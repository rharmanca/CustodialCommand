import{r as n,j as e,c as A,S as $e,C as ue,a as Te,u as Ae,b as Fe,B as z,d as C,e as k,f as w,H as Ee,g as U,h as M,i as R,U as Le,X as Be}from"./index-BevRPiCH.js";import{u as Pe,C as ae,n as _e,c as ze,f as W,i as Ue,t as Me,s as Re}from"./custodialNotesSchema-BsGpYhLK.js";import{m as Oe,g as qe,l as He,S as J,p as Ge,s as Ve,C as oe,a as We,c as Je}from"./collapsible-section-CFpYEk9w.js";import{L as N,I as T}from"./label-ajbr-TW9.js";import{T as Ke}from"./textarea-DqRvqOfb.js";import{S as re,a as ie,b as le,c as ne,d as ce}from"./select-DTyOSYyR.js";import{D as Ye,a as Xe,b as Qe,c as Ze,d as es}from"./dialog-C60uz-x3.js";import{C as ss}from"./chevron-right-BXHBXyKe.js";import{r as O,i as de}from"./custodial-criteria-aPNJLI_7.js";import{L as ts}from"./LoadingOverlay-efHe_1Bd.js";import{C as as}from"./Combination-D94_BxWu.js";import{S as K}from"./save-B-eNEcmZ.js";import{S as me}from"./star-C94evVQa.js";import{C as os}from"./calendar-DSQz2M4H.js";const xe=n.forwardRef(({...c},i)=>e.jsx("nav",{ref:i,"aria-label":"breadcrumb",...c}));xe.displayName="Breadcrumb";const he=n.forwardRef(({className:c,...i},d)=>e.jsx("ol",{ref:d,className:A("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",c),...i}));he.displayName="BreadcrumbList";const Y=n.forwardRef(({className:c,...i},d)=>e.jsx("li",{ref:d,className:A("inline-flex items-center gap-1.5",c),...i}));Y.displayName="BreadcrumbItem";const pe=n.forwardRef(({asChild:c,className:i,...d},f)=>{const D=c?$e:"a";return e.jsx(D,{ref:f,className:A("transition-colors hover:text-foreground",i),...d})});pe.displayName="BreadcrumbLink";const ge=n.forwardRef(({className:c,...i},d)=>e.jsx("span",{ref:d,role:"link","aria-disabled":"true","aria-current":"page",className:A("font-normal text-foreground",c),...i}));ge.displayName="BreadcrumbPage";const fe=({children:c,className:i,...d})=>e.jsx("li",{role:"presentation","aria-hidden":"true",className:A("[&>svg]:w-3.5 [&>svg]:h-3.5",i),...d,children:c??e.jsx(ss,{})});fe.displayName="BreadcrumbSeparator";function rs({status:c,lastSaved:i,errorMessage:d,className:f=""}){const[D,r]=n.useState("");n.useEffect(()=>{if(!i){r("");return}const E=()=>{const h=new Date().getTime()-i.getTime(),I=Math.floor(h/1e3),j=Math.floor(I/60);I<10?r("just now"):I<60?r(`${I}s ago`):j<60?r(`${j}m ago`):r(i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))};E();const X=setInterval(E,1e4);return()=>clearInterval(X)},[i]);const b=(()=>{switch(c){case"saving":return{icon:K,text:"Saving...",bgColor:"bg-blue-100 border-blue-300",textColor:"text-blue-800",iconColor:"text-blue-600",animate:!0};case"saved":return{icon:as,text:D?`Saved ${D}`:"Saved",bgColor:"bg-green-100 border-green-300",textColor:"text-green-800",iconColor:"text-green-600",animate:!1};case"error":return{icon:Te,text:d||"Save failed",bgColor:"bg-red-100 border-red-300",textColor:"text-red-800",iconColor:"text-red-600",animate:!1};default:return{icon:ue,text:"Not saved",bgColor:"bg-gray-100 border-gray-300",textColor:"text-gray-700",iconColor:"text-gray-500",animate:!1}}})(),o=b.icon;return e.jsxs("div",{className:`fixed bottom-4 right-4 z-50 flex items-center gap-2 px-4 py-2 rounded-lg border-2 shadow-lg transition-all duration-200 ${b.bgColor} ${f}`,role:"status","aria-live":"polite",children:[e.jsx(o,{className:`h-4 w-4 ${b.iconColor} ${b.animate?"animate-pulse":""}`}),e.jsx("span",{className:`text-sm font-medium ${b.textColor}`,children:b.text})]})}function vs({onBack:c}){const{isMobile:i}=Ae(),{toast:d}=Fe(),{register:f,handleSubmit:D,formState:{errors:r,isSubmitting:F},reset:b,setValue:o,watch:E,getValues:X,control:q}=Pe({resolver:Me(Re),defaultValues:Ue}),h=E(),[I,j]=n.useState(!1),[be,H]=n.useState([]),[v,$]=n.useState(null),[L,B]=n.useState(null),[G,Q]=n.useState(!1),[je,V]=n.useState("idle"),ve=[{value:"ASA",label:"ASA"},{value:"LCA",label:"LCA"},{value:"GWC",label:"GWC"},{value:"OA",label:"OA"},{value:"CBR",label:"CBR"},{value:"WLC",label:"WLC"}],Z=[{value:"exterior",label:"Exterior"},{value:"gym_bleachers",label:"Gym and Bleachers"},{value:"classroom",label:"Classroom"},{value:"cafeteria",label:"Cafeteria"},{value:"utility_storage",label:"Utility Or Storage"},{value:"admin_office",label:"Admin or Office Area"},{value:"hallway",label:"Hallway"},{value:"stairwell",label:"Stairwell"},{value:"restroom",label:"Restroom"},{value:"staff_single_restroom",label:"Staff or Single Restroom"}],[g,P]=n.useState([]);n.useEffect(()=>{Oe(),ye();const s=qe();console.log("Storage stats:",s)},[]),n.useEffect(()=>{if(v){const s=setTimeout(()=>{ee()},2e3);return()=>clearTimeout(s)}},[h,g,v]);const ye=()=>{try{const s=He(J.DRAFT_INSPECTION);s&&(H([s]),j(!0));const t=localStorage.getItem("custodial_inspection_drafts");if(t&&!s){const l=JSON.parse(t).filter(u=>{const m=new Date(u.lastModified),x=new Date;return x.setDate(x.getDate()-7),m>x});l.length>0&&(H(l),j(!0))}}catch(s){console.error("Error loading draft inspections:",s)}},Ne=()=>`draft_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,ee=async()=>{if(!(!h.school||!h.date)){Q(!0),V("saving");try{const s=v||Ne();v||$(s);const t=[];for(const l of g)try{const u=await Ge(l);t.push(u)}catch(u){console.error("Failed to process image:",u)}const a={id:s,...h,selectedImages:t,lastModified:new Date().toISOString(),title:`${h.school} - ${h.roomNumber||"Room"} - ${h.locationCategory||"Inspection"}`};Ve(J.DRAFT_INSPECTION,a),B(new Date),V("saved")}catch(s){console.error("Error saving draft:",s),V("error")}finally{Q(!1)}}},Se=s=>{if(o("school",s.school||""),o("date",s.date||""),o("inspectionType",s.inspectionType||"single_room"),o("locationDescription",s.locationDescription||""),o("roomNumber",s.roomNumber||""),o("locationCategory",s.locationCategory||""),o("floors",s.floors||0),o("verticalHorizontalSurfaces",s.verticalHorizontalSurfaces||0),o("ceiling",s.ceiling||0),o("restrooms",s.restrooms||0),o("customerSatisfaction",s.customerSatisfaction||0),o("trash",s.trash||0),o("projectCleaning",s.projectCleaning||0),o("activitySupport",s.activitySupport||0),o("safetyCompliance",s.safetyCompliance||0),o("equipment",s.equipment||0),o("monitoring",s.monitoring||0),o("notes",s.notes||""),s.selectedImages&&s.selectedImages.length>0){const t=s.selectedImages.map((a,l)=>{const u=atob(a.split(",")[1]),m=new Array(u.length);for(let y=0;y<u.length;y++)m[y]=u.charCodeAt(y);const x=new Uint8Array(m);return new File([x],`image_${l}.jpg`,{type:"image/jpeg"})});P(t)}$(s.id),j(!1)},se=s=>{Je(J.DRAFT_INSPECTION);const t=JSON.parse(localStorage.getItem("custodial_inspection_drafts")||"[]"),a=t.filter(l=>l.id!==s);a.length!==t.length&&localStorage.setItem("custodial_inspection_drafts",JSON.stringify(a)),H([]),v===s&&($(null),B(null))},Ce=()=>{j(!1),$(null),B(null)},te=async s=>{const t=s.target.files;if(t&&t.length>0){const a=Array.from(t),u=5-g.length,m=a.slice(0,u),x=[];let y=0,_=0;for(const p of m)if(y+=p.size,_e(p,500))try{const S=await ze(p,{maxSizeKB:500});x.push(S.compressedFile),_+=S.compressedSize,console.log(`Compressed ${p.name}: ${W(p.size)} ‚Üí ${W(S.compressedSize)}`)}catch(S){console.error("Failed to compress image:",S),x.push(p),_+=p.size}else x.push(p),_+=p.size;if(P(p=>[...p,...x]),x.length>0){const p=y-_,S=(p/y*100).toFixed(1);d({title:"üì∏ Photos Uploaded Successfully!",description:`Added ${x.length} photo${x.length>1?"s":""} to inspection documentation.${p>0?` Saved ${W(p)} (${S}% compression).`:""}`,duration:3e3})}m.length<a.length&&d({variant:"destructive",title:"Upload Limit Reached",description:`Only ${m.length} photos were added. Maximum of 5 images allowed per inspection.`,duration:5e3}),console.log("Files selected:",x.length,"files")}},we=s=>{P(t=>t.filter((a,l)=>l!==s))},De=async s=>{try{const t=new FormData;Object.entries(s).forEach(([m,x])=>{m!=="images"&&t.append(m,x?.toString()||"")}),g.forEach(m=>{t.append("images",m)});const a=new AbortController,l=setTimeout(()=>a.abort(),3e4),u=await fetch("/api/inspections",{method:"POST",body:t,signal:a.signal});if(clearTimeout(l),u.ok)d({title:"‚úÖ Inspection Submitted Successfully!",description:`Single area inspection for ${s.school} has been submitted and saved.`,variant:"default",duration:5e3}),v&&se(v),b(),P([]),$(null),B(null),setTimeout(()=>{c&&c()},6e3);else{const m=await u.json().catch(()=>({message:"Unknown error"}));d({variant:"destructive",title:"Submission Failed",description:`Error: ${m.message||"Unable to submit inspection. Please try again."}`,duration:7e3})}}catch(t){console.error("Error submitting inspection:",t);let a="Submission Failed",l="Unable to submit inspection. Please try again.";t instanceof Error&&(t.name==="AbortError"?(a="Request Timeout",l="The request took too long to complete. This might be due to slow internet connection or large file uploads. Please try again."):t.message.includes("NetworkError")||t.message.includes("fetch")?(a="Network Error",l="Unable to connect to the server. Please check your connection and try again."):(t.message.includes("validation")||t.message.includes("Invalid"))&&(a="Invalid Data",l="Please check all required fields and try again.")),d({variant:"destructive",title:a,description:l,duration:7e3})}},Ie=n.useCallback((s,t)=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-3 text-center",children:"Rate this category:"}),e.jsx("div",{className:"flex justify-center gap-2 mb-4",children:[1,2,3,4,5].map(a=>e.jsx("button",{type:"button",className:"p-3 min-w-[48px] min-h-[48px] rounded-md hover:bg-yellow-50 transition-colors touch-manipulation flex items-center justify-center",onClick:()=>o(s.key,a),children:e.jsx(me,{className:`w-7 h-7 ${a<=t&&t>0?"fill-yellow-400 text-yellow-400":"text-gray-300 hover:text-yellow-300"}`})},a))}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",className:`px-6 py-3 min-h-[48px] rounded-md border text-sm font-medium transition-colors touch-manipulation ${t===0?"bg-gray-100 border-gray-300 text-gray-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,onClick:()=>o(s.key,0),children:"Not Rated"})})]}),e.jsx("div",{className:"text-center",children:t>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{variant:"secondary",className:"text-sm px-3 py-1",children:O[t-1]?.label}),e.jsx("div",{className:"text-xs text-muted-foreground",children:O[t-1]?.description})]}):e.jsx(z,{variant:"outline",className:"text-sm px-3 py-1",children:"No rating selected"})}),t>0&&s.criteria&&s.criteria[t]&&e.jsx(C,{className:"bg-blue-50 border-blue-200",children:e.jsx(k,{className:"p-3",children:e.jsxs("div",{className:"text-xs text-blue-800",children:[e.jsxs("strong",{className:"text-sm",children:["Rating ",t," Criteria:"]}),e.jsx("p",{className:"mt-1 leading-relaxed",children:s.criteria[t]})]})})})]}),[o]),ke=n.useCallback((s,t)=>e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[e.jsx(w,{type:"button",variant:t===0?"default":"outline",size:"sm",className:"px-4 py-3 text-xs min-h-[48px]",onClick:()=>o(s.key,0),children:"Not Rated"}),[1,2,3,4,5].map(a=>e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"min-w-[48px] min-h-[48px]",onClick:()=>o(s.key,a),children:e.jsx(me,{className:`w-7 h-7 ${a<=t&&t>0?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},a))]}),e.jsx("div",{className:"text-center px-3",children:t>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{variant:"secondary",className:"text-sm px-3 py-1",children:O[t-1]?.label}),e.jsx("div",{className:"text-xs text-gray-600 leading-relaxed",children:O[t-1]?.description})]}):e.jsx(z,{variant:"outline",className:"text-sm px-3 py-1",children:"No rating selected"})}),t>0&&s.criteria&&s.criteria[t]&&e.jsx(C,{className:"bg-accent/10 border-accent/30",children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"text-xs text-accent-foreground",children:[e.jsxs("strong",{className:"text-sm",children:["Rating ",t," Criteria:"]}),e.jsx("p",{className:"mt-1 leading-relaxed",children:s.criteria[t]})]})})})]}),[o]);return e.jsxs(e.Fragment,{children:[e.jsx(Ye,{open:I,onOpenChange:j,children:e.jsxs(Xe,{className:"max-w-2xl",children:[e.jsxs(Qe,{children:[e.jsx(Ze,{children:"Resume Previous Inspection?"}),e.jsx(es,{children:"You have unfinished inspection drafts. Would you like to continue one of them or start a new inspection?"})]}),e.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[be.map(s=>e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last modified: ",new Date(s.lastModified).toLocaleString()]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["School: ",s.school," ‚Ä¢ Date: ",s.date,s.roomNumber&&` ‚Ä¢ Room: ${s.roomNumber}`]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(w,{size:"sm",onClick:()=>Se(s),children:"Resume"}),e.jsx(w,{size:"sm",variant:"outline",onClick:()=>se(s.id),children:"Delete"})]})]})},s.id)),e.jsx("div",{className:"flex justify-center space-x-4 pt-4",children:e.jsx(w,{onClick:Ce,variant:"outline",children:"Start New Inspection"})})]})]})}),e.jsxs("div",{className:"container mx-auto p-6 max-w-4xl",children:[e.jsx(xe,{className:"mb-4",children:e.jsxs(he,{children:[e.jsx(Y,{children:e.jsxs(pe,{onClick:c,className:"flex items-center gap-1 cursor-pointer",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Home"})]})}),e.jsx(fe,{}),e.jsx(Y,{children:e.jsx(ge,{children:"Single Area Inspection"})})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Submit Inspection"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Use this form to inspect a single room or location. Example: Cafeteria. If performing a whole building inspection please select that from the previous screen."}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800 leading-relaxed",children:[e.jsx("strong",{children:"üìã Important:"})," This form is for inspecting a single room or area using the same rating criteria as the Whole Building Inspection. However, single area inspections are recorded separately and do not automatically count toward a building-wide inspection or monthly metrics. If you're conducting these inspections as part of a comprehensive building review or to meet monthly inspection requirements, you'll need to manually track your progress across all required areas."]})}),(L||G)&&e.jsx("div",{className:"mt-2 flex items-center space-x-2 text-sm text-muted-foreground",children:G?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Saving..."})]}):L?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsxs("span",{children:["Last saved: ",L.toLocaleTimeString()]})]}):null}),v&&e.jsxs(w,{type:"button",variant:"outline",onClick:ee,disabled:G,className:"mt-4",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Save Draft"]})]}),e.jsxs("form",{onSubmit:D(De),className:"space-y-6",children:[e.jsxs(C,{children:[e.jsxs(U,{children:[e.jsx(M,{children:"Basic Information"}),e.jsx(R,{children:"Enter the basic details for this inspection"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"school",id:"school-label",children:"School *"}),e.jsx(ae,{name:"school",control:q,render:({field:s})=>e.jsxs(re,{value:s.value,onValueChange:s.onChange,children:[e.jsx(ie,{"aria-required":"true","aria-labelledby":"school-label","aria-describedby":r.school?"school-error":void 0,"aria-invalid":r.school?"true":void 0,children:e.jsx(le,{placeholder:"Select school"})}),e.jsx(ne,{children:ve.map(t=>e.jsx(ce,{value:t.value,children:t.label},t.value))})]})}),r.school&&e.jsx("p",{id:"school-error",className:"text-sm text-red-500 mt-1",role:"alert",children:r.school.message})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"date",children:"Inspection Date *"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{id:"date",type:"date",...f("date"),"aria-required":"true","aria-describedby":r.date?"date-error date-help":"date-help","aria-invalid":r.date?"true":void 0,className:"pr-10"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground","aria-hidden":"true",children:e.jsx(os,{className:"w-4 h-4"})})]}),r.date&&e.jsx("p",{id:"date-error",className:"text-sm text-red-500 mt-1",role:"alert",children:r.date.message}),e.jsx("p",{id:"date-help",className:"text-sm text-muted-foreground mt-1",children:"Click the field or calendar icon to select a date"})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"locationCategory",children:"Location Category"}),e.jsx(ae,{name:"locationCategory",control:q,render:({field:s})=>e.jsxs(re,{value:s.value,onValueChange:s.onChange,children:[e.jsx(ie,{children:e.jsx(le,{placeholder:"Select location category"})}),e.jsx(ne,{children:Z.map(t=>e.jsx(ce,{value:t.value,children:t.label},t.value))})]})}),r.locationCategory&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.locationCategory.message})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"roomNumber",children:"Room Number"}),e.jsx(T,{id:"roomNumber",...f("roomNumber"),placeholder:"e.g., 101, Main Hall"}),r.roomNumber&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.roomNumber.message})]})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"locationDescription",children:"Location Description"}),e.jsx(T,{id:"locationDescription",...f("locationDescription"),placeholder:"e.g., Main Building, Second Floor, Near Library"}),r.locationDescription&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.locationDescription.message})]})]})]}),e.jsxs(C,{children:[e.jsxs(U,{children:[e.jsx(M,{children:"Inspection Categories"}),e.jsx(R,{children:i?"Expand each category to rate it. Detailed criteria will appear when you select a rating.":"Expand each category to rate it based on the criteria (1-5 stars). Detailed criteria will appear when you select a rating."})]}),e.jsx(k,{className:"space-y-4",children:i?de.map(s=>e.jsx(oe,{title:s.label,defaultCollapsed:!0,className:"border border-gray-200",titleClassName:"text-left font-medium",contentClassName:"space-y-3",children:Ie(s,h[s.key])},s.key)):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:de.map(s=>e.jsx(oe,{title:s.label,defaultCollapsed:!0,className:"border border-gray-200",titleClassName:"text-left font-medium",contentClassName:"space-y-3",children:ke(s,h[s.key])},s.key))})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(C,{children:[e.jsxs(U,{children:[e.jsx(M,{children:"Additional Notes & Observations"}),e.jsx(R,{children:"Detailed observations, specific issues, recommendations, or additional context"})]}),e.jsxs(k,{children:[e.jsx(Ke,{...f("notes"),placeholder:`Enter detailed notes about this inspection...

Examples:
‚Ä¢ Specific areas that need attention
‚Ä¢ Safety concerns observed
‚Ä¢ Maintenance recommendations
‚Ä¢ Follow-up actions required
‚Ä¢ Staff performance observations
‚Ä¢ Equipment issues noted`,rows:8,className:"min-h-[200px]","aria-describedby":"notes-help"}),r.notes&&e.jsx("p",{className:"text-sm text-red-500 mt-2",children:r.notes.message}),e.jsx("p",{id:"notes-help",className:"text-sm text-muted-foreground mt-2",children:"Provide detailed observations, specific issues, recommendations, or additional context for this inspection"})]})]}),e.jsxs(C,{children:[e.jsxs(U,{children:[e.jsx(M,{children:"Photo Documentation"}),e.jsx(R,{children:"Upload images or take photos to document inspection findings (up to 5 images)"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(N,{htmlFor:"image-upload",className:"cursor-pointer flex-1",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 px-4 py-3 sm:py-2 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors min-h-[48px]",children:[e.jsx(Le,{className:"w-5 h-5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"font-medium",children:"Upload Images"})]}),e.jsx(T,{id:"image-upload",type:"file",multiple:!0,accept:"image/*",onChange:te,className:"hidden",disabled:g.length>=5})]}),e.jsxs(N,{htmlFor:"camera-capture",className:"cursor-pointer flex-1",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 px-4 py-3 sm:py-2 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors min-h-[48px]",children:[e.jsx(We,{className:"w-5 h-5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"font-medium",children:"Take Photo"})]}),e.jsx(T,{id:"camera-capture",type:"file",accept:"image/*",capture:"environment",onChange:te,className:"hidden",disabled:g.length>=5})]})]}),g.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-2 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[g.length," of 5 images selected"]}),g.length>=5&&e.jsx("span",{className:"text-xs text-blue-700 bg-blue-100 px-2 py-1 rounded",children:"Maximum reached"})]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"üì∏ Select multiple images or take photos ‚Ä¢ Up to 5 images ‚Ä¢ JPG, PNG, GIF supported"}),g.length>0&&e.jsxs("div",{className:"space-y-2",role:"region","aria-label":"Uploaded inspection photos",children:[e.jsx(N,{className:"text-sm font-semibold",id:"image-previews-label",children:"Image Previews"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 sm:gap-4",role:"list","aria-labelledby":"image-previews-label",children:g.map((s,t)=>{const a=h.locationCategory?Z.find(m=>m.value===h.locationCategory)?.label:"inspection area",l=h.roomNumber?` in ${h.roomNumber}`:"",u=`Inspection photo ${t+1} of ${g.length} for ${a}${l}. File: ${s.name}`;return e.jsxs("div",{className:"relative group",role:"listitem",children:[e.jsx("img",{src:URL.createObjectURL(s),alt:u,className:"w-full h-32 sm:h-24 object-cover rounded-lg border-2 border-gray-200",loading:"lazy"}),e.jsx("button",{type:"button",onClick:()=>we(t),className:"absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white rounded-full p-2 opacity-90 md:opacity-0 md:group-hover:opacity-100 transition-opacity shadow-lg","aria-label":`Remove photo ${t+1}: ${s.name}`,children:e.jsx(Be,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1 py-0.5 rounded","aria-hidden":"true",children:s.name.length>12?s.name.substring(0,12)+"...":s.name})]},t)})})]})]})]})]}),e.jsx("div",{className:"flex justify-end gap-4",children:e.jsx(w,{type:"submit",size:"lg",disabled:F,className:`bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed ${i?"w-full h-14 text-lg":""}`,children:F?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"‚è≥"}),"Submitting..."]}):"Submit Inspection"})})]})]}),F&&e.jsx(ts,{message:"Submitting inspection..."}),e.jsx(rs,{status:je,lastSaved:L})]})}export{vs as default};
