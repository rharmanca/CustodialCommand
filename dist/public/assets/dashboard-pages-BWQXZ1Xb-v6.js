var L=(g,D,u)=>new Promise((E,h)=>{var N=o=>{try{a(u.next(o))}catch(m){h(m)}},p=o=>{try{a(u.throw(o))}catch(m){h(m)}},a=o=>o.done?E(o.value):Promise.resolve(o.value).then(N,p);a((u=u.apply(g,D)).next())});import{r as l,j as s,u as z,v as H,f as A,w as F,b as q}from"./vendor-sxM67w4W-v6.js";import{a as G,u as J,b2 as K,B as V,C as i,b as t,c as d,d as c,e as n,L as I,I as k,b3 as S}from"./index-D0Fw1TE4-v6.js";import"./ui-BA32w1ww-v6.js";import"./utils-Cj9wHvoQ-v6.js";import"./forms-CCi5m2ZW-v6.js";import"./charts-core-BgnrxSXt-v6.js";import"./pdf-export-DTP6qpk5-v6.js";function rs({onBack:g}){const{toast:D}=G(),{isMobile:u}=J(),[E,h]=l.useState(!0),[N,p]=l.useState(!1),[a,o]=l.useState([]),[m,j]=l.useState(""),[b,U]=l.useState(""),[Q,B]=l.useState([]);l.useEffect(()=>{const e=new Date,r=new Date(e);r.setDate(e.getDate()-30),U(e.toISOString().split("T")[0]),j(r.toISOString().split("T")[0])},[]);const w=(e,r)=>L(null,null,function*(){try{h(!0);const C=new URLSearchParams;e&&C.append("startDate",e),r&&C.append("endDate",r);const R=yield fetch(`/api/scores?${C.toString()}`);if(!R.ok)throw new Error("Failed to fetch scores");const T=yield R.json();o(T.scores||[]),B(T.scores||[])}catch(C){console.error("Error fetching scores:",C),D({title:"Error",description:"Failed to load building scores. Please try again.",variant:"destructive"})}finally{h(!1),p(!1)}});l.useEffect(()=>{m&&b&&w(m,b)},[m,b]);const O=()=>{p(!0),w(m,b)},P=()=>{const e=new Date,r=new Date(e);r.setDate(e.getDate()-30),U(e.toISOString().split("T")[0]),j(r.toISOString().split("T")[0])},y=a.filter(e=>e.score.level2Compliant).length,v=a.length,M=v>0?y/v*100:0,$=a.length>0?a.reduce((e,r)=>e+r.score.overallScore,0)/a.length:0,x=a.length>0?a.reduce((e,r)=>r.score.overallScore>e.score.overallScore?r:e):null,f=a.filter(e=>e.score.overallScore<3);return E&&!N?s.jsxDEV(K,{message:"Loading building scores..."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:111,columnNumber:12},this):s.jsxDEV("div",{className:"container mx-auto p-6 max-w-7xl space-y-6",children:[s.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[s.jsxDEV("div",{children:[s.jsxDEV("h1",{className:"text-3xl font-bold",children:"Building Scores Dashboard"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:119,columnNumber:11},this),s.jsxDEV("p",{className:"text-muted-foreground mt-1",children:"Track custodial performance across all campuses"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:120,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:118,columnNumber:9},this),g&&s.jsxDEV(V,{variant:"outline",onClick:g,children:"← Back"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:125,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:117,columnNumber:7},this),s.jsxDEV(i,{children:[s.jsxDEV(t,{children:s.jsxDEV("div",{className:"flex items-center justify-between",children:[s.jsxDEV("div",{children:[s.jsxDEV(d,{className:"text-lg flex items-center gap-2",children:[s.jsxDEV(z,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:137,columnNumber:17},this),"Filter by Date Range"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:136,columnNumber:15},this),s.jsxDEV(c,{children:"View scores for a specific time period"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:140,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:135,columnNumber:13},this),s.jsxDEV(V,{variant:"outline",size:"sm",onClick:O,disabled:N,children:[s.jsxDEV(H,{className:`w-4 h-4 mr-2 ${N?"animate-spin":""}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:148,columnNumber:15},this),"Refresh"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:142,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:134,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:133,columnNumber:9},this),s.jsxDEV(n,{children:s.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsxDEV("div",{className:"space-y-2",children:[s.jsxDEV(I,{htmlFor:"startDate",children:"Start Date"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:156,columnNumber:15},this),s.jsxDEV(k,{id:"startDate",type:"date",value:m,onChange:e=>j(e.target.value)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:157,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:155,columnNumber:13},this),s.jsxDEV("div",{className:"space-y-2",children:[s.jsxDEV(I,{htmlFor:"endDate",children:"End Date"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:165,columnNumber:15},this),s.jsxDEV(k,{id:"endDate",type:"date",value:b,onChange:e=>U(e.target.value)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:166,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:164,columnNumber:13},this),s.jsxDEV("div",{className:"space-y-2 flex items-end",children:s.jsxDEV(V,{variant:"secondary",onClick:P,className:"w-full",children:"Last 30 Days"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:174,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:173,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:154,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:153,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:132,columnNumber:7},this),s.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxDEV(i,{children:[s.jsxDEV(t,{className:"pb-3",children:[s.jsxDEV(c,{children:"Total Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:186,columnNumber:13},this),s.jsxDEV(d,{className:"text-3xl",children:v},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:187,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:185,columnNumber:11},this),s.jsxDEV(n,{children:s.jsxDEV("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsxDEV(A,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:191,columnNumber:15},this),s.jsxDEV("span",{children:"Monitored campuses"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:192,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:190,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:189,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:184,columnNumber:9},this),s.jsxDEV(i,{children:[s.jsxDEV(t,{className:"pb-3",children:[s.jsxDEV(c,{children:"Level 2 Compliance"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:199,columnNumber:13},this),s.jsxDEV(d,{className:"text-3xl text-green-600",children:[M.toFixed(0),"%"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:200,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:198,columnNumber:11},this),s.jsxDEV(n,{children:s.jsxDEV("div",{className:"text-sm text-muted-foreground",children:[y," of ",v," schools ≥3.0"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:205,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:204,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:197,columnNumber:9},this),s.jsxDEV(i,{children:[s.jsxDEV(t,{className:"pb-3",children:[s.jsxDEV(c,{children:"Network Average"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:213,columnNumber:13},this),s.jsxDEV(d,{className:"text-3xl",children:$.toFixed(2)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:214,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:212,columnNumber:11},this),s.jsxDEV(n,{children:s.jsxDEV("div",{className:"text-sm text-muted-foreground",children:"Across all schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:217,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:216,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:211,columnNumber:9},this),s.jsxDEV(i,{children:[s.jsxDEV(t,{className:"pb-3",children:[s.jsxDEV(c,{children:"Needs Attention"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:225,columnNumber:13},this),s.jsxDEV(d,{className:"text-3xl text-yellow-600",children:f.length},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:226,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:224,columnNumber:11},this),s.jsxDEV(n,{children:s.jsxDEV("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsxDEV(F,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:232,columnNumber:15},this),s.jsxDEV("span",{children:"Below Level 2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:233,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:231,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:230,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:223,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:183,columnNumber:7},this),x&&s.jsxDEV(i,{className:"bg-gradient-to-r from-green-50 to-blue-50 border-green-200",children:[s.jsxDEV(t,{children:s.jsxDEV("div",{className:"flex items-center gap-2",children:[s.jsxDEV(q,{className:"w-5 h-5 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:244,columnNumber:15},this),s.jsxDEV(d,{className:"text-lg",children:"Top Performer"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:245,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:243,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:242,columnNumber:11},this),s.jsxDEV(n,{children:s.jsxDEV(S,{school:x.school,score:x.score,complianceStatus:x.complianceStatus,dateRange:x.dateRange,compact:u},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:249,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:248,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:241,columnNumber:9},this),f.length>0&&s.jsxDEV(i,{className:"bg-yellow-50 border-yellow-200",children:[s.jsxDEV(t,{children:[s.jsxDEV("div",{className:"flex items-center gap-2",children:[s.jsxDEV(F,{className:"w-5 h-5 text-yellow-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:265,columnNumber:15},this),s.jsxDEV(d,{className:"text-lg",children:"Schools Needing Attention"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:266,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:264,columnNumber:13},this),s.jsxDEV(c,{children:[f.length," ",f.length===1?"school is":"schools are"," below Level 2 standards"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:268,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:263,columnNumber:11},this),s.jsxDEV(n,{children:s.jsxDEV("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:f.map(e=>s.jsxDEV(S,{school:e.school,score:e.score,complianceStatus:e.complianceStatus,dateRange:e.dateRange,compact:!0},e.school,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:275,columnNumber:17},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:273,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:272,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:262,columnNumber:9},this),s.jsxDEV(i,{children:[s.jsxDEV(t,{children:[s.jsxDEV(d,{children:"All School Scores"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:292,columnNumber:11},this),s.jsxDEV(c,{children:["Showing ",a.length," schools sorted by overall score"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:293,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:291,columnNumber:9},this),s.jsxDEV(n,{children:[s.jsxDEV("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:a.map(e=>s.jsxDEV(S,{school:e.school,score:e.score,complianceStatus:e.complianceStatus,dateRange:e.dateRange,compact:!0},e.school,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:300,columnNumber:15},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:298,columnNumber:11},this),a.length===0&&s.jsxDEV("div",{className:"text-center py-12 text-muted-foreground",children:[s.jsxDEV(A,{className:"w-12 h-12 mx-auto mb-4 opacity-50"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:312,columnNumber:15},this),s.jsxDEV("p",{children:"No scores available for the selected date range."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:313,columnNumber:15},this),s.jsxDEV("p",{className:"text-sm mt-2",children:"Try adjusting your date filters or refresh the page."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:314,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:311,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:297,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:290,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:115,columnNumber:5},this)}export{rs as default};
