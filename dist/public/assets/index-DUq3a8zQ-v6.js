
;(function(){
  // CRITICAL: Initialize global scheduler container
  if(typeof window !== 'undefined') {
    window.__cf = window.__cf || {};
    window.__REACT_SCHEDULER_EXPORTS__ = window.__REACT_SCHEDULER_EXPORTS__ || {};
    window.__SCHEDULER_PATCHED__ = true;
    console.log('[Scheduler Fix] Global containers initialized');
  }
})();
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/inspection-pages-BssZhaOe-v6.js","assets/vendor-1jRaonge-v6.js","assets/ui-BQCqNqg0-v6.js","assets/utils-DvvWCVwA-v6.js","assets/forms-qrEI1HMw-v6.js","assets/charts-core-Ci00SAtp-v6.js","assets/pdf-export-DLkp0oRl-v6.js","assets/data-pages-_UOy_NOD-v6.js","assets/notes-pages-DNzhrUgd-v6.js","assets/building-inspection-Dj5QLIO1-v6.js","assets/admin-pages-DELiqfCh-v6.js","assets/feedback-pages-DCdtDxK0-v6.js","assets/dashboard-pages-BQVzgzzK-v6.js"])))=>i.map(i=>d[i]);
var q5=Object.defineProperty;var oy=e=>{throw TypeError(e)};var H5=(e,r,t)=>r in e?q5(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var er=(e,r,t)=>H5(e,typeof r!="symbol"?r+"":r,t),Jf=(e,r,t)=>r.has(e)||oy("Cannot "+t);var de=(e,r,t)=>(Jf(e,r,"read from private field"),t?t.call(e):r.get(e)),ir=(e,r,t)=>r.has(e)?oy("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(e):r.set(e,t),$e=(e,r,t,n)=>(Jf(e,r,"write to private field"),n?n.call(e,t):r.set(e,t),t),Et=(e,r,t)=>(Jf(e,r,"access private method"),t);var yu=(e,r,t,n)=>({set _(a){$e(e,r,a,t)},get _(){return de(e,r,n)}});import{r as W,j as m,V as Lk,O as Bk,Q as qk,W as Hk,X as oi,Y as zk,Z as $k,_ as z5,$ as Gk,z as Ut,i as P1,E as Pn,a0 as Wk,a1 as ly,l as Yk,a2 as $5,a3 as Kk,H as G5,a4 as W5,x as xn,a5 as V1,U as ni,R as Is,a6 as Y5,a7 as K5,a8 as Xk,a9 as X5,aa as Q5,ab as Qk,ac as Z5,ad as $i,ae as J5,af as Zk,ag as eV,ah as Jk,ai as rV,g as M1,aj as tV,ak as e4,al as r4,am as t4,an as n4,ao as a4,ap as i4,aq as nV,ar as s4,as as j1,at as aV,au as o4,av as l4,aw as L1,h as Xc,k as u4,ax as c4,ay as iV,az as f4,aA as m4,aB as d4,aC as h4,b as lo,aD as p4,w as vn,p as Aa,aE as B1,aF as sV,aG as kg,u as wt,F as ja,aH as oV,aI as uy,aJ as v4,aK as x4,aL as lV,aM as uV,aN as g4,aO as cV,y as Qi,aP as fV,aQ as mV,n as ic,aR as b4,aS as N4,aT as dV,aU as hV,aV as pV,aW as vV,aX as xV,aY as gV,G as y4,aZ as em,a as bV,a_ as NV,a$ as yV,b0 as CV,b1 as Yo,b2 as EV,b3 as wV,b4 as _V,b5 as SV,b6 as TV,b7 as C4,b8 as E4,b9 as DV,ba as AV,A as kV,bb as RV,bc as OV,bd as FV,be as w4,bf as _4,bg as S4,bh as T4,bi as D4,bj as A4,bk as Ps,bl as pi,bm as hl,bn as UV,bo as IV,bp as PV,bq as VV,br as k4,C as R4,e as cy,bs as MV,bt as jV,bu as LV,T as BV}from"./vendor-1jRaonge-v6.js";import{o as O4,a as F4,s as Zt,n as wn,l as Ko,i as qV}from"./forms-qrEI1HMw-v6.js";import{R as q1,L as HV,C as U4,X as I4,Y as P4,T as V4,a as M4,b as fy,B as zV,c as my,d as dy,e as $V,P as GV,f as WV,g as YV,h as KV}from"./charts-core-Ci00SAtp-v6.js";import{c as j4,t as XV,s as rm,a as hy,f as sc,e as QV}from"./utils-DvvWCVwA-v6.js";import{E as Ll,a as Zi}from"./pdf-export-DLkp0oRl-v6.js";import"./ui-BQCqNqg0-v6.js";import"./index-DUq3a8zQ-v6.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();var Pi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var tm={exports:{}},nm={},py;function ZV(){return py||(py=1,(function(e){/**
 * @license React
 * scheduler.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var r=!1,t=5;function n(pe,ke){var Ve=pe.length;pe.push(ke),s(pe,ke,Ve)}function a(pe){return pe.length===0?null:pe[0]}function i(pe){if(pe.length===0)return null;var ke=pe[0],Ve=pe.pop();return Ve!==ke&&(pe[0]=Ve,o(pe,Ve,0)),ke}function s(pe,ke,Ve){for(var Ke=Ve;Ke>0;){var ar=Ke-1>>>1,Er=pe[ar];if(u(Er,ke)>0)pe[ar]=ke,pe[Ke]=Er,Ke=ar;else return}}function o(pe,ke,Ve){for(var Ke=Ve,ar=pe.length,Er=ar>>>1;Ke<Er;){var rr=(Ke+1)*2-1,nt=pe[rr],ur=rr+1,un=pe[ur];if(u(nt,ke)<0)ur<ar&&u(un,nt)<0?(pe[Ke]=un,pe[ur]=ke,Ke=ur):(pe[Ke]=nt,pe[rr]=ke,Ke=rr);else if(ur<ar&&u(un,ke)<0)pe[Ke]=un,pe[ur]=ke,Ke=ur;else return}}function u(pe,ke){var Ve=pe.sortIndex-ke.sortIndex;return Ve!==0?Ve:pe.id-ke.id}var l=1,c=2,f=3,h=4,d=5;function v(pe,ke){}var p=typeof performance=="object"&&typeof performance.now=="function";if(p){var x=performance;e.unstable_now=function(){return x.now()}}else{var g=Date,N=g.now();e.unstable_now=function(){return g.now()-N}}var b=1073741823,y=-1,_=250,w=5e3,C=1e4,k=b,D=[],U=[],F=1,L=null,P=f,B=!1,G=!1,ue=!1,oe=typeof setTimeout=="function"?setTimeout:null,he=typeof clearTimeout=="function"?clearTimeout:null,fe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(pe){for(var ke=a(U);ke!==null;){if(ke.callback===null)i(U);else if(ke.startTime<=pe)i(U),ke.sortIndex=ke.expirationTime,n(D,ke);else return;ke=a(U)}}function re(pe){if(ue=!1,S(pe),!G)if(a(D)!==null)G=!0,je(T);else{var ke=a(U);ke!==null&&Z(re,ke.startTime-pe)}}function T(pe,ke){G=!1,ue&&(ue=!1,J()),B=!0;var Ve=P;try{var Ke;if(!r)return E(pe,ke)}finally{L=null,P=Ve,B=!1}}function E(pe,ke){var Ve=ke;for(S(Ve),L=a(D);L!==null&&!(L.expirationTime>Ve&&(!pe||xr()));){var Ke=L.callback;if(typeof Ke=="function"){L.callback=null,P=L.priorityLevel;var ar=L.expirationTime<=Ve,Er=Ke(ar);Ve=e.unstable_now(),typeof Er=="function"?L.callback=Er:L===a(D)&&i(D),S(Ve)}else i(D);L=a(D)}if(L!==null)return!0;var rr=a(U);return rr!==null&&Z(re,rr.startTime-Ve),!1}function V(pe,ke){switch(pe){case l:case c:case f:case h:case d:break;default:pe=f}var Ve=P;P=pe;try{return ke()}finally{P=Ve}}function I(pe){var ke;switch(P){case l:case c:case f:ke=f;break;default:ke=P;break}var Ve=P;P=ke;try{return pe()}finally{P=Ve}}function Y(pe){var ke=P;return function(){var Ve=P;P=ke;try{return pe.apply(this,arguments)}finally{P=Ve}}}function ie(pe,ke,Ve){var Ke=e.unstable_now(),ar;if(typeof Ve=="object"&&Ve!==null){var Er=Ve.delay;typeof Er=="number"&&Er>0?ar=Ke+Er:ar=Ke}else ar=Ke;var rr;switch(pe){case l:rr=y;break;case c:rr=_;break;case d:rr=k;break;case h:rr=C;break;case f:default:rr=w;break}var nt=ar+rr,ur={id:F++,callback:ke,priorityLevel:pe,startTime:ar,expirationTime:nt,sortIndex:-1};return ar>Ke?(ur.sortIndex=ar,n(U,ur),a(D)===null&&ur===a(U)&&(ue?J():ue=!0,Z(re,ar-Ke))):(ur.sortIndex=nt,n(D,ur),!G&&!B&&(G=!0,je(T))),ur}function le(){}function X(){!G&&!B&&(G=!0,je(T))}function Q(){return a(D)}function be(pe){pe.callback=null}function ee(){return P}var Ie=!1,Te=null,Ye=-1,Be=t,Ee=-1;function xr(){var pe=e.unstable_now()-Ee;return!(pe<Be)}function Wr(){}function $r(pe){if(pe<0||pe>125){console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported");return}pe>0?Be=Math.floor(1e3/pe):Be=t}var Nr=function(){if(Te!==null){var pe=e.unstable_now();Ee=pe;var ke=!0,Ve=!0;try{Ve=Te(ke,pe)}finally{Ve?Tr():(Ie=!1,Te=null)}}else Ie=!1},Tr;if(typeof fe=="function")Tr=function(){fe(Nr)};else if(typeof MessageChannel<"u"){var Yr=new MessageChannel,Ne=Yr.port2;Yr.port1.onmessage=Nr,Tr=function(){Ne.postMessage(null)}}else Tr=function(){oe(Nr,0)};function je(pe){Te=pe,Ie||(Ie=!0,Tr())}function Z(pe,ke){Ye=oe(function(){pe(e.unstable_now())},ke)}function J(){he(Ye),Ye=-1}var xe=Wr,Le=null;e.unstable_IdlePriority=d,e.unstable_ImmediatePriority=l,e.unstable_LowPriority=h,e.unstable_NormalPriority=f,e.unstable_Profiling=Le,e.unstable_UserBlockingPriority=c,e.unstable_cancelCallback=be,e.unstable_continueExecution=X,e.unstable_forceFrameRate=$r,e.unstable_getCurrentPriorityLevel=ee,e.unstable_getFirstCallbackNode=Q,e.unstable_next=I,e.unstable_pauseExecution=le,e.unstable_requestPaint=xe,e.unstable_runWithPriority=V,e.unstable_scheduleCallback=ie,e.unstable_shouldYield=xr,e.unstable_wrapCallback=Y,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error})(nm)),nm}}var vy;function foe(){return vy||(vy=1,tm.exports=ZV()),tm.exports}const JV="modulepreload",eM=function(e){return"/"+e},xy={},vi=function(r,t,n){let a=Promise.resolve();if(t&&t.length>0){let s=function(l){return Promise.all(l.map(c=>Promise.resolve(c).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=o?.nonce||o?.getAttribute("nonce");a=s(t.map(l=>{if(l=eM(l),l in xy)return;xy[l]=!0;const c=l.endsWith(".css"),f=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":JV,c||(h.as="script"),h.crossOrigin="",h.href=l,u&&h.setAttribute("nonce",u),document.head.appendChild(h),c)return new Promise((d,v)=>{h.addEventListener("load",d),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return r().catch(i)})},gy=768;function rM(){const[e,r]=W.useState(void 0),[t,n]=W.useState(!1),[a,i]=W.useState("portrait");return W.useEffect(()=>{const s=window.matchMedia(`(max-width: ${gy-1}px)`),o=window.matchMedia("(orientation: portrait)"),u=()=>{r(window.innerWidth<gy),i(o.matches?"portrait":"landscape")},l=()=>{n("ontouchstart"in window||navigator.maxTouchPoints>0)};return s.addEventListener("change",u),o.addEventListener("change",u),u(),l(),()=>{s.removeEventListener("change",u),o.removeEventListener("change",u)}},[]),{isMobile:!!e,isTouch:t,orientation:a}}function tM(){const[e,r]=W.useState([]),t=W.useCallback(l=>{const c=Math.random().toString(36).substr(2,9),f=l.type==="error"?7e3:5e3,h={...l,id:c,duration:l.duration||f};return r(d=>[...d,h]),h.duration!==0&&setTimeout(()=>{n(c)},h.duration),c},[]),n=W.useCallback(l=>{r(c=>c.filter(f=>f.id!==l))},[]),a=W.useCallback(()=>{r([])},[]),i=W.useCallback((l,c,f)=>t({type:"success",message:l,title:c||"Success",duration:f}),[t]),s=W.useCallback((l,c,f)=>t({type:"error",message:l,title:c||"Error",duration:f}),[t]),o=W.useCallback((l,c,f)=>t({type:"info",message:l,title:c||"Info",duration:f}),[t]),u=W.useCallback((l,c,f)=>t({type:"warning",message:l,title:c||"Warning",duration:f}),[t]);return{notifications:e,addNotification:t,removeNotification:n,clearAllNotifications:a,showSuccess:i,showError:s,showInfo:o,showWarning:u}}const Ii=class Ii{constructor(){er(this,"storage",new Map);er(this,"useLocalStorage");er(this,"warnings",new Set);this.useLocalStorage=this.checkLocalStorageAvailability(),this.useLocalStorage||console.warn("SafeLocalStorage: localStorage is unavailable. Using in-memory fallback storage. Data will not persist across page reloads.")}static getInstance(){return Ii.instance||(Ii.instance=new Ii),Ii.instance}checkLocalStorageAvailability(){try{if(typeof window>"u"||!("localStorage"in window))return!1;const r=window.localStorage,t="__safe_storage_test__",n="test";r.setItem(t,n);const a=r.getItem(t);return r.removeItem(t),a===n}catch{return!1}}setItem(r,t){if(this.useLocalStorage)try{localStorage.setItem(r,t);return}catch(n){this.handleStorageError(n,"setItem")}this.storage.set(r,t)}getItem(r){if(this.useLocalStorage)try{return localStorage.getItem(r)}catch(t){this.handleStorageError(t,"getItem")}return this.storage.get(r)||null}removeItem(r){if(this.useLocalStorage)try{localStorage.removeItem(r);return}catch(t){this.handleStorageError(t,"removeItem")}this.storage.delete(r)}clear(){if(this.useLocalStorage)try{localStorage.clear();return}catch(r){this.handleStorageError(r,"clear")}this.storage.clear()}keys(){if(this.useLocalStorage)try{return Object.keys(localStorage)}catch(r){this.handleStorageError(r,"keys")}return Array.from(this.storage.keys())}get length(){if(this.useLocalStorage)try{return localStorage.length}catch(r){this.handleStorageError(r,"length")}return this.storage.size}isUsingLocalStorage(){return this.useLocalStorage}async getQuotaInfo(){if("storage"in navigator&&"estimate"in navigator.storage)try{const r=await navigator.storage.estimate(),t=r.usage||0,n=r.quota||0,a=n>0?t/n*100:0;return{usage:t,quota:n,percentage:Math.round(a*100)/100}}catch(r){console.warn("SafeLocalStorage: Unable to get quota info",r)}return null}handleStorageError(r,t){const n=`${t}:${r.name}`;this.warnings.has(n)||(console.warn(`SafeLocalStorage: ${t} failed with ${r.name}. Switching to in-memory fallback storage.`,r),this.warnings.add(n)),(r.name==="QuotaExceededError"||r.name==="NS_ERROR_DOM_QUOTA_REACHED")&&console.error("SafeLocalStorage: Storage quota exceeded. Consider clearing old data or increasing storage allocation."),this.useLocalStorage&&(this.useLocalStorage=!1,console.warn("SafeLocalStorage: Permanently switched to in-memory fallback mode for this session."))}};er(Ii,"instance");let Rg=Ii;const Or=Rg.getInstance(),nM=1,aM=1e6;let am=0;function iM(){return am=(am+1)%Number.MAX_SAFE_INTEGER,am.toString()}const im=new Map,by=e=>{if(im.has(e))return;const r=setTimeout(()=>{im.delete(e),Jo({type:"REMOVE_TOAST",toastId:e})},aM);im.set(e,r)},sM=(e,r)=>{switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,nM)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(t=>t.id===r.toast.id?{...t,...r.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=r;return t?by(t):e.toasts.forEach(n=>{by(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===t||t===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return r.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(t=>t.id!==r.toastId)}}},Zu=[];let Ju={toasts:[]};function Jo(e){Ju=sM(Ju,e),Zu.forEach(r=>{r(Ju)})}function oM({...e}){const r=iM(),t=a=>Jo({type:"UPDATE_TOAST",toast:{...a,id:r}}),n=()=>Jo({type:"DISMISS_TOAST",toastId:r});return Jo({type:"ADD_TOAST",toast:{...e,id:r,open:!0,onOpenChange:a=>{a||n()}}}),{id:r,dismiss:n,update:t}}function Qc(){const[e,r]=W.useState(Ju);return W.useEffect(()=>(Zu.push(r),()=>{const t=Zu.indexOf(r);t>-1&&Zu.splice(t,1)}),[e]),{...e,toast:oM,dismiss:t=>Jo({type:"DISMISS_TOAST",toastId:t})}}const Ny=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,yy=j4,Bl=(e,r)=>t=>{var n;if(r?.variants==null)return yy(e,t?.class,t?.className);const{variants:a,defaultVariants:i}=r,s=Object.keys(a).map(l=>{const c=t?.[l],f=i?.[l];if(c===null)return null;const h=Ny(c)||Ny(f);return a[l][h]}),o=t&&Object.entries(t).reduce((l,c)=>{let[f,h]=c;return h===void 0||(l[f]=h),l},{}),u=r==null||(n=r.compoundVariants)===null||n===void 0?void 0:n.reduce((l,c)=>{let{class:f,className:h,...d}=c;return Object.entries(d).every(v=>{let[p,x]=v;return Array.isArray(x)?x.includes({...i,...o}[p]):{...i,...o}[p]===x})?[...l,f,h]:l},[]);return yy(e,s,u,t?.class,t?.className)};function Ae(...e){return XV(j4(e))}const lM=z5,L4=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(Lk,{ref:t,className:Ae("fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-[999999] flex max-h-screen w-auto flex-col items-center justify-center p-4 pointer-events-none",e),style:{maxWidth:"500px"},...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:14,columnNumber:3},void 0));L4.displayName=Lk.displayName;const uM=Bl("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-lg border-2 p-6 pr-8 shadow-xl transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-top-full data-[state=open]:slide-in-from-top-full backdrop-blur-sm",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),B4=W.forwardRef(({className:e,variant:r,...t},n)=>m.jsxDEV(Bk,{ref:n,className:Ae(uM({variant:r}),e),...t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:50,columnNumber:5},void 0));B4.displayName=Bk.displayName;const cM=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(qk,{ref:t,className:Ae("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:63,columnNumber:3},void 0));cM.displayName=qk.displayName;const q4=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(Hk,{ref:t,className:Ae("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...r,children:m.jsxDEV(oi,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:87,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:78,columnNumber:3},void 0));q4.displayName=Hk.displayName;const H4=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(zk,{ref:t,className:Ae("text-sm font-semibold",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:96,columnNumber:3},void 0));H4.displayName=zk.displayName;const z4=W.forwardRef(({className:e,...r},t)=>m.jsxDEV($k,{ref:t,className:Ae("text-sm opacity-90",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:108,columnNumber:3},void 0));z4.displayName=$k.displayName;function fM(){const{toasts:e}=Qc();return m.jsxDEV(lM,{children:[e.map(function({id:r,title:t,description:n,action:a,...i}){return m.jsxDEV(B4,{...i,children:[m.jsxDEV("div",{className:"grid gap-1",children:[t&&m.jsxDEV(H4,{children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:20,columnNumber:25},this),n&&m.jsxDEV(z4,{children:n},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:22,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:19,columnNumber:13},this),a,m.jsxDEV(q4,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:26,columnNumber:13},this)]},r,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:18,columnNumber:11},this)}),m.jsxDEV(L4,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:30,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:15,columnNumber:5},this)}const mM=Bl("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),dM=W.forwardRef(({className:e,variant:r,...t},n)=>m.jsxDEV("div",{ref:n,role:"alert",className:Ae(mM({variant:r}),e),...t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert.tsx",lineNumber:26,columnNumber:3},void 0));dM.displayName="Alert";const hM=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("h5",{ref:t,className:Ae("mb-1 font-medium leading-none tracking-tight",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert.tsx",lineNumber:39,columnNumber:3},void 0));hM.displayName="AlertTitle";const pM=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("div",{ref:t,className:Ae("text-sm [&_p]:leading-relaxed",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert.tsx",lineNumber:51,columnNumber:3},void 0));pM.displayName="AlertDescription";const pl=Bl("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-semibold ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 shadow-md hover:shadow-lg active:scale-95 min-h-[48px] touch-manipulation",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 border-3 border-primary/30 hover:border-primary/40 shadow-lg hover:shadow-xl",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 border-3 border-destructive/30 hover:border-destructive/40 shadow-lg hover:shadow-xl",outline:"border-3 border-input bg-background hover:bg-accent hover:text-accent-foreground hover:border-accent/50 shadow-md hover:shadow-lg",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 border-3 border-secondary/30 hover:border-secondary/40 shadow-md hover:shadow-lg",ghost:"hover:bg-accent hover:text-accent-foreground border-3 border-transparent hover:border-accent/20",link:"text-primary underline-offset-4 hover:underline border-3 border-transparent"},size:{default:"h-12 px-6 py-3 font-semibold min-h-[48px]",sm:"h-10 rounded-md px-4 font-medium min-h-[44px]",lg:"h-14 rounded-md px-8 font-semibold text-base min-h-[56px]",icon:"h-12 w-12 min-h-[48px] min-w-[48px]"}},defaultVariants:{variant:"default",size:"default"}}),We=W.forwardRef(({className:e,variant:r,size:t,asChild:n=!1,...a},i)=>{const s=n?Gk:"button";return m.jsxDEV(s,{className:Ae(pl({variant:r,size:t,className:e})),ref:i,...a},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/button.tsx",lineNumber:47,columnNumber:7},void 0)});We.displayName="Button";function vM({notifications:e,onRemove:r}){return e.length?m.jsxDEV("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(t=>m.jsxDEV("div",{className:`
            p-4 rounded-lg shadow-lg max-w-sm cursor-pointer transform transition-all
            ${t.type==="success"?"bg-green-50 border border-green-200 text-green-800":""}
            ${t.type==="error"?"bg-red-50 border border-red-200 text-red-800":""}
            ${t.type==="warning"?"bg-yellow-50 border border-yellow-200 text-yellow-800":""}
            ${t.type==="info"?"bg-blue-50 border border-blue-200 text-blue-800":""}
          `,onClick:()=>r(t.id),children:m.jsxDEV("div",{className:"flex justify-between items-start",children:[m.jsxDEV("div",{className:"flex-1",children:[m.jsxDEV("h4",{className:"font-medium",children:t.title},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:107,columnNumber:15},this),m.jsxDEV("p",{className:"text-sm mt-1",children:t.message},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:108,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:106,columnNumber:13},this),m.jsxDEV("button",{onClick:n=>{n.stopPropagation(),r(t.id)},className:"ml-2 text-gray-400 hover:text-gray-600",children:"Ã—"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:110,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:105,columnNumber:11},this)},t.id,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:94,columnNumber:9},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:92,columnNumber:5},this):null}const xM=Bl("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function yr({className:e,variant:r,...t}){return m.jsxDEV("div",{className:Ae(xM({variant:r}),e),...t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/badge.tsx",lineNumber:34,columnNumber:5},this)}const qe=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("div",{ref:t,className:Ae("rounded-lg border-2 bg-card text-card-foreground shadow-md transition-all duration-300","[@media(hover:hover)_and_(pointer:fine)]:hover:-translate-y-1 [@media(hover:hover)_and_(pointer:fine)]:hover:shadow-xl",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:8,columnNumber:3},void 0));qe.displayName="Card";const Qe=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("div",{ref:t,className:Ae("flex flex-col space-y-1.5 p-6 bg-gradient-to-r from-primary/5 to-accent/5 border-b border-border/50",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:24,columnNumber:3},void 0));Qe.displayName="CardHeader";const Ze=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("h3",{ref:t,className:Ae("text-2xl font-bold leading-none tracking-tight text-foreground",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:36,columnNumber:3},void 0));Ze.displayName="CardTitle";const mr=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("p",{ref:t,className:Ae("text-sm text-muted-foreground",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:51,columnNumber:3},void 0));mr.displayName="CardDescription";const He=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("div",{ref:t,className:Ae("p-6 pt-0",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:63,columnNumber:3},void 0));He.displayName="CardContent";const gM=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("div",{ref:t,className:Ae("flex items-center p-6 pt-0",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:71,columnNumber:3},void 0));gM.displayName="CardFooter";function bM({className:e}){const[r,t]=W.useState(navigator.onLine),[n,a]=W.useState([]),[i,s]=W.useState(!1);W.useEffect(()=>{const f=()=>t(!0),h=()=>t(!1);return window.addEventListener("online",f),window.addEventListener("offline",h),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",d=>{d.data.type==="FORM_SYNC_SUCCESS"&&a(v=>v.filter(p=>p.id!==d.data.formId))}),o(),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",h)}},[]);const o=async()=>{if("serviceWorker"in navigator&&navigator.serviceWorker.controller){const f=new MessageChannel;f.port1.onmessage=h=>{if(h.data.type==="OFFLINE_FORMS_RESPONSE"){const d=Object.values(h.data.forms);a(d)}},navigator.serviceWorker.controller.postMessage({type:"GET_OFFLINE_FORMS"},[f.port2])}},u=()=>r?n.length>0?m.jsxDEV(P1,{className:"w-4 h-4 text-yellow-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:72,columnNumber:9},this):m.jsxDEV(Pn,{className:"w-4 h-4 text-green-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:74,columnNumber:9},this):m.jsxDEV(Wk,{className:"w-4 h-4 text-red-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:77,columnNumber:12},this),l=()=>r?n.length>0?`${n.length} form${n.length>1?"s":""} pending sync`:"Online":"Offline",c=()=>r?n.length>0?"secondary":"default":"destructive";return r&&n.length===0?null:m.jsxDEV("div",{className:e,children:m.jsxDEV(qe,{className:"border-l-4 border-l-blue-500",children:m.jsxDEV(He,{className:"p-3",children:[m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("div",{className:"flex items-center space-x-2",children:[u(),m.jsxDEV("span",{className:"text-sm font-medium",children:l()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:107,columnNumber:15},this),n.length>0&&m.jsxDEV(yr,{variant:c(),className:"text-xs",children:n.length},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:109,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:105,columnNumber:13},this),n.length>0&&m.jsxDEV(We,{variant:"ghost",size:"sm",onClick:()=>s(!i),className:"text-xs",children:i?"Hide":"Details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:116,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:104,columnNumber:11},this),i&&n.length>0&&m.jsxDEV("div",{className:"mt-3 space-y-2",children:[m.jsxDEV("div",{className:"text-xs text-muted-foreground",children:"Forms saved offline will be submitted when connection is restored:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:129,columnNumber:15},this),n.map(f=>m.jsxDEV("div",{className:"flex items-center justify-between p-2 bg-muted rounded text-xs",children:[m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(Ut,{className:"w-3 h-3 text-yellow-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:135,columnNumber:21},this),m.jsxDEV("span",{children:[f.data.school," - ",new Date(f.timestamp).toLocaleTimeString()]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:136,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:134,columnNumber:19},this),m.jsxDEV(yr,{variant:"outline",className:"text-xs",children:f.retryCount>0?`Retry ${f.retryCount}`:"Pending"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:140,columnNumber:19},this)]},f.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:133,columnNumber:17},this))]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:128,columnNumber:13},this),!r&&m.jsxDEV("div",{className:"mt-2 text-xs text-muted-foreground",children:"Your forms are being saved locally and will sync when you're back online."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:149,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:103,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:102,columnNumber:7},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:101,columnNumber:5},this)}function NM({notifications:e,onRemove:r,maxNotifications:t=5}){const[n,a]=W.useState([]);W.useEffect(()=>{const u=[...e].sort((l,c)=>c.timestamp.getTime()-l.timestamp.getTime()).slice(0,t);a(u),u.forEach(l=>{if(!l.persistent&&l.duration!==0){const c=l.duration||5e3;setTimeout(()=>{r(l.id)},c)}})},[e,r,t]);const i=u=>{switch(u){case"success":return m.jsxDEV(Pn,{className:"w-5 h-5 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:58,columnNumber:16},this);case"error":return m.jsxDEV(Ut,{className:"w-5 h-5 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:60,columnNumber:16},this);case"warning":return m.jsxDEV(Ut,{className:"w-5 h-5 text-yellow-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:62,columnNumber:16},this);case"info":return m.jsxDEV(ly,{className:"w-5 h-5 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:64,columnNumber:16},this);case"offline":return m.jsxDEV(Wk,{className:"w-5 h-5 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:66,columnNumber:16},this);case"sync":return m.jsxDEV(Yk,{className:"w-5 h-5 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:68,columnNumber:16},this);default:return m.jsxDEV(ly,{className:"w-5 h-5 text-gray-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:70,columnNumber:16},this)}},s=u=>{switch(u){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-yellow-50 border-yellow-200";case"info":return"bg-blue-50 border-blue-200";case"offline":return"bg-orange-50 border-orange-200";case"sync":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}},o=u=>{switch(u){case"success":return"text-green-900";case"error":return"text-red-900";case"warning":return"text-yellow-900";case"info":return"text-blue-900";case"offline":return"text-orange-900";case"sync":return"text-blue-900";default:return"text-gray-900"}};return n.length===0?null:m.jsxDEV("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm w-full",children:n.map(u=>m.jsxDEV("div",{className:`relative p-4 rounded-lg border shadow-lg transition-all duration-300 transform animate-in slide-in-from-right-full ${s(u.type)}`,children:m.jsxDEV("div",{className:"flex items-start space-x-3",children:[m.jsxDEV("div",{className:"flex-shrink-0",children:i(u.type)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:124,columnNumber:13},this),m.jsxDEV("div",{className:"flex-1 min-w-0",children:[m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("h4",{className:`text-sm font-semibold ${o(u.type)}`,children:u.title},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:130,columnNumber:17},this),m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV("span",{className:"text-xs text-muted-foreground",children:u.timestamp.toLocaleTimeString()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:134,columnNumber:19},this),m.jsxDEV(We,{variant:"ghost",size:"sm",onClick:()=>r(u.id),className:"h-6 w-6 p-0 hover:bg-black/10",children:m.jsxDEV(oi,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:143,columnNumber:21},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:137,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:133,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:129,columnNumber:15},this),m.jsxDEV("p",{className:`text-sm mt-1 ${o(u.type)} opacity-90`,children:u.message},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:148,columnNumber:15},this),u.actions&&u.actions.length>0&&m.jsxDEV("div",{className:"flex space-x-2 mt-3",children:u.actions.map((l,c)=>m.jsxDEV(We,{variant:l.variant||"outline",size:"sm",onClick:l.action,className:"text-xs h-7",children:l.label},c,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:155,columnNumber:21},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:153,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:128,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:123,columnNumber:11},this)},u.id,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:119,columnNumber:9},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:117,columnNumber:5},this)}function yM(){const[e,r]=W.useState([]),t=f=>{const h={...f,id:`notification_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date};return r(d=>[...d,h]),h.id};return{notifications:e,addNotification:t,removeNotification:f=>{r(h=>h.filter(d=>d.id!==f))},clearAllNotifications:()=>{r([])},showSuccess:(f,h,d)=>t({type:"success",title:f,message:h,...d}),showError:(f,h,d)=>t({type:"error",title:f,message:h,persistent:!0,...d}),showWarning:(f,h,d)=>t({type:"warning",title:f,message:h,...d}),showInfo:(f,h,d)=>t({type:"info",title:f,message:h,...d}),showOffline:(f,h,d)=>t({type:"offline",title:f,message:h,persistent:!0,...d}),showSync:(f,h,d)=>t({type:"sync",title:f,message:h,...d})}}var Zc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Jc=typeof window>"u"||"Deno"in globalThis;function An(){}function CM(e,r){return typeof e=="function"?e(r):e}function EM(e){return typeof e=="number"&&e>=0&&e!==1/0}function wM(e,r){return Math.max(e+(r||0)-Date.now(),0)}function Og(e,r){return typeof e=="function"?e(r):e}function _M(e,r){return typeof e=="function"?e(r):e}function Cy(e,r){const{type:t="all",exact:n,fetchStatus:a,predicate:i,queryKey:s,stale:o}=e;if(s){if(n){if(r.queryHash!==H1(s,r.options))return!1}else if(!xl(r.queryKey,s))return!1}if(t!=="all"){const u=r.isActive();if(t==="active"&&!u||t==="inactive"&&u)return!1}return!(typeof o=="boolean"&&r.isStale()!==o||a&&a!==r.state.fetchStatus||i&&!i(r))}function Ey(e,r){const{exact:t,status:n,predicate:a,mutationKey:i}=e;if(i){if(!r.options.mutationKey)return!1;if(t){if(vl(r.options.mutationKey)!==vl(i))return!1}else if(!xl(r.options.mutationKey,i))return!1}return!(n&&r.state.status!==n||a&&!a(r))}function H1(e,r){return(r?.queryKeyHashFn||vl)(e)}function vl(e){return JSON.stringify(e,(r,t)=>Ug(t)?Object.keys(t).sort().reduce((n,a)=>(n[a]=t[a],n),{}):t)}function xl(e,r){return e===r?!0:typeof e!=typeof r?!1:e&&r&&typeof e=="object"&&typeof r=="object"?Object.keys(r).every(t=>xl(e[t],r[t])):!1}function Fg(e,r){if(e===r)return e;const t=wy(e)&&wy(r);if(t||Ug(e)&&Ug(r)){const n=t?e:Object.keys(e),a=n.length,i=t?r:Object.keys(r),s=i.length,o=t?[]:{},u=new Set(n);let l=0;for(let c=0;c<s;c++){const f=t?c:i[c];(!t&&u.has(f)||t)&&e[f]===void 0&&r[f]===void 0?(o[f]=void 0,l++):(o[f]=Fg(e[f],r[f]),o[f]===e[f]&&e[f]!==void 0&&l++)}return a===s&&l===a?e:o}return r}function wy(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Ug(e){if(!_y(e))return!1;const r=e.constructor;if(r===void 0)return!0;const t=r.prototype;return!(!_y(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function _y(e){return Object.prototype.toString.call(e)==="[object Object]"}function SM(e){return new Promise(r=>{setTimeout(r,e)})}function TM(e,r,t){if(typeof t.structuralSharing=="function")return t.structuralSharing(e,r);if(t.structuralSharing!==!1){try{return Fg(e,r)}catch(n){throw console.error(`Structural sharing requires data to be JSON serializable. To fix this, turn off structuralSharing or return JSON-serializable data from your queryFn. [${t.queryHash}]: ${n}`),n}return Fg(e,r)}return r}function DM(e,r,t=0){const n=[...e,r];return t&&n.length>t?n.slice(1):n}function AM(e,r,t=0){const n=[r,...e];return t&&n.length>t?n.slice(0,-1):n}var oc=Symbol();function $4(e,r){return e.queryFn===oc&&console.error(`Attempted to invoke queryFn when set to skipToken. This is likely a configuration error. Query hash: '${e.queryHash}'`),!e.queryFn&&r?.initialPromise?()=>r.initialPromise:!e.queryFn||e.queryFn===oc?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Li,Za,Ys,Ok,kM=(Ok=class extends Zc{constructor(){super();ir(this,Li);ir(this,Za);ir(this,Ys);$e(this,Ys,r=>{if(!Jc&&window.addEventListener){const t=()=>r();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){de(this,Za)||this.setEventListener(de(this,Ys))}onUnsubscribe(){var r;this.hasListeners()||((r=de(this,Za))==null||r.call(this),$e(this,Za,void 0))}setEventListener(r){var t;$e(this,Ys,r),(t=de(this,Za))==null||t.call(this),$e(this,Za,r(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(r){de(this,Li)!==r&&($e(this,Li,r),this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(t=>{t(r)})}isFocused(){return typeof de(this,Li)=="boolean"?de(this,Li):globalThis.document?.visibilityState!=="hidden"}},Li=new WeakMap,Za=new WeakMap,Ys=new WeakMap,Ok),G4=new kM,Ks,Ja,Xs,Fk,RM=(Fk=class extends Zc{constructor(){super();ir(this,Ks,!0);ir(this,Ja);ir(this,Xs);$e(this,Xs,r=>{if(!Jc&&window.addEventListener){const t=()=>r(!0),n=()=>r(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}})}onSubscribe(){de(this,Ja)||this.setEventListener(de(this,Xs))}onUnsubscribe(){var r;this.hasListeners()||((r=de(this,Ja))==null||r.call(this),$e(this,Ja,void 0))}setEventListener(r){var t;$e(this,Xs,r),(t=de(this,Ja))==null||t.call(this),$e(this,Ja,r(this.setOnline.bind(this)))}setOnline(r){de(this,Ks)!==r&&($e(this,Ks,r),this.listeners.forEach(n=>{n(r)}))}isOnline(){return de(this,Ks)}},Ks=new WeakMap,Ja=new WeakMap,Xs=new WeakMap,Fk),lc=new RM;function OM(){let e,r;const t=new Promise((a,i)=>{e=a,r=i});t.status="pending",t.catch(()=>{});function n(a){Object.assign(t,a),delete t.resolve,delete t.reject}return t.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},t.reject=a=>{n({status:"rejected",reason:a}),r(a)},t}function FM(e){return Math.min(1e3*2**e,3e4)}function W4(e){return(e??"online")==="online"?lc.isOnline():!0}var Y4=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function K4(e){let r=!1,t=0,n;const a=OM(),i=()=>a.status!=="pending",s=p=>{i()||(h(new Y4(p)),e.abort?.())},o=()=>{r=!0},u=()=>{r=!1},l=()=>G4.isFocused()&&(e.networkMode==="always"||lc.isOnline())&&e.canRun(),c=()=>W4(e.networkMode)&&e.canRun(),f=p=>{i()||(n?.(),a.resolve(p))},h=p=>{i()||(n?.(),a.reject(p))},d=()=>new Promise(p=>{n=x=>{(i()||l())&&p(x)},e.onPause?.()}).then(()=>{n=void 0,i()||e.onContinue?.()}),v=()=>{if(i())return;let p;const x=t===0?e.initialPromise:void 0;try{p=x??e.fn()}catch(g){p=Promise.reject(g)}Promise.resolve(p).then(f).catch(g=>{if(i())return;const N=e.retry??(Jc?0:3),b=e.retryDelay??FM,y=typeof b=="function"?b(t,g):b,_=N===!0||typeof N=="number"&&t<N||typeof N=="function"&&N(t,g);if(r||!_){h(g);return}t++,e.onFail?.(t,g),SM(y).then(()=>l()?void 0:d()).then(()=>{r?h(g):v()})})};return{promise:a,status:()=>a.status,cancel:s,continue:()=>(n?.(),a),cancelRetry:o,continueRetry:u,canStart:c,start:()=>(c()?v():d().then(v),a)}}var UM=e=>setTimeout(e,0);function IM(){let e=[],r=0,t=o=>{o()},n=o=>{o()},a=UM;const i=o=>{r?e.push(o):a(()=>{t(o)})},s=()=>{const o=e;e=[],o.length&&a(()=>{n(()=>{o.forEach(u=>{t(u)})})})};return{batch:o=>{let u;r++;try{u=o()}finally{r--,r||s()}return u},batchCalls:o=>(...u)=>{i(()=>{o(...u)})},schedule:i,setNotifyFunction:o=>{t=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var Ot=IM(),Bi,Uk,X4=(Uk=class{constructor(){ir(this,Bi)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),EM(this.gcTime)&&$e(this,Bi,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Jc?1/0:300*1e3))}clearGcTimeout(){de(this,Bi)&&(clearTimeout(de(this,Bi)),$e(this,Bi,void 0))}},Bi=new WeakMap,Uk),Qs,Zs,dn,qi,ot,Ml,Hi,kn,ba,Ik,PM=(Ik=class extends X4{constructor(r){super();ir(this,kn);ir(this,Qs);ir(this,Zs);ir(this,dn);ir(this,qi);ir(this,ot);ir(this,Ml);ir(this,Hi);$e(this,Hi,!1),$e(this,Ml,r.defaultOptions),this.setOptions(r.options),this.observers=[],$e(this,qi,r.client),$e(this,dn,de(this,qi).getQueryCache()),this.queryKey=r.queryKey,this.queryHash=r.queryHash,$e(this,Qs,MM(this.options)),this.state=r.state??de(this,Qs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){return de(this,ot)?.promise}setOptions(r){this.options={...de(this,Ml),...r},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&de(this,dn).remove(this)}setData(r,t){const n=TM(this.state.data,r,this.options);return Et(this,kn,ba).call(this,{data:n,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),n}setState(r,t){Et(this,kn,ba).call(this,{type:"setState",state:r,setStateOptions:t})}cancel(r){const t=de(this,ot)?.promise;return de(this,ot)?.cancel(r),t?t.then(An).catch(An):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(de(this,Qs))}isActive(){return this.observers.some(r=>_M(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===oc||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(r=>Og(r.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(r=0){return this.state.data===void 0?!0:r==="static"?!1:this.state.isInvalidated?!0:!wM(this.state.dataUpdatedAt,r)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),de(this,ot)?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),de(this,ot)?.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),de(this,dn).notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(t=>t!==r),this.observers.length||(de(this,ot)&&(de(this,Hi)?de(this,ot).cancel({revert:!0}):de(this,ot).cancelRetry()),this.scheduleGc()),de(this,dn).notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Et(this,kn,ba).call(this,{type:"invalidate"})}async fetch(r,t){if(this.state.fetchStatus!=="idle"&&de(this,ot)?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(de(this,ot))return de(this,ot).continueRetry(),de(this,ot).promise}if(r&&this.setOptions(r),!this.options.queryFn){const u=this.observers.find(l=>l.options.queryFn);u&&this.setOptions(u.options)}Array.isArray(this.options.queryKey)||console.error("As of v4, queryKey needs to be an Array. If you are using a string like 'repoData', please change it to an Array, e.g. ['repoData']");const n=new AbortController,a=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>($e(this,Hi,!0),n.signal)})},i=()=>{const u=$4(this.options,t),c=(()=>{const f={client:de(this,qi),queryKey:this.queryKey,meta:this.meta};return a(f),f})();return $e(this,Hi,!1),this.options.persister?this.options.persister(u,c,this):u(c)},o=(()=>{const u={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:de(this,qi),state:this.state,fetchFn:i};return a(u),u})();this.options.behavior?.onFetch(o,this),$e(this,Zs,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&Et(this,kn,ba).call(this,{type:"fetch",meta:o.fetchOptions?.meta}),$e(this,ot,K4({initialPromise:t?.initialPromise,fn:o.fetchFn,abort:n.abort.bind(n),onFail:(u,l)=>{Et(this,kn,ba).call(this,{type:"failed",failureCount:u,error:l})},onPause:()=>{Et(this,kn,ba).call(this,{type:"pause"})},onContinue:()=>{Et(this,kn,ba).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const u=await de(this,ot).start();if(u===void 0)throw console.error(`Query data cannot be undefined. Please make sure to return a value other than undefined from your query function. Affected query key: ${this.queryHash}`),new Error(`${this.queryHash} data is undefined`);return this.setData(u),de(this,dn).config.onSuccess?.(u,this),de(this,dn).config.onSettled?.(u,this.state.error,this),u}catch(u){if(u instanceof Y4){if(u.silent)return de(this,ot).promise;if(u.revert){if(this.setState({...de(this,Zs),fetchStatus:"idle"}),this.state.data===void 0)throw u;return this.state.data}}throw Et(this,kn,ba).call(this,{type:"error",error:u}),de(this,dn).config.onError?.(u,this),de(this,dn).config.onSettled?.(this.state.data,u,this),u}finally{this.scheduleGc()}}},Qs=new WeakMap,Zs=new WeakMap,dn=new WeakMap,qi=new WeakMap,ot=new WeakMap,Ml=new WeakMap,Hi=new WeakMap,kn=new WeakSet,ba=function(r){const t=n=>{switch(r.type){case"failed":return{...n,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...VM(n.data,this.options),fetchMeta:r.meta??null};case"success":const a={...n,data:r.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:r.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return $e(this,Zs,r.manual?a:void 0),a;case"error":const i=r.error;return{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...r.state}}};this.state=t(this.state),Ot.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),de(this,dn).notify({query:this,type:"updated",action:r})})},Ik);function VM(e,r){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:W4(r.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function MM(e){const r=typeof e.initialData=="function"?e.initialData():e.initialData,t=r!==void 0,n=t?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:r,dataUpdateCount:0,dataUpdatedAt:t?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var Xn,Pk,jM=(Pk=class extends Zc{constructor(r={}){super();ir(this,Xn);this.config=r,$e(this,Xn,new Map)}build(r,t,n){const a=t.queryKey,i=t.queryHash??H1(a,t);let s=this.get(i);return s||(s=new PM({client:r,queryKey:a,queryHash:i,options:r.defaultQueryOptions(t),state:n,defaultOptions:r.getQueryDefaults(a)}),this.add(s)),s}add(r){de(this,Xn).has(r.queryHash)||(de(this,Xn).set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const t=de(this,Xn).get(r.queryHash);t&&(r.destroy(),t===r&&de(this,Xn).delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){Ot.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return de(this,Xn).get(r)}getAll(){return[...de(this,Xn).values()]}find(r){const t={exact:!0,...r};return this.getAll().find(n=>Cy(t,n))}findAll(r={}){const t=this.getAll();return Object.keys(r).length>0?t.filter(n=>Cy(r,n)):t}notify(r){Ot.batch(()=>{this.listeners.forEach(t=>{t(r)})})}onFocus(){Ot.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){Ot.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},Xn=new WeakMap,Pk),Qn,At,zi,Zn,Ka,Vk,LM=(Vk=class extends X4{constructor(r){super();ir(this,Zn);ir(this,Qn);ir(this,At);ir(this,zi);this.mutationId=r.mutationId,$e(this,At,r.mutationCache),$e(this,Qn,[]),this.state=r.state||BM(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){de(this,Qn).includes(r)||(de(this,Qn).push(r),this.clearGcTimeout(),de(this,At).notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){$e(this,Qn,de(this,Qn).filter(t=>t!==r)),this.scheduleGc(),de(this,At).notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){de(this,Qn).length||(this.state.status==="pending"?this.scheduleGc():de(this,At).remove(this))}continue(){return de(this,zi)?.continue()??this.execute(this.state.variables)}async execute(r){const t=()=>{Et(this,Zn,Ka).call(this,{type:"continue"})};$e(this,zi,K4({fn:()=>this.options.mutationFn?this.options.mutationFn(r):Promise.reject(new Error("No mutationFn found")),onFail:(i,s)=>{Et(this,Zn,Ka).call(this,{type:"failed",failureCount:i,error:s})},onPause:()=>{Et(this,Zn,Ka).call(this,{type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>de(this,At).canRun(this)}));const n=this.state.status==="pending",a=!de(this,zi).canStart();try{if(n)t();else{Et(this,Zn,Ka).call(this,{type:"pending",variables:r,isPaused:a}),await de(this,At).config.onMutate?.(r,this);const s=await this.options.onMutate?.(r);s!==this.state.context&&Et(this,Zn,Ka).call(this,{type:"pending",context:s,variables:r,isPaused:a})}const i=await de(this,zi).start();return await de(this,At).config.onSuccess?.(i,r,this.state.context,this),await this.options.onSuccess?.(i,r,this.state.context),await de(this,At).config.onSettled?.(i,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(i,null,r,this.state.context),Et(this,Zn,Ka).call(this,{type:"success",data:i}),i}catch(i){try{throw await de(this,At).config.onError?.(i,r,this.state.context,this),await this.options.onError?.(i,r,this.state.context),await de(this,At).config.onSettled?.(void 0,i,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,i,r,this.state.context),i}finally{Et(this,Zn,Ka).call(this,{type:"error",error:i})}}finally{de(this,At).runNext(this)}}},Qn=new WeakMap,At=new WeakMap,zi=new WeakMap,Zn=new WeakSet,Ka=function(r){const t=n=>{switch(r.type){case"failed":return{...n,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...n,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:r.error,failureCount:n.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Ot.batch(()=>{de(this,Qn).forEach(n=>{n.onMutationUpdate(r)}),de(this,At).notify({mutation:this,type:"updated",action:r})})},Vk);function BM(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ya,Rn,jl,Mk,qM=(Mk=class extends Zc{constructor(r={}){super();ir(this,ya);ir(this,Rn);ir(this,jl);this.config=r,$e(this,ya,new Set),$e(this,Rn,new Map),$e(this,jl,0)}build(r,t,n){const a=new LM({mutationCache:this,mutationId:++yu(this,jl)._,options:r.defaultMutationOptions(t),state:n});return this.add(a),a}add(r){de(this,ya).add(r);const t=Cu(r);if(typeof t=="string"){const n=de(this,Rn).get(t);n?n.push(r):de(this,Rn).set(t,[r])}this.notify({type:"added",mutation:r})}remove(r){if(de(this,ya).delete(r)){const t=Cu(r);if(typeof t=="string"){const n=de(this,Rn).get(t);if(n)if(n.length>1){const a=n.indexOf(r);a!==-1&&n.splice(a,1)}else n[0]===r&&de(this,Rn).delete(t)}}this.notify({type:"removed",mutation:r})}canRun(r){const t=Cu(r);if(typeof t=="string"){const a=de(this,Rn).get(t)?.find(i=>i.state.status==="pending");return!a||a===r}else return!0}runNext(r){const t=Cu(r);return typeof t=="string"?de(this,Rn).get(t)?.find(a=>a!==r&&a.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Ot.batch(()=>{de(this,ya).forEach(r=>{this.notify({type:"removed",mutation:r})}),de(this,ya).clear(),de(this,Rn).clear()})}getAll(){return Array.from(de(this,ya))}find(r){const t={exact:!0,...r};return this.getAll().find(n=>Ey(t,n))}findAll(r={}){return this.getAll().filter(t=>Ey(r,t))}notify(r){Ot.batch(()=>{this.listeners.forEach(t=>{t(r)})})}resumePausedMutations(){const r=this.getAll().filter(t=>t.state.isPaused);return Ot.batch(()=>Promise.all(r.map(t=>t.continue().catch(An))))}},ya=new WeakMap,Rn=new WeakMap,jl=new WeakMap,Mk);function Cu(e){return e.options.scope?.id}function Sy(e){return{onFetch:(r,t)=>{const n=r.options,a=r.fetchOptions?.meta?.fetchMore?.direction,i=r.state.data?.pages||[],s=r.state.data?.pageParams||[];let o={pages:[],pageParams:[]},u=0;const l=async()=>{let c=!1;const f=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(r.signal.aborted?c=!0:r.signal.addEventListener("abort",()=>{c=!0}),r.signal)})},h=$4(r.options,r.fetchOptions),d=async(v,p,x)=>{if(c)return Promise.reject();if(p==null&&v.pages.length)return Promise.resolve(v);const N=(()=>{const w={client:r.client,queryKey:r.queryKey,pageParam:p,direction:x?"backward":"forward",meta:r.options.meta};return f(w),w})(),b=await h(N),{maxPages:y}=r.options,_=x?AM:DM;return{pages:_(v.pages,b,y),pageParams:_(v.pageParams,p,y)}};if(a&&i.length){const v=a==="backward",p=v?HM:Ty,x={pages:i,pageParams:s},g=p(n,x);o=await d(x,g,v)}else{const v=e??i.length;do{const p=u===0?s[0]??n.initialPageParam:Ty(n,o);if(u>0&&p==null)break;o=await d(o,p),u++}while(u<v)}return o};r.options.persister?r.fetchFn=()=>r.options.persister?.(l,{client:r.client,queryKey:r.queryKey,meta:r.options.meta,signal:r.signal},t):r.fetchFn=l}}}function Ty(e,{pages:r,pageParams:t}){const n=r.length-1;return r.length>0?e.getNextPageParam(r[n],r,t[n],t):void 0}function HM(e,{pages:r,pageParams:t}){return r.length>0?e.getPreviousPageParam?.(r[0],r,t[0],t):void 0}var jr,ei,ri,Js,eo,ti,ro,to,jk,zM=(jk=class{constructor(e={}){ir(this,jr);ir(this,ei);ir(this,ri);ir(this,Js);ir(this,eo);ir(this,ti);ir(this,ro);ir(this,to);$e(this,jr,e.queryCache||new jM),$e(this,ei,e.mutationCache||new qM),$e(this,ri,e.defaultOptions||{}),$e(this,Js,new Map),$e(this,eo,new Map),$e(this,ti,0)}mount(){yu(this,ti)._++,de(this,ti)===1&&($e(this,ro,G4.subscribe(async e=>{e&&(await this.resumePausedMutations(),de(this,jr).onFocus())})),$e(this,to,lc.subscribe(async e=>{e&&(await this.resumePausedMutations(),de(this,jr).onOnline())})))}unmount(){var e,r;yu(this,ti)._--,de(this,ti)===0&&((e=de(this,ro))==null||e.call(this),$e(this,ro,void 0),(r=de(this,to))==null||r.call(this),$e(this,to,void 0))}isFetching(e){return de(this,jr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return de(this,ei).findAll({...e,status:"pending"}).length}getQueryData(e){const r=this.defaultQueryOptions({queryKey:e});return de(this,jr).get(r.queryHash)?.state.data}ensureQueryData(e){const r=this.defaultQueryOptions(e),t=de(this,jr).build(this,r),n=t.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&t.isStaleByTime(Og(r.staleTime,t))&&this.prefetchQuery(r),Promise.resolve(n))}getQueriesData(e){return de(this,jr).findAll(e).map(({queryKey:r,state:t})=>{const n=t.data;return[r,n]})}setQueryData(e,r,t){const n=this.defaultQueryOptions({queryKey:e}),i=de(this,jr).get(n.queryHash)?.state.data,s=CM(r,i);if(s!==void 0)return de(this,jr).build(this,n).setData(s,{...t,manual:!0})}setQueriesData(e,r,t){return Ot.batch(()=>de(this,jr).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,r,t)]))}getQueryState(e){const r=this.defaultQueryOptions({queryKey:e});return de(this,jr).get(r.queryHash)?.state}removeQueries(e){const r=de(this,jr);Ot.batch(()=>{r.findAll(e).forEach(t=>{r.remove(t)})})}resetQueries(e,r){const t=de(this,jr);return Ot.batch(()=>(t.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},r)))}cancelQueries(e,r={}){const t={revert:!0,...r},n=Ot.batch(()=>de(this,jr).findAll(e).map(a=>a.cancel(t)));return Promise.all(n).then(An).catch(An)}invalidateQueries(e,r={}){return Ot.batch(()=>(de(this,jr).findAll(e).forEach(t=>{t.invalidate()}),e?.refetchType==="none"?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},r)))}refetchQueries(e,r={}){const t={...r,cancelRefetch:r.cancelRefetch??!0},n=Ot.batch(()=>de(this,jr).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,t);return t.throwOnError||(i=i.catch(An)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(An)}fetchQuery(e){const r=this.defaultQueryOptions(e);r.retry===void 0&&(r.retry=!1);const t=de(this,jr).build(this,r);return t.isStaleByTime(Og(r.staleTime,t))?t.fetch(r):Promise.resolve(t.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(An).catch(An)}fetchInfiniteQuery(e){return e.behavior=Sy(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(An).catch(An)}ensureInfiniteQueryData(e){return e.behavior=Sy(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return lc.isOnline()?de(this,ei).resumePausedMutations():Promise.resolve()}getQueryCache(){return de(this,jr)}getMutationCache(){return de(this,ei)}getDefaultOptions(){return de(this,ri)}setDefaultOptions(e){$e(this,ri,e)}setQueryDefaults(e,r){de(this,Js).set(vl(e),{queryKey:e,defaultOptions:r})}getQueryDefaults(e){const r=[...de(this,Js).values()],t={};return r.forEach(n=>{xl(e,n.queryKey)&&Object.assign(t,n.defaultOptions)}),t}setMutationDefaults(e,r){de(this,eo).set(vl(e),{mutationKey:e,defaultOptions:r})}getMutationDefaults(e){const r=[...de(this,eo).values()],t={};return r.forEach(n=>{xl(e,n.mutationKey)&&Object.assign(t,n.defaultOptions)}),t}defaultQueryOptions(e){if(e._defaulted)return e;const r={...de(this,ri).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return r.queryHash||(r.queryHash=H1(r.queryKey,r)),r.refetchOnReconnect===void 0&&(r.refetchOnReconnect=r.networkMode!=="always"),r.throwOnError===void 0&&(r.throwOnError=!!r.suspense),!r.networkMode&&r.persister&&(r.networkMode="offlineFirst"),r.queryFn===oc&&(r.enabled=!1),r}defaultMutationOptions(e){return e?._defaulted?e:{...de(this,ri).mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){de(this,jr).clear(),de(this,ei).clear()}},jr=new WeakMap,ei=new WeakMap,ri=new WeakMap,Js=new WeakMap,eo=new WeakMap,ti=new WeakMap,ro=new WeakMap,to=new WeakMap,jk);function $M(e,r){if(e instanceof RegExp)return{keys:!1,pattern:e};var t,n,a,i,s=[],o="",u=e.split("/");for(u[0]||u.shift();a=u.shift();)t=a[0],t==="*"?(s.push(t),o+=a[1]==="?"?"(?:/(.*))?":"/(.*)"):t===":"?(n=a.indexOf("?",1),i=a.indexOf(".",1),s.push(a.substring(1,~n?n:~i?i:a.length)),o+=~n&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(o+=(~n?"?":"")+"\\"+a.substring(i))):o+="/"+a;return{keys:s,pattern:new RegExp("^"+o+(r?"(?=$|/)":"/?$"),"i")}}var sm={exports:{}},om={},Dy;function GM(){if(Dy)return om;Dy=1;/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return(function(){function e(d,v){return d===v&&(d!==0||1/d===1/v)||d!==d&&v!==v}function r(d,v){c||a.startTransition===void 0||(c=!0,console.error("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var p=v();if(!f){var x=v();i(p,x)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),f=!0)}x=s({inst:{value:p,getSnapshot:v}});var g=x[0].inst,N=x[1];return u(function(){g.value=p,g.getSnapshot=v,t(g)&&N({inst:g})},[d,p,v]),o(function(){return t(g)&&N({inst:g}),d(function(){t(g)&&N({inst:g})})},[d]),l(p),p}function t(d){var v=d.getSnapshot;d=d.value;try{var p=v();return!i(d,p)}catch{return!0}}function n(d,v){return v()}typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var a=$5(),i=typeof Object.is=="function"?Object.is:e,s=a.useState,o=a.useEffect,u=a.useLayoutEffect,l=a.useDebugValue,c=!1,f=!1,h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?n:r;om.useSyncExternalStore=a.useSyncExternalStore!==void 0?a.useSyncExternalStore:h,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())})(),om}var Ay;function WM(){return Ay||(Ay=1,sm.exports=GM()),sm.exports}var YM=WM();const KM="popstate",z1="pushState",$1="replaceState",XM="hashchange",ky=[KM,z1,$1,XM],QM=e=>{for(const r of ky)addEventListener(r,e);return()=>{for(const r of ky)removeEventListener(r,e)}},Q4=(e,r)=>YM.useSyncExternalStore(QM,e,r),ZM=()=>location.search,JM=({ssrSearch:e=""}={})=>Q4(ZM,()=>e),Ry=()=>location.pathname,ej=({ssrPath:e}={})=>Q4(Ry,e?()=>e:Ry),rj=(e,{replace:r=!1,state:t=null}={})=>history[r?$1:z1](t,"",e),tj=(e={})=>[ej(e),rj],Oy=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Oy]>"u"){for(const e of[z1,$1]){const r=history[e];history[e]=function(){const t=r.apply(this,arguments),n=new Event(e);return n.arguments=arguments,dispatchEvent(n),t}}Object.defineProperty(window,Oy,{value:!0})}const nj=(e,r)=>r.toLowerCase().indexOf(e.toLowerCase())?"~"+r:r.slice(e.length)||"/",Z4=(e="")=>e==="/"?"":e,aj=(e,r)=>e[0]==="~"?e.slice(1):Z4(r)+e,ij=(e="",r)=>nj(Fy(Z4(e)),Fy(r)),Fy=e=>{try{return decodeURI(e)}catch{return e}},J4={hook:tj,searchHook:JM,parser:$M,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},eR=W.createContext(J4),G1=()=>W.useContext(eR),sj={};W.createContext(sj);const rR=e=>{const[r,t]=e.hook(e);return[ij(e.base,r),Kk((n,a)=>t(aj(n,e.base),a))]},oj=()=>rR(G1()),lj=({children:e,...r})=>{const t=G1(),n=r.hook?J4:t;let a=n;const[i,s]=r.ssrPath?.split("?")??[];s&&(r.ssrSearch=s,r.ssrPath=i),r.hrefs=r.hrefs??r.hook?.hrefs;let o=W.useRef({}),u=o.current,l=u;for(let c in n){const f=c==="base"?n[c]+(r[c]||""):r[c]||n[c];u===l&&f!==l[c]&&(o.current=l={...l}),l[c]=f,(f!==n[c]||f!==a[c])&&(a=l)}return W.createElement(eR.Provider,{value:a,children:e})};W.forwardRef((e,r)=>{const t=G1(),[n,a]=rR(t),{to:i="",href:s=i,onClick:o,asChild:u,children:l,className:c,replace:f,state:h,...d}=e,v=Kk(x=>{x.ctrlKey||x.metaKey||x.altKey||x.shiftKey||x.button!==0||(o?.(x),x.defaultPrevented||(x.preventDefault(),a(s,e)))}),p=t.hrefs(s[0]==="~"?s.slice(1):t.base+s,t);return u&&W.isValidElement(l)?W.cloneElement(l,{onClick:v,href:p}):W.createElement("a",{...d,onClick:v,href:p,className:c?.call?c(n===s):c,children:l,ref:r})});function uj(){if(typeof XMLHttpRequest<"u")return new XMLHttpRequest;try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch{throw new Error("XMLHttpRequest not supported")}}function cj(e,r={}){return new Promise(function(t,n){var a=uj(),i=r.method||"GET";if(a.open(i,e,!0),a.withCredentials=r.credentials==="include",r.headers)for(var s in r.headers)r.headers.hasOwnProperty(s)&&a.setRequestHeader(s,r.headers[s]);a.onreadystatechange=function(){if(a.readyState===4){var o={ok:a.status>=200&&a.status<300,status:a.status,statusText:a.statusText,text:function(){return Promise.resolve(a.responseText)},json:function(){try{return Promise.resolve(JSON.parse(a.responseText))}catch(u){return Promise.reject(u)}}};o.ok?t(o):n(new Error(a.status+": "+a.statusText))}},a.onerror=function(){n(new Error("Network error"))},a.send(r.body||null)})}var fj=typeof fetch<"u"?fetch:cj;function mj(e){return new Promise(function(r,t){e.ok?r(e):e.text().then(function(n){t(new Error(e.status+": "+(n||e.statusText)))})})}const dj=({on401:e})=>function({queryKey:r}){return new Promise(function(t,n){fj(r.join("/"),{credentials:"include"}).then(function(a){return mj(a).then(function(){return a.json()})}).then(t).catch(n)})},hj=new zM({defaultOptions:{queries:{queryFn:dj({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),pj=({className:e})=>{const[r]=oj(),t=[{id:"home",label:"Home",icon:G5,href:"/",active:r==="/"},{id:"inspection",label:"Inspect",icon:W5,href:"/custodial-inspection",active:r==="/custodial-inspection"},{id:"building",label:"Building",icon:xn,href:"/whole-building-inspection",active:r==="/whole-building-inspection"},{id:"data",label:"Data",icon:V1,href:"/inspection-data",active:r==="/inspection-data"},{id:"admin",label:"Admin",icon:ni,href:"/admin-inspections",active:r==="/admin-inspections"}];return m.jsxDEV("div",{className:Ae("fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50 md:hidden",e),children:[m.jsxDEV("div",{className:"grid grid-cols-5 py-2",children:t.map(n=>{const a=n.icon;return m.jsxDEV("a",{href:n.href,className:Ae("flex flex-col items-center justify-center py-2 px-1 text-xs transition-colors duration-200 touch-manipulation",n.active?"text-blue-600":"text-gray-600 hover:text-gray-900 active:scale-95"),children:[m.jsxDEV("div",{className:"relative",children:[m.jsxDEV(a,{className:Ae("h-6 w-6 transition-transform duration-200",n.active&&"scale-110")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:71,columnNumber:17},void 0),n.active&&m.jsxDEV("div",{className:"absolute -top-1 -right-1 h-2 w-2 bg-blue-600 rounded-full animate-pulse"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:78,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:70,columnNumber:15},void 0),m.jsxDEV("span",{className:Ae("mt-1 font-medium text-[10px] leading-tight",n.active&&"font-semibold"),children:n.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:81,columnNumber:15},void 0)]},n.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:60,columnNumber:13},void 0)})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:56,columnNumber:7},void 0),m.jsxDEV("div",{className:"h-safe-area-inset-bottom bg-white"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:93,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:52,columnNumber:5},void 0)},lm=({href:e,children:r,className:t})=>m.jsxDEV("a",{href:e,className:Ae("sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-blue-600 text-white px-4 py-2 rounded-md z-50 transition-all duration-200 hover:bg-blue-700",t),children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/AccessibilityEnhancements.tsx",lineNumber:13,columnNumber:5},void 0),vj=()=>({announce:(r,t="polite")=>{const n=document.createElement("div");n.setAttribute("aria-live",t),n.setAttribute("aria-atomic","true"),n.className="sr-only",n.textContent=r,document.body.appendChild(n),setTimeout(()=>{document.body.removeChild(n)},1e3)}}),xj=()=>{W.useEffect(()=>{const e=r=>{if(r.key==="Escape"){const t=document.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');t.length>0&&t[0].focus()}if(r.key==="Tab"&&r.shiftKey){const t=document.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(t.length>0){const n=t[t.length-1];document.activeElement===n&&(r.preventDefault(),t.length>1&&t[0].focus())}}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[])},gj=()=>{const e=W.useCallback(()=>{const t=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),n=[];let a=0;return t.forEach((i,s)=>{const o=parseInt(i.tagName.charAt(1));s>0&&o>a+1&&n.push(`Skipped heading level: h${a} to h${o} at "${i.textContent}"`),i.textContent?.trim()||n.push(`Empty ${i.tagName} found`),a=o}),n},[]),r=W.useCallback(()=>{const t=document.querySelectorAll("h1, h2, h3, h4, h5, h6");return Array.from(t).map(n=>({level:parseInt(n.tagName.charAt(1)),text:n.textContent?.trim()||"",id:n.id||""}))},[]);return{validateHeadingStructure:e,getHeadingOutline:r}},bj=()=>({validateImages:W.useCallback(()=>{const r=document.querySelectorAll("img"),t=[];return r.forEach((n,a)=>{const i=n.getAttribute("alt");i===null&&t.push(`Image ${a+1}: Missing alt attribute`),i===""&&!n.getAttribute("role")&&t.push(`Image ${a+1}: Decorative image should have role="presentation" or alt=""`),i&&i.length>125&&t.push(`Image ${a+1}: Alt text too long (${i.length} chars), consider using longdesc`)}),t},[])}),Nj=()=>({validateLinks:W.useCallback(()=>{const r=document.querySelectorAll("a[href]"),t=[],n=new Set;return r.forEach((a,i)=>{const s=a.textContent?.trim()||"";a.getAttribute("href"),!s&&!a.querySelector("img")&&t.push(`Link ${i+1}: Empty link text`),["click here","read more","learn more","here","more"].includes(s.toLowerCase())&&t.push(`Link ${i+1}: Generic link text "${s}" - be more descriptive`),n.has(s)?t.push(`Link ${i+1}: Duplicate link text "${s}" - ensure context or make unique`):n.add(s),a.getAttribute("target")==="_blank"&&!a.getAttribute("aria-label")?.includes("opens")&&t.push(`Link ${i+1}: Opens new window without accessibility warning`)}),t},[])}),yj=()=>({validateForms:W.useCallback(()=>{const r=document.querySelectorAll("form"),t=[];return r.forEach((n,a)=>{n.querySelectorAll("input, select, textarea").forEach((s,o)=>{const u=s.tagName.toLowerCase(),l=s.id,c=l?document.querySelector(`label[for="${l}"]`):!1,f=s.getAttribute("aria-label"),h=s.getAttribute("aria-labelledby");if(!c&&!f&&!h&&t.push(`Form ${a+1}, ${u} ${o+1}: Missing label or aria-label`),s.hasAttribute("required")){const d=s.getAttribute("aria-required")==="true",v=c&&c?.textContent?.includes("*");!d&&!v&&t.push(`Form ${a+1}, ${u} ${o+1}: Required field not clearly indicated`)}if(s.classList.contains("error")||s.getAttribute("aria-invalid")==="true"){const d=s.getAttribute("aria-describedby");d&&document.getElementById(d)||t.push(`Form ${a+1}, ${u} ${o+1}: Invalid field has no error message`)}})}),t},[])}),Cj=()=>{const[e,r]=W.useState(!1);return W.useEffect(()=>{const t=navigator.userAgent.toLowerCase(),n=t.includes("nvda")||t.includes(" jaws")||t.includes("dragon")||window.speechSynthesis!==void 0,a=window.matchMedia("(prefers-reduced-motion: reduce)").matches,i=window.matchMedia("(prefers-contrast: high)").matches;r(n||a||i)},[]),e},Ej=()=>({runQuickAudit:W.useCallback(()=>{const r=[],{validateHeadingStructure:t}=gj();r.push(...t());const{validateImages:n}=bj();r.push(...n());const{validateLinks:a}=Nj();r.push(...a());const{validateForms:i}=yj();return r.push(...i()),document.documentElement.getAttribute("lang")||r.push("Missing lang attribute on html element"),(!document.title||document.title.length===0)&&r.push("Missing or empty page title"),{violations:r,score:Math.max(0,100-r.length*5),total:r.length}},[])}),wj=()=>{const[e,r]=W.useState("medium"),t=W.useCallback(()=>{r(i=>i==="small"?"medium":"large")},[]),n=W.useCallback(()=>{r(i=>i==="large"?"medium":"small")},[]),a=W.useCallback(()=>{r("medium")},[]);return{textSize:e,increaseTextSize:t,decreaseTextSize:n,resetTextSize:a}},_j=()=>{W.useEffect(()=>{const e=r=>{if(r.ctrlKey||r.metaKey)switch(r.key){case"+":case"=":r.preventDefault(),document.body.style.fontSize="larger";break;case"-":r.preventDefault(),document.body.style.fontSize="smaller";break;case"0":r.preventDefault(),document.body.style.fontSize="";break}if(r.altKey)switch(r.key){case"m":r.preventDefault();const t=document.querySelector('main, [role="main"]');t&&(t.focus(),t.scrollIntoView());break;case"n":r.preventDefault();const n=document.querySelector('nav, [role="navigation"]');n&&(n.focus(),n.scrollIntoView());break;case"h":r.preventDefault();const a=document.querySelector("h1");a&&(a.focus(),a.scrollIntoView());break}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[])},Sj=W.lazy(()=>vi(()=>import("./inspection-pages-BssZhaOe-v6.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Tj=W.lazy(()=>vi(()=>import("./data-pages-_UOy_NOD-v6.js"),__vite__mapDeps([7,1,2,3,6,5,4]))),Dj=W.lazy(()=>vi(()=>import("./notes-pages-DNzhrUgd-v6.js"),__vite__mapDeps([8,1,2,3,4,5,6]))),Aj=W.lazy(()=>vi(()=>import("./building-inspection-Dj5QLIO1-v6.js"),__vite__mapDeps([9,1,2,3,4,5,6]))),kj=W.lazy(()=>vi(()=>Promise.resolve().then(()=>Fee),void 0)),Rj=W.lazy(()=>vi(()=>import("./admin-pages-DELiqfCh-v6.js"),__vite__mapDeps([10,1,2,3,4,5,6]))),Oj=W.lazy(()=>vi(()=>import("./feedback-pages-DCdtDxK0-v6.js"),__vite__mapDeps([11,1,2,3,4,5,6]))),Fj=W.lazy(()=>vi(()=>import("./dashboard-pages-BQVzgzzK-v6.js"),__vite__mapDeps([12,1,2,3,4,5,6]))),$a=()=>m.jsxDEV("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:m.jsxDEV("div",{className:"text-center max-w-md mx-auto",children:[m.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:43,columnNumber:7},void 0),m.jsxDEV("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Loading..."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:44,columnNumber:7},void 0),m.jsxDEV("p",{className:"text-muted-foreground",children:"Please wait while we load the page."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:45,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:42,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:41,columnNumber:3},void 0);class Uj extends Is.Component{constructor(r){super(r),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}render(){return this.state.hasError?m.jsxDEV("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:m.jsxDEV("div",{className:"text-center max-w-md mx-auto",children:[m.jsxDEV("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:68,columnNumber:13},this),m.jsxDEV("p",{className:"text-gray-600 mb-4",children:"Please refresh the page to try again."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:71,columnNumber:13},this),m.jsxDEV("button",{onClick:()=>window.location.reload(),className:"modern-button bg-primary hover:bg-primary/90 border-primary text-primary-foreground",children:"Refresh Page"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:74,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:67,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:66,columnNumber:9},this):this.props.children}}function Ij(){const[e,r]=W.useState("Custodial"),[t,n]=W.useState(!1),[a,i]=W.useState(!1),[s,o]=W.useState(!1);rM();const{announce:u}=vj();xj(),_j();const{runQuickAudit:l}=Ej(),{textSize:c,increaseTextSize:f,decreaseTextSize:h}=wj(),d=Cj();W.useEffect(()=>{{const w=setInterval(()=>{const C=l();C.total>0&&(console.group("ðŸ” Accessibility Audit Results"),console.log(`Score: ${C.score}/100 (${C.total} violations)`),C.violations.forEach((k,D)=>{console.warn(`${D+1}. ${k}`)}),console.groupEnd())},1e4);return()=>clearInterval(w)}},[l]);const{notifications:v,removeNotification:p}=tM(),{notifications:x,removeNotification:g,showSuccess:N,showInfo:b}=yM();W.useEffect(()=>{e!=="Custodial"&&u(`Navigated to ${{"Custodial Inspection":"Single Area Inspection Form","Custodial Notes":"Custodial Concern Reporting Form","Inspection Data":"Inspection Data and Reports","Whole Building Inspection":"Whole Building Inspection Form","Rating Criteria":"Rating Criteria Reference Guide","admin-inspections":"Admin Inspections Panel","Monthly Feedback":"Monthly Feedback Reports","Scores Dashboard":"Building Scores Dashboard"}[e]||e}`)},[e,u]),W.useEffect(()=>{const w=()=>{document.querySelectorAll("form").forEach(D=>{D.noValidate=!0,D.querySelectorAll("input[pattern]").forEach(U=>{const F=U;F.setAttribute("data-pattern",F.getAttribute("pattern")||""),F.removeAttribute("pattern")}),D.addEventListener("invalid",U=>{U.preventDefault()},!0)})};w();const C=new MutationObserver(w);return C.observe(document.documentElement,{childList:!0,subtree:!0}),()=>C.disconnect()},[]),W.useEffect(()=>{const w=()=>{const U=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");i(U),U&&!Or.getItem("pwa-install-shown")&&(o(!0),Or.setItem("pwa-install-shown","true"),setTimeout(()=>o(!1),5e3),N("App Installed Successfully!","You can now access Custodial Command directly from your home screen.",{duration:5e3}))};w(),(()=>{const F=Or.getItem("app-version");if(F&&F!=="v6"){console.log("App version updated, clearing cache..."),"caches"in window&&caches.keys().then(G=>{G.forEach(ue=>{caches.delete(ue)})});const L=["app-version","pwa-install-shown"];Or.keys().filter(G=>!L.includes(G)).forEach(G=>Or.removeItem(G)),Or.setItem("app-version","v6"),b("App Updated","ðŸ”„ App updated! Reloading with latest version..."),setTimeout(()=>window.location.reload(),2e3);return}Or.setItem("app-version","v6")})();const k=()=>{i(!0),o(!0),Or.setItem("pwa-install-shown","true"),setTimeout(()=>o(!1),5e3),N("App Installed Successfully!","You can now access Custodial Command directly from your home screen.",{duration:5e3})};window.addEventListener("appinstalled",k);const D=window.matchMedia("(display-mode: standalone)");return D.addEventListener("change",w),()=>{window.removeEventListener("appinstalled",k),D.removeEventListener("change",w)}},[]);const y=[{name:"Home",path:"Custodial"}],_=()=>{try{switch(e){case"Custodial":return m.jsxDEV("div",{className:"p-8 text-center",children:[m.jsxDEV("div",{className:"mb-8 max-w-2xl mx-auto",children:[s&&m.jsxDEV("div",{className:"mb-4 p-4 bg-accent/20 border-2 border-accent/50 rounded-lg shadow-md",children:[m.jsxDEV("div",{className:"flex items-center justify-center space-x-2",children:[m.jsxDEV("span",{className:"text-2xl",children:"âœ…"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:300,columnNumber:23},this),m.jsxDEV("span",{className:"text-lg font-bold text-accent-foreground",children:"App Successfully Installed!"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:301,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:299,columnNumber:21},this),m.jsxDEV("p",{className:"text-center text-accent-foreground mt-2",children:"You can now access Custodial Command directly from your home screen."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:305,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:298,columnNumber:19},this),a?m.jsxDEV("div",{className:"mb-4 p-4 bg-accent/20 border-2 border-accent/50 rounded-lg shadow-md",children:[m.jsxDEV("div",{className:"flex items-center justify-center space-x-2",children:[m.jsxDEV("span",{className:"text-xl",children:"ðŸ“±"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:316,columnNumber:23},this),m.jsxDEV("span",{className:"text-lg font-bold text-accent-foreground",children:"Running as Installed App"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:317,columnNumber:23},this),m.jsxDEV("span",{className:"text-xl",children:"âœ…"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:320,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:315,columnNumber:21},this),m.jsxDEV("p",{className:"text-center text-accent-foreground mt-1 text-sm",children:"App is installed and working offline-ready"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:322,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:314,columnNumber:19},this):m.jsxDEV("button",{onClick:()=>n(!t),className:"w-full p-4 bg-amber-100 border-2 border-amber-300 rounded-lg shadow-md hover:bg-amber-150 transition-colors flex items-center justify-between",children:[m.jsxDEV("span",{className:"text-lg font-bold text-amber-900",children:"ðŸ“± Install on Your Mobile Device"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:333,columnNumber:21},this),m.jsxDEV("span",{className:"text-amber-900 text-xl",children:t?"âˆ’":"+"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:336,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:327,columnNumber:19},this),!a&&t&&m.jsxDEV("div",{className:"mt-4 p-6 bg-amber-50 border-2 border-amber-300 rounded-lg shadow-md",children:m.jsxDEV("div",{className:"text-amber-800 space-y-3",children:[m.jsxDEV("div",{className:"bg-white p-3 rounded border border-amber-200",children:[m.jsxDEV("p",{className:"font-semibold text-amber-900 mb-1",children:"iPhone/iPad:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:346,columnNumber:25},this),m.jsxDEV("p",{className:"text-sm",children:"1. Tap the Share button (â–¡â†—) in Safari"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:349,columnNumber:25},this),m.jsxDEV("p",{className:"text-sm",children:'2. Scroll down and tap "Add to Home Screen"'},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:352,columnNumber:25},this),m.jsxDEV("p",{className:"text-sm",children:'3. Tap "Add" to install the app'},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:355,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:345,columnNumber:23},this),m.jsxDEV("div",{className:"bg-white p-3 rounded border border-amber-200",children:[m.jsxDEV("p",{className:"font-semibold text-amber-900 mb-1",children:"Android:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:360,columnNumber:25},this),m.jsxDEV("p",{className:"text-sm",children:"1. Tap the menu (â‹®) in Chrome or your browser"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:363,columnNumber:25},this),m.jsxDEV("p",{className:"text-sm",children:'2. Select "Add to Home screen" or "Install app"'},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:366,columnNumber:25},this),m.jsxDEV("p",{className:"text-sm",children:'3. Tap "Add" or "Install" to confirm'},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:369,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:359,columnNumber:23},this),m.jsxDEV("p",{className:"text-center text-sm font-medium text-amber-700 mt-3",children:"Once installed, access the app directly from your home screen like any other app!"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:373,columnNumber:23},this),m.jsxDEV("div",{className:"mt-4 p-3 bg-accent/10 border border-accent/30 rounded",children:m.jsxDEV("p",{className:"text-center text-sm font-medium text-accent-foreground",children:"âœ“ Works offline after installation - previously viewed pages remain accessible"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:378,columnNumber:25},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:377,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:344,columnNumber:21},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:343,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:295,columnNumber:15},this),m.jsxDEV("div",{className:"space-y-6 mb-6",children:[m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide px-2",children:"Submit Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:391,columnNumber:19},this),m.jsxDEV("div",{className:"responsive-grid",children:[m.jsxDEV("button",{onClick:()=>r("Custodial Notes"),className:"modern-button bg-blue-600 hover:bg-blue-700 border-blue-600 text-white shadow-md hover:shadow-lg transition-shadow",children:m.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“ Report A Custodial Concern"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:399,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:395,columnNumber:21},this),m.jsxDEV("button",{onClick:()=>r("Custodial Inspection"),className:"modern-button bg-blue-600 hover:bg-blue-700 border-blue-600 text-white shadow-md hover:shadow-lg transition-shadow",children:m.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ” Single Area Inspection"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:407,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:403,columnNumber:21},this),m.jsxDEV("button",{onClick:()=>r("Whole Building Inspection"),className:"modern-button bg-blue-600 hover:bg-blue-700 border-blue-600 text-white shadow-md hover:shadow-lg transition-shadow",children:m.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ¢ Building Inspection"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:415,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:411,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:394,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:390,columnNumber:17},this),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide px-2",children:"View & Reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:423,columnNumber:19},this),m.jsxDEV("div",{className:"responsive-grid",children:[m.jsxDEV("button",{onClick:()=>r("Scores Dashboard"),className:"modern-button bg-emerald-600 hover:bg-emerald-700 border-emerald-600 text-white shadow-md hover:shadow-lg transition-shadow",children:m.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“ˆ Building Scores Dashboard"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:431,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:427,columnNumber:21},this),m.jsxDEV("button",{onClick:()=>r("Inspection Data"),className:"modern-button bg-green-600 hover:bg-green-700 border-green-600 text-white shadow-md hover:shadow-lg transition-shadow",children:m.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“Š View Data & Reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:439,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:435,columnNumber:21},this),m.jsxDEV("button",{onClick:()=>r("Monthly Feedback"),className:"modern-button bg-purple-600 hover:bg-purple-700 border-purple-600 text-white shadow-md hover:shadow-lg transition-shadow",children:m.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“„ Monthly Feedback Reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:447,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:443,columnNumber:21},this),m.jsxDEV("button",{onClick:()=>r("Rating Criteria"),className:"modern-button bg-gray-600 hover:bg-gray-700 border-gray-600 text-white shadow-sm hover:shadow-md transition-shadow",children:m.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"â„¹ï¸ Rating Criteria Guide"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:455,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:451,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:426,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:422,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:389,columnNumber:15},this),m.jsxDEV("p",{className:"text-lg text-muted-foreground text-center",children:"Cleanliness is a duty for all."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:463,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:293,columnNumber:13},this);case"Custodial Inspection":return m.jsxDEV(W.Suspense,{fallback:m.jsxDEV($a,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:470,columnNumber:33},this),children:m.jsxDEV(Sj,{onBack:()=>r("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:471,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:470,columnNumber:13},this);case"Inspection Data":return m.jsxDEV(W.Suspense,{fallback:m.jsxDEV($a,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:478,columnNumber:33},this),children:m.jsxDEV(Tj,{onBack:()=>r("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:479,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:478,columnNumber:13},this);case"Custodial Notes":return m.jsxDEV(W.Suspense,{fallback:m.jsxDEV($a,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:484,columnNumber:33},this),children:m.jsxDEV(Dj,{onBack:()=>r("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:485,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:484,columnNumber:13},this);case"Whole Building Inspection":return m.jsxDEV(W.Suspense,{fallback:m.jsxDEV($a,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:490,columnNumber:33},this),children:m.jsxDEV(Aj,{onBack:()=>r("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:491,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:490,columnNumber:13},this);case"Rating Criteria":return m.jsxDEV(W.Suspense,{fallback:m.jsxDEV($a,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:498,columnNumber:33},this),children:m.jsxDEV(kj,{onBack:()=>r("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:499,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:498,columnNumber:13},this);case"admin-inspections":return m.jsxDEV(W.Suspense,{fallback:m.jsxDEV($a,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:504,columnNumber:33},this),children:m.jsxDEV(Rj,{onBack:()=>r("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:505,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:504,columnNumber:13},this);case"Monthly Feedback":return m.jsxDEV(W.Suspense,{fallback:m.jsxDEV($a,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:510,columnNumber:33},this),children:m.jsxDEV(Oj,{onBack:()=>r("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:511,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:510,columnNumber:13},this);case"Scores Dashboard":return m.jsxDEV(W.Suspense,{fallback:m.jsxDEV($a,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:516,columnNumber:33},this),children:m.jsxDEV(Fj,{onBack:()=>r("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:517,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:516,columnNumber:13},this);default:return m.jsxDEV("div",{className:"p-8 text-center",children:[m.jsxDEV("h1",{className:"text-2xl font-bold",children:"Page Not Found"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:523,columnNumber:15},this),m.jsxDEV("button",{onClick:()=>r("Custodial"),className:"mt-4 modern-button bg-primary hover:bg-primary/90 border-primary text-primary-foreground",children:"Return Home"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:524,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:522,columnNumber:13},this)}}catch(w){return console.error("Error rendering page:",w),m.jsxDEV("div",{className:"p-8 text-center",children:[m.jsxDEV("h1",{className:"text-2xl font-bold text-red-600",children:"Error Loading Page"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:537,columnNumber:11},this),m.jsxDEV("p",{className:"mt-2 text-gray-600",children:"Something went wrong. Please try again."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:540,columnNumber:11},this),m.jsxDEV("button",{onClick:()=>r("Custodial"),className:"mt-4 modern-button bg-primary hover:bg-primary/90 border-primary text-primary-foreground",children:"Return Home"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:543,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:536,columnNumber:9},this)}};return m.jsxDEV(Uj,{children:m.jsxDEV(Y5,{client:hj,children:m.jsxDEV(lj,{children:m.jsxDEV("div",{className:"bg-background text-foreground min-h-screen pb-16 lg:pb-0","data-testid":"app-container",lang:"en",children:[m.jsxDEV("div",{className:"sr-only",role:"navigation","aria-label":"Skip links",children:[m.jsxDEV(lm,{href:"#main-content",children:"Skip to main content"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:566,columnNumber:15},this),m.jsxDEV(lm,{href:"#navigation",children:"Skip to navigation"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:567,columnNumber:15},this),m.jsxDEV(lm,{href:"#footer",children:"Skip to footer"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:568,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:565,columnNumber:13},this),m.jsxDEV("div",{className:"main-container",children:[m.jsxDEV("header",{className:"w-full header-container rounded-xl shadow-sm",role:"banner",children:[m.jsxDEV("h1",{className:"font-bold modern-header tracking-tight",id:"app-title",children:"CA Custodial Command"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:577,columnNumber:17},this),m.jsxDEV("div",{className:"sr-only","aria-live":"polite",children:d&&"Screen reader mode detected"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:580,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:573,columnNumber:15},this),m.jsxDEV("nav",{className:"w-full nav-container rounded-xl shadow-sm",role:"navigation","aria-labelledby":"app-title",id:"navigation",children:m.jsxDEV("div",{className:"button-container",role:"menubar",children:[y.map(w=>m.jsxDEV("button",{onClick:()=>r(w.path),className:`modern-button ${e===w.path?"bg-primary/80":""}`,role:"menuitem","aria-current":e===w.path?"page":void 0,"aria-label":`${w.name} page${e===w.path?", current page":""}`,children:w.name},w.name,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:594,columnNumber:21},this)),m.jsxDEV("button",{onClick:()=>r("admin-inspections"),className:"modern-button bg-red-600 hover:bg-red-700 border-red-600 text-white",role:"menuitem","aria-label":"Admin inspections panel","aria-current":e==="admin-inspections"?"page":void 0,children:"Admin"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:607,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:592,columnNumber:17},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:586,columnNumber:15},this),m.jsxDEV("div",{className:"w-full nav-container rounded-xl shadow-sm mb-4",role:"toolbar","aria-label":"Text size controls",children:m.jsxDEV("div",{className:"button-container",children:[m.jsxDEV("button",{onClick:h,className:"modern-button bg-secondary hover:bg-secondary/80","aria-label":"Decrease text size",disabled:c==="small",children:[m.jsxDEV("span",{"aria-hidden":"true",children:"A-"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:632,columnNumber:21},this),m.jsxDEV("span",{className:"sr-only",children:"Decrease text size"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:633,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:626,columnNumber:19},this),m.jsxDEV("span",{className:"text-sm text-muted-foreground px-2","aria-live":"polite","aria-label":`Current text size: ${c}`,children:["Text Size: ",c.charAt(0).toUpperCase()+c.slice(1)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:635,columnNumber:19},this),m.jsxDEV("button",{onClick:f,className:"modern-button bg-secondary hover:bg-secondary/80","aria-label":"Increase text size",disabled:c==="large",children:[m.jsxDEV("span",{"aria-hidden":"true",children:"A+"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:648,columnNumber:21},this),m.jsxDEV("span",{className:"sr-only",children:"Increase text size"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:649,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:642,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:625,columnNumber:17},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:620,columnNumber:15},this),m.jsxDEV(bM,{className:"mb-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:655,columnNumber:15},this),m.jsxDEV("main",{id:"main-content",className:"w-full content-area rounded-xl shadow-sm",role:"main","aria-label":"Main content",tabIndex:-1,children:_()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:658,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:571,columnNumber:13},this),m.jsxDEV("footer",{className:"w-full mt-6 text-center text-muted-foreground text-sm",role:"contentinfo",id:"footer",children:[m.jsxDEV("p",{children:"Â© 2025 Shared Service Command. All rights reserved. For the People!"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:675,columnNumber:15},this),m.jsxDEV("div",{className:"mt-2 text-xs",children:m.jsxDEV("span",{"aria-label":"Accessibility information",children:"WCAG 2.2 AA Compliant | Screen reader friendly"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:680,columnNumber:17},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:679,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:670,columnNumber:13},this),m.jsxDEV(pj,{className:"lg:hidden"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:687,columnNumber:13},this),m.jsxDEV("div",{"aria-live":"polite","aria-label":"Application notifications",role:"region",children:[m.jsxDEV(fM,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:695,columnNumber:15},this),m.jsxDEV(vM,{notifications:v,onRemove:p},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:696,columnNumber:15},this),m.jsxDEV(NM,{notifications:x,onRemove:g},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:700,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:690,columnNumber:13},this),m.jsxDEV("div",{className:"sr-only","aria-live":"assertive","aria-atomic":"true",id:"screen-reader-announcements"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:707,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:559,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:558,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:557,columnNumber:7},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:555,columnNumber:5},this)}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("Service Worker registered successfully:",e.scope),setInterval(()=>{e.update()},300*1e3)}).catch(e=>{console.error("Service Worker registration failed:",e)})});const tR=document.getElementById("root");if(!tR)throw new Error("Could not find root element");const Pj=K5.createRoot(tR);Pj.render(m.jsxDEV(Ij,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/main.tsx",lineNumber:32,columnNumber:13},void 0));console.log("App initializing...");const Eu={DRAFT_INSPECTION:"custodial-draft-inspection",DRAFT_BUILDING_INSPECTION:"custodial-draft-building-inspection",DRAFT_CUSTODIAL_NOTE:"custodial-draft-custodial-note",USER_PREFERENCES:"custodial-user-preferences",LEGACY_INSPECTION_DRAFTS:"custodial_inspection_drafts",LEGACY_BUILDING_DRAFTS:"building_form_drafts"},Gi={MAX_DRAFT_SIZE:5*1024*1024,MAX_TOTAL_STORAGE:8*1024*1024,MAX_DRAFTS_PER_TYPE:10,IMAGE_QUALITY:.7,MAX_IMAGE_DIMENSIONS:{width:1200,height:1200}},Ig=()=>{let e=0;const r=Or.keys();for(const t of r){const n=Or.getItem(t);n&&(e+=n.length+t.length)}return e},Vj=e=>new Promise((r,t)=>{const n=document.createElement("canvas"),a=n.getContext("2d"),i=new Image;i.onload=()=>{const{width:s,height:o}=Gi.MAX_IMAGE_DIMENSIONS;let{width:u,height:l}=i;if(u>s||l>o){const f=Math.min(s/u,o/l);u*=f,l*=f}n.width=u,n.height=l,a?.drawImage(i,0,0,u,l);const c=n.toDataURL("image/jpeg",Gi.IMAGE_QUALITY);r(c)},i.onerror=t,i.src=URL.createObjectURL(e)}),moe=(e,r)=>{try{const t={data:r,timestamp:Date.now()},n=JSON.stringify(t);if(n.length>Gi.MAX_DRAFT_SIZE){console.warn(`Draft too large (${Math.round(n.length/1024)}KB). Skipping save.`);return}if(Ig()+n.length>Gi.MAX_TOTAL_STORAGE&&(Pg(),Ig()+n.length>Gi.MAX_TOTAL_STORAGE)){console.warn("Storage limit reached. Cannot save draft.");return}Or.setItem(e,n)}catch(t){if(console.error("Failed to save draft to localStorage:",t),t instanceof Error&&t.name==="QuotaExceededError"){Pg();try{Or.setItem(e,JSON.stringify({data:r,timestamp:Date.now()}))}catch(n){console.error("Failed to save draft even after cleanup:",n)}}}},doe=e=>{try{const r=Or.getItem(e);if(!r)return null;const t=JSON.parse(r);return Date.now()-t.timestamp>10080*60*1e3?(Or.removeItem(e),null):t.data}catch(r){return console.error("Failed to load draft from localStorage:",r),null}},hoe=e=>{try{Or.removeItem(e)}catch(r){console.error("Failed to clear draft from localStorage:",r)}},Pg=()=>{try{const e=Date.now()-6048e5,r=[],t=Or.keys();for(const n of t)if(n.startsWith("custodial-"))try{const a=Or.getItem(n);if(a){const i=JSON.parse(a);i.timestamp&&i.timestamp<e&&r.push(n)}}catch{r.push(n)}r.forEach(n=>Or.removeItem(n)),console.log(`Cleaned up ${r.length} old drafts`)}catch(e){console.error("Failed to cleanup old drafts:",e)}},poe=()=>{try{Or.getItem(Eu.LEGACY_INSPECTION_DRAFTS)&&(console.log("Migrating legacy inspection drafts..."),Or.removeItem(Eu.LEGACY_INSPECTION_DRAFTS)),Or.getItem(Eu.LEGACY_BUILDING_DRAFTS)&&(console.log("Migrating legacy building inspection drafts..."),Or.removeItem(Eu.LEGACY_BUILDING_DRAFTS)),Pg()}catch(e){console.error("Failed to migrate legacy drafts:",e)}},voe=async e=>{try{return e.size<500*1024?new Promise((r,t)=>{const n=new FileReader;n.onload=()=>r(n.result),n.onerror=t,n.readAsDataURL(e)}):await Vj(e)}catch(r){throw console.error("Failed to process image for storage:",r),r}},xoe=()=>{const e=Ig(),r=Or.keys().filter(t=>t.startsWith("custodial-")).length;return{totalSizeKB:Math.round(e/1024),totalSizeMB:Math.round(e/(1024*1024)*100)/100,draftCount:r,limitMB:Math.round(Gi.MAX_TOTAL_STORAGE/(1024*1024)),usagePercent:Math.round(e/Gi.MAX_TOTAL_STORAGE*100)}};async function goe(e,r={}){const{maxWidth:t=1920,maxHeight:n=1080,quality:a=.8,maxSizeKB:i=500}=r;return new Promise((s,o)=>{const u=document.createElement("canvas"),l=u.getContext("2d"),c=new Image;c.onload=()=>{let{width:f,height:h}=c;if(f>t||h>n){const p=Math.min(t/f,n/h);f=f*p,h=h*p}u.width=f,u.height=h,l?.drawImage(c,0,0,f,h);let d=a;const v=()=>{u.toBlob(p=>{if(!p){o(new Error("Failed to compress image"));return}if(p.size/1024>i&&d>.1)d-=.1,v();else{const g=new File([p],e.name,{type:"image/jpeg",lastModified:Date.now()});s({compressedFile:g,originalSize:e.size,compressedSize:p.size,compressionRatio:(e.size-p.size)/e.size})}},"image/jpeg",d)};v()},c.onerror=()=>o(new Error("Failed to load image")),c.src=URL.createObjectURL(e)})}function boe(e,r=500){return e.size/1024>r}function Noe(e){if(e===0)return"0 Bytes";const r=1024,t=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,n)).toFixed(2))+" "+t[n]}const Vs=W.forwardRef(({className:e,type:r,...t},n)=>m.jsxDEV("input",{type:r,className:Ae("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground","transition-all duration-200 ease-out","border-3 border-[hsl(var(--border))] bg-[hsl(var(--card))] text-[hsl(var(--card-foreground))]","focus:outline-none focus:ring-0 focus:border-[hsl(var(--primary))] focus:shadow-[0_0_0_4px_hsl(var(--primary)_/_0.2)] focus:bg-[hsl(var(--background))]","hover:border-[hsl(var(--primary)_/_0.8)] hover:shadow-[0_0_0_2px_hsl(var(--primary)_/_0.1)]","disabled:cursor-not-allowed disabled:opacity-50","transform-gpu will-change-auto",e),ref:n,...t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/input.tsx",lineNumber:10,columnNumber:7},void 0));Vs.displayName="Input";const Mj=Bl("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),tr=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(Xk,{ref:t,className:Ae(Mj(),e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/label.tsx",lineNumber:15,columnNumber:3},void 0));tr.displayName=Xk.displayName;const W1=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("textarea",{className:Ae("flex min-h-[80px] w-full rounded-md bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground","transition-all duration-200 ease-out","border-3 border-[hsl(var(--border))] bg-[hsl(var(--card))] text-[hsl(var(--card-foreground))]","focus:outline-none focus:ring-0 focus:border-[hsl(var(--primary))] focus:shadow-[0_0_0_4px_hsl(var(--primary)_/_0.2)] focus:bg-[hsl(var(--background))]","hover:border-[hsl(var(--primary)_/_0.8)] hover:shadow-[0_0_0_2px_hsl(var(--primary)_/_0.1)]","disabled:cursor-not-allowed disabled:opacity-50","transform-gpu will-change-auto",e),ref:t,...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/textarea.tsx",lineNumber:10,columnNumber:7},void 0));W1.displayName="Textarea";const jj=["top","right","bottom","left"],li=Math.min,en=Math.max,uc=Math.round,wu=Math.floor,na=e=>({x:e,y:e}),Lj={left:"right",right:"left",bottom:"top",top:"bottom"},Bj={start:"end",end:"start"};function Vg(e,r,t){return en(e,li(r,t))}function ka(e,r){return typeof e=="function"?e(r):e}function Ra(e){return e.split("-")[0]}function uo(e){return e.split("-")[1]}function Y1(e){return e==="x"?"y":"x"}function K1(e){return e==="y"?"height":"width"}const qj=new Set(["top","bottom"]);function ra(e){return qj.has(Ra(e))?"y":"x"}function X1(e){return Y1(ra(e))}function Hj(e,r,t){t===void 0&&(t=!1);const n=uo(e),a=X1(e),i=K1(a);let s=a==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return r.reference[i]>r.floating[i]&&(s=cc(s)),[s,cc(s)]}function zj(e){const r=cc(e);return[Mg(e),r,Mg(r)]}function Mg(e){return e.replace(/start|end/g,r=>Bj[r])}const Uy=["left","right"],Iy=["right","left"],$j=["top","bottom"],Gj=["bottom","top"];function Wj(e,r,t){switch(e){case"top":case"bottom":return t?r?Iy:Uy:r?Uy:Iy;case"left":case"right":return r?$j:Gj;default:return[]}}function Yj(e,r,t,n){const a=uo(e);let i=Wj(Ra(e),t==="start",n);return a&&(i=i.map(s=>s+"-"+a),r&&(i=i.concat(i.map(Mg)))),i}function cc(e){return e.replace(/left|right|bottom|top/g,r=>Lj[r])}function Kj(e){return{top:0,right:0,bottom:0,left:0,...e}}function nR(e){return typeof e!="number"?Kj(e):{top:e,right:e,bottom:e,left:e}}function fc(e){const{x:r,y:t,width:n,height:a}=e;return{width:n,height:a,top:t,left:r,right:r+n,bottom:t+a,x:r,y:t}}function Py(e,r,t){let{reference:n,floating:a}=e;const i=ra(r),s=X1(r),o=K1(s),u=Ra(r),l=i==="y",c=n.x+n.width/2-a.width/2,f=n.y+n.height/2-a.height/2,h=n[o]/2-a[o]/2;let d;switch(u){case"top":d={x:c,y:n.y-a.height};break;case"bottom":d={x:c,y:n.y+n.height};break;case"right":d={x:n.x+n.width,y:f};break;case"left":d={x:n.x-a.width,y:f};break;default:d={x:n.x,y:n.y}}switch(uo(r)){case"start":d[s]-=h*(t&&l?-1:1);break;case"end":d[s]+=h*(t&&l?-1:1);break}return d}const Xj=async(e,r,t)=>{const{placement:n="bottom",strategy:a="absolute",middleware:i=[],platform:s}=t,o=i.filter(Boolean),u=await(s.isRTL==null?void 0:s.isRTL(r));let l=await s.getElementRects({reference:e,floating:r,strategy:a}),{x:c,y:f}=Py(l,n,u),h=n,d={},v=0;for(let p=0;p<o.length;p++){const{name:x,fn:g}=o[p],{x:N,y:b,data:y,reset:_}=await g({x:c,y:f,initialPlacement:n,placement:h,strategy:a,middlewareData:d,rects:l,platform:s,elements:{reference:e,floating:r}});c=N??c,f=b??f,d={...d,[x]:{...d[x],...y}},_&&v<=50&&(v++,typeof _=="object"&&(_.placement&&(h=_.placement),_.rects&&(l=_.rects===!0?await s.getElementRects({reference:e,floating:r,strategy:a}):_.rects),{x:c,y:f}=Py(l,h,u)),p=-1)}return{x:c,y:f,placement:h,strategy:a,middlewareData:d}};async function gl(e,r){var t;r===void 0&&(r={});const{x:n,y:a,platform:i,rects:s,elements:o,strategy:u}=e,{boundary:l="clippingAncestors",rootBoundary:c="viewport",elementContext:f="floating",altBoundary:h=!1,padding:d=0}=ka(r,e),v=nR(d),x=o[h?f==="floating"?"reference":"floating":f],g=fc(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(x)))==null||t?x:x.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:l,rootBoundary:c,strategy:u})),N=f==="floating"?{x:n,y:a,width:s.floating.width,height:s.floating.height}:s.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),y=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},_=fc(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:N,offsetParent:b,strategy:u}):N);return{top:(g.top-_.top+v.top)/y.y,bottom:(_.bottom-g.bottom+v.bottom)/y.y,left:(g.left-_.left+v.left)/y.x,right:(_.right-g.right+v.right)/y.x}}const Qj=e=>({name:"arrow",options:e,async fn(r){const{x:t,y:n,placement:a,rects:i,platform:s,elements:o,middlewareData:u}=r,{element:l,padding:c=0}=ka(e,r)||{};if(l==null)return{};const f=nR(c),h={x:t,y:n},d=X1(a),v=K1(d),p=await s.getDimensions(l),x=d==="y",g=x?"top":"left",N=x?"bottom":"right",b=x?"clientHeight":"clientWidth",y=i.reference[v]+i.reference[d]-h[d]-i.floating[v],_=h[d]-i.reference[d],w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(l));let C=w?w[b]:0;(!C||!await(s.isElement==null?void 0:s.isElement(w)))&&(C=o.floating[b]||i.floating[v]);const k=y/2-_/2,D=C/2-p[v]/2-1,U=li(f[g],D),F=li(f[N],D),L=U,P=C-p[v]-F,B=C/2-p[v]/2+k,G=Vg(L,B,P),ue=!u.arrow&&uo(a)!=null&&B!==G&&i.reference[v]/2-(B<L?U:F)-p[v]/2<0,oe=ue?B<L?B-L:B-P:0;return{[d]:h[d]+oe,data:{[d]:G,centerOffset:B-G-oe,...ue&&{alignmentOffset:oe}},reset:ue}}}),Zj=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(r){var t,n;const{placement:a,middlewareData:i,rects:s,initialPlacement:o,platform:u,elements:l}=r,{mainAxis:c=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:p=!0,...x}=ka(e,r);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const g=Ra(a),N=ra(o),b=Ra(o)===o,y=await(u.isRTL==null?void 0:u.isRTL(l.floating)),_=h||(b||!p?[cc(o)]:zj(o)),w=v!=="none";!h&&w&&_.push(...Yj(o,p,v,y));const C=[o,..._],k=await gl(r,x),D=[];let U=((n=i.flip)==null?void 0:n.overflows)||[];if(c&&D.push(k[g]),f){const B=Hj(a,s,y);D.push(k[B[0]],k[B[1]])}if(U=[...U,{placement:a,overflows:D}],!D.every(B=>B<=0)){var F,L;const B=(((F=i.flip)==null?void 0:F.index)||0)+1,G=C[B];if(G&&(!(f==="alignment"?N!==ra(G):!1)||U.every(he=>ra(he.placement)===N?he.overflows[0]>0:!0)))return{data:{index:B,overflows:U},reset:{placement:G}};let ue=(L=U.filter(oe=>oe.overflows[0]<=0).sort((oe,he)=>oe.overflows[1]-he.overflows[1])[0])==null?void 0:L.placement;if(!ue)switch(d){case"bestFit":{var P;const oe=(P=U.filter(he=>{if(w){const fe=ra(he.placement);return fe===N||fe==="y"}return!0}).map(he=>[he.placement,he.overflows.filter(fe=>fe>0).reduce((fe,S)=>fe+S,0)]).sort((he,fe)=>he[1]-fe[1])[0])==null?void 0:P[0];oe&&(ue=oe);break}case"initialPlacement":ue=o;break}if(a!==ue)return{reset:{placement:ue}}}return{}}}};function Vy(e,r){return{top:e.top-r.height,right:e.right-r.width,bottom:e.bottom-r.height,left:e.left-r.width}}function My(e){return jj.some(r=>e[r]>=0)}const Jj=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(r){const{rects:t}=r,{strategy:n="referenceHidden",...a}=ka(e,r);switch(n){case"referenceHidden":{const i=await gl(r,{...a,elementContext:"reference"}),s=Vy(i,t.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:My(s)}}}case"escaped":{const i=await gl(r,{...a,altBoundary:!0}),s=Vy(i,t.floating);return{data:{escapedOffsets:s,escaped:My(s)}}}default:return{}}}}},aR=new Set(["left","top"]);async function e8(e,r){const{placement:t,platform:n,elements:a}=e,i=await(n.isRTL==null?void 0:n.isRTL(a.floating)),s=Ra(t),o=uo(t),u=ra(t)==="y",l=aR.has(s)?-1:1,c=i&&u?-1:1,f=ka(r,e);let{mainAxis:h,crossAxis:d,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return o&&typeof v=="number"&&(d=o==="end"?v*-1:v),u?{x:d*c,y:h*l}:{x:h*l,y:d*c}}const r8=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(r){var t,n;const{x:a,y:i,placement:s,middlewareData:o}=r,u=await e8(r,e);return s===((t=o.offset)==null?void 0:t.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:a+u.x,y:i+u.y,data:{...u,placement:s}}}}},t8=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(r){const{x:t,y:n,placement:a}=r,{mainAxis:i=!0,crossAxis:s=!1,limiter:o={fn:x=>{let{x:g,y:N}=x;return{x:g,y:N}}},...u}=ka(e,r),l={x:t,y:n},c=await gl(r,u),f=ra(Ra(a)),h=Y1(f);let d=l[h],v=l[f];if(i){const x=h==="y"?"top":"left",g=h==="y"?"bottom":"right",N=d+c[x],b=d-c[g];d=Vg(N,d,b)}if(s){const x=f==="y"?"top":"left",g=f==="y"?"bottom":"right",N=v+c[x],b=v-c[g];v=Vg(N,v,b)}const p=o.fn({...r,[h]:d,[f]:v});return{...p,data:{x:p.x-t,y:p.y-n,enabled:{[h]:i,[f]:s}}}}}},n8=function(e){return e===void 0&&(e={}),{options:e,fn(r){const{x:t,y:n,placement:a,rects:i,middlewareData:s}=r,{offset:o=0,mainAxis:u=!0,crossAxis:l=!0}=ka(e,r),c={x:t,y:n},f=ra(a),h=Y1(f);let d=c[h],v=c[f];const p=ka(o,r),x=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(u){const b=h==="y"?"height":"width",y=i.reference[h]-i.floating[b]+x.mainAxis,_=i.reference[h]+i.reference[b]-x.mainAxis;d<y?d=y:d>_&&(d=_)}if(l){var g,N;const b=h==="y"?"width":"height",y=aR.has(Ra(a)),_=i.reference[f]-i.floating[b]+(y&&((g=s.offset)==null?void 0:g[f])||0)+(y?0:x.crossAxis),w=i.reference[f]+i.reference[b]+(y?0:((N=s.offset)==null?void 0:N[f])||0)-(y?x.crossAxis:0);v<_?v=_:v>w&&(v=w)}return{[h]:d,[f]:v}}}},a8=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(r){var t,n;const{placement:a,rects:i,platform:s,elements:o}=r,{apply:u=()=>{},...l}=ka(e,r),c=await gl(r,l),f=Ra(a),h=uo(a),d=ra(a)==="y",{width:v,height:p}=i.floating;let x,g;f==="top"||f==="bottom"?(x=f,g=h===(await(s.isRTL==null?void 0:s.isRTL(o.floating))?"start":"end")?"left":"right"):(g=f,x=h==="end"?"top":"bottom");const N=p-c.top-c.bottom,b=v-c.left-c.right,y=li(p-c[x],N),_=li(v-c[g],b),w=!r.middlewareData.shift;let C=y,k=_;if((t=r.middlewareData.shift)!=null&&t.enabled.x&&(k=b),(n=r.middlewareData.shift)!=null&&n.enabled.y&&(C=N),w&&!h){const U=en(c.left,0),F=en(c.right,0),L=en(c.top,0),P=en(c.bottom,0);d?k=v-2*(U!==0||F!==0?U+F:en(c.left,c.right)):C=p-2*(L!==0||P!==0?L+P:en(c.top,c.bottom))}await u({...r,availableWidth:k,availableHeight:C});const D=await s.getDimensions(o.floating);return v!==D.width||p!==D.height?{reset:{rects:!0}}:{}}}};function ef(){return typeof window<"u"}function co(e){return iR(e)?(e.nodeName||"").toLowerCase():"#document"}function on(e){var r;return(e==null||(r=e.ownerDocument)==null?void 0:r.defaultView)||window}function ua(e){var r;return(r=(iR(e)?e.ownerDocument:e.document)||window.document)==null?void 0:r.documentElement}function iR(e){return ef()?e instanceof Node||e instanceof on(e).Node:!1}function Mn(e){return ef()?e instanceof Element||e instanceof on(e).Element:!1}function ia(e){return ef()?e instanceof HTMLElement||e instanceof on(e).HTMLElement:!1}function jy(e){return!ef()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof on(e).ShadowRoot}const i8=new Set(["inline","contents"]);function ql(e){const{overflow:r,overflowX:t,overflowY:n,display:a}=jn(e);return/auto|scroll|overlay|hidden|clip/.test(r+n+t)&&!i8.has(a)}const s8=new Set(["table","td","th"]);function o8(e){return s8.has(co(e))}const l8=[":popover-open",":modal"];function rf(e){return l8.some(r=>{try{return e.matches(r)}catch{return!1}})}const u8=["transform","translate","scale","rotate","perspective"],c8=["transform","translate","scale","rotate","perspective","filter"],f8=["paint","layout","strict","content"];function Q1(e){const r=Z1(),t=Mn(e)?jn(e):e;return u8.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!r&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!r&&(t.filter?t.filter!=="none":!1)||c8.some(n=>(t.willChange||"").includes(n))||f8.some(n=>(t.contain||"").includes(n))}function m8(e){let r=ui(e);for(;ia(r)&&!no(r);){if(Q1(r))return r;if(rf(r))return null;r=ui(r)}return null}function Z1(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const d8=new Set(["html","body","#document"]);function no(e){return d8.has(co(e))}function jn(e){return on(e).getComputedStyle(e)}function tf(e){return Mn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function ui(e){if(co(e)==="html")return e;const r=e.assignedSlot||e.parentNode||jy(e)&&e.host||ua(e);return jy(r)?r.host:r}function sR(e){const r=ui(e);return no(r)?e.ownerDocument?e.ownerDocument.body:e.body:ia(r)&&ql(r)?r:sR(r)}function bl(e,r,t){var n;r===void 0&&(r=[]),t===void 0&&(t=!0);const a=sR(e),i=a===((n=e.ownerDocument)==null?void 0:n.body),s=on(a);if(i){const o=jg(s);return r.concat(s,s.visualViewport||[],ql(a)?a:[],o&&t?bl(o):[])}return r.concat(a,bl(a,[],t))}function jg(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function oR(e){const r=jn(e);let t=parseFloat(r.width)||0,n=parseFloat(r.height)||0;const a=ia(e),i=a?e.offsetWidth:t,s=a?e.offsetHeight:n,o=uc(t)!==i||uc(n)!==s;return o&&(t=i,n=s),{width:t,height:n,$:o}}function J1(e){return Mn(e)?e:e.contextElement}function Ms(e){const r=J1(e);if(!ia(r))return na(1);const t=r.getBoundingClientRect(),{width:n,height:a,$:i}=oR(r);let s=(i?uc(t.width):t.width)/n,o=(i?uc(t.height):t.height)/a;return(!s||!Number.isFinite(s))&&(s=1),(!o||!Number.isFinite(o))&&(o=1),{x:s,y:o}}const h8=na(0);function lR(e){const r=on(e);return!Z1()||!r.visualViewport?h8:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function p8(e,r,t){return r===void 0&&(r=!1),!t||r&&t!==on(e)?!1:r}function Ji(e,r,t,n){r===void 0&&(r=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect(),i=J1(e);let s=na(1);r&&(n?Mn(n)&&(s=Ms(n)):s=Ms(e));const o=p8(i,t,n)?lR(i):na(0);let u=(a.left+o.x)/s.x,l=(a.top+o.y)/s.y,c=a.width/s.x,f=a.height/s.y;if(i){const h=on(i),d=n&&Mn(n)?on(n):n;let v=h,p=jg(v);for(;p&&n&&d!==v;){const x=Ms(p),g=p.getBoundingClientRect(),N=jn(p),b=g.left+(p.clientLeft+parseFloat(N.paddingLeft))*x.x,y=g.top+(p.clientTop+parseFloat(N.paddingTop))*x.y;u*=x.x,l*=x.y,c*=x.x,f*=x.y,u+=b,l+=y,v=on(p),p=jg(v)}}return fc({width:c,height:f,x:u,y:l})}function nf(e,r){const t=tf(e).scrollLeft;return r?r.left+t:Ji(ua(e)).left+t}function uR(e,r){const t=e.getBoundingClientRect(),n=t.left+r.scrollLeft-nf(e,t),a=t.top+r.scrollTop;return{x:n,y:a}}function v8(e){let{elements:r,rect:t,offsetParent:n,strategy:a}=e;const i=a==="fixed",s=ua(n),o=r?rf(r.floating):!1;if(n===s||o&&i)return t;let u={scrollLeft:0,scrollTop:0},l=na(1);const c=na(0),f=ia(n);if((f||!f&&!i)&&((co(n)!=="body"||ql(s))&&(u=tf(n)),ia(n))){const d=Ji(n);l=Ms(n),c.x=d.x+n.clientLeft,c.y=d.y+n.clientTop}const h=s&&!f&&!i?uR(s,u):na(0);return{width:t.width*l.x,height:t.height*l.y,x:t.x*l.x-u.scrollLeft*l.x+c.x+h.x,y:t.y*l.y-u.scrollTop*l.y+c.y+h.y}}function x8(e){return Array.from(e.getClientRects())}function g8(e){const r=ua(e),t=tf(e),n=e.ownerDocument.body,a=en(r.scrollWidth,r.clientWidth,n.scrollWidth,n.clientWidth),i=en(r.scrollHeight,r.clientHeight,n.scrollHeight,n.clientHeight);let s=-t.scrollLeft+nf(e);const o=-t.scrollTop;return jn(n).direction==="rtl"&&(s+=en(r.clientWidth,n.clientWidth)-a),{width:a,height:i,x:s,y:o}}const Ly=25;function b8(e,r){const t=on(e),n=ua(e),a=t.visualViewport;let i=n.clientWidth,s=n.clientHeight,o=0,u=0;if(a){i=a.width,s=a.height;const c=Z1();(!c||c&&r==="fixed")&&(o=a.offsetLeft,u=a.offsetTop)}const l=nf(n);if(l<=0){const c=n.ownerDocument,f=c.body,h=getComputedStyle(f),d=c.compatMode==="CSS1Compat"&&parseFloat(h.marginLeft)+parseFloat(h.marginRight)||0,v=Math.abs(n.clientWidth-f.clientWidth-d);v<=Ly&&(i-=v)}else l<=Ly&&(i+=l);return{width:i,height:s,x:o,y:u}}const N8=new Set(["absolute","fixed"]);function y8(e,r){const t=Ji(e,!0,r==="fixed"),n=t.top+e.clientTop,a=t.left+e.clientLeft,i=ia(e)?Ms(e):na(1),s=e.clientWidth*i.x,o=e.clientHeight*i.y,u=a*i.x,l=n*i.y;return{width:s,height:o,x:u,y:l}}function By(e,r,t){let n;if(r==="viewport")n=b8(e,t);else if(r==="document")n=g8(ua(e));else if(Mn(r))n=y8(r,t);else{const a=lR(e);n={x:r.x-a.x,y:r.y-a.y,width:r.width,height:r.height}}return fc(n)}function cR(e,r){const t=ui(e);return t===r||!Mn(t)||no(t)?!1:jn(t).position==="fixed"||cR(t,r)}function C8(e,r){const t=r.get(e);if(t)return t;let n=bl(e,[],!1).filter(o=>Mn(o)&&co(o)!=="body"),a=null;const i=jn(e).position==="fixed";let s=i?ui(e):e;for(;Mn(s)&&!no(s);){const o=jn(s),u=Q1(s);!u&&o.position==="fixed"&&(a=null),(i?!u&&!a:!u&&o.position==="static"&&!!a&&N8.has(a.position)||ql(s)&&!u&&cR(e,s))?n=n.filter(c=>c!==s):a=o,s=ui(s)}return r.set(e,n),n}function E8(e){let{element:r,boundary:t,rootBoundary:n,strategy:a}=e;const s=[...t==="clippingAncestors"?rf(r)?[]:C8(r,this._c):[].concat(t),n],o=s[0],u=s.reduce((l,c)=>{const f=By(r,c,a);return l.top=en(f.top,l.top),l.right=li(f.right,l.right),l.bottom=li(f.bottom,l.bottom),l.left=en(f.left,l.left),l},By(r,o,a));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function w8(e){const{width:r,height:t}=oR(e);return{width:r,height:t}}function _8(e,r,t){const n=ia(r),a=ua(r),i=t==="fixed",s=Ji(e,!0,i,r);let o={scrollLeft:0,scrollTop:0};const u=na(0);function l(){u.x=nf(a)}if(n||!n&&!i)if((co(r)!=="body"||ql(a))&&(o=tf(r)),n){const d=Ji(r,!0,i,r);u.x=d.x+r.clientLeft,u.y=d.y+r.clientTop}else a&&l();i&&!n&&a&&l();const c=a&&!n&&!i?uR(a,o):na(0),f=s.left+o.scrollLeft-u.x-c.x,h=s.top+o.scrollTop-u.y-c.y;return{x:f,y:h,width:s.width,height:s.height}}function um(e){return jn(e).position==="static"}function qy(e,r){if(!ia(e)||jn(e).position==="fixed")return null;if(r)return r(e);let t=e.offsetParent;return ua(e)===t&&(t=t.ownerDocument.body),t}function fR(e,r){const t=on(e);if(rf(e))return t;if(!ia(e)){let a=ui(e);for(;a&&!no(a);){if(Mn(a)&&!um(a))return a;a=ui(a)}return t}let n=qy(e,r);for(;n&&o8(n)&&um(n);)n=qy(n,r);return n&&no(n)&&um(n)&&!Q1(n)?t:n||m8(e)||t}const S8=async function(e){const r=this.getOffsetParent||fR,t=this.getDimensions,n=await t(e.floating);return{reference:_8(e.reference,await r(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function T8(e){return jn(e).direction==="rtl"}const D8={convertOffsetParentRelativeRectToViewportRelativeRect:v8,getDocumentElement:ua,getClippingRect:E8,getOffsetParent:fR,getElementRects:S8,getClientRects:x8,getDimensions:w8,getScale:Ms,isElement:Mn,isRTL:T8};function mR(e,r){return e.x===r.x&&e.y===r.y&&e.width===r.width&&e.height===r.height}function A8(e,r){let t=null,n;const a=ua(e);function i(){var o;clearTimeout(n),(o=t)==null||o.disconnect(),t=null}function s(o,u){o===void 0&&(o=!1),u===void 0&&(u=1),i();const l=e.getBoundingClientRect(),{left:c,top:f,width:h,height:d}=l;if(o||r(),!h||!d)return;const v=wu(f),p=wu(a.clientWidth-(c+h)),x=wu(a.clientHeight-(f+d)),g=wu(c),b={rootMargin:-v+"px "+-p+"px "+-x+"px "+-g+"px",threshold:en(0,li(1,u))||1};let y=!0;function _(w){const C=w[0].intersectionRatio;if(C!==u){if(!y)return s();C?s(!1,C):n=setTimeout(()=>{s(!1,1e-7)},1e3)}C===1&&!mR(l,e.getBoundingClientRect())&&s(),y=!1}try{t=new IntersectionObserver(_,{...b,root:a.ownerDocument})}catch{t=new IntersectionObserver(_,b)}t.observe(e)}return s(!0),i}function yoe(e,r,t,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:u=!1}=n,l=J1(e),c=a||i?[...l?bl(l):[],...bl(r)]:[];c.forEach(g=>{a&&g.addEventListener("scroll",t,{passive:!0}),i&&g.addEventListener("resize",t)});const f=l&&o?A8(l,t):null;let h=-1,d=null;s&&(d=new ResizeObserver(g=>{let[N]=g;N&&N.target===l&&d&&(d.unobserve(r),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=d)==null||b.observe(r)})),t()}),l&&!u&&d.observe(l),d.observe(r));let v,p=u?Ji(e):null;u&&x();function x(){const g=Ji(e);p&&!mR(p,g)&&t(),p=g,v=requestAnimationFrame(x)}return t(),()=>{var g;c.forEach(N=>{a&&N.removeEventListener("scroll",t),i&&N.removeEventListener("resize",t)}),f?.(),(g=d)==null||g.disconnect(),d=null,u&&cancelAnimationFrame(v)}}const Coe=r8,Eoe=t8,woe=Zj,_oe=a8,Soe=Jj,Toe=Qj,Doe=n8,Aoe=(e,r,t)=>{const n=new Map,a={platform:D8,...t},i={...a.platform,_c:n};return Xj(e,r,{...a,platform:i})};var k8=function(e){if(typeof document>"u")return null;var r=Array.isArray(e)?e[0]:e;return r.ownerDocument.body},Es=new WeakMap,_u=new WeakMap,Su={},cm=0,dR=function(e){return e&&(e.host||dR(e.parentNode))},R8=function(e,r){return r.map(function(t){if(e.contains(t))return t;var n=dR(t);return n&&e.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)}).filter(function(t){return!!t})},O8=function(e,r,t,n){var a=R8(r,Array.isArray(e)?e:[e]);Su[t]||(Su[t]=new WeakMap);var i=Su[t],s=[],o=new Set,u=new Set(a),l=function(f){!f||o.has(f)||(o.add(f),l(f.parentNode))};a.forEach(l);var c=function(f){!f||u.has(f)||Array.prototype.forEach.call(f.children,function(h){if(o.has(h))c(h);else try{var d=h.getAttribute(n),v=d!==null&&d!=="false",p=(Es.get(h)||0)+1,x=(i.get(h)||0)+1;Es.set(h,p),i.set(h,x),s.push(h),p===1&&v&&_u.set(h,!0),x===1&&h.setAttribute(t,"true"),v||h.setAttribute(n,"true")}catch(g){console.error("aria-hidden: cannot operate on ",h,g)}})};return c(r),o.clear(),cm++,function(){s.forEach(function(f){var h=Es.get(f)-1,d=i.get(f)-1;Es.set(f,h),i.set(f,d),h||(_u.has(f)||f.removeAttribute(n),_u.delete(f)),d||f.removeAttribute(t)}),cm--,cm||(Es=new WeakMap,Es=new WeakMap,_u=new WeakMap,Su={})}},koe=function(e,r,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=k8(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),O8(n,a,t,"aria-hidden")):function(){return null}},mc=function(){return mc=Object.assign||function(r){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},mc.apply(this,arguments)};function F8(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t}function Roe(e,r,t){if(t||arguments.length===2)for(var n=0,a=r.length,i;n<a;n++)(i||!(n in r))&&(i||(i=Array.prototype.slice.call(r,0,n)),i[n]=r[n]);return e.concat(i||Array.prototype.slice.call(r))}function fm(e,r){return typeof e=="function"?e(r):e&&(e.current=r),e}function U8(e,r){var t=W.useState(function(){return{value:e,callback:r,facade:{get current(){return t.value},set current(n){var a=t.value;a!==n&&(t.value=n,t.callback(n,a))}}}})[0];return t.callback=r,t.facade}var I8=typeof window<"u"?W.useLayoutEffect:W.useEffect,Hy=new WeakMap;function Ooe(e,r){var t=U8(null,function(n){return e.forEach(function(a){return fm(a,n)})});return I8(function(){var n=Hy.get(t);if(n){var a=new Set(n),i=new Set(e),s=t.current;a.forEach(function(o){i.has(o)||fm(o,null)}),i.forEach(function(o){a.has(o)||fm(o,s)})}Hy.set(t,e)},[e]),t}function P8(e){return e}function V8(e,r){r===void 0&&(r=P8);var t=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:e},useMedium:function(i){var s=r(i,n);return t.push(s),function(){t=t.filter(function(o){return o!==s})}},assignSyncMedium:function(i){for(n=!0;t.length;){var s=t;t=[],s.forEach(i)}t={push:function(o){return i(o)},filter:function(){return t}}},assignMedium:function(i){n=!0;var s=[];if(t.length){var o=t;t=[],o.forEach(i),s=t}var u=function(){var c=s;s=[],c.forEach(i)},l=function(){return Promise.resolve().then(u)};l(),t={push:function(c){s.push(c),l()},filter:function(c){return s=s.filter(c),t}}}};return a}function Foe(e){e===void 0&&(e={});var r=V8(null);return r.options=mc({async:!0,ssr:!1},e),r}var hR=function(e){var r=e.sideCar,t=F8(e,["sideCar"]);if(!r)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=r.read();if(!n)throw new Error("Sidecar medium not found");return W.createElement(n,mc({},t))};hR.isSideCarExport=!0;function Uoe(e,r){return e.useMedium(r),hR}var Ioe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};const el=X5,rl=Q5,js=W.forwardRef(({className:e,children:r,...t},n)=>m.jsxDEV(Qk,{ref:n,className:Ae("flex h-10 w-full items-center justify-between rounded-md bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground","transition-all duration-200 ease-out","border-3 border-[hsl(var(--border))] bg-[hsl(var(--card))] text-[hsl(var(--card-foreground))]","focus:outline-none focus:ring-0 focus:border-[hsl(var(--primary))] focus:shadow-[0_0_0_4px_hsl(var(--primary)_/_0.2)] focus:bg-[hsl(var(--background))]","hover:border-[hsl(var(--primary)_/_0.8)] hover:shadow-[0_0_0_2px_hsl(var(--primary)_/_0.1)]","disabled:cursor-not-allowed disabled:opacity-50","transform-gpu will-change-auto","[&>span]:line-clamp-1",e),...t,children:[r,m.jsxDEV(Z5,{asChild:!0,children:m.jsxDEV($i,{className:"h-4 w-4 opacity-50"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:39,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:38,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:16,columnNumber:3},void 0));js.displayName=Qk.displayName;const pR=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(e4,{ref:t,className:Ae("flex cursor-default items-center justify-center py-1",e),...r,children:m.jsxDEV(r4,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:57,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:49,columnNumber:3},void 0));pR.displayName=e4.displayName;const vR=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(t4,{ref:t,className:Ae("flex cursor-default items-center justify-center py-1",e),...r,children:m.jsxDEV($i,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:74,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:66,columnNumber:3},void 0));vR.displayName=t4.displayName;const Ls=W.forwardRef(({className:e,children:r,position:t="popper",...n},a)=>m.jsxDEV(J5,{children:m.jsxDEV(Zk,{ref:a,className:Ae("relative z-[9999] max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-white text-gray-900 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...n,children:[m.jsxDEV(pR,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:96,columnNumber:7},void 0),m.jsxDEV(eV,{className:Ae("p-1 bg-white",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:97,columnNumber:7},void 0),m.jsxDEV(vR,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:106,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:85,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:84,columnNumber:3},void 0));Ls.displayName=Zk.displayName;const M8=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(n4,{ref:t,className:Ae("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:116,columnNumber:3},void 0));M8.displayName=n4.displayName;const Un=W.forwardRef(({className:e,children:r,...t},n)=>m.jsxDEV(Jk,{ref:n,className:Ae("relative flex w-full cursor-pointer select-none items-center rounded-sm py-2 pl-8 pr-4 text-sm bg-white text-gray-900 outline-none hover:bg-gray-100 focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[m.jsxDEV("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:m.jsxDEV(rV,{children:m.jsxDEV(M1,{className:"h-4 w-4 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:138,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:137,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:136,columnNumber:5},void 0),m.jsxDEV(tV,{className:"truncate",children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:142,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:128,columnNumber:3},void 0));Un.displayName=Jk.displayName;const j8=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(a4,{ref:t,className:Ae("-mx-1 my-1 h-px bg-muted",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:151,columnNumber:3},void 0));j8.displayName=a4.displayName;const af=i4,xR=nV,L8=s4,gR=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(L1,{ref:t,className:Ae("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:21,columnNumber:3},void 0));gR.displayName=L1.displayName;const Hl=W.forwardRef(({className:e,children:r,...t},n)=>m.jsxDEV(L8,{children:[m.jsxDEV(gR,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:37,columnNumber:5},void 0),m.jsxDEV(j1,{ref:n,className:Ae("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t,children:[r,m.jsxDEV(aV,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[m.jsxDEV(oi,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:48,columnNumber:9},void 0),m.jsxDEV("span",{className:"sr-only",children:"Close"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:49,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:47,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:38,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:36,columnNumber:3},void 0));Hl.displayName=j1.displayName;const zl=({className:e,...r})=>m.jsxDEV("div",{className:Ae("flex flex-col space-y-1.5 text-center sm:text-left",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:60,columnNumber:3},void 0);zl.displayName="DialogHeader";const bR=({className:e,...r})=>m.jsxDEV("div",{className:Ae("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:74,columnNumber:3},void 0);bR.displayName="DialogFooter";const $l=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(o4,{ref:t,className:Ae("text-lg font-semibold leading-none tracking-tight",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:88,columnNumber:3},void 0));$l.displayName=o4.displayName;const Gl=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(l4,{ref:t,className:Ae("text-sm text-muted-foreground",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:103,columnNumber:3},void 0));Gl.displayName=l4.displayName;function Tu(...e){return e.filter(Boolean).join(" ")}function Poe({title:e,children:r,defaultCollapsed:t=!0,className:n,titleClassName:a,contentClassName:i,disabled:s=!1}){const[o,u]=W.useState(t),l=()=>{s||u(!o)};return m.jsxDEV("div",{className:Tu("border border-gray-200 rounded-lg overflow-hidden",n||""),children:[m.jsxDEV("button",{type:"button",onClick:l,disabled:s,className:Tu("w-full justify-between p-4 h-auto font-medium text-left hover:bg-gray-50 border-none rounded-none flex items-center bg-transparent cursor-pointer",s?"cursor-not-allowed opacity-50":"",a||""),children:[m.jsxDEV("span",{className:"text-base",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:47,columnNumber:9},this),o?m.jsxDEV(Xc,{className:"w-5 h-5 transition-transform duration-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:49,columnNumber:11},this):m.jsxDEV($i,{className:"w-5 h-5 transition-transform duration-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:51,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:37,columnNumber:7},this),m.jsxDEV("div",{className:Tu("transition-all duration-300 ease-in-out overflow-hidden",o?"max-h-0":"max-h-[2000px]"),children:m.jsxDEV("div",{className:Tu("p-4 pt-0",i||""),children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:61,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:55,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:36,columnNumber:5},this)}const B8=W.forwardRef(({...e},r)=>m.jsxDEV("nav",{ref:r,"aria-label":"breadcrumb",...e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:12,columnNumber:26},void 0));B8.displayName="Breadcrumb";const q8=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("ol",{ref:t,className:Ae("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:19,columnNumber:3},void 0));q8.displayName="BreadcrumbList";const H8=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("li",{ref:t,className:Ae("inline-flex items-center gap-1.5",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:34,columnNumber:3},void 0));H8.displayName="BreadcrumbItem";const z8=W.forwardRef(({asChild:e,className:r,...t},n)=>{const a=e?Gk:"a";return m.jsxDEV(a,{ref:n,className:Ae("transition-colors hover:text-foreground",r),...t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:51,columnNumber:5},void 0)});z8.displayName="BreadcrumbLink";const $8=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("span",{ref:t,role:"link","aria-disabled":"true","aria-current":"page",className:Ae("font-normal text-foreground",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:64,columnNumber:3},void 0));$8.displayName="BreadcrumbPage";const G8=({children:e,className:r,...t})=>m.jsxDEV("li",{role:"presentation","aria-hidden":"true",className:Ae("[&>svg]:w-3.5 [&>svg]:h-3.5",r),...t,children:e??m.jsxDEV(Xc,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:86,columnNumber:18},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:80,columnNumber:3},void 0);G8.displayName="BreadcrumbSeparator";const zy=[{stars:1,label:"Unkempt Neglect",description:"Crisis"},{stars:2,label:"Moderate Dinginess",description:"Reactive"},{stars:3,label:"Casual Inattention",description:"Managed Care"},{stars:4,label:"Ordinary Tidiness",description:"Comprehensive Care"},{stars:5,label:"Orderly Spotlessness",description:"Showpiece Facility"}],W8=[{key:"floors",label:"Floors",criteria:{5:"Floors and base moldings shine and/or are bright and clean; colors are fresh. No dirt buildup in corners or along walls.",4:"Floors and base moldings shine and/or are bright and clean. There is no buildup in corners along walls, but there can be up to two days' worth of dust, dirt, stains, or streaks.",3:"Floors are swept or vacuumed clean, but upon close observation there can be stains. A buildup of dirt and/or floor finish in corners and along walls can be seen. There are dull spots and/or matted carpet in walking lanes. Base molding is dull and dingy with streaks or splashes.",2:"Floors are swept or vacuumed clean, but are dull, dingy, and stained. There is an obvious buildup of dirt and/or floor finish in corners and along walls. There is a dull path and/or obviously matted carpet in the walking lanes. Base molding is dull and dingy with streaks or splashes.",1:"Floors and carpet are dull, dirty, dingy, scuffed, and/or matted. There is a conspicuous buildup of old dirt and/or floor finish in corners and along walls. Base molding is dirty, stained, and streaked. Gum, stains, dirt, dust balls, and trash are broadcast."}},{key:"verticalHorizontalSurfaces",label:"Vertical and Horizontal Surfaces",criteria:{5:"All vertical and horizontal surfaces have a freshly cleaned or polished appearance and have no accumulation of dust, dirt, marks, streaks, smudges, or fingerprints. Windows, glass, sills, frames, and related surfaces are free of dust, smudges, fingerprints etc.",4:"All vertical and horizontal surfaces are clean, but marks, dust, smudges, and fingerprints are noticeable upon close observation. Windows appear clean, but on close inspection marks, dust, cobwebs may be found. Sills and frames may have visible dust, dirt, or cobwebs on them.",3:"All vertical and horizontal surfaces have obvious dust, dirt, marks, smudges, and fingerprints. Windows frames are dusty and dirty, window glass is acceptable but it is obvious they have not been cleaned.",2:"All vertical and horizontal surfaces have conspicuous dust, dirt, smudges, fingerprints, and marks. At a quick glance windows are visibly dirty.",1:"All vertical and horizontal surfaces have major accumulations of dust, dirt, smudges, and fingerprints, all of which will be difficult to remove. Lack of attention is obvious. Window glass has obvious smudges, dirt, and marks. Frames are visibly dirty, dusty, and cobwebs are appearing."}},{key:"ceiling",label:"Ceiling",criteria:{5:"Ceilings and air vents are clean and free of dust/debris including cobwebs. No deficiencies.",4:"Ceilings and air vents are clean but dust/debris/cobwebs are noticeable upon close inspection.",3:"Ceilings and air vents have obvious dust/debris/cobwebs.",2:"Ceilings and air vents have conspicuous dust/debris/cobwebs.",1:"Ceilings and air vents have major accumulation of dust/debris/cobwebs."}},{key:"restrooms",label:"Restrooms",criteria:{5:"Consistent Monitoring: Restrooms must be regularly checked for use and cleanliness. Stocked and Maintained: Supplies (soap, paper products, etc.) must be fully stocked at all times. Spotless and Polished: Surfaces must be free of dirt, smudges, and water stains, with polished fixtures and mirrors. Graffiti-Free: No graffiti or defacement is present. Pleasant Odor: Restrooms must have a fresh, pleasant scent with no unpleasant odors.",4:"Routine Monitoring: Restrooms are checked regularly but may have minor lapses between inspections. Adequately Stocked: Supplies are generally available, though occasional low stock may occur. Clean but Lived-In: Surfaces are mostly clean, but minor smudges, water spots, or streaks may be present. Graffiti-Free: No significant graffiti, though faint markings or minor blemishes may be visible. Neutral Odor: The restroom has no strong odorsâ€”neither noticeably fresh nor unpleasant.",3:"Infrequent Monitoring: Restrooms are checked sporadically, leading to noticeable gaps in maintenance. Partially Stocked: Supplies are inconsistentâ€”some items may be low or temporarily unavailable. Visible Wear: Surfaces show clear signs of use, including smudges, water spots, and minor grime. Minor Graffiti: Small or faint graffiti, scratches, or markings are present but not overwhelming. Slight Odor: A faint but noticeable stale or musty odor may be present, though not overpowering.",2:"Inconsistent Monitoring: Restrooms are rarely checked, leading to noticeable lapses in cleanliness and maintenance. Low Stock: Many supplies are missing, and those that remain are often running low. Dirty Surfaces: Surfaces show significant grime, stains, and streaks. Cleaning is overdue, and the overall appearance is visibly unkempt. Graffiti and Damage: Obvious graffiti, markings, or damage is present in several areas. Unpleasant Odor: A strong, unpleasant odor may be present, creating a noticeable discomfort for users.",1:"Rare or No Monitoring: Restrooms are infrequently checked or completely overlooked, leading to prolonged periods of neglect. No Stock: Essential supplies are completely absent or inadequate, with no immediate plans to restock. Filthy Surfaces: Surfaces are visibly dirty, with heavy stains, grime, and possibly mold or mildew. The overall environment is unsanitary. Extensive Graffiti and Damage: Graffiti, damage, or vandalism is widespread and has not been addressed. Strong, Offensive Odor: The restroom emits a strong, unpleasant odor, often foul, making the space uncomfortable and potentially unsanitary."}},{key:"customerSatisfaction",label:"Customer Satisfaction and Coordination",criteria:{5:"Proud of facilities, have a high level of trust for the custodial organization.",4:"Satisfied with custodial-related services, usually complimentary of custodial staff.",3:"Accustomed to basic level of custodial care. Generally able to perform mission duties. Lack of pride in physical environment.",2:"Generally critical of cost, responsiveness, and quality of custodial services.",1:"Consistent customer ridicule, mistrust of custodial services."}},{key:"trash",label:"Trash",criteria:{5:"Interior trash cans only hold daily waste, and are clean and free from odor. Dumpster area is free from litter, dumpsters are closed and if applicable after hours locked. Exterior grounds are free from litter, and exterior trash cans are well placed and maintained.",4:"Most interior trash cans only hold daily waste, and are largely clean and free from odor. Dumpster area is free from litter, dumpsters are closed and if applicable after hours locked. Exterior grounds have some litter but appear to be regularly tended to. Exterior trash cans are present, maintenance is frequency of emptying is unclear but acceptable.",3:"Interior trash is regularly cleared, some cans are ill maintained and have odor. Litter is present near dumpsters. Some litter is blowing around exterior and does not appear to be addressed on a regular basis.",2:"Trash containers smell, are stained and are frequently at capacity with old trash. Litter is present at dumpster area, dumpsters are poorly secured and contributing to exterior litter issues. Exterior litter is present and obvious.",1:"Trash containers smell, are stained and are overflowing with old trash. Dumpster areas are overflowing, litter is present near dumpsters and does not appear regularly cleaned. Exterior litter is present, and affecting the overall appearance of school."}},{key:"projectCleaning",label:"Project Cleaning",criteria:{5:"Break work scope is completed on time and regarded well by school based staff. Items are organized, prioritized, and presented by custodial team. Work exceeds expectations.",4:"Break work scope is mostly completed, however not on time and some work is shifted throughout year. Custodial team organizes most items. Work meets expectations.",3:"Priority break work items are completed, some are pushed to a later date. Items have been organized, prioritized, and presented by school and network. Most of the work meets expectations.",2:"Break work items must be requested and organized by school or network. Some items are not able to be completed. Completed work does not meet expectations.",1:"There are insufficient funds and staffing for project cleaning."}},{key:"activitySupport",label:"Activity Support",criteria:{5:"Activity (athletics, events, afterschool activities) support happens, and is planned along with the weekly routine. All comments are complimentary. Activity support compliments and does not impede regular work.",4:"Activity support happens, and is planned along with the weekly routine. Most comments are complimentary.",3:"Activity support happens, and is planned along with the weekly routine. Work at times do not meet customer expectations. Comments are generally complimentary. Activity support is at the expense of some other duties.",2:"Activity support happens, but staffing is not allocated. Support is done by redirecting staff away from normal custodial duties on a routine basis.",1:"Activity support happens ad hoc and often leads to duties not being completed."}},{key:"safetyCompliance",label:"Safety and Compliance",criteria:{5:"All chemicals are properly labeled, secured, and used in accordance with manufacturer instructions. Gas, propane, and highly combustible items are stored off site. Closets are organized and compliant with DHH regulations.",4:"Most chemicals are properly labeled, secured, and used in accordance with manufacturer instructions. Gas, propane, and highly combustible items are stored off site. Some disorganization and lack of tidiness in closets.",3:"Some chemicals are properly labeled, secured. Proper use of chemicals is not clear, visible misuse of chemicals such as buildup or material damage is present. Gas, propane, and highly combustible items are usually stored off site, though often after use left on campus. Closets are dirty, though organizational and safety systems appear to be present.",2:"Many chemicals not labeled. Proper use of chemicals is not clear, visible misuse of chemicals such as buildup or material damage is present. Gas, propane, and highly combustible items can be found on site. Closets are dirty, no apparent regular organization or safety assessment.",1:"Improper use and knowledge of chemicals is widespread. Closets are consistently disorganized, dirty, and lacking safety precautions. Combustible materials prohibited may be present. It is unclear if there are any organizational or safety systems in place."}},{key:"equipment",label:"Equipment",criteria:{5:"There is sufficient equipment, located within reasonable proximity to the responsible areas. Equipment is kept in good repair and is replaced as needed. Equipment is evaluated and optimized for the tasks at hand. Equipment is being used in facility with regularity.",4:"There is sufficient equipment, located within reasonable proximity to the responsible areas. Equipment is kept in good repair and is replaced as needed. Equipment is evaluated and optimized for the tasks at hand.",3:"There is sufficient equipment, located within reasonable proximity to the responsible areas. Equipment is replaced as needed, but may not be the optimal equipment for the tasks at hand.",2:"Equipment is frequently shared and transported and occasionally in disrepair, but there is a basic inventory of equipment on hand.",1:"There is no or minimal capital investment for custodial operations. Equipment is limited and in disrepair. Staff do not use available equipment and or not trained on operation."}},{key:"monitoring",label:"Monitoring",criteria:{5:"Real-Time Monitoring: A system is in place to track performance and cleanliness frequently, with some elements monitored in real time. Contract Alignment: Performance standards are fully aligned with the specifications outlined in the contract. Responsive Feedback: Feedback from schools is actively sought, quickly addressed, and incorporated into service improvements.",4:"Regular Monitoring: A system is in place to track performance and cleanliness at scheduled intervals, though not in real time. Contract Compliance: Performance generally aligns with contractual standards, with only occasional minor deviations. Feedback Incorporated: Feedback from schools is generally addressed in a timely manner and used to improve services.",3:"Periodic Monitoring: Performance is monitored intermittently, leading to some inconsistencies in cleanliness and efficiency. Partial Contract Compliance: Standards are mostly followed, but occasional oversights or delays occur. Reactive Feedback Response: Feedback from schools is addressed, but often with some delay.",2:"Infrequent Monitoring: Performance is rarely tracked, leading to noticeable inconsistencies. Contract Deviations: Several standards outlined in the contract are not being consistently met. Delayed Feedback Response: Feedback from schools is often ignored or addressed with significant delay.",1:"No Monitoring: Performance is rarely or never tracked, resulting in significant inefficiencies. Contract Non-Compliance: Most contractual standards are not being met. Disregarded Feedback: Feedback from schools is ignored or dismissed."}}];function Voe({message:e="Loading..."}){return m.jsxDEV("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",role:"status","aria-live":"polite","aria-label":e,children:m.jsxDEV("div",{className:"bg-card p-6 rounded-lg shadow-xl max-w-sm w-full mx-4",children:[m.jsxDEV("div",{className:"flex justify-center mb-4",children:m.jsxDEV("div",{className:"animate-spin h-12 w-12 border-4 border-primary border-t-transparent rounded-full","aria-hidden":"true"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:16,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:15,columnNumber:9},this),m.jsxDEV("p",{className:"text-center text-foreground font-medium text-lg",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:23,columnNumber:9},this),m.jsxDEV("span",{className:"sr-only",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:28,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:13,columnNumber:7},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:7,columnNumber:5},this)}const Moe=O4({school:Zt().min(1,"School is required").max(100,"School name too long"),date:Zt().min(1,"Date is required").refine(e=>!isNaN(Date.parse(e)),"Invalid date format"),inspectionType:Ko("single_room").default("single_room"),locationDescription:Zt().min(3,"Please describe the location (minimum 3 characters)").max(500,"Location description too long"),roomNumber:Zt().max(50,"Room number too long").optional().or(Ko("")),locationCategory:Zt().max(100,"Location category too long").optional().or(Ko("")),floors:wn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),verticalHorizontalSurfaces:wn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),ceiling:wn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),restrooms:wn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),customerSatisfaction:wn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),trash:wn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),projectCleaning:wn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),activitySupport:wn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),safetyCompliance:wn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),equipment:wn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),monitoring:wn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),notes:Zt().max(5e3,"Notes too long").optional().or(Ko("")),images:F4(Zt()).max(5,"Maximum 5 images allowed").default([])}),joe={school:"",date:"",inspectionType:"single_room",locationDescription:"",roomNumber:"",locationCategory:"",floors:0,verticalHorizontalSurfaces:0,ceiling:0,restrooms:0,customerSatisfaction:0,trash:0,projectCleaning:0,activitySupport:0,safetyCompliance:0,equipment:0,monitoring:0,notes:"",images:[]},Loe=O4({inspectorName:Zt().min(1,"Inspector name is required").max(100,"Inspector name too long"),school:Zt().min(1,"School is required").max(100,"School name too long"),date:Zt().min(1,"Date is required").refine(e=>!isNaN(Date.parse(e)),"Invalid date format"),location:Zt().min(1,"Location is required").max(200,"Location too long"),locationDescription:Zt().max(500,"Location description too long").optional().or(Ko("")),notes:Zt().min(10,"Please provide a detailed description (minimum 10 characters)").max(5e3,"Notes too long"),images:F4(qV(File)).max(5,"Maximum 5 images allowed").optional().default([])}),Boe={inspectorName:"",school:"",date:new Date().toISOString().split("T")[0],location:"",locationDescription:"",notes:"",images:[]};function qoe({status:e,lastSaved:r,errorMessage:t,className:n=""}){const[a,i]=W.useState("");W.useEffect(()=>{if(!r){i("");return}const l=()=>{const h=new Date().getTime()-r.getTime(),d=Math.floor(h/1e3),v=Math.floor(d/60);d<10?i("just now"):d<60?i(`${d}s ago`):v<60?i(`${v}m ago`):i(r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))};l();const c=setInterval(l,1e4);return()=>clearInterval(c)},[r]);const o=(()=>{switch(e){case"saving":return{icon:u4,text:"Saving...",bgColor:"bg-blue-100 border-blue-300",textColor:"text-blue-800",iconColor:"text-blue-600",animate:!0};case"saved":return{icon:M1,text:a?`Saved ${a}`:"Saved",bgColor:"bg-green-100 border-green-300",textColor:"text-green-800",iconColor:"text-green-600",animate:!1};case"error":return{icon:Ut,text:t||"Save failed",bgColor:"bg-red-100 border-red-300",textColor:"text-red-800",iconColor:"text-red-600",animate:!1};default:return{icon:P1,text:"Not saved",bgColor:"bg-gray-100 border-gray-300",textColor:"text-gray-700",iconColor:"text-gray-500",animate:!1}}})(),u=o.icon;return m.jsxDEV("div",{className:`fixed bottom-4 right-4 z-50 flex items-center gap-2 px-4 py-2 rounded-lg border-2 shadow-lg transition-all duration-200 ${o.bgColor} ${n}`,role:"status","aria-live":"polite",children:[m.jsxDEV(u,{className:`h-4 w-4 ${o.iconColor} ${o.animate?"animate-pulse":""}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/auto-save-indicator.tsx",lineNumber:102,columnNumber:7},this),m.jsxDEV("span",{className:`text-sm font-medium ${o.textColor}`,children:o.text},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/auto-save-indicator.tsx",lineNumber:105,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/auto-save-indicator.tsx",lineNumber:97,columnNumber:5},this)}const NR=W.forwardRef(({className:e,orientation:r="horizontal",decorative:t=!0,...n},a)=>m.jsxDEV(c4,{ref:a,decorative:t,orientation:r,className:Ae("shrink-0 bg-border",r==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/separator.tsx",lineNumber:13,columnNumber:5},void 0));NR.displayName=c4.displayName;const Y8=iV,yR=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(f4,{ref:t,className:Ae("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/tabs.tsx",lineNumber:12,columnNumber:3},void 0));yR.displayName=f4.displayName;const Lg=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(m4,{ref:t,className:Ae("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/tabs.tsx",lineNumber:27,columnNumber:3},void 0));Lg.displayName=m4.displayName;const Bg=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(d4,{ref:t,className:Ae("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/tabs.tsx",lineNumber:42,columnNumber:3},void 0));Bg.displayName=d4.displayName;function Hoe({className:e,...r}){return m.jsxDEV("div",{className:Ae("animate-pulse rounded-md bg-muted",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/skeleton.tsx",lineNumber:8,columnNumber:5},this)}var mm,$y;function $t(){if($y)return mm;$y=1;var e=Array.isArray;return mm=e,mm}var dm,Gy;function CR(){if(Gy)return dm;Gy=1;var e=typeof Pi=="object"&&Pi&&Pi.Object===Object&&Pi;return dm=e,dm}var hm,Wy;function ca(){if(Wy)return hm;Wy=1;var e=CR(),r=typeof self=="object"&&self&&self.Object===Object&&self,t=e||r||Function("return this")();return hm=t,hm}var pm,Yy;function Wl(){if(Yy)return pm;Yy=1;var e=ca(),r=e.Symbol;return pm=r,pm}var vm,Ky;function K8(){if(Ky)return vm;Ky=1;var e=Wl(),r=Object.prototype,t=r.hasOwnProperty,n=r.toString,a=e?e.toStringTag:void 0;function i(s){var o=t.call(s,a),u=s[a];try{s[a]=void 0;var l=!0}catch{}var c=n.call(s);return l&&(o?s[a]=u:delete s[a]),c}return vm=i,vm}var xm,Xy;function X8(){if(Xy)return xm;Xy=1;var e=Object.prototype,r=e.toString;function t(n){return r.call(n)}return xm=t,xm}var gm,Qy;function La(){if(Qy)return gm;Qy=1;var e=Wl(),r=K8(),t=X8(),n="[object Null]",a="[object Undefined]",i=e?e.toStringTag:void 0;function s(o){return o==null?o===void 0?a:n:i&&i in Object(o)?r(o):t(o)}return gm=s,gm}var bm,Zy;function Ba(){if(Zy)return bm;Zy=1;function e(r){return r!=null&&typeof r=="object"}return bm=e,bm}var Nm,Jy;function fo(){if(Jy)return Nm;Jy=1;var e=La(),r=Ba(),t="[object Symbol]";function n(a){return typeof a=="symbol"||r(a)&&e(a)==t}return Nm=n,Nm}var ym,eC;function eb(){if(eC)return ym;eC=1;var e=$t(),r=fo(),t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){if(e(i))return!1;var o=typeof i;return o=="number"||o=="symbol"||o=="boolean"||i==null||r(i)?!0:n.test(i)||!t.test(i)||s!=null&&i in Object(s)}return ym=a,ym}var Cm,rC;function xi(){if(rC)return Cm;rC=1;function e(r){var t=typeof r;return r!=null&&(t=="object"||t=="function")}return Cm=e,Cm}var Em,tC;function rb(){if(tC)return Em;tC=1;var e=La(),r=xi(),t="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",i="[object Proxy]";function s(o){if(!r(o))return!1;var u=e(o);return u==n||u==a||u==t||u==i}return Em=s,Em}var wm,nC;function Q8(){if(nC)return wm;nC=1;var e=ca(),r=e["__core-js_shared__"];return wm=r,wm}var _m,aC;function Z8(){if(aC)return _m;aC=1;var e=Q8(),r=(function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function t(n){return!!r&&r in n}return _m=t,_m}var Sm,iC;function ER(){if(iC)return Sm;iC=1;var e=Function.prototype,r=e.toString;function t(n){if(n!=null){try{return r.call(n)}catch{}try{return n+""}catch{}}return""}return Sm=t,Sm}var Tm,sC;function J8(){if(sC)return Tm;sC=1;var e=rb(),r=Z8(),t=xi(),n=ER(),a=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,u=s.toString,l=o.hasOwnProperty,c=RegExp("^"+u.call(l).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(h){if(!t(h)||r(h))return!1;var d=e(h)?c:i;return d.test(n(h))}return Tm=f,Tm}var Dm,oC;function e6(){if(oC)return Dm;oC=1;function e(r,t){return r?.[t]}return Dm=e,Dm}var Am,lC;function os(){if(lC)return Am;lC=1;var e=J8(),r=e6();function t(n,a){var i=r(n,a);return e(i)?i:void 0}return Am=t,Am}var km,uC;function sf(){if(uC)return km;uC=1;var e=os(),r=e(Object,"create");return km=r,km}var Rm,cC;function r6(){if(cC)return Rm;cC=1;var e=sf();function r(){this.__data__=e?e(null):{},this.size=0}return Rm=r,Rm}var Om,fC;function t6(){if(fC)return Om;fC=1;function e(r){var t=this.has(r)&&delete this.__data__[r];return this.size-=t?1:0,t}return Om=e,Om}var Fm,mC;function n6(){if(mC)return Fm;mC=1;var e=sf(),r="__lodash_hash_undefined__",t=Object.prototype,n=t.hasOwnProperty;function a(i){var s=this.__data__;if(e){var o=s[i];return o===r?void 0:o}return n.call(s,i)?s[i]:void 0}return Fm=a,Fm}var Um,dC;function a6(){if(dC)return Um;dC=1;var e=sf(),r=Object.prototype,t=r.hasOwnProperty;function n(a){var i=this.__data__;return e?i[a]!==void 0:t.call(i,a)}return Um=n,Um}var Im,hC;function i6(){if(hC)return Im;hC=1;var e=sf(),r="__lodash_hash_undefined__";function t(n,a){var i=this.__data__;return this.size+=this.has(n)?0:1,i[n]=e&&a===void 0?r:a,this}return Im=t,Im}var Pm,pC;function s6(){if(pC)return Pm;pC=1;var e=r6(),r=t6(),t=n6(),n=a6(),a=i6();function i(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var l=s[o];this.set(l[0],l[1])}}return i.prototype.clear=e,i.prototype.delete=r,i.prototype.get=t,i.prototype.has=n,i.prototype.set=a,Pm=i,Pm}var Vm,vC;function o6(){if(vC)return Vm;vC=1;function e(){this.__data__=[],this.size=0}return Vm=e,Vm}var Mm,xC;function tb(){if(xC)return Mm;xC=1;function e(r,t){return r===t||r!==r&&t!==t}return Mm=e,Mm}var jm,gC;function of(){if(gC)return jm;gC=1;var e=tb();function r(t,n){for(var a=t.length;a--;)if(e(t[a][0],n))return a;return-1}return jm=r,jm}var Lm,bC;function l6(){if(bC)return Lm;bC=1;var e=of(),r=Array.prototype,t=r.splice;function n(a){var i=this.__data__,s=e(i,a);if(s<0)return!1;var o=i.length-1;return s==o?i.pop():t.call(i,s,1),--this.size,!0}return Lm=n,Lm}var Bm,NC;function u6(){if(NC)return Bm;NC=1;var e=of();function r(t){var n=this.__data__,a=e(n,t);return a<0?void 0:n[a][1]}return Bm=r,Bm}var qm,yC;function c6(){if(yC)return qm;yC=1;var e=of();function r(t){return e(this.__data__,t)>-1}return qm=r,qm}var Hm,CC;function f6(){if(CC)return Hm;CC=1;var e=of();function r(t,n){var a=this.__data__,i=e(a,t);return i<0?(++this.size,a.push([t,n])):a[i][1]=n,this}return Hm=r,Hm}var zm,EC;function lf(){if(EC)return zm;EC=1;var e=o6(),r=l6(),t=u6(),n=c6(),a=f6();function i(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var l=s[o];this.set(l[0],l[1])}}return i.prototype.clear=e,i.prototype.delete=r,i.prototype.get=t,i.prototype.has=n,i.prototype.set=a,zm=i,zm}var $m,wC;function nb(){if(wC)return $m;wC=1;var e=os(),r=ca(),t=e(r,"Map");return $m=t,$m}var Gm,_C;function m6(){if(_C)return Gm;_C=1;var e=s6(),r=lf(),t=nb();function n(){this.size=0,this.__data__={hash:new e,map:new(t||r),string:new e}}return Gm=n,Gm}var Wm,SC;function d6(){if(SC)return Wm;SC=1;function e(r){var t=typeof r;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?r!=="__proto__":r===null}return Wm=e,Wm}var Ym,TC;function uf(){if(TC)return Ym;TC=1;var e=d6();function r(t,n){var a=t.__data__;return e(n)?a[typeof n=="string"?"string":"hash"]:a.map}return Ym=r,Ym}var Km,DC;function h6(){if(DC)return Km;DC=1;var e=uf();function r(t){var n=e(this,t).delete(t);return this.size-=n?1:0,n}return Km=r,Km}var Xm,AC;function p6(){if(AC)return Xm;AC=1;var e=uf();function r(t){return e(this,t).get(t)}return Xm=r,Xm}var Qm,kC;function v6(){if(kC)return Qm;kC=1;var e=uf();function r(t){return e(this,t).has(t)}return Qm=r,Qm}var Zm,RC;function x6(){if(RC)return Zm;RC=1;var e=uf();function r(t,n){var a=e(this,t),i=a.size;return a.set(t,n),this.size+=a.size==i?0:1,this}return Zm=r,Zm}var Jm,OC;function ab(){if(OC)return Jm;OC=1;var e=m6(),r=h6(),t=p6(),n=v6(),a=x6();function i(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var l=s[o];this.set(l[0],l[1])}}return i.prototype.clear=e,i.prototype.delete=r,i.prototype.get=t,i.prototype.has=n,i.prototype.set=a,Jm=i,Jm}var ed,FC;function wR(){if(FC)return ed;FC=1;var e=ab(),r="Expected a function";function t(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(r);var i=function(){var s=arguments,o=a?a.apply(this,s):s[0],u=i.cache;if(u.has(o))return u.get(o);var l=n.apply(this,s);return i.cache=u.set(o,l)||u,l};return i.cache=new(t.Cache||e),i}return t.Cache=e,ed=t,ed}var rd,UC;function g6(){if(UC)return rd;UC=1;var e=wR(),r=500;function t(n){var a=e(n,function(s){return i.size===r&&i.clear(),s}),i=a.cache;return a}return rd=t,rd}var td,IC;function b6(){if(IC)return td;IC=1;var e=g6(),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,t=/\\(\\)?/g,n=e(function(a){var i=[];return a.charCodeAt(0)===46&&i.push(""),a.replace(r,function(s,o,u,l){i.push(u?l.replace(t,"$1"):o||s)}),i});return td=n,td}var nd,PC;function ib(){if(PC)return nd;PC=1;function e(r,t){for(var n=-1,a=r==null?0:r.length,i=Array(a);++n<a;)i[n]=t(r[n],n,r);return i}return nd=e,nd}var ad,VC;function N6(){if(VC)return ad;VC=1;var e=Wl(),r=ib(),t=$t(),n=fo(),a=e?e.prototype:void 0,i=a?a.toString:void 0;function s(o){if(typeof o=="string")return o;if(t(o))return r(o,s)+"";if(n(o))return i?i.call(o):"";var u=o+"";return u=="0"&&1/o==-1/0?"-0":u}return ad=s,ad}var id,MC;function _R(){if(MC)return id;MC=1;var e=N6();function r(t){return t==null?"":e(t)}return id=r,id}var sd,jC;function SR(){if(jC)return sd;jC=1;var e=$t(),r=eb(),t=b6(),n=_R();function a(i,s){return e(i)?i:r(i,s)?[i]:t(n(i))}return sd=a,sd}var od,LC;function cf(){if(LC)return od;LC=1;var e=fo();function r(t){if(typeof t=="string"||e(t))return t;var n=t+"";return n=="0"&&1/t==-1/0?"-0":n}return od=r,od}var ld,BC;function sb(){if(BC)return ld;BC=1;var e=SR(),r=cf();function t(n,a){a=e(a,n);for(var i=0,s=a.length;n!=null&&i<s;)n=n[r(a[i++])];return i&&i==s?n:void 0}return ld=t,ld}var ud,qC;function TR(){if(qC)return ud;qC=1;var e=sb();function r(t,n,a){var i=t==null?void 0:e(t,n);return i===void 0?a:i}return ud=r,ud}var y6=TR();const zoe=nr(y6);var cd,HC;function C6(){if(HC)return cd;HC=1;function e(r){return r==null}return cd=e,cd}var E6=C6();const $oe=nr(E6);var fd,zC;function w6(){if(zC)return fd;zC=1;var e=La(),r=$t(),t=Ba(),n="[object String]";function a(i){return typeof i=="string"||!r(i)&&t(i)&&e(i)==n}return fd=a,fd}var _6=w6();const Goe=nr(_6);var S6=rb();const Woe=nr(S6);var T6=xi();const Yoe=nr(T6);var md,$C;function DR(){if($C)return md;$C=1;var e=La(),r=Ba(),t="[object Number]";function n(a){return typeof a=="number"||r(a)&&e(a)==t}return md=n,md}var dd,GC;function D6(){if(GC)return dd;GC=1;var e=DR();function r(t){return e(t)&&t!=+t}return dd=r,dd}var A6=D6();const Koe=nr(A6);var k6=DR();const Xoe=nr(k6);var hd,WC;function R6(){if(WC)return hd;WC=1;function e(r,t,n){var a=-1,i=r.length;t<0&&(t=-t>i?0:i+t),n=n>i?i:n,n<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var s=Array(i);++a<i;)s[a]=r[a+t];return s}return hd=e,hd}var pd,YC;function O6(){if(YC)return pd;YC=1;var e=R6();function r(t,n,a){var i=t.length;return a=a===void 0?i:a,!n&&a>=i?t:e(t,n,a)}return pd=r,pd}var vd,KC;function AR(){if(KC)return vd;KC=1;var e="\\ud800-\\udfff",r="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=r+t+n,i="\\ufe0e\\ufe0f",s="\\u200d",o=RegExp("["+s+e+a+i+"]");function u(l){return o.test(l)}return vd=u,vd}var xd,XC;function F6(){if(XC)return xd;XC=1;function e(r){return r.split("")}return xd=e,xd}var gd,QC;function U6(){if(QC)return gd;QC=1;var e="\\ud800-\\udfff",r="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=r+t+n,i="\\ufe0e\\ufe0f",s="["+e+"]",o="["+a+"]",u="\\ud83c[\\udffb-\\udfff]",l="(?:"+o+"|"+u+")",c="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",h="[\\ud800-\\udbff][\\udc00-\\udfff]",d="\\u200d",v=l+"?",p="["+i+"]?",x="(?:"+d+"(?:"+[c,f,h].join("|")+")"+p+v+")*",g=p+v+x,N="(?:"+[c+o+"?",o,f,h,s].join("|")+")",b=RegExp(u+"(?="+u+")|"+N+g,"g");function y(_){return _.match(b)||[]}return gd=y,gd}var bd,ZC;function I6(){if(ZC)return bd;ZC=1;var e=F6(),r=AR(),t=U6();function n(a){return r(a)?t(a):e(a)}return bd=n,bd}var Nd,JC;function P6(){if(JC)return Nd;JC=1;var e=O6(),r=AR(),t=I6(),n=_R();function a(i){return function(s){s=n(s);var o=r(s)?t(s):void 0,u=o?o[0]:s.charAt(0),l=o?e(o,1).join(""):s.slice(1);return u[i]()+l}}return Nd=a,Nd}var yd,eE;function V6(){if(eE)return yd;eE=1;var e=P6(),r=e("toUpperCase");return yd=r,yd}var M6=V6();const Qoe=nr(M6);function _r(e){return function(){return e}}const kR=Math.cos,dc=Math.sin,Bn=Math.sqrt,hc=Math.PI,ff=2*hc,qg=Math.PI,Hg=2*qg,Ri=1e-6,j6=Hg-Ri;function RR(e){this._+=e[0];for(let r=1,t=e.length;r<t;++r)this._+=arguments[r]+e[r]}function L6(e){let r=Math.floor(e);if(!(r>=0))throw new Error(`invalid digits: ${e}`);if(r>15)return RR;const t=10**r;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*t)/t+n[a]}}class B6{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?RR:L6(r)}moveTo(r,t){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,t){this._append`L${this._x1=+r},${this._y1=+t}`}quadraticCurveTo(r,t,n,a){this._append`Q${+r},${+t},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(r,t,n,a,i,s){this._append`C${+r},${+t},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(r,t,n,a,i){if(r=+r,t=+t,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,u=n-r,l=a-t,c=s-r,f=o-t,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=r},${this._y1=t}`;else if(h>Ri)if(!(Math.abs(f*u-l*c)>Ri)||!i)this._append`L${this._x1=r},${this._y1=t}`;else{let d=n-s,v=a-o,p=u*u+l*l,x=d*d+v*v,g=Math.sqrt(p),N=Math.sqrt(h),b=i*Math.tan((qg-Math.acos((p+h-x)/(2*g*N)))/2),y=b/N,_=b/g;Math.abs(y-1)>Ri&&this._append`L${r+y*c},${t+y*f}`,this._append`A${i},${i},0,0,${+(f*d>c*v)},${this._x1=r+_*u},${this._y1=t+_*l}`}}arc(r,t,n,a,i,s){if(r=+r,t=+t,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),u=n*Math.sin(a),l=r+o,c=t+u,f=1^s,h=s?a-i:i-a;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>Ri||Math.abs(this._y1-c)>Ri)&&this._append`L${l},${c}`,n&&(h<0&&(h=h%Hg+Hg),h>j6?this._append`A${n},${n},0,1,${f},${r-o},${t-u}A${n},${n},0,1,${f},${this._x1=l},${this._y1=c}`:h>Ri&&this._append`A${n},${n},0,${+(h>=qg)},${f},${this._x1=r+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(r,t,n,a){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+t}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function ob(e){let r=3;return e.digits=function(t){if(!arguments.length)return r;if(t==null)r=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);r=n}return e},()=>new B6(r)}function lb(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function OR(e){this._context=e}OR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:this._context.lineTo(e,r);break}}};function FR(e){return new OR(e)}function UR(e){return e[0]}function IR(e){return e[1]}function q6(e,r){var t=_r(!0),n=null,a=FR,i=null,s=ob(o);e=typeof e=="function"?e:e===void 0?UR:_r(e),r=typeof r=="function"?r:r===void 0?IR:_r(r);function o(u){var l,c=(u=lb(u)).length,f,h=!1,d;for(n==null&&(i=a(d=s())),l=0;l<=c;++l)!(l<c&&t(f=u[l],l,u))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,l,u),+r(f,l,u));if(d)return i=null,d+""||null}return o.x=function(u){return arguments.length?(e=typeof u=="function"?u:_r(+u),o):e},o.y=function(u){return arguments.length?(r=typeof u=="function"?u:_r(+u),o):r},o.defined=function(u){return arguments.length?(t=typeof u=="function"?u:_r(!!u),o):t},o.curve=function(u){return arguments.length?(a=u,n!=null&&(i=a(n)),o):a},o.context=function(u){return arguments.length?(u==null?n=i=null:i=a(n=u),o):n},o}function Zoe(e,r,t){var n=null,a=_r(!0),i=null,s=FR,o=null,u=ob(l);e=typeof e=="function"?e:e===void 0?UR:_r(+e),r=typeof r=="function"?r:_r(r===void 0?0:+r),t=typeof t=="function"?t:t===void 0?IR:_r(+t);function l(f){var h,d,v,p=(f=lb(f)).length,x,g=!1,N,b=new Array(p),y=new Array(p);for(i==null&&(o=s(N=u())),h=0;h<=p;++h){if(!(h<p&&a(x=f[h],h,f))===g)if(g=!g)d=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),v=h-1;v>=d;--v)o.point(b[v],y[v]);o.lineEnd(),o.areaEnd()}g&&(b[h]=+e(x,h,f),y[h]=+r(x,h,f),o.point(n?+n(x,h,f):b[h],t?+t(x,h,f):y[h]))}if(N)return o=null,N+""||null}function c(){return q6().defined(a).curve(s).context(i)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:_r(+f),n=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:_r(+f),l):e},l.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:_r(+f),l):n},l.y=function(f){return arguments.length?(r=typeof f=="function"?f:_r(+f),t=null,l):r},l.y0=function(f){return arguments.length?(r=typeof f=="function"?f:_r(+f),l):r},l.y1=function(f){return arguments.length?(t=f==null?null:typeof f=="function"?f:_r(+f),l):t},l.lineX0=l.lineY0=function(){return c().x(e).y(r)},l.lineY1=function(){return c().x(e).y(t)},l.lineX1=function(){return c().x(n).y(r)},l.defined=function(f){return arguments.length?(a=typeof f=="function"?f:_r(!!f),l):a},l.curve=function(f){return arguments.length?(s=f,i!=null&&(o=s(i)),l):s},l.context=function(f){return arguments.length?(f==null?i=o=null:o=s(i=f),l):i},l}class PR{constructor(r,t){this._context=r,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(r,t){switch(r=+r,t=+t,this._point){case 0:{this._point=1,this._line?this._context.lineTo(r,t):this._context.moveTo(r,t);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+r)/2,this._y0,this._x0,t,r,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,r,this._y0,r,t);break}}this._x0=r,this._y0=t}}function Joe(e){return new PR(e,!0)}function ele(e){return new PR(e,!1)}const H6={draw(e,r){const t=Bn(r/hc);e.moveTo(t,0),e.arc(0,0,t,0,ff)}},rle={draw(e,r){const t=Bn(r/5)/2;e.moveTo(-3*t,-t),e.lineTo(-t,-t),e.lineTo(-t,-3*t),e.lineTo(t,-3*t),e.lineTo(t,-t),e.lineTo(3*t,-t),e.lineTo(3*t,t),e.lineTo(t,t),e.lineTo(t,3*t),e.lineTo(-t,3*t),e.lineTo(-t,t),e.lineTo(-3*t,t),e.closePath()}},VR=Bn(1/3),z6=VR*2,tle={draw(e,r){const t=Bn(r/z6),n=t*VR;e.moveTo(0,-t),e.lineTo(n,0),e.lineTo(0,t),e.lineTo(-n,0),e.closePath()}},nle={draw(e,r){const t=Bn(r),n=-t/2;e.rect(n,n,t,t)}},$6=.8908130915292852,MR=dc(hc/10)/dc(7*hc/10),G6=dc(ff/10)*MR,W6=-kR(ff/10)*MR,ale={draw(e,r){const t=Bn(r*$6),n=G6*t,a=W6*t;e.moveTo(0,-t),e.lineTo(n,a);for(let i=1;i<5;++i){const s=ff*i/5,o=kR(s),u=dc(s);e.lineTo(u*t,-o*t),e.lineTo(o*n-u*a,u*n+o*a)}e.closePath()}},Cd=Bn(3),ile={draw(e,r){const t=-Bn(r/(Cd*3));e.moveTo(0,t*2),e.lineTo(-Cd*t,-t),e.lineTo(Cd*t,-t),e.closePath()}},cn=-.5,fn=Bn(3)/2,zg=1/Bn(12),Y6=(zg/2+1)*3,sle={draw(e,r){const t=Bn(r/Y6),n=t/2,a=t*zg,i=n,s=t*zg+t,o=-i,u=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(o,u),e.lineTo(cn*n-fn*a,fn*n+cn*a),e.lineTo(cn*i-fn*s,fn*i+cn*s),e.lineTo(cn*o-fn*u,fn*o+cn*u),e.lineTo(cn*n+fn*a,cn*a-fn*n),e.lineTo(cn*i+fn*s,cn*s-fn*i),e.lineTo(cn*o+fn*u,cn*u-fn*o),e.closePath()}};function ole(e,r){let t=null,n=ob(a);e=typeof e=="function"?e:_r(e||H6),r=typeof r=="function"?r:_r(r===void 0?64:+r);function a(){let i;if(t||(t=i=n()),e.apply(this,arguments).draw(t,+r.apply(this,arguments)),i)return t=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:_r(i),a):e},a.size=function(i){return arguments.length?(r=typeof i=="function"?i:_r(+i),a):r},a.context=function(i){return arguments.length?(t=i??null,a):t},a}function pc(){}function vc(e,r,t){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+r)/6,(e._y0+4*e._y1+t)/6)}function jR(e){this._context=e}jR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:vc(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:vc(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function lle(e){return new jR(e)}function LR(e){this._context=e}LR.prototype={areaStart:pc,areaEnd:pc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._x2=e,this._y2=r;break;case 1:this._point=2,this._x3=e,this._y3=r;break;case 2:this._point=3,this._x4=e,this._y4=r,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+r)/6);break;default:vc(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function ule(e){return new LR(e)}function BR(e){this._context=e}BR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var t=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+r)/6;this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 3:this._point=4;default:vc(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function cle(e){return new BR(e)}function qR(e){this._context=e}qR.prototype={areaStart:pc,areaEnd:pc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,r){e=+e,r=+r,this._point?this._context.lineTo(e,r):(this._point=1,this._context.moveTo(e,r))}};function fle(e){return new qR(e)}function rE(e){return e<0?-1:1}function tE(e,r,t){var n=e._x1-e._x0,a=r-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(t-e._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(rE(i)+rE(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function nE(e,r){var t=e._x1-e._x0;return t?(3*(e._y1-e._y0)/t-r)/2:r}function Ed(e,r,t){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-n)/3;e._context.bezierCurveTo(n+o,a+o*r,i-o,s-o*t,i,s)}function xc(e){this._context=e}xc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ed(this,this._t0,nE(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){var t=NaN;if(e=+e,r=+r,!(e===this._x1&&r===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,Ed(this,nE(this,t=tE(this,e,r)),t);break;default:Ed(this,this._t0,t=tE(this,e,r));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r,this._t0=t}}};function HR(e){this._context=new zR(e)}(HR.prototype=Object.create(xc.prototype)).point=function(e,r){xc.prototype.point.call(this,r,e)};function zR(e){this._context=e}zR.prototype={moveTo:function(e,r){this._context.moveTo(r,e)},closePath:function(){this._context.closePath()},lineTo:function(e,r){this._context.lineTo(r,e)},bezierCurveTo:function(e,r,t,n,a,i){this._context.bezierCurveTo(r,e,n,t,i,a)}};function mle(e){return new xc(e)}function dle(e){return new HR(e)}function $R(e){this._context=e}$R.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,r=this._y,t=e.length;if(t)if(this._line?this._context.lineTo(e[0],r[0]):this._context.moveTo(e[0],r[0]),t===2)this._context.lineTo(e[1],r[1]);else for(var n=aE(e),a=aE(r),i=0,s=1;s<t;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],r[s]);(this._line||this._line!==0&&t===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,r){this._x.push(+e),this._y.push(+r)}};function aE(e){var r,t=e.length-1,n,a=new Array(t),i=new Array(t),s=new Array(t);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],r=1;r<t-1;++r)a[r]=1,i[r]=4,s[r]=4*e[r]+2*e[r+1];for(a[t-1]=2,i[t-1]=7,s[t-1]=8*e[t-1]+e[t],r=1;r<t;++r)n=a[r]/i[r-1],i[r]-=n,s[r]-=n*s[r-1];for(a[t-1]=s[t-1]/i[t-1],r=t-2;r>=0;--r)a[r]=(s[r]-a[r+1])/i[r];for(i[t-1]=(e[t]+a[t-1])/2,r=0;r<t-1;++r)i[r]=2*e[r+1]-a[r+1];return[a,i]}function hle(e){return new $R(e)}function mf(e,r){this._context=e,this._t=r}mf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,r),this._context.lineTo(e,r);else{var t=this._x*(1-this._t)+e*this._t;this._context.lineTo(t,this._y),this._context.lineTo(t,r)}break}}this._x=e,this._y=r}};function ple(e){return new mf(e,.5)}function vle(e){return new mf(e,0)}function xle(e){return new mf(e,1)}function Nl(e,r){if((s=e.length)>1)for(var t=1,n,a,i=e[r[0]],s,o=i.length;t<s;++t)for(a=i,i=e[r[t]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function iE(e){for(var r=e.length,t=new Array(r);--r>=0;)t[r]=r;return t}function K6(e,r){return e[r]}function X6(e){const r=[];return r.key=e,r}function gle(){var e=_r([]),r=iE,t=Nl,n=K6;function a(i){var s=Array.from(e.apply(this,arguments),X6),o,u=s.length,l=-1,c;for(const f of i)for(o=0,++l;o<u;++o)(s[o][l]=[0,+n(f,s[o].key,l,i)]).data=f;for(o=0,c=lb(r(s));o<u;++o)s[c[o]].index=o;return t(s,c),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:_r(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:_r(+i),a):n},a.order=function(i){return arguments.length?(r=i==null?iE:typeof i=="function"?i:_r(Array.from(i)),a):r},a.offset=function(i){return arguments.length?(t=i??Nl,a):t},a}function ble(e,r){if((n=e.length)>0){for(var t,n,a=0,i=e[0].length,s;a<i;++a){for(s=t=0;t<n;++t)s+=e[t][a][1]||0;if(s)for(t=0;t<n;++t)e[t][a][1]/=s}Nl(e,r)}}function Nle(e,r){if((a=e.length)>0){for(var t=0,n=e[r[0]],a,i=n.length;t<i;++t){for(var s=0,o=0;s<a;++s)o+=e[s][t][1]||0;n[t][1]+=n[t][0]=-o/2}Nl(e,r)}}function yle(e,r){if(!(!((s=e.length)>0)||!((i=(a=e[r[0]]).length)>0))){for(var t=0,n=1,a,i,s;n<i;++n){for(var o=0,u=0,l=0;o<s;++o){for(var c=e[r[o]],f=c[n][1]||0,h=c[n-1][1]||0,d=(f-h)/2,v=0;v<o;++v){var p=e[r[v]],x=p[n][1]||0,g=p[n-1][1]||0;d+=x-g}u+=f,l+=d*f}a[n-1][1]+=a[n-1][0]=t,u&&(t-=l/u)}a[n-1][1]+=a[n-1][0]=t,Nl(e,r)}}var wd,sE;function Q6(){if(sE)return wd;sE=1;var e=lf();function r(){this.__data__=new e,this.size=0}return wd=r,wd}var _d,oE;function Z6(){if(oE)return _d;oE=1;function e(r){var t=this.__data__,n=t.delete(r);return this.size=t.size,n}return _d=e,_d}var Sd,lE;function J6(){if(lE)return Sd;lE=1;function e(r){return this.__data__.get(r)}return Sd=e,Sd}var Td,uE;function eL(){if(uE)return Td;uE=1;function e(r){return this.__data__.has(r)}return Td=e,Td}var Dd,cE;function rL(){if(cE)return Dd;cE=1;var e=lf(),r=nb(),t=ab(),n=200;function a(i,s){var o=this.__data__;if(o instanceof e){var u=o.__data__;if(!r||u.length<n-1)return u.push([i,s]),this.size=++o.size,this;o=this.__data__=new t(u)}return o.set(i,s),this.size=o.size,this}return Dd=a,Dd}var Ad,fE;function GR(){if(fE)return Ad;fE=1;var e=lf(),r=Q6(),t=Z6(),n=J6(),a=eL(),i=rL();function s(o){var u=this.__data__=new e(o);this.size=u.size}return s.prototype.clear=r,s.prototype.delete=t,s.prototype.get=n,s.prototype.has=a,s.prototype.set=i,Ad=s,Ad}var kd,mE;function tL(){if(mE)return kd;mE=1;var e="__lodash_hash_undefined__";function r(t){return this.__data__.set(t,e),this}return kd=r,kd}var Rd,dE;function nL(){if(dE)return Rd;dE=1;function e(r){return this.__data__.has(r)}return Rd=e,Rd}var Od,hE;function WR(){if(hE)return Od;hE=1;var e=ab(),r=tL(),t=nL();function n(a){var i=-1,s=a==null?0:a.length;for(this.__data__=new e;++i<s;)this.add(a[i])}return n.prototype.add=n.prototype.push=r,n.prototype.has=t,Od=n,Od}var Fd,pE;function YR(){if(pE)return Fd;pE=1;function e(r,t){for(var n=-1,a=r==null?0:r.length;++n<a;)if(t(r[n],n,r))return!0;return!1}return Fd=e,Fd}var Ud,vE;function KR(){if(vE)return Ud;vE=1;function e(r,t){return r.has(t)}return Ud=e,Ud}var Id,xE;function XR(){if(xE)return Id;xE=1;var e=WR(),r=YR(),t=KR(),n=1,a=2;function i(s,o,u,l,c,f){var h=u&n,d=s.length,v=o.length;if(d!=v&&!(h&&v>d))return!1;var p=f.get(s),x=f.get(o);if(p&&x)return p==o&&x==s;var g=-1,N=!0,b=u&a?new e:void 0;for(f.set(s,o),f.set(o,s);++g<d;){var y=s[g],_=o[g];if(l)var w=h?l(_,y,g,o,s,f):l(y,_,g,s,o,f);if(w!==void 0){if(w)continue;N=!1;break}if(b){if(!r(o,function(C,k){if(!t(b,k)&&(y===C||c(y,C,u,l,f)))return b.push(k)})){N=!1;break}}else if(!(y===_||c(y,_,u,l,f))){N=!1;break}}return f.delete(s),f.delete(o),N}return Id=i,Id}var Pd,gE;function aL(){if(gE)return Pd;gE=1;var e=ca(),r=e.Uint8Array;return Pd=r,Pd}var Vd,bE;function iL(){if(bE)return Vd;bE=1;function e(r){var t=-1,n=Array(r.size);return r.forEach(function(a,i){n[++t]=[i,a]}),n}return Vd=e,Vd}var Md,NE;function ub(){if(NE)return Md;NE=1;function e(r){var t=-1,n=Array(r.size);return r.forEach(function(a){n[++t]=a}),n}return Md=e,Md}var jd,yE;function sL(){if(yE)return jd;yE=1;var e=Wl(),r=aL(),t=tb(),n=XR(),a=iL(),i=ub(),s=1,o=2,u="[object Boolean]",l="[object Date]",c="[object Error]",f="[object Map]",h="[object Number]",d="[object RegExp]",v="[object Set]",p="[object String]",x="[object Symbol]",g="[object ArrayBuffer]",N="[object DataView]",b=e?e.prototype:void 0,y=b?b.valueOf:void 0;function _(w,C,k,D,U,F,L){switch(k){case N:if(w.byteLength!=C.byteLength||w.byteOffset!=C.byteOffset)return!1;w=w.buffer,C=C.buffer;case g:return!(w.byteLength!=C.byteLength||!F(new r(w),new r(C)));case u:case l:case h:return t(+w,+C);case c:return w.name==C.name&&w.message==C.message;case d:case p:return w==C+"";case f:var P=a;case v:var B=D&s;if(P||(P=i),w.size!=C.size&&!B)return!1;var G=L.get(w);if(G)return G==C;D|=o,L.set(w,C);var ue=n(P(w),P(C),D,U,F,L);return L.delete(w),ue;case x:if(y)return y.call(w)==y.call(C)}return!1}return jd=_,jd}var Ld,CE;function QR(){if(CE)return Ld;CE=1;function e(r,t){for(var n=-1,a=t.length,i=r.length;++n<a;)r[i+n]=t[n];return r}return Ld=e,Ld}var Bd,EE;function oL(){if(EE)return Bd;EE=1;var e=QR(),r=$t();function t(n,a,i){var s=a(n);return r(n)?s:e(s,i(n))}return Bd=t,Bd}var qd,wE;function lL(){if(wE)return qd;wE=1;function e(r,t){for(var n=-1,a=r==null?0:r.length,i=0,s=[];++n<a;){var o=r[n];t(o,n,r)&&(s[i++]=o)}return s}return qd=e,qd}var Hd,_E;function uL(){if(_E)return Hd;_E=1;function e(){return[]}return Hd=e,Hd}var zd,SE;function cL(){if(SE)return zd;SE=1;var e=lL(),r=uL(),t=Object.prototype,n=t.propertyIsEnumerable,a=Object.getOwnPropertySymbols,i=a?function(s){return s==null?[]:(s=Object(s),e(a(s),function(o){return n.call(s,o)}))}:r;return zd=i,zd}var $d,TE;function fL(){if(TE)return $d;TE=1;function e(r,t){for(var n=-1,a=Array(r);++n<r;)a[n]=t(n);return a}return $d=e,$d}var Gd,DE;function mL(){if(DE)return Gd;DE=1;var e=La(),r=Ba(),t="[object Arguments]";function n(a){return r(a)&&e(a)==t}return Gd=n,Gd}var Wd,AE;function cb(){if(AE)return Wd;AE=1;var e=mL(),r=Ba(),t=Object.prototype,n=t.hasOwnProperty,a=t.propertyIsEnumerable,i=e((function(){return arguments})())?e:function(s){return r(s)&&n.call(s,"callee")&&!a.call(s,"callee")};return Wd=i,Wd}var Xo={exports:{}},Yd,kE;function dL(){if(kE)return Yd;kE=1;function e(){return!1}return Yd=e,Yd}Xo.exports;var RE;function ZR(){return RE||(RE=1,(function(e,r){var t=ca(),n=dL(),a=r&&!r.nodeType&&r,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,o=s?t.Buffer:void 0,u=o?o.isBuffer:void 0,l=u||n;e.exports=l})(Xo,Xo.exports)),Xo.exports}var Kd,OE;function fb(){if(OE)return Kd;OE=1;var e=9007199254740991,r=/^(?:0|[1-9]\d*)$/;function t(n,a){var i=typeof n;return a=a??e,!!a&&(i=="number"||i!="symbol"&&r.test(n))&&n>-1&&n%1==0&&n<a}return Kd=t,Kd}var Xd,FE;function mb(){if(FE)return Xd;FE=1;var e=9007199254740991;function r(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=e}return Xd=r,Xd}var Qd,UE;function hL(){if(UE)return Qd;UE=1;var e=La(),r=mb(),t=Ba(),n="[object Arguments]",a="[object Array]",i="[object Boolean]",s="[object Date]",o="[object Error]",u="[object Function]",l="[object Map]",c="[object Number]",f="[object Object]",h="[object RegExp]",d="[object Set]",v="[object String]",p="[object WeakMap]",x="[object ArrayBuffer]",g="[object DataView]",N="[object Float32Array]",b="[object Float64Array]",y="[object Int8Array]",_="[object Int16Array]",w="[object Int32Array]",C="[object Uint8Array]",k="[object Uint8ClampedArray]",D="[object Uint16Array]",U="[object Uint32Array]",F={};F[N]=F[b]=F[y]=F[_]=F[w]=F[C]=F[k]=F[D]=F[U]=!0,F[n]=F[a]=F[x]=F[i]=F[g]=F[s]=F[o]=F[u]=F[l]=F[c]=F[f]=F[h]=F[d]=F[v]=F[p]=!1;function L(P){return t(P)&&r(P.length)&&!!F[e(P)]}return Qd=L,Qd}var Zd,IE;function JR(){if(IE)return Zd;IE=1;function e(r){return function(t){return r(t)}}return Zd=e,Zd}var Qo={exports:{}};Qo.exports;var PE;function pL(){return PE||(PE=1,(function(e,r){var t=CR(),n=r&&!r.nodeType&&r,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&t.process,o=(function(){try{var u=a&&a.require&&a.require("util").types;return u||s&&s.binding&&s.binding("util")}catch{}})();e.exports=o})(Qo,Qo.exports)),Qo.exports}var Jd,VE;function eO(){if(VE)return Jd;VE=1;var e=hL(),r=JR(),t=pL(),n=t&&t.isTypedArray,a=n?r(n):e;return Jd=a,Jd}var eh,ME;function vL(){if(ME)return eh;ME=1;var e=fL(),r=cb(),t=$t(),n=ZR(),a=fb(),i=eO(),s=Object.prototype,o=s.hasOwnProperty;function u(l,c){var f=t(l),h=!f&&r(l),d=!f&&!h&&n(l),v=!f&&!h&&!d&&i(l),p=f||h||d||v,x=p?e(l.length,String):[],g=x.length;for(var N in l)(c||o.call(l,N))&&!(p&&(N=="length"||d&&(N=="offset"||N=="parent")||v&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||a(N,g)))&&x.push(N);return x}return eh=u,eh}var rh,jE;function xL(){if(jE)return rh;jE=1;var e=Object.prototype;function r(t){var n=t&&t.constructor,a=typeof n=="function"&&n.prototype||e;return t===a}return rh=r,rh}var th,LE;function rO(){if(LE)return th;LE=1;function e(r,t){return function(n){return r(t(n))}}return th=e,th}var nh,BE;function gL(){if(BE)return nh;BE=1;var e=rO(),r=e(Object.keys,Object);return nh=r,nh}var ah,qE;function bL(){if(qE)return ah;qE=1;var e=xL(),r=gL(),t=Object.prototype,n=t.hasOwnProperty;function a(i){if(!e(i))return r(i);var s=[];for(var o in Object(i))n.call(i,o)&&o!="constructor"&&s.push(o);return s}return ah=a,ah}var ih,HE;function Yl(){if(HE)return ih;HE=1;var e=rb(),r=mb();function t(n){return n!=null&&r(n.length)&&!e(n)}return ih=t,ih}var sh,zE;function df(){if(zE)return sh;zE=1;var e=vL(),r=bL(),t=Yl();function n(a){return t(a)?e(a):r(a)}return sh=n,sh}var oh,$E;function NL(){if($E)return oh;$E=1;var e=oL(),r=cL(),t=df();function n(a){return e(a,t,r)}return oh=n,oh}var lh,GE;function yL(){if(GE)return lh;GE=1;var e=NL(),r=1,t=Object.prototype,n=t.hasOwnProperty;function a(i,s,o,u,l,c){var f=o&r,h=e(i),d=h.length,v=e(s),p=v.length;if(d!=p&&!f)return!1;for(var x=d;x--;){var g=h[x];if(!(f?g in s:n.call(s,g)))return!1}var N=c.get(i),b=c.get(s);if(N&&b)return N==s&&b==i;var y=!0;c.set(i,s),c.set(s,i);for(var _=f;++x<d;){g=h[x];var w=i[g],C=s[g];if(u)var k=f?u(C,w,g,s,i,c):u(w,C,g,i,s,c);if(!(k===void 0?w===C||l(w,C,o,u,c):k)){y=!1;break}_||(_=g=="constructor")}if(y&&!_){var D=i.constructor,U=s.constructor;D!=U&&"constructor"in i&&"constructor"in s&&!(typeof D=="function"&&D instanceof D&&typeof U=="function"&&U instanceof U)&&(y=!1)}return c.delete(i),c.delete(s),y}return lh=a,lh}var uh,WE;function CL(){if(WE)return uh;WE=1;var e=os(),r=ca(),t=e(r,"DataView");return uh=t,uh}var ch,YE;function EL(){if(YE)return ch;YE=1;var e=os(),r=ca(),t=e(r,"Promise");return ch=t,ch}var fh,KE;function tO(){if(KE)return fh;KE=1;var e=os(),r=ca(),t=e(r,"Set");return fh=t,fh}var mh,XE;function wL(){if(XE)return mh;XE=1;var e=os(),r=ca(),t=e(r,"WeakMap");return mh=t,mh}var dh,QE;function _L(){if(QE)return dh;QE=1;var e=CL(),r=nb(),t=EL(),n=tO(),a=wL(),i=La(),s=ER(),o="[object Map]",u="[object Object]",l="[object Promise]",c="[object Set]",f="[object WeakMap]",h="[object DataView]",d=s(e),v=s(r),p=s(t),x=s(n),g=s(a),N=i;return(e&&N(new e(new ArrayBuffer(1)))!=h||r&&N(new r)!=o||t&&N(t.resolve())!=l||n&&N(new n)!=c||a&&N(new a)!=f)&&(N=function(b){var y=i(b),_=y==u?b.constructor:void 0,w=_?s(_):"";if(w)switch(w){case d:return h;case v:return o;case p:return l;case x:return c;case g:return f}return y}),dh=N,dh}var hh,ZE;function SL(){if(ZE)return hh;ZE=1;var e=GR(),r=XR(),t=sL(),n=yL(),a=_L(),i=$t(),s=ZR(),o=eO(),u=1,l="[object Arguments]",c="[object Array]",f="[object Object]",h=Object.prototype,d=h.hasOwnProperty;function v(p,x,g,N,b,y){var _=i(p),w=i(x),C=_?c:a(p),k=w?c:a(x);C=C==l?f:C,k=k==l?f:k;var D=C==f,U=k==f,F=C==k;if(F&&s(p)){if(!s(x))return!1;_=!0,D=!1}if(F&&!D)return y||(y=new e),_||o(p)?r(p,x,g,N,b,y):t(p,x,C,g,N,b,y);if(!(g&u)){var L=D&&d.call(p,"__wrapped__"),P=U&&d.call(x,"__wrapped__");if(L||P){var B=L?p.value():p,G=P?x.value():x;return y||(y=new e),b(B,G,g,N,y)}}return F?(y||(y=new e),n(p,x,g,N,b,y)):!1}return hh=v,hh}var ph,JE;function db(){if(JE)return ph;JE=1;var e=SL(),r=Ba();function t(n,a,i,s,o){return n===a?!0:n==null||a==null||!r(n)&&!r(a)?n!==n&&a!==a:e(n,a,i,s,t,o)}return ph=t,ph}var vh,ew;function TL(){if(ew)return vh;ew=1;var e=GR(),r=db(),t=1,n=2;function a(i,s,o,u){var l=o.length,c=l,f=!u;if(i==null)return!c;for(i=Object(i);l--;){var h=o[l];if(f&&h[2]?h[1]!==i[h[0]]:!(h[0]in i))return!1}for(;++l<c;){h=o[l];var d=h[0],v=i[d],p=h[1];if(f&&h[2]){if(v===void 0&&!(d in i))return!1}else{var x=new e;if(u)var g=u(v,p,d,i,s,x);if(!(g===void 0?r(p,v,t|n,u,x):g))return!1}}return!0}return vh=a,vh}var xh,rw;function nO(){if(rw)return xh;rw=1;var e=xi();function r(t){return t===t&&!e(t)}return xh=r,xh}var gh,tw;function DL(){if(tw)return gh;tw=1;var e=nO(),r=df();function t(n){for(var a=r(n),i=a.length;i--;){var s=a[i],o=n[s];a[i]=[s,o,e(o)]}return a}return gh=t,gh}var bh,nw;function aO(){if(nw)return bh;nw=1;function e(r,t){return function(n){return n==null?!1:n[r]===t&&(t!==void 0||r in Object(n))}}return bh=e,bh}var Nh,aw;function AL(){if(aw)return Nh;aw=1;var e=TL(),r=DL(),t=aO();function n(a){var i=r(a);return i.length==1&&i[0][2]?t(i[0][0],i[0][1]):function(s){return s===a||e(s,a,i)}}return Nh=n,Nh}var yh,iw;function kL(){if(iw)return yh;iw=1;function e(r,t){return r!=null&&t in Object(r)}return yh=e,yh}var Ch,sw;function RL(){if(sw)return Ch;sw=1;var e=SR(),r=cb(),t=$t(),n=fb(),a=mb(),i=cf();function s(o,u,l){u=e(u,o);for(var c=-1,f=u.length,h=!1;++c<f;){var d=i(u[c]);if(!(h=o!=null&&l(o,d)))break;o=o[d]}return h||++c!=f?h:(f=o==null?0:o.length,!!f&&a(f)&&n(d,f)&&(t(o)||r(o)))}return Ch=s,Ch}var Eh,ow;function OL(){if(ow)return Eh;ow=1;var e=kL(),r=RL();function t(n,a){return n!=null&&r(n,a,e)}return Eh=t,Eh}var wh,lw;function FL(){if(lw)return wh;lw=1;var e=db(),r=TR(),t=OL(),n=eb(),a=nO(),i=aO(),s=cf(),o=1,u=2;function l(c,f){return n(c)&&a(f)?i(s(c),f):function(h){var d=r(h,c);return d===void 0&&d===f?t(h,c):e(f,d,o|u)}}return wh=l,wh}var _h,uw;function mo(){if(uw)return _h;uw=1;function e(r){return r}return _h=e,_h}var Sh,cw;function UL(){if(cw)return Sh;cw=1;function e(r){return function(t){return t?.[r]}}return Sh=e,Sh}var Th,fw;function IL(){if(fw)return Th;fw=1;var e=sb();function r(t){return function(n){return e(n,t)}}return Th=r,Th}var Dh,mw;function PL(){if(mw)return Dh;mw=1;var e=UL(),r=IL(),t=eb(),n=cf();function a(i){return t(i)?e(n(i)):r(i)}return Dh=a,Dh}var Ah,dw;function fa(){if(dw)return Ah;dw=1;var e=AL(),r=FL(),t=mo(),n=$t(),a=PL();function i(s){return typeof s=="function"?s:s==null?t:typeof s=="object"?n(s)?r(s[0],s[1]):e(s):a(s)}return Ah=i,Ah}var kh,hw;function iO(){if(hw)return kh;hw=1;function e(r,t,n,a){for(var i=r.length,s=n+(a?1:-1);a?s--:++s<i;)if(t(r[s],s,r))return s;return-1}return kh=e,kh}var Rh,pw;function VL(){if(pw)return Rh;pw=1;function e(r){return r!==r}return Rh=e,Rh}var Oh,vw;function ML(){if(vw)return Oh;vw=1;function e(r,t,n){for(var a=n-1,i=r.length;++a<i;)if(r[a]===t)return a;return-1}return Oh=e,Oh}var Fh,xw;function jL(){if(xw)return Fh;xw=1;var e=iO(),r=VL(),t=ML();function n(a,i,s){return i===i?t(a,i,s):e(a,r,s)}return Fh=n,Fh}var Uh,gw;function LL(){if(gw)return Uh;gw=1;var e=jL();function r(t,n){var a=t==null?0:t.length;return!!a&&e(t,n,0)>-1}return Uh=r,Uh}var Ih,bw;function BL(){if(bw)return Ih;bw=1;function e(r,t,n){for(var a=-1,i=r==null?0:r.length;++a<i;)if(n(t,r[a]))return!0;return!1}return Ih=e,Ih}var Ph,Nw;function qL(){if(Nw)return Ph;Nw=1;function e(){}return Ph=e,Ph}var Vh,yw;function HL(){if(yw)return Vh;yw=1;var e=tO(),r=qL(),t=ub(),n=1/0,a=e&&1/t(new e([,-0]))[1]==n?function(i){return new e(i)}:r;return Vh=a,Vh}var Mh,Cw;function zL(){if(Cw)return Mh;Cw=1;var e=WR(),r=LL(),t=BL(),n=KR(),a=HL(),i=ub(),s=200;function o(u,l,c){var f=-1,h=r,d=u.length,v=!0,p=[],x=p;if(c)v=!1,h=t;else if(d>=s){var g=l?null:a(u);if(g)return i(g);v=!1,h=n,x=new e}else x=l?[]:p;e:for(;++f<d;){var N=u[f],b=l?l(N):N;if(N=c||N!==0?N:0,v&&b===b){for(var y=x.length;y--;)if(x[y]===b)continue e;l&&x.push(b),p.push(N)}else h(x,b,c)||(x!==p&&x.push(b),p.push(N))}return p}return Mh=o,Mh}var jh,Ew;function $L(){if(Ew)return jh;Ew=1;var e=fa(),r=zL();function t(n,a){return n&&n.length?r(n,e(a,2)):[]}return jh=t,jh}var GL=$L();const Cle=nr(GL);var Lh,ww;function WL(){if(ww)return Lh;ww=1;var e=Wl(),r=cb(),t=$t(),n=e?e.isConcatSpreadable:void 0;function a(i){return t(i)||r(i)||!!(n&&i&&i[n])}return Lh=a,Lh}var Bh,_w;function sO(){if(_w)return Bh;_w=1;var e=QR(),r=WL();function t(n,a,i,s,o){var u=-1,l=n.length;for(i||(i=r),o||(o=[]);++u<l;){var c=n[u];a>0&&i(c)?a>1?t(c,a-1,i,s,o):e(o,c):s||(o[o.length]=c)}return o}return Bh=t,Bh}var qh,Sw;function YL(){if(Sw)return qh;Sw=1;function e(r){return function(t,n,a){for(var i=-1,s=Object(t),o=a(t),u=o.length;u--;){var l=o[r?u:++i];if(n(s[l],l,s)===!1)break}return t}}return qh=e,qh}var Hh,Tw;function KL(){if(Tw)return Hh;Tw=1;var e=YL(),r=e();return Hh=r,Hh}var zh,Dw;function oO(){if(Dw)return zh;Dw=1;var e=KL(),r=df();function t(n,a){return n&&e(n,a,r)}return zh=t,zh}var $h,Aw;function XL(){if(Aw)return $h;Aw=1;var e=Yl();function r(t,n){return function(a,i){if(a==null)return a;if(!e(a))return t(a,i);for(var s=a.length,o=n?s:-1,u=Object(a);(n?o--:++o<s)&&i(u[o],o,u)!==!1;);return a}}return $h=r,$h}var Gh,kw;function hb(){if(kw)return Gh;kw=1;var e=oO(),r=XL(),t=r(e);return Gh=t,Gh}var Wh,Rw;function lO(){if(Rw)return Wh;Rw=1;var e=hb(),r=Yl();function t(n,a){var i=-1,s=r(n)?Array(n.length):[];return e(n,function(o,u,l){s[++i]=a(o,u,l)}),s}return Wh=t,Wh}var Yh,Ow;function QL(){if(Ow)return Yh;Ow=1;function e(r,t){var n=r.length;for(r.sort(t);n--;)r[n]=r[n].value;return r}return Yh=e,Yh}var Kh,Fw;function ZL(){if(Fw)return Kh;Fw=1;var e=fo();function r(t,n){if(t!==n){var a=t!==void 0,i=t===null,s=t===t,o=e(t),u=n!==void 0,l=n===null,c=n===n,f=e(n);if(!l&&!f&&!o&&t>n||o&&u&&c&&!l&&!f||i&&u&&c||!a&&c||!s)return 1;if(!i&&!o&&!f&&t<n||f&&a&&s&&!i&&!o||l&&a&&s||!u&&s||!c)return-1}return 0}return Kh=r,Kh}var Xh,Uw;function JL(){if(Uw)return Xh;Uw=1;var e=ZL();function r(t,n,a){for(var i=-1,s=t.criteria,o=n.criteria,u=s.length,l=a.length;++i<u;){var c=e(s[i],o[i]);if(c){if(i>=l)return c;var f=a[i];return c*(f=="desc"?-1:1)}}return t.index-n.index}return Xh=r,Xh}var Qh,Iw;function e7(){if(Iw)return Qh;Iw=1;var e=ib(),r=sb(),t=fa(),n=lO(),a=QL(),i=JR(),s=JL(),o=mo(),u=$t();function l(c,f,h){f.length?f=e(f,function(p){return u(p)?function(x){return r(x,p.length===1?p[0]:p)}:p}):f=[o];var d=-1;f=e(f,i(t));var v=n(c,function(p,x,g){var N=e(f,function(b){return b(p)});return{criteria:N,index:++d,value:p}});return a(v,function(p,x){return s(p,x,h)})}return Qh=l,Qh}var Zh,Pw;function r7(){if(Pw)return Zh;Pw=1;function e(r,t,n){switch(n.length){case 0:return r.call(t);case 1:return r.call(t,n[0]);case 2:return r.call(t,n[0],n[1]);case 3:return r.call(t,n[0],n[1],n[2])}return r.apply(t,n)}return Zh=e,Zh}var Jh,Vw;function t7(){if(Vw)return Jh;Vw=1;var e=r7(),r=Math.max;function t(n,a,i){return a=r(a===void 0?n.length-1:a,0),function(){for(var s=arguments,o=-1,u=r(s.length-a,0),l=Array(u);++o<u;)l[o]=s[a+o];o=-1;for(var c=Array(a+1);++o<a;)c[o]=s[o];return c[a]=i(l),e(n,this,c)}}return Jh=t,Jh}var e0,Mw;function n7(){if(Mw)return e0;Mw=1;function e(r){return function(){return r}}return e0=e,e0}var r0,jw;function uO(){if(jw)return r0;jw=1;var e=os(),r=(function(){try{var t=e(Object,"defineProperty");return t({},"",{}),t}catch{}})();return r0=r,r0}var t0,Lw;function a7(){if(Lw)return t0;Lw=1;var e=n7(),r=uO(),t=mo(),n=r?function(a,i){return r(a,"toString",{configurable:!0,enumerable:!1,value:e(i),writable:!0})}:t;return t0=n,t0}var n0,Bw;function i7(){if(Bw)return n0;Bw=1;var e=800,r=16,t=Date.now;function n(a){var i=0,s=0;return function(){var o=t(),u=r-(o-s);if(s=o,u>0){if(++i>=e)return arguments[0]}else i=0;return a.apply(void 0,arguments)}}return n0=n,n0}var a0,qw;function s7(){if(qw)return a0;qw=1;var e=a7(),r=i7(),t=r(e);return a0=t,a0}var i0,Hw;function o7(){if(Hw)return i0;Hw=1;var e=mo(),r=t7(),t=s7();function n(a,i){return t(r(a,i,e),a+"")}return i0=n,i0}var s0,zw;function hf(){if(zw)return s0;zw=1;var e=tb(),r=Yl(),t=fb(),n=xi();function a(i,s,o){if(!n(o))return!1;var u=typeof s;return(u=="number"?r(o)&&t(s,o.length):u=="string"&&s in o)?e(o[s],i):!1}return s0=a,s0}var o0,$w;function l7(){if($w)return o0;$w=1;var e=sO(),r=e7(),t=o7(),n=hf(),a=t(function(i,s){if(i==null)return[];var o=s.length;return o>1&&n(i,s[0],s[1])?s=[]:o>2&&n(s[0],s[1],s[2])&&(s=[s[0]]),r(i,e(s,1),[])});return o0=a,o0}var u7=l7();const Ele=nr(u7);var l0,Gw;function c7(){if(Gw)return l0;Gw=1;var e=ca(),r=function(){return e.Date.now()};return l0=r,l0}var u0,Ww;function f7(){if(Ww)return u0;Ww=1;var e=/\s/;function r(t){for(var n=t.length;n--&&e.test(t.charAt(n)););return n}return u0=r,u0}var c0,Yw;function m7(){if(Yw)return c0;Yw=1;var e=f7(),r=/^\s+/;function t(n){return n&&n.slice(0,e(n)+1).replace(r,"")}return c0=t,c0}var f0,Kw;function cO(){if(Kw)return f0;Kw=1;var e=m7(),r=xi(),t=fo(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function u(l){if(typeof l=="number")return l;if(t(l))return n;if(r(l)){var c=typeof l.valueOf=="function"?l.valueOf():l;l=r(c)?c+"":c}if(typeof l!="string")return l===0?l:+l;l=e(l);var f=i.test(l);return f||s.test(l)?o(l.slice(2),f?2:8):a.test(l)?n:+l}return f0=u,f0}var m0,Xw;function d7(){if(Xw)return m0;Xw=1;var e=xi(),r=c7(),t=cO(),n="Expected a function",a=Math.max,i=Math.min;function s(o,u,l){var c,f,h,d,v,p,x=0,g=!1,N=!1,b=!0;if(typeof o!="function")throw new TypeError(n);u=t(u)||0,e(l)&&(g=!!l.leading,N="maxWait"in l,h=N?a(t(l.maxWait)||0,u):h,b="trailing"in l?!!l.trailing:b);function y(P){var B=c,G=f;return c=f=void 0,x=P,d=o.apply(G,B),d}function _(P){return x=P,v=setTimeout(k,u),g?y(P):d}function w(P){var B=P-p,G=P-x,ue=u-B;return N?i(ue,h-G):ue}function C(P){var B=P-p,G=P-x;return p===void 0||B>=u||B<0||N&&G>=h}function k(){var P=r();if(C(P))return D(P);v=setTimeout(k,w(P))}function D(P){return v=void 0,b&&c?y(P):(c=f=void 0,d)}function U(){v!==void 0&&clearTimeout(v),x=0,c=p=f=v=void 0}function F(){return v===void 0?d:D(r())}function L(){var P=r(),B=C(P);if(c=arguments,f=this,p=P,B){if(v===void 0)return _(p);if(N)return clearTimeout(v),v=setTimeout(k,u),y(p)}return v===void 0&&(v=setTimeout(k,u)),d}return L.cancel=U,L.flush=F,L}return m0=s,m0}var d0,Qw;function h7(){if(Qw)return d0;Qw=1;var e=d7(),r=xi(),t="Expected a function";function n(a,i,s){var o=!0,u=!0;if(typeof a!="function")throw new TypeError(t);return r(s)&&(o="leading"in s?!!s.leading:o,u="trailing"in s?!!s.trailing:u),e(a,i,{leading:o,maxWait:i,trailing:u})}return d0=n,d0}var p7=h7();const wle=nr(p7);function si(e,r){return e==null||r==null?NaN:e<r?-1:e>r?1:e>=r?0:NaN}function v7(e,r){return e==null||r==null?NaN:r<e?-1:r>e?1:r>=e?0:NaN}function pb(e){let r,t,n;e.length!==2?(r=si,t=(o,u)=>si(e(o),u),n=(o,u)=>e(o)-u):(r=e===si||e===v7?e:x7,t=e,n=e);function a(o,u,l=0,c=o.length){if(l<c){if(r(u,u)!==0)return c;do{const f=l+c>>>1;t(o[f],u)<0?l=f+1:c=f}while(l<c)}return l}function i(o,u,l=0,c=o.length){if(l<c){if(r(u,u)!==0)return c;do{const f=l+c>>>1;t(o[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function s(o,u,l=0,c=o.length){const f=a(o,u,l,c-1);return f>l&&n(o[f-1],u)>-n(o[f],u)?f-1:f}return{left:a,center:s,right:i}}function x7(){return 0}function fO(e){return e===null?NaN:+e}function*g7(e,r){for(let t of e)t!=null&&(t=+t)>=t&&(yield t)}const b7=pb(si),Kl=b7.right;pb(fO).center;class Zw extends Map{constructor(r,t=C7){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),r!=null)for(const[n,a]of r)this.set(n,a)}get(r){return super.get(Jw(this,r))}has(r){return super.has(Jw(this,r))}set(r,t){return super.set(N7(this,r),t)}delete(r){return super.delete(y7(this,r))}}function Jw({_intern:e,_key:r},t){const n=r(t);return e.has(n)?e.get(n):t}function N7({_intern:e,_key:r},t){const n=r(t);return e.has(n)?e.get(n):(e.set(n,t),t)}function y7({_intern:e,_key:r},t){const n=r(t);return e.has(n)&&(t=e.get(n),e.delete(n)),t}function C7(e){return e!==null&&typeof e=="object"?e.valueOf():e}function E7(e=si){if(e===si)return mO;if(typeof e!="function")throw new TypeError("compare is not a function");return(r,t)=>{const n=e(r,t);return n||n===0?n:(e(t,t)===0)-(e(r,r)===0)}}function mO(e,r){return(e==null||!(e>=e))-(r==null||!(r>=r))||(e<r?-1:e>r?1:0)}const w7=Math.sqrt(50),_7=Math.sqrt(10),S7=Math.sqrt(2);function gc(e,r,t){const n=(r-e)/Math.max(0,t),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=w7?10:i>=_7?5:i>=S7?2:1;let o,u,l;return a<0?(l=Math.pow(10,-a)/s,o=Math.round(e*l),u=Math.round(r*l),o/l<e&&++o,u/l>r&&--u,l=-l):(l=Math.pow(10,a)*s,o=Math.round(e/l),u=Math.round(r/l),o*l<e&&++o,u*l>r&&--u),u<o&&.5<=t&&t<2?gc(e,r,t*2):[o,u,l]}function $g(e,r,t){if(r=+r,e=+e,t=+t,!(t>0))return[];if(e===r)return[e];const n=r<e,[a,i,s]=n?gc(r,e,t):gc(e,r,t);if(!(i>=a))return[];const o=i-a+1,u=new Array(o);if(n)if(s<0)for(let l=0;l<o;++l)u[l]=(i-l)/-s;else for(let l=0;l<o;++l)u[l]=(i-l)*s;else if(s<0)for(let l=0;l<o;++l)u[l]=(a+l)/-s;else for(let l=0;l<o;++l)u[l]=(a+l)*s;return u}function Gg(e,r,t){return r=+r,e=+e,t=+t,gc(e,r,t)[2]}function Wg(e,r,t){r=+r,e=+e,t=+t;const n=r<e,a=n?Gg(r,e,t):Gg(e,r,t);return(n?-1:1)*(a<0?1/-a:a)}function e2(e,r){let t;for(const n of e)n!=null&&(t<n||t===void 0&&n>=n)&&(t=n);return t}function r2(e,r){let t;for(const n of e)n!=null&&(t>n||t===void 0&&n>=n)&&(t=n);return t}function dO(e,r,t=0,n=1/0,a){if(r=Math.floor(r),t=Math.floor(Math.max(0,t)),n=Math.floor(Math.min(e.length-1,n)),!(t<=r&&r<=n))return e;for(a=a===void 0?mO:E7(a);n>t;){if(n-t>600){const u=n-t+1,l=r-t+1,c=Math.log(u),f=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),d=Math.max(t,Math.floor(r-l*f/u+h)),v=Math.min(n,Math.floor(r+(u-l)*f/u+h));dO(e,r,d,v,a)}const i=e[r];let s=t,o=n;for(Oo(e,t,r),a(e[n],i)>0&&Oo(e,t,n);s<o;){for(Oo(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}a(e[t],i)===0?Oo(e,t,o):(++o,Oo(e,o,n)),o<=r&&(t=o+1),r<=o&&(n=o-1)}return e}function Oo(e,r,t){const n=e[r];e[r]=e[t],e[t]=n}function T7(e,r,t){if(e=Float64Array.from(g7(e)),!(!(n=e.length)||isNaN(r=+r))){if(r<=0||n<2)return r2(e);if(r>=1)return e2(e);var n,a=(n-1)*r,i=Math.floor(a),s=e2(dO(e,i).subarray(0,i+1)),o=r2(e.subarray(i+1));return s+(o-s)*(a-i)}}function D7(e,r,t=fO){if(!(!(n=e.length)||isNaN(r=+r))){if(r<=0||n<2)return+t(e[0],0,e);if(r>=1)return+t(e[n-1],n-1,e);var n,a=(n-1)*r,i=Math.floor(a),s=+t(e[i],i,e),o=+t(e[i+1],i+1,e);return s+(o-s)*(a-i)}}function A7(e,r,t){e=+e,r=+r,t=(a=arguments.length)<2?(r=e,e=0,1):a<3?1:+t;for(var n=-1,a=Math.max(0,Math.ceil((r-e)/t))|0,i=new Array(a);++n<a;)i[n]=e+n*t;return i}function yn(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function qa(e,r){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof r=="function"?this.interpolator(r):this.range(r);break}}return this}const Yg=Symbol("implicit");function vb(){var e=new Zw,r=[],t=[],n=Yg;function a(i){let s=e.get(i);if(s===void 0){if(n!==Yg)return n;e.set(i,s=r.push(i)-1)}return t[s%t.length]}return a.domain=function(i){if(!arguments.length)return r.slice();r=[],e=new Zw;for(const s of i)e.has(s)||e.set(s,r.push(s)-1);return a},a.range=function(i){return arguments.length?(t=Array.from(i),a):t.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return vb(r,t).unknown(n)},yn.apply(a,arguments),a}function xb(){var e=vb().unknown(void 0),r=e.domain,t=e.range,n=0,a=1,i,s,o=!1,u=0,l=0,c=.5;delete e.unknown;function f(){var h=r().length,d=a<n,v=d?a:n,p=d?n:a;i=(p-v)/Math.max(1,h-u+l*2),o&&(i=Math.floor(i)),v+=(p-v-i*(h-u))*c,s=i*(1-u),o&&(v=Math.round(v),s=Math.round(s));var x=A7(h).map(function(g){return v+i*g});return t(d?x.reverse():x)}return e.domain=function(h){return arguments.length?(r(h),f()):r()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,o=!0,f()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(h){return arguments.length?(o=!!h,f()):o},e.padding=function(h){return arguments.length?(u=Math.min(1,l=+h),f()):u},e.paddingInner=function(h){return arguments.length?(u=Math.min(1,h),f()):u},e.paddingOuter=function(h){return arguments.length?(l=+h,f()):l},e.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),f()):c},e.copy=function(){return xb(r(),[n,a]).round(o).paddingInner(u).paddingOuter(l).align(c)},yn.apply(f(),arguments)}function hO(e){var r=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return hO(r())},e}function k7(){return hO(xb.apply(null,arguments).paddingInner(1))}function gb(e,r,t){e.prototype=r.prototype=t,t.constructor=e}function pO(e,r){var t=Object.create(e.prototype);for(var n in r)t[n]=r[n];return t}function Xl(){}var yl=.7,bc=1/yl,Bs="\\s*([+-]?\\d+)\\s*",Cl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",aa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",R7=/^#([0-9a-f]{3,8})$/,O7=new RegExp(`^rgb\\(${Bs},${Bs},${Bs}\\)$`),F7=new RegExp(`^rgb\\(${aa},${aa},${aa}\\)$`),U7=new RegExp(`^rgba\\(${Bs},${Bs},${Bs},${Cl}\\)$`),I7=new RegExp(`^rgba\\(${aa},${aa},${aa},${Cl}\\)$`),P7=new RegExp(`^hsl\\(${Cl},${aa},${aa}\\)$`),V7=new RegExp(`^hsla\\(${Cl},${aa},${aa},${Cl}\\)$`),t2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};gb(Xl,El,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:n2,formatHex:n2,formatHex8:M7,formatHsl:j7,formatRgb:a2,toString:a2});function n2(){return this.rgb().formatHex()}function M7(){return this.rgb().formatHex8()}function j7(){return vO(this).formatHsl()}function a2(){return this.rgb().formatRgb()}function El(e){var r,t;return e=(e+"").trim().toLowerCase(),(r=R7.exec(e))?(t=r[1].length,r=parseInt(r[1],16),t===6?i2(r):t===3?new jt(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):t===8?Du(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):t===4?Du(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=O7.exec(e))?new jt(r[1],r[2],r[3],1):(r=F7.exec(e))?new jt(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=U7.exec(e))?Du(r[1],r[2],r[3],r[4]):(r=I7.exec(e))?Du(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=P7.exec(e))?l2(r[1],r[2]/100,r[3]/100,1):(r=V7.exec(e))?l2(r[1],r[2]/100,r[3]/100,r[4]):t2.hasOwnProperty(e)?i2(t2[e]):e==="transparent"?new jt(NaN,NaN,NaN,0):null}function i2(e){return new jt(e>>16&255,e>>8&255,e&255,1)}function Du(e,r,t,n){return n<=0&&(e=r=t=NaN),new jt(e,r,t,n)}function L7(e){return e instanceof Xl||(e=El(e)),e?(e=e.rgb(),new jt(e.r,e.g,e.b,e.opacity)):new jt}function Kg(e,r,t,n){return arguments.length===1?L7(e):new jt(e,r,t,n??1)}function jt(e,r,t,n){this.r=+e,this.g=+r,this.b=+t,this.opacity=+n}gb(jt,Kg,pO(Xl,{brighter(e){return e=e==null?bc:Math.pow(bc,e),new jt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?yl:Math.pow(yl,e),new jt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new jt(Wi(this.r),Wi(this.g),Wi(this.b),Nc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:s2,formatHex:s2,formatHex8:B7,formatRgb:o2,toString:o2}));function s2(){return`#${Vi(this.r)}${Vi(this.g)}${Vi(this.b)}`}function B7(){return`#${Vi(this.r)}${Vi(this.g)}${Vi(this.b)}${Vi((isNaN(this.opacity)?1:this.opacity)*255)}`}function o2(){const e=Nc(this.opacity);return`${e===1?"rgb(":"rgba("}${Wi(this.r)}, ${Wi(this.g)}, ${Wi(this.b)}${e===1?")":`, ${e})`}`}function Nc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Wi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Vi(e){return e=Wi(e),(e<16?"0":"")+e.toString(16)}function l2(e,r,t,n){return n<=0?e=r=t=NaN:t<=0||t>=1?e=r=NaN:r<=0&&(e=NaN),new On(e,r,t,n)}function vO(e){if(e instanceof On)return new On(e.h,e.s,e.l,e.opacity);if(e instanceof Xl||(e=El(e)),!e)return new On;if(e instanceof On)return e;e=e.rgb();var r=e.r/255,t=e.g/255,n=e.b/255,a=Math.min(r,t,n),i=Math.max(r,t,n),s=NaN,o=i-a,u=(i+a)/2;return o?(r===i?s=(t-n)/o+(t<n)*6:t===i?s=(n-r)/o+2:s=(r-t)/o+4,o/=u<.5?i+a:2-i-a,s*=60):o=u>0&&u<1?0:s,new On(s,o,u,e.opacity)}function q7(e,r,t,n){return arguments.length===1?vO(e):new On(e,r,t,n??1)}function On(e,r,t,n){this.h=+e,this.s=+r,this.l=+t,this.opacity=+n}gb(On,q7,pO(Xl,{brighter(e){return e=e==null?bc:Math.pow(bc,e),new On(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?yl:Math.pow(yl,e),new On(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*r,a=2*t-n;return new jt(h0(e>=240?e-240:e+120,a,n),h0(e,a,n),h0(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new On(u2(this.h),Au(this.s),Au(this.l),Nc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Nc(this.opacity);return`${e===1?"hsl(":"hsla("}${u2(this.h)}, ${Au(this.s)*100}%, ${Au(this.l)*100}%${e===1?")":`, ${e})`}`}}));function u2(e){return e=(e||0)%360,e<0?e+360:e}function Au(e){return Math.max(0,Math.min(1,e||0))}function h0(e,r,t){return(e<60?r+(t-r)*e/60:e<180?t:e<240?r+(t-r)*(240-e)/60:r)*255}const bb=e=>()=>e;function H7(e,r){return function(t){return e+t*r}}function z7(e,r,t){return e=Math.pow(e,t),r=Math.pow(r,t)-e,t=1/t,function(n){return Math.pow(e+n*r,t)}}function $7(e){return(e=+e)==1?xO:function(r,t){return t-r?z7(r,t,e):bb(isNaN(r)?t:r)}}function xO(e,r){var t=r-e;return t?H7(e,t):bb(isNaN(e)?r:e)}const c2=(function e(r){var t=$7(r);function n(a,i){var s=t((a=Kg(a)).r,(i=Kg(i)).r),o=t(a.g,i.g),u=t(a.b,i.b),l=xO(a.opacity,i.opacity);return function(c){return a.r=s(c),a.g=o(c),a.b=u(c),a.opacity=l(c),a+""}}return n.gamma=e,n})(1);function G7(e,r){r||(r=[]);var t=e?Math.min(r.length,e.length):0,n=r.slice(),a;return function(i){for(a=0;a<t;++a)n[a]=e[a]*(1-i)+r[a]*i;return n}}function W7(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Y7(e,r){var t=r?r.length:0,n=e?Math.min(t,e.length):0,a=new Array(n),i=new Array(t),s;for(s=0;s<n;++s)a[s]=ho(e[s],r[s]);for(;s<t;++s)i[s]=r[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function K7(e,r){var t=new Date;return e=+e,r=+r,function(n){return t.setTime(e*(1-n)+r*n),t}}function yc(e,r){return e=+e,r=+r,function(t){return e*(1-t)+r*t}}function X7(e,r){var t={},n={},a;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in e?t[a]=ho(e[a],r[a]):n[a]=r[a];return function(i){for(a in t)n[a]=t[a](i);return n}}var Xg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,p0=new RegExp(Xg.source,"g");function Q7(e){return function(){return e}}function Z7(e){return function(r){return e(r)+""}}function J7(e,r){var t=Xg.lastIndex=p0.lastIndex=0,n,a,i,s=-1,o=[],u=[];for(e=e+"",r=r+"";(n=Xg.exec(e))&&(a=p0.exec(r));)(i=a.index)>t&&(i=r.slice(t,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,u.push({i:s,x:yc(n,a)})),t=p0.lastIndex;return t<r.length&&(i=r.slice(t),o[s]?o[s]+=i:o[++s]=i),o.length<2?u[0]?Z7(u[0].x):Q7(r):(r=u.length,function(l){for(var c=0,f;c<r;++c)o[(f=u[c]).i]=f.x(l);return o.join("")})}function ho(e,r){var t=typeof r,n;return r==null||t==="boolean"?bb(r):(t==="number"?yc:t==="string"?(n=El(r))?(r=n,c2):J7:r instanceof El?c2:r instanceof Date?K7:W7(r)?G7:Array.isArray(r)?Y7:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?X7:yc)(e,r)}function Nb(e,r){return e=+e,r=+r,function(t){return Math.round(e*(1-t)+r*t)}}function e9(e,r){r===void 0&&(r=e,e=ho);for(var t=0,n=r.length-1,a=r[0],i=new Array(n<0?0:n);t<n;)i[t]=e(a,a=r[++t]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function r9(e){return function(){return e}}function Cc(e){return+e}var f2=[0,1];function Ft(e){return e}function Qg(e,r){return(r-=e=+e)?function(t){return(t-e)/r}:r9(isNaN(r)?NaN:.5)}function t9(e,r){var t;return e>r&&(t=e,e=r,r=t),function(n){return Math.max(e,Math.min(r,n))}}function n9(e,r,t){var n=e[0],a=e[1],i=r[0],s=r[1];return a<n?(n=Qg(a,n),i=t(s,i)):(n=Qg(n,a),i=t(i,s)),function(o){return i(n(o))}}function a9(e,r,t){var n=Math.min(e.length,r.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++s<n;)a[s]=Qg(e[s],e[s+1]),i[s]=t(r[s],r[s+1]);return function(o){var u=Kl(e,o,1,n)-1;return i[u](a[u](o))}}function Ql(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function pf(){var e=f2,r=f2,t=ho,n,a,i,s=Ft,o,u,l;function c(){var h=Math.min(e.length,r.length);return s!==Ft&&(s=t9(e[0],e[h-1])),o=h>2?a9:n9,u=l=null,f}function f(h){return h==null||isNaN(h=+h)?i:(u||(u=o(e.map(n),r,t)))(n(s(h)))}return f.invert=function(h){return s(a((l||(l=o(r,e.map(n),yc)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Cc),c()):e.slice()},f.range=function(h){return arguments.length?(r=Array.from(h),c()):r.slice()},f.rangeRound=function(h){return r=Array.from(h),t=Nb,c()},f.clamp=function(h){return arguments.length?(s=h?!0:Ft,c()):s!==Ft},f.interpolate=function(h){return arguments.length?(t=h,c()):t},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,d){return n=h,a=d,c()}}function yb(){return pf()(Ft,Ft)}function i9(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Ec(e,r){if((t=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var t,n=e.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+e.slice(t+1)]}function ao(e){return e=Ec(Math.abs(e)),e?e[1]:NaN}function s9(e,r){return function(t,n){for(var a=t.length,i=[],s=0,o=e[0],u=0;a>0&&o>0&&(u+o+1>n&&(o=Math.max(1,n-u)),i.push(t.substring(a-=o,a+o)),!((u+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(r)}}function o9(e){return function(r){return r.replace(/[0-9]/g,function(t){return e[+t]})}}var l9=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function wl(e){if(!(r=l9.exec(e)))throw new Error("invalid format: "+e);var r;return new Cb({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}wl.prototype=Cb.prototype;function Cb(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Cb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function u9(e){e:for(var r=e.length,t=1,n=-1,a;t<r;++t)switch(e[t]){case".":n=a=t;break;case"0":n===0&&(n=t),a=t;break;default:if(!+e[t])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var gO;function c9(e,r){var t=Ec(e,r);if(!t)return e+"";var n=t[0],a=t[1],i=a-(gO=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Ec(e,Math.max(0,r+i-1))[0]}function m2(e,r){var t=Ec(e,r);if(!t)return e+"";var n=t[0],a=t[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const d2={"%":(e,r)=>(e*100).toFixed(r),b:e=>Math.round(e).toString(2),c:e=>e+"",d:i9,e:(e,r)=>e.toExponential(r),f:(e,r)=>e.toFixed(r),g:(e,r)=>e.toPrecision(r),o:e=>Math.round(e).toString(8),p:(e,r)=>m2(e*100,r),r:m2,s:c9,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function h2(e){return e}var p2=Array.prototype.map,v2=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function f9(e){var r=e.grouping===void 0||e.thousands===void 0?h2:s9(p2.call(e.grouping,Number),e.thousands+""),t=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?h2:o9(p2.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"âˆ’":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=wl(f);var h=f.fill,d=f.align,v=f.sign,p=f.symbol,x=f.zero,g=f.width,N=f.comma,b=f.precision,y=f.trim,_=f.type;_==="n"?(N=!0,_="g"):d2[_]||(b===void 0&&(b=12),y=!0,_="g"),(x||h==="0"&&d==="=")&&(x=!0,h="0",d="=");var w=p==="$"?t:p==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",C=p==="$"?n:/[%p]/.test(_)?s:"",k=d2[_],D=/[defgprs%]/.test(_);b=b===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function U(F){var L=w,P=C,B,G,ue;if(_==="c")P=k(F)+P,F="";else{F=+F;var oe=F<0||1/F<0;if(F=isNaN(F)?u:k(Math.abs(F),b),y&&(F=u9(F)),oe&&+F==0&&v!=="+"&&(oe=!1),L=(oe?v==="("?v:o:v==="-"||v==="("?"":v)+L,P=(_==="s"?v2[8+gO/3]:"")+P+(oe&&v==="("?")":""),D){for(B=-1,G=F.length;++B<G;)if(ue=F.charCodeAt(B),48>ue||ue>57){P=(ue===46?a+F.slice(B+1):F.slice(B))+P,F=F.slice(0,B);break}}}N&&!x&&(F=r(F,1/0));var he=L.length+F.length+P.length,fe=he<g?new Array(g-he+1).join(h):"";switch(N&&x&&(F=r(fe+F,fe.length?g-P.length:1/0),fe=""),d){case"<":F=L+F+P+fe;break;case"=":F=L+fe+F+P;break;case"^":F=fe.slice(0,he=fe.length>>1)+L+F+P+fe.slice(he);break;default:F=fe+L+F+P;break}return i(F)}return U.toString=function(){return f+""},U}function c(f,h){var d=l((f=wl(f),f.type="f",f)),v=Math.max(-8,Math.min(8,Math.floor(ao(h)/3)))*3,p=Math.pow(10,-v),x=v2[8+v/3];return function(g){return d(p*g)+x}}return{format:l,formatPrefix:c}}var ku,Eb,bO;m9({thousands:",",grouping:[3],currency:["$",""]});function m9(e){return ku=f9(e),Eb=ku.format,bO=ku.formatPrefix,ku}function d9(e){return Math.max(0,-ao(Math.abs(e)))}function h9(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ao(r)/3)))*3-ao(Math.abs(e)))}function p9(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,ao(r)-ao(e))+1}function NO(e,r,t,n){var a=Wg(e,r,t),i;switch(n=wl(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(r));return n.precision==null&&!isNaN(i=h9(a,s))&&(n.precision=i),bO(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=p9(a,Math.max(Math.abs(e),Math.abs(r))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=d9(a))&&(n.precision=i-(n.type==="%")*2);break}}return Eb(n)}function gi(e){var r=e.domain;return e.ticks=function(t){var n=r();return $g(n[0],n[n.length-1],t??10)},e.tickFormat=function(t,n){var a=r();return NO(a[0],a[a.length-1],t??10,n)},e.nice=function(t){t==null&&(t=10);var n=r(),a=0,i=n.length-1,s=n[a],o=n[i],u,l,c=10;for(o<s&&(l=s,s=o,o=l,l=a,a=i,i=l);c-- >0;){if(l=Gg(s,o,t),l===u)return n[a]=s,n[i]=o,r(n);if(l>0)s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l;else if(l<0)s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l;else break;u=l}return e},e}function yO(){var e=yb();return e.copy=function(){return Ql(e,yO())},yn.apply(e,arguments),gi(e)}function CO(e){var r;function t(n){return n==null||isNaN(n=+n)?r:n}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=Array.from(n,Cc),t):e.slice()},t.unknown=function(n){return arguments.length?(r=n,t):r},t.copy=function(){return CO(e).unknown(r)},e=arguments.length?Array.from(e,Cc):[0,1],gi(t)}function EO(e,r){e=e.slice();var t=0,n=e.length-1,a=e[t],i=e[n],s;return i<a&&(s=t,t=n,n=s,s=a,a=i,i=s),e[t]=r.floor(a),e[n]=r.ceil(i),e}function x2(e){return Math.log(e)}function g2(e){return Math.exp(e)}function v9(e){return-Math.log(-e)}function x9(e){return-Math.exp(-e)}function g9(e){return isFinite(e)?+("1e"+e):e<0?0:e}function b9(e){return e===10?g9:e===Math.E?Math.exp:r=>Math.pow(e,r)}function N9(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),r=>Math.log(r)/e)}function b2(e){return(r,t)=>-e(-r,t)}function wb(e){const r=e(x2,g2),t=r.domain;let n=10,a,i;function s(){return a=N9(n),i=b9(n),t()[0]<0?(a=b2(a),i=b2(i),e(v9,x9)):e(x2,g2),r}return r.base=function(o){return arguments.length?(n=+o,s()):n},r.domain=function(o){return arguments.length?(t(o),s()):t()},r.ticks=o=>{const u=t();let l=u[0],c=u[u.length-1];const f=c<l;f&&([l,c]=[c,l]);let h=a(l),d=a(c),v,p;const x=o==null?10:+o;let g=[];if(!(n%1)&&d-h<x){if(h=Math.floor(h),d=Math.ceil(d),l>0){for(;h<=d;++h)for(v=1;v<n;++v)if(p=h<0?v/i(-h):v*i(h),!(p<l)){if(p>c)break;g.push(p)}}else for(;h<=d;++h)for(v=n-1;v>=1;--v)if(p=h>0?v/i(-h):v*i(h),!(p<l)){if(p>c)break;g.push(p)}g.length*2<x&&(g=$g(l,c,x))}else g=$g(h,d,Math.min(d-h,x)).map(i);return f?g.reverse():g},r.tickFormat=(o,u)=>{if(o==null&&(o=10),u==null&&(u=n===10?"s":","),typeof u!="function"&&(!(n%1)&&(u=wl(u)).precision==null&&(u.trim=!0),u=Eb(u)),o===1/0)return u;const l=Math.max(1,n*o/r.ticks().length);return c=>{let f=c/i(Math.round(a(c)));return f*n<n-.5&&(f*=n),f<=l?u(c):""}},r.nice=()=>t(EO(t(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),r}function wO(){const e=wb(pf()).domain([1,10]);return e.copy=()=>Ql(e,wO()).base(e.base()),yn.apply(e,arguments),e}function N2(e){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/e))}}function y2(e){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*e}}function _b(e){var r=1,t=e(N2(r),y2(r));return t.constant=function(n){return arguments.length?e(N2(r=+n),y2(r)):r},gi(t)}function _O(){var e=_b(pf());return e.copy=function(){return Ql(e,_O()).constant(e.constant())},yn.apply(e,arguments)}function C2(e){return function(r){return r<0?-Math.pow(-r,e):Math.pow(r,e)}}function y9(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function C9(e){return e<0?-e*e:e*e}function Sb(e){var r=e(Ft,Ft),t=1;function n(){return t===1?e(Ft,Ft):t===.5?e(y9,C9):e(C2(t),C2(1/t))}return r.exponent=function(a){return arguments.length?(t=+a,n()):t},gi(r)}function Tb(){var e=Sb(pf());return e.copy=function(){return Ql(e,Tb()).exponent(e.exponent())},yn.apply(e,arguments),e}function E9(){return Tb.apply(null,arguments).exponent(.5)}function E2(e){return Math.sign(e)*e*e}function w9(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function SO(){var e=yb(),r=[0,1],t=!1,n;function a(i){var s=w9(e(i));return isNaN(s)?n:t?Math.round(s):s}return a.invert=function(i){return e.invert(E2(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((r=Array.from(i,Cc)).map(E2)),a):r.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(t=!!i,a):t},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return SO(e.domain(),r).round(t).clamp(e.clamp()).unknown(n)},yn.apply(a,arguments),gi(a)}function TO(){var e=[],r=[],t=[],n;function a(){var s=0,o=Math.max(1,r.length);for(t=new Array(o-1);++s<o;)t[s-1]=D7(e,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:r[Kl(t,s)]}return i.invertExtent=function(s){var o=r.indexOf(s);return o<0?[NaN,NaN]:[o>0?t[o-1]:e[0],o<t.length?t[o]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(si),a()},i.range=function(s){return arguments.length?(r=Array.from(s),a()):r.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return t.slice()},i.copy=function(){return TO().domain(e).range(r).unknown(n)},yn.apply(i,arguments)}function DO(){var e=0,r=1,t=1,n=[.5],a=[0,1],i;function s(u){return u!=null&&u<=u?a[Kl(n,u,0,t)]:i}function o(){var u=-1;for(n=new Array(t);++u<t;)n[u]=((u+1)*r-(u-t)*e)/(t+1);return s}return s.domain=function(u){return arguments.length?([e,r]=u,e=+e,r=+r,o()):[e,r]},s.range=function(u){return arguments.length?(t=(a=Array.from(u)).length-1,o()):a.slice()},s.invertExtent=function(u){var l=a.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,n[0]]:l>=t?[n[t-1],r]:[n[l-1],n[l]]},s.unknown=function(u){return arguments.length&&(i=u),s},s.thresholds=function(){return n.slice()},s.copy=function(){return DO().domain([e,r]).range(a).unknown(i)},yn.apply(gi(s),arguments)}function AO(){var e=[.5],r=[0,1],t,n=1;function a(i){return i!=null&&i<=i?r[Kl(e,i,0,n)]:t}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,r.length-1),a):e.slice()},a.range=function(i){return arguments.length?(r=Array.from(i),n=Math.min(e.length,r.length-1),a):r.slice()},a.invertExtent=function(i){var s=r.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(t=i,a):t},a.copy=function(){return AO().domain(e).range(r).unknown(t)},yn.apply(a,arguments)}const v0=new Date,x0=new Date;function st(e,r,t,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),r(i,1),e(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(r(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const u=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return u;let l;do u.push(l=new Date(+i)),r(i,o),e(i);while(l<i&&i<s);return u},a.filter=i=>st(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;r(s,-1),!i(s););else for(;--o>=0;)for(;r(s,1),!i(s););}),t&&(a.count=(i,s)=>(v0.setTime(+i),x0.setTime(+s),e(v0),e(x0),Math.floor(t(v0,x0))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const wc=st(()=>{},(e,r)=>{e.setTime(+e+r)},(e,r)=>r-e);wc.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?st(r=>{r.setTime(Math.floor(r/e)*e)},(r,t)=>{r.setTime(+r+t*e)},(r,t)=>(t-r)/e):wc);wc.range;const Ca=1e3,gn=Ca*60,Ea=gn*60,Oa=Ea*24,Db=Oa*7,w2=Oa*30,g0=Oa*365,Mi=st(e=>{e.setTime(e-e.getMilliseconds())},(e,r)=>{e.setTime(+e+r*Ca)},(e,r)=>(r-e)/Ca,e=>e.getUTCSeconds());Mi.range;const Ab=st(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ca)},(e,r)=>{e.setTime(+e+r*gn)},(e,r)=>(r-e)/gn,e=>e.getMinutes());Ab.range;const kb=st(e=>{e.setUTCSeconds(0,0)},(e,r)=>{e.setTime(+e+r*gn)},(e,r)=>(r-e)/gn,e=>e.getUTCMinutes());kb.range;const Rb=st(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ca-e.getMinutes()*gn)},(e,r)=>{e.setTime(+e+r*Ea)},(e,r)=>(r-e)/Ea,e=>e.getHours());Rb.range;const Ob=st(e=>{e.setUTCMinutes(0,0,0)},(e,r)=>{e.setTime(+e+r*Ea)},(e,r)=>(r-e)/Ea,e=>e.getUTCHours());Ob.range;const Zl=st(e=>e.setHours(0,0,0,0),(e,r)=>e.setDate(e.getDate()+r),(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*gn)/Oa,e=>e.getDate()-1);Zl.range;const vf=st(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/Oa,e=>e.getUTCDate()-1);vf.range;const kO=st(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/Oa,e=>Math.floor(e/Oa));kO.range;function ls(e){return st(r=>{r.setDate(r.getDate()-(r.getDay()+7-e)%7),r.setHours(0,0,0,0)},(r,t)=>{r.setDate(r.getDate()+t*7)},(r,t)=>(t-r-(t.getTimezoneOffset()-r.getTimezoneOffset())*gn)/Db)}const xf=ls(0),_c=ls(1),_9=ls(2),S9=ls(3),io=ls(4),T9=ls(5),D9=ls(6);xf.range;_c.range;_9.range;S9.range;io.range;T9.range;D9.range;function us(e){return st(r=>{r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-e)%7),r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCDate(r.getUTCDate()+t*7)},(r,t)=>(t-r)/Db)}const gf=us(0),Sc=us(1),A9=us(2),k9=us(3),so=us(4),R9=us(5),O9=us(6);gf.range;Sc.range;A9.range;k9.range;so.range;R9.range;O9.range;const Fb=st(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,r)=>{e.setMonth(e.getMonth()+r)},(e,r)=>r.getMonth()-e.getMonth()+(r.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Fb.range;const Ub=st(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCMonth(e.getUTCMonth()+r)},(e,r)=>r.getUTCMonth()-e.getUTCMonth()+(r.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Ub.range;const Fa=st(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r)},(e,r)=>r.getFullYear()-e.getFullYear(),e=>e.getFullYear());Fa.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:st(r=>{r.setFullYear(Math.floor(r.getFullYear()/e)*e),r.setMonth(0,1),r.setHours(0,0,0,0)},(r,t)=>{r.setFullYear(r.getFullYear()+t*e)});Fa.range;const Ua=st(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r)},(e,r)=>r.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Ua.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:st(r=>{r.setUTCFullYear(Math.floor(r.getUTCFullYear()/e)*e),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCFullYear(r.getUTCFullYear()+t*e)});Ua.range;function RO(e,r,t,n,a,i){const s=[[Mi,1,Ca],[Mi,5,5*Ca],[Mi,15,15*Ca],[Mi,30,30*Ca],[i,1,gn],[i,5,5*gn],[i,15,15*gn],[i,30,30*gn],[a,1,Ea],[a,3,3*Ea],[a,6,6*Ea],[a,12,12*Ea],[n,1,Oa],[n,2,2*Oa],[t,1,Db],[r,1,w2],[r,3,3*w2],[e,1,g0]];function o(l,c,f){const h=c<l;h&&([l,c]=[c,l]);const d=f&&typeof f.range=="function"?f:u(l,c,f),v=d?d.range(l,+c+1):[];return h?v.reverse():v}function u(l,c,f){const h=Math.abs(c-l)/f,d=pb(([,,x])=>x).right(s,h);if(d===s.length)return e.every(Wg(l/g0,c/g0,f));if(d===0)return wc.every(Math.max(Wg(l,c,f),1));const[v,p]=s[h/s[d-1][2]<s[d][2]/h?d-1:d];return v.every(p)}return[o,u]}const[F9,U9]=RO(Ua,Ub,gf,kO,Ob,kb),[I9,P9]=RO(Fa,Fb,xf,Zl,Rb,Ab);function b0(e){if(0<=e.y&&e.y<100){var r=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return r.setFullYear(e.y),r}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function N0(e){if(0<=e.y&&e.y<100){var r=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return r.setUTCFullYear(e.y),r}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Fo(e,r,t){return{y:e,m:r,d:t,H:0,M:0,S:0,L:0}}function V9(e){var r=e.dateTime,t=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,u=e.shortMonths,l=Uo(a),c=Io(a),f=Uo(i),h=Io(i),d=Uo(s),v=Io(s),p=Uo(o),x=Io(o),g=Uo(u),N=Io(u),b={a:oe,A:he,b:fe,B:S,c:null,d:k2,e:k2,f:sB,g:vB,G:gB,H:nB,I:aB,j:iB,L:OO,m:oB,M:lB,p:re,q:T,Q:F2,s:U2,S:uB,u:cB,U:fB,V:mB,w:dB,W:hB,x:null,X:null,y:pB,Y:xB,Z:bB,"%":O2},y={a:E,A:V,b:I,B:Y,c:null,d:R2,e:R2,f:EB,g:FB,G:IB,H:NB,I:yB,j:CB,L:UO,m:wB,M:_B,p:ie,q:le,Q:F2,s:U2,S:SB,u:TB,U:DB,V:AB,w:kB,W:RB,x:null,X:null,y:OB,Y:UB,Z:PB,"%":O2},_={a:U,A:F,b:L,B:P,c:B,d:D2,e:D2,f:J9,g:T2,G:S2,H:A2,I:A2,j:K9,L:Z9,m:Y9,M:X9,p:D,q:W9,Q:rB,s:tB,S:Q9,u:q9,U:H9,V:z9,w:B9,W:$9,x:G,X:ue,y:T2,Y:S2,Z:G9,"%":eB};b.x=w(t,b),b.X=w(n,b),b.c=w(r,b),y.x=w(t,y),y.X=w(n,y),y.c=w(r,y);function w(X,Q){return function(be){var ee=[],Ie=-1,Te=0,Ye=X.length,Be,Ee,xr;for(be instanceof Date||(be=new Date(+be));++Ie<Ye;)X.charCodeAt(Ie)===37&&(ee.push(X.slice(Te,Ie)),(Ee=_2[Be=X.charAt(++Ie)])!=null?Be=X.charAt(++Ie):Ee=Be==="e"?" ":"0",(xr=Q[Be])&&(Be=xr(be,Ee)),ee.push(Be),Te=Ie+1);return ee.push(X.slice(Te,Ie)),ee.join("")}}function C(X,Q){return function(be){var ee=Fo(1900,void 0,1),Ie=k(ee,X,be+="",0),Te,Ye;if(Ie!=be.length)return null;if("Q"in ee)return new Date(ee.Q);if("s"in ee)return new Date(ee.s*1e3+("L"in ee?ee.L:0));if(Q&&!("Z"in ee)&&(ee.Z=0),"p"in ee&&(ee.H=ee.H%12+ee.p*12),ee.m===void 0&&(ee.m="q"in ee?ee.q:0),"V"in ee){if(ee.V<1||ee.V>53)return null;"w"in ee||(ee.w=1),"Z"in ee?(Te=N0(Fo(ee.y,0,1)),Ye=Te.getUTCDay(),Te=Ye>4||Ye===0?Sc.ceil(Te):Sc(Te),Te=vf.offset(Te,(ee.V-1)*7),ee.y=Te.getUTCFullYear(),ee.m=Te.getUTCMonth(),ee.d=Te.getUTCDate()+(ee.w+6)%7):(Te=b0(Fo(ee.y,0,1)),Ye=Te.getDay(),Te=Ye>4||Ye===0?_c.ceil(Te):_c(Te),Te=Zl.offset(Te,(ee.V-1)*7),ee.y=Te.getFullYear(),ee.m=Te.getMonth(),ee.d=Te.getDate()+(ee.w+6)%7)}else("W"in ee||"U"in ee)&&("w"in ee||(ee.w="u"in ee?ee.u%7:"W"in ee?1:0),Ye="Z"in ee?N0(Fo(ee.y,0,1)).getUTCDay():b0(Fo(ee.y,0,1)).getDay(),ee.m=0,ee.d="W"in ee?(ee.w+6)%7+ee.W*7-(Ye+5)%7:ee.w+ee.U*7-(Ye+6)%7);return"Z"in ee?(ee.H+=ee.Z/100|0,ee.M+=ee.Z%100,N0(ee)):b0(ee)}}function k(X,Q,be,ee){for(var Ie=0,Te=Q.length,Ye=be.length,Be,Ee;Ie<Te;){if(ee>=Ye)return-1;if(Be=Q.charCodeAt(Ie++),Be===37){if(Be=Q.charAt(Ie++),Ee=_[Be in _2?Q.charAt(Ie++):Be],!Ee||(ee=Ee(X,be,ee))<0)return-1}else if(Be!=be.charCodeAt(ee++))return-1}return ee}function D(X,Q,be){var ee=l.exec(Q.slice(be));return ee?(X.p=c.get(ee[0].toLowerCase()),be+ee[0].length):-1}function U(X,Q,be){var ee=d.exec(Q.slice(be));return ee?(X.w=v.get(ee[0].toLowerCase()),be+ee[0].length):-1}function F(X,Q,be){var ee=f.exec(Q.slice(be));return ee?(X.w=h.get(ee[0].toLowerCase()),be+ee[0].length):-1}function L(X,Q,be){var ee=g.exec(Q.slice(be));return ee?(X.m=N.get(ee[0].toLowerCase()),be+ee[0].length):-1}function P(X,Q,be){var ee=p.exec(Q.slice(be));return ee?(X.m=x.get(ee[0].toLowerCase()),be+ee[0].length):-1}function B(X,Q,be){return k(X,r,Q,be)}function G(X,Q,be){return k(X,t,Q,be)}function ue(X,Q,be){return k(X,n,Q,be)}function oe(X){return s[X.getDay()]}function he(X){return i[X.getDay()]}function fe(X){return u[X.getMonth()]}function S(X){return o[X.getMonth()]}function re(X){return a[+(X.getHours()>=12)]}function T(X){return 1+~~(X.getMonth()/3)}function E(X){return s[X.getUTCDay()]}function V(X){return i[X.getUTCDay()]}function I(X){return u[X.getUTCMonth()]}function Y(X){return o[X.getUTCMonth()]}function ie(X){return a[+(X.getUTCHours()>=12)]}function le(X){return 1+~~(X.getUTCMonth()/3)}return{format:function(X){var Q=w(X+="",b);return Q.toString=function(){return X},Q},parse:function(X){var Q=C(X+="",!1);return Q.toString=function(){return X},Q},utcFormat:function(X){var Q=w(X+="",y);return Q.toString=function(){return X},Q},utcParse:function(X){var Q=C(X+="",!0);return Q.toString=function(){return X},Q}}}var _2={"-":"",_:" ",0:"0"},mt=/^\s*\d+/,M9=/^%/,j9=/[\\^$*+?|[\]().{}]/g;function lr(e,r,t){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<t?new Array(t-i+1).join(r)+a:a)}function L9(e){return e.replace(j9,"\\$&")}function Uo(e){return new RegExp("^(?:"+e.map(L9).join("|")+")","i")}function Io(e){return new Map(e.map((r,t)=>[r.toLowerCase(),t]))}function B9(e,r,t){var n=mt.exec(r.slice(t,t+1));return n?(e.w=+n[0],t+n[0].length):-1}function q9(e,r,t){var n=mt.exec(r.slice(t,t+1));return n?(e.u=+n[0],t+n[0].length):-1}function H9(e,r,t){var n=mt.exec(r.slice(t,t+2));return n?(e.U=+n[0],t+n[0].length):-1}function z9(e,r,t){var n=mt.exec(r.slice(t,t+2));return n?(e.V=+n[0],t+n[0].length):-1}function $9(e,r,t){var n=mt.exec(r.slice(t,t+2));return n?(e.W=+n[0],t+n[0].length):-1}function S2(e,r,t){var n=mt.exec(r.slice(t,t+4));return n?(e.y=+n[0],t+n[0].length):-1}function T2(e,r,t){var n=mt.exec(r.slice(t,t+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),t+n[0].length):-1}function G9(e,r,t){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(t,t+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),t+n[0].length):-1}function W9(e,r,t){var n=mt.exec(r.slice(t,t+1));return n?(e.q=n[0]*3-3,t+n[0].length):-1}function Y9(e,r,t){var n=mt.exec(r.slice(t,t+2));return n?(e.m=n[0]-1,t+n[0].length):-1}function D2(e,r,t){var n=mt.exec(r.slice(t,t+2));return n?(e.d=+n[0],t+n[0].length):-1}function K9(e,r,t){var n=mt.exec(r.slice(t,t+3));return n?(e.m=0,e.d=+n[0],t+n[0].length):-1}function A2(e,r,t){var n=mt.exec(r.slice(t,t+2));return n?(e.H=+n[0],t+n[0].length):-1}function X9(e,r,t){var n=mt.exec(r.slice(t,t+2));return n?(e.M=+n[0],t+n[0].length):-1}function Q9(e,r,t){var n=mt.exec(r.slice(t,t+2));return n?(e.S=+n[0],t+n[0].length):-1}function Z9(e,r,t){var n=mt.exec(r.slice(t,t+3));return n?(e.L=+n[0],t+n[0].length):-1}function J9(e,r,t){var n=mt.exec(r.slice(t,t+6));return n?(e.L=Math.floor(n[0]/1e3),t+n[0].length):-1}function eB(e,r,t){var n=M9.exec(r.slice(t,t+1));return n?t+n[0].length:-1}function rB(e,r,t){var n=mt.exec(r.slice(t));return n?(e.Q=+n[0],t+n[0].length):-1}function tB(e,r,t){var n=mt.exec(r.slice(t));return n?(e.s=+n[0],t+n[0].length):-1}function k2(e,r){return lr(e.getDate(),r,2)}function nB(e,r){return lr(e.getHours(),r,2)}function aB(e,r){return lr(e.getHours()%12||12,r,2)}function iB(e,r){return lr(1+Zl.count(Fa(e),e),r,3)}function OO(e,r){return lr(e.getMilliseconds(),r,3)}function sB(e,r){return OO(e,r)+"000"}function oB(e,r){return lr(e.getMonth()+1,r,2)}function lB(e,r){return lr(e.getMinutes(),r,2)}function uB(e,r){return lr(e.getSeconds(),r,2)}function cB(e){var r=e.getDay();return r===0?7:r}function fB(e,r){return lr(xf.count(Fa(e)-1,e),r,2)}function FO(e){var r=e.getDay();return r>=4||r===0?io(e):io.ceil(e)}function mB(e,r){return e=FO(e),lr(io.count(Fa(e),e)+(Fa(e).getDay()===4),r,2)}function dB(e){return e.getDay()}function hB(e,r){return lr(_c.count(Fa(e)-1,e),r,2)}function pB(e,r){return lr(e.getFullYear()%100,r,2)}function vB(e,r){return e=FO(e),lr(e.getFullYear()%100,r,2)}function xB(e,r){return lr(e.getFullYear()%1e4,r,4)}function gB(e,r){var t=e.getDay();return e=t>=4||t===0?io(e):io.ceil(e),lr(e.getFullYear()%1e4,r,4)}function bB(e){var r=e.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+lr(r/60|0,"0",2)+lr(r%60,"0",2)}function R2(e,r){return lr(e.getUTCDate(),r,2)}function NB(e,r){return lr(e.getUTCHours(),r,2)}function yB(e,r){return lr(e.getUTCHours()%12||12,r,2)}function CB(e,r){return lr(1+vf.count(Ua(e),e),r,3)}function UO(e,r){return lr(e.getUTCMilliseconds(),r,3)}function EB(e,r){return UO(e,r)+"000"}function wB(e,r){return lr(e.getUTCMonth()+1,r,2)}function _B(e,r){return lr(e.getUTCMinutes(),r,2)}function SB(e,r){return lr(e.getUTCSeconds(),r,2)}function TB(e){var r=e.getUTCDay();return r===0?7:r}function DB(e,r){return lr(gf.count(Ua(e)-1,e),r,2)}function IO(e){var r=e.getUTCDay();return r>=4||r===0?so(e):so.ceil(e)}function AB(e,r){return e=IO(e),lr(so.count(Ua(e),e)+(Ua(e).getUTCDay()===4),r,2)}function kB(e){return e.getUTCDay()}function RB(e,r){return lr(Sc.count(Ua(e)-1,e),r,2)}function OB(e,r){return lr(e.getUTCFullYear()%100,r,2)}function FB(e,r){return e=IO(e),lr(e.getUTCFullYear()%100,r,2)}function UB(e,r){return lr(e.getUTCFullYear()%1e4,r,4)}function IB(e,r){var t=e.getUTCDay();return e=t>=4||t===0?so(e):so.ceil(e),lr(e.getUTCFullYear()%1e4,r,4)}function PB(){return"+0000"}function O2(){return"%"}function F2(e){return+e}function U2(e){return Math.floor(+e/1e3)}var ws,PO,VO;VB({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function VB(e){return ws=V9(e),PO=ws.format,ws.parse,VO=ws.utcFormat,ws.utcParse,ws}function MB(e){return new Date(e)}function jB(e){return e instanceof Date?+e:+new Date(+e)}function Ib(e,r,t,n,a,i,s,o,u,l){var c=yb(),f=c.invert,h=c.domain,d=l(".%L"),v=l(":%S"),p=l("%I:%M"),x=l("%I %p"),g=l("%a %d"),N=l("%b %d"),b=l("%B"),y=l("%Y");function _(w){return(u(w)<w?d:o(w)<w?v:s(w)<w?p:i(w)<w?x:n(w)<w?a(w)<w?g:N:t(w)<w?b:y)(w)}return c.invert=function(w){return new Date(f(w))},c.domain=function(w){return arguments.length?h(Array.from(w,jB)):h().map(MB)},c.ticks=function(w){var C=h();return e(C[0],C[C.length-1],w??10)},c.tickFormat=function(w,C){return C==null?_:l(C)},c.nice=function(w){var C=h();return(!w||typeof w.range!="function")&&(w=r(C[0],C[C.length-1],w??10)),w?h(EO(C,w)):c},c.copy=function(){return Ql(c,Ib(e,r,t,n,a,i,s,o,u,l))},c}function LB(){return yn.apply(Ib(I9,P9,Fa,Fb,xf,Zl,Rb,Ab,Mi,PO).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function BB(){return yn.apply(Ib(F9,U9,Ua,Ub,gf,vf,Ob,kb,Mi,VO).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function bf(){var e=0,r=1,t,n,a,i,s=Ft,o=!1,u;function l(f){return f==null||isNaN(f=+f)?u:s(a===0?.5:(f=(i(f)-t)*a,o?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,r]=f,t=i(e=+e),n=i(r=+r),a=t===n?0:1/(n-t),l):[e,r]},l.clamp=function(f){return arguments.length?(o=!!f,l):o},l.interpolator=function(f){return arguments.length?(s=f,l):s};function c(f){return function(h){var d,v;return arguments.length?([d,v]=h,s=f(d,v),l):[s(0),s(1)]}}return l.range=c(ho),l.rangeRound=c(Nb),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return i=f,t=f(e),n=f(r),a=t===n?0:1/(n-t),l}}function bi(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function MO(){var e=gi(bf()(Ft));return e.copy=function(){return bi(e,MO())},qa.apply(e,arguments)}function jO(){var e=wb(bf()).domain([1,10]);return e.copy=function(){return bi(e,jO()).base(e.base())},qa.apply(e,arguments)}function LO(){var e=_b(bf());return e.copy=function(){return bi(e,LO()).constant(e.constant())},qa.apply(e,arguments)}function Pb(){var e=Sb(bf());return e.copy=function(){return bi(e,Pb()).exponent(e.exponent())},qa.apply(e,arguments)}function qB(){return Pb.apply(null,arguments).exponent(.5)}function BO(){var e=[],r=Ft;function t(n){if(n!=null&&!isNaN(n=+n))return r((Kl(e,n,1)-1)/(e.length-1))}return t.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(si),t},t.interpolator=function(n){return arguments.length?(r=n,t):r},t.range=function(){return e.map((n,a)=>r(a/(e.length-1)))},t.quantiles=function(n){return Array.from({length:n+1},(a,i)=>T7(e,i/n))},t.copy=function(){return BO(r).domain(e)},qa.apply(t,arguments)}function Nf(){var e=0,r=.5,t=1,n=1,a,i,s,o,u,l=Ft,c,f=!1,h;function d(p){return isNaN(p=+p)?h:(p=.5+((p=+c(p))-i)*(n*p<n*i?o:u),l(f?Math.max(0,Math.min(1,p)):p))}d.domain=function(p){return arguments.length?([e,r,t]=p,a=c(e=+e),i=c(r=+r),s=c(t=+t),o=a===i?0:.5/(i-a),u=i===s?0:.5/(s-i),n=i<a?-1:1,d):[e,r,t]},d.clamp=function(p){return arguments.length?(f=!!p,d):f},d.interpolator=function(p){return arguments.length?(l=p,d):l};function v(p){return function(x){var g,N,b;return arguments.length?([g,N,b]=x,l=e9(p,[g,N,b]),d):[l(0),l(.5),l(1)]}}return d.range=v(ho),d.rangeRound=v(Nb),d.unknown=function(p){return arguments.length?(h=p,d):h},function(p){return c=p,a=p(e),i=p(r),s=p(t),o=a===i?0:.5/(i-a),u=i===s?0:.5/(s-i),n=i<a?-1:1,d}}function qO(){var e=gi(Nf()(Ft));return e.copy=function(){return bi(e,qO())},qa.apply(e,arguments)}function HO(){var e=wb(Nf()).domain([.1,1,10]);return e.copy=function(){return bi(e,HO()).base(e.base())},qa.apply(e,arguments)}function zO(){var e=_b(Nf());return e.copy=function(){return bi(e,zO()).constant(e.constant())},qa.apply(e,arguments)}function Vb(){var e=Sb(Nf());return e.copy=function(){return bi(e,Vb()).exponent(e.exponent())},qa.apply(e,arguments)}function HB(){return Vb.apply(null,arguments).exponent(.5)}const _le=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:xb,scaleDiverging:qO,scaleDivergingLog:HO,scaleDivergingPow:Vb,scaleDivergingSqrt:HB,scaleDivergingSymlog:zO,scaleIdentity:CO,scaleImplicit:Yg,scaleLinear:yO,scaleLog:wO,scaleOrdinal:vb,scalePoint:k7,scalePow:Tb,scaleQuantile:TO,scaleQuantize:DO,scaleRadial:SO,scaleSequential:MO,scaleSequentialLog:jO,scaleSequentialPow:Pb,scaleSequentialQuantile:BO,scaleSequentialSqrt:qB,scaleSequentialSymlog:LO,scaleSqrt:E9,scaleSymlog:_O,scaleThreshold:AO,scaleTime:LB,scaleUtc:BB,tickFormat:NO},Symbol.toStringTag,{value:"Module"}));var y0,I2;function yf(){if(I2)return y0;I2=1;var e=fo();function r(t,n,a){for(var i=-1,s=t.length;++i<s;){var o=t[i],u=n(o);if(u!=null&&(l===void 0?u===u&&!e(u):a(u,l)))var l=u,c=o}return c}return y0=r,y0}var C0,P2;function $O(){if(P2)return C0;P2=1;function e(r,t){return r>t}return C0=e,C0}var E0,V2;function zB(){if(V2)return E0;V2=1;var e=yf(),r=$O(),t=mo();function n(a){return a&&a.length?e(a,t,r):void 0}return E0=n,E0}var $B=zB();const Sle=nr($B);var w0,M2;function GO(){if(M2)return w0;M2=1;function e(r,t){return r<t}return w0=e,w0}var _0,j2;function GB(){if(j2)return _0;j2=1;var e=yf(),r=GO(),t=mo();function n(a){return a&&a.length?e(a,t,r):void 0}return _0=n,_0}var WB=GB();const Tle=nr(WB);var S0,L2;function YB(){if(L2)return S0;L2=1;var e=ib(),r=fa(),t=lO(),n=$t();function a(i,s){var o=n(i)?e:t;return o(i,r(s,3))}return S0=a,S0}var T0,B2;function KB(){if(B2)return T0;B2=1;var e=sO(),r=YB();function t(n,a){return e(r(n,a),1)}return T0=t,T0}var XB=KB();const Dle=nr(XB);var D0,q2;function QB(){if(q2)return D0;q2=1;var e=db();function r(t,n){return e(t,n)}return D0=r,D0}var ZB=QB();const Ale=nr(ZB);var po=1e9,JB={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},jb,Fr=!0,bn="[DecimalError] ",Yi=bn+"Invalid argument: ",Mb=bn+"Exponent out of range: ",vo=Math.floor,Oi=Math.pow,eq=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,nn,lt=1e7,Dr=7,WO=9007199254740991,Tc=vo(WO/Dr),Ue={};Ue.absoluteValue=Ue.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Ue.comparedTo=Ue.cmp=function(e){var r,t,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,r=0,t=n<a?n:a;r<t;++r)if(i.d[r]!==e.d[r])return i.d[r]>e.d[r]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Ue.decimalPlaces=Ue.dp=function(){var e=this,r=e.d.length-1,t=(r-e.e)*Dr;if(r=e.d[r],r)for(;r%10==0;r/=10)t--;return t<0?0:t};Ue.dividedBy=Ue.div=function(e){return wa(this,new this.constructor(e))};Ue.dividedToIntegerBy=Ue.idiv=function(e){var r=this,t=r.constructor;return Cr(wa(r,new t(e),0,1),t.precision)};Ue.equals=Ue.eq=function(e){return!this.cmp(e)};Ue.exponent=function(){return et(this)};Ue.greaterThan=Ue.gt=function(e){return this.cmp(e)>0};Ue.greaterThanOrEqualTo=Ue.gte=function(e){return this.cmp(e)>=0};Ue.isInteger=Ue.isint=function(){return this.e>this.d.length-2};Ue.isNegative=Ue.isneg=function(){return this.s<0};Ue.isPositive=Ue.ispos=function(){return this.s>0};Ue.isZero=function(){return this.s===0};Ue.lessThan=Ue.lt=function(e){return this.cmp(e)<0};Ue.lessThanOrEqualTo=Ue.lte=function(e){return this.cmp(e)<1};Ue.logarithm=Ue.log=function(e){var r,t=this,n=t.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(nn))throw Error(bn+"NaN");if(t.s<1)throw Error(bn+(t.s?"NaN":"-Infinity"));return t.eq(nn)?new n(0):(Fr=!1,r=wa(_l(t,i),_l(e,i),i),Fr=!0,Cr(r,a))};Ue.minus=Ue.sub=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?XO(r,e):YO(r,(e.s=-e.s,e))};Ue.modulo=Ue.mod=function(e){var r,t=this,n=t.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(bn+"NaN");return t.s?(Fr=!1,r=wa(t,e,0,1).times(e),Fr=!0,t.minus(r)):Cr(new n(t),a)};Ue.naturalExponential=Ue.exp=function(){return KO(this)};Ue.naturalLogarithm=Ue.ln=function(){return _l(this)};Ue.negated=Ue.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Ue.plus=Ue.add=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?YO(r,e):XO(r,(e.s=-e.s,e))};Ue.precision=Ue.sd=function(e){var r,t,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Yi+e);if(r=et(a)+1,n=a.d.length-1,t=n*Dr+1,n=a.d[n],n){for(;n%10==0;n/=10)t--;for(n=a.d[0];n>=10;n/=10)t++}return e&&r>t?r:t};Ue.squareRoot=Ue.sqrt=function(){var e,r,t,n,a,i,s,o=this,u=o.constructor;if(o.s<1){if(!o.s)return new u(0);throw Error(bn+"NaN")}for(e=et(o),Fr=!1,a=Math.sqrt(+o),a==0||a==1/0?(r=ta(o.d),(r.length+e)%2==0&&(r+="0"),a=Math.sqrt(r),e=vo((e+1)/2)-(e<0||e%2),a==1/0?r="5e"+e:(r=a.toExponential(),r=r.slice(0,r.indexOf("e")+1)+e),n=new u(r)):n=new u(a.toString()),t=u.precision,a=s=t+3;;)if(i=n,n=i.plus(wa(o,i,s+2)).times(.5),ta(i.d).slice(0,s)===(r=ta(n.d)).slice(0,s)){if(r=r.slice(s-3,s+1),a==s&&r=="4999"){if(Cr(i,t+1,0),i.times(i).eq(o)){n=i;break}}else if(r!="9999")break;s+=4}return Fr=!0,Cr(n,t)};Ue.times=Ue.mul=function(e){var r,t,n,a,i,s,o,u,l,c=this,f=c.constructor,h=c.d,d=(e=new f(e)).d;if(!c.s||!e.s)return new f(0);for(e.s*=c.s,t=c.e+e.e,u=h.length,l=d.length,u<l&&(i=h,h=d,d=i,s=u,u=l,l=s),i=[],s=u+l,n=s;n--;)i.push(0);for(n=l;--n>=0;){for(r=0,a=u+n;a>n;)o=i[a]+d[n]*h[a-n-1]+r,i[a--]=o%lt|0,r=o/lt|0;i[a]=(i[a]+r)%lt|0}for(;!i[--s];)i.pop();return r?++t:i.shift(),e.d=i,e.e=t,Fr?Cr(e,f.precision):e};Ue.toDecimalPlaces=Ue.todp=function(e,r){var t=this,n=t.constructor;return t=new n(t),e===void 0?t:(sa(e,0,po),r===void 0?r=n.rounding:sa(r,0,8),Cr(t,e+et(t)+1,r))};Ue.toExponential=function(e,r){var t,n=this,a=n.constructor;return e===void 0?t=es(n,!0):(sa(e,0,po),r===void 0?r=a.rounding:sa(r,0,8),n=Cr(new a(n),e+1,r),t=es(n,!0,e+1)),t};Ue.toFixed=function(e,r){var t,n,a=this,i=a.constructor;return e===void 0?es(a):(sa(e,0,po),r===void 0?r=i.rounding:sa(r,0,8),n=Cr(new i(a),e+et(a)+1,r),t=es(n.abs(),!1,e+et(n)+1),a.isneg()&&!a.isZero()?"-"+t:t)};Ue.toInteger=Ue.toint=function(){var e=this,r=e.constructor;return Cr(new r(e),et(e)+1,r.rounding)};Ue.toNumber=function(){return+this};Ue.toPower=Ue.pow=function(e){var r,t,n,a,i,s,o=this,u=o.constructor,l=12,c=+(e=new u(e));if(!e.s)return new u(nn);if(o=new u(o),!o.s){if(e.s<1)throw Error(bn+"Infinity");return o}if(o.eq(nn))return o;if(n=u.precision,e.eq(nn))return Cr(o,n);if(r=e.e,t=e.d.length-1,s=r>=t,i=o.s,s){if((t=c<0?-c:c)<=WO){for(a=new u(nn),r=Math.ceil(n/Dr+4),Fr=!1;t%2&&(a=a.times(o),z2(a.d,r)),t=vo(t/2),t!==0;)o=o.times(o),z2(o.d,r);return Fr=!0,e.s<0?new u(nn).div(a):Cr(a,n)}}else if(i<0)throw Error(bn+"NaN");return i=i<0&&e.d[Math.max(r,t)]&1?-1:1,o.s=1,Fr=!1,a=e.times(_l(o,n+l)),Fr=!0,a=KO(a),a.s=i,a};Ue.toPrecision=function(e,r){var t,n,a=this,i=a.constructor;return e===void 0?(t=et(a),n=es(a,t<=i.toExpNeg||t>=i.toExpPos)):(sa(e,1,po),r===void 0?r=i.rounding:sa(r,0,8),a=Cr(new i(a),e,r),t=et(a),n=es(a,e<=t||t<=i.toExpNeg,e)),n};Ue.toSignificantDigits=Ue.tosd=function(e,r){var t=this,n=t.constructor;return e===void 0?(e=n.precision,r=n.rounding):(sa(e,1,po),r===void 0?r=n.rounding:sa(r,0,8)),Cr(new n(t),e,r)};Ue.toString=Ue.valueOf=Ue.val=Ue.toJSON=Ue[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,r=et(e),t=e.constructor;return es(e,r<=t.toExpNeg||r>=t.toExpPos)};function YO(e,r){var t,n,a,i,s,o,u,l,c=e.constructor,f=c.precision;if(!e.s||!r.s)return r.s||(r=new c(e)),Fr?Cr(r,f):r;if(u=e.d,l=r.d,s=e.e,a=r.e,u=u.slice(),i=s-a,i){for(i<0?(n=u,i=-i,o=l.length):(n=l,a=s,o=u.length),s=Math.ceil(f/Dr),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=u.length,i=l.length,o-i<0&&(i=o,n=l,l=u,u=n),t=0;i;)t=(u[--i]=u[i]+l[i]+t)/lt|0,u[i]%=lt;for(t&&(u.unshift(t),++a),o=u.length;u[--o]==0;)u.pop();return r.d=u,r.e=a,Fr?Cr(r,f):r}function sa(e,r,t){if(e!==~~e||e<r||e>t)throw Error(Yi+e)}function ta(e){var r,t,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,r=1;r<a;r++)n=e[r]+"",t=Dr-n.length,t&&(i+=Xa(t)),i+=n;s=e[r],n=s+"",t=Dr-n.length,t&&(i+=Xa(t))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var wa=(function(){function e(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%lt|0,s=i/lt|0;return s&&n.unshift(s),n}function r(n,a,i,s){var o,u;if(i!=s)u=i>s?1:-1;else for(o=u=0;o<i;o++)if(n[o]!=a[o]){u=n[o]>a[o]?1:-1;break}return u}function t(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*lt+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,u,l,c,f,h,d,v,p,x,g,N,b,y,_,w,C,k,D=n.constructor,U=n.s==a.s?1:-1,F=n.d,L=a.d;if(!n.s)return new D(n);if(!a.s)throw Error(bn+"Division by zero");for(u=n.e-a.e,C=L.length,_=F.length,d=new D(U),v=d.d=[],l=0;L[l]==(F[l]||0);)++l;if(L[l]>(F[l]||0)&&--u,i==null?N=i=D.precision:s?N=i+(et(n)-et(a))+1:N=i,N<0)return new D(0);if(N=N/Dr+2|0,l=0,C==1)for(c=0,L=L[0],N++;(l<_||c)&&N--;l++)b=c*lt+(F[l]||0),v[l]=b/L|0,c=b%L|0;else{for(c=lt/(L[0]+1)|0,c>1&&(L=e(L,c),F=e(F,c),C=L.length,_=F.length),y=C,p=F.slice(0,C),x=p.length;x<C;)p[x++]=0;k=L.slice(),k.unshift(0),w=L[0],L[1]>=lt/2&&++w;do c=0,o=r(L,p,C,x),o<0?(g=p[0],C!=x&&(g=g*lt+(p[1]||0)),c=g/w|0,c>1?(c>=lt&&(c=lt-1),f=e(L,c),h=f.length,x=p.length,o=r(f,p,h,x),o==1&&(c--,t(f,C<h?k:L,h))):(c==0&&(o=c=1),f=L.slice()),h=f.length,h<x&&f.unshift(0),t(p,f,x),o==-1&&(x=p.length,o=r(L,p,C,x),o<1&&(c++,t(p,C<x?k:L,x))),x=p.length):o===0&&(c++,p=[0]),v[l++]=c,o&&p[0]?p[x++]=F[y]||0:(p=[F[y]],x=1);while((y++<_||p[0]!==void 0)&&N--)}return v[0]||v.shift(),d.e=u,Cr(d,s?i+et(d)+1:i)}})();function KO(e,r){var t,n,a,i,s,o,u=0,l=0,c=e.constructor,f=c.precision;if(et(e)>16)throw Error(Mb+et(e));if(!e.s)return new c(nn);for(Fr=!1,o=f,s=new c(.03125);e.abs().gte(.1);)e=e.times(s),l+=5;for(n=Math.log(Oi(2,l))/Math.LN10*2+5|0,o+=n,t=a=i=new c(nn),c.precision=o;;){if(a=Cr(a.times(e),o),t=t.times(++u),s=i.plus(wa(a,t,o)),ta(s.d).slice(0,o)===ta(i.d).slice(0,o)){for(;l--;)i=Cr(i.times(i),o);return c.precision=f,r==null?(Fr=!0,Cr(i,f)):i}i=s}}function et(e){for(var r=e.e*Dr,t=e.d[0];t>=10;t/=10)r++;return r}function A0(e,r,t){if(r>e.LN10.sd())throw Fr=!0,t&&(e.precision=t),Error(bn+"LN10 precision limit exceeded");return Cr(new e(e.LN10),r)}function Xa(e){for(var r="";e--;)r+="0";return r}function _l(e,r){var t,n,a,i,s,o,u,l,c,f=1,h=10,d=e,v=d.d,p=d.constructor,x=p.precision;if(d.s<1)throw Error(bn+(d.s?"NaN":"-Infinity"));if(d.eq(nn))return new p(0);if(r==null?(Fr=!1,l=x):l=r,d.eq(10))return r==null&&(Fr=!0),A0(p,l);if(l+=h,p.precision=l,t=ta(v),n=t.charAt(0),i=et(d),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&t.charAt(1)>3;)d=d.times(e),t=ta(d.d),n=t.charAt(0),f++;i=et(d),n>1?(d=new p("0."+t),i++):d=new p(n+"."+t.slice(1))}else return u=A0(p,l+2,x).times(i+""),d=_l(new p(n+"."+t.slice(1)),l-h).plus(u),p.precision=x,r==null?(Fr=!0,Cr(d,x)):d;for(o=s=d=wa(d.minus(nn),d.plus(nn),l),c=Cr(d.times(d),l),a=3;;){if(s=Cr(s.times(c),l),u=o.plus(wa(s,new p(a),l)),ta(u.d).slice(0,l)===ta(o.d).slice(0,l))return o=o.times(2),i!==0&&(o=o.plus(A0(p,l+2,x).times(i+""))),o=wa(o,new p(f),l),p.precision=x,r==null?(Fr=!0,Cr(o,x)):o;o=u,a+=2}}function H2(e,r){var t,n,a;for((t=r.indexOf("."))>-1&&(r=r.replace(".","")),(n=r.search(/e/i))>0?(t<0&&(t=n),t+=+r.slice(n+1),r=r.substring(0,n)):t<0&&(t=r.length),n=0;r.charCodeAt(n)===48;)++n;for(a=r.length;r.charCodeAt(a-1)===48;)--a;if(r=r.slice(n,a),r){if(a-=n,t=t-n-1,e.e=vo(t/Dr),e.d=[],n=(t+1)%Dr,t<0&&(n+=Dr),n<a){for(n&&e.d.push(+r.slice(0,n)),a-=Dr;n<a;)e.d.push(+r.slice(n,n+=Dr));r=r.slice(n),n=Dr-r.length}else n-=a;for(;n--;)r+="0";if(e.d.push(+r),Fr&&(e.e>Tc||e.e<-Tc))throw Error(Mb+t)}else e.s=0,e.e=0,e.d=[0];return e}function Cr(e,r,t){var n,a,i,s,o,u,l,c,f=e.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(n=r-s,n<0)n+=Dr,a=r,l=f[c=0];else{if(c=Math.ceil((n+1)/Dr),i=f.length,c>=i)return e;for(l=i=f[c],s=1;i>=10;i/=10)s++;n%=Dr,a=n-Dr+s}if(t!==void 0&&(i=Oi(10,s-a-1),o=l/i%10|0,u=r<0||f[c+1]!==void 0||l%i,u=t<4?(o||u)&&(t==0||t==(e.s<0?3:2)):o>5||o==5&&(t==4||u||t==6&&(n>0?a>0?l/Oi(10,s-a):0:f[c-1])%10&1||t==(e.s<0?8:7))),r<1||!f[0])return u?(i=et(e),f.length=1,r=r-i-1,f[0]=Oi(10,(Dr-r%Dr)%Dr),e.e=vo(-r/Dr)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=c,i=1,c--):(f.length=c+1,i=Oi(10,Dr-n),f[c]=a>0?(l/Oi(10,s-a)%Oi(10,a)|0)*i:0),u)for(;;)if(c==0){(f[0]+=i)==lt&&(f[0]=1,++e.e);break}else{if(f[c]+=i,f[c]!=lt)break;f[c--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(Fr&&(e.e>Tc||e.e<-Tc))throw Error(Mb+et(e));return e}function XO(e,r){var t,n,a,i,s,o,u,l,c,f,h=e.constructor,d=h.precision;if(!e.s||!r.s)return r.s?r.s=-r.s:r=new h(e),Fr?Cr(r,d):r;if(u=e.d,f=r.d,n=r.e,l=e.e,u=u.slice(),s=l-n,s){for(c=s<0,c?(t=u,s=-s,o=f.length):(t=f,n=l,o=u.length),a=Math.max(Math.ceil(d/Dr),o)+2,s>a&&(s=a,t.length=1),t.reverse(),a=s;a--;)t.push(0);t.reverse()}else{for(a=u.length,o=f.length,c=a<o,c&&(o=a),a=0;a<o;a++)if(u[a]!=f[a]){c=u[a]<f[a];break}s=0}for(c&&(t=u,u=f,f=t,r.s=-r.s),o=u.length,a=f.length-o;a>0;--a)u[o++]=0;for(a=f.length;a>s;){if(u[--a]<f[a]){for(i=a;i&&u[--i]===0;)u[i]=lt-1;--u[i],u[a]+=lt}u[a]-=f[a]}for(;u[--o]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(r.d=u,r.e=n,Fr?Cr(r,d):r):new h(0)}function es(e,r,t){var n,a=et(e),i=ta(e.d),s=i.length;return r?(t&&(n=t-s)>0?i=i.charAt(0)+"."+i.slice(1)+Xa(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Xa(-a-1)+i,t&&(n=t-s)>0&&(i+=Xa(n))):a>=s?(i+=Xa(a+1-s),t&&(n=t-a-1)>0&&(i=i+"."+Xa(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),t&&(n=t-s)>0&&(a+1===s&&(i+="."),i+=Xa(n))),e.s<0?"-"+i:i}function z2(e,r){if(e.length>r)return e.length=r,!0}function QO(e){var r,t,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Yi+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return H2(s,i.toString())}else if(typeof i!="string")throw Error(Yi+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,eq.test(i))H2(s,i);else throw Error(Yi+i)}if(a.prototype=Ue,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=QO,a.config=a.set=rq,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],r=0;r<n.length;)e.hasOwnProperty(t=n[r++])||(e[t]=this[t]);return a.config(e),a}function rq(e){if(!e||typeof e!="object")throw Error(bn+"Object expected");var r,t,n,a=["precision",1,po,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(r=0;r<a.length;r+=3)if((n=e[t=a[r]])!==void 0)if(vo(n)===n&&n>=a[r+1]&&n<=a[r+2])this[t]=n;else throw Error(Yi+t+": "+n);if((n=e[t="LN10"])!==void 0)if(n==Math.LN10)this[t]=new this(n);else throw Error(Yi+t+": "+n);return this}var jb=QO(JB);nn=new jb(1);const kle=jb;var $2="Invariant failed";function Rle(e,r){var t=typeof r=="function"?r():r,n=t?"".concat($2,": ").concat(t):$2;throw new Error(n)}var k0,G2;function tq(){if(G2)return k0;G2=1;function e(r){var t=r==null?0:r.length;return t?r[t-1]:void 0}return k0=e,k0}var nq=tq();const Ole=nr(nq);var R0={exports:{}};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var O0,W2;function aq(){if(W2)return O0;W2=1;var e=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable;function n(i){if(i==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(i)}function a(){try{if(!Object.assign)return!1;var i=new String("abc");if(i[5]="de",Object.getOwnPropertyNames(i)[0]==="5")return!1;for(var s={},o=0;o<10;o++)s["_"+String.fromCharCode(o)]=o;var u=Object.getOwnPropertyNames(s).map(function(c){return s[c]});if(u.join("")!=="0123456789")return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach(function(c){l[c]=c}),Object.keys(Object.assign({},l)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return O0=a()?Object.assign:function(i,s){for(var o,u=n(i),l,c=1;c<arguments.length;c++){o=Object(arguments[c]);for(var f in o)r.call(o,f)&&(u[f]=o[f]);if(e){l=e(o);for(var h=0;h<l.length;h++)t.call(o,l[h])&&(u[l[h]]=o[l[h]])}}return u},O0}var F0,Y2;function ZO(){if(Y2)return F0;Y2=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return F0=e,F0}var U0,K2;function JO(){return K2||(K2=1,U0=Function.call.bind(Object.prototype.hasOwnProperty)),U0}var I0,X2;function iq(){if(X2)return I0;X2=1;var e=function(){};{var r=ZO(),t={},n=JO();e=function(i){var s="Warning: "+i;typeof console<"u"&&console.error(s);try{throw new Error(s)}catch{}}}function a(i,s,o,u,l){for(var c in i)if(n(i,c)){var f;try{if(typeof i[c]!="function"){var h=Error((u||"React class")+": "+o+" type `"+c+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof i[c]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw h.name="Invariant Violation",h}f=i[c](s,c,u,o,null,r)}catch(v){f=v}if(f&&!(f instanceof Error)&&e((u||"React class")+": type specification of "+o+" `"+c+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof f+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),f instanceof Error&&!(f.message in t)){t[f.message]=!0;var d=l?l():"";e("Failed "+o+" type: "+f.message+(d??""))}}}return a.resetWarningCache=function(){t={}},I0=a,I0}var P0,Q2;function sq(){if(Q2)return P0;Q2=1;var e=h4(),r=aq(),t=ZO(),n=JO(),a=iq(),i=function(){};i=function(o){var u="Warning: "+o;typeof console<"u"&&console.error(u);try{throw new Error(u)}catch{}};function s(){return null}return P0=function(o,u){var l=typeof Symbol=="function"&&Symbol.iterator,c="@@iterator";function f(S){var re=S&&(l&&S[l]||S[c]);if(typeof re=="function")return re}var h="<<anonymous>>",d={array:g("array"),bigint:g("bigint"),bool:g("boolean"),func:g("function"),number:g("number"),object:g("object"),string:g("string"),symbol:g("symbol"),any:N(),arrayOf:b,element:y(),elementType:_(),instanceOf:w,node:U(),objectOf:k,oneOf:C,oneOfType:D,shape:L,exact:P};function v(S,re){return S===re?S!==0||1/S===1/re:S!==S&&re!==re}function p(S,re){this.message=S,this.data=re&&typeof re=="object"?re:{},this.stack=""}p.prototype=Error.prototype;function x(S){var re={},T=0;function E(I,Y,ie,le,X,Q,be){if(le=le||h,Q=Q||ie,be!==t){if(u){var ee=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw ee.name="Invariant Violation",ee}else if(typeof console<"u"){var Ie=le+":"+ie;!re[Ie]&&T<3&&(i("You are manually calling a React.PropTypes validation function for the `"+Q+"` prop on `"+le+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),re[Ie]=!0,T++)}}return Y[ie]==null?I?Y[ie]===null?new p("The "+X+" `"+Q+"` is marked as required "+("in `"+le+"`, but its value is `null`.")):new p("The "+X+" `"+Q+"` is marked as required in "+("`"+le+"`, but its value is `undefined`.")):null:S(Y,ie,le,X,Q)}var V=E.bind(null,!1);return V.isRequired=E.bind(null,!0),V}function g(S){function re(T,E,V,I,Y,ie){var le=T[E],X=ue(le);if(X!==S){var Q=oe(le);return new p("Invalid "+I+" `"+Y+"` of type "+("`"+Q+"` supplied to `"+V+"`, expected ")+("`"+S+"`."),{expectedType:S})}return null}return x(re)}function N(){return x(s)}function b(S){function re(T,E,V,I,Y){if(typeof S!="function")return new p("Property `"+Y+"` of component `"+V+"` has invalid PropType notation inside arrayOf.");var ie=T[E];if(!Array.isArray(ie)){var le=ue(ie);return new p("Invalid "+I+" `"+Y+"` of type "+("`"+le+"` supplied to `"+V+"`, expected an array."))}for(var X=0;X<ie.length;X++){var Q=S(ie,X,V,I,Y+"["+X+"]",t);if(Q instanceof Error)return Q}return null}return x(re)}function y(){function S(re,T,E,V,I){var Y=re[T];if(!o(Y)){var ie=ue(Y);return new p("Invalid "+V+" `"+I+"` of type "+("`"+ie+"` supplied to `"+E+"`, expected a single ReactElement."))}return null}return x(S)}function _(){function S(re,T,E,V,I){var Y=re[T];if(!e.isValidElementType(Y)){var ie=ue(Y);return new p("Invalid "+V+" `"+I+"` of type "+("`"+ie+"` supplied to `"+E+"`, expected a single ReactElement type."))}return null}return x(S)}function w(S){function re(T,E,V,I,Y){if(!(T[E]instanceof S)){var ie=S.name||h,le=fe(T[E]);return new p("Invalid "+I+" `"+Y+"` of type "+("`"+le+"` supplied to `"+V+"`, expected ")+("instance of `"+ie+"`."))}return null}return x(re)}function C(S){if(!Array.isArray(S))return arguments.length>1?i("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):i("Invalid argument supplied to oneOf, expected an array."),s;function re(T,E,V,I,Y){for(var ie=T[E],le=0;le<S.length;le++)if(v(ie,S[le]))return null;var X=JSON.stringify(S,function(be,ee){var Ie=oe(ee);return Ie==="symbol"?String(ee):ee});return new p("Invalid "+I+" `"+Y+"` of value `"+String(ie)+"` "+("supplied to `"+V+"`, expected one of "+X+"."))}return x(re)}function k(S){function re(T,E,V,I,Y){if(typeof S!="function")return new p("Property `"+Y+"` of component `"+V+"` has invalid PropType notation inside objectOf.");var ie=T[E],le=ue(ie);if(le!=="object")return new p("Invalid "+I+" `"+Y+"` of type "+("`"+le+"` supplied to `"+V+"`, expected an object."));for(var X in ie)if(n(ie,X)){var Q=S(ie,X,V,I,Y+"."+X,t);if(Q instanceof Error)return Q}return null}return x(re)}function D(S){if(!Array.isArray(S))return i("Invalid argument supplied to oneOfType, expected an instance of array."),s;for(var re=0;re<S.length;re++){var T=S[re];if(typeof T!="function")return i("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+he(T)+" at index "+re+"."),s}function E(V,I,Y,ie,le){for(var X=[],Q=0;Q<S.length;Q++){var be=S[Q],ee=be(V,I,Y,ie,le,t);if(ee==null)return null;ee.data&&n(ee.data,"expectedType")&&X.push(ee.data.expectedType)}var Ie=X.length>0?", expected one of type ["+X.join(", ")+"]":"";return new p("Invalid "+ie+" `"+le+"` supplied to "+("`"+Y+"`"+Ie+"."))}return x(E)}function U(){function S(re,T,E,V,I){return B(re[T])?null:new p("Invalid "+V+" `"+I+"` supplied to "+("`"+E+"`, expected a ReactNode."))}return x(S)}function F(S,re,T,E,V){return new p((S||"React class")+": "+re+" type `"+T+"."+E+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+V+"`.")}function L(S){function re(T,E,V,I,Y){var ie=T[E],le=ue(ie);if(le!=="object")return new p("Invalid "+I+" `"+Y+"` of type `"+le+"` "+("supplied to `"+V+"`, expected `object`."));for(var X in S){var Q=S[X];if(typeof Q!="function")return F(V,I,Y,X,oe(Q));var be=Q(ie,X,V,I,Y+"."+X,t);if(be)return be}return null}return x(re)}function P(S){function re(T,E,V,I,Y){var ie=T[E],le=ue(ie);if(le!=="object")return new p("Invalid "+I+" `"+Y+"` of type `"+le+"` "+("supplied to `"+V+"`, expected `object`."));var X=r({},T[E],S);for(var Q in X){var be=S[Q];if(n(S,Q)&&typeof be!="function")return F(V,I,Y,Q,oe(be));if(!be)return new p("Invalid "+I+" `"+Y+"` key `"+Q+"` supplied to `"+V+"`.\nBad object: "+JSON.stringify(T[E],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(S),null,"  "));var ee=be(ie,Q,V,I,Y+"."+Q,t);if(ee)return ee}return null}return x(re)}function B(S){switch(typeof S){case"number":case"string":case"undefined":return!0;case"boolean":return!S;case"object":if(Array.isArray(S))return S.every(B);if(S===null||o(S))return!0;var re=f(S);if(re){var T=re.call(S),E;if(re!==S.entries){for(;!(E=T.next()).done;)if(!B(E.value))return!1}else for(;!(E=T.next()).done;){var V=E.value;if(V&&!B(V[1]))return!1}}else return!1;return!0;default:return!1}}function G(S,re){return S==="symbol"?!0:re?re["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&re instanceof Symbol:!1}function ue(S){var re=typeof S;return Array.isArray(S)?"array":S instanceof RegExp?"object":G(re,S)?"symbol":re}function oe(S){if(typeof S>"u"||S===null)return""+S;var re=ue(S);if(re==="object"){if(S instanceof Date)return"date";if(S instanceof RegExp)return"regexp"}return re}function he(S){var re=oe(S);switch(re){case"array":case"object":return"an "+re;case"boolean":case"date":case"regexp":return"a "+re;default:return re}}function fe(S){return!S.constructor||!S.constructor.name?h:S.constructor.name}return d.checkPropTypes=a,d.resetWarningCache=a.resetWarningCache,d.PropTypes=d,d},P0}var Z2;function oq(){if(Z2)return R0.exports;Z2=1;{var e=h4(),r=!0;R0.exports=sq()(e.isElement,r)}return R0.exports}var lq=oq();const Fle=nr(lq);var uq=Object.getOwnPropertyNames,cq=Object.getOwnPropertySymbols,fq=Object.prototype.hasOwnProperty;function J2(e,r){return function(n,a,i){return e(n,a,i)&&r(n,a,i)}}function Ru(e){return function(t,n,a){if(!t||!n||typeof t!="object"||typeof n!="object")return e(t,n,a);var i=a.cache,s=i.get(t),o=i.get(n);if(s&&o)return s===n&&o===t;i.set(t,n),i.set(n,t);var u=e(t,n,a);return i.delete(t),i.delete(n),u}}function e_(e){return uq(e).concat(cq(e))}var mq=Object.hasOwn||(function(e,r){return fq.call(e,r)});function cs(e,r){return e===r||!e&&!r&&e!==e&&r!==r}var dq="__v",hq="__o",pq="_owner",r_=Object.getOwnPropertyDescriptor,t_=Object.keys;function vq(e,r,t){var n=e.length;if(r.length!==n)return!1;for(;n-- >0;)if(!t.equals(e[n],r[n],n,n,e,r,t))return!1;return!0}function xq(e,r){return cs(e.getTime(),r.getTime())}function gq(e,r){return e.name===r.name&&e.message===r.message&&e.cause===r.cause&&e.stack===r.stack}function bq(e,r){return e===r}function n_(e,r,t){var n=e.size;if(n!==r.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.entries(),s,o,u=0;(s=i.next())&&!s.done;){for(var l=r.entries(),c=!1,f=0;(o=l.next())&&!o.done;){if(a[f]){f++;continue}var h=s.value,d=o.value;if(t.equals(h[0],d[0],u,f,e,r,t)&&t.equals(h[1],d[1],h[0],d[0],e,r,t)){c=a[f]=!0;break}f++}if(!c)return!1;u++}return!0}var Nq=cs;function yq(e,r,t){var n=t_(e),a=n.length;if(t_(r).length!==a)return!1;for(;a-- >0;)if(!eF(e,r,t,n[a]))return!1;return!0}function Po(e,r,t){var n=e_(e),a=n.length;if(e_(r).length!==a)return!1;for(var i,s,o;a-- >0;)if(i=n[a],!eF(e,r,t,i)||(s=r_(e,i),o=r_(r,i),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function Cq(e,r){return cs(e.valueOf(),r.valueOf())}function Eq(e,r){return e.source===r.source&&e.flags===r.flags}function a_(e,r,t){var n=e.size;if(n!==r.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.values(),s,o;(s=i.next())&&!s.done;){for(var u=r.values(),l=!1,c=0;(o=u.next())&&!o.done;){if(!a[c]&&t.equals(s.value,o.value,s.value,o.value,e,r,t)){l=a[c]=!0;break}c++}if(!l)return!1}return!0}function wq(e,r){var t=e.length;if(r.length!==t)return!1;for(;t-- >0;)if(e[t]!==r[t])return!1;return!0}function _q(e,r){return e.hostname===r.hostname&&e.pathname===r.pathname&&e.protocol===r.protocol&&e.port===r.port&&e.hash===r.hash&&e.username===r.username&&e.password===r.password}function eF(e,r,t,n){return(n===pq||n===hq||n===dq)&&(e.$$typeof||r.$$typeof)?!0:mq(r,n)&&t.equals(e[n],r[n],n,n,e,r,t)}var Sq="[object Arguments]",Tq="[object Boolean]",Dq="[object Date]",Aq="[object Error]",kq="[object Map]",Rq="[object Number]",Oq="[object Object]",Fq="[object RegExp]",Uq="[object Set]",Iq="[object String]",Pq="[object URL]",Vq=Array.isArray,i_=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,s_=Object.assign,Mq=Object.prototype.toString.call.bind(Object.prototype.toString);function jq(e){var r=e.areArraysEqual,t=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,s=e.areNumbersEqual,o=e.areObjectsEqual,u=e.arePrimitiveWrappersEqual,l=e.areRegExpsEqual,c=e.areSetsEqual,f=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(v,p,x){if(v===p)return!0;if(v==null||p==null)return!1;var g=typeof v;if(g!==typeof p)return!1;if(g!=="object")return g==="number"?s(v,p,x):g==="function"?a(v,p,x):!1;var N=v.constructor;if(N!==p.constructor)return!1;if(N===Object)return o(v,p,x);if(Vq(v))return r(v,p,x);if(i_!=null&&i_(v))return f(v,p,x);if(N===Date)return t(v,p,x);if(N===RegExp)return l(v,p,x);if(N===Map)return i(v,p,x);if(N===Set)return c(v,p,x);var b=Mq(v);return b===Dq?t(v,p,x):b===Fq?l(v,p,x):b===kq?i(v,p,x):b===Uq?c(v,p,x):b===Oq?typeof v.then!="function"&&typeof p.then!="function"&&o(v,p,x):b===Pq?h(v,p,x):b===Aq?n(v,p,x):b===Sq?o(v,p,x):b===Tq||b===Rq||b===Iq?u(v,p,x):!1}}function Lq(e){var r=e.circular,t=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Po:vq,areDatesEqual:xq,areErrorsEqual:gq,areFunctionsEqual:bq,areMapsEqual:n?J2(n_,Po):n_,areNumbersEqual:Nq,areObjectsEqual:n?Po:yq,arePrimitiveWrappersEqual:Cq,areRegExpsEqual:Eq,areSetsEqual:n?J2(a_,Po):a_,areTypedArraysEqual:n?Po:wq,areUrlsEqual:_q};if(t&&(a=s_({},a,t(a))),r){var i=Ru(a.areArraysEqual),s=Ru(a.areMapsEqual),o=Ru(a.areObjectsEqual),u=Ru(a.areSetsEqual);a=s_({},a,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:u})}return a}function Bq(e){return function(r,t,n,a,i,s,o){return e(r,t,o)}}function qq(e){var r=e.circular,t=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(u,l){var c=n(),f=c.cache,h=f===void 0?r?new WeakMap:void 0:f,d=c.meta;return t(u,l,{cache:h,equals:a,meta:d,strict:i})};if(r)return function(u,l){return t(u,l,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var s={cache:void 0,equals:a,meta:void 0,strict:i};return function(u,l){return t(u,l,s)}}var Ule=Ni();Ni({strict:!0});Ni({circular:!0});Ni({circular:!0,strict:!0});Ni({createInternalComparator:function(){return cs}});Ni({strict:!0,createInternalComparator:function(){return cs}});Ni({circular:!0,createInternalComparator:function(){return cs}});Ni({circular:!0,createInternalComparator:function(){return cs},strict:!0});function Ni(e){e===void 0&&(e={});var r=e.circular,t=r===void 0?!1:r,n=e.createInternalComparator,a=e.createState,i=e.strict,s=i===void 0?!1:i,o=Lq(e),u=jq(o),l=n?n(u):Bq(u);return qq({circular:t,comparator:u,createState:a,equals:l,strict:s})}var V0,o_;function Hq(){if(o_)return V0;o_=1;var e=yf(),r=$O(),t=fa();function n(a,i){return a&&a.length?e(a,t(i,2),r):void 0}return V0=n,V0}var zq=Hq();const Ile=nr(zq);var M0,l_;function $q(){if(l_)return M0;l_=1;var e=yf(),r=fa(),t=GO();function n(a,i){return a&&a.length?e(a,r(i,2),t):void 0}return M0=n,M0}var Gq=$q();const Ple=nr(Gq);var j0,u_;function Wq(){if(u_)return j0;u_=1;var e=rO(),r=e(Object.getPrototypeOf,Object);return j0=r,j0}var L0,c_;function Yq(){if(c_)return L0;c_=1;var e=La(),r=Wq(),t=Ba(),n="[object Object]",a=Function.prototype,i=Object.prototype,s=a.toString,o=i.hasOwnProperty,u=s.call(Object);function l(c){if(!t(c)||e(c)!=n)return!1;var f=r(c);if(f===null)return!0;var h=o.call(f,"constructor")&&f.constructor;return typeof h=="function"&&h instanceof h&&s.call(h)==u}return L0=l,L0}var Kq=Yq();const Vle=nr(Kq);var B0,f_;function Xq(){if(f_)return B0;f_=1;var e=La(),r=Ba(),t="[object Boolean]";function n(a){return a===!0||a===!1||r(a)&&e(a)==t}return B0=n,B0}var Qq=Xq();const Mle=nr(Qq);var q0,m_;function Zq(){if(m_)return q0;m_=1;function e(r){return r&&r.length?r[0]:void 0}return q0=e,q0}var H0,d_;function Jq(){return d_||(d_=1,H0=Zq()),H0}var eH=Jq();const jle=nr(eH);var z0,h_;function rH(){if(h_)return z0;h_=1;var e=Math.ceil,r=Math.max;function t(n,a,i,s){for(var o=-1,u=r(e((a-n)/(i||1)),0),l=Array(u);u--;)l[s?u:++o]=n,n+=i;return l}return z0=t,z0}var $0,p_;function rF(){if(p_)return $0;p_=1;var e=cO(),r=1/0,t=17976931348623157e292;function n(a){if(!a)return a===0?a:0;if(a=e(a),a===r||a===-r){var i=a<0?-1:1;return i*t}return a===a?a:0}return $0=n,$0}var G0,v_;function tH(){if(v_)return G0;v_=1;var e=rH(),r=hf(),t=rF();function n(a){return function(i,s,o){return o&&typeof o!="number"&&r(i,s,o)&&(s=o=void 0),i=t(i),s===void 0?(s=i,i=0):s=t(s),o=o===void 0?i<s?1:-1:t(o),e(i,s,o,a)}}return G0=n,G0}var W0,x_;function nH(){if(x_)return W0;x_=1;var e=tH(),r=e();return W0=r,W0}var aH=nH();const Lle=nr(aH);var Y0,g_;function iH(){if(g_)return Y0;g_=1;var e=hb();function r(t,n){var a;return e(t,function(i,s,o){return a=n(i,s,o),!a}),!!a}return Y0=r,Y0}var K0,b_;function sH(){if(b_)return K0;b_=1;var e=YR(),r=fa(),t=iH(),n=$t(),a=hf();function i(s,o,u){var l=n(s)?e:t;return u&&a(s,o,u)&&(o=void 0),l(s,r(o,3))}return K0=i,K0}var oH=sH();const Ble=nr(oH);var X0,N_;function lH(){if(N_)return X0;N_=1;var e=uO();function r(t,n,a){n=="__proto__"&&e?e(t,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):t[n]=a}return X0=r,X0}var Q0,y_;function uH(){if(y_)return Q0;y_=1;var e=lH(),r=oO(),t=fa();function n(a,i){var s={};return i=t(i,3),r(a,function(o,u,l){e(s,u,i(o,u,l))}),s}return Q0=n,Q0}var cH=uH();const qle=nr(cH);var Z0,C_;function fH(){if(C_)return Z0;C_=1;function e(r,t){for(var n=-1,a=r==null?0:r.length;++n<a;)if(!t(r[n],n,r))return!1;return!0}return Z0=e,Z0}var J0,E_;function mH(){if(E_)return J0;E_=1;var e=hb();function r(t,n){var a=!0;return e(t,function(i,s,o){return a=!!n(i,s,o),a}),a}return J0=r,J0}var ep,w_;function dH(){if(w_)return ep;w_=1;var e=fH(),r=mH(),t=fa(),n=$t(),a=hf();function i(s,o,u){var l=n(s)?e:r;return u&&a(s,o,u)&&(o=void 0),l(s,t(o,3))}return ep=i,ep}var hH=dH();const Hle=nr(hH);var rp,__;function pH(){if(__)return rp;__=1;var e=fa(),r=Yl(),t=df();function n(a){return function(i,s,o){var u=Object(i);if(!r(i)){var l=e(s,3);i=t(i),s=function(f){return l(u[f],f,u)}}var c=a(i,s,o);return c>-1?u[l?i[c]:c]:void 0}}return rp=n,rp}var tp,S_;function vH(){if(S_)return tp;S_=1;var e=rF();function r(t){var n=e(t),a=n%1;return n===n?a?n-a:n:0}return tp=r,tp}var np,T_;function xH(){if(T_)return np;T_=1;var e=iO(),r=fa(),t=vH(),n=Math.max;function a(i,s,o){var u=i==null?0:i.length;if(!u)return-1;var l=o==null?0:t(o);return l<0&&(l=n(u+l,0)),e(i,r(s,3),l)}return np=a,np}var ap,D_;function gH(){if(D_)return ap;D_=1;var e=pH(),r=xH(),t=e(r);return ap=t,ap}var bH=gH();const zle=nr(bH);var NH=wR();const $le=nr(NH);var ip={exports:{}},A_;function yH(){return A_||(A_=1,(function(e){var r=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function a(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function i(u,l,c,f,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new a(c,f||u,h),v=t?t+l:l;return u._events[v]?u._events[v].fn?u._events[v]=[u._events[v],d]:u._events[v].push(d):(u._events[v]=d,u._eventsCount++),u}function s(u,l){--u._eventsCount===0?u._events=new n:delete u._events[l]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],c,f;if(this._eventsCount===0)return l;for(f in c=this._events)r.call(c,f)&&l.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},o.prototype.listeners=function(l){var c=t?t+l:l,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,d=f.length,v=new Array(d);h<d;h++)v[h]=f[h].fn;return v},o.prototype.listenerCount=function(l){var c=t?t+l:l,f=this._events[c];return f?f.fn?1:f.length:0},o.prototype.emit=function(l,c,f,h,d,v){var p=t?t+l:l;if(!this._events[p])return!1;var x=this._events[p],g=arguments.length,N,b;if(x.fn){switch(x.once&&this.removeListener(l,x.fn,void 0,!0),g){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,c),!0;case 3:return x.fn.call(x.context,c,f),!0;case 4:return x.fn.call(x.context,c,f,h),!0;case 5:return x.fn.call(x.context,c,f,h,d),!0;case 6:return x.fn.call(x.context,c,f,h,d,v),!0}for(b=1,N=new Array(g-1);b<g;b++)N[b-1]=arguments[b];x.fn.apply(x.context,N)}else{var y=x.length,_;for(b=0;b<y;b++)switch(x[b].once&&this.removeListener(l,x[b].fn,void 0,!0),g){case 1:x[b].fn.call(x[b].context);break;case 2:x[b].fn.call(x[b].context,c);break;case 3:x[b].fn.call(x[b].context,c,f);break;case 4:x[b].fn.call(x[b].context,c,f,h);break;default:if(!N)for(_=1,N=new Array(g-1);_<g;_++)N[_-1]=arguments[_];x[b].fn.apply(x[b].context,N)}}return!0},o.prototype.on=function(l,c,f){return i(this,l,c,f,!1)},o.prototype.once=function(l,c,f){return i(this,l,c,f,!0)},o.prototype.removeListener=function(l,c,f,h){var d=t?t+l:l;if(!this._events[d])return this;if(!c)return s(this,d),this;var v=this._events[d];if(v.fn)v.fn===c&&(!h||v.once)&&(!f||v.context===f)&&s(this,d);else{for(var p=0,x=[],g=v.length;p<g;p++)(v[p].fn!==c||h&&!v[p].once||f&&v[p].context!==f)&&x.push(v[p]);x.length?this._events[d]=x.length===1?x[0]:x:s(this,d)}return this},o.prototype.removeAllListeners=function(l){var c;return l?(c=t?t+l:l,this._events[c]&&s(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,e.exports=o})(ip)),ip.exports}var CH=yH();const Gle=nr(CH),Wle=({data:e,title:r="Performance Trends",description:t="Average ratings over time"})=>{const n=({active:a,payload:i,label:s})=>a&&i&&i.length?m.jsxDEV("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg",children:[m.jsxDEV("p",{className:"font-medium text-foreground mb-2",children:s},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:27,columnNumber:11},void 0),i.map((o,u)=>m.jsxDEV("div",{className:"flex items-center gap-2 text-sm",children:[m.jsxDEV("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:o.color}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:30,columnNumber:15},void 0),m.jsxDEV("span",{className:"text-muted-foreground",children:[o.name,":"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:34,columnNumber:15},void 0),m.jsxDEV("span",{className:"font-medium text-foreground",children:o.value},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:35,columnNumber:15},void 0)]},u,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:29,columnNumber:13},void 0))]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:26,columnNumber:9},void 0):null;return m.jsxDEV(qe,{className:"w-full offscreen-content layout-contained",children:[m.jsxDEV(Qe,{children:[m.jsxDEV(Ze,{className:"flex items-center gap-2 text-foreground",children:[m.jsxDEV(lo,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:48,columnNumber:11},void 0),r]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:47,columnNumber:9},void 0),m.jsxDEV(mr,{className:"text-muted-foreground",children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:51,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:46,columnNumber:7},void 0),m.jsxDEV(He,{children:m.jsxDEV("div",{className:"h-80 w-full",children:m.jsxDEV(q1,{width:"100%",height:"100%",children:m.jsxDEV(HV,{data:e,margin:{top:5,right:30,left:20,bottom:5},children:[m.jsxDEV(U4,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.3},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:59,columnNumber:15},void 0),m.jsxDEV(I4,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:64,columnNumber:15},void 0),m.jsxDEV(P4,{domain:[1,5],stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:71,columnNumber:15},void 0),m.jsxDEV(V4,{content:m.jsxDEV(n,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:78,columnNumber:33},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:78,columnNumber:15},void 0),m.jsxDEV(M4,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:79,columnNumber:15},void 0),m.jsxDEV(fy,{type:"monotone",dataKey:"averageRating",stroke:"hsl(var(--chart-1))",strokeWidth:3,dot:{fill:"hsl(var(--chart-1))",strokeWidth:2,r:4},activeDot:{r:6,stroke:"hsl(var(--chart-1))",strokeWidth:2}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:80,columnNumber:15},void 0),m.jsxDEV(fy,{type:"monotone",dataKey:"totalInspections",stroke:"hsl(var(--chart-2))",strokeWidth:2,strokeDasharray:"5 5",dot:{fill:"hsl(var(--chart-2))",strokeWidth:2,r:3}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:88,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:58,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:57,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:56,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:55,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:45,columnNumber:5},void 0)},Yle=({data:e,title:r="School Performance Comparison",description:t="Average ratings and inspection counts by school",showThresholds:n=!0})=>{const a=({active:i,payload:s,label:o})=>i&&s&&s.length?m.jsxDEV("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg",children:[m.jsxDEV("p",{className:"font-medium text-foreground mb-2",children:o},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:30,columnNumber:11},void 0),s.map((u,l)=>m.jsxDEV("div",{className:"flex items-center gap-2 text-sm",children:[m.jsxDEV("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:u.color}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:33,columnNumber:15},void 0),m.jsxDEV("span",{className:"text-muted-foreground",children:[u.name,":"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:37,columnNumber:15},void 0),m.jsxDEV("span",{className:"font-medium text-foreground",children:u.value},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:38,columnNumber:15},void 0)]},l,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:32,columnNumber:13},void 0))]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:29,columnNumber:9},void 0):null;return m.jsxDEV(qe,{className:"w-full offscreen-content layout-contained",children:[m.jsxDEV(Qe,{children:[m.jsxDEV(Ze,{className:"flex items-center gap-2 text-foreground",children:[m.jsxDEV(xn,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:51,columnNumber:11},void 0),r]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:50,columnNumber:9},void 0),m.jsxDEV(mr,{className:"text-muted-foreground",children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:54,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:49,columnNumber:7},void 0),m.jsxDEV(He,{children:[m.jsxDEV("div",{className:"h-80 w-full",children:m.jsxDEV(q1,{width:"100%",height:"100%",children:m.jsxDEV(zV,{data:e,margin:{top:20,right:30,left:20,bottom:5},children:[m.jsxDEV(U4,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.3},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:62,columnNumber:15},void 0),m.jsxDEV(I4,{dataKey:"school",stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1,angle:-45,textAnchor:"end",height:80},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:67,columnNumber:15},void 0),m.jsxDEV(P4,{stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:77,columnNumber:15},void 0),m.jsxDEV(V4,{content:m.jsxDEV(a,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:83,columnNumber:33},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:83,columnNumber:15},void 0),m.jsxDEV(M4,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:84,columnNumber:15},void 0),n&&m.jsxDEV(m.Fragment,{children:[m.jsxDEV(my,{y:3,stroke:"#10B981",strokeDasharray:"5 5",strokeWidth:2,label:{value:"Acceptable (3.0)",position:"top"}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:87,columnNumber:19},void 0),m.jsxDEV(my,{y:2,stroke:"#EF4444",strokeDasharray:"5 5",strokeWidth:2,label:{value:"Critical (2.0)",position:"top"}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:94,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:86,columnNumber:17},void 0),m.jsxDEV(dy,{dataKey:"averageRating",fill:"hsl(var(--chart-1))",name:"Average Rating",radius:[2,2,0,0]},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:103,columnNumber:15},void 0),m.jsxDEV(dy,{dataKey:"totalInspections",fill:"hsl(var(--chart-2))",name:"Total Inspections",radius:[2,2,0,0]},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:109,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:61,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:60,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:59,columnNumber:9},void 0),n&&m.jsxDEV("div",{className:"mt-4 flex items-center gap-4 text-sm text-muted-foreground",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV("div",{className:"w-4 h-0.5 bg-green-500 border-dashed border-t-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:121,columnNumber:15},void 0),m.jsxDEV("span",{children:"Acceptable Threshold (3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:122,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:120,columnNumber:13},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV("div",{className:"w-4 h-0.5 bg-red-500 border-dashed border-t-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:125,columnNumber:15},void 0),m.jsxDEV("span",{children:"Critical Threshold (2.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:126,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:124,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:119,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:58,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:48,columnNumber:5},void 0)},Kle=({data:e,title:r="Category Performance Analysis",description:t="Performance ratings across all inspection categories",showProblemHighlighting:n=!0})=>{const a=s=>s<2?{level:"critical",color:"#EF4444",icon:vn}:s<3?{level:"needs-attention",color:"#F59E0B",icon:Ut}:{level:"acceptable",color:"#10B981",icon:Pn},i=s=>{const{payload:o,x:u,y:l,textAnchor:c}=s,f=e.find(d=>d.category===o.value),h=f?a(f.rating):null;return h?.icon||Aa,m.jsxDEV("g",{transform:`translate(${u},${l})`,children:[m.jsxDEV("text",{x:0,y:0,dy:16,textAnchor:c,fontSize:12,fill:h?.color||"hsl(var(--muted-foreground))",fontWeight:n&&h?.level!=="acceptable"?"bold":"normal",children:o.value},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:39,columnNumber:9},void 0),n&&h?.level!=="acceptable"&&m.jsxDEV("circle",{cx:-20,cy:0,r:4,fill:h?.color||"#EF4444"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:51,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:38,columnNumber:7},void 0)};return m.jsxDEV(qe,{className:"w-full offscreen-content layout-contained",children:[m.jsxDEV(Qe,{children:[m.jsxDEV(Ze,{className:"flex items-center gap-2 text-foreground",children:[m.jsxDEV(p4,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:65,columnNumber:11},void 0),r]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:64,columnNumber:9},void 0),m.jsxDEV(mr,{className:"text-muted-foreground",children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:68,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:63,columnNumber:7},void 0),m.jsxDEV(He,{children:[m.jsxDEV("div",{className:"h-80 w-full",children:m.jsxDEV(q1,{width:"100%",height:"100%",children:m.jsxDEV($V,{data:e,margin:{top:20,right:30,left:20,bottom:5},children:[m.jsxDEV(GV,{stroke:"hsl(var(--border))",opacity:.3},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:76,columnNumber:15},void 0),m.jsxDEV(WV,{dataKey:"category",tick:m.jsxDEV(i,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:82,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:80,columnNumber:15},void 0),m.jsxDEV(YV,{domain:[0,5],tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},axisLine:!1},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:84,columnNumber:15},void 0),m.jsxDEV(KV,{name:"Performance",dataKey:"rating",stroke:"hsl(var(--chart-1))",fill:"hsl(var(--chart-1))",fillOpacity:.2,strokeWidth:2},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:75,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:74,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:73,columnNumber:9},void 0),n&&m.jsxDEV("div",{className:"mt-4 space-y-3",children:[m.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:e.map(s=>{const o=a(s.rating);return o.level==="acceptable"?null:m.jsxDEV("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted/50",children:[m.jsxDEV(o.icon,{className:"w-4 h-4",style:{color:o.color}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:110,columnNumber:21},void 0),m.jsxDEV("span",{className:"font-medium",children:s.category},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:111,columnNumber:21},void 0),m.jsxDEV("span",{className:"text-muted-foreground",children:["(",s.rating.toFixed(1),")"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:112,columnNumber:21},void 0)]},s.category,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:109,columnNumber:19},void 0)})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:103,columnNumber:13},void 0),m.jsxDEV("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(vn,{className:"w-4 h-4 text-red-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:121,columnNumber:17},void 0),m.jsxDEV("span",{children:"Critical (< 2.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:122,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:120,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(Ut,{className:"w-4 h-4 text-orange-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:125,columnNumber:17},void 0),m.jsxDEV("span",{children:"Needs Attention (2.0-3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:126,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:124,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(Pn,{className:"w-4 h-4 text-green-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:129,columnNumber:17},void 0),m.jsxDEV("span",{children:"Acceptable (> 3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:130,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:128,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:119,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:101,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:72,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:62,columnNumber:5},void 0)},Xle=({title:e,value:r,description:t,trend:n,icon:a,color:i="primary",className:s=""})=>{const u=(f=>{switch(f){case"primary":return{text:"text-primary",bg:"bg-primary/10",border:"border-primary/20"};case"secondary":return{text:"text-secondary",bg:"bg-secondary/10",border:"border-secondary/20"};case"success":return{text:"text-green-600",bg:"bg-green-50",border:"border-green-200"};case"warning":return{text:"text-yellow-600",bg:"bg-yellow-50",border:"border-yellow-200"};case"destructive":return{text:"text-destructive",bg:"bg-destructive/10",border:"border-destructive/20"};default:return{text:"text-primary",bg:"bg-primary/10",border:"border-primary/20"}}})(i),l=f=>f>0?m.jsxDEV(lo,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:72,columnNumber:32},void 0):f<0?m.jsxDEV(B1,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:73,columnNumber:32},void 0):m.jsxDEV(sV,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:74,columnNumber:12},void 0),c=f=>f>0?"text-green-600":f<0?"text-red-600":"text-muted-foreground";return m.jsxDEV(qe,{className:s,children:[m.jsxDEV(Qe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsxDEV(Ze,{className:"text-sm font-medium text-muted-foreground",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:86,columnNumber:9},void 0),a&&m.jsxDEV("div",{className:`p-2 rounded-lg ${u.bg} ${u.border} border`,children:m.jsxDEV(a,{className:`w-4 h-4 ${u.text}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:91,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:90,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:85,columnNumber:7},void 0),m.jsxDEV(He,{children:m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV("div",{className:"text-2xl font-bold text-foreground",children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:97,columnNumber:11},void 0),t&&m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:101,columnNumber:13},void 0),n&&m.jsxDEV("div",{className:`flex items-center gap-1 text-sm ${c(n.value)}`,children:[l(n.value),m.jsxDEV("span",{className:"font-medium",children:[n.value>0?"+":"",n.value,"%"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:108,columnNumber:15},void 0),m.jsxDEV("span",{className:"text-muted-foreground",children:n.period},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:111,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:106,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:96,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:95,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:84,columnNumber:5},void 0)},Qle=({data:e,title:r="Room Performance Heatmap",description:t="Visual overview of room performance ratings",maxRoomsPerRow:n=8,onRoomClick:a})=>{const[i,s]=W.useState(null),o=h=>h>=4.5?"bg-green-100 text-green-800 border-green-200":h>=3.5?"bg-yellow-100 text-yellow-800 border-yellow-200":h>=2.5?"bg-orange-100 text-orange-800 border-orange-200":"bg-red-100 text-red-800 border-red-200",u=h=>h>=4.5?"Excellent":h>=3.5?"Good":h>=2.5?"Fair":"Needs Attention",l=h=>h<2?{level:"critical",color:"#EF4444",icon:vn}:h<3?{level:"needs-attention",color:"#F59E0B",icon:Ut}:{level:"acceptable",color:"#10B981",icon:Pn},c=h=>{s(h),a?.(h)},f=e.reduce((h,d)=>(h[d.school]||(h[d.school]=[]),h[d.school].push(d),h),{});return m.jsxDEV(qe,{className:"w-full offscreen-content layout-contained",children:[m.jsxDEV(Qe,{children:[m.jsxDEV(Ze,{className:"flex items-center gap-2 text-foreground",children:[m.jsxDEV(kg,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:76,columnNumber:11},void 0),r]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:75,columnNumber:9},void 0),m.jsxDEV(mr,{className:"text-muted-foreground",children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:79,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:74,columnNumber:7},void 0),m.jsxDEV(He,{children:m.jsxDEV("div",{className:"space-y-6",children:[Object.entries(f).map(([h,d])=>m.jsxDEV("div",{className:"space-y-3",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(xn,{className:"w-4 h-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:88,columnNumber:17},void 0),m.jsxDEV("h3",{className:"font-medium text-foreground",children:h},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:89,columnNumber:17},void 0),m.jsxDEV("span",{className:"text-sm text-muted-foreground",children:["(",d.length," rooms)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:90,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:87,columnNumber:15},void 0),m.jsxDEV("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${Math.min(n,d.length)}, 1fr)`},children:d.map(v=>m.jsxDEV(af,{children:[m.jsxDEV(xR,{asChild:!0,children:m.jsxDEV("div",{className:`
                          p-3 text-center text-xs rounded-lg border-2 transition-all duration-200 hover:scale-105 cursor-pointer
                          ${o(v.rating)}
                        `,title:`Room ${v.number}: ${v.rating.toFixed(1)}/5 - ${u(v.rating)}`,onClick:()=>c(v),children:[m.jsxDEV("div",{className:"font-bold text-sm mb-1",children:v.number},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:109,columnNumber:25},void 0),m.jsxDEV("div",{className:"text-xs opacity-75",children:v.rating.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:112,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:101,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:100,columnNumber:21},void 0),m.jsxDEV(Hl,{className:"max-w-2xl",children:[m.jsxDEV(zl,{children:[m.jsxDEV($l,{className:"flex items-center gap-2",children:[m.jsxDEV(kg,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:120,columnNumber:27},void 0),"Room ",v.number," - ",v.school]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:119,columnNumber:25},void 0),m.jsxDEV(Gl,{children:"Detailed performance analysis and inspection history"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:123,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:118,columnNumber:23},void 0),m.jsxDEV("div",{className:"space-y-6",children:[m.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsxDEV(qe,{children:m.jsxDEV(He,{className:"p-4",children:[m.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[m.jsxDEV(Aa,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:134,columnNumber:33},void 0),m.jsxDEV("span",{className:"text-sm font-medium",children:"Current Rating"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:135,columnNumber:33},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:133,columnNumber:31},void 0),m.jsxDEV("div",{className:"text-2xl font-bold",style:{color:l(v.rating).color},children:[v.rating.toFixed(1),"/5"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:137,columnNumber:31},void 0),m.jsxDEV("div",{className:"text-xs text-muted-foreground",children:u(v.rating)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:140,columnNumber:31},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:132,columnNumber:29},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:131,columnNumber:27},void 0),m.jsxDEV(qe,{children:m.jsxDEV(He,{className:"p-4",children:[m.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[m.jsxDEV(wt,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:149,columnNumber:33},void 0),m.jsxDEV("span",{className:"text-sm font-medium",children:"Last Inspection"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:150,columnNumber:33},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:148,columnNumber:31},void 0),m.jsxDEV("div",{className:"text-lg font-semibold",children:new Date(v.lastInspection).toLocaleDateString()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:152,columnNumber:31},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:147,columnNumber:29},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:146,columnNumber:27},void 0),m.jsxDEV(qe,{children:m.jsxDEV(He,{className:"p-4",children:[m.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[Is.createElement(l(v.rating).icon,{className:"w-4 h-4"}),m.jsxDEV("span",{className:"text-sm font-medium",children:"Status"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:162,columnNumber:33},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:160,columnNumber:31},void 0),m.jsxDEV(yr,{variant:l(v.rating).level==="critical"?"destructive":l(v.rating).level==="needs-attention"?"secondary":"default",className:"text-xs",children:l(v.rating).level.replace("-"," ").toUpperCase()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:164,columnNumber:31},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:159,columnNumber:29},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:158,columnNumber:27},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:130,columnNumber:25},void 0),v.categories&&m.jsxDEV("div",{children:[m.jsxDEV("h4",{className:"text-sm font-medium mb-3",children:"Category Performance"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:178,columnNumber:29},void 0),m.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(v.categories).map(([p,x])=>m.jsxDEV("div",{className:"flex justify-between items-center p-2 bg-muted/50 rounded",children:[m.jsxDEV("span",{className:"text-sm",children:p},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:182,columnNumber:35},void 0),m.jsxDEV("div",{className:"flex items-center gap-1",children:[m.jsxDEV("span",{className:"text-sm font-medium",children:x.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:184,columnNumber:37},void 0),x<3&&m.jsxDEV(vn,{className:"w-3 h-3 text-orange-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:185,columnNumber:54},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:183,columnNumber:35},void 0)]},p,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:181,columnNumber:33},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:179,columnNumber:29},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:177,columnNumber:27},void 0),v.inspectionHistory&&v.inspectionHistory.length>0&&m.jsxDEV("div",{children:[m.jsxDEV("h4",{className:"text-sm font-medium mb-3",children:"Inspection History"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:196,columnNumber:29},void 0),m.jsxDEV("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:v.inspectionHistory.slice(0,5).map((p,x)=>m.jsxDEV("div",{className:"flex justify-between items-center p-2 bg-muted/30 rounded text-sm",children:[m.jsxDEV("div",{children:[m.jsxDEV("span",{className:"font-medium",children:new Date(p.date).toLocaleDateString()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:201,columnNumber:37},void 0),p.inspector&&m.jsxDEV("span",{className:"text-muted-foreground ml-2",children:["by ",p.inspector]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:203,columnNumber:39},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:200,columnNumber:35},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV("span",{className:"font-medium",children:p.rating.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:207,columnNumber:37},void 0),p.rating<3&&m.jsxDEV(vn,{className:"w-3 h-3 text-orange-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:208,columnNumber:65},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:206,columnNumber:35},void 0)]},x,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:199,columnNumber:33},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:197,columnNumber:29},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:195,columnNumber:27},void 0),v.photos&&v.photos.length>0&&m.jsxDEV("div",{children:[m.jsxDEV("h4",{className:"text-sm font-medium mb-3",children:"Inspection Photos"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:219,columnNumber:29},void 0),m.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:v.photos.slice(0,4).map((p,x)=>m.jsxDEV("div",{className:"aspect-square bg-muted rounded overflow-hidden",children:m.jsxDEV("img",{src:p,alt:`Room ${v.number} photo ${x+1}`,className:"w-full h-full object-cover"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:223,columnNumber:35},void 0)},x,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:222,columnNumber:33},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:220,columnNumber:29},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:218,columnNumber:27},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:128,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:117,columnNumber:21},void 0)]},`${h}-${v.number}`,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:99,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:95,columnNumber:15},void 0)]},h,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:86,columnNumber:13},void 0)),m.jsxDEV("div",{className:"border-t border-border pt-4",children:[m.jsxDEV("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Performance Legend"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:243,columnNumber:13},void 0),m.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV("div",{className:"w-3 h-3 rounded bg-green-100 border border-green-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:246,columnNumber:17},void 0),m.jsxDEV("span",{className:"text-muted-foreground",children:"Excellent (4.5+)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:247,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:245,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV("div",{className:"w-3 h-3 rounded bg-yellow-100 border border-yellow-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:250,columnNumber:17},void 0),m.jsxDEV("span",{className:"text-muted-foreground",children:"Good (3.5-4.4)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:251,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:249,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV("div",{className:"w-3 h-3 rounded bg-orange-100 border border-orange-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:254,columnNumber:17},void 0),m.jsxDEV("span",{className:"text-muted-foreground",children:"Fair (2.5-3.4)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:255,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:253,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV("div",{className:"w-3 h-3 rounded bg-red-100 border border-red-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:258,columnNumber:17},void 0),m.jsxDEV("span",{className:"text-muted-foreground",children:"Needs Attention (<2.5)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:259,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:257,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:244,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:242,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:84,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:83,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:73,columnNumber:5},void 0)},Lb=({groupName:e,inspections:r,type:t,onInspectionClick:n})=>{const[a,i]=W.useState(!1),s=r.length,o=r.map(v=>{const x=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(g=>v[g]).filter(g=>typeof g=="number");return x.length>0?x.reduce((g,N)=>g+N,0)/x.length:null}).filter(v=>v!==null),u=o.length>0?Math.round(o.reduce((v,p)=>v+p,0)/o.length*10)/10:0,l=r.length>0?{earliest:new Date(Math.min(...r.map(v=>new Date(v.date).getTime()))),latest:new Date(Math.max(...r.map(v=>new Date(v.date).getTime())))}:null,c=()=>{switch(t){case"school":return m.jsxDEV(xn,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:57,columnNumber:16},void 0);case"date":return m.jsxDEV(wt,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:59,columnNumber:16},void 0);case"inspector":return m.jsxDEV(ni,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:61,columnNumber:16},void 0);default:return m.jsxDEV(ja,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:63,columnNumber:16},void 0)}},f=()=>{switch(t){case"school":return"School";case"date":return"Month";case"inspector":return"Inspector";default:return"Group"}},h=v=>m.jsxDEV("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(p=>m.jsxDEV(Aa,{className:`w-3 h-3 ${p<=v?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},p,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:84,columnNumber:11},void 0)),m.jsxDEV("span",{className:"ml-1 text-xs text-muted-foreground",children:v.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:93,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:82,columnNumber:7},void 0),d=()=>{if(!l)return"";const v=p=>p.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${v(l.earliest)} - ${v(l.latest)}`};return m.jsxDEV(qe,{className:"w-full",children:[m.jsxDEV(Qe,{className:"cursor-pointer",onClick:()=>i(!a),children:[m.jsxDEV(Ze,{className:"flex items-center justify-between",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[c(),m.jsxDEV("span",{className:"text-foreground",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:115,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:113,columnNumber:11},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(yr,{variant:"secondary",className:"text-xs",children:[s," inspections"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:118,columnNumber:13},void 0),m.jsxDEV(We,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:a?m.jsxDEV($i,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:127,columnNumber:17},void 0):m.jsxDEV(Xc,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:129,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:121,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:117,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:112,columnNumber:9},void 0),m.jsxDEV(mr,{className:"flex items-center justify-between",children:[m.jsxDEV("div",{className:"flex items-center gap-4",children:[m.jsxDEV("span",{className:"text-sm text-muted-foreground",children:[f(),": ",e]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:136,columnNumber:13},void 0),l&&m.jsxDEV("span",{className:"text-xs text-muted-foreground",children:d()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:140,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:135,columnNumber:11},void 0),u>0&&m.jsxDEV("div",{className:"flex items-center gap-1",children:h(Math.round(u))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:146,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:134,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:108,columnNumber:7},void 0),a&&m.jsxDEV(He,{className:"pt-0",children:m.jsxDEV("div",{className:"space-y-3",children:[m.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-3 bg-muted/30 rounded-lg",children:[m.jsxDEV("div",{className:"text-center",children:[m.jsxDEV("p",{className:"text-lg font-bold text-foreground",children:s},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:159,columnNumber:17},void 0),m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Total"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:160,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:158,columnNumber:15},void 0),m.jsxDEV("div",{className:"text-center",children:[m.jsxDEV("p",{className:"text-lg font-bold text-primary",children:u.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:163,columnNumber:17},void 0),m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Avg Rating"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:164,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:162,columnNumber:15},void 0),m.jsxDEV("div",{className:"text-center",children:[m.jsxDEV("p",{className:"text-lg font-bold text-green-600",children:r.filter(v=>v.inspectionType==="single_room").length},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:167,columnNumber:17},void 0),m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Single Room"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:170,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:166,columnNumber:15},void 0),m.jsxDEV("div",{className:"text-center",children:[m.jsxDEV("p",{className:"text-lg font-bold text-blue-600",children:r.filter(v=>v.inspectionType==="whole_building").length},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:173,columnNumber:17},void 0),m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Building"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:176,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:172,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:157,columnNumber:13},void 0),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Individual Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:182,columnNumber:15},void 0),r.sort((v,p)=>new Date(p.date).getTime()-new Date(v.date).getTime()).map(v=>{const p=(()=>{const g=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(N=>v[N]).filter(N=>typeof N=="number");return g.length>0?Math.round(g.reduce((N,b)=>N+b,0)/g.length*10)/10:0})();return m.jsxDEV("div",{className:"flex items-center justify-between p-3 border border-border rounded-lg hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>n?.(v),children:[m.jsxDEV("div",{className:"flex items-center gap-3",children:[m.jsxDEV("div",{className:"flex items-center gap-1",children:[m.jsxDEV(kg,{className:"w-3 h-3 text-muted-foreground"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:210,columnNumber:27},void 0),m.jsxDEV("span",{className:"text-sm font-medium text-foreground",children:v.inspectionType==="single_room"?`Room ${v.roomNumber??"Not specified"}`:`Building: ${v.buildingName||v.locationDescription||"Whole Building"}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:211,columnNumber:27},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:209,columnNumber:25},void 0),m.jsxDEV(yr,{variant:v.inspectionType==="single_room"?"default":"secondary",className:"text-xs",children:v.inspectionType==="single_room"?"Single Room":"Whole Building"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:218,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:208,columnNumber:23},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[p>0&&m.jsxDEV("div",{className:"flex items-center gap-1",children:h(Math.round(p))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:227,columnNumber:27},void 0),m.jsxDEV("span",{className:"text-xs text-muted-foreground",children:new Date(v.date).toLocaleDateString()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:231,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:225,columnNumber:23},void 0)]},v.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:203,columnNumber:21},void 0)})]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:181,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:155,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:154,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:107,columnNumber:5},void 0)},Zle=({inspections:e,onInspectionClick:r})=>{const t=e.reduce((o,u)=>(o[u.school]||(o[u.school]=[]),o[u.school].push(u),o),{}),n=Object.entries(t).sort(([,o],[,u])=>u.length-o.length),a=n.length,i=e.length,s=a>0?Math.round(i/a*10)/10:0;return m.jsxDEV("div",{className:"space-y-6",children:[m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{children:[m.jsxDEV(Ze,{className:"flex items-center gap-2 text-foreground",children:[m.jsxDEV(xn,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:40,columnNumber:13},void 0),"School Performance Overview"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:39,columnNumber:11},void 0),m.jsxDEV(mr,{className:"text-muted-foreground",children:"Inspections grouped by school with performance metrics"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:43,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:38,columnNumber:9},void 0),m.jsxDEV(He,{children:m.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsxDEV("div",{className:"text-center p-4 bg-primary/10 rounded-lg",children:[m.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:m.jsxDEV(xn,{className:"w-6 h-6 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:51,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:50,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:a},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:53,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Total Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:54,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:49,columnNumber:13},void 0),m.jsxDEV("div",{className:"text-center p-4 bg-secondary/10 rounded-lg",children:[m.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:m.jsxDEV(lo,{className:"w-6 h-6 text-secondary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:58,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:57,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:i},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:60,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Total Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:61,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:56,columnNumber:13},void 0),m.jsxDEV("div",{className:"text-center p-4 bg-accent/10 rounded-lg",children:[m.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:m.jsxDEV(oV,{className:"w-6 h-6 text-accent"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:65,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:64,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:s},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:67,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Avg per School"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:68,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:63,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:48,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:47,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:37,columnNumber:7},void 0),m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[m.jsxDEV(xn,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:77,columnNumber:11},void 0),"Schools (",a,")"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:76,columnNumber:9},void 0),n.length===0?m.jsxDEV(qe,{children:m.jsxDEV(He,{className:"text-center py-8",children:[m.jsxDEV(xn,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:84,columnNumber:15},void 0),m.jsxDEV("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No School Data"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:85,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-muted-foreground",children:"No inspection data available for school grouping."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:86,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:83,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:82,columnNumber:11},void 0):m.jsxDEV("div",{className:"space-y-3",children:n.map(([o,u])=>m.jsxDEV(Lb,{groupName:o,inspections:u,type:"school",onInspectionClick:r},o,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:92,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:90,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:75,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:35,columnNumber:5},void 0)},Jle=({inspections:e,onInspectionClick:r})=>{const t=e.reduce((c,f)=>{const h=new Date(f.date),d=`${h.getFullYear()}-${String(h.getMonth()+1).padStart(2,"0")}`,v=h.toLocaleDateString("en-US",{month:"long",year:"numeric"});return c[d]||(c[d]={monthName:v,inspections:[]}),c[d].inspections.push(f),c},{}),n=Object.entries(t).sort(([c],[f])=>f.localeCompare(c)),a=n.length,i=e.length,s=a>0?Math.round(i/a*10)/10:0,o=new Date().toISOString().slice(0,7),u=t[o],l=u?.inspections.length||0;return m.jsxDEV("div",{className:"space-y-6",children:[m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{children:[m.jsxDEV(Ze,{className:"flex items-center gap-2 text-foreground",children:[m.jsxDEV(wt,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:52,columnNumber:13},void 0),"Monthly Performance Overview"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:51,columnNumber:11},void 0),m.jsxDEV(mr,{className:"text-muted-foreground",children:"Inspections grouped by month with trend analysis"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:55,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:50,columnNumber:9},void 0),m.jsxDEV(He,{children:m.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsxDEV("div",{className:"text-center p-4 bg-primary/10 rounded-lg",children:[m.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:m.jsxDEV(wt,{className:"w-6 h-6 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:63,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:62,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:a},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:65,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Active Months"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:66,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:61,columnNumber:13},void 0),m.jsxDEV("div",{className:"text-center p-4 bg-secondary/10 rounded-lg",children:[m.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:m.jsxDEV(lo,{className:"w-6 h-6 text-secondary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:70,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:69,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:i},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:72,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Total Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:73,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:68,columnNumber:13},void 0),m.jsxDEV("div",{className:"text-center p-4 bg-accent/10 rounded-lg",children:[m.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:m.jsxDEV(P1,{className:"w-6 h-6 text-accent"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:77,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:76,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:s},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:79,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Avg per Month"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:80,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:75,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:60,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:59,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:49,columnNumber:7},void 0),u&&m.jsxDEV(qe,{className:"border-primary/20 bg-primary/5",children:m.jsxDEV(Qe,{children:[m.jsxDEV(Ze,{className:"flex items-center gap-2 text-primary",children:[m.jsxDEV(wt,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:91,columnNumber:15},void 0),"Current Month: ",u.monthName]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:90,columnNumber:13},void 0),m.jsxDEV(mr,{children:[l," inspections this month"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:89,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:88,columnNumber:9},void 0),m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[m.jsxDEV(wt,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:104,columnNumber:11},void 0),"Monthly Breakdown (",a," months)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:103,columnNumber:9},void 0),n.length===0?m.jsxDEV(qe,{children:m.jsxDEV(He,{className:"text-center py-8",children:[m.jsxDEV(wt,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:111,columnNumber:15},void 0),m.jsxDEV("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No Monthly Data"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:112,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-muted-foreground",children:"No inspection data available for monthly grouping."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:113,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:110,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:109,columnNumber:11},void 0):m.jsxDEV("div",{className:"space-y-3",children:n.map(([c,f])=>m.jsxDEV(Lb,{groupName:f.monthName,inspections:f.inspections,type:"date",onInspectionClick:r},c,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:119,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:117,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:102,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:47,columnNumber:5},void 0)},eue=({inspections:e,onInspectionClick:r})=>{const t=e.reduce((l,c)=>{const f=c.inspectorName||"Unknown Inspector";return l[f]||(l[f]=[]),l[f].push(c),l},{}),n=Object.entries(t).sort(([,l],[,c])=>c.length-l.length),a=n.length,i=e.length,s=a>0?Math.round(i/a*10)/10:0,o=n[0],u=o?.[1].length||0;return m.jsxDEV("div",{className:"space-y-6",children:[m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{children:[m.jsxDEV(Ze,{className:"flex items-center gap-2 text-foreground",children:[m.jsxDEV(ni,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:45,columnNumber:13},void 0),"Inspector Performance Overview"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:44,columnNumber:11},void 0),m.jsxDEV(mr,{className:"text-muted-foreground",children:"Inspections grouped by inspector with performance metrics"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:48,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:43,columnNumber:9},void 0),m.jsxDEV(He,{children:m.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsxDEV("div",{className:"text-center p-4 bg-primary/10 rounded-lg",children:[m.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:m.jsxDEV(ni,{className:"w-6 h-6 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:56,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:55,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:a},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:58,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Active Inspectors"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:59,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:54,columnNumber:13},void 0),m.jsxDEV("div",{className:"text-center p-4 bg-secondary/10 rounded-lg",children:[m.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:m.jsxDEV(lo,{className:"w-6 h-6 text-secondary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:63,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:62,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:i},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:65,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Total Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:66,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:61,columnNumber:13},void 0),m.jsxDEV("div",{className:"text-center p-4 bg-accent/10 rounded-lg",children:[m.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:m.jsxDEV(uy,{className:"w-6 h-6 text-accent"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:70,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:69,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:s},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:72,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Avg per Inspector"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:73,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:68,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:53,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:52,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:42,columnNumber:7},void 0),o&&m.jsxDEV(qe,{className:"border-primary/20 bg-primary/5",children:m.jsxDEV(Qe,{children:[m.jsxDEV(Ze,{className:"flex items-center gap-2 text-primary",children:[m.jsxDEV(uy,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:84,columnNumber:15},void 0),"Top Performer: ",o[0]]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:83,columnNumber:13},void 0),m.jsxDEV(mr,{children:[u," inspections completed"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:87,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:82,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:81,columnNumber:9},void 0),m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[m.jsxDEV(ni,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:97,columnNumber:11},void 0),"Inspectors (",a,")"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:96,columnNumber:9},void 0),n.length===0?m.jsxDEV(qe,{children:m.jsxDEV(He,{className:"text-center py-8",children:[m.jsxDEV(ni,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:104,columnNumber:15},void 0),m.jsxDEV("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No Inspector Data"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:105,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-muted-foreground",children:"No inspection data available for inspector grouping."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:106,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:103,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:102,columnNumber:11},void 0):m.jsxDEV("div",{className:"space-y-3",children:n.map(([l,c])=>m.jsxDEV(Lb,{groupName:l,inspections:c,type:"inspector",onInspectionClick:r},l,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:112,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:110,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:95,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:40,columnNumber:5},void 0)},EH=2,wH=3;function fs(e){const t=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(a=>e[a]).filter(a=>typeof a=="number");if(t.length===0)return null;const n=t.reduce((a,i)=>a+i,0)/t.length;return Math.round(n*10)/10}function Bb(e){return e<EH?"critical":e<wH?"needs-attention":"acceptable"}function _H(e){const r=["urgent","emergency","safety","hazard","leak","flood","fire","electrical"],t=["immediate","asap","critical","dangerous","broken","damaged"],n=["needs","require","attention","maintenance","repair"],a=`${e.notes} ${e.location} ${e.locationDescription}`.toLowerCase();let i="low";const s=[];return r.some(o=>a.includes(o))?(i="urgent",s.push(...r.filter(o=>a.includes(o)))):t.some(o=>a.includes(o))?(i="high",s.push(...t.filter(o=>a.includes(o)))):n.some(o=>a.includes(o))&&(i="medium",s.push(...n.filter(o=>a.includes(o)))),{note:e,severity:i,keywords:s}}function qb(e){const r=[],t=[];e.forEach(s=>{const o=fs(s);if(o===null)return;const u=Bb(o);if(u==="acceptable")return;const l={inspection:s,rating:o,severity:u,location:s.inspectionType==="single_room"?`Room ${s.roomNumber}`:s.buildingName||s.locationDescription||"Whole Building",school:s.school,date:s.date};u==="critical"?r.push(l):t.push(l)}),r.sort((s,o)=>s.rating-o.rating),t.sort((s,o)=>s.rating-o.rating);const n=new Set([...r,...t].map(s=>s.school)),a=[...r,...t].reduce((s,o)=>(s[o.school]=(s[o.school]||0)+1,s),{}),i=Object.entries(a).sort(([,s],[,o])=>o-s)[0]?.[0]||null;return{critical:r,needsAttention:t,urgentNotes:[],summary:{totalProblems:r.length+t.length,criticalCount:r.length,needsAttentionCount:t.length,urgentNotesCount:0,affectedSchools:Array.from(n),mostProblematicSchool:i,mostProblematicCategory:null}}}function Hb(e){return e.map(_H).filter(r=>r.severity==="urgent"||r.severity==="high").sort((r,t)=>{const n={urgent:0,high:1,medium:2,low:3};return n[r.severity]-n[t.severity]})}function SH(e){switch(e){case"critical":return{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200",text:"Critical"};case"needs-attention":return{variant:"secondary",className:"bg-orange-100 text-orange-800 border-orange-200",text:"Needs Attention"};case"acceptable":return{variant:"default",className:"bg-green-100 text-green-800 border-green-200",text:"Acceptable"}}}function TH(e){switch(e){case"urgent":return{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200 animate-pulse",text:"URGENT"};case"high":return{variant:"secondary",className:"bg-orange-100 text-orange-800 border-orange-200",text:"High Priority"};case"medium":return{variant:"outline",className:"bg-yellow-100 text-yellow-800 border-yellow-200",text:"Medium Priority"};case"low":return{variant:"outline",className:"bg-gray-100 text-gray-800 border-gray-200",text:"Low Priority"}}}const tF=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(v4,{className:Ae("grid gap-2",e),...r,ref:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/radio-group.tsx",lineNumber:12,columnNumber:5},void 0));tF.displayName=v4.displayName;const ec=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(x4,{ref:t,className:Ae("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:m.jsxDEV(lV,{className:"flex items-center justify-center",children:m.jsxDEV(uV,{className:"h-2.5 w-2.5 fill-current text-current"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/radio-group.tsx",lineNumber:35,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/radio-group.tsx",lineNumber:34,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/radio-group.tsx",lineNumber:26,columnNumber:5},void 0));ec.displayName=x4.displayName;const it=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(g4,{ref:t,className:Ae("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...r,children:m.jsxDEV(cV,{className:Ae("flex items-center justify-center text-current"),children:m.jsxDEV(M1,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/checkbox.tsx",lineNumber:22,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/checkbox.tsx",lineNumber:19,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/checkbox.tsx",lineNumber:11,columnNumber:3},void 0));it.displayName=g4.displayName;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Dc={};Dc.version="0.18.5";var nF=1252,DH=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],aF=function(e){DH.indexOf(e)!=-1&&(nF=e)};function AH(){aF(1252)}var Sl=function(e){aF(e)};function kH(){Sl(1200),AH()}var Ou=function(r){return String.fromCharCode(r)},k_=function(r){return String.fromCharCode(r)},Ac,ai="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Tl(e){for(var r="",t=0,n=0,a=0,i=0,s=0,o=0,u=0,l=0;l<e.length;)t=e.charCodeAt(l++),i=t>>2,n=e.charCodeAt(l++),s=(t&3)<<4|n>>4,a=e.charCodeAt(l++),o=(n&15)<<2|a>>6,u=a&63,isNaN(n)?o=u=64:isNaN(a)&&(u=64),r+=ai.charAt(i)+ai.charAt(s)+ai.charAt(o)+ai.charAt(u);return r}function Ia(e){var r="",t=0,n=0,a=0,i=0,s=0,o=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)i=ai.indexOf(e.charAt(l++)),s=ai.indexOf(e.charAt(l++)),t=i<<2|s>>4,r+=String.fromCharCode(t),o=ai.indexOf(e.charAt(l++)),n=(s&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(n)),u=ai.indexOf(e.charAt(l++)),a=(o&3)<<6|u,u!==64&&(r+=String.fromCharCode(a));return r}var cr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ha=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function rs(e){return cr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function R_(e){return cr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Fn=function(r){return cr?Ha(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function Cf(e){if(typeof ArrayBuffer>"u")return Fn(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function Jl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function RH(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var vt=cr?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Ha(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function OH(e){for(var r=[],t=0,n=e.length+250,a=rs(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[t++]=s;else if(s<2048)a[t++]=192|s>>6&31,a[t++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[t++]=240|s>>8&7,a[t++]=128|s>>2&63,a[t++]=128|o>>6&15|(s&3)<<4,a[t++]=128|o&63}else a[t++]=224|s>>12&15,a[t++]=128|s>>6&63,a[t++]=128|s&63;t>n&&(r.push(a.slice(0,t)),t=0,a=rs(65535),n=65530)}return r.push(a.slice(0,t)),vt(r)}var tl=/\u0000/g,Fu=/[\u0001-\u0006]/g;function qs(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function In(e,r){var t=""+e;return t.length>=r?t:Lr("0",r-t.length)+t}function zb(e,r){var t=""+e;return t.length>=r?t:Lr(" ",r-t.length)+t}function kc(e,r){var t=""+e;return t.length>=r?t:t+Lr(" ",r-t.length)}function FH(e,r){var t=""+Math.round(e);return t.length>=r?t:Lr("0",r-t.length)+t}function UH(e,r){var t=""+e;return t.length>=r?t:Lr("0",r-t.length)+t}var O_=Math.pow(2,32);function _s(e,r){if(e>O_||e<-O_)return FH(e,r);var t=Math.round(e);return UH(t,r)}function Rc(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var F_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],sp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function IH(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var qr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},U_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},PH={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Oc(e,r,t){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,u=1,l=0,c=0,f=Math.floor(a);l<r&&(f=Math.floor(a),o=f*s+i,c=f*l+u,!(a-f<5e-8));)a=1/(a-f),i=s,s=o,u=l,l=c;if(c>r&&(l>r?(c=u,o=i):(c=l,o=s)),!t)return[0,n*o,c];var h=Math.floor(n*o/c);return[h,n*o-h*c,c]}function Uu(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=t?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=t?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),s=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),n<60&&(i=(i+6)%7),t&&(i=HH(u,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var iF=new Date(1899,11,31,0,0,0),VH=iF.getTime(),MH=new Date(1900,2,1,0,0,0);function sF(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=MH&&(t+=1440*60*1e3),(t-(VH+(e.getTimezoneOffset()-iF.getTimezoneOffset())*6e4))/(1440*60*1e3)}function $b(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jH(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function LH(e){var r=e<0?12:11,t=$b(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function BH(e){var r=$b(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function qH(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=LH(e):r===10?t=e.toFixed(10).substr(0,12):t=BH(e),$b(jH(t.toUpperCase()))}function Zg(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):qH(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ci(14,sF(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function HH(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function zH(e,r,t,n){var a="",i=0,s=0,o=t.y,u,l=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:u=o%100,l=2;break;default:u=o%1e4,l=4;break}break;case 109:switch(r.length){case 1:case 2:u=t.m,l=r.length;break;case 3:return sp[t.m-1][1];case 5:return sp[t.m-1][0];default:return sp[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:u=t.d,l=r.length;break;case 3:return F_[t.q][0];default:return F_[t.q][1]}break;case 104:switch(r.length){case 1:case 2:u=1+(t.H+11)%12,l=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:u=t.H,l=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:u=t.M,l=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?In(t.S,r.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(t.S+t.u)),i>=60*s&&(i=0),r==="s"?i===0?"0":""+i/s:(a=In(i,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":u=t.D*24+t.H;break;case"[m]":case"[mm]":u=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":u=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}l=r.length===3?1:2;break;case 101:u=o,l=1;break}var c=l>0?In(u,l):"";return c}function ii(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var oF=/%/g;function $H(e,r,t){var n=r.replace(oF,""),a=r.length-n.length;return _a(e,n,t*Math.pow(10,2*a))+Lr("%",a)}function GH(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return _a(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function lF(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+lF(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(r/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),t.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,l,c){return u+l+c.substr(0,(a+i)%a)+"."+c.substr(i)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var uF=/# (\?+)( ?)\/( ?)(\d+)/;function WH(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),i=Math.floor(a/n),s=a-i*n,o=n;return t+(i===0?"":""+i)+" "+(s===0?Lr(" ",e[1].length+1+e[4].length):zb(s,e[1].length)+e[2]+"/"+e[3]+In(o,e[4].length))}function YH(e,r,t){return t+(r===0?"":""+r)+Lr(" ",e[1].length+2+e[4].length)}var cF=/^#*0*\.([0#]+)/,fF=/\).*[0#]/,mF=/\(###\) ###\\?-####/;function kt(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function I_(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function P_(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function KH(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function XH(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function mn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(fF)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?mn("n",n,t):"("+mn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return GH(e,r,t);if(r.indexOf("%")!==-1)return $H(e,r,t);if(r.indexOf("E")!==-1)return lF(r,t);if(r.charCodeAt(0)===36)return"$"+mn(e,r.substr(r.charAt(1)==" "?2:1),t);var a,i,s,o,u=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+_s(u,r.length);if(r.match(/^[#?]+$/))return a=_s(t,0),a==="0"&&(a=""),a.length>r.length?a:kt(r.substr(0,r.length-a.length))+a;if(i=r.match(uF))return WH(i,u,l);if(r.match(/^#+0+$/))return l+_s(u,r.length-r.indexOf("0"));if(i=r.match(cF))return a=I_(t,i[1].length).replace(/^([^\.]+)$/,"$1."+kt(i[1])).replace(/\.$/,"."+kt(i[1])).replace(/\.(\d*)$/,function(v,p){return"."+p+Lr("0",kt(i[1]).length-p.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+I_(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+ii(_s(u,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+mn(e,r,-t):ii(""+(Math.floor(t)+KH(t,i[1].length)))+"."+In(P_(t,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return mn(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qs(mn(e,r.replace(/[\\-]/g,""),t)),s=0,qs(qs(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(r.match(mF))return a=mn(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var c="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Oc(u,Math.pow(10,s)-1,!1),a=""+l,c=_a("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),a+=c+i[2]+"/"+i[3],c=kc(o[2],s),c.length<i[4].length&&(c=kt(i[4].substr(i[4].length-c.length))+c),a+=c,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Oc(u,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zb(o[1],s)+i[2]+"/"+i[3]+kc(o[2],s):Lr(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=_s(t,0),r.length<=a.length?a:kt(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=r.indexOf(".")-s,h=r.length-a.length-f;return kt(r.substr(0,f)+a+r.substr(r.length-h))}if(i=r.match(/^00,000\.([#0]*0)$/))return s=P_(t,i[1].length),t<0?"-"+mn(e,r,-t):ii(XH(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?In(0,3-v.length):"")+v})+"."+In(s,i[1].length);switch(r){case"###,##0.00":return mn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var d=ii(_s(u,0));return d!=="0"?l+d:"";case"###,###.00":return mn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return mn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function QH(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return _a(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function ZH(e,r,t){var n=r.replace(oF,""),a=r.length-n.length;return _a(e,n,t*Math.pow(10,2*a))+Lr("%",a)}function dF(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+dF(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(r/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!t.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,l,c){return u+l+c.substr(0,(a+i)%a)+"."+c.substr(i)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Gn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(fF)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Gn("n",n,t):"("+Gn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return QH(e,r,t);if(r.indexOf("%")!==-1)return ZH(e,r,t);if(r.indexOf("E")!==-1)return dF(r,t);if(r.charCodeAt(0)===36)return"$"+Gn(e,r.substr(r.charAt(1)==" "?2:1),t);var a,i,s,o,u=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+In(u,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:kt(r.substr(0,r.length-a.length))+a;if(i=r.match(uF))return YH(i,u,l);if(r.match(/^#+0+$/))return l+In(u,r.length-r.indexOf("0"));if(i=r.match(cF))return a=(""+t).replace(/^([^\.]+)$/,"$1."+kt(i[1])).replace(/\.$/,"."+kt(i[1])),a=a.replace(/\.(\d*)$/,function(v,p){return"."+p+Lr("0",kt(i[1]).length-p.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+ii(""+u);if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Gn(e,r,-t):ii(""+t)+"."+Lr("0",i[1].length);if(i=r.match(/^#,#*,#0/))return Gn(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qs(Gn(e,r.replace(/[\\-]/g,""),t)),s=0,qs(qs(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(r.match(mF))return a=Gn(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var c="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Oc(u,Math.pow(10,s)-1,!1),a=""+l,c=_a("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),a+=c+i[2]+"/"+i[3],c=kc(o[2],s),c.length<i[4].length&&(c=kt(i[4].substr(i[4].length-c.length))+c),a+=c,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Oc(u,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zb(o[1],s)+i[2]+"/"+i[3]+kc(o[2],s):Lr(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:kt(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=r.indexOf(".")-s,h=r.length-a.length-f;return kt(r.substr(0,f)+a+r.substr(r.length-h))}if(i=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Gn(e,r,-t):ii(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?In(0,3-v.length):"")+v})+"."+In(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var d=ii(""+u);return d!=="0"?l+d:"";default:if(r.match(/\.[0#?]*$/))return Gn(e,r.slice(0,r.lastIndexOf(".")),t)+kt(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function _a(e,r,t){return(t|0)===t?Gn(e,r,t):mn(e,r,t)}function JH(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var hF=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function pF(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Rc(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(hF))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function ez(e,r,t,n){for(var a=[],i="",s=0,o="",u="t",l,c,f,h="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Rc(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(f=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++s;break;case"\\":var d=e.charAt(++s),v=d==="("||d===")"?d:"t";a[a.length]={t:v,v:d},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:r},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(l==null&&(l=Uu(r,t,e.charAt(s+1)==="2"),l==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},u=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||l==null&&(l=Uu(r,t),l==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:i},u=o;break;case"A":case"a":case"ä¸Š":var p={t:o,v:o};if(l==null&&(l=Uu(r,t)),e.substr(s,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(l!=null&&(p.v=l.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),p.t="T",s+=5,h="h"):(p.t="t",++s),l==null&&p.t==="T")return"";a[a.length]=p,u=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(hF)){if(l==null&&(l=Uu(r,t),l==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",pF(e)||(a[a.length]={t:"t",v:i}));break;case".":if(l!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},u=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var x=0,g=0,N;for(s=a.length-1,u="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=h,u="h",x<1&&(x=1);break;case"s":(N=a[s].v.match(/\.0+$/))&&(g=Math.max(g,N[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":u=a[s].t;break;case"m":u==="s"&&(a[s].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&a[s].v.match(/[Hh]/)&&(x=1),x<2&&a[s].v.match(/[Mm]/)&&(x=2),x<3&&a[s].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var b="",y;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=zH(a[s].t.charCodeAt(0),a[s].v,l,g),a[s].t="t";break;case"n":case"?":for(y=s+1;a[y]!=null&&((o=a[y].t)==="?"||o==="D"||(o===" "||o==="t")&&a[y+1]!=null&&(a[y+1].t==="?"||a[y+1].t==="t"&&a[y+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[y].v==="/"||a[y].v===" "&&a[y+1]!=null&&a[y+1].t=="?"));)a[s].v+=a[y].v,a[y]={v:"",t:";"},++y;b+=a[s].v,s=y-1;break;case"G":a[s].t="t",a[s].v=Zg(r,t);break}var _="",w,C;if(b.length>0){b.charCodeAt(0)==40?(w=r<0&&b.charCodeAt(0)===45?-r:r,C=_a("n",b,w)):(w=r<0&&n>1?-r:r,C=_a("n",b,w),w<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),y=C.length-1;var k=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){k=s;break}var D=a.length;if(k===a.length&&C.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(y>=a[s].v.length-1?(y-=a[s].v.length,a[s].v=C.substr(y+1,a[s].v.length)):y<0?a[s].v="":(a[s].v=C.substr(0,y+1),y=-1),a[s].t="t",D=s);y>=0&&D<a.length&&(a[D].v=C.substr(0,y+1)+a[D].v)}else if(k!==a.length&&C.indexOf("E")===-1){for(y=C.indexOf(".")-1,s=k;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(c=a[s].v.indexOf(".")>-1&&s===k?a[s].v.indexOf(".")-1:a[s].v.length-1,_=a[s].v.substr(c+1);c>=0;--c)y>=0&&(a[s].v.charAt(c)==="0"||a[s].v.charAt(c)==="#")&&(_=C.charAt(y--)+_);a[s].v=_,a[s].t="t",D=s}for(y>=0&&D<a.length&&(a[D].v=C.substr(0,y+1)+a[D].v),y=C.indexOf(".")+1,s=k;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==k)){for(c=a[s].v.indexOf(".")>-1&&s===k?a[s].v.indexOf(".")+1:0,_=a[s].v.substr(0,c);c<a[s].v.length;++c)y<C.length&&(_+=C.charAt(y++));a[s].v=_,a[s].t="t",D=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(w=n>1&&r<0&&s>0&&a[s-1].v==="-"?-r:r,a[s].v=_a(a[s].t,a[s].v,w),a[s].t="t");var U="";for(s=0;s!==a.length;++s)a[s]!=null&&(U+=a[s].v);return U}var V_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function M_(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function rz(e,r){var t=JH(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var i=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var s=t[0].match(V_),o=t[1].match(V_);return M_(r,s)?[n,t[0]]:M_(r,o)?[n,t[1]]:[n,t[s!=null&&o!=null?2:1]]}return[n,i]}function ci(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:qr)[e],n==null&&(n=t.table&&t.table[U_[e]]||qr[U_[e]]),n==null&&(n=PH[e]||"General");break}if(Rc(n,0))return Zg(r,t);r instanceof Date&&(r=sF(r,t.date1904));var a=rz(n,r);if(Rc(a[1]))return Zg(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return ez(a[1],r,t,a[0])}function vF(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(qr[t]==null){r<0&&(r=t);continue}if(qr[t]==e){r=t;break}}r<0&&(r=391)}return qr[r]=e,r}function Ef(e){for(var r=0;r!=392;++r)e[r]!==void 0&&vF(e[r],r)}function wf(){qr=IH()}var xF=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function tz(e){var r=typeof e=="number"?qr[e]:e;return r=r.replace(xF,"(\\d+)"),new RegExp("^"+r+"$")}function nz(e,r,t){var n=-1,a=-1,i=-1,s=-1,o=-1,u=-1;(r.match(xF)||[]).forEach(function(f,h){var d=parseInt(t[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=d;break;case"d":i=d;break;case"h":s=d;break;case"s":u=d;break;case"m":s>=0?o=d:a=d;break}}),u>=0&&o==-1&&a>=0&&(o=a,a=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var c=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return s==-1&&o==-1&&u==-1?l:n==-1&&a==-1&&i==-1?c:l+"T"+c}var az=(function(){var e={};e.version="1.2.0";function r(){for(var C=0,k=new Array(256),D=0;D!=256;++D)C=D,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,k[D]=C;return typeof Int32Array<"u"?new Int32Array(k):k}var t=r();function n(C){var k=0,D=0,U=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)F[U]=C[U];for(U=0;U!=256;++U)for(D=C[U],k=256+U;k<4096;k+=256)D=F[k]=D>>>8^C[D&255];var L=[];for(U=1;U!=16;++U)L[U-1]=typeof Int32Array<"u"?F.subarray(U*256,U*256+256):F.slice(U*256,U*256+256);return L}var a=n(t),i=a[0],s=a[1],o=a[2],u=a[3],l=a[4],c=a[5],f=a[6],h=a[7],d=a[8],v=a[9],p=a[10],x=a[11],g=a[12],N=a[13],b=a[14];function y(C,k){for(var D=k^-1,U=0,F=C.length;U<F;)D=D>>>8^t[(D^C.charCodeAt(U++))&255];return~D}function _(C,k){for(var D=k^-1,U=C.length-15,F=0;F<U;)D=b[C[F++]^D&255]^N[C[F++]^D>>8&255]^g[C[F++]^D>>16&255]^x[C[F++]^D>>>24]^p[C[F++]]^v[C[F++]]^d[C[F++]]^h[C[F++]]^f[C[F++]]^c[C[F++]]^l[C[F++]]^u[C[F++]]^o[C[F++]]^s[C[F++]]^i[C[F++]]^t[C[F++]];for(U+=15;F<U;)D=D>>>8^t[(D^C[F++])&255];return~D}function w(C,k){for(var D=k^-1,U=0,F=C.length,L=0,P=0;U<F;)L=C.charCodeAt(U++),L<128?D=D>>>8^t[(D^L)&255]:L<2048?(D=D>>>8^t[(D^(192|L>>6&31))&255],D=D>>>8^t[(D^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,P=C.charCodeAt(U++)&1023,D=D>>>8^t[(D^(240|L>>8&7))&255],D=D>>>8^t[(D^(128|L>>2&63))&255],D=D>>>8^t[(D^(128|P>>6&15|(L&3)<<4))&255],D=D>>>8^t[(D^(128|P&63))&255]):(D=D>>>8^t[(D^(224|L>>12&15))&255],D=D>>>8^t[(D^(128|L>>6&63))&255],D=D>>>8^t[(D^(128|L&63))&255]);return~D}return e.table=t,e.bstr=y,e.buf=_,e.str=w,e})(),gr=(function(){var r={};r.version="1.2.1";function t(R,q){for(var M=R.split("/"),j=q.split("/"),H=0,z=0,ne=Math.min(M.length,j.length);H<ne;++H){if(z=M[H].length-j[H].length)return z;if(M[H]!=j[H])return M[H]<j[H]?-1:1}return M.length-j.length}function n(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:n(R.slice(0,-1));var q=R.lastIndexOf("/");return q===-1?R:R.slice(0,q+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var q=R.lastIndexOf("/");return q===-1?R:R.slice(q+1)}function i(R,q){typeof q=="string"&&(q=new Date(q));var M=q.getHours();M=M<<6|q.getMinutes(),M=M<<5|q.getSeconds()>>>1,R.write_shift(2,M);var j=q.getFullYear()-1980;j=j<<4|q.getMonth()+1,j=j<<5|q.getDate(),R.write_shift(2,j)}function s(R){var q=R.read_shift(2)&65535,M=R.read_shift(2)&65535,j=new Date,H=M&31;M>>>=5;var z=M&15;M>>>=4,j.setMilliseconds(0),j.setFullYear(M+1980),j.setMonth(z-1),j.setDate(H);var ne=q&31;q>>>=5;var me=q&63;return q>>>=6,j.setHours(q),j.setMinutes(me),j.setSeconds(ne<<1),j}function o(R){Jt(R,0);for(var q={},M=0;R.l<=R.length-4;){var j=R.read_shift(2),H=R.read_shift(2),z=R.l+H,ne={};switch(j){case 21589:M=R.read_shift(1),M&1&&(ne.mtime=R.read_shift(4)),H>5&&(M&2&&(ne.atime=R.read_shift(4)),M&4&&(ne.ctime=R.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3));break}R.l=z,q[j]=ne}return q}var u;function l(){return u||(u={})}function c(R,q){if(R[0]==80&&R[1]==75)return _i(R,q);if((R[0]|32)==109&&(R[1]|32)==105)return P5(R,q);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var M=3,j=512,H=0,z=0,ne=0,me=0,te=0,ae=[],se=R.slice(0,512);Jt(se,0);var ye=f(se);switch(M=ye[0],M){case 3:j=512;break;case 4:j=4096;break;case 0:if(ye[1]==0)return _i(R,q);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}j!==512&&(se=R.slice(0,j),Jt(se,28));var De=R.slice(0,j);h(se,M);var Fe=se.read_shift(4,"i");if(M===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);se.l+=4,ne=se.read_shift(4,"i"),se.l+=4,se.chk("00100000","Mini Stream Cutoff Size: "),me=se.read_shift(4,"i"),H=se.read_shift(4,"i"),te=se.read_shift(4,"i"),z=se.read_shift(4,"i");for(var we=-1,Re=0;Re<109&&(we=se.read_shift(4,"i"),!(we<0));++Re)ae[Re]=we;var ze=d(R,j);x(te,z,ze,j,ae);var Ir=N(ze,ne,ae,j);Ir[ne].name="!Directory",H>0&&me!==P&&(Ir[me].name="!MiniFAT"),Ir[ae[0]].name="!FAT",Ir.fat_addrs=ae,Ir.ssz=j;var Pr={},Ct=[],Ao=[],ko=[];b(ne,Ir,ze,Ct,H,Pr,Ao,me),v(Ao,ko,Ct),Ct.shift();var Ro={FileIndex:Ao,FullPaths:ko};return q&&q.raw&&(Ro.raw={header:De,sectors:ze}),Ro}function f(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(B,"Header Signature: "),R.l+=16;var q=R.read_shift(2,"u");return[R.read_shift(2,"u"),q]}function h(R,q){var M=9;switch(R.l+=2,M=R.read_shift(2)){case 9:if(q!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(q!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function d(R,q){for(var M=Math.ceil(R.length/q)-1,j=[],H=1;H<M;++H)j[H-1]=R.slice(H*q,(H+1)*q);return j[M-1]=R.slice(M*q),j}function v(R,q,M){for(var j=0,H=0,z=0,ne=0,me=0,te=M.length,ae=[],se=[];j<te;++j)ae[j]=se[j]=j,q[j]=M[j];for(;me<se.length;++me)j=se[me],H=R[j].L,z=R[j].R,ne=R[j].C,ae[j]===j&&(H!==-1&&ae[H]!==H&&(ae[j]=ae[H]),z!==-1&&ae[z]!==z&&(ae[j]=ae[z])),ne!==-1&&(ae[ne]=j),H!==-1&&j!=ae[j]&&(ae[H]=ae[j],se.lastIndexOf(H)<me&&se.push(H)),z!==-1&&j!=ae[j]&&(ae[z]=ae[j],se.lastIndexOf(z)<me&&se.push(z));for(j=1;j<te;++j)ae[j]===j&&(z!==-1&&ae[z]!==z?ae[j]=ae[z]:H!==-1&&ae[H]!==H&&(ae[j]=ae[H]));for(j=1;j<te;++j)if(R[j].type!==0){if(me=j,me!=ae[me])do me=ae[me],q[j]=q[me]+"/"+q[j];while(me!==0&&ae[me]!==-1&&me!=ae[me]);ae[j]=-1}for(q[0]+="/",j=1;j<te;++j)R[j].type!==2&&(q[j]+="/")}function p(R,q,M){for(var j=R.start,H=R.size,z=[],ne=j;M&&H>0&&ne>=0;)z.push(q.slice(ne*L,ne*L+L)),H-=L,ne=Ui(M,ne*4);return z.length===0?ce(0):vt(z).slice(0,R.size)}function x(R,q,M,j,H){var z=P;if(R===P){if(q!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var ne=M[R],me=(j>>>2)-1;if(!ne)return;for(var te=0;te<me&&(z=Ui(ne,te*4))!==P;++te)H.push(z);x(Ui(ne,j-4),q-1,M,j,H)}}function g(R,q,M,j,H){var z=[],ne=[];H||(H=[]);var me=j-1,te=0,ae=0;for(te=q;te>=0;){H[te]=!0,z[z.length]=te,ne.push(R[te]);var se=M[Math.floor(te*4/j)];if(ae=te*4&me,j<4+ae)throw new Error("FAT boundary crossed: "+te+" 4 "+j);if(!R[se])break;te=Ui(R[se],ae)}return{nodes:z,data:G_([ne])}}function N(R,q,M,j){var H=R.length,z=[],ne=[],me=[],te=[],ae=j-1,se=0,ye=0,De=0,Fe=0;for(se=0;se<H;++se)if(me=[],De=se+q,De>=H&&(De-=H),!ne[De]){te=[];var we=[];for(ye=De;ye>=0;){we[ye]=!0,ne[ye]=!0,me[me.length]=ye,te.push(R[ye]);var Re=M[Math.floor(ye*4/j)];if(Fe=ye*4&ae,j<4+Fe)throw new Error("FAT boundary crossed: "+ye+" 4 "+j);if(!R[Re]||(ye=Ui(R[Re],Fe),we[ye]))break}z[De]={nodes:me,data:G_([te])}}return z}function b(R,q,M,j,H,z,ne,me){for(var te=0,ae=j.length?2:0,se=q[R].data,ye=0,De=0,Fe;ye<se.length;ye+=128){var we=se.slice(ye,ye+128);Jt(we,64),De=we.read_shift(2),Fe=Xb(we,0,De-ae),j.push(Fe);var Re={name:Fe,type:we.read_shift(1),color:we.read_shift(1),L:we.read_shift(4,"i"),R:we.read_shift(4,"i"),C:we.read_shift(4,"i"),clsid:we.read_shift(16),state:we.read_shift(4,"i"),start:0,size:0},ze=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);ze!==0&&(Re.ct=y(we,we.l-8));var Ir=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);Ir!==0&&(Re.mt=y(we,we.l-8)),Re.start=we.read_shift(4,"i"),Re.size=we.read_shift(4,"i"),Re.size<0&&Re.start<0&&(Re.size=Re.type=0,Re.start=P,Re.name=""),Re.type===5?(te=Re.start,H>0&&te!==P&&(q[te].name="!StreamData")):Re.size>=4096?(Re.storage="fat",q[Re.start]===void 0&&(q[Re.start]=g(M,Re.start,q.fat_addrs,q.ssz)),q[Re.start].name=Re.name,Re.content=q[Re.start].data.slice(0,Re.size)):(Re.storage="minifat",Re.size<0?Re.size=0:te!==P&&Re.start!==P&&q[te]&&(Re.content=p(Re,q[te].data,(q[me]||{}).data))),Re.content&&Jt(Re.content,0),z[Fe]=Re,ne.push(Re)}}function y(R,q){return new Date((tn(R,q+4)/1e7*Math.pow(2,32)+tn(R,q)/1e7-11644473600)*1e3)}function _(R,q){return l(),c(u.readFileSync(R),q)}function w(R,q){var M=q&&q.type;switch(M||cr&&Buffer.isBuffer(R)&&(M="buffer"),M||"base64"){case"file":return _(R,q);case"base64":return c(Fn(Ia(R)),q);case"binary":return c(Fn(R),q)}return c(R,q)}function C(R,q){var M=q||{},j=M.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=j+"/",R.FileIndex[0]={name:j,type:5}),M.CLSID&&(R.FileIndex[0].clsid=M.CLSID),k(R)}function k(R){var q="Sh33tJ5";if(!gr.find(R,"/"+q)){var M=ce(4);M[0]=55,M[1]=M[3]=50,M[2]=54,R.FileIndex.push({name:q,type:2,content:M,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+q),D(R)}}function D(R,q){C(R);for(var M=!1,j=!1,H=R.FullPaths.length-1;H>=0;--H){var z=R.FileIndex[H];switch(z.type){case 0:j?M=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(z.R*z.L*z.C)&&(M=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!q)){var ne=new Date(1987,1,19),me=0,te=Object.create?Object.create(null):{},ae=[];for(H=0;H<R.FullPaths.length;++H)te[R.FullPaths[H]]=!0,R.FileIndex[H].type!==0&&ae.push([R.FullPaths[H],R.FileIndex[H]]);for(H=0;H<ae.length;++H){var se=n(ae[H][0]);j=te[se],j||(ae.push([se,{name:a(se).replace("/",""),type:1,clsid:ue,ct:ne,mt:ne,content:null}]),te[se]=!0)}for(ae.sort(function(Fe,we){return t(Fe[0],we[0])}),R.FullPaths=[],R.FileIndex=[],H=0;H<ae.length;++H)R.FullPaths[H]=ae[H][0],R.FileIndex[H]=ae[H][1];for(H=0;H<ae.length;++H){var ye=R.FileIndex[H],De=R.FullPaths[H];if(ye.name=a(De).replace("/",""),ye.L=ye.R=ye.C=-(ye.color=1),ye.size=ye.content?ye.content.length:0,ye.start=0,ye.clsid=ye.clsid||ue,H===0)ye.C=ae.length>1?1:-1,ye.size=0,ye.type=5;else if(De.slice(-1)=="/"){for(me=H+1;me<ae.length&&n(R.FullPaths[me])!=De;++me);for(ye.C=me>=ae.length?-1:me,me=H+1;me<ae.length&&n(R.FullPaths[me])!=n(De);++me);ye.R=me>=ae.length?-1:me,ye.type=1}else n(R.FullPaths[H+1]||"")==n(De)&&(ye.R=H+1),ye.type=2}}}function U(R,q){var M=q||{};if(M.fileType=="mad")return V5(R,M);switch(D(R),M.fileType){case"zip":return yt(R,M)}var j=(function(Fe){for(var we=0,Re=0,ze=0;ze<Fe.FileIndex.length;++ze){var Ir=Fe.FileIndex[ze];if(Ir.content){var Pr=Ir.content.length;Pr>0&&(Pr<4096?we+=Pr+63>>6:Re+=Pr+511>>9)}}for(var Ct=Fe.FullPaths.length+3>>2,Ao=we+7>>3,ko=we+127>>7,Ro=Ao+Re+Ct+ko,Si=Ro+127>>7,Zf=Si<=109?0:Math.ceil((Si-109)/127);Ro+Si+Zf+127>>7>Si;)Zf=++Si<=109?0:Math.ceil((Si-109)/127);var ha=[1,Zf,Si,ko,Ct,Re,we,0];return Fe.FileIndex[0].size=we<<6,ha[7]=(Fe.FileIndex[0].start=ha[0]+ha[1]+ha[2]+ha[3]+ha[4]+ha[5])+(ha[6]+7>>3),ha})(R),H=ce(j[7]<<9),z=0,ne=0;{for(z=0;z<8;++z)H.write_shift(1,G[z]);for(z=0;z<8;++z)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),z=0;z<3;++z)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,j[2]),H.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:P),H.write_shift(4,j[3]),H.write_shift(-4,j[1]?j[0]-1:P),H.write_shift(4,j[1]),z=0;z<109;++z)H.write_shift(-4,z<j[2]?j[1]+z:-1)}if(j[1])for(ne=0;ne<j[1];++ne){for(;z<236+ne*127;++z)H.write_shift(-4,z<j[2]?j[1]+z:-1);H.write_shift(-4,ne===j[1]-1?P:ne+1)}var me=function(Fe){for(ne+=Fe;z<ne-1;++z)H.write_shift(-4,z+1);Fe&&(++z,H.write_shift(-4,P))};for(ne=z=0,ne+=j[1];z<ne;++z)H.write_shift(-4,oe.DIFSECT);for(ne+=j[2];z<ne;++z)H.write_shift(-4,oe.FATSECT);me(j[3]),me(j[4]);for(var te=0,ae=0,se=R.FileIndex[0];te<R.FileIndex.length;++te)se=R.FileIndex[te],se.content&&(ae=se.content.length,!(ae<4096)&&(se.start=ne,me(ae+511>>9)));for(me(j[6]+7>>3);H.l&511;)H.write_shift(-4,oe.ENDOFCHAIN);for(ne=z=0,te=0;te<R.FileIndex.length;++te)se=R.FileIndex[te],se.content&&(ae=se.content.length,!(!ae||ae>=4096)&&(se.start=ne,me(ae+63>>6)));for(;H.l&511;)H.write_shift(-4,oe.ENDOFCHAIN);for(z=0;z<j[4]<<2;++z){var ye=R.FullPaths[z];if(!ye||ye.length===0){for(te=0;te<17;++te)H.write_shift(4,0);for(te=0;te<3;++te)H.write_shift(4,-1);for(te=0;te<12;++te)H.write_shift(4,0);continue}se=R.FileIndex[z],z===0&&(se.start=se.size?se.start-1:P);var De=z===0&&M.root||se.name;if(ae=2*(De.length+1),H.write_shift(64,De,"utf16le"),H.write_shift(2,ae),H.write_shift(1,se.type),H.write_shift(1,se.color),H.write_shift(-4,se.L),H.write_shift(-4,se.R),H.write_shift(-4,se.C),se.clsid)H.write_shift(16,se.clsid,"hex");else for(te=0;te<4;++te)H.write_shift(4,0);H.write_shift(4,se.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,se.start),H.write_shift(4,se.size),H.write_shift(4,0)}for(z=1;z<R.FileIndex.length;++z)if(se=R.FileIndex[z],se.size>=4096)if(H.l=se.start+1<<9,cr&&Buffer.isBuffer(se.content))se.content.copy(H,H.l,0,se.size),H.l+=se.size+511&-512;else{for(te=0;te<se.size;++te)H.write_shift(1,se.content[te]);for(;te&511;++te)H.write_shift(1,0)}for(z=1;z<R.FileIndex.length;++z)if(se=R.FileIndex[z],se.size>0&&se.size<4096)if(cr&&Buffer.isBuffer(se.content))se.content.copy(H,H.l,0,se.size),H.l+=se.size+63&-64;else{for(te=0;te<se.size;++te)H.write_shift(1,se.content[te]);for(;te&63;++te)H.write_shift(1,0)}if(cr)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function F(R,q){var M=R.FullPaths.map(function(te){return te.toUpperCase()}),j=M.map(function(te){var ae=te.split("/");return ae[ae.length-(te.slice(-1)=="/"?2:1)]}),H=!1;q.charCodeAt(0)===47?(H=!0,q=M[0].slice(0,-1)+q):H=q.indexOf("/")!==-1;var z=q.toUpperCase(),ne=H===!0?M.indexOf(z):j.indexOf(z);if(ne!==-1)return R.FileIndex[ne];var me=!z.match(Fu);for(z=z.replace(tl,""),me&&(z=z.replace(Fu,"!")),ne=0;ne<M.length;++ne)if((me?M[ne].replace(Fu,"!"):M[ne]).replace(tl,"")==z||(me?j[ne].replace(Fu,"!"):j[ne]).replace(tl,"")==z)return R.FileIndex[ne];return null}var L=64,P=-2,B="d0cf11e0a1b11ae1",G=[208,207,17,224,161,177,26,225],ue="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:B,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ue,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function he(R,q,M){l();var j=U(R,M);u.writeFileSync(q,j)}function fe(R){for(var q=new Array(R.length),M=0;M<R.length;++M)q[M]=String.fromCharCode(R[M]);return q.join("")}function S(R,q){var M=U(R,q);switch(q&&q.type||"buffer"){case"file":return l(),u.writeFileSync(q.filename,M),M;case"binary":return typeof M=="string"?M:fe(M);case"base64":return Tl(typeof M=="string"?M:fe(M));case"buffer":if(cr)return Buffer.isBuffer(M)?M:Ha(M);case"array":return typeof M=="string"?Fn(M):M}return M}var re;function T(R){try{var q=R.InflateRaw,M=new q;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)re=R;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function E(R,q){if(!re)return ur(R,q);var M=re.InflateRaw,j=new M,H=j._processChunk(R.slice(R.l),j._finishFlushFlag);return R.l+=j.bytesRead,H}function V(R){return re?re.deflateRawSync(R):pe(R)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(R){var q=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(q>>16|q>>8|q)&255}for(var X=typeof Uint8Array<"u",Q=X?new Uint8Array(256):[],be=0;be<256;++be)Q[be]=le(be);function ee(R,q){var M=Q[R&255];return q<=8?M>>>8-q:(M=M<<8|Q[R>>8&255],q<=16?M>>>16-q:(M=M<<8|Q[R>>16&255],M>>>24-q))}function Ie(R,q){var M=q&7,j=q>>>3;return(R[j]|(M<=6?0:R[j+1]<<8))>>>M&3}function Te(R,q){var M=q&7,j=q>>>3;return(R[j]|(M<=5?0:R[j+1]<<8))>>>M&7}function Ye(R,q){var M=q&7,j=q>>>3;return(R[j]|(M<=4?0:R[j+1]<<8))>>>M&15}function Be(R,q){var M=q&7,j=q>>>3;return(R[j]|(M<=3?0:R[j+1]<<8))>>>M&31}function Ee(R,q){var M=q&7,j=q>>>3;return(R[j]|(M<=1?0:R[j+1]<<8))>>>M&127}function xr(R,q,M){var j=q&7,H=q>>>3,z=(1<<M)-1,ne=R[H]>>>j;return M<8-j||(ne|=R[H+1]<<8-j,M<16-j)||(ne|=R[H+2]<<16-j,M<24-j)||(ne|=R[H+3]<<24-j),ne&z}function Wr(R,q,M){var j=q&7,H=q>>>3;return j<=5?R[H]|=(M&7)<<j:(R[H]|=M<<j&255,R[H+1]=(M&7)>>8-j),q+3}function $r(R,q,M){var j=q&7,H=q>>>3;return M=(M&1)<<j,R[H]|=M,q+1}function Nr(R,q,M){var j=q&7,H=q>>>3;return M<<=j,R[H]|=M&255,M>>>=8,R[H+1]=M,q+8}function Tr(R,q,M){var j=q&7,H=q>>>3;return M<<=j,R[H]|=M&255,M>>>=8,R[H+1]=M&255,R[H+2]=M>>>8,q+16}function Yr(R,q){var M=R.length,j=2*M>q?2*M:q+5,H=0;if(M>=q)return R;if(cr){var z=R_(j);if(R.copy)R.copy(z);else for(;H<R.length;++H)z[H]=R[H];return z}else if(X){var ne=new Uint8Array(j);if(ne.set)ne.set(R);else for(;H<M;++H)ne[H]=R[H];return ne}return R.length=j,R}function Ne(R){for(var q=new Array(R),M=0;M<R;++M)q[M]=0;return q}function je(R,q,M){var j=1,H=0,z=0,ne=0,me=0,te=R.length,ae=X?new Uint16Array(32):Ne(32);for(z=0;z<32;++z)ae[z]=0;for(z=te;z<M;++z)R[z]=0;te=R.length;var se=X?new Uint16Array(te):Ne(te);for(z=0;z<te;++z)ae[H=R[z]]++,j<H&&(j=H),se[z]=0;for(ae[0]=0,z=1;z<=j;++z)ae[z+16]=me=me+ae[z-1]<<1;for(z=0;z<te;++z)me=R[z],me!=0&&(se[z]=ae[me+16]++);var ye=0;for(z=0;z<te;++z)if(ye=R[z],ye!=0)for(me=ee(se[z],j)>>j-ye,ne=(1<<j+4-ye)-1;ne>=0;--ne)q[me|ne<<ye]=ye&15|z<<4;return j}var Z=X?new Uint16Array(512):Ne(512),J=X?new Uint16Array(32):Ne(32);if(!X){for(var xe=0;xe<512;++xe)Z[xe]=0;for(xe=0;xe<32;++xe)J[xe]=0}(function(){for(var R=[],q=0;q<32;q++)R.push(5);je(R,J,32);var M=[];for(q=0;q<=143;q++)M.push(8);for(;q<=255;q++)M.push(9);for(;q<=279;q++)M.push(7);for(;q<=287;q++)M.push(8);je(M,Z,288)})();var Le=(function(){for(var q=X?new Uint8Array(32768):[],M=0,j=0;M<ie.length-1;++M)for(;j<ie[M+1];++j)q[j]=M;for(;j<32768;++j)q[j]=29;var H=X?new Uint8Array(259):[];for(M=0,j=0;M<Y.length-1;++M)for(;j<Y[M+1];++j)H[j]=M;function z(me,te){for(var ae=0;ae<me.length;){var se=Math.min(65535,me.length-ae),ye=ae+se==me.length;for(te.write_shift(1,+ye),te.write_shift(2,se),te.write_shift(2,~se&65535);se-- >0;)te[te.l++]=me[ae++]}return te.l}function ne(me,te){for(var ae=0,se=0,ye=X?new Uint16Array(32768):[];se<me.length;){var De=Math.min(65535,me.length-se);if(De<10){for(ae=Wr(te,ae,+(se+De==me.length)),ae&7&&(ae+=8-(ae&7)),te.l=ae/8|0,te.write_shift(2,De),te.write_shift(2,~De&65535);De-- >0;)te[te.l++]=me[se++];ae=te.l*8;continue}ae=Wr(te,ae,+(se+De==me.length)+2);for(var Fe=0;De-- >0;){var we=me[se];Fe=(Fe<<5^we)&32767;var Re=-1,ze=0;if((Re=ye[Fe])&&(Re|=se&-32768,Re>se&&(Re-=32768),Re<se))for(;me[Re+ze]==me[se+ze]&&ze<250;)++ze;if(ze>2){we=H[ze],we<=22?ae=Nr(te,ae,Q[we+1]>>1)-1:(Nr(te,ae,3),ae+=5,Nr(te,ae,Q[we-23]>>5),ae+=3);var Ir=we<8?0:we-4>>2;Ir>0&&(Tr(te,ae,ze-Y[we]),ae+=Ir),we=q[se-Re],ae=Nr(te,ae,Q[we]>>3),ae-=3;var Pr=we<4?0:we-2>>1;Pr>0&&(Tr(te,ae,se-Re-ie[we]),ae+=Pr);for(var Ct=0;Ct<ze;++Ct)ye[Fe]=se&32767,Fe=(Fe<<5^me[se])&32767,++se;De-=ze-1}else we<=143?we=we+48:ae=$r(te,ae,1),ae=Nr(te,ae,Q[we]),ye[Fe]=se&32767,++se}ae=Nr(te,ae,0)-1}return te.l=(ae+7)/8|0,te.l}return function(te,ae){return te.length<8?z(te,ae):ne(te,ae)}})();function pe(R){var q=ce(50+Math.floor(R.length*1.1)),M=Le(R,q);return q.slice(0,M)}var ke=X?new Uint16Array(32768):Ne(32768),Ve=X?new Uint16Array(32768):Ne(32768),Ke=X?new Uint16Array(128):Ne(128),ar=1,Er=1;function rr(R,q){var M=Be(R,q)+257;q+=5;var j=Be(R,q)+1;q+=5;var H=Ye(R,q)+4;q+=4;for(var z=0,ne=X?new Uint8Array(19):Ne(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,ae=X?new Uint8Array(8):Ne(8),se=X?new Uint8Array(8):Ne(8),ye=ne.length,De=0;De<H;++De)ne[I[De]]=z=Te(R,q),te<z&&(te=z),ae[z]++,q+=3;var Fe=0;for(ae[0]=0,De=1;De<=te;++De)se[De]=Fe=Fe+ae[De-1]<<1;for(De=0;De<ye;++De)(Fe=ne[De])!=0&&(me[De]=se[Fe]++);var we=0;for(De=0;De<ye;++De)if(we=ne[De],we!=0){Fe=Q[me[De]]>>8-we;for(var Re=(1<<7-we)-1;Re>=0;--Re)Ke[Fe|Re<<we]=we&7|De<<3}var ze=[];for(te=1;ze.length<M+j;)switch(Fe=Ke[Ee(R,q)],q+=Fe&7,Fe>>>=3){case 16:for(z=3+Ie(R,q),q+=2,Fe=ze[ze.length-1];z-- >0;)ze.push(Fe);break;case 17:for(z=3+Te(R,q),q+=3;z-- >0;)ze.push(0);break;case 18:for(z=11+Ee(R,q),q+=7;z-- >0;)ze.push(0);break;default:ze.push(Fe),te<Fe&&(te=Fe);break}var Ir=ze.slice(0,M),Pr=ze.slice(M);for(De=M;De<286;++De)Ir[De]=0;for(De=j;De<30;++De)Pr[De]=0;return ar=je(Ir,ke,286),Er=je(Pr,Ve,30),q}function nt(R,q){if(R[0]==3&&!(R[1]&3))return[rs(q),2];for(var M=0,j=0,H=R_(q||1<<18),z=0,ne=H.length>>>0,me=0,te=0;(j&1)==0;){if(j=Te(R,M),M+=3,j>>>1)j>>1==1?(me=9,te=5):(M=rr(R,M),me=ar,te=Er);else{M&7&&(M+=8-(M&7));var ae=R[M>>>3]|R[(M>>>3)+1]<<8;if(M+=32,ae>0)for(!q&&ne<z+ae&&(H=Yr(H,z+ae),ne=H.length);ae-- >0;)H[z++]=R[M>>>3],M+=8;continue}for(;;){!q&&ne<z+32767&&(H=Yr(H,z+32767),ne=H.length);var se=xr(R,M,me),ye=j>>>1==1?Z[se]:ke[se];if(M+=ye&15,ye>>>=4,(ye>>>8&255)===0)H[z++]=ye;else{if(ye==256)break;ye-=257;var De=ye<8?0:ye-4>>2;De>5&&(De=0);var Fe=z+Y[ye];De>0&&(Fe+=xr(R,M,De),M+=De),se=xr(R,M,te),ye=j>>>1==1?J[se]:Ve[se],M+=ye&15,ye>>>=4;var we=ye<4?0:ye-2>>1,Re=ie[ye];for(we>0&&(Re+=xr(R,M,we),M+=we),!q&&ne<Fe&&(H=Yr(H,Fe+100),ne=H.length);z<Fe;)H[z]=H[z-Re],++z}}}return q?[H,M+7>>>3]:[H.slice(0,z),M+7>>>3]}function ur(R,q){var M=R.slice(R.l||0),j=nt(M,q);return R.l+=j[1],j[0]}function un(R,q){if(R)typeof console<"u"&&console.error(q);else throw new Error(q)}function _i(R,q){var M=R;Jt(M,0);var j=[],H=[],z={FileIndex:j,FullPaths:H};C(z,{root:q.root});for(var ne=M.length-4;(M[ne]!=80||M[ne+1]!=75||M[ne+2]!=5||M[ne+3]!=6)&&ne>=0;)--ne;M.l=ne+4,M.l+=4;var me=M.read_shift(2);M.l+=6;var te=M.read_shift(4);for(M.l=te,ne=0;ne<me;++ne){M.l+=20;var ae=M.read_shift(4),se=M.read_shift(4),ye=M.read_shift(2),De=M.read_shift(2),Fe=M.read_shift(2);M.l+=8;var we=M.read_shift(4),Re=o(M.slice(M.l+ye,M.l+ye+De));M.l+=ye+De+Fe;var ze=M.l;M.l=we+4,Do(M,ae,se,z,Re),M.l=ze}return z}function Do(R,q,M,j,H){R.l+=2;var z=R.read_shift(2),ne=R.read_shift(2),me=s(R);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var te=R.read_shift(4),ae=R.read_shift(4),se=R.read_shift(4),ye=R.read_shift(2),De=R.read_shift(2),Fe="",we=0;we<ye;++we)Fe+=String.fromCharCode(R[R.l++]);if(De){var Re=o(R.slice(R.l,R.l+De));(Re[21589]||{}).mt&&(me=Re[21589].mt),((H||{})[21589]||{}).mt&&(me=H[21589].mt)}R.l+=De;var ze=R.slice(R.l,R.l+ae);switch(ne){case 8:ze=E(R,se);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var Ir=!1;z&8&&(te=R.read_shift(4),te==134695760&&(te=R.read_shift(4),Ir=!0),ae=R.read_shift(4),se=R.read_shift(4)),ae!=q&&un(Ir,"Bad compressed size: "+q+" != "+ae),se!=M&&un(Ir,"Bad uncompressed size: "+M+" != "+se),Qf(j,Fe,ze,{unsafe:!0,mt:me})}function yt(R,q){var M=q||{},j=[],H=[],z=ce(1),ne=M.compression?8:0,me=0,te=0,ae=0,se=0,ye=0,De=R.FullPaths[0],Fe=De,we=R.FileIndex[0],Re=[],ze=0;for(te=1;te<R.FullPaths.length;++te)if(Fe=R.FullPaths[te].slice(De.length),we=R.FileIndex[te],!(!we.size||!we.content||Fe=="Sh33tJ5")){var Ir=se,Pr=ce(Fe.length);for(ae=0;ae<Fe.length;++ae)Pr.write_shift(1,Fe.charCodeAt(ae)&127);Pr=Pr.slice(0,Pr.l),Re[ye]=az.buf(we.content,0);var Ct=we.content;ne==8&&(Ct=V(Ct)),z=ce(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,me),z.write_shift(2,ne),we.mt?i(z,we.mt):z.write_shift(4,0),z.write_shift(-4,Re[ye]),z.write_shift(4,Ct.length),z.write_shift(4,we.content.length),z.write_shift(2,Pr.length),z.write_shift(2,0),se+=z.length,j.push(z),se+=Pr.length,j.push(Pr),se+=Ct.length,j.push(Ct),z=ce(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,me),z.write_shift(2,ne),z.write_shift(4,0),z.write_shift(-4,Re[ye]),z.write_shift(4,Ct.length),z.write_shift(4,we.content.length),z.write_shift(2,Pr.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Ir),ze+=z.l,H.push(z),ze+=Pr.length,H.push(Pr),++ye}return z=ce(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,ye),z.write_shift(2,ye),z.write_shift(4,ze),z.write_shift(4,se),z.write_shift(2,0),vt([vt(j),vt(H),z])}var Nu={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function R5(R,q){if(R.ctype)return R.ctype;var M=R.name||"",j=M.match(/\.([^\.]+)$/);return j&&Nu[j[1]]||q&&(j=(M=q).match(/[\.\\]([^\.\\])+$/),j&&Nu[j[1]])?Nu[j[1]]:"application/octet-stream"}function O5(R){for(var q=Tl(R),M=[],j=0;j<q.length;j+=76)M.push(q.slice(j,j+76));return M.join(`\r
`)+`\r
`}function F5(R){var q=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ae){var se=ae.charCodeAt(0).toString(16).toUpperCase();return"="+(se.length==1?"0"+se:se)});q=q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),q.charAt(0)==`
`&&(q="=0D"+q.slice(1)),q=q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],j=q.split(`\r
`),H=0;H<j.length;++H){var z=j[H];if(z.length==0){M.push("");continue}for(var ne=0;ne<z.length;){var me=76,te=z.slice(ne,ne+me);te.charAt(me-1)=="="?me--:te.charAt(me-2)=="="?me-=2:te.charAt(me-3)=="="&&(me-=3),te=z.slice(ne,ne+me),ne+=me,ne<z.length&&(te+="="),M.push(te)}}return M.join(`\r
`)}function U5(R){for(var q=[],M=0;M<R.length;++M){for(var j=R[M];M<=R.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+R[++M];q.push(j)}for(var H=0;H<q.length;++H)q[H]=q[H].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return Fn(q.join(`\r
`))}function I5(R,q,M){for(var j="",H="",z="",ne,me=0;me<10;++me){var te=q[me];if(!te||te.match(/^\s*$/))break;var ae=te.match(/^(.*?):\s*([^\s].*)$/);if(ae)switch(ae[1].toLowerCase()){case"content-location":j=ae[2].trim();break;case"content-type":z=ae[2].trim();break;case"content-transfer-encoding":H=ae[2].trim();break}}switch(++me,H.toLowerCase()){case"base64":ne=Fn(Ia(q.slice(me).join("")));break;case"quoted-printable":ne=U5(q.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var se=Qf(R,j.slice(M.length),ne,{unsafe:!0});z&&(se.ctype=z)}function P5(R,q){if(fe(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=q&&q.root||"",j=(cr&&Buffer.isBuffer(R)?R.toString("binary"):fe(R)).split(`\r
`),H=0,z="";for(H=0;H<j.length;++H)if(z=j[H],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),M||(M=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),z.slice(0,M.length)!=M););var ne=(j[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var me="--"+(ne[1]||""),te=[],ae=[],se={FileIndex:te,FullPaths:ae};C(se);var ye,De=0;for(H=0;H<j.length;++H){var Fe=j[H];Fe!==me&&Fe!==me+"--"||(De++&&I5(se,j.slice(ye,H),M),ye=H)}return se}function V5(R,q){var M=q||{},j=M.boundary||"SheetJS";j="------="+j;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],z=R.FullPaths[0],ne=z,me=R.FileIndex[0],te=1;te<R.FullPaths.length;++te)if(ne=R.FullPaths[te].slice(z.length),me=R.FileIndex[te],!(!me.size||!me.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ze){return"_x"+ze.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ze){return"_u"+ze.charCodeAt(0).toString(16)+"_"});for(var ae=me.content,se=cr&&Buffer.isBuffer(ae)?ae.toString("binary"):fe(ae),ye=0,De=Math.min(1024,se.length),Fe=0,we=0;we<=De;++we)(Fe=se.charCodeAt(we))>=32&&Fe<128&&++ye;var Re=ye>=De*4/5;H.push(j),H.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+ne),H.push("Content-Transfer-Encoding: "+(Re?"quoted-printable":"base64")),H.push("Content-Type: "+R5(me,ne)),H.push(""),H.push(Re?F5(se):O5(se))}return H.push(j+`--\r
`),H.join(`\r
`)}function M5(R){var q={};return C(q,R),q}function Qf(R,q,M,j){var H=j&&j.unsafe;H||C(R);var z=!H&&gr.find(R,q);if(!z){var ne=R.FullPaths[0];q.slice(0,ne.length)==ne?ne=q:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+q).replace("//","/")),z={name:a(q),type:2},R.FileIndex.push(z),R.FullPaths.push(ne),H||gr.utils.cfb_gc(R)}return z.content=M,z.size=M?M.length:0,j&&(j.CLSID&&(z.clsid=j.CLSID),j.mt&&(z.mt=j.mt),j.ct&&(z.ct=j.ct)),z}function j5(R,q){C(R);var M=gr.find(R,q);if(M){for(var j=0;j<R.FileIndex.length;++j)if(R.FileIndex[j]==M)return R.FileIndex.splice(j,1),R.FullPaths.splice(j,1),!0}return!1}function L5(R,q,M){C(R);var j=gr.find(R,q);if(j){for(var H=0;H<R.FileIndex.length;++H)if(R.FileIndex[H]==j)return R.FileIndex[H].name=a(M),R.FullPaths[H]=M,!0}return!1}function B5(R){D(R,!0)}return r.find=F,r.read=w,r.parse=c,r.write=S,r.writeFile=he,r.utils={cfb_new:M5,cfb_add:Qf,cfb_del:j5,cfb_mov:L5,cfb_gc:B5,ReadShift:al,CheckField:IF,prep_blob:Jt,bconcat:vt,use_zlib:T,_deflateRaw:pe,_inflateRaw:ur,consts:oe},r})();function iz(e){return typeof e=="string"?Cf(e):Array.isArray(e)?RH(e):e}function eu(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=Cf(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?Al(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([iz(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(r)&&(r=Jl(r)),o.write(r),o.close(),r}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function bt(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function j_(e,r){for(var t=[],n=bt(e),a=0;a!==n.length;++a)t[e[n[a]][r]]==null&&(t[e[n[a]][r]]=n[a]);return t}function Gb(e){for(var r=[],t=bt(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function _f(e){for(var r=[],t=bt(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function sz(e){for(var r=[],t=bt(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var Fc=new Date(1899,11,30,0,0,0);function Ht(e,r){var t=e.getTime(),n=Fc.getTime()+(e.getTimezoneOffset()-Fc.getTimezoneOffset())*6e4;return(t-n)/(1440*60*1e3)}var gF=new Date,oz=Fc.getTime()+(gF.getTimezoneOffset()-Fc.getTimezoneOffset())*6e4,L_=gF.getTimezoneOffset();function bF(e){var r=new Date;return r.setTime(e*24*60*60*1e3+oz),r.getTimezoneOffset()!==L_&&r.setTime(r.getTime()+(r.getTimezoneOffset()-L_)*6e4),r}var B_=new Date("2017-02-19T19:06:09.000Z"),NF=isNaN(B_.getFullYear())?new Date("2/19/17"):B_,lz=NF.getFullYear()==2017;function It(e,r){var t=new Date(e);if(lz)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(NF.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Sf(e,r){if(cr&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var t={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(i){return t[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function zt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=zt(e[t]));return r}function Lr(e,r){for(var t="";t.length<r;)t+=e;return t}function Sa(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return t=-t,i}),!isNaN(r=Number(n)))?r/t:r}var uz=["january","february","march","april","may","june","july","august","september","october","november","december"];function Dl(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),i=r.getDate();if(isNaN(i))return t;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&uz.indexOf(s)==-1)return t}else if(s.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||i>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}function Je(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return cr?n=Ha(t):n=OH(t),gr.utils.cfb_add(e,r,n)}gr.utils.cfb_add(e,r,t)}else e.file(r,t)}function Wb(){return gr.utils.cfb_new()}var tt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,cz={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Yb=Gb(cz),Kb=/[&<>'"]/g,fz=/[\u0000-\u0008\u000b-\u001f]/g;function pr(e){var r=e+"";return r.replace(Kb,function(t){return Yb[t]}).replace(fz,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function q_(e){return pr(e).replace(/ /g,"_x0020_")}var yF=/[\u0000-\u001f]/g;function mz(e){var r=e+"";return r.replace(Kb,function(t){return Yb[t]}).replace(/\n/g,"<br/>").replace(yF,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function dz(e){var r=e+"";return r.replace(Kb,function(t){return Yb[t]}).replace(yF,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function hz(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function pz(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function op(e){for(var r="",t=0,n=0,a=0,i=0,s=0,o=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){s=(n&31)<<6,s|=a&63,r+=String.fromCharCode(s);continue}if(i=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(t++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function H_(e){var r=rs(2*e.length),t,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(t=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,s=55296+(t>>>10&1023),t=56320+(t&1023)),s!==0&&(r[i++]=s&255,r[i++]=s>>>8,s=0),r[i++]=t%256,r[i++]=t>>>8;return r.slice(0,i).toString("ucs2")}function z_(e){return Ha(e,"binary").toString("utf8")}var Iu="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",nl=cr&&(z_(Iu)==op(Iu)&&z_||H_(Iu)==op(Iu)&&H_)||op,Al=cr?function(e){return Ha(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},vz=(function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),CF=/(^\s|\s$|\n)/;function xt(e,r){return"<"+e+(r.match(CF)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function kl(e){return bt(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function _e(e,r,t){return"<"+e+(t!=null?kl(t):"")+(r!=null?(r.match(CF)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Jg(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function xz(e,r){switch(typeof e){case"string":var t=_e("vt:lpwstr",pr(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return _e((e|0)==e?"vt:i4":"vt:r8",pr(String(e)));case"boolean":return _e("vt:bool",e?"true":"false")}if(e instanceof Date)return _e("vt:filetime",Jg(e));throw new Error("Unable to serialize "+e)}var ut={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},xo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],rn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function gz(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,i=5;i>=0;--i)a=a*256+e[r+i];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function bz(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,i=0,s=n?-r:r;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(r)?26985:0);for(var o=0;o<=5;++o,i/=256)e[t+o]=i&255;e[t+6]=(a&15)<<4|i&15,e[t+7]=a>>4|n}var $_=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},G_=cr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Ha(r)})):$_(e)}:$_,W_=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(Zo(e,a)));return n.join("").replace(tl,"")},Xb=cr?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(tl,""):W_(e,r,t)}:W_,Y_=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},EF=cr?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Y_(e,r,t)}:Y_,K_=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(Rs(e,a)));return n.join("")},ru=cr?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):K_(r,t,n)}:K_,wF=function(e,r){var t=tn(e,r);return t>0?ru(e,r+4,r+4+t-1):""},_F=wF,SF=function(e,r){var t=tn(e,r);return t>0?ru(e,r+4,r+4+t-1):""},TF=SF,DF=function(e,r){var t=2*tn(e,r);return t>0?ru(e,r+4,r+4+t-1):""},AF=DF,kF=function(r,t){var n=tn(r,t);return n>0?Xb(r,t+4,t+4+n):""},RF=kF,OF=function(e,r){var t=tn(e,r);return t>0?ru(e,r+4,r+4+t):""},FF=OF,UF=function(e,r){return gz(e,r)},Uc=UF,Qb=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};cr&&(_F=function(r,t){if(!Buffer.isBuffer(r))return wF(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},TF=function(r,t){if(!Buffer.isBuffer(r))return SF(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},AF=function(r,t){if(!Buffer.isBuffer(r))return DF(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},RF=function(r,t){if(!Buffer.isBuffer(r))return kF(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},FF=function(r,t){if(!Buffer.isBuffer(r))return OF(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},Uc=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):UF(r,t)},Qb=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Rs=function(e,r){return e[r]},Zo=function(e,r){return e[r+1]*256+e[r]},Nz=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},tn=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Ui=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},yz=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function al(e,r){var t="",n,a,i=[],s,o,u,l;switch(r){case"dbcs":if(l=this.l,cr&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)t+=String.fromCharCode(Zo(this,l)),l+=2;e*=2;break;case"utf8":t=ru(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Xb(this,this.l,this.l+e);break;case"wstr":return al.call(this,e,"dbcs");case"lpstr-ansi":t=_F(this,this.l),e=4+tn(this,this.l);break;case"lpstr-cp":t=TF(this,this.l),e=4+tn(this,this.l);break;case"lpwstr":t=AF(this,this.l),e=4+2*tn(this,this.l);break;case"lpp4":e=4+tn(this,this.l),t=RF(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+tn(this,this.l),t=FF(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(s=Rs(this,this.l+e++))!==0;)i.push(Ou(s));t=i.join("");break;case"_wstr":for(e=0,t="";(s=Zo(this,this.l+e))!==0;)i.push(Ou(s)),e+=2;e+=2,t=i.join("");break;case"dbcs-cont":for(t="",l=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(l)!==-1)return s=Rs(this,l),this.l=l+1,o=al.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Ou(Zo(this,l))),l+=2}t=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",l=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(l)!==-1)return s=Rs(this,l),this.l=l+1,o=al.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Ou(Rs(this,l))),l+=1}t=i.join("");break;default:switch(e){case 1:return n=Rs(this,this.l),this.l++,n;case 2:return n=(r==="i"?Nz:Zo)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?Ui:yz)(this,this.l),this.l+=4,n):(a=tn(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=Uc(this,this.l):a=Uc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=EF(this,this.l,e);break}}return this.l+=e,t}var Cz=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Ez=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},wz=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function _z(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)wz(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var s=r.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,Cz(this,r,this.l);break;case 8:if(n=8,t==="f"){bz(this,r,this.l);break}case 16:break;case-4:n=4,Ez(this,r,this.l);break}return this.l+=n,this}function IF(e,r){var t=EF(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Jt(e,r){e.l=r,e.read_shift=al,e.chk=IF,e.write_shift=_z}function oa(e,r){e.l+=r}function ce(e){var r=rs(e);return Jt(r,0),r}function Lt(){var e=[],r=cr?256:2048,t=function(l){var c=ce(l);return Jt(c,0),c},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(l){return n&&l<n.length-n.l?n:(a(),n=t(Math.max(l+1,r)))},s=function(){return a(),vt(e)},o=function(l){a(),n=l,n.l==null&&(n.l=n.length),i(r)};return{next:i,push:o,end:s,_bufs:e}}function ve(e,r,t,n){var a=+r,i;if(!isNaN(a)){n||(n=gX[a].p||(t||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Qb(t)&&e.push(t)}}function il(e,r,t){var n=zt(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function X_(e,r,t){var n=zt(e);return n.s=il(n.s,r.s,t),n.e=il(n.e,r.s,t),n}function sl(e,r){if(e.cRel&&e.c<0)for(e=zt(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=zt(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=vr(e);return!e.cRel&&e.cRel!=null&&(t=Dz(t)),!e.rRel&&e.rRel!=null&&(t=Sz(t)),t}function lp(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+St(e.s.c)+":"+(e.e.cRel?"":"$")+St(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+gt(e.s.r)+":"+(e.e.rRel?"":"$")+gt(e.e.r):sl(e.s,r.biff)+":"+sl(e.e,r.biff)}function Zb(e){return parseInt(Tz(e),10)-1}function gt(e){return""+(e+1)}function Sz(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Tz(e){return e.replace(/\$(\d+)$/,"$1")}function Jb(e){for(var r=Az(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function St(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Dz(e){return e.replace(/^([A-Z])/,"$$$1")}function Az(e){return e.replace(/^\$([A-Z])/,"$1")}function kz(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ct(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function vr(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function ln(e){var r=e.indexOf(":");return r==-1?{s:ct(e),e:ct(e)}:{s:ct(e.slice(0,r)),e:ct(e.slice(r+1))}}function rt(e,r){return typeof r>"u"||typeof r=="number"?rt(e.s,e.e):(typeof e!="string"&&(e=vr(e)),typeof r!="string"&&(r=vr(r)),e==r?e:e+":"+r)}function kr(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,i=e.length;for(t=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===i||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function Q_(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=ci(e.z,t?Ht(r):r)}catch{}try{return e.w=ci((e.XF||{}).numFmtId||(t?14:0),t?Ht(r):r)}catch{return""+r}}function Pa(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?tu[e.v]||e.v:r==null?Q_(e,e.v):Q_(e,r))}function ms(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function PF(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?ct(n.origin):n.origin;s=u.r,o=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var c=kr(i["!ref"]);l.s.c=c.s.c,l.s.r=c.s.r,l.e.c=Math.max(l.e.c,c.e.c),l.e.r=Math.max(l.e.r,c.e.r),s==-1&&(l.e.r=s=c.e.r+1)}for(var f=0;f!=r.length;++f)if(r[f]){if(!Array.isArray(r[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=r[f].length;++h)if(!(typeof r[f][h]>"u")){var d={v:r[f][h]},v=s+f,p=o+h;if(l.s.r>v&&(l.s.r=v),l.s.c>p&&(l.s.c=p),l.e.r<v&&(l.e.r=v),l.e.c<p&&(l.e.c=p),r[f][h]&&typeof r[f][h]=="object"&&!Array.isArray(r[f][h])&&!(r[f][h]instanceof Date))d=r[f][h];else if(Array.isArray(d.v)&&(d.f=r[f][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||qr[14],n.cellDates?(d.t="d",d.w=ci(d.z,Ht(d.v))):(d.t="n",d.v=Ht(d.v),d.w=ci(d.z,d.v))):d.t="s";if(a)i[v]||(i[v]=[]),i[v][p]&&i[v][p].z&&(d.z=i[v][p].z),i[v][p]=d;else{var x=vr({c:p,r:v});i[x]&&i[x].z&&(d.z=i[x].z),i[x]=d}}}return l.s.c<1e7&&(i["!ref"]=rt(l)),i}function go(e,r){return PF(null,e,r)}function Rz(e){return e.read_shift(4,"i")}function Vn(e,r){return r||(r=ce(4)),r.write_shift(4,e),r}function Tt(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function ft(e,r){var t=!1;return r==null&&(t=!0,r=ce(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function Oz(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Fz(e,r){return r||(r=ce(4)),r.write_shift(2,0),r.write_shift(2,0),r}function eN(e,r){var t=e.l,n=e.read_shift(1),a=Tt(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var o=e.read_shift(4),u=0;u!=o;++u)i.push(Oz(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=t+r,s}function Uz(e,r){var t=!1;return r==null&&(t=!0,r=ce(15+4*e.t.length)),r.write_shift(1,0),ft(e.t,r),t?r.slice(0,r.l):r}var Iz=eN;function Pz(e,r){var t=!1;return r==null&&(t=!0,r=ce(23+4*e.t.length)),r.write_shift(1,1),ft(e.t,r),r.write_shift(4,1),Fz({},r),t?r.slice(0,r.l):r}function Cn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function ds(e,r){return r==null&&(r=ce(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function hs(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function ps(e,r){return r==null&&(r=ce(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var Vz=Tt,VF=ft;function rN(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function Ic(e,r){var t=!1;return r==null&&(t=!0,r=ce(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var Mz=Tt,e1=rN,tN=Ic;function MF(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?Uc([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Ui(r,0)>>2;return t?a/100:a}function jF(e,r){r==null&&(r=ce(4));var t=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?a:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function LF(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function jz(e,r){return r||(r=ce(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var vs=LF,bo=jz;function No(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ts(e,r){return(r||ce(8)).write_shift(8,e,"f")}function Lz(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var l=Kz[a];l&&(r.rgb=lS(l));break;case 2:r.rgb=lS([s,o,u]);break;case 3:r.theme=a;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function Pc(e,r){if(r||(r=ce(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function Bz(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function qz(e,r){r||(r=ce(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}var BF=2,Qt=3,Pu=11,Vc=19,Vu=64,Hz=65,zz=71,$z=4108,Gz=4126,pt=80,Z_={1:{n:"CodePage",t:BF},2:{n:"Category",t:pt},3:{n:"PresentationFormat",t:pt},4:{n:"ByteCount",t:Qt},5:{n:"LineCount",t:Qt},6:{n:"ParagraphCount",t:Qt},7:{n:"SlideCount",t:Qt},8:{n:"NoteCount",t:Qt},9:{n:"HiddenCount",t:Qt},10:{n:"MultimediaClipCount",t:Qt},11:{n:"ScaleCrop",t:Pu},12:{n:"HeadingPairs",t:$z},13:{n:"TitlesOfParts",t:Gz},14:{n:"Manager",t:pt},15:{n:"Company",t:pt},16:{n:"LinksUpToDate",t:Pu},17:{n:"CharacterCount",t:Qt},19:{n:"SharedDoc",t:Pu},22:{n:"HyperlinksChanged",t:Pu},23:{n:"AppVersion",t:Qt,p:"version"},24:{n:"DigSig",t:Hz},26:{n:"ContentType",t:pt},27:{n:"ContentStatus",t:pt},28:{n:"Language",t:pt},29:{n:"Version",t:pt},255:{},2147483648:{n:"Locale",t:Vc},2147483651:{n:"Behavior",t:Vc},1919054434:{}},J_={1:{n:"CodePage",t:BF},2:{n:"Title",t:pt},3:{n:"Subject",t:pt},4:{n:"Author",t:pt},5:{n:"Keywords",t:pt},6:{n:"Comments",t:pt},7:{n:"Template",t:pt},8:{n:"LastAuthor",t:pt},9:{n:"RevNumber",t:pt},10:{n:"EditTime",t:Vu},11:{n:"LastPrinted",t:Vu},12:{n:"CreatedDate",t:Vu},13:{n:"ModifiedDate",t:Vu},14:{n:"PageCount",t:Qt},15:{n:"WordCount",t:Qt},16:{n:"CharCount",t:Qt},17:{n:"Thumbnail",t:zz},18:{n:"Application",t:pt},19:{n:"DocSecurity",t:Qt},255:{},2147483648:{n:"Locale",t:Vc},2147483651:{n:"Behavior",t:Vc},1919054434:{}};function Wz(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Yz=Wz([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Kz=zt(Yz),tu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Xz={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Mu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function qF(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function HF(e,r){var t=sz(Xz),n=[],a;n[n.length]=tt,n[n.length]=_e("Types",null,{xmlns:ut.CT,"xmlns:xsd":ut.xsd,"xmlns:xsi":ut.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return _e("Default",null,{Extension:u[0],ContentType:u[1]})}));var i=function(u){e[u]&&e[u].length>0&&(a=e[u][0],n[n.length]=_e("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Mu[u][r.bookType]||Mu[u].xlsx}))},s=function(u){(e[u]||[]).forEach(function(l){n[n.length]=_e("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:Mu[u][r.bookType]||Mu[u].xlsx})})},o=function(u){(e[u]||[]).forEach(function(l){n[n.length]=_e("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:t[u][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var sr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zF(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Hs(e){var r=[tt,_e("Relationships",null,{xmlns:ut.RELS})];return bt(e["!id"]).forEach(function(t){r[r.length]=_e("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function hr(e,r,t,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,a.Id="rId"+r,a.Type=n,a.Target=t,[sr.HLINK,sr.XPATH,sr.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,r}function Qz(e){var r=[tt];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function eS(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function Zz(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function Jz(e){var r=[tt];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(eS(e[t][0],e[t][1])),r.push(Zz("",e[t][0]));return r.push(eS("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function $F(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Dc.version+"</meta:generator></office:meta></office:document-meta>"}var Ki=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function up(e,r,t,n,a){a[e]!=null||r==null||r===""||(a[e]=r,r=pr(r),n[n.length]=t?_e(e,r,t):xt(e,r))}function GF(e,r){var t=r||{},n=[tt,_e("cp:coreProperties",null,{"xmlns:cp":ut.CORE_PROPS,"xmlns:dc":ut.dc,"xmlns:dcterms":ut.dcterms,"xmlns:dcmitype":ut.dcmitype,"xmlns:xsi":ut.xsi})],a={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&up("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Jg(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&up("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Jg(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Ki.length;++i){var s=Ki[i],o=t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&up(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var zs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],WF=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function YF(e){var r=[],t=_e;return e||(e={}),e.Application="SheetJS",r[r.length]=tt,r[r.length]=_e("Properties",null,{xmlns:ut.EXT_PROPS,"xmlns:vt":ut.vt}),zs.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=pr(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(r[r.length]=t(n[0],a))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+pr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function KF(e){var r=[tt,_e("Properties",null,{xmlns:ut.CUST_PROPS,"xmlns:vt":ut.vt})];if(!e)return r.join("");var t=1;return bt(e).forEach(function(a){++t,r[r.length]=_e("property",xz(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:pr(a)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var rS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function e$(e,r){var t=[];return bt(rS).map(function(n){for(var a=0;a<Ki.length;++a)if(Ki[a][1]==n)return Ki[a];for(a=0;a<zs.length;++a)if(zs[a][1]==n)return zs[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),t.push(xt(rS[n[1]]||n[1],a))}}),_e("DocumentProperties",t.join(""),{xmlns:rn.o})}function r$(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&bt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Ki.length;++s)if(i==Ki[s][1])return;for(s=0;s<zs.length;++s)if(i==zs[s][1])return;for(s=0;s<t.length;++s)if(i==t[s])return;var o=e[i],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o=String(o),a.push(_e(q_(i),o,{"dt:dt":u}))}}),r&&bt(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=r[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(_e(q_(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+rn.o+'">'+a.join("")+"</"+n+">"}function t$(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),a=(t-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=ce(8);return s.write_shift(4,n),s.write_shift(4,a),s}function tS(e,r){var t=ce(4),n=ce(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=ce(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=t$(r);break;case 31:case 80:for(n=ce(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return vt([t,n])}var XF=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function n$(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function nS(e,r,t){var n=ce(8),a=[],i=[],s=8,o=0,u=ce(8),l=ce(8);if(u.write_shift(4,2),u.write_shift(4,1200),l.write_shift(4,1),i.push(u),a.push(l),s+=8+u.length,!r){l=ce(8),l.write_shift(4,0),a.unshift(l);var c=[ce(4)];for(c[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(u=ce(8+2*(f.length+1)+(f.length%2?0:2)),u.write_shift(4,o+2),u.write_shift(4,f.length+1),u.write_shift(0,f,"dbcs");u.l!=u.length;)u.write_shift(1,0);c.push(u)}u=vt(c),i.unshift(u),s+=8+u.length}for(o=0;o<e.length;++o)if(!(r&&!r[e[o][0]])&&!(XF.indexOf(e[o][0])>-1||WF.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],d=0;if(r){d=+r[e[o][0]];var v=t[d];if(v.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}u=tS(v.t,h)}else{var x=n$(h);x==-1&&(x=31,h=String(h)),u=tS(x,h)}i.push(u),l=ce(8),l.write_shift(4,r?d:2+o),a.push(l),s+=8+u.length}var g=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,g),g+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),vt([n].concat(a).concat(i))}function aS(e,r,t,n,a,i){var s=ce(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,gr.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,r,"hex"),s.write_shift(4,a?68:48);var u=nS(e,t,n);if(o.push(u),a){var l=nS(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+u.length),o.push(l)}return vt(o)}function a$(e,r){r||(r=ce(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function i$(e,r){return e.read_shift(r)===1}function Rt(e,r){return r||(r=ce(2)),r.write_shift(2,+!!e),r}function QF(e){return e.read_shift(2,"u")}function hn(e,r){return r||(r=ce(2)),r.write_shift(2,e),r}function ZF(e,r,t){return t||(t=ce(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function JF(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function s$(e){var r=e.t||"",t=ce(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=ce(2*r.length);n.write_shift(2*r.length,r,"utf16le");var a=[t,n];return vt(a)}function o$(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function l$(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):o$(e,n,t)}function u$(e,r,t){if(t.biff>5)return l$(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function eU(e,r,t){return t||(t=ce(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function iS(e,r){r||(r=ce(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function c$(e){var r=ce(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}r.write_shift(4,2),r.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(t=0;t<s.length;++t)r.write_shift(4,s[t]);if(i==28)n=n.slice(1),iS(n,r);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<s.length;++t)r.write_shift(1,parseInt(s[t],16));var o=a>-1?n.slice(0,a):n;for(r.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)r.write_shift(2,o.charCodeAt(t));r.write_shift(2,0),i&8&&iS(a>-1?n.slice(a+1):"",r)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<s.length;++t)r.write_shift(1,parseInt(s[t],16));for(var u=0;n.slice(u*3,u*3+3)=="../"||n.slice(u*3,u*3+3)=="..\\";)++u;for(r.write_shift(2,u),r.write_shift(4,n.length-3*u+1),t=0;t<n.length-3*u;++t)r.write_shift(1,n.charCodeAt(t+3*u)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function ns(e,r,t,n){return n||(n=ce(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function f$(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function m$(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function rU(e,r){return r||(r=ce(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function nN(e,r,t){var n=1536,a=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ce(a);return i.write_shift(2,n),i.write_shift(2,r),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function d$(e,r){var t=!r||r.biff==8,n=ce(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function h$(e,r){var t=!r||r.biff>=8?2:1,n=ce(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function p$(e,r){var t=ce(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=s$(e[a]);var i=vt([t].concat(n));return i.parts=[t.length].concat(n.map(function(s){return s.length})),i}function v$(){var e=ce(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function x$(e){var r=ce(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function g$(e,r){var t=e.name||"Arial",n=r&&r.biff==5,a=n?15+t.length:16+2*t.length,i=ce(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,t.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),i}function b$(e,r,t,n){var a=ce(10);return ns(e,r,n,a),a.write_shift(4,t),a}function N$(e,r,t,n,a){var i=!a||a.biff==8,s=ce(8+ +i+(1+i)*t.length);return ns(e,r,n,s),s.write_shift(2,t.length),i&&s.write_shift(1,1),s.write_shift((1+i)*t.length,t,i?"utf16le":"sbcs"),s}function y$(e,r,t,n){var a=t&&t.biff==5;n||(n=ce(a?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(a?1:2,r.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function C$(e,r){var t=r.biff==8||!r.biff?4:2,n=ce(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function sS(e,r,t,n){var a=t&&t.biff==5;n||(n=ce(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function E$(e){var r=ce(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function w$(e,r,t,n,a,i){var s=ce(8);return ns(e,r,n,s),ZF(t,i,s),s}function _$(e,r,t,n){var a=ce(14);return ns(e,r,n,a),ts(t,a),a}function S$(e,r,t){if(t.biff<8)return T$(e,r,t);for(var n=[],a=e.l+r,i=e.read_shift(t.biff>8?4:2);i--!==0;)n.push(f$(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function T$(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=JF(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function D$(e){var r=ce(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)rU(e[t],r);return r}function A$(e){var r=ce(24),t=ct(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)r.write_shift(1,parseInt(n[a],16));return vt([r,c$(e[1])])}function k$(e){var r=e[1].Tooltip,t=ce(10+2*(r.length+1));t.write_shift(2,2048);var n=ct(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var a=0;a<r.length;++a)t.write_shift(2,r.charCodeAt(a));return t.write_shift(2,0),t}function R$(e){return e||(e=ce(4)),e.write_shift(2,1),e.write_shift(2,1),e}function O$(e,r,t){if(!t.cellStyles)return oa(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var l={s:a,e:i,w:s,ixfe:o,flags:u};return(t.biff>=5||!t.biff)&&(l.level=u>>8&7),l}function F$(e,r){var t=ce(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function U$(e){for(var r=ce(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}function I$(e,r,t){var n=ce(15);return au(n,e,r),n.write_shift(8,t,"f"),n}function P$(e,r,t){var n=ce(9);return au(n,e,r),n.write_shift(2,t),n}var V$=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Gb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,u){var l=[],c=rs(1);switch(u.type){case"base64":c=Fn(Ia(o));break;case"binary":c=Fn(o);break;case"buffer":case"array":c=o;break}Jt(c,0);var f=c.read_shift(1),h=!!(f&136),d=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,x=521;f==2&&(p=c.read_shift(2)),c.l+=3,f!=2&&(p=c.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(x=c.read_shift(2));var g=c.read_shift(2),N=u.codepage||1252;f!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(N=e[c[c.l]]),c.l+=1,c.l+=2),v&&(c.l+=36);for(var b=[],y={},_=Math.min(c.length,f==2?521:x-10-(d?264:0)),w=v?32:11;c.l<_&&c[c.l]!=13;)switch(y={},y.name=Ac.utils.decode(N,c.slice(c.l,c.l+w)).replace(/[\u0000\r\n].*$/g,""),c.l+=w,y.type=String.fromCharCode(c.read_shift(1)),f!=2&&!v&&(y.offset=c.read_shift(4)),y.len=c.read_shift(1),f==2&&(y.offset=c.read_shift(2)),y.dec=c.read_shift(1),y.name.length&&b.push(y),f!=2&&(c.l+=v?13:14),y.type){case"B":(!d||y.len!=8)&&u.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+y.type)}if(c[c.l]!==13&&(c.l=x-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=x;var C=0,k=0;for(l[0]=[],k=0;k!=b.length;++k)l[0][k]=b[k].name;for(;p-- >0;){if(c[c.l]===42){c.l+=g;continue}for(++c.l,l[++C]=[],k=0,k=0;k!=b.length;++k){var D=c.slice(c.l,c.l+b[k].len);c.l+=b[k].len,Jt(D,0);var U=Ac.utils.decode(N,D);switch(b[k].type){case"C":U.trim().length&&(l[C][k]=U.replace(/\s+$/,""));break;case"D":U.length===8?l[C][k]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):l[C][k]=U;break;case"F":l[C][k]=parseFloat(U.trim());break;case"+":case"I":l[C][k]=v?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":l[C][k]=!0;break;case"N":case"F":l[C][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));l[C][k]="##MEMO##"+(v?parseInt(U.trim(),10):D.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(l[C][k]=+U||0);break;case"@":l[C][k]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":l[C][k]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":l[C][k]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[C][k]=-D.read_shift(-8,"f");break;case"B":if(d&&b[k].len==8){l[C][k]=D.read_shift(8,"f");break}case"G":case"P":D.l+=b[k].len;break;case"0":if(b[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[k].type)}}}if(f!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return u&&u.sheetRows&&(l=l.slice(0,u.sheetRows)),u.DBF=b,l}function n(o,u){var l=u||{};l.dateNF||(l.dateNF="yyyymmdd");var c=go(t(o,l),l);return c["!cols"]=l.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete l.DBF,c}function a(o,u){try{return ms(n(o,u),u)}catch(l){if(u&&u.WTF)throw l}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,u){var l=u||{};if(+l.codepage>=0&&Sl(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var c=Lt(),f=qc(o,{header:1,raw:!0,cellDates:!0}),h=f[0],d=f.slice(1),v=o["!cols"]||[],p=0,x=0,g=0,N=1;for(p=0;p<h.length;++p){if(((v[p]||{}).DBF||{}).name){h[p]=v[p].DBF.name,++g;continue}if(h[p]!=null){if(++g,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(x=0;x<1024;++x)if(h.indexOf(h[p]+"_"+x)==-1){h[p]+="_"+x;break}}}}var b=kr(o["!ref"]),y=[],_=[],w=[];for(p=0;p<=b.e.c-b.s.c;++p){var C="",k="",D=0,U=[];for(x=0;x<d.length;++x)d[x][p]!=null&&U.push(d[x][p]);if(U.length==0||h[p]==null){y[p]="?";continue}for(x=0;x<U.length;++x){switch(typeof U[x]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=U[x]instanceof Date?"D":"C";break;default:k="C"}D=Math.max(D,String(U[x]).length),C=C&&C!=k?"C":k}D>250&&(D=250),k=((v[p]||{}).DBF||{}).type,k=="C"&&v[p].DBF.len>D&&(D=v[p].DBF.len),C=="B"&&k=="N"&&(C="N",w[p]=v[p].DBF.dec,D=v[p].DBF.len),_[p]=C=="C"||k=="N"?D:i[C]||0,N+=_[p],y[p]=C}var F=c.next(32);for(F.write_shift(4,318902576),F.write_shift(4,d.length),F.write_shift(2,296+32*g),F.write_shift(2,N),p=0;p<4;++p)F.write_shift(4,0);for(F.write_shift(4,0|(+r[nF]||3)<<8),p=0,x=0;p<h.length;++p)if(h[p]!=null){var L=c.next(32),P=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,P,"sbcs"),L.write_shift(1,y[p]=="?"?"C":y[p],"sbcs"),L.write_shift(4,x),L.write_shift(1,_[p]||i[y[p]]||0),L.write_shift(1,w[p]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),x+=_[p]||i[y[p]]||0}var B=c.next(264);for(B.write_shift(4,13),p=0;p<65;++p)B.write_shift(4,0);for(p=0;p<d.length;++p){var G=c.next(N);for(G.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(y[x]){case"L":G.write_shift(1,d[p][x]==null?63:d[p][x]?84:70);break;case"B":G.write_shift(8,d[p][x]||0,"f");break;case"N":var ue="0";for(typeof d[p][x]=="number"&&(ue=d[p][x].toFixed(w[x]||0)),g=0;g<_[x]-ue.length;++g)G.write_shift(1,32);G.write_shift(1,ue,"sbcs");break;case"D":d[p][x]?(G.write_shift(4,("0000"+d[p][x].getFullYear()).slice(-4),"sbcs"),G.write_shift(2,("00"+(d[p][x].getMonth()+1)).slice(-2),"sbcs"),G.write_shift(2,("00"+d[p][x].getDate()).slice(-2),"sbcs")):G.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(d[p][x]!=null?d[p][x]:"").slice(0,_[x]);for(G.write_shift(1,oe,"sbcs"),g=0;g<_[x]-oe.length;++g)G.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),M$=(function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+bt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(h,d){var v=e[d];return typeof v=="number"?k_(v):v},n=function(h,d,v){var p=d.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return p==59?h:k_(p)};e["|"]=254;function a(h,d){switch(d.type){case"base64":return i(Ia(h),d);case"binary":return i(h,d);case"buffer":return i(cr&&Buffer.isBuffer(h)?h.toString("binary"):Jl(h),d);case"array":return i(Sf(h),d)}throw new Error("Unrecognized type "+d.type)}function i(h,d){var v=h.split(/[\n\r]+/),p=-1,x=-1,g=0,N=0,b=[],y=[],_=null,w={},C=[],k=[],D=[],U=0,F;for(+d.codepage>=0&&Sl(+d.codepage);g!==v.length;++g){U=0;var L=v[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),P=L.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),B=P[0],G;if(L.length>0)switch(B){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&y.push(L.slice(3).replace(/;;/g,";"));break;case"C":var ue=!1,oe=!1,he=!1,fe=!1,S=-1,re=-1;for(N=1;N<P.length;++N)switch(P[N].charAt(0)){case"A":break;case"X":x=parseInt(P[N].slice(1))-1,oe=!0;break;case"Y":for(p=parseInt(P[N].slice(1))-1,oe||(x=0),F=b.length;F<=p;++F)b[F]=[];break;case"K":G=P[N].slice(1),G.charAt(0)==='"'?G=G.slice(1,G.length-1):G==="TRUE"?G=!0:G==="FALSE"?G=!1:isNaN(Sa(G))?isNaN(Dl(G).getDate())||(G=It(G)):(G=Sa(G),_!==null&&pF(_)&&(G=bF(G))),ue=!0;break;case"E":fe=!0;var T=PG(P[N].slice(1),{r:p,c:x});b[p][x]=[b[p][x],T];break;case"S":he=!0,b[p][x]=[b[p][x],"S5S"];break;case"G":break;case"R":S=parseInt(P[N].slice(1))-1;break;case"C":re=parseInt(P[N].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}if(ue&&(b[p][x]&&b[p][x].length==2?b[p][x][0]=G:b[p][x]=G,_=null),he){if(fe)throw new Error("SYLK shared formula cannot have own formula");var E=S>-1&&b[S][re];if(!E||!E[1])throw new Error("SYLK shared formula cannot find base");b[p][x][1]=VG(E[1],{r:p-S,c:x-re})}break;case"F":var V=0;for(N=1;N<P.length;++N)switch(P[N].charAt(0)){case"X":x=parseInt(P[N].slice(1))-1,++V;break;case"Y":for(p=parseInt(P[N].slice(1))-1,F=b.length;F<=p;++F)b[F]=[];break;case"M":U=parseInt(P[N].slice(1))/20;break;case"F":break;case"G":break;case"P":_=y[parseInt(P[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=P[N].slice(1).split(" "),F=parseInt(D[0],10);F<=parseInt(D[1],10);++F)U=parseInt(D[2],10),k[F-1]=U===0?{hidden:!0}:{wch:U},aN(k[F-1]);break;case"C":x=parseInt(P[N].slice(1))-1,k[x]||(k[x]={});break;case"R":p=parseInt(P[N].slice(1))-1,C[p]||(C[p]={}),U>0?(C[p].hpt=U,C[p].hpx=sU(U)):U===0&&(C[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}V<1&&(_=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}}return C.length>0&&(w["!rows"]=C),k.length>0&&(w["!cols"]=k),d&&d.sheetRows&&(b=b.slice(0,d.sheetRows)),[b,w]}function s(h,d){var v=a(h,d),p=v[0],x=v[1],g=go(p,d);return bt(x).forEach(function(N){g[N]=x[N]}),g}function o(h,d){return ms(s(h,d),d)}function u(h,d,v,p){var x="C;Y"+(v+1)+";X"+(p+1)+";K";switch(h.t){case"n":x+=h.v||0,h.f&&!h.F&&(x+=";E"+sN(h.f,{r:v,c:p}));break;case"b":x+=h.v?"TRUE":"FALSE";break;case"e":x+=h.w||h.v;break;case"d":x+='"'+(h.w||h.v)+'"';break;case"s":x+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function l(h,d){d.forEach(function(v,p){var x="F;W"+(p+1)+" "+(p+1)+" ";v.hidden?x+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Mc(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=jc(v.wpx)),typeof v.wch=="number"&&(x+=Math.round(v.wch))),x.charAt(x.length-1)!=" "&&h.push(x)})}function c(h,d){d.forEach(function(v,p){var x="F;";v.hidden?x+="M0;":v.hpt?x+="M"+20*v.hpt+";":v.hpx&&(x+="M"+20*Lc(v.hpx)+";"),x.length>2&&h.push(x+"R"+(p+1))})}function f(h,d){var v=["ID;PWXL;N;E"],p=[],x=kr(h["!ref"]),g,N=Array.isArray(h),b=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&l(v,h["!cols"]),h["!rows"]&&c(v,h["!rows"]),v.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var y=x.s.r;y<=x.e.r;++y)for(var _=x.s.c;_<=x.e.c;++_){var w=vr({r:y,c:_});g=N?(h[y]||[])[_]:h[w],!(!g||g.v==null&&(!g.f||g.F))&&p.push(u(g,h,y,_))}return v.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:s,from_sheet:f}})(),j$=(function(){function e(i,s){switch(s.type){case"base64":return r(Ia(i),s);case"binary":return r(i,s);case"buffer":return r(cr&&Buffer.isBuffer(i)?i.toString("binary"):Jl(i),s);case"array":return r(Sf(i),s)}throw new Error("Unrecognized type "+s.type)}function r(i,s){for(var o=i.split(`
`),u=-1,l=-1,c=0,f=[];c!==o.length;++c){if(o[c].trim()==="BOT"){f[++u]=[],l=0;continue}if(!(u<0)){var h=o[c].trim().split(","),d=h[0],v=h[1];++c;for(var p=o[c]||"";(p.match(/["]/g)||[]).length&1&&c<o.length-1;)p+=`
`+o[++c];switch(p=p.trim(),+d){case-1:if(p==="BOT"){f[++u]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[u][l]=!0:p==="FALSE"?f[u][l]=!1:isNaN(Sa(v))?isNaN(Dl(v).getDate())?f[u][l]=v:f[u][l]=It(v):f[u][l]=Sa(v),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[u][l++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function t(i,s){return go(e(i,s),s)}function n(i,s){return ms(t(i,s),s)}var a=(function(){var i=function(u,l,c,f,h){u.push(l),u.push(c+","+f),u.push('"'+h.replace(/"/g,'""')+'"')},s=function(u,l,c,f){u.push(l+","+c),u.push(l==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(u){var l=[],c=kr(u["!ref"]),f,h=Array.isArray(u);i(l,"TABLE",0,1,"sheetjs"),i(l,"VECTORS",0,c.e.r-c.s.r+1,""),i(l,"TUPLES",0,c.e.c-c.s.c+1,""),i(l,"DATA",0,0,"");for(var d=c.s.r;d<=c.e.r;++d){s(l,-1,0,"BOT");for(var v=c.s.c;v<=c.e.c;++v){var p=vr({r:d,c:v});if(f=h?(u[d]||[])[v]:u[p],!f){s(l,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?s(l,1,0,"="+f.f):s(l,1,0,""):s(l,0,x,"V");break;case"b":s(l,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(l,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=ci(f.z||qr[14],Ht(It(f.v)))),s(l,0,f.w,"V");break;default:s(l,1,0,"")}}}s(l,-1,0,"EOD");var g=`\r
`,N=l.join(g);return N}})();return{to_workbook:n,to_sheet:t,from_sheet:a}})(),tU=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,h){for(var d=f.split(`
`),v=-1,p=-1,x=0,g=[];x!==d.length;++x){var N=d[x].trim().split(":");if(N[0]==="cell"){var b=ct(N[1]);if(g.length<=b.r)for(v=g.length;v<=b.r;++v)g[v]||(g[v]=[]);switch(v=b.r,p=b.c,N[2]){case"t":g[v][p]=e(N[3]);break;case"v":g[v][p]=+N[3];break;case"vtf":var y=N[N.length-1];case"vtc":switch(N[3]){case"nl":g[v][p]=!!+N[4];break;default:g[v][p]=+N[4];break}N[2]=="vtf"&&(g[v][p]=[g[v][p],y])}}}return h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}function n(f,h){return go(t(f,h),h)}function a(f,h){return ms(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function l(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],v,p="",x=ln(f["!ref"]),g=Array.isArray(f),N=x.s.r;N<=x.e.r;++N)for(var b=x.s.c;b<=x.e.c;++b)if(p=vr({r:N,c:b}),v=g?(f[N]||[])[b]:f[p],!(!v||v.v==null||v.t==="z")){switch(d=["cell",p,"t"],v.t){case"s":case"str":d.push(r(v.v));break;case"n":v.f?(d[2]="vtf",d[3]="n",d[4]=v.v,d[5]=r(v.f)):(d[2]="v",d[3]=v.v);break;case"b":d[2]="vt"+(v.f?"f":"c"),d[3]="nl",d[4]=v.v?"1":"0",d[5]=r(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var y=Ht(It(v.v));d[2]="vtc",d[3]="nd",d[4]=""+y,d[5]=v.w||ci(v.z||qr[14],y);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function c(f){return[i,s,o,s,l(f),u].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:c}})(),L$=(function(){function e(c,f,h,d,v){v.raw?f[h][d]=c:c===""||(c==="TRUE"?f[h][d]=!0:c==="FALSE"?f[h][d]=!1:isNaN(Sa(c))?isNaN(Dl(c).getDate())?f[h][d]=c:f[h][d]=It(c):f[h][d]=Sa(c))}function r(c,f){var h=f||{},d=[];if(!c||c.length===0)return d;for(var v=c.split(/[\r\n]/),p=v.length-1;p>=0&&v[p].length===0;)--p;for(var x=10,g=0,N=0;N<=p;++N)g=v[N].indexOf(" "),g==-1?g=v[N].length:g++,x=Math.max(x,g);for(N=0;N<=p;++N){d[N]=[];var b=0;for(e(v[N].slice(0,x).trim(),d,N,b,h),b=1;b<=(v[N].length-x)/10+1;++b)e(v[N].slice(x+(b-1)*10,x+b*10).trim(),d,N,b,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(c){for(var f={},h=!1,d=0,v=0;d<c.length;++d)(v=c.charCodeAt(d))==34?h=!h:!h&&v in t&&(f[v]=(f[v]||0)+1);v=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&v.push([f[d],d]);if(!v.length){f=n;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&v.push([f[d],d])}return v.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),t[v.pop()[1]]||44}function i(c,f){var h=f||{},d="",v=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(d=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(d=c.charAt(4),c=c.slice(6)):d=a(c.slice(0,1024)):h&&h.FS?d=h.FS:d=a(c.slice(0,1024));var x=0,g=0,N=0,b=0,y=0,_=d.charCodeAt(0),w=!1,C=0,k=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var D=h.dateNF!=null?tz(h.dateNF):null;function U(){var F=c.slice(b,y),L={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)L.t="z";else if(h.raw)L.t="s",L.v=F;else if(F.trim().length===0)L.t="s",L.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(L.t="s",L.v=F.slice(2,-1).replace(/""/g,'"')):MG(F)?(L.t="n",L.f=F.slice(1)):(L.t="s",L.v=F);else if(F=="TRUE")L.t="b",L.v=!0;else if(F=="FALSE")L.t="b",L.v=!1;else if(!isNaN(N=Sa(F)))L.t="n",h.cellText!==!1&&(L.w=F),L.v=N;else if(!isNaN(Dl(F).getDate())||D&&F.match(D)){L.z=h.dateNF||qr[14];var P=0;D&&F.match(D)&&(F=nz(F,h.dateNF,F.match(D)||[]),P=1),h.cellDates?(L.t="d",L.v=It(F,P)):(L.t="n",L.v=Ht(It(F,P))),h.cellText!==!1&&(L.w=ci(L.z,L.v instanceof Date?Ht(L.v):L.v)),h.cellNF||delete L.z}else L.t="s",L.v=F;if(L.t=="z"||(h.dense?(v[x]||(v[x]=[]),v[x][g]=L):v[vr({c:g,r:x})]=L),b=y+1,k=c.charCodeAt(b),p.e.c<g&&(p.e.c=g),p.e.r<x&&(p.e.r=x),C==_)++g;else if(g=0,++x,h.sheetRows&&h.sheetRows<=x)return!0}e:for(;y<c.length;++y)switch(C=c.charCodeAt(y)){case 34:k===34&&(w=!w);break;case _:case 10:case 13:if(!w&&U())break e;break}return y-b>0&&U(),v["!ref"]=rt(p),v}function s(c,f){return!(f&&f.PRN)||f.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?i(c,f):go(r(c,f),f)}function o(c,f){var h="",d=f.type=="string"?[0,0,0,0]:ZX(c,f);switch(f.type){case"base64":h=Ia(c);break;case"binary":h=c;break;case"buffer":f.codepage==65001?h=c.toString("utf8"):f.codepage&&typeof Ac<"u"||(h=cr&&Buffer.isBuffer(c)?c.toString("binary"):Jl(c));break;case"array":h=Sf(c);break;case"string":h=c;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=nl(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=nl(h):f.type=="binary"&&typeof Ac<"u",h.slice(0,19)=="socialcalc:version:"?tU.to_sheet(f.type=="string"?h:nl(h),f):s(h,f)}function u(c,f){return ms(o(c,f),f)}function l(c){for(var f=[],h=kr(c["!ref"]),d,v=Array.isArray(c),p=h.s.r;p<=h.e.r;++p){for(var x=[],g=h.s.c;g<=h.e.c;++g){var N=vr({r:p,c:g});if(d=v?(c[p]||[])[g]:c[N],!d||d.v==null){x.push("          ");continue}for(var b=(d.w||(Pa(d),d.w)||"").slice(0,10);b.length<10;)b+=" ";x.push(b+(g===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:l}})(),oS=(function(){function e(T,E,V){if(T){Jt(T,T.l||0);for(var I=V.Enum||S;T.l<T.length;){var Y=T.read_shift(2),ie=I[Y]||I[65535],le=T.read_shift(2),X=T.l+le,Q=ie.f&&ie.f(T,le,V);if(T.l=X,E(Q,ie,Y))return}}}function r(T,E){switch(E.type){case"base64":return t(Fn(Ia(T)),E);case"binary":return t(Fn(T),E);case"buffer":case"array":return t(T,E)}throw"Unsupported type "+E.type}function t(T,E){if(!T)return T;var V=E||{},I=V.dense?[]:{},Y="Sheet1",ie="",le=0,X={},Q=[],be=[],ee={s:{r:0,c:0},e:{r:0,c:0}},Ie=V.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)V.Enum=S,e(T,function(Ee,xr,Wr){switch(Wr){case 0:V.vers=Ee,Ee>=4096&&(V.qpro=!0);break;case 6:ee=Ee;break;case 204:Ee&&(ie=Ee);break;case 222:ie=Ee;break;case 15:case 51:V.qpro||(Ee[1].v=Ee[1].v.slice(1));case 13:case 14:case 16:Wr==14&&(Ee[2]&112)==112&&(Ee[2]&15)>1&&(Ee[2]&15)<15&&(Ee[1].z=V.dateNF||qr[14],V.cellDates&&(Ee[1].t="d",Ee[1].v=bF(Ee[1].v))),V.qpro&&Ee[3]>le&&(I["!ref"]=rt(ee),X[Y]=I,Q.push(Y),I=V.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},le=Ee[3],Y=ie||"Sheet"+(le+1),ie="");var $r=V.dense?(I[Ee[0].r]||[])[Ee[0].c]:I[vr(Ee[0])];if($r){$r.t=Ee[1].t,$r.v=Ee[1].v,Ee[1].z!=null&&($r.z=Ee[1].z),Ee[1].f!=null&&($r.f=Ee[1].f);break}V.dense?(I[Ee[0].r]||(I[Ee[0].r]=[]),I[Ee[0].r][Ee[0].c]=Ee[1]):I[vr(Ee[0])]=Ee[1];break}},V);else if(T[2]==26||T[2]==14)V.Enum=re,T[2]==14&&(V.qpro=!0,T.l=0),e(T,function(Ee,xr,Wr){switch(Wr){case 204:Y=Ee;break;case 22:Ee[1].v=Ee[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ee[3]>le&&(I["!ref"]=rt(ee),X[Y]=I,Q.push(Y),I=V.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},le=Ee[3],Y="Sheet"+(le+1)),Ie>0&&Ee[0].r>=Ie)break;V.dense?(I[Ee[0].r]||(I[Ee[0].r]=[]),I[Ee[0].r][Ee[0].c]=Ee[1]):I[vr(Ee[0])]=Ee[1],ee.e.c<Ee[0].c&&(ee.e.c=Ee[0].c),ee.e.r<Ee[0].r&&(ee.e.r=Ee[0].r);break;case 27:Ee[14e3]&&(be[Ee[14e3][0]]=Ee[14e3][1]);break;case 1537:be[Ee[0]]=Ee[1],Ee[0]==le&&(Y=Ee[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(I["!ref"]=rt(ee),X[ie||Y]=I,Q.push(ie||Y),!be.length)return{SheetNames:Q,Sheets:X};for(var Te={},Ye=[],Be=0;Be<be.length;++Be)X[Q[Be]]?(Ye.push(be[Be]||Q[Be]),Te[be[Be]]=X[be[Be]]||X[Q[Be]]):(Ye.push(be[Be]),Te[be[Be]]={"!ref":"A1"});return{SheetNames:Ye,Sheets:Te}}function n(T,E){var V=E||{};if(+V.codepage>=0&&Sl(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var I=Lt(),Y=kr(T["!ref"]),ie=Array.isArray(T),le=[];Se(I,0,i(1030)),Se(I,6,u(Y));for(var X=Math.min(Y.e.r,8191),Q=Y.s.r;Q<=X;++Q)for(var be=gt(Q),ee=Y.s.c;ee<=Y.e.c;++ee){Q===Y.s.r&&(le[ee]=St(ee));var Ie=le[ee]+be,Te=ie?(T[Q]||[])[ee]:T[Ie];if(!(!Te||Te.t=="z"))if(Te.t=="n")(Te.v|0)==Te.v&&Te.v>=-32768&&Te.v<=32767?Se(I,13,d(Q,ee,Te.v)):Se(I,14,p(Q,ee,Te.v));else{var Ye=Pa(Te);Se(I,15,f(Q,ee,Ye.slice(0,239)))}}return Se(I,1),I.end()}function a(T,E){var V=E||{};if(+V.codepage>=0&&Sl(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var I=Lt();Se(I,0,s(T));for(var Y=0,ie=0;Y<T.SheetNames.length;++Y)(T.Sheets[T.SheetNames[Y]]||{})["!ref"]&&Se(I,27,fe(T.SheetNames[Y],ie++));var le=0;for(Y=0;Y<T.SheetNames.length;++Y){var X=T.Sheets[T.SheetNames[Y]];if(!(!X||!X["!ref"])){for(var Q=kr(X["!ref"]),be=Array.isArray(X),ee=[],Ie=Math.min(Q.e.r,8191),Te=Q.s.r;Te<=Ie;++Te)for(var Ye=gt(Te),Be=Q.s.c;Be<=Q.e.c;++Be){Te===Q.s.r&&(ee[Be]=St(Be));var Ee=ee[Be]+Ye,xr=be?(X[Te]||[])[Be]:X[Ee];if(!(!xr||xr.t=="z"))if(xr.t=="n")Se(I,23,U(Te,Be,le,xr.v));else{var Wr=Pa(xr);Se(I,22,C(Te,Be,le,Wr.slice(0,239)))}}++le}}return Se(I,1),I.end()}function i(T){var E=ce(2);return E.write_shift(2,T),E}function s(T){var E=ce(26);E.write_shift(2,4096),E.write_shift(2,4),E.write_shift(4,0);for(var V=0,I=0,Y=0,ie=0;ie<T.SheetNames.length;++ie){var le=T.SheetNames[ie],X=T.Sheets[le];if(!(!X||!X["!ref"])){++Y;var Q=ln(X["!ref"]);V<Q.e.r&&(V=Q.e.r),I<Q.e.c&&(I=Q.e.c)}}return V>8191&&(V=8191),E.write_shift(2,V),E.write_shift(1,Y),E.write_shift(1,I),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(1,1),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(4,0),E}function o(T,E,V){var I={s:{c:0,r:0},e:{c:0,r:0}};return E==8&&V.qpro?(I.s.c=T.read_shift(1),T.l++,I.s.r=T.read_shift(2),I.e.c=T.read_shift(1),T.l++,I.e.r=T.read_shift(2),I):(I.s.c=T.read_shift(2),I.s.r=T.read_shift(2),E==12&&V.qpro&&(T.l+=2),I.e.c=T.read_shift(2),I.e.r=T.read_shift(2),E==12&&V.qpro&&(T.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function u(T){var E=ce(8);return E.write_shift(2,T.s.c),E.write_shift(2,T.s.r),E.write_shift(2,T.e.c),E.write_shift(2,T.e.r),E}function l(T,E,V){var I=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(I[0].c=T.read_shift(1),I[3]=T.read_shift(1),I[0].r=T.read_shift(2),T.l+=2):(I[2]=T.read_shift(1),I[0].c=T.read_shift(2),I[0].r=T.read_shift(2)),I}function c(T,E,V){var I=T.l+E,Y=l(T,E,V);if(Y[1].t="s",V.vers==20768){T.l++;var ie=T.read_shift(1);return Y[1].v=T.read_shift(ie,"utf8"),Y}return V.qpro&&T.l++,Y[1].v=T.read_shift(I-T.l,"cstr"),Y}function f(T,E,V){var I=ce(7+V.length);I.write_shift(1,255),I.write_shift(2,E),I.write_shift(2,T),I.write_shift(1,39);for(var Y=0;Y<I.length;++Y){var ie=V.charCodeAt(Y);I.write_shift(1,ie>=128?95:ie)}return I.write_shift(1,0),I}function h(T,E,V){var I=l(T,E,V);return I[1].v=T.read_shift(2,"i"),I}function d(T,E,V){var I=ce(7);return I.write_shift(1,255),I.write_shift(2,E),I.write_shift(2,T),I.write_shift(2,V,"i"),I}function v(T,E,V){var I=l(T,E,V);return I[1].v=T.read_shift(8,"f"),I}function p(T,E,V){var I=ce(13);return I.write_shift(1,255),I.write_shift(2,E),I.write_shift(2,T),I.write_shift(8,V,"f"),I}function x(T,E,V){var I=T.l+E,Y=l(T,E,V);if(Y[1].v=T.read_shift(8,"f"),V.qpro)T.l=I;else{var ie=T.read_shift(2);y(T.slice(T.l,T.l+ie),Y),T.l+=ie}return Y}function g(T,E,V){var I=E&32768;return E&=-32769,E=(I?T:0)+(E>=8192?E-16384:E),(I?"":"$")+(V?St(E):gt(E))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function y(T,E){Jt(T,0);for(var V=[],I=0,Y="",ie="",le="",X="";T.l<T.length;){var Q=T[T.l++];switch(Q){case 0:V.push(T.read_shift(8,"f"));break;case 1:ie=g(E[0].c,T.read_shift(2),!0),Y=g(E[0].r,T.read_shift(2),!1),V.push(ie+Y);break;case 2:{var be=g(E[0].c,T.read_shift(2),!0),ee=g(E[0].r,T.read_shift(2),!1);ie=g(E[0].c,T.read_shift(2),!0),Y=g(E[0].r,T.read_shift(2),!1),V.push(be+ee+":"+ie+Y)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(T.read_shift(2));break;case 6:{for(var Ie="";Q=T[T.l++];)Ie+=String.fromCharCode(Q);V.push('"'+Ie.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:X=V.pop(),le=V.pop(),V.push(["AND","OR"][Q-20]+"("+le+","+X+")");break;default:if(Q<32&&b[Q])X=V.pop(),le=V.pop(),V.push(le+b[Q]+X);else if(N[Q]){if(I=N[Q][1],I==69&&(I=T[T.l++]),I>V.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+V.join("|")+"|");return}var Te=V.slice(-I);V.length-=I,V.push(N[Q][0]+"("+Te.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}V.length==1?E[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function _(T){var E=[{c:0,r:0},{t:"n",v:0},0];return E[0].r=T.read_shift(2),E[3]=T[T.l++],E[0].c=T[T.l++],E}function w(T,E){var V=_(T);return V[1].t="s",V[1].v=T.read_shift(E-4,"cstr"),V}function C(T,E,V,I){var Y=ce(6+I.length);Y.write_shift(2,T),Y.write_shift(1,V),Y.write_shift(1,E),Y.write_shift(1,39);for(var ie=0;ie<I.length;++ie){var le=I.charCodeAt(ie);Y.write_shift(1,le>=128?95:le)}return Y.write_shift(1,0),Y}function k(T,E){var V=_(T);V[1].v=T.read_shift(2);var I=V[1].v>>1;if(V[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return V[1].v=I,V}function D(T,E){var V=_(T),I=T.read_shift(4),Y=T.read_shift(4),ie=T.read_shift(2);if(ie==65535)return I===0&&Y===3221225472?(V[1].t="e",V[1].v=15):I===0&&Y===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var le=ie&32768;return ie=(ie&32767)-16446,V[1].v=(1-le*2)*(Y*Math.pow(2,ie+32)+I*Math.pow(2,ie)),V}function U(T,E,V,I){var Y=ce(14);if(Y.write_shift(2,T),Y.write_shift(1,V),Y.write_shift(1,E),I==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var ie=0,le=0,X=0,Q=0;return I<0&&(ie=1,I=-I),le=Math.log2(I)|0,I/=Math.pow(2,le-31),Q=I>>>0,(Q&2147483648)==0&&(I/=2,++le,Q=I>>>0),I-=Q,Q|=2147483648,Q>>>=0,I*=Math.pow(2,32),X=I>>>0,Y.write_shift(4,X),Y.write_shift(4,Q),le+=16383+(ie?32768:0),Y.write_shift(2,le),Y}function F(T,E){var V=D(T);return T.l+=E-14,V}function L(T,E){var V=_(T),I=T.read_shift(4);return V[1].v=I>>6,V}function P(T,E){var V=_(T),I=T.read_shift(8,"f");return V[1].v=I,V}function B(T,E){var V=P(T);return T.l+=E-10,V}function G(T,E){return T[T.l+E-1]==0?T.read_shift(E,"cstr"):""}function ue(T,E){var V=T[T.l++];V>E-1&&(V=E-1);for(var I="";I.length<V;)I+=String.fromCharCode(T[T.l++]);return I}function oe(T,E,V){if(!(!V.qpro||E<21)){var I=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var Y=T.read_shift(E-21,"cstr");return[I,Y]}}function he(T,E){for(var V={},I=T.l+E;T.l<I;){var Y=T.read_shift(2);if(Y==14e3){for(V[Y]=[0,""],V[Y][0]=T.read_shift(2);T[T.l];)V[Y][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return V}function fe(T,E){var V=ce(5+T.length);V.write_shift(2,14e3),V.write_shift(2,E);for(var I=0;I<T.length;++I){var Y=T.charCodeAt(I);V[V.l++]=Y>127?95:Y}return V[V.l++]=0,V}var S={0:{n:"BOF",f:QF},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:G},222:{n:"SHEETNAMELP",f:ue},65535:{n:""}},re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:w},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:he},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:B},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:G},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}})(),B$=/^\s|\s$|[\t\n\r]/;function nU(e,r){if(!r.bookSST)return"";var t=[tt];t[t.length]=_e("sst",null,{xmlns:xo[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(B$)&&(i+=' xml:space="preserve"'),i+=">"+pr(a.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function q$(e){return[e.read_shift(4),e.read_shift(4)]}function H$(e,r){return r||(r=ce(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var z$=Uz;function $$(e){var r=Lt();ve(r,159,H$(e));for(var t=0;t<e.length;++t)ve(r,19,z$(e[t]));return ve(r,160),r.end()}function G$(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function aU(e){var r=0,t,n=G$(e),a=n.length+1,i,s,o,u,l;for(t=rs(a),t[0]=n.length,i=1;i!=a;++i)t[i]=n[i-1];for(i=a-1;i>=0;--i)s=t[i],o=(r&16384)===0?0:1,u=r<<1&32767,l=o|u,r=l^s;return r^52811}var W$=(function(){function e(a,i){switch(i.type){case"base64":return r(Ia(a),i);case"binary":return r(a,i);case"buffer":return r(cr&&Buffer.isBuffer(a)?a.toString("binary"):Jl(a),i);case"array":return r(Sf(a),i)}throw new Error("Unrecognized type "+i.type)}function r(a,i){var s=i||{},o=s.dense?[]:{},u=a.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(c,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,d=0,v,p=-1;v=h.exec(c);){switch(v[0]){case"\\cell":var x=c.slice(d,h.lastIndex-v[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var g={v:x,t:"s"};Array.isArray(o)?o[f][p]=g:o[vr({r:f,c:p})]=g}break}d=h.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=rt(l),o}function t(a,i){return ms(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=kr(a["!ref"]),o,u=Array.isArray(a),l=s.s.r;l<=s.e.r;++l){i.push("\\trowd\\trautofit1");for(var c=s.s.c;c<=s.e.c;++c)i.push("\\cellx"+(c+1));for(i.push("\\pard\\intbl"),c=s.s.c;c<=s.e.c;++c){var f=vr({r:l,c});o=u?(a[l]||[])[c]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Pa(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}})();function lS(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}var Y$=6,Ta=Y$;function Mc(e){return Math.floor((e+Math.round(128/Ta)/256)*Ta)}function jc(e){return Math.floor((e-5)/Ta*100+.5)/100}function r1(e){return Math.round((e*Ta+5)/Ta*256)/256}function aN(e){e.width?(e.wpx=Mc(e.width),e.wch=jc(e.wpx),e.MDW=Ta):e.wpx?(e.wch=jc(e.wpx),e.width=r1(e.wch),e.MDW=Ta):typeof e.wch=="number"&&(e.width=r1(e.wch),e.wpx=Mc(e.width),e.MDW=Ta),e.customWidth&&delete e.customWidth}var K$=96,iU=K$;function Lc(e){return e*96/iU}function sU(e){return e*iU/96}function X$(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=_e("numFmt",null,{numFmtId:n,formatCode:pr(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=_e("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function Q$(e){var r=[];return r[r.length]=_e("cellXfs",null),e.forEach(function(t){r[r.length]=_e("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=_e("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function oU(e,r){var t=[tt,_e("styleSheet",null,{xmlns:xo[0],"xmlns:vt":ut.vt})],n;return e.SSF&&(n=X$(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Q$(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Z$(e,r){var t=e.read_shift(2),n=Tt(e);return[t,n]}function J$(e,r,t){t||(t=ce(6+4*r.length)),t.write_shift(2,e),ft(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function eG(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=Bz(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=Lz(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Tt(e),n}function rG(e,r){r||(r=ce(153)),r.write_shift(2,e.sz*20),qz(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),Pc(e.color,r);var n=0;return n=2,r.write_shift(1,n),ft(e.name,r),r.length>r.l?r.slice(0,r.l):r}var tG=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],cp,nG=oa;function uS(e,r){r||(r=ce(84)),cp||(cp=Gb(tG));var t=cp[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(Pc({auto:1},r),Pc({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function aG(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}function lU(e,r,t){t||(t=ce(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Vo(e,r){return r||(r=ce(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var iG=oa;function sG(e,r){return r||(r=ce(51)),r.write_shift(1,0),Vo(null,r),Vo(null,r),Vo(null,r),Vo(null,r),Vo(null,r),r.length>r.l?r.slice(0,r.l):r}function oG(e,r){return r||(r=ce(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),Ic(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function lG(e,r,t){var n=ce(2052);return n.write_shift(4,e),Ic(r,n),Ic(t,n),n.length>n.l?n.slice(0,n.l):n}function uG(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&++t}),t!=0&&(ve(e,615,Vn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&ve(e,44,J$(a,r[a]))}),ve(e,616))}}function cG(e){var r=1;ve(e,611,Vn(r)),ve(e,43,rG({sz:12,color:{theme:1},name:"Calibri",family:2})),ve(e,612)}function fG(e){var r=2;ve(e,603,Vn(r)),ve(e,45,uS({patternType:"none"})),ve(e,45,uS({patternType:"gray125"})),ve(e,604)}function mG(e){var r=1;ve(e,613,Vn(r)),ve(e,46,sG()),ve(e,614)}function dG(e){var r=1;ve(e,626,Vn(r)),ve(e,47,lU({numFmtId:0},65535)),ve(e,627)}function hG(e,r){ve(e,617,Vn(r.length)),r.forEach(function(t){ve(e,47,lU(t,0))}),ve(e,618)}function pG(e){var r=1;ve(e,619,Vn(r)),ve(e,48,oG({xfId:0,name:"Normal"})),ve(e,620)}function vG(e){var r=0;ve(e,505,Vn(r)),ve(e,506)}function xG(e){var r=0;ve(e,508,lG(r,"TableStyleMedium9","PivotStyleMedium4")),ve(e,509)}function gG(e,r){var t=Lt();return ve(t,278),uG(t,e.SSF),cG(t),fG(t),mG(t),dG(t),hG(t,r.cellXfs),pG(t),vG(t),xG(t),ve(t,279),t.end()}function uU(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[tt];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function bG(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Tt(e)}}function NG(e){var r=ce(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),ft(e.name,r),r.slice(0,r.l)}function yG(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function CG(e){var r=ce(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function EG(e,r){var t=ce(8+2*r.length);return t.write_shift(4,e),ft(r,t),t.slice(0,t.l)}function wG(e){return e.l+=4,e.read_shift(4)!=0}function _G(e,r){var t=ce(8);return t.write_shift(4,e),t.write_shift(4,1),t}function SG(){var e=Lt();return ve(e,332),ve(e,334,Vn(1)),ve(e,335,NG({name:"XLDAPR",version:12e4,flags:3496657072})),ve(e,336),ve(e,339,EG(1,"XLDAPR")),ve(e,52),ve(e,35,Vn(514)),ve(e,4096,Vn(0)),ve(e,4097,hn(1)),ve(e,36),ve(e,53),ve(e,340),ve(e,337,_G(1)),ve(e,51,CG([[1,0]])),ve(e,338),ve(e,333),e.end()}function cU(){var e=[tt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function TG(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=vr(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}var Us=1024;function fU(e,r){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),a=[_e("xml",null,{"xmlns:v":rn.v,"xmlns:o":rn.o,"xmlns:x":rn.x,"xmlns:mv":rn.mv}).replace(/\/>/,">"),_e("o:shapelayout",_e("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),_e("v:shapetype",[_e("v:stroke",null,{joinstyle:"miter"}),_e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Us<e*1e3;)Us+=1e3;return r.forEach(function(i){var s=ct(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var u=o.type=="gradient"?_e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=_e("v:fill",u,o),c={on:"t",obscured:"t"};++Us,a=a.concat(["<v:shape"+kl({id:"_x0000_s"+Us,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,_e("v:shadow",null,c),_e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",xt("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),xt("x:AutoFill","False"),xt("x:Row",String(s.r)),xt("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function mU(e){var r=[tt,_e("comments",null,{xmlns:xo[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=pr(a.a);t.indexOf(i)==-1&&(t.push(i),r.push("<author>"+i+"</author>")),a.T&&a.ID&&t.indexOf("tc="+a.ID)==-1&&(t.push("tc="+a.ID),r.push("<author>tc="+a.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(u){u.a&&(a=t.indexOf(pr(u.a))),i.push(u.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)r.push(xt("t",pr(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;r.push(xt("t",pr(s)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function DG(e,r,t){var n=[tt,_e("ThreadedComments",null,{xmlns:ut.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&r.indexOf(s.a)==-1&&r.push(s.a);var u={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?i=u.id:u.parentId=i,s.ID=u.id,s.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(s.a)).slice(-12)+"}"),n.push(_e("threadedComment",xt("text",s.t||""),u))})}),n.push("</ThreadedComments>"),n.join("")}function AG(e){var r=[tt,_e("personList",null,{xmlns:ut.TCMNT,"xmlns:x":xo[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(_e("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function kG(e){var r={};r.iauthor=e.read_shift(4);var t=vs(e);return r.rfx=t.s,r.ref=vr(t.s),e.l+=16,r}function RG(e,r){return r==null&&(r=ce(36)),r.write_shift(4,e[1].iauthor),bo(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var OG=Tt;function FG(e){return ft(e.slice(0,54))}function UG(e){var r=Lt(),t=[];return ve(r,628),ve(r,630),e.forEach(function(n){n[1].forEach(function(a){t.indexOf(a.a)>-1||(t.push(a.a.slice(0,54)),ve(r,632,FG(a.a)))})}),ve(r,631),ve(r,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=t.indexOf(a.a);var i={s:ct(n[0]),e:ct(n[0])};ve(r,635,RG([i,a])),a.t&&a.t.length>0&&ve(r,637,Pz(a)),ve(r,636),delete a.iauthor})}),ve(r,634),ve(r,629),r.end()}function IG(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var a=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&gr.utils.cfb_add(e,a,r.FileIndex[n].content)}})}var dU=["xlsb","xlsm","xlam","biff8","xla"],PG=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,i,s){var o=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var l=i.length>0?parseInt(i,10)|0:0,c=s.length>0?parseInt(s,10)|0:0;return o?c+=r.c:--c,u?l+=r.r:--l,a+(o?"":"$")+St(c)+(u?"":"$")+gt(l)}return function(a,i){return r=i,a.replace(e,t)}})(),iN=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sN=(function(){return function(r,t){return r.replace(iN,function(n,a,i,s,o,u){var l=Jb(s)-(i?0:t.c),c=Zb(u)-(o?0:t.r),f=c==0?"":o?c+1:"["+c+"]",h=l==0?"":i?l+1:"["+l+"]";return a+"R"+f+"C"+h})}})();function VG(e,r){return e.replace(iN,function(t,n,a,i,s,o){return n+(a=="$"?a+i:St(Jb(i)+r.c))+(s=="$"?s+o:gt(Zb(o)+r.r))})}function MG(e){return e.length!=1}function Kr(e){e.l+=1}function fi(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function hU(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return pU(e);t.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=fi(e),o=fi(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function pU(e){var r=fi(e),t=fi(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function jG(e,r,t){if(t.biff<8)return pU(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),i=fi(e),s=fi(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function vU(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return LG(e);var n=e.read_shift(t&&t.biff==12?4:2),a=fi(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function LG(e){var r=fi(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function BG(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function qG(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return HG(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function HG(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function zG(e,r,t){var n=(e[e.l++]&96)>>5,a=hU(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function $G(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=hU(e,i,t);return[n,a,s]}function GG(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function WG(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function YG(e,r,t){var n=(e[e.l++]&96)>>5,a=jG(e,r-1,t);return[n,a]}function KG(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function cS(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function XG(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function QG(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function ZG(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function JG(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function eW(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function xU(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function rW(e){return e.read_shift(2),xU(e)}function tW(e){return e.read_shift(2),xU(e)}function nW(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=vU(e,0,t);return[n,a]}function aW(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=qG(e,0,t);return[n,a]}function iW(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var i=vU(e,0,t);return[n,a,i]}function sW(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[sY[a],NU[a],n]}function oW(e,r,t){var n=e[e.l++],a=e.read_shift(1),i=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:lW(e);return[a,(i[0]===0?NU:iY)[i[1]]]}function lW(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function uW(e,r,t){e.l+=t&&t.biff==2?3:4}function cW(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function fW(e){return e.l++,tu[e.read_shift(1)]}function mW(e){return e.l++,e.read_shift(2)}function dW(e){return e.l++,e.read_shift(1)!==0}function hW(e){return e.l++,No(e)}function pW(e,r,t){return e.l++,JF(e,r-1,t)}function vW(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=i$(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=tu[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=No(e);break;case 2:t[1]=u$(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function xW(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((t.biff==12?vs:m$)(e));return a}function gW(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=vW(e,t.biff);return s}function bW(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,i=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function NW(e,r,t){if(t.biff==5)return yW(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function yW(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function CW(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function EW(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function wW(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function _W(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var SW=oa,TW=oa,DW=oa;function nu(e,r,t){return e.l+=2,[BG(e)]}function oN(e){return e.l+=6,[]}var AW=nu,kW=oN,RW=oN,OW=nu;function gU(e){return e.l+=2,[QF(e),e.read_shift(2)&1]}var FW=nu,UW=gU,IW=oN,PW=nu,VW=nu,MW=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jW(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=MW[t>>2&31];return{ixti:r,coltype:t&3,rt:s,idx:n,c:a,C:i}}function LW(e){return e.l+=2,[e.read_shift(4)]}function BW(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function qW(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function HW(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function zW(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function $W(e){return e.l+=4,[0,0]}var fS={1:{n:"PtgExp",f:cW},2:{n:"PtgTbl",f:DW},3:{n:"PtgAdd",f:Kr},4:{n:"PtgSub",f:Kr},5:{n:"PtgMul",f:Kr},6:{n:"PtgDiv",f:Kr},7:{n:"PtgPower",f:Kr},8:{n:"PtgConcat",f:Kr},9:{n:"PtgLt",f:Kr},10:{n:"PtgLe",f:Kr},11:{n:"PtgEq",f:Kr},12:{n:"PtgGe",f:Kr},13:{n:"PtgGt",f:Kr},14:{n:"PtgNe",f:Kr},15:{n:"PtgIsect",f:Kr},16:{n:"PtgUnion",f:Kr},17:{n:"PtgRange",f:Kr},18:{n:"PtgUplus",f:Kr},19:{n:"PtgUminus",f:Kr},20:{n:"PtgPercent",f:Kr},21:{n:"PtgParen",f:Kr},22:{n:"PtgMissArg",f:Kr},23:{n:"PtgStr",f:pW},26:{n:"PtgSheet",f:BW},27:{n:"PtgEndSheet",f:qW},28:{n:"PtgErr",f:fW},29:{n:"PtgBool",f:dW},30:{n:"PtgInt",f:mW},31:{n:"PtgNum",f:hW},32:{n:"PtgArray",f:KG},33:{n:"PtgFunc",f:sW},34:{n:"PtgFuncVar",f:oW},35:{n:"PtgName",f:bW},36:{n:"PtgRef",f:nW},37:{n:"PtgArea",f:zG},38:{n:"PtgMemArea",f:CW},39:{n:"PtgMemErr",f:SW},40:{n:"PtgMemNoMem",f:TW},41:{n:"PtgMemFunc",f:EW},42:{n:"PtgRefErr",f:wW},43:{n:"PtgAreaErr",f:GG},44:{n:"PtgRefN",f:aW},45:{n:"PtgAreaN",f:YG},46:{n:"PtgMemAreaN",f:HW},47:{n:"PtgMemNoMemN",f:zW},57:{n:"PtgNameX",f:NW},58:{n:"PtgRef3d",f:iW},59:{n:"PtgArea3d",f:$G},60:{n:"PtgRefErr3d",f:_W},61:{n:"PtgAreaErr3d",f:WG},255:{}},GW={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},WW={1:{n:"PtgElfLel",f:gU},2:{n:"PtgElfRw",f:PW},3:{n:"PtgElfCol",f:AW},6:{n:"PtgElfRwV",f:VW},7:{n:"PtgElfColV",f:OW},10:{n:"PtgElfRadical",f:FW},11:{n:"PtgElfRadicalS",f:IW},13:{n:"PtgElfColS",f:kW},15:{n:"PtgElfColSV",f:RW},16:{n:"PtgElfRadicalLel",f:UW},25:{n:"PtgList",f:jW},29:{n:"PtgSxName",f:LW},255:{}},YW={0:{n:"PtgAttrNoop",f:$W},1:{n:"PtgAttrSemi",f:eW},2:{n:"PtgAttrIf",f:ZG},4:{n:"PtgAttrChoose",f:XG},8:{n:"PtgAttrGoto",f:QG},16:{n:"PtgAttrSum",f:uW},32:{n:"PtgAttrBaxcel",f:cS},33:{n:"PtgAttrBaxcel",f:cS},64:{n:"PtgAttrSpace",f:rW},65:{n:"PtgAttrSpaceSemi",f:tW},128:{n:"PtgAttrIfError",f:JG},255:{}};function KW(e,r,t,n){if(n.biff<8)return oa(e,r);for(var a=e.l+r,i=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=gW(e,0,n),i.push(t[s][1]);break;case"PtgMemArea":t[s][2]=xW(e,t[s][1],n),i.push(t[s][2]);break;case"PtgExp":n&&n.biff==12&&(t[s][1][1]=e.read_shift(4),i.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0]}return r=a-e.l,r!==0&&i.push(oa(e,r)),i}function XW(e,r,t){for(var n=e.l+r,a,i,s=[];n!=e.l;)r=n-e.l,i=e[e.l],a=fS[i]||fS[GW[i]],(i===24||i===25)&&(a=(i===24?WW:YW)[e[e.l+1]]),!a||!a.f?oa(e,r):s.push([a.n,a.f(e,r,t)]);return s}function QW(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var ZW={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function JW(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function bU(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function mS(e,r,t){var n=bU(e,r,t);return n=="#REF"?n:JW(n,t)}function oo(e,r,t,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],u,l,c,f=0,h=0,d,v="";if(!e[0]||!e[0][0])return"";for(var p=-1,x="",g=0,N=e[0].length;g<N;++g){var b=e[0][g];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),l=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:x=Lr(" ",e[0][p][1][1]);break;case 1:x=Lr("\r",e[0][p][1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}l=l+x,p=-1}o.push(l+ZW[b[0]]+u);break;case"PtgIsect":u=o.pop(),l=o.pop(),o.push(l+" "+u);break;case"PtgUnion":u=o.pop(),l=o.pop(),o.push(l+","+u);break;case"PtgRange":u=o.pop(),l=o.pop(),o.push(l+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=il(b[1][1],s,a),o.push(sl(c,i));break;case"PtgRefN":c=t?il(b[1][1],t,a):b[1][1],o.push(sl(c,i));break;case"PtgRef3d":f=b[1][1],c=il(b[1][2],s,a),v=mS(n,f,a),o.push(v+"!"+sl(c,i));break;case"PtgFunc":case"PtgFuncVar":var y=b[1][0],_=b[1][1];y||(y=0),y&=127;var w=y==0?[]:o.slice(-y);o.length-=y,_==="User"&&(_=w.shift()),o.push(_+"("+w.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":d=X_(b[1][1],t?{s:t}:s,a),o.push(lp(d,a));break;case"PtgArea":d=X_(b[1][1],s,a),o.push(lp(d,a));break;case"PtgArea3d":f=b[1][1],d=b[1][2],v=mS(n,f,a),o.push(v+"!"+lp(d,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=b[1][2];var C=(n.names||[])[h-1]||(n[0]||[])[h],k=C?C.Name:"SH33TJSNAME"+String(h);k&&k.slice(0,6)=="_xlfn."&&!a.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var D=b[1][1];h=b[1][2];var U;if(a.biff<=5)D<0&&(D=-D),n[D]&&(U=n[D][h]);else{var F="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][h]&&n[D][h].itab>0&&(F=n.SheetNames[n[D][h].itab-1]+"!"):F=n.SheetNames[h-1]+"!"),n[D]&&n[D][h])F+=n[D][h].Name;else if(n[0]&&n[0][h])F+=n[0][h].Name;else{var L=(bU(n,D,a)||"").split(";;");L[h-1]?F=L[h-1]:F+="SH33TJSERRX"}o.push(F);break}U||(U={Name:"SH33TJSERRY"}),o.push(U.Name);break;case"PtgParen":var P="(",B=")";if(p>=0){switch(x="",e[0][p][1][0]){case 2:P=Lr(" ",e[0][p][1][1])+P;break;case 3:P=Lr("\r",e[0][p][1][1])+P;break;case 4:B=Lr(" ",e[0][p][1][1])+B;break;case 5:B=Lr("\r",e[0][p][1][1])+B;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(P+o.pop()+B);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:b[1][1],r:b[1][0]};var G={c:t.c,r:t.r};if(n.sharedf[vr(c)]){var ue=n.sharedf[vr(c)];o.push(oo(ue,s,G,n,a))}else{var oe=!1;for(u=0;u!=n.arrayf.length;++u)if(l=n.arrayf[u],!(c.c<l[0].s.c||c.c>l[0].e.c)&&!(c.r<l[0].s.r||c.r>l[0].e.r)){o.push(oo(l[1],s,G,n,a)),oe=!0;break}oe||o.push(b[1])}break;case"PtgArray":o.push("{"+QW(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var he=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&he.indexOf(e[0][g][0])==-1){b=e[0][p];var fe=!0;switch(b[1][0]){case 4:fe=!1;case 0:x=Lr(" ",b[1][1]);break;case 5:fe=!1;case 1:x=Lr("\r",b[1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((fe?x:"")+o.pop()+(fe?"":x)),p=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function eY(e){if(e==null){var r=ce(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return ts(e);return ts(0)}function rY(e,r,t,n,a){var i=ns(r,t,a),s=eY(e.v),o=ce(6),u=33;o.write_shift(2,u),o.write_shift(4,0);for(var l=ce(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];var f=vt([i,s,o,l]);return f}function Tf(e,r,t){var n=e.read_shift(4),a=XW(e,n,t),i=e.read_shift(4),s=i>0?KW(e,i,a,t):null;return[a,s]}var tY=Tf,Df=Tf,nY=Tf,aY=Tf,iY={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},NU={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},sY={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function oY(e){var r="of:="+e.replace(iN,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function lY(e){return e.replace(/\./,"!")}var ol=typeof Map<"u";function lN(e,r,t){var n=0,a=e.length;if(t){if(ol?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var i=ol?t.get(r):t[r];n<i.length;++n)if(e[i[n]].t===r)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===r)return e.Count++,n;return e[a]={t:r},e.Count++,e.Unique++,t&&(ol?(t.has(r)||t.set(r,[]),t.get(r).push(a)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(a))),a}function Af(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(Ta=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=jc(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=r1(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function yU(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function yi(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],a=60,i=e.length;if(n==null&&t.ssf){for(;a<392;++a)if(t.ssf[a]==null){vF(r.z,a),t.ssf[a]=r.z,t.revssf[r.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function uY(e,r,t){if(e&&e["!ref"]){var n=kr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function cY(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+rt(e[t])+'"/>';return r+"</mergeCells>"}function fY(e,r,t,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&r.vbaraw){var u=r.SheetNames[t];try{r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}i=!0,s.codeName=Al(pr(u))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),o=(o||"")+_e("outlinePr",null,l)}!i&&!o||(a[a.length]=_e("sheetPr",o,s))}var mY=["objects","scenarios","selectLockedCells","selectUnlockedCells"],dY=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function hY(e){var r={sheet:1};return mY.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),dY.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=aU(e.password).toString(16).toUpperCase()),_e("sheetProtection",null,r)}function pY(e){return yU(e),_e("pageMargins",null,e)}function vY(e,r){for(var t=["<cols>"],n,a=0;a!=r.length;++a)(n=r[a])&&(t[t.length]=_e("col",null,Af(a,n)));return t[t.length]="</cols>",t.join("")}function xY(e,r,t,n){var a=typeof e.ref=="string"?e.ref:rt(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,s=ln(a);s.s.r==s.e.r&&(s.e.r=ln(r["!ref"]).e.r,a=rt(s));for(var o=0;o<i.length;++o){var u=i[o];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+t.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+a}),_e("autoFilter",null,{ref:a})}function gY(e,r,t,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),_e("sheetViews",_e("sheetView",null,a),{})}function bY(e,r,t,n){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=tu[e.v];break;case"d":n&&n.cellDates?a=It(e.v,-1).toISOString():(e=zt(e),e.t="n",a=""+(e.v=Ht(It(e.v)))),typeof e.z>"u"&&(e.z=qr[14]);break;default:a=e.v;break}var o=xt("v",pr(a)),u={r},l=yi(n.cellXfs,e,n);switch(l!==0&&(u.s=l),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=xt("v",""+lN(n.Strings,e.v,n.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var c=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;o=_e("f",pr(e.f),c)+(e.v!=null?o:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(u.cm=1),_e("c",o,u)}function NY(e,r,t,n){var a=[],i=[],s=kr(e["!ref"]),o="",u,l="",c=[],f=0,h=0,d=e["!rows"],v=Array.isArray(e),p={r:l},x,g=-1;for(h=s.s.c;h<=s.e.c;++h)c[h]=St(h);for(f=s.s.r;f<=s.e.r;++f){for(i=[],l=gt(f),h=s.s.c;h<=s.e.c;++h){u=c[h]+l;var N=v?(e[f]||[])[h]:e[u];N!==void 0&&(o=bY(N,u,e,r))!=null&&i.push(o)}(i.length>0||d&&d[f])&&(p={r:l},d&&d[f]&&(x=d[f],x.hidden&&(p.hidden=1),g=-1,x.hpx?g=Lc(x.hpx):x.hpt&&(g=x.hpt),g>-1&&(p.ht=g,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),a[a.length]=_e("row",i.join(""),p))}if(d)for(;f<d.length;++f)d&&d[f]&&(p={r:f+1},x=d[f],x.hidden&&(p.hidden=1),g=-1,x.hpx?g=Lc(x.hpx):x.hpt&&(g=x.hpt),g>-1&&(p.ht=g,p.customHeight=1),x.level&&(p.outlineLevel=x.level),a[a.length]=_e("row","",p));return a.join("")}function CU(e,r,t,n){var a=[tt,_e("worksheet",null,{xmlns:xo[0],"xmlns:r":ut.r})],i=t.SheetNames[e],s=0,o="",u=t.Sheets[i];u==null&&(u={});var l=u["!ref"]||"A1",c=kr(l);if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),l=rt(c)}n||(n={}),u["!comments"]=[];var f=[];fY(u,t,e,r,a),a[a.length]=_e("dimension",null,{ref:l}),a[a.length]=gY(u,r,e,t),r.sheetFormat&&(a[a.length]=_e("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(a[a.length]=vY(u,u["!cols"])),a[s=a.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(o=NY(u,r),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),u["!protect"]&&(a[a.length]=hY(u["!protect"])),u["!autofilter"]!=null&&(a[a.length]=xY(u["!autofilter"],u,t,e)),u["!merges"]!=null&&u["!merges"].length>0&&(a[a.length]=cY(u["!merges"]));var h=-1,d,v=-1;return u["!links"].length>0&&(a[a.length]="<hyperlinks>",u["!links"].forEach(function(p){p[1].Target&&(d={ref:p[0]},p[1].Target.charAt(0)!="#"&&(v=hr(n,-1,pr(p[1].Target).replace(/#.*$/,""),sr.HLINK),d["r:id"]="rId"+v),(h=p[1].Target.indexOf("#"))>-1&&(d.location=pr(p[1].Target.slice(h+1))),p[1].Tooltip&&(d.tooltip=pr(p[1].Tooltip)),a[a.length]=_e("hyperlink",null,d))}),a[a.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(a[a.length]=pY(u["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(a[a.length]=xt("ignoredErrors",_e("ignoredError",null,{numberStoredAsText:1,sqref:l}))),f.length>0&&(v=hr(n,-1,"../drawings/drawing"+(e+1)+".xml",sr.DRAW),a[a.length]=_e("drawing",null,{"r:id":"rId"+v}),u["!drawing"]=f),u["!comments"].length>0&&(v=hr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",sr.VML),a[a.length]=_e("legacyDrawing",null,{"r:id":"rId"+v}),u["!legacy"]=v),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function yY(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=a/20),t}function CY(e,r,t){var n=ce(145),a=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Lc(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,u=n.l;n.l+=4;for(var l={r:e,c:0},c=0;c<16;++c)if(!(r.s.c>c+1<<10||r.e.c<c<<10)){for(var f=-1,h=-1,d=c<<10;d<c+1<<10;++d){l.c=d;var v=Array.isArray(t)?(t[l.r]||[])[l.c]:t[vr(l)];v&&(f<0&&(f=d),h=d)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var p=n.l;return n.l=u,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function EY(e,r,t,n){var a=CY(n,t,r);(a.length>17||(r["!rows"]||[])[n])&&ve(e,0,a)}var wY=vs,_Y=bo;function SY(){}function TY(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=Vz(e),t}function DY(e,r,t){t==null&&(t=ce(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var a=1;a<3;++a)t.write_shift(1,0);return Pc({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),VF(e,t),t.slice(0,t.l)}function AY(e){var r=Cn(e);return[r]}function kY(e,r,t){return t==null&&(t=ce(8)),ds(r,t)}function RY(e){var r=hs(e);return[r]}function OY(e,r,t){return t==null&&(t=ce(4)),ps(r,t)}function FY(e){var r=Cn(e),t=e.read_shift(1);return[r,t,"b"]}function UY(e,r,t){return t==null&&(t=ce(9)),ds(r,t),t.write_shift(1,e.v?1:0),t}function IY(e){var r=hs(e),t=e.read_shift(1);return[r,t,"b"]}function PY(e,r,t){return t==null&&(t=ce(5)),ps(r,t),t.write_shift(1,e.v?1:0),t}function VY(e){var r=Cn(e),t=e.read_shift(1);return[r,t,"e"]}function MY(e,r,t){return t==null&&(t=ce(9)),ds(r,t),t.write_shift(1,e.v),t}function jY(e){var r=hs(e),t=e.read_shift(1);return[r,t,"e"]}function LY(e,r,t){return t==null&&(t=ce(8)),ps(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function BY(e){var r=Cn(e),t=e.read_shift(4);return[r,t,"s"]}function qY(e,r,t){return t==null&&(t=ce(12)),ds(r,t),t.write_shift(4,r.v),t}function HY(e){var r=hs(e),t=e.read_shift(4);return[r,t,"s"]}function zY(e,r,t){return t==null&&(t=ce(8)),ps(r,t),t.write_shift(4,r.v),t}function $Y(e){var r=Cn(e),t=No(e);return[r,t,"n"]}function GY(e,r,t){return t==null&&(t=ce(16)),ds(r,t),ts(e.v,t),t}function WY(e){var r=hs(e),t=No(e);return[r,t,"n"]}function YY(e,r,t){return t==null&&(t=ce(12)),ps(r,t),ts(e.v,t),t}function KY(e){var r=Cn(e),t=MF(e);return[r,t,"n"]}function XY(e,r,t){return t==null&&(t=ce(12)),ds(r,t),jF(e.v,t),t}function QY(e){var r=hs(e),t=MF(e);return[r,t,"n"]}function ZY(e,r,t){return t==null&&(t=ce(8)),ps(r,t),jF(e.v,t),t}function JY(e){var r=Cn(e),t=eN(e);return[r,t,"is"]}function eK(e){var r=Cn(e),t=Tt(e);return[r,t,"str"]}function rK(e,r,t){return t==null&&(t=ce(12+4*e.v.length)),ds(r,t),ft(e.v,t),t.length>t.l?t.slice(0,t.l):t}function tK(e){var r=hs(e),t=Tt(e);return[r,t,"str"]}function nK(e,r,t){return t==null&&(t=ce(8+4*e.v.length)),ps(r,t),ft(e.v,t),t.length>t.l?t.slice(0,t.l):t}function aK(e,r,t){var n=e.l+r,a=Cn(e);a.r=t["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(t.cellFormula){e.l+=2;var o=Df(e,n-e.l,t);s[3]=oo(o,null,a,t.supbooks,t)}else e.l=n;return s}function iK(e,r,t){var n=e.l+r,a=Cn(e);a.r=t["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(t.cellFormula){e.l+=2;var o=Df(e,n-e.l,t);s[3]=oo(o,null,a,t.supbooks,t)}else e.l=n;return s}function sK(e,r,t){var n=e.l+r,a=Cn(e);a.r=t["!row"];var i=No(e),s=[a,i,"n"];if(t.cellFormula){e.l+=2;var o=Df(e,n-e.l,t);s[3]=oo(o,null,a,t.supbooks,t)}else e.l=n;return s}function oK(e,r,t){var n=e.l+r,a=Cn(e);a.r=t["!row"];var i=Tt(e),s=[a,i,"str"];if(t.cellFormula){e.l+=2;var o=Df(e,n-e.l,t);s[3]=oo(o,null,a,t.supbooks,t)}else e.l=n;return s}var lK=vs,uK=bo;function cK(e,r){return r==null&&(r=ce(4)),r.write_shift(4,e),r}function fK(e,r){var t=e.l+r,n=vs(e),a=rN(e),i=Tt(e),s=Tt(e),o=Tt(e);e.l=t;var u={rfx:n,relId:a,loc:i,display:o};return s&&(u.Tooltip=s),u}function mK(e,r){var t=ce(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));bo({s:ct(e[0]),e:ct(e[0])},t),tN("rId"+r,t);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return ft(a||"",t),ft(e[1].Tooltip||"",t),ft("",t),t.slice(0,t.l)}function dK(){}function hK(e,r,t){var n=e.l+r,a=LF(e),i=e.read_shift(1),s=[a];if(s[2]=i,t.cellFormula){var o=tY(e,n-e.l,t);s[1]=o}else e.l=n;return s}function pK(e,r,t){var n=e.l+r,a=vs(e),i=[a];if(t.cellFormula){var s=aY(e,n-e.l,t);i[1]=s,e.l=n}else e.l=n;return i}function vK(e,r,t){t==null&&(t=ce(18));var n=Af(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var a=0;return r.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),r.level&&(a|=r.level<<8),t.write_shift(2,a),t}var EU=["left","right","top","bottom","header","footer"];function xK(e){var r={};return EU.forEach(function(t){r[t]=No(e)}),r}function gK(e,r){return r==null&&(r=ce(48)),yU(e),EU.forEach(function(t){ts(e[t],r)}),r}function bK(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function NK(e,r,t){t==null&&(t=ce(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function yK(e){var r=ce(24);return r.write_shift(4,4),r.write_shift(4,1),bo(e,r),r}function CK(e,r){return r==null&&(r=ce(66)),r.write_shift(2,e.password?aU(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function EK(){}function wK(){}function _K(e,r,t,n,a,i,s){if(r.v===void 0)return!1;var o="";switch(r.t){case"b":o=r.v?"1":"0";break;case"d":r=zt(r),r.z=r.z||qr[14],r.v=Ht(It(r.v)),r.t="n";break;case"n":case"e":o=""+r.v;break;default:o=r.v;break}var u={r:t,c:n};switch(u.s=yi(a.cellXfs,r,a),r.l&&i["!links"].push([vr(u),r.l]),r.c&&i["!comments"].push([vr(u),r.c]),r.t){case"s":case"str":return a.bookSST?(o=lN(a.Strings,r.v,a.revStrings),u.t="s",u.v=o,s?ve(e,18,zY(r,u)):ve(e,7,qY(r,u))):(u.t="str",s?ve(e,17,nK(r,u)):ve(e,6,rK(r,u))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?s?ve(e,13,ZY(r,u)):ve(e,2,XY(r,u)):s?ve(e,16,YY(r,u)):ve(e,5,GY(r,u)),!0;case"b":return u.t="b",s?ve(e,15,PY(r,u)):ve(e,4,UY(r,u)),!0;case"e":return u.t="e",s?ve(e,14,LY(r,u)):ve(e,3,MY(r,u)),!0}return s?ve(e,12,OY(r,u)):ve(e,1,kY(r,u)),!0}function SK(e,r,t,n){var a=kr(r["!ref"]||"A1"),i,s="",o=[];ve(e,145);var u=Array.isArray(r),l=a.e.r;r["!rows"]&&(l=Math.max(a.e.r,r["!rows"].length-1));for(var c=a.s.r;c<=l;++c){s=gt(c),EY(e,r,a,c);var f=!1;if(c<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){c===a.s.r&&(o[h]=St(h)),i=o[h]+s;var d=u?(r[c]||[])[h]:r[i];if(!d){f=!1;continue}f=_K(e,d,c,h,n,r,f)}}ve(e,146)}function TK(e,r){!r||!r["!merges"]||(ve(e,177,cK(r["!merges"].length)),r["!merges"].forEach(function(t){ve(e,176,uK(t))}),ve(e,178))}function DK(e,r){!r||!r["!cols"]||(ve(e,390),r["!cols"].forEach(function(t,n){t&&ve(e,60,vK(n,t))}),ve(e,391))}function AK(e,r){!r||!r["!ref"]||(ve(e,648),ve(e,649,yK(kr(r["!ref"]))),ve(e,650))}function kK(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var a=hr(t,-1,n[1].Target.replace(/#.*$/,""),sr.HLINK);ve(e,494,mK(n,a))}}),delete r["!links"]}function RK(e,r,t,n){if(r["!comments"].length>0){var a=hr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",sr.VML);ve(e,551,tN("rId"+a)),r["!legacy"]=a}}function OK(e,r,t,n){if(r["!autofilter"]){var a=r["!autofilter"],i=typeof a.ref=="string"?a.ref:rt(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,o=ln(i);o.s.r==o.e.r&&(o.e.r=ln(r["!ref"]).e.r,i=rt(o));for(var u=0;u<s.length;++u){var l=s[u];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+t.SheetNames[n]+"'!"+i;break}}u==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),ve(e,161,bo(kr(i))),ve(e,162)}}function FK(e,r,t){ve(e,133),ve(e,137,NK(r,t)),ve(e,138),ve(e,134)}function UK(e,r){r["!protect"]&&ve(e,535,CK(r["!protect"]))}function IK(e,r,t,n){var a=Lt(),i=t.SheetNames[e],s=t.Sheets[i]||{},o=i;try{t&&t.Workbook&&(o=t.Workbook.Sheets[e].CodeName||o)}catch{}var u=kr(s["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(r.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],ve(a,129),(t.vbaraw||s["!outline"])&&ve(a,147,DY(o,s["!outline"])),ve(a,148,_Y(u)),FK(a,s,t.Workbook),DK(a,s),SK(a,s,e,r),UK(a,s),OK(a,s,t,e),TK(a,s),kK(a,s,n),s["!margins"]&&ve(a,476,gK(s["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&AK(a,s),RK(a,s,e,n),ve(a,130),a.end()}function PK(e,r){e.l+=10;var t=Tt(e);return{name:t}}var VK=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function MK(e){return!e.Workbook||!e.Workbook.WBProps?"false":pz(e.Workbook.WBProps.date1904)?"true":"false"}var jK="][*?/\\".split("");function wU(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return jK.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function LK(e,r,t){e.forEach(function(n,a){wU(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(t){var s=r&&r[a]&&r[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function BK(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];LK(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)uY(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}function _U(e){var r=[tt];r[r.length]=_e("workbook",null,{xmlns:xo[0],"xmlns:r":ut.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(VK.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=_e("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(r[r.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),r[r.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:pr(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}r[r.length]=_e("sheet",null,s)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var u={name:o.Name};o.Comment&&(u.comment=o.Comment),o.Sheet!=null&&(u.localSheetId=""+o.Sheet),o.Hidden&&(u.hidden="1"),o.Ref&&(r[r.length]=_e("definedName",pr(o.Ref),u))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function qK(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=e1(e),t.name=Tt(e),t}function HK(e,r){return r||(r=ce(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),tN(e.strRelID,r),ft(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function zK(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?Tt(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function $K(e,r){r||(r=ce(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),VF(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function GK(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),i=Mz(e),s=nY(e,0,t),o=rN(e);e.l=n;var u={Name:i,Ptg:s};return a<268435455&&(u.Sheet=a),o&&(u.Comment=o),u}function WK(e,r){ve(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,a={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};ve(e,156,HK(a))}ve(e,144)}function YK(e,r){r||(r=ce(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return ft("SheetJS",r),ft(Dc.version,r),ft(Dc.version,r),ft("7262",r),r.length>r.l?r.slice(0,r.l):r}function KK(e,r){r||(r=ce(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function XK(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,a=-1,i=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&a==-1?a=n:t[n].Hidden==1&&i==-1&&(i=n);i>a||(ve(e,135),ve(e,158,KK(a)),ve(e,136))}}function QK(e,r){var t=Lt();return ve(t,131),ve(t,128,YK()),ve(t,153,$K(e.Workbook&&e.Workbook.WBProps||null)),XK(t,e),WK(t,e),ve(t,132),t.end()}function ZK(e,r,t){return(r.slice(-4)===".bin"?QK:_U)(e)}function JK(e,r,t,n,a){return(r.slice(-4)===".bin"?IK:CU)(e,t,n,a)}function eX(e,r,t){return(r.slice(-4)===".bin"?gG:oU)(e,t)}function rX(e,r,t){return(r.slice(-4)===".bin"?$$:nU)(e,t)}function tX(e,r,t){return(r.slice(-4)===".bin"?UG:mU)(e)}function nX(e){return(e.slice(-4)===".bin"?SG:cU)()}function aX(e,r){var t=[];return e.Props&&t.push(e$(e.Props,r)),e.Custprops&&t.push(r$(e.Props,e.Custprops)),t.join("")}function iX(){return""}function sX(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,a){var i=[];i.push(_e("NumberFormat",null,{"ss:Format":pr(qr[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};t.push(_e("Style",i.join(""),s))}),_e("Styles",t.join(""))}function SU(e){return _e("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+sN(e.Ref,{r:0,c:0})})}function oX(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var a=r[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||t.push(SU(a)))}return _e("Names",t.join(""))}function lX(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||i.push(SU(o)))}return i.join("")}function uX(e,r,t,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(_e("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(_e("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(_e("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)a.push(_e("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==t&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(xt("ProtectContents","True")),e["!protect"].objects&&a.push(xt("ProtectObjects","True")),e["!protect"].scenarios&&a.push(xt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(xt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(xt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":_e("WorksheetOptions",a.join(""),{xmlns:rn.x})}function cX(e){return e.map(function(r){var t=hz(r.t||""),n=_e("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return _e("Comment",n,{"ss:Author":r.a})}).join("")}function fX(e,r,t,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+pr(sN(e.f,s))),e.F&&e.F.slice(0,r.length)==r){var u=ct(e.F.slice(r.length+1));o["ss:ArrayRange"]="RC:R"+(u.r==s.r?"":"["+(u.r-s.r)+"]")+"C"+(u.c==s.c?"":"["+(u.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=pr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=pr(e.l.Tooltip))),t["!merges"])for(var l=t["!merges"],c=0;c!=l.length;++c)l[c].s.c!=s.c||l[c].s.r!=s.r||(l[c].e.c>l[c].s.c&&(o["ss:MergeAcross"]=l[c].e.c-l[c].s.c),l[c].e.r>l[c].s.r&&(o["ss:MergeDown"]=l[c].e.r-l[c].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=tu[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||qr[14]);break;case"s":f="String",h=dz(e.v||"");break}var d=yi(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=s.c+1;var v=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(e.c||[]).length>0&&(p+=cX(e.c)),_e("Cell",p,o)}function mX(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=sU(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function dX(e,r,t,n){if(!e["!ref"])return"";var a=kr(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(x,g){aN(x);var N=!!x.width,b=Af(g,x),y={"ss:Index":g+1};N&&(y["ss:Width"]=Mc(b.width)),x.hidden&&(y["ss:Hidden"]="1"),o.push(_e("Column",null,y))});for(var u=Array.isArray(e),l=a.s.r;l<=a.e.r;++l){for(var c=[mX(l,(e["!rows"]||[])[l])],f=a.s.c;f<=a.e.c;++f){var h=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>f)&&!(i[s].s.r>l)&&!(i[s].e.c<f)&&!(i[s].e.r<l)){(i[s].s.c!=f||i[s].s.r!=l)&&(h=!0);break}if(!h){var d={r:l,c:f},v=vr(d),p=u?(e[l]||[])[f]:e[v];c.push(fX(p,v,e,r,t,n,d))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function hX(e,r,t){var n=[],a=t.SheetNames[e],i=t.Sheets[a],s=i?lX(i,r,e,t):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?dX(i,r,e,t):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(uX(i,r,e,t)),n.join("")}function pX(e,r){r||(r={}),e.SSF||(e.SSF=zt(qr)),e.SSF&&(wf(),Ef(e.SSF),r.revssf=_f(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],yi(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(aX(e,r)),t.push(iX()),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push(_e("Worksheet",hX(n,r,e),{"ss:Name":pr(e.SheetNames[n])}));return t[2]=sX(e,r),t[3]=oX(e),tt+_e("Workbook",t.join(""),{xmlns:rn.ss,"xmlns:o":rn.o,"xmlns:x":rn.x,"xmlns:ss":rn.ss,"xmlns:dt":rn.dt,"xmlns:html":rn.html})}var fp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function vX(e,r){var t=[],n=[],a=[],i=0,s,o=j_(Z_,"n"),u=j_(J_,"n");if(e.Props)for(s=bt(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?t:Object.prototype.hasOwnProperty.call(u,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=bt(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?t:Object.prototype.hasOwnProperty.call(u,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var l=[];for(i=0;i<a.length;++i)XF.indexOf(a[i][0])>-1||WF.indexOf(a[i][0])>-1||a[i][1]!=null&&l.push(a[i]);n.length&&gr.utils.cfb_add(r,"/SummaryInformation",aS(n,fp.SI,u,J_)),(t.length||l.length)&&gr.utils.cfb_add(r,"/DocumentSummaryInformation",aS(t,fp.DSI,o,Z_,l.length?l:null,fp.UDI))}function xX(e,r){var t=r||{},n=gr.utils.cfb_new({root:"R"}),a="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":a="/Workbook",t.biff=8;break;case"biff5":a="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return gr.utils.cfb_add(n,a,TU(e,t)),t.biff==8&&(e.Props||e.Custprops)&&vX(e,n),t.biff==8&&e.vbaraw&&IG(n,gr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var gX={0:{f:yY},1:{f:AY},2:{f:KY},3:{f:VY},4:{f:FY},5:{f:$Y},6:{f:eK},7:{f:BY},8:{f:oK},9:{f:sK},10:{f:aK},11:{f:iK},12:{f:RY},13:{f:QY},14:{f:jY},15:{f:IY},16:{f:WY},17:{f:tK},18:{f:HY},19:{f:eN},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:GK},40:{},42:{},43:{f:eG},44:{f:Z$},45:{f:nG},46:{f:iG},47:{f:aG},48:{},49:{f:Rz},50:{},51:{f:yG},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:O$},62:{f:JY},63:{f:TG},64:{f:EK},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:oa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:bK},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:TY},148:{f:wY,p:16},151:{f:dK},152:{},153:{f:zK},154:{},155:{},156:{f:qK},157:{},158:{},159:{T:1,f:q$},160:{T:-1},161:{T:1,f:vs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:lK},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bG},336:{T:-1},337:{f:wG,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:e1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:S$},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:hK},427:{f:pK},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xK},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:SY},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:fK},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:e1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:OG},633:{T:1},634:{T:-1},635:{T:1,f:kG},636:{T:-1},637:{f:Iz},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:PK},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:wK},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Se(e,r,t,n){var a=r;if(!isNaN(a)){var i=n||(t||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&Qb(t)&&e.push(t)}}function bX(e,r,t,n){var a=(t||[]).length||0;if(a<=8224)return Se(e,r,t,a);var i=r;if(!isNaN(i)){for(var s=t.parts||[],o=0,u=0,l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;var c=e.next(4);for(c.write_shift(2,i),c.write_shift(2,l),e.push(t.slice(u,u+l)),u+=l;u<a;){for(c=e.next(4),c.write_shift(2,60),l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;c.write_shift(2,l),e.push(t.slice(u,u+l)),u+=l}}}function au(e,r,t){return e||(e=ce(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function NX(e,r,t,n){var a=ce(9);return au(a,e,r),ZF(t,n||"b",a),a}function yX(e,r,t){var n=ce(8+2*t.length);return au(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function CX(e,r,t,n){if(r.v!=null)switch(r.t){case"d":case"n":var a=r.t=="d"?Ht(It(r.v)):r.v;a==(a|0)&&a>=0&&a<65536?Se(e,2,P$(t,n,a)):Se(e,3,I$(t,n,a));return;case"b":case"e":Se(e,5,NX(t,n,r.v,r.t));return;case"s":case"str":Se(e,4,yX(t,n,(r.v||"").slice(0,255)));return}Se(e,1,au(null,t,n))}function EX(e,r,t,n){var a=Array.isArray(r),i=kr(r["!ref"]||"A1"),s,o="",u=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=rt(i)}for(var l=i.s.r;l<=i.e.r;++l){o=gt(l);for(var c=i.s.c;c<=i.e.c;++c){l===i.s.r&&(u[c]=St(c)),s=u[c]+o;var f=a?(r[l]||[])[c]:r[s];f&&CX(e,f,l,c)}}}function wX(e,r){for(var t=r||{},n=Lt(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==t.sheet&&(a=i);if(a==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Se(n,t.biff==4?1033:t.biff==3?521:9,nN(e,16,t)),EX(n,e.Sheets[e.SheetNames[a]],a,t),Se(n,10),n.end()}function _X(e,r,t){Se(e,49,g$({sz:12,name:"Arial"},t))}function SX(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&Se(e,1054,y$(a,r[a],t))})}function TX(e,r){var t=ce(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Se(e,2151,t),t=ce(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),rU(kr(r["!ref"]||"A1"),t),t.write_shift(4,4),Se(e,2152,t)}function DX(e,r){for(var t=0;t<16;++t)Se(e,224,sS({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){Se(e,224,sS(n,0,r))})}function AX(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];Se(e,440,A$(n)),n[1].Tooltip&&Se(e,2048,k$(n))}delete r["!links"]}function kX(e,r){if(r){var t=0;r.forEach(function(n,a){++t<=256&&n&&Se(e,125,F$(Af(a,n),a))})}}function RX(e,r,t,n,a){var i=16+yi(a.cellXfs,r,a);if(r.v==null&&!r.bf){Se(e,513,ns(t,n,i));return}if(r.bf)Se(e,6,rY(r,t,n,a,i));else switch(r.t){case"d":case"n":var s=r.t=="d"?Ht(It(r.v)):r.v;Se(e,515,_$(t,n,s,i));break;case"b":case"e":Se(e,517,w$(t,n,r.v,i,a,r.t));break;case"s":case"str":if(a.bookSST){var o=lN(a.Strings,r.v,a.revStrings);Se(e,253,b$(t,n,o,i))}else Se(e,516,N$(t,n,(r.v||"").slice(0,255),i,a));break;default:Se(e,513,ns(t,n,i))}}function OX(e,r,t){var n=Lt(),a=t.SheetNames[e],i=t.Sheets[a]||{},s=(t||{}).Workbook||{},o=(s.Sheets||[])[e]||{},u=Array.isArray(i),l=r.biff==8,c,f="",h=[],d=kr(i["!ref"]||"A1"),v=l?65536:16384;if(d.e.c>255||d.e.r>=v){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,v-1)}Se(n,2057,nN(t,16,r)),Se(n,13,hn(1)),Se(n,12,hn(100)),Se(n,15,Rt(!0)),Se(n,17,Rt(!1)),Se(n,16,ts(.001)),Se(n,95,Rt(!0)),Se(n,42,Rt(!1)),Se(n,43,Rt(!1)),Se(n,130,hn(1)),Se(n,128,E$()),Se(n,131,Rt(!1)),Se(n,132,Rt(!1)),l&&kX(n,i["!cols"]),Se(n,512,C$(d,r)),l&&(i["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){f=gt(p);for(var x=d.s.c;x<=d.e.c;++x){p===d.s.r&&(h[x]=St(x)),c=h[x]+f;var g=u?(i[p]||[])[x]:i[c];g&&(RX(n,g,p,x,r),l&&g.l&&i["!links"].push([c,g.l]))}}var N=o.CodeName||o.name||a;return l&&Se(n,574,x$((s.Views||[])[0])),l&&(i["!merges"]||[]).length&&Se(n,229,D$(i["!merges"])),l&&AX(n,i),Se(n,442,eU(N)),l&&TX(n,i),Se(n,10),n.end()}function FX(e,r,t){var n=Lt(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=t.biff==8,u=t.biff==5;if(Se(n,2057,nN(e,5,t)),t.bookType=="xla"&&Se(n,135),Se(n,225,o?hn(1200):null),Se(n,193,a$(2)),u&&Se(n,191),u&&Se(n,192),Se(n,226),Se(n,92,d$("SheetJS",t)),Se(n,66,hn(o?1200:1252)),o&&Se(n,353,hn(0)),o&&Se(n,448),Se(n,317,U$(e.SheetNames.length)),o&&e.vbaraw&&Se(n,211),o&&e.vbaraw){var l=s.CodeName||"ThisWorkbook";Se(n,442,eU(l))}Se(n,156,hn(17)),Se(n,25,Rt(!1)),Se(n,18,Rt(!1)),Se(n,19,hn(0)),o&&Se(n,431,Rt(!1)),o&&Se(n,444,hn(0)),Se(n,61,v$()),Se(n,64,Rt(!1)),Se(n,141,hn(0)),Se(n,34,Rt(MK(e)=="true")),Se(n,14,Rt(!0)),o&&Se(n,439,Rt(!1)),Se(n,218,hn(0)),_X(n,e,t),SX(n,e.SSF,t),DX(n,t),o&&Se(n,352,Rt(!1));var c=n.end(),f=Lt();o&&Se(f,140,R$()),o&&t.Strings&&bX(f,252,p$(t.Strings)),Se(f,10);var h=f.end(),d=Lt(),v=0,p=0;for(p=0;p<e.SheetNames.length;++p)v+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var x=c.length+v+h.length;for(p=0;p<e.SheetNames.length;++p){var g=i[p]||{};Se(d,133,h$({pos:x,hs:g.Hidden||0,dt:0,name:e.SheetNames[p]},t)),x+=r[p].length}var N=d.end();if(v!=N.length)throw new Error("BS8 "+v+" != "+N.length);var b=[];return c.length&&b.push(c),N.length&&b.push(N),h.length&&b.push(h),vt(b)}function UX(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=zt(qr)),e&&e.SSF&&(wf(),Ef(e.SSF),t.revssf=_f(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,uN(t),t.cellXfs=[],yi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=OX(a,t,e);return n.unshift(FX(e,n,t)),vt(n)}function TU(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var a=ln(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var i=r||{};switch(i.biff||2){case 8:case 5:return UX(e,r);case 4:case 3:case 2:return wX(e,r)}throw new Error("invalid type "+i.bookType+" for BIFF")}function IX(e,r,t,n){for(var a=e["!merges"]||[],i=[],s=r.s.c;s<=r.e.c;++s){for(var o=0,u=0,l=0;l<a.length;++l)if(!(a[l].s.r>t||a[l].s.c>s)&&!(a[l].e.r<t||a[l].e.c<s)){if(a[l].s.r<t||a[l].s.c<s){o=-1;break}o=a[l].e.r-a[l].s.r+1,u=a[l].e.c-a[l].s.c+1;break}if(!(o<0)){var c=vr({r:t,c:s}),f=n.dense?(e[t]||[])[s]:e[c],h=f&&f.v!=null&&(f.h||mz(f.w||(Pa(f),f.w)||""))||"",d={};o>1&&(d.rowspan=o),u>1&&(d.colspan=u),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+c,i.push(_e("td",h,d))}}var v="<tr>";return v+i.join("")+"</tr>"}var PX='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',VX="</body></html>";function MX(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function DU(e,r){var t=r||{},n=t.header!=null?t.header:PX,a=t.footer!=null?t.footer:VX,i=[n],s=ln(e["!ref"]);t.dense=Array.isArray(e),i.push(MX(e,s,t));for(var o=s.s.r;o<=s.e.r;++o)i.push(IX(e,s,o,t));return i.push("</table>"+a),i.join("")}function AU(e,r,t){var n=t||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?ct(n.origin):n.origin;a=s.r,i=s.c}var o=r.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var c=ln(e["!ref"]);l.s.r=Math.min(l.s.r,c.s.r),l.s.c=Math.min(l.s.c,c.s.c),l.e.r=Math.max(l.e.r,c.e.r),l.e.c=Math.max(l.e.c,c.e.c),a==-1&&(l.e.r=a=c.e.r+1)}var f=[],h=0,d=e["!rows"]||(e["!rows"]=[]),v=0,p=0,x=0,g=0,N=0,b=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&p<u;++v){var y=o[v];if(dS(y)){if(n.display)continue;d[p]={hidden:!0}}var _=y.children;for(x=g=0;x<_.length;++x){var w=_[x];if(!(n.display&&dS(w))){var C=w.hasAttribute("data-v")?w.getAttribute("data-v"):w.hasAttribute("v")?w.getAttribute("v"):vz(w.innerHTML),k=w.getAttribute("data-z")||w.getAttribute("z");for(h=0;h<f.length;++h){var D=f[h];D.s.c==g+i&&D.s.r<p+a&&p+a<=D.e.r&&(g=D.e.c+1-i,h=-1)}b=+w.getAttribute("colspan")||1,((N=+w.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:p+a,c:g+i},e:{r:p+a+(N||1)-1,c:g+i+(b||1)-1}});var U={t:"s",v:C},F=w.getAttribute("data-t")||w.getAttribute("t")||"";C!=null&&(C.length==0?U.t=F||"z":n.raw||C.trim().length==0||F=="s"||(C==="TRUE"?U={t:"b",v:!0}:C==="FALSE"?U={t:"b",v:!1}:isNaN(Sa(C))?isNaN(Dl(C).getDate())||(U={t:"d",v:It(C)},n.cellDates||(U={t:"n",v:Ht(U.v)}),U.z=n.dateNF||qr[14]):U={t:"n",v:Sa(C)})),U.z===void 0&&k!=null&&(U.z=k);var L="",P=w.getElementsByTagName("A");if(P&&P.length)for(var B=0;B<P.length&&!(P[B].hasAttribute("href")&&(L=P[B].getAttribute("href"),L.charAt(0)!="#"));++B);L&&L.charAt(0)!="#"&&(U.l={Target:L}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][g+i]=U):e[vr({c:g+i,r:p+a})]=U,l.e.c<g+i&&(l.e.c=g+i),g+=b}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),l.e.r=Math.max(l.e.r,p-1+a),e["!ref"]=rt(l),p>=u&&(e["!fullref"]=rt((l.e.r=o.length-v+p-1+a,l))),e}function kU(e,r){var t=r||{},n=t.dense?[]:{};return AU(n,e,r)}function jX(e,r){return ms(kU(e,r),r)}function dS(e){var r="",t=LX(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function LX(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var BX=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+kl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return tt+r}})(),hS=(function(){var e=function(i){return pr(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(i,s,o){var u=[];u.push('      <table:table table:name="'+pr(s.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,c=0,f=ln(i["!ref"]||"A1"),h=i["!merges"]||[],d=0,v=Array.isArray(i);if(i["!cols"])for(c=0;c<=f.e.c;++c)u.push("        <table:table-column"+(i["!cols"][c]?' table:style-name="co'+i["!cols"][c].ods+'"':"")+`></table:table-column>
`);var p="",x=i["!rows"]||[];for(l=0;l<f.s.r;++l)p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",u.push("        <table:table-row"+p+`></table:table-row>
`);for(;l<=f.e.r;++l){for(p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",u.push("        <table:table-row"+p+`>
`),c=0;c<f.s.c;++c)u.push(r);for(;c<=f.e.c;++c){var g=!1,N={},b="";for(d=0;d!=h.length;++d)if(!(h[d].s.c>c)&&!(h[d].s.r>l)&&!(h[d].e.c<c)&&!(h[d].e.r<l)){(h[d].s.c!=c||h[d].s.r!=l)&&(g=!0),N["table:number-columns-spanned"]=h[d].e.c-h[d].s.c+1,N["table:number-rows-spanned"]=h[d].e.r-h[d].s.r+1;break}if(g){u.push(t);continue}var y=vr({r:l,c}),_=v?(i[l]||[])[c]:i[y];if(_&&_.f&&(N["table:formula"]=pr(oY(_.f)),_.F&&_.F.slice(0,y.length)==y)){var w=ln(_.F);N["table:number-matrix-columns-spanned"]=w.e.c-w.s.c+1,N["table:number-matrix-rows-spanned"]=w.e.r-w.s.r+1}if(!_){u.push(r);continue}switch(_.t){case"b":b=_.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=_.v?"true":"false";break;case"n":b=_.w||String(_.v||0),N["office:value-type"]="float",N["office:value"]=_.v||0;break;case"s":case"str":b=_.v==null?"":_.v,N["office:value-type"]="string";break;case"d":b=_.w||It(_.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=It(_.v).toISOString(),N["table:style-name"]="ce1";break;default:u.push(r);continue}var C=e(b);if(_.l&&_.l.Target){var k=_.l.Target;k=k.charAt(0)=="#"?"#"+lY(k.slice(1)):k,k.charAt(0)!="#"&&!k.match(/^\w+:/)&&(k="../"+k),C=_e("text:a",C,{"xlink:href":k.replace(/&/g,"&amp;")})}u.push("          "+_e("table:table-cell",_e("text:p",C,{}),N)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var c=0;c<l["!cols"].length;++c)if(l["!cols"][c]){var f=l["!cols"][c];if(f.width==null&&f.wpx==null&&f.wch==null)continue;aN(f),f.ods=o;var h=l["!cols"][c].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var u=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var c=0;c<l["!rows"].length;++c)if(l["!rows"][c]){l["!rows"][c].ods=u;var f=l["!rows"][c].hpx+"px";i.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++u}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var u=[tt],l=kl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=kl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(u.push("<office:document"+l+c+`>
`),u.push($F().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+l+`>
`),a(u,s),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var f=0;f!=s.SheetNames.length;++f)u.push(n(s.Sheets[s.SheetNames[f]],s,f));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),o.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function RU(e,r){if(r.bookType=="fods")return hS(e,r);var t=Wb(),n="",a=[],i=[];return n="mimetype",Je(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Je(t,n,hS(e,r)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Je(t,n,BX(e,r)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Je(t,n,tt+$F()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Je(t,n,Jz(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Je(t,n,Qz(a)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Bc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function qX(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Fn(Al(e))}function HX(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var n=0;n<r.length;++n)if(e[t+n]!=r[n])continue e;return!0}return!1}function mi(e){var r=e.reduce(function(a,i){return a+i.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function zX(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,a=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[r+i]=a&255;e[r+15]|=t>=0?0:128}function Rl(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function dr(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function $s(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function at(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=Rl(e,t),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var u=t[0];e[t[0]++]>=128;);o=e.slice(u,t[0])}break;case 5:s=4,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 1:s=8,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 2:s=Rl(e,t),o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var l={data:o,type:i};r[a]==null?r[a]=[l]:r[a].push(l)}return r}function ht(e){var r=[];return e.forEach(function(t,n){t.forEach(function(a){a.data&&(r.push(dr(n*8+a.type)),a.type==2&&r.push(dr(a.data.length)),r.push(a.data))})}),mi(r)}function _n(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=Rl(e,n),i=at(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:$s(i[1][0].data),messages:[]};i[2].forEach(function(o){var u=at(o.data),l=$s(u[3][0].data);s.messages.push({meta:u,data:e.slice(n[0],n[0]+l)}),n[0]+=l}),(r=i[3])!=null&&r[0]&&(s.merge=$s(i[3][0].data)>>>0>0),t.push(s)}return t}function Ss(e){var r=[];return e.forEach(function(t){var n=[];n[1]=[{data:dr(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:dr(+!!t.merge),type:0}]);var a=[];t.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:dr(s.data.length)}],n[2].push({data:ht(s.meta),type:2})});var i=ht(n);r.push(dr(i.length)),r.push(i),a.forEach(function(s){return r.push(s)})}),mi(r)}function $X(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Rl(r,t),a=[];t[0]<r.length;){var i=r[t[0]]&3;if(i==0){var s=r[t[0]++]>>2;if(s<60)++s;else{var o=s-59;s=r[t[0]],o>1&&(s|=r[t[0]+1]<<8),o>2&&(s|=r[t[0]+2]<<16),o>3&&(s|=r[t[0]+3]<<24),s>>>=0,s++,t[0]+=o}a.push(r.slice(t[0],t[0]+s)),t[0]+=s;continue}else{var u=0,l=0;if(i==1?(l=(r[t[0]]>>2&7)+4,u=(r[t[0]++]&224)<<3,u|=r[t[0]++]):(l=(r[t[0]++]>>2)+1,i==2?(u=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(u=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[mi(a)],u==0)throw new Error("Invalid offset 0");if(u>a[0].length)throw new Error("Invalid offset beyond length");if(l>=u)for(a.push(a[0].slice(-u)),l-=u;l>=a[a.length-1].length;)a.push(a[a.length-1]),l-=a[a.length-1].length;a.push(a[0].slice(-u,-u+l))}}var c=mi(a);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function Sn(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push($X(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return mi(r)}function Ts(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),a=new Uint8Array(4);r.push(a);var i=dr(n),s=i.length;r.push(i),n<=60?(s++,r.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e.slice(t,t+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,t+=n}return mi(r)}function mp(e,r){var t=new Uint8Array(32),n=Bc(t),a=12,i=0;switch(t[0]=5,e.t){case"n":t[1]=2,zX(t,a,e.v),i|=1,a+=16;break;case"b":t[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,n.setUint32(a,r.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),t.slice(0,a)}function dp(e,r){var t=new Uint8Array(32),n=Bc(t),a=12,i=0;switch(t[0]=3,e.t){case"n":t[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":t[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,n.setUint32(a,r.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),t.slice(0,a)}function Ga(e){var r=at(e);return Rl(r[1][0].data)}function GX(e,r,t){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&$s(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var u=0,l=Bc(e[7][0].data),c=0,f=[],h=Bc(e[4][0].data),d=0,v=[],p=0;p<r.length;++p){if(r[p]==null){l.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}l.setUint16(p*2,c,!0),h.setUint16(p*2,d,!0);var x,g;switch(typeof r[p]){case"string":x=mp({t:"s",v:r[p]},t),g=dp({t:"s",v:r[p]},t);break;case"number":x=mp({t:"n",v:r[p]},t),g=dp({t:"n",v:r[p]},t);break;case"boolean":x=mp({t:"b",v:r[p]},t),g=dp({t:"b",v:r[p]},t);break;default:throw new Error("Unsupported value "+r[p])}f.push(x),c+=x.length,v.push(g),d+=g.length,++u}for(e[2][0].data=dr(u);p<e[7][0].data.length/2;++p)l.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=mi(f),e[3][0].data=mi(v),u}function WX(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ln(t["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(rt(n)));var i=qc(t,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(E){return E.forEach(function(V){typeof V=="string"&&s.push(V)})});var o={},u=[],l=gr.read(r.numbers,{type:"base64"});l.FileIndex.map(function(E,V){return[E,l.FullPaths[V]]}).forEach(function(E){var V=E[0],I=E[1];if(V.type==2&&V.name.match(/\.iwa/)){var Y=V.content,ie=Sn(Y),le=_n(ie);le.forEach(function(X){u.push(X.id),o[X.id]={deps:[],location:I,type:$s(X.messages[0].meta[1][0].data)}})}}),u.sort(function(E,V){return E-V});var c=u.filter(function(E){return E>1}).map(function(E){return[E,dr(E)]});l.FileIndex.map(function(E,V){return[E,l.FullPaths[V]]}).forEach(function(E){var V=E[0];if(E[1],!!V.name.match(/\.iwa/)){var I=_n(Sn(V.content));I.forEach(function(Y){Y.messages.forEach(function(ie){c.forEach(function(le){Y.messages.some(function(X){return $s(X.meta[1][0].data)!=11006&&HX(X.data,le[1])})&&o[le[0]].deps.push(Y.id)})})})}});for(var f=gr.find(l,o[1].location),h=_n(Sn(f.content)),d,v=0;v<h.length;++v){var p=h[v];p.id==1&&(d=p)}var x=Ga(at(d.messages[0].data)[1][0].data);for(f=gr.find(l,o[x].location),h=_n(Sn(f.content)),v=0;v<h.length;++v)p=h[v],p.id==x&&(d=p);for(x=Ga(at(d.messages[0].data)[2][0].data),f=gr.find(l,o[x].location),h=_n(Sn(f.content)),v=0;v<h.length;++v)p=h[v],p.id==x&&(d=p);for(x=Ga(at(d.messages[0].data)[2][0].data),f=gr.find(l,o[x].location),h=_n(Sn(f.content)),v=0;v<h.length;++v)p=h[v],p.id==x&&(d=p);var g=at(d.messages[0].data);{g[6][0].data=dr(n.e.r+1),g[7][0].data=dr(n.e.c+1);var N=Ga(g[46][0].data),b=gr.find(l,o[N].location),y=_n(Sn(b.content));{for(var _=0;_<y.length&&y[_].id!=N;++_);if(y[_].id!=N)throw"Bad ColumnRowUIDMapArchive";var w=at(y[_].messages[0].data);w[1]=[],w[2]=[],w[3]=[];for(var C=0;C<=n.e.c;++C){var k=[];k[1]=k[2]=[{type:0,data:dr(C+420690)}],w[1].push({type:2,data:ht(k)}),w[2].push({type:0,data:dr(C)}),w[3].push({type:0,data:dr(C)})}w[4]=[],w[5]=[],w[6]=[];for(var D=0;D<=n.e.r;++D)k=[],k[1]=k[2]=[{type:0,data:dr(D+726270)}],w[4].push({type:2,data:ht(k)}),w[5].push({type:0,data:dr(D)}),w[6].push({type:0,data:dr(D)});y[_].messages[0].data=ht(w)}b.content=Ts(Ss(y)),b.size=b.content.length,delete g[46];var U=at(g[4][0].data);{U[7][0].data=dr(n.e.r+1);var F=at(U[1][0].data),L=Ga(F[2][0].data);b=gr.find(l,o[L].location),y=_n(Sn(b.content));{if(y[0].id!=L)throw"Bad HeaderStorageBucket";var P=at(y[0].messages[0].data);for(D=0;D<i.length;++D){var B=at(P[2][0].data);B[1][0].data=dr(D),B[4][0].data=dr(i[D].length),P[2][D]={type:P[2][0].type,data:ht(B)}}y[0].messages[0].data=ht(P)}b.content=Ts(Ss(y)),b.size=b.content.length;var G=Ga(U[2][0].data);b=gr.find(l,o[G].location),y=_n(Sn(b.content));{if(y[0].id!=G)throw"Bad HeaderStorageBucket";for(P=at(y[0].messages[0].data),C=0;C<=n.e.c;++C)B=at(P[2][0].data),B[1][0].data=dr(C),B[4][0].data=dr(n.e.r+1),P[2][C]={type:P[2][0].type,data:ht(B)};y[0].messages[0].data=ht(P)}b.content=Ts(Ss(y)),b.size=b.content.length;var ue=Ga(U[4][0].data);(function(){for(var E=gr.find(l,o[ue].location),V=_n(Sn(E.content)),I,Y=0;Y<V.length;++Y){var ie=V[Y];ie.id==ue&&(I=ie)}var le=at(I.messages[0].data);{le[3]=[];var X=[];s.forEach(function(ee,Ie){X[1]=[{type:0,data:dr(Ie)}],X[2]=[{type:0,data:dr(1)}],X[3]=[{type:2,data:qX(ee)}],le[3].push({type:2,data:ht(X)})})}I.messages[0].data=ht(le);var Q=Ss(V),be=Ts(Q);E.content=be,E.size=E.content.length})();var oe=at(U[3][0].data);{var he=oe[1][0];delete oe[2];var fe=at(he.data);{var S=Ga(fe[2][0].data);(function(){for(var E=gr.find(l,o[S].location),V=_n(Sn(E.content)),I,Y=0;Y<V.length;++Y){var ie=V[Y];ie.id==S&&(I=ie)}var le=at(I.messages[0].data);{delete le[6],delete oe[7];var X=new Uint8Array(le[5][0].data);le[5]=[];for(var Q=0,be=0;be<=n.e.r;++be){var ee=at(X);Q+=GX(ee,i[be],s),ee[1][0].data=dr(be),le[5].push({data:ht(ee),type:2})}le[1]=[{type:0,data:dr(n.e.c+1)}],le[2]=[{type:0,data:dr(n.e.r+1)}],le[3]=[{type:0,data:dr(Q)}],le[4]=[{type:0,data:dr(n.e.r+1)}]}I.messages[0].data=ht(le);var Ie=Ss(V),Te=Ts(Ie);E.content=Te,E.size=E.content.length})()}he.data=ht(fe)}U[3][0].data=ht(oe)}g[4][0].data=ht(U)}d.messages[0].data=ht(g);var re=Ss(h),T=Ts(re);return f.content=T,f.size=f.content.length,l}function YX(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function uN(e){YX([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function KX(e,r){return r.bookType=="ods"?RU(e,r):r.bookType=="numbers"?WX(e,r):r.bookType=="xlsb"?XX(e,r):QX(e,r)}function XX(e,r){Us=1024,e&&!e.SSF&&(e.SSF=zt(qr)),e&&e.SSF&&(wf(),Ef(e.SSF),r.revssf=_f(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ol?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",n=dU.indexOf(r.bookType)>-1,a=qF();uN(r=r||{});var i=Wb(),s="",o=0;if(r.cellXfs=[],yi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Je(i,s,GF(e.Props,r)),a.coreprops.push(s),hr(r.rels,2,s,sr.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&u.push(e.SheetNames[l]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,Je(i,s,YF(e.Props)),a.extprops.push(s),hr(r.rels,3,s,sr.EXT_PROPS),e.Custprops!==e.Props&&bt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Je(i,s,KF(e.Custprops)),a.custprops.push(s),hr(r.rels,4,s,sr.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var c={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+t,Je(i,s,JK(o-1,s,r,e,c)),a.sheets.push(s),hr(r.wbrels,-1,"worksheets/sheet"+o+"."+t,sr.WS[0])}if(f){var d=f["!comments"],v=!1,p="";d&&d.length>0&&(p="xl/comments"+o+"."+t,Je(i,p,tX(d,p)),a.comments.push(p),hr(c,-1,"../comments"+o+"."+t,sr.CMNT),v=!0),f["!legacy"]&&v&&Je(i,"xl/drawings/vmlDrawing"+o+".vml",fU(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}c["!id"].rId1&&Je(i,zF(s),Hs(c))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+t,Je(i,s,rX(r.Strings,s,r)),a.strs.push(s),hr(r.wbrels,-1,"sharedStrings."+t,sr.SST)),s="xl/workbook."+t,Je(i,s,ZK(e,s)),a.workbooks.push(s),hr(r.rels,1,s,sr.WB),s="xl/theme/theme1.xml",Je(i,s,uU(e.Themes,r)),a.themes.push(s),hr(r.wbrels,-1,"theme/theme1.xml",sr.THEME),s="xl/styles."+t,Je(i,s,eX(e,s,r)),a.styles.push(s),hr(r.wbrels,-1,"styles."+t,sr.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Je(i,s,e.vbaraw),a.vba.push(s),hr(r.wbrels,-1,"vbaProject.bin",sr.VBA)),s="xl/metadata."+t,Je(i,s,nX(s)),a.metadata.push(s),hr(r.wbrels,-1,"metadata."+t,sr.XLMETA),Je(i,"[Content_Types].xml",HF(a,r)),Je(i,"_rels/.rels",Hs(r.rels)),Je(i,"xl/_rels/workbook."+t+".rels",Hs(r.wbrels)),delete r.revssf,delete r.ssf,i}function QX(e,r){Us=1024,e&&!e.SSF&&(e.SSF=zt(qr)),e&&e.SSF&&(wf(),Ef(e.SSF),r.revssf=_f(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ol?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=dU.indexOf(r.bookType)>-1,a=qF();uN(r=r||{});var i=Wb(),s="",o=0;if(r.cellXfs=[],yi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Je(i,s,GF(e.Props,r)),a.coreprops.push(s),hr(r.rels,2,s,sr.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&u.push(e.SheetNames[l]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,Je(i,s,YF(e.Props)),a.extprops.push(s),hr(r.rels,3,s,sr.EXT_PROPS),e.Custprops!==e.Props&&bt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Je(i,s,KF(e.Custprops)),a.custprops.push(s),hr(r.rels,4,s,sr.CUST_PROPS));var c=["SheetJ5"];for(r.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+o+"."+t,Je(i,s,CU(o-1,r,e,f)),a.sheets.push(s),hr(r.wbrels,-1,"worksheets/sheet"+o+"."+t,sr.WS[0])}if(h){var v=h["!comments"],p=!1,x="";if(v&&v.length>0){var g=!1;v.forEach(function(N){N[1].forEach(function(b){b.T==!0&&(g=!0)})}),g&&(x="xl/threadedComments/threadedComment"+o+"."+t,Je(i,x,DG(v,c,r)),a.threadedcomments.push(x),hr(f,-1,"../threadedComments/threadedComment"+o+"."+t,sr.TCMNT)),x="xl/comments"+o+"."+t,Je(i,x,mU(v)),a.comments.push(x),hr(f,-1,"../comments"+o+"."+t,sr.CMNT),p=!0}h["!legacy"]&&p&&Je(i,"xl/drawings/vmlDrawing"+o+".vml",fU(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Je(i,zF(s),Hs(f))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+t,Je(i,s,nU(r.Strings,r)),a.strs.push(s),hr(r.wbrels,-1,"sharedStrings."+t,sr.SST)),s="xl/workbook."+t,Je(i,s,_U(e)),a.workbooks.push(s),hr(r.rels,1,s,sr.WB),s="xl/theme/theme1.xml",Je(i,s,uU(e.Themes,r)),a.themes.push(s),hr(r.wbrels,-1,"theme/theme1.xml",sr.THEME),s="xl/styles."+t,Je(i,s,oU(e,r)),a.styles.push(s),hr(r.wbrels,-1,"styles."+t,sr.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Je(i,s,e.vbaraw),a.vba.push(s),hr(r.wbrels,-1,"vbaProject.bin",sr.VBA)),s="xl/metadata."+t,Je(i,s,cU()),a.metadata.push(s),hr(r.wbrels,-1,"metadata."+t,sr.XLMETA),c.length>1&&(s="xl/persons/person.xml",Je(i,s,AG(c)),a.people.push(s),hr(r.wbrels,-1,"persons/person.xml",sr.PEOPLE)),Je(i,"[Content_Types].xml",HF(a,r)),Je(i,"_rels/.rels",Hs(r.rels)),Je(i,"xl/_rels/workbook."+t+".rels",Hs(r.wbrels)),delete r.revssf,delete r.ssf,i}function ZX(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Ia(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function OU(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return eu(r.file,gr.write(e,{type:cr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return gr.write(e,r)}function JX(e,r){var t=zt(r||{}),n=KX(e,t);return eQ(n,t)}function eQ(e,r){var t={},n=cr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var a=e.FullPaths?gr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof a=="string"){if(r.type=="binary"||r.type=="base64")return a;a=new Uint8Array(Cf(a))}return r.password&&typeof encrypt_agile<"u"?OU(encrypt_agile(a,r.password),r):r.type==="file"?eu(r.file,a):r.type=="string"?nl(a):a}function rQ(e,r){var t=r||{},n=xX(e,t);return OU(n,t)}function Wn(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return Tl(Al(n));case"binary":return Al(n);case"string":return e;case"file":return eu(r.file,n,"utf8");case"buffer":return cr?Ha(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Wn(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function tQ(e,r){switch(r.type){case"base64":return Tl(e);case"binary":return e;case"string":return e;case"file":return eu(r.file,e,"binary");case"buffer":return cr?Ha(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function ju(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?Tl(t):r.type=="string"?nl(t):t;case"file":return eu(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function FU(e,r){kH(),BK(e);var t=zt(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=FU(e,t);return t.type="array",Cf(n)}var a=0;if(t.sheet&&(typeof t.sheet=="number"?a=t.sheet:a=e.SheetNames.indexOf(t.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Wn(pX(e,t),t);case"slk":case"sylk":return Wn(M$.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"htm":case"html":return Wn(DU(e.Sheets[e.SheetNames[a]],t),t);case"txt":return tQ(UU(e.Sheets[e.SheetNames[a]],t),t);case"csv":return Wn(cN(e.Sheets[e.SheetNames[a]],t),t,"\uFEFF");case"dif":return Wn(j$.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"dbf":return ju(V$.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"prn":return Wn(L$.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"rtf":return Wn(W$.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"eth":return Wn(tU.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"fods":return Wn(RU(e,t),t);case"wk1":return ju(oS.sheet_to_wk1(e.Sheets[e.SheetNames[a]],t),t);case"wk3":return ju(oS.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),ju(TU(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),rQ(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return JX(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function nQ(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function aQ(e,r,t){var n={};return n.type="file",n.file=r,nQ(n),FU(e,n)}function iQ(e,r,t,n,a,i,s,o){var u=gt(t),l=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch{h.__rowNum__=t}else h.__rowNum__=t;if(!s||e[t])for(var d=r.s.c;d<=r.e.c;++d){var v=s?e[t][d]:e[n[d]+u];if(v===void 0||v.t===void 0){if(l===void 0)continue;i[d]!=null&&(h[i[d]]=l);continue}var p=v.v;switch(v.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(i[d]!=null){if(p==null)if(v.t=="e"&&p===null)h[i[d]]=null;else if(l!==void 0)h[i[d]]=l;else if(c&&p===null)h[i[d]]=null;else continue;else h[i[d]]=c&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?p:Pa(v,p,o);p!=null&&(f=!1)}}return{row:h,isempty:f}}function qc(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,i=[],s=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},l=r||{},c=l.range!=null?l.range:e["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof c){case"string":u=kr(c);break;case"number":u=kr(e["!ref"]),u.s.r=c;break;default:u=c}n>0&&(a=0);var f=gt(u.s.r),h=[],d=[],v=0,p=0,x=Array.isArray(e),g=u.s.r,N=0,b={};x&&!e[g]&&(e[g]=[]);var y=l.skipHidden&&e["!cols"]||[],_=l.skipHidden&&e["!rows"]||[];for(N=u.s.c;N<=u.e.c;++N)if(!(y[N]||{}).hidden)switch(h[N]=St(N),t=x?e[g][N]:e[h[N]+f],n){case 1:i[N]=N-u.s.c;break;case 2:i[N]=h[N];break;case 3:i[N]=l.header[N-u.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=s=Pa(t,null,l),p=b[s]||0,!p)b[s]=1;else{do o=s+"_"+p++;while(b[o]);b[s]=p,b[o]=1}i[N]=o}for(g=u.s.r+a;g<=u.e.r;++g)if(!(_[g]||{}).hidden){var w=iQ(e,u,g,h,n,i,x,l);(w.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(d[v++]=w.row)}return d.length=v,d}var pS=/"/g;function sQ(e,r,t,n,a,i,s,o){for(var u=!0,l=[],c="",f=gt(t),h=r.s.c;h<=r.e.c;++h)if(n[h]){var d=o.dense?(e[t]||[])[h]:e[n[h]+f];if(d==null)c="";else if(d.v!=null){u=!1,c=""+(o.rawNumbers&&d.t=="n"?d.v:Pa(d,null,o));for(var v=0,p=0;v!==c.length;++v)if((p=c.charCodeAt(v))===a||p===i||p===34||o.forceQuotes){c='"'+c.replace(pS,'""')+'"';break}c=="ID"&&(c='"ID"')}else d.f!=null&&!d.F?(u=!1,c="="+d.f,c.indexOf(",")>=0&&(c='"'+c.replace(pS,'""')+'"')):c="";l.push(c)}return o.blankrows===!1&&u?null:l.join(s)}function cN(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=kr(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,u=o.charCodeAt(0),l=new RegExp((i=="|"?"\\|":i)+"+$"),c="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(h[v]||{}).hidden||(f[v]=St(v));for(var p=0,x=a.s.r;x<=a.e.r;++x)(d[x]||{}).hidden||(c=sQ(e,a,x,f,s,u,i,n),c!=null&&(n.strip&&(c=c.replace(l,"")),(c||n.blankrows!==!1)&&t.push((p++?o:"")+c)));return delete n.dense,t.join("")}function UU(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=cN(e,r);return t}function oQ(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=kr(e["!ref"]),i="",s=[],o,u=[],l=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=St(o);for(var c=a.s.r;c<=a.e.r;++c)for(i=gt(c),o=a.s.c;o<=a.e.c;++o)if(r=s[o]+i,t=l?(e[c]||[])[o]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}u[u.length]=r+"="+n}return u}function IU(e,r,t){var n=t||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?ct(n.origin):n.origin;s=u.r,o=u.c}var l,c={s:{c:0,r:0},e:{c:o,r:s+r.length-1+a}};if(i["!ref"]){var f=kr(i["!ref"]);c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),s==-1&&(s=f.e.r+1,c.e.r=s+r.length-1+a)}else s==-1&&(s=0,c.e.r=r.length-1+a);var h=n.header||[],d=0;r.forEach(function(p,x){bt(p).forEach(function(g){(d=h.indexOf(g))==-1&&(h[d=h.length]=g);var N=p[g],b="z",y="",_=vr({c:o+d,r:s+x+a});l=Ol(i,_),N&&typeof N=="object"&&!(N instanceof Date)?i[_]=N:(typeof N=="number"?b="n":typeof N=="boolean"?b="b":typeof N=="string"?b="s":N instanceof Date?(b="d",n.cellDates||(b="n",N=Ht(N)),y=n.dateNF||qr[14]):N===null&&n.nullError&&(b="e",N=0),l?(l.t=b,l.v=N,delete l.w,delete l.R,y&&(l.z=y)):i[_]=l={t:b,v:N},y&&(l.z=y))})}),c.e.c=Math.max(c.e.c,o+h.length-1);var v=gt(s);if(a)for(d=0;d<h.length;++d)i[St(d+o)+v]={t:"s",v:h[d]};return i["!ref"]=rt(c),i}function lQ(e,r){return IU(null,e,r)}function Ol(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=ct(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Ol(e,vr(r)):Ol(e,vr({r,c:t||0}))}function uQ(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function cQ(){return{SheetNames:[],Sheets:{}}}function fQ(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=s+a)!=-1;++a);}if(wU(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function mQ(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=uQ(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function dQ(e,r){return e.z=r,e}function PU(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function hQ(e,r,t){return PU(e,"#"+r,t)}function pQ(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function vQ(e,r,t,n){for(var a=typeof r!="string"?r:kr(r),i=typeof r=="string"?r:rt(r),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var u=Ol(e,s,o);u.t="n",u.F=i,delete u.v,s==a.s.r&&o==a.s.c&&(u.f=t,n&&(u.D=!0))}return e}var Jn={encode_col:St,encode_row:gt,encode_cell:vr,encode_range:rt,decode_col:Jb,decode_row:Zb,split_cell:kz,decode_cell:ct,decode_range:ln,format_cell:Pa,sheet_add_aoa:PF,sheet_add_json:IU,sheet_add_dom:AU,aoa_to_sheet:go,json_to_sheet:lQ,table_to_sheet:kU,table_to_book:jX,sheet_to_csv:cN,sheet_to_txt:UU,sheet_to_json:qc,sheet_to_html:DU,sheet_to_formulae:oQ,sheet_to_row_object_array:qc,sheet_get_cell:Ol,book_new:cQ,book_append_sheet:fQ,book_set_sheet_visibility:mQ,cell_set_number_format:dQ,cell_set_hyperlink:PU,cell_set_internal_link:hQ,cell_add_comment:pQ,sheet_set_array_formula:vQ,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function xQ(e){const r=Jn.book_new();if(e.options.includeSummary){const a=gQ(e);Jn.book_append_sheet(r,a,"Summary")}if(e.options.includeAllInspections){const a=t1(e.inspections);Jn.book_append_sheet(r,a,"All Inspections")}if(e.options.includeProblemAreas){const a=VU(e.inspections);Jn.book_append_sheet(r,a,"Problem Areas")}if(e.options.includeCustodialNotes){const a=MU(e.custodialNotes);Jn.book_append_sheet(r,a,"Custodial Notes")}const n=`Custodial_Command_Report_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;aQ(r,n)}function gQ(e){const r=qb(e.inspections),t=Hb(e.custodialNotes),n=[["CUSTODIAL COMMAND - EXECUTIVE SUMMARY"],["Generated:",new Date().toLocaleString()],[""],["KEY METRICS"],["Total Inspections:",e.inspections.length],["Critical Issues (Rating < 2.0):",r.critical.length],["Needs Attention (Rating 2.0-3.0):",r.needsAttention.length],["Urgent Custodial Notes:",t.length],["Affected Schools:",r.summary.affectedSchools.length],[""],["SCHOOL PERFORMANCE"],["Most Problematic School:",r.summary.mostProblematicSchool||"N/A"],["Affected Schools:",r.summary.affectedSchools.join(", ")],[""],["SEVERITY BREAKDOWN"],["Critical Issues:",r.critical.length],["Needs Attention:",r.needsAttention.length],["Acceptable Performance:",e.inspections.length-r.summary.totalProblems],[""],["AVERAGE RATINGS BY SCHOOL"]],a=e.inspections.reduce((i,s)=>{const o=fs(s);return o===null||(i[s.school]||(i[s.school]={total:0,count:0}),i[s.school].total+=o,i[s.school].count+=1),i},{});return Object.entries(a).forEach(([i,s])=>{const o=(s.total/s.count).toFixed(2),u=Bb(s.total/s.count);n.push([i,o,u.toUpperCase()])}),Jn.aoa_to_sheet(n)}function t1(e){const r=["ID","Date","School","Type","Room Number","Building Name","Location","Inspector","Average Rating","Severity","Floors","Vertical/Horizontal Surfaces","Ceiling","Restrooms","Customer Satisfaction","Trash","Project Cleaning","Activity Support","Safety & Compliance","Equipment","Monitoring","Notes"],t=e.map(i=>{const s=fs(i),o=s?Bb(s):"N/A";return[i.id,new Date(i.date).toLocaleDateString(),i.school,i.inspectionType==="single_room"?"Single Room":"Whole Building",i.roomNumber||"",i.buildingName||"",i.locationDescription||"",i.inspectorName||"",s?.toFixed(2)||"N/A",o.toUpperCase(),i.floors||"",i.verticalHorizontalSurfaces||"",i.ceiling||"",i.restrooms||"",i.customerSatisfaction||"",i.trash||"",i.projectCleaning||"",i.activitySupport||"",i.safetyCompliance||"",i.equipment||"",i.monitoring||"",i.notes||""]}),n=Jn.aoa_to_sheet([r,...t]),a=[{wch:8},{wch:12},{wch:20},{wch:15},{wch:12},{wch:20},{wch:25},{wch:15},{wch:12},{wch:12},{wch:8},{wch:25},{wch:10},{wch:12},{wch:20},{wch:8},{wch:15},{wch:15},{wch:18},{wch:12},{wch:12},{wch:30}];return n["!cols"]=a,n}function VU(e){const r=qb(e),t=["Severity","School","Location","Date","Rating","Inspector","Type","Floors","Vertical/Horizontal","Ceiling","Restrooms","Customer Satisfaction","Trash","Project Cleaning","Activity Support","Safety & Compliance","Equipment","Monitoring","Notes"],a=[...r.critical,...r.needsAttention].map(o=>{const u=o.inspection;return[o.severity.toUpperCase(),o.school,o.location,new Date(o.date).toLocaleDateString(),o.rating.toFixed(2),u.inspectorName||"",u.inspectionType==="single_room"?"Single Room":"Whole Building",u.floors||"",u.verticalHorizontalSurfaces||"",u.ceiling||"",u.restrooms||"",u.customerSatisfaction||"",u.trash||"",u.projectCleaning||"",u.activitySupport||"",u.safetyCompliance||"",u.equipment||"",u.monitoring||"",u.notes||""]}),i=Jn.aoa_to_sheet([t,...a]),s=[{wch:12},{wch:20},{wch:25},{wch:12},{wch:8},{wch:15},{wch:15},{wch:8},{wch:25},{wch:10},{wch:12},{wch:20},{wch:8},{wch:15},{wch:15},{wch:18},{wch:12},{wch:12},{wch:30}];return i["!cols"]=s,i}function MU(e){const r=Hb(e),t=["Priority","School","Location","Date","Notes","Keywords","Inspector"],n=r.map(s=>{const o=s.note;return[s.severity.toUpperCase(),o.school,o.location,new Date(o.date).toLocaleDateString(),o.notes,s.keywords.join(", "),""]}),a=Jn.aoa_to_sheet([t,...n]),i=[{wch:12},{wch:20},{wch:25},{wch:12},{wch:50},{wch:30},{wch:15}];return a["!cols"]=i,a}function bQ(e,r="inspections"){let t;switch(r){case"inspections":t=t1(e.inspections);break;case"problems":t=VU(e.inspections);break;case"notes":t=MU(e.custodialNotes);break;default:t=t1(e.inspections)}const n=Jn.sheet_to_csv(t),a=new Blob([n],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),s=URL.createObjectURL(a);i.setAttribute("href",s),i.setAttribute("download",`Custodial_Command_${r}_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}function Fl(e){"@babel/helpers - typeof";return Fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Fl(e)}var Ln=Uint8Array,an=Uint16Array,fN=Int32Array,mN=new Ln([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),dN=new Ln([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),vS=new Ln([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),jU=function(e,r){for(var t=new an(31),n=0;n<31;++n)t[n]=r+=1<<e[n-1];for(var a=new fN(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)a[i]=i-t[n]<<5|n;return{b:t,r:a}},LU=jU(mN,2),NQ=LU.b,n1=LU.r;NQ[28]=258,n1[258]=28;var yQ=jU(dN,0),xS=yQ.r,a1=new an(32768);for(var Ar=0;Ar<32768;++Ar){var Wa=(Ar&43690)>>1|(Ar&21845)<<1;Wa=(Wa&52428)>>2|(Wa&13107)<<2,Wa=(Wa&61680)>>4|(Wa&3855)<<4,a1[Ar]=((Wa&65280)>>8|(Wa&255)<<8)>>1}var ll=(function(e,r,t){for(var n=e.length,a=0,i=new an(r);a<n;++a)e[a]&&++i[e[a]-1];var s=new an(r);for(a=1;a<r;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(t){o=new an(1<<r);var u=15-r;for(a=0;a<n;++a)if(e[a])for(var l=a<<4|e[a],c=r-e[a],f=s[e[a]-1]++<<c,h=f|(1<<c)-1;f<=h;++f)o[a1[f]>>u]=l}else for(o=new an(n),a=0;a<n;++a)e[a]&&(o[a]=a1[s[e[a]-1]++]>>15-e[a]);return o}),as=new Ln(288);for(var Ar=0;Ar<144;++Ar)as[Ar]=8;for(var Ar=144;Ar<256;++Ar)as[Ar]=9;for(var Ar=256;Ar<280;++Ar)as[Ar]=7;for(var Ar=280;Ar<288;++Ar)as[Ar]=8;var Hc=new Ln(32);for(var Ar=0;Ar<32;++Ar)Hc[Ar]=5;var CQ=ll(as,9,0),EQ=ll(Hc,5,0),BU=function(e){return(e+7)/8|0},wQ=function(e,r,t){return(t==null||t>e.length)&&(t=e.length),new Ln(e.subarray(r,t))},pa=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8},Mo=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8,e[n+2]|=t>>16},hp=function(e,r){for(var t=[],n=0;n<e.length;++n)e[n]&&t.push({s:n,f:e[n]});var a=t.length,i=t.slice();if(!a)return{t:HU,l:0};if(a==1){var s=new Ln(t[0].s+1);return s[t[0].s]=1,{t:s,l:1}}t.sort(function(_,w){return _.f-w.f}),t.push({s:-1,f:25001});var o=t[0],u=t[1],l=0,c=1,f=2;for(t[0]={s:-1,f:o.f+u.f,l:o,r:u};c!=a-1;)o=t[t[l].f<t[f].f?l++:f++],u=t[l!=c&&t[l].f<t[f].f?l++:f++],t[c++]={s:-1,f:o.f+u.f,l:o,r:u};for(var h=i[0].s,n=1;n<a;++n)i[n].s>h&&(h=i[n].s);var d=new an(h+1),v=i1(t[c-1],d,0);if(v>r){var n=0,p=0,x=v-r,g=1<<x;for(i.sort(function(w,C){return d[C.s]-d[w.s]||w.f-C.f});n<a;++n){var N=i[n].s;if(d[N]>r)p+=g-(1<<v-d[N]),d[N]=r;else break}for(p>>=x;p>0;){var b=i[n].s;d[b]<r?p-=1<<r-d[b]++-1:++n}for(;n>=0&&p;--n){var y=i[n].s;d[y]==r&&(--d[y],++p)}v=r}return{t:new Ln(d),l:v}},i1=function(e,r,t){return e.s==-1?Math.max(i1(e.l,r,t+1),i1(e.r,r,t+1)):r[e.s]=t},gS=function(e){for(var r=e.length;r&&!e[--r];);for(var t=new an(++r),n=0,a=e[0],i=1,s=function(u){t[n++]=u},o=1;o<=r;++o)if(e[o]==a&&o!=r)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[o]}return{c:t.subarray(0,n),n:r}},jo=function(e,r){for(var t=0,n=0;n<r.length;++n)t+=e[n]*r[n];return t},qU=function(e,r,t){var n=t.length,a=BU(r+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=t[i];return(a+4+n)*8},bS=function(e,r,t,n,a,i,s,o,u,l,c){pa(r,c++,t),++a[256];for(var f=hp(a,15),h=f.t,d=f.l,v=hp(i,15),p=v.t,x=v.l,g=gS(h),N=g.c,b=g.n,y=gS(p),_=y.c,w=y.n,C=new an(19),k=0;k<N.length;++k)++C[N[k]&31];for(var k=0;k<_.length;++k)++C[_[k]&31];for(var D=hp(C,7),U=D.t,F=D.l,L=19;L>4&&!U[vS[L-1]];--L);var P=l+5<<3,B=jo(a,as)+jo(i,Hc)+s,G=jo(a,h)+jo(i,p)+s+14+3*L+jo(C,U)+2*C[16]+3*C[17]+7*C[18];if(u>=0&&P<=B&&P<=G)return qU(r,c,e.subarray(u,u+l));var ue,oe,he,fe;if(pa(r,c,1+(G<B)),c+=2,G<B){ue=ll(h,d,0),oe=h,he=ll(p,x,0),fe=p;var S=ll(U,F,0);pa(r,c,b-257),pa(r,c+5,w-1),pa(r,c+10,L-4),c+=14;for(var k=0;k<L;++k)pa(r,c+3*k,U[vS[k]]);c+=3*L;for(var re=[N,_],T=0;T<2;++T)for(var E=re[T],k=0;k<E.length;++k){var V=E[k]&31;pa(r,c,S[V]),c+=U[V],V>15&&(pa(r,c,E[k]>>5&127),c+=E[k]>>12)}}else ue=CQ,oe=as,he=EQ,fe=Hc;for(var k=0;k<o;++k){var I=n[k];if(I>255){var V=I>>18&31;Mo(r,c,ue[V+257]),c+=oe[V+257],V>7&&(pa(r,c,I>>23&31),c+=mN[V]);var Y=I&31;Mo(r,c,he[Y]),c+=fe[Y],Y>3&&(Mo(r,c,I>>5&8191),c+=dN[Y])}else Mo(r,c,ue[I]),c+=oe[I]}return Mo(r,c,ue[256]),c+oe[256]},_Q=new fN([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),HU=new Ln(0),SQ=function(e,r,t,n,a,i){var s=i.z||e.length,o=new Ln(n+s+5*(1+Math.ceil(s/7e3))+a),u=o.subarray(n,o.length-a),l=i.l,c=(i.r||0)&7;if(r){c&&(u[0]=i.r>>3);for(var f=_Q[r-1],h=f>>13,d=f&8191,v=(1<<t)-1,p=i.p||new an(32768),x=i.h||new an(v+1),g=Math.ceil(t/3),N=2*g,b=function(Te){return(e[Te]^e[Te+1]<<g^e[Te+2]<<N)&v},y=new fN(25e3),_=new an(288),w=new an(32),C=0,k=0,D=i.i||0,U=0,F=i.w||0,L=0;D+2<s;++D){var P=b(D),B=D&32767,G=x[P];if(p[B]=G,x[P]=B,F<=D){var ue=s-D;if((C>7e3||U>24576)&&(ue>423||!l)){c=bS(e,u,0,y,_,w,k,U,L,D-L,c),U=C=k=0,L=D;for(var oe=0;oe<286;++oe)_[oe]=0;for(var oe=0;oe<30;++oe)w[oe]=0}var he=2,fe=0,S=d,re=B-G&32767;if(ue>2&&P==b(D-re))for(var T=Math.min(h,ue)-1,E=Math.min(32767,D),V=Math.min(258,ue);re<=E&&--S&&B!=G;){if(e[D+he]==e[D+he-re]){for(var I=0;I<V&&e[D+I]==e[D+I-re];++I);if(I>he){if(he=I,fe=re,I>T)break;for(var Y=Math.min(re,I-2),ie=0,oe=0;oe<Y;++oe){var le=D-re+oe&32767,X=p[le],Q=le-X&32767;Q>ie&&(ie=Q,G=le)}}}B=G,G=p[B],re+=B-G&32767}if(fe){y[U++]=268435456|n1[he]<<18|xS[fe];var be=n1[he]&31,ee=xS[fe]&31;k+=mN[be]+dN[ee],++_[257+be],++w[ee],F=D+he,++C}else y[U++]=e[D],++_[e[D]]}}for(D=Math.max(D,F);D<s;++D)y[U++]=e[D],++_[e[D]];c=bS(e,u,l,y,_,w,k,U,L,D-L,c),l||(i.r=c&7|u[c/8|0]<<3,c-=7,i.h=x,i.p=p,i.i=D,i.w=F)}else{for(var D=i.w||0;D<s+l;D+=65535){var Ie=D+65535;Ie>=s&&(u[c/8|0]=l,Ie=s),c=qU(u,c+1,e.subarray(D,Ie))}i.i=s}return wQ(o,0,n+BU(c)+a)},zU=function(){var e=1,r=0;return{p:function(t){for(var n=e,a=r,i=t.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=t[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,r=a},d:function(){return e%=65521,r%=65521,(e&255)<<24|(e&65280)<<8|(r&255)<<8|r>>8}}},TQ=function(e,r,t,n,a){if(!a&&(a={l:1},r.dictionary)){var i=r.dictionary.subarray(-32768),s=new Ln(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return SQ(e,r.level==null?6:r.level,r.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+r.mem,t,n,a)},$U=function(e,r,t){for(;t;++r)e[r]=t,t>>>=8},DQ=function(e,r){var t=r.level,n=t==0?0:t<6?1:t==9?3:2;if(e[0]=120,e[1]=n<<6|(r.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,r.dictionary){var a=zU();a.p(r.dictionary),$U(e,2,a.d())}};function rue(e,r){r||(r={});var t=zU();t.p(e);var n=TQ(e,r,r.dictionary?6:2,4);return DQ(n,r),$U(n,n.length-4,t.d()),n}var AQ=typeof TextDecoder<"u"&&new TextDecoder,kQ=0;try{AQ.decode(HU,{stream:!0}),kQ=1}catch{}function RQ(e){if(Array.isArray(e))return e}function OQ(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n,a,i,s,o=[],u=!0,l=!1;try{if(i=(t=t.call(e)).next,r!==0)for(;!(u=(n=i.call(t)).done)&&(o.push(n.value),o.length!==r);u=!0);}catch(c){l=!0,a=c}finally{try{if(!u&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(l)throw a}}return o}}function NS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function FQ(e,r){if(e){if(typeof e=="string")return NS(e,r);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?NS(e,r):void 0}}function UQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tue(e,r){return RQ(e)||OQ(e,r)||FQ(e,r)||UQ()}function yS(e,r="utf8"){return new TextDecoder(r).decode(e)}const IQ=new TextEncoder;function PQ(e){return IQ.encode(e)}const VQ=1024*8,MQ=(()=>{const e=new Uint8Array(4),r=new Uint32Array(e.buffer);return!((r[0]=1)&e[0])})(),pp={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class hN{constructor(r=VQ,t={}){er(this,"buffer");er(this,"byteLength");er(this,"byteOffset");er(this,"length");er(this,"offset");er(this,"lastWrittenByte");er(this,"littleEndian");er(this,"_data");er(this,"_mark");er(this,"_marks");let n=!1;typeof r=="number"?r=new ArrayBuffer(r):(n=!0,this.lastWrittenByte=r.byteLength);const a=t.offset?t.offset>>>0:0,i=r.byteLength-a;let s=a;(ArrayBuffer.isView(r)||r instanceof hN)&&(r.byteLength!==r.buffer.byteLength&&(s=r.byteOffset+a),r=r.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=r,this.length=i,this.byteLength=i,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,i),this._mark=0,this._marks=[]}available(r=1){return this.offset+r<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(r=1){return this.offset+=r,this}back(r=1){return this.offset-=r,this}seek(r){return this.offset=r,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const r=this._marks.pop();if(r===void 0)throw new Error("Mark stack empty");return this.seek(r),this}rewind(){return this.offset=0,this}ensureAvailable(r=1){if(!this.available(r)){const n=(this.offset+r)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(r=1){return this.readArray(r,"uint8")}readArray(r,t){const n=pp[t].BYTES_PER_ELEMENT*r,a=this.byteOffset+this.offset,i=this.buffer.slice(a,a+n);if(this.littleEndian===MQ&&t!=="uint8"&&t!=="int8"){const o=new Uint8Array(this.buffer.slice(a,a+n));o.reverse();const u=new pp[t](o.buffer);return this.offset+=n,u.reverse(),u}const s=new pp[t](i);return this.offset+=n,s}readInt16(){const r=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,r}readUint16(){const r=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,r}readInt32(){const r=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,r}readUint32(){const r=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat32(){const r=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat64(){const r=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,r}readBigInt64(){const r=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,r}readBigUint64(){const r=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,r}readChar(){return String.fromCharCode(this.readInt8())}readChars(r=1){let t="";for(let n=0;n<r;n++)t+=this.readChar();return t}readUtf8(r=1){return yS(this.readBytes(r))}decodeText(r=1,t="utf8"){return yS(this.readBytes(r),t)}writeBoolean(r){return this.writeUint8(r?255:0),this}writeInt8(r){return this.ensureAvailable(1),this._data.setInt8(this.offset++,r),this._updateLastWrittenByte(),this}writeUint8(r){return this.ensureAvailable(1),this._data.setUint8(this.offset++,r),this._updateLastWrittenByte(),this}writeByte(r){return this.writeUint8(r)}writeBytes(r){this.ensureAvailable(r.length);for(let t=0;t<r.length;t++)this._data.setUint8(this.offset++,r[t]);return this._updateLastWrittenByte(),this}writeInt16(r){return this.ensureAvailable(2),this._data.setInt16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(r){return this.ensureAvailable(2),this._data.setUint16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(r){return this.ensureAvailable(4),this._data.setInt32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(r){return this.ensureAvailable(4),this._data.setUint32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(r){return this.ensureAvailable(4),this._data.setFloat32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(r){return this.ensureAvailable(8),this._data.setFloat64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(r){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(r){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(r){return this.writeUint8(r.charCodeAt(0))}writeChars(r){for(let t=0;t<r.length;t++)this.writeUint8(r.charCodeAt(t));return this}writeUtf8(r){return this.writeBytes(PQ(r))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function yo(e){let r=e.length;for(;--r>=0;)e[r]=0}const jQ=3,LQ=258,GU=29,BQ=256,qQ=BQ+1+GU,WU=30,HQ=512,zQ=new Array((qQ+2)*2);yo(zQ);const $Q=new Array(WU*2);yo($Q);const GQ=new Array(HQ);yo(GQ);const WQ=new Array(LQ-jQ+1);yo(WQ);const YQ=new Array(GU);yo(YQ);const KQ=new Array(WU);yo(KQ);const XQ=(e,r,t,n)=>{let a=e&65535|0,i=e>>>16&65535|0,s=0;for(;t!==0;){s=t>2e3?2e3:t,t-=s;do a=a+r[n++]|0,i=i+a|0;while(--s);a%=65521,i%=65521}return a|i<<16|0};var s1=XQ;const QQ=()=>{let e,r=[];for(var t=0;t<256;t++){e=t;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r},ZQ=new Uint32Array(QQ()),JQ=(e,r,t,n)=>{const a=ZQ,i=n+t;e^=-1;for(let s=n;s<i;s++)e=e>>>8^a[(e^r[s])&255];return e^-1};var $n=JQ,o1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},YU={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const eZ=(e,r)=>Object.prototype.hasOwnProperty.call(e,r);var rZ=function(e){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const t=r.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)eZ(t,n)&&(e[n]=t[n])}}return e},tZ=e=>{let r=0;for(let n=0,a=e.length;n<a;n++)r+=e[n].length;const t=new Uint8Array(r);for(let n=0,a=0,i=e.length;n<i;n++){let s=e[n];t.set(s,a),a+=s.length}return t},KU={assign:rZ,flattenChunks:tZ};let XU=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{XU=!1}const Ul=new Uint8Array(256);for(let e=0;e<256;e++)Ul[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Ul[254]=Ul[254]=1;var nZ=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let r,t,n,a,i,s=e.length,o=0;for(a=0;a<s;a++)t=e.charCodeAt(a),(t&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),a++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(r=new Uint8Array(o),i=0,a=0;i<o;a++)t=e.charCodeAt(a),(t&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),a++)),t<128?r[i++]=t:t<2048?(r[i++]=192|t>>>6,r[i++]=128|t&63):t<65536?(r[i++]=224|t>>>12,r[i++]=128|t>>>6&63,r[i++]=128|t&63):(r[i++]=240|t>>>18,r[i++]=128|t>>>12&63,r[i++]=128|t>>>6&63,r[i++]=128|t&63);return r};const aZ=(e,r)=>{if(r<65534&&e.subarray&&XU)return String.fromCharCode.apply(null,e.length===r?e:e.subarray(0,r));let t="";for(let n=0;n<r;n++)t+=String.fromCharCode(e[n]);return t};var iZ=(e,r)=>{const t=r||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,r));let n,a;const i=new Array(t*2);for(a=0,n=0;n<t;){let s=e[n++];if(s<128){i[a++]=s;continue}let o=Ul[s];if(o>4){i[a++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<t;)s=s<<6|e[n++]&63,o--;if(o>1){i[a++]=65533;continue}s<65536?i[a++]=s:(s-=65536,i[a++]=55296|s>>10&1023,i[a++]=56320|s&1023)}return aZ(i,a)},sZ=(e,r)=>{r=r||e.length,r>e.length&&(r=e.length);let t=r-1;for(;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?r:t+Ul[e[t]]>r?t:r},l1={string2buf:nZ,buf2string:iZ,utf8border:sZ};function oZ(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var lZ=oZ;const Lu=16209,uZ=16191;var cZ=function(r,t){let n,a,i,s,o,u,l,c,f,h,d,v,p,x,g,N,b,y,_,w,C,k,D,U;const F=r.state;n=r.next_in,D=r.input,a=n+(r.avail_in-5),i=r.next_out,U=r.output,s=i-(t-r.avail_out),o=i+(r.avail_out-257),u=F.dmax,l=F.wsize,c=F.whave,f=F.wnext,h=F.window,d=F.hold,v=F.bits,p=F.lencode,x=F.distcode,g=(1<<F.lenbits)-1,N=(1<<F.distbits)-1;e:do{v<15&&(d+=D[n++]<<v,v+=8,d+=D[n++]<<v,v+=8),b=p[d&g];r:for(;;){if(y=b>>>24,d>>>=y,v-=y,y=b>>>16&255,y===0)U[i++]=b&65535;else if(y&16){_=b&65535,y&=15,y&&(v<y&&(d+=D[n++]<<v,v+=8),_+=d&(1<<y)-1,d>>>=y,v-=y),v<15&&(d+=D[n++]<<v,v+=8,d+=D[n++]<<v,v+=8),b=x[d&N];t:for(;;){if(y=b>>>24,d>>>=y,v-=y,y=b>>>16&255,y&16){if(w=b&65535,y&=15,v<y&&(d+=D[n++]<<v,v+=8,v<y&&(d+=D[n++]<<v,v+=8)),w+=d&(1<<y)-1,w>u){r.msg="invalid distance too far back",F.mode=Lu;break e}if(d>>>=y,v-=y,y=i-s,w>y){if(y=w-y,y>c&&F.sane){r.msg="invalid distance too far back",F.mode=Lu;break e}if(C=0,k=h,f===0){if(C+=l-y,y<_){_-=y;do U[i++]=h[C++];while(--y);C=i-w,k=U}}else if(f<y){if(C+=l+f-y,y-=f,y<_){_-=y;do U[i++]=h[C++];while(--y);if(C=0,f<_){y=f,_-=y;do U[i++]=h[C++];while(--y);C=i-w,k=U}}}else if(C+=f-y,y<_){_-=y;do U[i++]=h[C++];while(--y);C=i-w,k=U}for(;_>2;)U[i++]=k[C++],U[i++]=k[C++],U[i++]=k[C++],_-=3;_&&(U[i++]=k[C++],_>1&&(U[i++]=k[C++]))}else{C=i-w;do U[i++]=U[C++],U[i++]=U[C++],U[i++]=U[C++],_-=3;while(_>2);_&&(U[i++]=U[C++],_>1&&(U[i++]=U[C++]))}}else if((y&64)===0){b=x[(b&65535)+(d&(1<<y)-1)];continue t}else{r.msg="invalid distance code",F.mode=Lu;break e}break}}else if((y&64)===0){b=p[(b&65535)+(d&(1<<y)-1)];continue r}else if(y&32){F.mode=uZ;break e}else{r.msg="invalid literal/length code",F.mode=Lu;break e}break}}while(n<a&&i<o);_=v>>3,n-=_,v-=_<<3,d&=(1<<v)-1,r.next_in=n,r.next_out=i,r.avail_in=n<a?5+(a-n):5-(n-a),r.avail_out=i<o?257+(o-i):257-(i-o),F.hold=d,F.bits=v};const Ds=15,CS=852,ES=592,wS=0,vp=1,_S=2,fZ=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),mZ=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dZ=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),hZ=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),pZ=(e,r,t,n,a,i,s,o)=>{const u=o.bits;let l=0,c=0,f=0,h=0,d=0,v=0,p=0,x=0,g=0,N=0,b,y,_,w,C,k=null,D;const U=new Uint16Array(Ds+1),F=new Uint16Array(Ds+1);let L=null,P,B,G;for(l=0;l<=Ds;l++)U[l]=0;for(c=0;c<n;c++)U[r[t+c]]++;for(d=u,h=Ds;h>=1&&U[h]===0;h--);if(d>h&&(d=h),h===0)return a[i++]=1<<24|64<<16|0,a[i++]=1<<24|64<<16|0,o.bits=1,0;for(f=1;f<h&&U[f]===0;f++);for(d<f&&(d=f),x=1,l=1;l<=Ds;l++)if(x<<=1,x-=U[l],x<0)return-1;if(x>0&&(e===wS||h!==1))return-1;for(F[1]=0,l=1;l<Ds;l++)F[l+1]=F[l]+U[l];for(c=0;c<n;c++)r[t+c]!==0&&(s[F[r[t+c]]++]=c);if(e===wS?(k=L=s,D=20):e===vp?(k=fZ,L=mZ,D=257):(k=dZ,L=hZ,D=0),N=0,c=0,l=f,C=i,v=d,p=0,_=-1,g=1<<d,w=g-1,e===vp&&g>CS||e===_S&&g>ES)return 1;for(;;){P=l-p,s[c]+1<D?(B=0,G=s[c]):s[c]>=D?(B=L[s[c]-D],G=k[s[c]-D]):(B=96,G=0),b=1<<l-p,y=1<<v,f=y;do y-=b,a[C+(N>>p)+y]=P<<24|B<<16|G|0;while(y!==0);for(b=1<<l-1;N&b;)b>>=1;if(b!==0?(N&=b-1,N+=b):N=0,c++,--U[l]===0){if(l===h)break;l=r[t+s[c]]}if(l>d&&(N&w)!==_){for(p===0&&(p=d),C+=f,v=l-p,x=1<<v;v+p<h&&(x-=U[v+p],!(x<=0));)v++,x<<=1;if(g+=1<<v,e===vp&&g>CS||e===_S&&g>ES)return 1;_=N&w,a[_]=d<<24|v<<16|C-i|0}}return N!==0&&(a[C+N]=l-p<<24|64<<16|0),o.bits=d,0};var ul=pZ;const vZ=0,QU=1,ZU=2,{Z_FINISH:SS,Z_BLOCK:xZ,Z_TREES:Bu,Z_OK:is,Z_STREAM_END:gZ,Z_NEED_DICT:bZ,Z_STREAM_ERROR:Nn,Z_DATA_ERROR:JU,Z_MEM_ERROR:eI,Z_BUF_ERROR:NZ,Z_DEFLATED:TS}=YU,kf=16180,DS=16181,AS=16182,kS=16183,RS=16184,OS=16185,FS=16186,US=16187,IS=16188,PS=16189,zc=16190,va=16191,xp=16192,VS=16193,gp=16194,MS=16195,jS=16196,LS=16197,BS=16198,qu=16199,Hu=16200,qS=16201,HS=16202,zS=16203,$S=16204,GS=16205,bp=16206,WS=16207,YS=16208,Rr=16209,rI=16210,tI=16211,yZ=852,CZ=592,EZ=15,wZ=EZ,KS=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function _Z(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const xs=e=>{if(!e)return 1;const r=e.state;return!r||r.strm!==e||r.mode<kf||r.mode>tI?1:0},nI=e=>{if(xs(e))return Nn;const r=e.state;return e.total_in=e.total_out=r.total=0,e.msg="",r.wrap&&(e.adler=r.wrap&1),r.mode=kf,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(yZ),r.distcode=r.distdyn=new Int32Array(CZ),r.sane=1,r.back=-1,is},aI=e=>{if(xs(e))return Nn;const r=e.state;return r.wsize=0,r.whave=0,r.wnext=0,nI(e)},iI=(e,r)=>{let t;if(xs(e))return Nn;const n=e.state;return r<0?(t=0,r=-r):(t=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?Nn:(n.window!==null&&n.wbits!==r&&(n.window=null),n.wrap=t,n.wbits=r,aI(e))},sI=(e,r)=>{if(!e)return Nn;const t=new _Z;e.state=t,t.strm=e,t.window=null,t.mode=kf;const n=iI(e,r);return n!==is&&(e.state=null),n},SZ=e=>sI(e,wZ);let XS=!0,Np,yp;const TZ=e=>{if(XS){Np=new Int32Array(512),yp=new Int32Array(32);let r=0;for(;r<144;)e.lens[r++]=8;for(;r<256;)e.lens[r++]=9;for(;r<280;)e.lens[r++]=7;for(;r<288;)e.lens[r++]=8;for(ul(QU,e.lens,0,288,Np,0,e.work,{bits:9}),r=0;r<32;)e.lens[r++]=5;ul(ZU,e.lens,0,32,yp,0,e.work,{bits:5}),XS=!1}e.lencode=Np,e.lenbits=9,e.distcode=yp,e.distbits=5},oI=(e,r,t,n)=>{let a;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(r.subarray(t-i.wsize,t),0),i.wnext=0,i.whave=i.wsize):(a=i.wsize-i.wnext,a>n&&(a=n),i.window.set(r.subarray(t-n,t-n+a),i.wnext),n-=a,n?(i.window.set(r.subarray(t-n,t),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},DZ=(e,r)=>{let t,n,a,i,s,o,u,l,c,f,h,d,v,p,x=0,g,N,b,y,_,w,C,k;const D=new Uint8Array(4);let U,F;const L=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(xs(e)||!e.output||!e.input&&e.avail_in!==0)return Nn;t=e.state,t.mode===va&&(t.mode=xp),s=e.next_out,a=e.output,u=e.avail_out,i=e.next_in,n=e.input,o=e.avail_in,l=t.hold,c=t.bits,f=o,h=u,k=is;e:for(;;)switch(t.mode){case kf:if(t.wrap===0){t.mode=xp;break}for(;c<16;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}if(t.wrap&2&&l===35615){t.wbits===0&&(t.wbits=15),t.check=0,D[0]=l&255,D[1]=l>>>8&255,t.check=$n(t.check,D,2,0),l=0,c=0,t.mode=DS;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){e.msg="incorrect header check",t.mode=Rr;break}if((l&15)!==TS){e.msg="unknown compression method",t.mode=Rr;break}if(l>>>=4,c-=4,C=(l&15)+8,t.wbits===0&&(t.wbits=C),C>15||C>t.wbits){e.msg="invalid window size",t.mode=Rr;break}t.dmax=1<<t.wbits,t.flags=0,e.adler=t.check=1,t.mode=l&512?PS:va,l=0,c=0;break;case DS:for(;c<16;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}if(t.flags=l,(t.flags&255)!==TS){e.msg="unknown compression method",t.mode=Rr;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=Rr;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&t.wrap&4&&(D[0]=l&255,D[1]=l>>>8&255,t.check=$n(t.check,D,2,0)),l=0,c=0,t.mode=AS;case AS:for(;c<32;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}t.head&&(t.head.time=l),t.flags&512&&t.wrap&4&&(D[0]=l&255,D[1]=l>>>8&255,D[2]=l>>>16&255,D[3]=l>>>24&255,t.check=$n(t.check,D,4,0)),l=0,c=0,t.mode=kS;case kS:for(;c<16;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&t.wrap&4&&(D[0]=l&255,D[1]=l>>>8&255,t.check=$n(t.check,D,2,0)),l=0,c=0,t.mode=RS;case RS:if(t.flags&1024){for(;c<16;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&t.wrap&4&&(D[0]=l&255,D[1]=l>>>8&255,t.check=$n(t.check,D,2,0)),l=0,c=0}else t.head&&(t.head.extra=null);t.mode=OS;case OS:if(t.flags&1024&&(d=t.length,d>o&&(d=o),d&&(t.head&&(C=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(i,i+d),C)),t.flags&512&&t.wrap&4&&(t.check=$n(t.check,n,d,i)),o-=d,i+=d,t.length-=d),t.length))break e;t.length=0,t.mode=FS;case FS:if(t.flags&2048){if(o===0)break e;d=0;do C=n[i+d++],t.head&&C&&t.length<65536&&(t.head.name+=String.fromCharCode(C));while(C&&d<o);if(t.flags&512&&t.wrap&4&&(t.check=$n(t.check,n,d,i)),o-=d,i+=d,C)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=US;case US:if(t.flags&4096){if(o===0)break e;d=0;do C=n[i+d++],t.head&&C&&t.length<65536&&(t.head.comment+=String.fromCharCode(C));while(C&&d<o);if(t.flags&512&&t.wrap&4&&(t.check=$n(t.check,n,d,i)),o-=d,i+=d,C)break e}else t.head&&(t.head.comment=null);t.mode=IS;case IS:if(t.flags&512){for(;c<16;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}if(t.wrap&4&&l!==(t.check&65535)){e.msg="header crc mismatch",t.mode=Rr;break}l=0,c=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=va;break;case PS:for(;c<32;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}e.adler=t.check=KS(l),l=0,c=0,t.mode=zc;case zc:if(t.havedict===0)return e.next_out=s,e.avail_out=u,e.next_in=i,e.avail_in=o,t.hold=l,t.bits=c,bZ;e.adler=t.check=1,t.mode=va;case va:if(r===xZ||r===Bu)break e;case xp:if(t.last){l>>>=c&7,c-=c&7,t.mode=bp;break}for(;c<3;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}switch(t.last=l&1,l>>>=1,c-=1,l&3){case 0:t.mode=VS;break;case 1:if(TZ(t),t.mode=qu,r===Bu){l>>>=2,c-=2;break e}break;case 2:t.mode=jS;break;case 3:e.msg="invalid block type",t.mode=Rr}l>>>=2,c-=2;break;case VS:for(l>>>=c&7,c-=c&7;c<32;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}if((l&65535)!==(l>>>16^65535)){e.msg="invalid stored block lengths",t.mode=Rr;break}if(t.length=l&65535,l=0,c=0,t.mode=gp,r===Bu)break e;case gp:t.mode=MS;case MS:if(d=t.length,d){if(d>o&&(d=o),d>u&&(d=u),d===0)break e;a.set(n.subarray(i,i+d),s),o-=d,i+=d,u-=d,s+=d,t.length-=d;break}t.mode=va;break;case jS:for(;c<14;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}if(t.nlen=(l&31)+257,l>>>=5,c-=5,t.ndist=(l&31)+1,l>>>=5,c-=5,t.ncode=(l&15)+4,l>>>=4,c-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=Rr;break}t.have=0,t.mode=LS;case LS:for(;t.have<t.ncode;){for(;c<3;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}t.lens[L[t.have++]]=l&7,l>>>=3,c-=3}for(;t.have<19;)t.lens[L[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,U={bits:t.lenbits},k=ul(vZ,t.lens,0,19,t.lencode,0,t.work,U),t.lenbits=U.bits,k){e.msg="invalid code lengths set",t.mode=Rr;break}t.have=0,t.mode=BS;case BS:for(;t.have<t.nlen+t.ndist;){for(;x=t.lencode[l&(1<<t.lenbits)-1],g=x>>>24,N=x>>>16&255,b=x&65535,!(g<=c);){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}if(b<16)l>>>=g,c-=g,t.lens[t.have++]=b;else{if(b===16){for(F=g+2;c<F;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}if(l>>>=g,c-=g,t.have===0){e.msg="invalid bit length repeat",t.mode=Rr;break}C=t.lens[t.have-1],d=3+(l&3),l>>>=2,c-=2}else if(b===17){for(F=g+3;c<F;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}l>>>=g,c-=g,C=0,d=3+(l&7),l>>>=3,c-=3}else{for(F=g+7;c<F;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}l>>>=g,c-=g,C=0,d=11+(l&127),l>>>=7,c-=7}if(t.have+d>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=Rr;break}for(;d--;)t.lens[t.have++]=C}}if(t.mode===Rr)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=Rr;break}if(t.lenbits=9,U={bits:t.lenbits},k=ul(QU,t.lens,0,t.nlen,t.lencode,0,t.work,U),t.lenbits=U.bits,k){e.msg="invalid literal/lengths set",t.mode=Rr;break}if(t.distbits=6,t.distcode=t.distdyn,U={bits:t.distbits},k=ul(ZU,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,U),t.distbits=U.bits,k){e.msg="invalid distances set",t.mode=Rr;break}if(t.mode=qu,r===Bu)break e;case qu:t.mode=Hu;case Hu:if(o>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=i,e.avail_in=o,t.hold=l,t.bits=c,cZ(e,h),s=e.next_out,a=e.output,u=e.avail_out,i=e.next_in,n=e.input,o=e.avail_in,l=t.hold,c=t.bits,t.mode===va&&(t.back=-1);break}for(t.back=0;x=t.lencode[l&(1<<t.lenbits)-1],g=x>>>24,N=x>>>16&255,b=x&65535,!(g<=c);){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}if(N&&(N&240)===0){for(y=g,_=N,w=b;x=t.lencode[w+((l&(1<<y+_)-1)>>y)],g=x>>>24,N=x>>>16&255,b=x&65535,!(y+g<=c);){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}l>>>=y,c-=y,t.back+=y}if(l>>>=g,c-=g,t.back+=g,t.length=b,N===0){t.mode=GS;break}if(N&32){t.back=-1,t.mode=va;break}if(N&64){e.msg="invalid literal/length code",t.mode=Rr;break}t.extra=N&15,t.mode=qS;case qS:if(t.extra){for(F=t.extra;c<F;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,c-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=HS;case HS:for(;x=t.distcode[l&(1<<t.distbits)-1],g=x>>>24,N=x>>>16&255,b=x&65535,!(g<=c);){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}if((N&240)===0){for(y=g,_=N,w=b;x=t.distcode[w+((l&(1<<y+_)-1)>>y)],g=x>>>24,N=x>>>16&255,b=x&65535,!(y+g<=c);){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}l>>>=y,c-=y,t.back+=y}if(l>>>=g,c-=g,t.back+=g,N&64){e.msg="invalid distance code",t.mode=Rr;break}t.offset=b,t.extra=N&15,t.mode=zS;case zS:if(t.extra){for(F=t.extra;c<F;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,c-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=Rr;break}t.mode=$S;case $S:if(u===0)break e;if(d=h-u,t.offset>d){if(d=t.offset-d,d>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=Rr;break}d>t.wnext?(d-=t.wnext,v=t.wsize-d):v=t.wnext-d,d>t.length&&(d=t.length),p=t.window}else p=a,v=s-t.offset,d=t.length;d>u&&(d=u),u-=d,t.length-=d;do a[s++]=p[v++];while(--d);t.length===0&&(t.mode=Hu);break;case GS:if(u===0)break e;a[s++]=t.length,u--,t.mode=Hu;break;case bp:if(t.wrap){for(;c<32;){if(o===0)break e;o--,l|=n[i++]<<c,c+=8}if(h-=u,e.total_out+=h,t.total+=h,t.wrap&4&&h&&(e.adler=t.check=t.flags?$n(t.check,a,h,s-h):s1(t.check,a,h,s-h)),h=u,t.wrap&4&&(t.flags?l:KS(l))!==t.check){e.msg="incorrect data check",t.mode=Rr;break}l=0,c=0}t.mode=WS;case WS:if(t.wrap&&t.flags){for(;c<32;){if(o===0)break e;o--,l+=n[i++]<<c,c+=8}if(t.wrap&4&&l!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=Rr;break}l=0,c=0}t.mode=YS;case YS:k=gZ;break e;case Rr:k=JU;break e;case rI:return eI;case tI:default:return Nn}return e.next_out=s,e.avail_out=u,e.next_in=i,e.avail_in=o,t.hold=l,t.bits=c,(t.wsize||h!==e.avail_out&&t.mode<Rr&&(t.mode<bp||r!==SS))&&oI(e,e.output,e.next_out,h-e.avail_out),f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,t.total+=h,t.wrap&4&&h&&(e.adler=t.check=t.flags?$n(t.check,a,h,e.next_out-h):s1(t.check,a,h,e.next_out-h)),e.data_type=t.bits+(t.last?64:0)+(t.mode===va?128:0)+(t.mode===qu||t.mode===gp?256:0),(f===0&&h===0||r===SS)&&k===is&&(k=NZ),k},AZ=e=>{if(xs(e))return Nn;let r=e.state;return r.window&&(r.window=null),e.state=null,is},kZ=(e,r)=>{if(xs(e))return Nn;const t=e.state;return(t.wrap&2)===0?Nn:(t.head=r,r.done=!1,is)},RZ=(e,r)=>{const t=r.length;let n,a,i;return xs(e)||(n=e.state,n.wrap!==0&&n.mode!==zc)?Nn:n.mode===zc&&(a=1,a=s1(a,r,t,0),a!==n.check)?JU:(i=oI(e,r,t,t),i?(n.mode=rI,eI):(n.havedict=1,is))};var OZ=aI,FZ=iI,UZ=nI,IZ=SZ,PZ=sI,VZ=DZ,MZ=AZ,jZ=kZ,LZ=RZ,BZ="pako inflate (from Nodeca project)",Na={inflateReset:OZ,inflateReset2:FZ,inflateResetKeep:UZ,inflateInit:IZ,inflateInit2:PZ,inflate:VZ,inflateEnd:MZ,inflateGetHeader:jZ,inflateSetDictionary:LZ,inflateInfo:BZ};function qZ(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var HZ=qZ;const lI=Object.prototype.toString,{Z_NO_FLUSH:zZ,Z_FINISH:$Z,Z_OK:Il,Z_STREAM_END:Cp,Z_NEED_DICT:Ep,Z_STREAM_ERROR:GZ,Z_DATA_ERROR:QS,Z_MEM_ERROR:WZ}=YU;function iu(e){this.options=KU.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(e&&e.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new lZ,this.strm.avail_out=0;let t=Na.inflateInit2(this.strm,r.windowBits);if(t!==Il)throw new Error(o1[t]);if(this.header=new HZ,Na.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=l1.string2buf(r.dictionary):lI.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(t=Na.inflateSetDictionary(this.strm,r.dictionary),t!==Il)))throw new Error(o1[t])}iu.prototype.push=function(e,r){const t=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let i,s,o;if(this.ended)return!1;for(r===~~r?s=r:s=r===!0?$Z:zZ,lI.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),i=Na.inflate(t,s),i===Ep&&a&&(i=Na.inflateSetDictionary(t,a),i===Il?i=Na.inflate(t,s):i===QS&&(i=Ep));t.avail_in>0&&i===Cp&&t.state.wrap>0&&e[t.next_in]!==0;)Na.inflateReset(t),i=Na.inflate(t,s);switch(i){case GZ:case QS:case Ep:case WZ:return this.onEnd(i),this.ended=!0,!1}if(o=t.avail_out,t.next_out&&(t.avail_out===0||i===Cp))if(this.options.to==="string"){let u=l1.utf8border(t.output,t.next_out),l=t.next_out-u,c=l1.buf2string(t.output,u);t.next_out=l,t.avail_out=n-l,l&&t.output.set(t.output.subarray(u,u+l),0),this.onData(c)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(i===Il&&o===0)){if(i===Cp)return i=Na.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};iu.prototype.onData=function(e){this.chunks.push(e)};iu.prototype.onEnd=function(e){e===Il&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=KU.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function YZ(e,r){const t=new iu(r);if(t.push(e),t.err)throw t.msg||o1[t.err];return t.result}var KZ=iu,XZ=YZ,QZ={Inflate:KZ,inflate:XZ};const{Inflate:ZZ,inflate:JZ}=QZ;var ZS=ZZ,eJ=JZ;const uI=[];for(let e=0;e<256;e++){let r=e;for(let t=0;t<8;t++)r&1?r=3988292384^r>>>1:r=r>>>1;uI[e]=r}const JS=4294967295;function rJ(e,r,t){let n=e;for(let a=0;a<t;a++)n=uI[(n^r[a])&255]^n>>>8;return n}function tJ(e,r){return(rJ(JS,e,r)^JS)>>>0}function eT(e,r,t){const n=e.readUint32(),a=tJ(new Uint8Array(e.buffer,e.byteOffset+e.offset-r-4,r),r);if(a!==n)throw new Error(`CRC mismatch for chunk ${t}. Expected ${n}, found ${a}`)}function cI(e,r,t){for(let n=0;n<t;n++)r[n]=e[n]}function fI(e,r,t,n){let a=0;for(;a<n;a++)r[a]=e[a];for(;a<t;a++)r[a]=e[a]+r[a-n]&255}function mI(e,r,t,n){let a=0;if(t.length===0)for(;a<n;a++)r[a]=e[a];else for(;a<n;a++)r[a]=e[a]+t[a]&255}function dI(e,r,t,n,a){let i=0;if(t.length===0){for(;i<a;i++)r[i]=e[i];for(;i<n;i++)r[i]=e[i]+(r[i-a]>>1)&255}else{for(;i<a;i++)r[i]=e[i]+(t[i]>>1)&255;for(;i<n;i++)r[i]=e[i]+(r[i-a]+t[i]>>1)&255}}function hI(e,r,t,n,a){let i=0;if(t.length===0){for(;i<a;i++)r[i]=e[i];for(;i<n;i++)r[i]=e[i]+r[i-a]&255}else{for(;i<a;i++)r[i]=e[i]+t[i]&255;for(;i<n;i++)r[i]=e[i]+nJ(r[i-a],t[i],t[i-a])&255}}function nJ(e,r,t){const n=e+r-t,a=Math.abs(n-e),i=Math.abs(n-r),s=Math.abs(n-t);return a<=i&&a<=s?e:i<=s?r:t}function aJ(e,r,t,n,a,i){switch(e){case 0:cI(r,t,a);break;case 1:fI(r,t,a,i);break;case 2:mI(r,t,n,a);break;case 3:dI(r,t,n,a,i);break;case 4:hI(r,t,n,a,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const iJ=new Uint16Array([255]),sJ=new Uint8Array(iJ.buffer),oJ=sJ[0]===255;function lJ(e){const{data:r,width:t,height:n,channels:a,depth:i}=e,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(i/8)*a,u=new Uint8Array(n*t*o);let l=0;for(let c=0;c<7;c++){const f=s[c],h=Math.ceil((t-f.x)/f.xStep),d=Math.ceil((n-f.y)/f.yStep);if(h<=0||d<=0)continue;const v=h*o,p=new Uint8Array(v);for(let x=0;x<d;x++){const g=r[l++],N=r.subarray(l,l+v);l+=v;const b=new Uint8Array(v);aJ(g,N,b,p,v,o),p.set(b);for(let y=0;y<h;y++){const _=f.x+y*f.xStep,w=f.y+x*f.yStep;if(!(_>=t||w>=n))for(let C=0;C<o;C++)u[(w*t+_)*o+C]=b[y*o+C]}}}if(i===16){const c=new Uint16Array(u.buffer);if(oJ)for(let f=0;f<c.length;f++)c[f]=uJ(c[f]);return c}else return u}function uJ(e){return(e&255)<<8|e>>8&255}const cJ=new Uint16Array([255]),fJ=new Uint8Array(cJ.buffer),mJ=fJ[0]===255,dJ=new Uint8Array(0);function rT(e){const{data:r,width:t,height:n,channels:a,depth:i}=e,s=Math.ceil(i/8)*a,o=Math.ceil(i/8*a*t),u=new Uint8Array(n*o);let l=dJ,c=0,f,h;for(let d=0;d<n;d++){switch(f=r.subarray(c+1,c+1+o),h=u.subarray(d*o,(d+1)*o),r[c]){case 0:cI(f,h,o);break;case 1:fI(f,h,o,s);break;case 2:mI(f,h,l,o);break;case 3:dI(f,h,l,o,s);break;case 4:hI(f,h,l,o,s);break;default:throw new Error(`Unsupported filter: ${r[c]}`)}l=h,c+=o+1}if(i===16){const d=new Uint16Array(u.buffer);if(mJ)for(let v=0;v<d.length;v++)d[v]=hJ(d[v]);return d}else return u}function hJ(e){return(e&255)<<8|e>>8&255}const rc=Uint8Array.of(137,80,78,71,13,10,26,10);function tT(e){if(!pJ(e.readBytes(rc.length)))throw new Error("wrong PNG signature")}function pJ(e){if(e.length<rc.length)return!1;for(let r=0;r<rc.length;r++)if(e[r]!==rc[r])return!1;return!0}const vJ="tEXt",xJ=0,pI=new TextDecoder("latin1");function gJ(e){if(NJ(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const bJ=/^[\u0000-\u00FF]*$/;function NJ(e){if(!bJ.test(e))throw new Error("invalid latin1 text")}function yJ(e,r,t){const n=vI(r);e[n]=CJ(r,t-n.length-1)}function vI(e){for(e.mark();e.readByte()!==xJ;);const r=e.offset;e.reset();const t=pI.decode(e.readBytes(r-e.offset-1));return e.skip(1),gJ(t),t}function CJ(e,r){return pI.decode(e.readBytes(r))}const Kt={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},wp={UNKNOWN:-1,DEFLATE:0},nT={UNKNOWN:-1,ADAPTIVE:0},_p={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},zu={NONE:0,BACKGROUND:1,PREVIOUS:2},Sp={SOURCE:0,OVER:1};class EJ extends hN{constructor(t,n={}){super(t);er(this,"_checkCrc");er(this,"_inflator");er(this,"_png");er(this,"_apng");er(this,"_end");er(this,"_hasPalette");er(this,"_palette");er(this,"_hasTransparency");er(this,"_transparency");er(this,"_compressionMethod");er(this,"_filterMethod");er(this,"_interlaceMethod");er(this,"_colorType");er(this,"_isAnimated");er(this,"_numberOfFrames");er(this,"_numberOfPlays");er(this,"_frames");er(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new ZS,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=wp.UNKNOWN,this._filterMethod=nT.UNKNOWN,this._interlaceMethod=_p.UNKNOWN,this._colorType=Kt.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(tT(this);!this._end;){const t=this.readUint32(),n=this.readChars(4);this.decodeChunk(t,n)}return this.decodeImage(),this._png}decodeApng(){for(tT(this);!this._end;){const t=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(t,n)}return this.decodeApngImage(),this._apng}decodeChunk(t,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case vJ:yJ(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?eT(this,t+4,n):this.skip(4)}decodeApngChunk(t,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,n),this.offset=a+t;break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?eT(this,t+4,n):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=wJ(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case Kt.GREYSCALE:a=1;break;case Kt.TRUECOLOUR:a=3;break;case Kt.INDEXED_COLOUR:a=1;break;case Kt.GREYSCALE_ALPHA:a=2;break;case Kt.TRUECOLOUR_ALPHA:a=4;break;case Kt.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==wp.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const n=t/3;this._hasPalette=!0;const a=[];this._palette=a;for(let i=0;i<n;i++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const n=t,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let n=t,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case Kt.GREYSCALE:case Kt.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let n=0;n<t/2;n++)this._transparency[n]=this.readUint16();break}case Kt.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let n=0;for(;n<t;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Kt.UNKNOWN:case Kt.GREYSCALE_ALPHA:case Kt.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const n=vI(this),a=this.readUint8();if(a!==wp.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const i=this.readBytes(t-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:eJ(i)}}decodepHYs(){const t=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:t,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const n={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(t);if(a){if(a.data=rT({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const i=this._apng.frames.at(t-1);this.disposeFrame(a,i,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(t,n,a){switch(t.disposeOp){case zu.NONE:break;case zu.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let s=0;s<this._png.width;s++){const o=(i*t.width+s)*this._png.channels;for(let u=0;u<this._png.channels;u++)a.data[o+u]=0}break;case zu.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,n){const a=1<<this._png.depth,i=(s,o)=>{const u=((s+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,l=(s*n.width+o)*this._png.channels;return{index:u,frameIndex:l}};switch(n.blendOp){case Sp.SOURCE:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:u,frameIndex:l}=i(s,o);for(let c=0;c<this._png.channels;c++)t.data[u+c]=n.data[l+c]}break;case Sp.OVER:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:u,frameIndex:l}=i(s,o);for(let c=0;c<this._png.channels;c++){const f=n.data[l+this._png.channels-1]/a,h=c%(this._png.channels-1)===0?1:n.data[l+c],d=Math.floor(f*h+(1-f)*t.data[u+c]);t.data[u+c]+=d}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==nT.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===_p.NO_INTERLACE)this._png.data=rT({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===_p.ADAM7)this._png.data=lJ({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,n=this._frames.at(-1);n?n.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:zu.NONE,blendOp:Sp.SOURCE,data:t}),this._inflator=new ZS,this._writingDataChunks=!1}}function wJ(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var aT;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(aT||(aT={}));function nue(e,r){return new EJ(e,r).decode()}const Jr={left:20,right:20},br={primary:"#000000",secondary:"#333333",border:"#CCCCCC",text:"#212121",tableBorder:"#CCCCCC",tableHeader:"#F0F0F0"},Vr={title:16,heading:12,body:10,small:8};function _J(e,r){let t=0;if(t+=50,e.dataTypes.inspections){const n=r.inspections.length;t+=n*.8}if(e.dataTypes.custodialNotes){const n=r.custodialNotes.length;t+=n*.3}if(e.dataTypes.images){const n=r.inspections.reduce((a,i)=>a+(i.images?.length||0),0);t+=n*200}return e.includeCharts&&(t+=500),e.includeDetails&&(t*=1.5),t<1024?`${Math.round(t)} KB`:`${(t/1024).toFixed(1)} MB`}function SJ(e,r){let t=1;if(e.dataTypes.inspections){const n=r.inspections.length,a=e.includeDetails?2:8;t+=Math.ceil(n/a)}if(e.dataTypes.custodialNotes){const n=r.custodialNotes.length;t+=Math.ceil(n/10)}return e.includeCharts&&(t+=2),Math.max(t,1)}function u1(e){const r=[];return!e.dataTypes.inspections&&!e.dataTypes.custodialNotes&&r.push("Please select at least one data type to export"),e.reportType||r.push("Please select a report type"),e.filters.dateRange.from&&e.filters.dateRange.to&&e.filters.dateRange.from>e.filters.dateRange.to&&r.push("Start date must be before end date"),(e.filters.ratingThreshold<1||e.filters.ratingThreshold>5)&&r.push("Rating threshold must be between 1 and 5"),{isValid:r.length===0,errors:r}}function Co(e,r){let t=[...e.inspections],n=[...e.custodialNotes];if(r.filters.dateRange.from){const a=r.filters.dateRange.from.getTime();t=t.filter(i=>new Date(i.date).getTime()>=a),n=n.filter(i=>new Date(i.date).getTime()>=a)}if(r.filters.dateRange.to){const a=r.filters.dateRange.to.getTime();t=t.filter(i=>new Date(i.date).getTime()<=a),n=n.filter(i=>new Date(i.date).getTime()<=a)}return r.filters.schools.length>0&&(t=t.filter(a=>r.filters.schools.includes(a.school)),n=n.filter(a=>r.filters.schools.includes(a.school))),r.filters.categories.length>0&&(t=t.filter(a=>r.filters.categories.some(i=>typeof a[i]=="number"))),r.filters.ratingThreshold>0&&(t=t.filter(a=>{const s=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(u=>a[u]).filter(u=>typeof u=="number");return s.length===0?!1:s.reduce((u,l)=>u+l,0)/s.length<=r.filters.ratingThreshold})),r.filters.severityLevels.length>0&&(t=t.filter(a=>{const s=["floors","verticalHorizontalSurfaces","ceiling","restrooms"].map(u=>a[u]).filter(u=>typeof u=="number");if(s.length===0)return!1;const o=s.reduce((u,l)=>u+l,0)/s.length;return!!(r.filters.severityLevels.includes("critical")&&o<=2||r.filters.severityLevels.includes("needs-attention")&&o<=3||r.filters.severityLevels.includes("acceptable")&&o>3)})),{inspections:t,custodialNotes:n,totalRecords:t.length+n.length,dateRange:r.filters.dateRange,schools:r.filters.schools,categories:r.filters.categories}}function TJ(e){const r=[];if(e.filters.dateRange.from||e.filters.dateRange.to){const t=e.filters.dateRange.from?.toLocaleDateString()||"Start",n=e.filters.dateRange.to?.toLocaleDateString()||"End";r.push(`Date: ${t} - ${n}`)}return e.filters.schools.length>0&&r.push(`Schools: ${e.filters.schools.length} selected`),e.filters.categories.length>0&&r.push(`Categories: ${e.filters.categories.length} selected`),e.filters.severityLevels.length>0&&r.push(`Severity: ${e.filters.severityLevels.join(", ")}`),e.filters.ratingThreshold>0&&r.push(`Rating â‰¤ ${e.filters.ratingThreshold} stars`),r}function DJ(e){const r=e.inspections.reduce((a,i)=>a+(i.images?.length||0),0),t=r*200,n=t<1024?`${t} KB`:`${(t/1024).toFixed(1)} MB`;return{inspections:e.inspections.length,custodialNotes:e.custodialNotes.length,images:r,totalSize:n}}function xI(e){const r=new Ll("p","mm","letter");let t=20;const n=AJ(e);return t=kJ(r,e,t),t=RJ(r,n,t),t=OJ(r,n,t),FJ(r),r.output("blob")}function AJ(e){const r=[],t=e.startDate?.getTime(),n=e.endDate?.getTime();return e.inspections.forEach(a=>{const i=new Date(a.date).getTime();if(t&&i<t||n&&i>n||e.schoolFilter&&a.school!==e.schoolFilter)return;const s=fs(a);if(s===null)return;let o="Info";if(s<2)o="Critical";else if(s<3)o="Needs Attention";else return;r.push({date:new Date(a.date).toLocaleDateString(),school:a.school,location:a.locationDescription||a.roomNumber||"N/A",priority:o,description:`Rating: ${s.toFixed(1)}/5.0${a.notes?` - ${a.notes}`:""}`,reportedBy:a.inspectorName||"N/A",category:"Inspection"})}),e.custodialNotes.forEach(a=>{const i=new Date(a.date).getTime();if(t&&i<t||n&&i>n||e.schoolFilter&&a.school!==e.schoolFilter)return;const o=["urgent","emergency","leak","unsafe","broken","immediate"].some(u=>a.notes.toLowerCase().includes(u));r.push({date:new Date(a.date).toLocaleDateString(),school:a.school,location:a.location,priority:o?"Critical":"Needs Attention",description:a.notes,reportedBy:"N/A",category:"Custodial Note"})}),r.sort((a,i)=>{if(a.priority!==i.priority){const s={Critical:0,"Needs Attention":1,Info:2};return s[a.priority]-s[i.priority]}return new Date(i.date).getTime()-new Date(a.date).getTime()}),r}function kJ(e,r,t){e.setFontSize(Vr.title),e.setTextColor(br.primary),e.setFont("helvetica","bold"),e.text("Current Custodial Issues Report",Jr.left,t),t+=8,e.setFontSize(Vr.body),e.setTextColor(br.secondary),e.setFont("helvetica","normal");const n=r.startDate&&r.endDate?`${r.startDate.toLocaleDateString()} - ${r.endDate.toLocaleDateString()}`:"All Dates";return e.text(`Date Range: ${n}`,Jr.left,t),t+=5,r.schoolFilter&&(e.text(`School: ${r.schoolFilter}`,Jr.left,t),t+=5),r.activeFilters&&r.activeFilters.length>0&&(e.text(`Filters: ${r.activeFilters.join(", ")}`,Jr.left,t),t+=5),e.setFontSize(Vr.small),e.setTextColor(br.secondary),e.text(`Generated: ${new Date().toLocaleString()}`,Jr.left,t),t+=5,e.setDrawColor(br.border),e.setLineWidth(.5),e.line(Jr.left,t,e.internal.pageSize.getWidth()-Jr.right,t),t+8}function RJ(e,r,t){const n=r.filter(o=>o.priority==="Critical").length,a=r.filter(o=>o.priority==="Needs Attention").length,i=new Set(r.map(o=>o.school)).size;e.setFontSize(Vr.heading),e.setTextColor(br.primary),e.setFont("helvetica","bold"),e.text("Summary Statistics",Jr.left,t),t+=6;const s=[["Total Issues:",r.length.toString()],["Critical:",n.toString()],["Needs Attention:",a.toString()],["Schools Affected:",i.toString()]];return Zi(e,{startY:t,body:s,theme:"plain",styles:{fontSize:Vr.body,textColor:br.text,cellPadding:2,lineWidth:.5,lineColor:br.tableBorder},columnStyles:{0:{fontStyle:"bold",cellWidth:40},1:{cellWidth:20}}}),e.lastAutoTable.finalY+10}function OJ(e,r,t){if(r.length===0)return e.setFontSize(Vr.body),e.setTextColor(br.secondary),e.text("No issues found for the selected criteria.",Jr.left,t),t+10;e.setFontSize(Vr.heading),e.setTextColor(br.primary),e.setFont("helvetica","bold"),e.text("Issues Detail",Jr.left,t),t+=6;const n=r.map(a=>[a.date,a.school,a.location,a.priority,a.description,a.category]);return Zi(e,{startY:t,head:[["Date","School","Location","Priority","Description","Type"]],body:n,theme:"grid",headStyles:{fillColor:br.tableHeader,textColor:br.primary,fontStyle:"bold",fontSize:Vr.small,lineWidth:.5,lineColor:br.tableBorder},bodyStyles:{fontSize:Vr.small,textColor:br.text,lineWidth:.5,lineColor:br.tableBorder},columnStyles:{0:{cellWidth:20},1:{cellWidth:20},2:{cellWidth:30},3:{cellWidth:25},4:{cellWidth:60},5:{cellWidth:25}},styles:{overflow:"linebreak",cellPadding:3}}),e.lastAutoTable.finalY}function FJ(e){const r=e.getNumberOfPages();for(let t=1;t<=r;t++){e.setPage(t);const n=e.internal.pageSize.getHeight();e.setFontSize(Vr.small),e.setTextColor(br.secondary),e.text(`Page ${t} of ${r}`,e.internal.pageSize.getWidth()/2,n-10,{align:"center"}),e.text("Custodial Command System",Jr.left,n-10)}}function UJ(e,r){const t=Co(e,r),n=new Ll("p","mm","letter");let a=20;if(n.setFontSize(Vr.title),n.setTextColor(br.primary),n.setFont("helvetica","bold"),n.text("EXECUTIVE SUMMARY",Jr.left,a),a+=15,r.filters.dateRange.from||r.filters.dateRange.to){n.setFontSize(Vr.body),n.setTextColor(br.secondary);const l=r.filters.dateRange.from?.toLocaleDateString()||"Start",c=r.filters.dateRange.to?.toLocaleDateString()||"End";n.text(`Report Period: ${l} - ${c}`,Jr.left,a),a+=10}const i=t.inspections.length,s=t.custodialNotes.length,o=i>0?t.inspections.map(fs).filter(l=>l!==null).reduce((l,c)=>l+c,0)/i:0,u=[["Total Inspections",i.toString()],["Custodial Notes",s.toString()],["Average Rating",o.toFixed(1)+" stars"],["Schools Covered",t.schools.length.toString()]];return Zi(n,{startY:a,head:[["Metric","Value"]],body:u,theme:"grid",headStyles:{fillColor:br.tableHeader},styles:{fontSize:Vr.body}}),a=n.lastAutoTable.finalY+10,n.setFontSize(Vr.body),n.setTextColor(br.text),n.text("This executive summary provides a high-level overview of custodial performance",Jr.left,a),a+=6,n.text(`across ${t.schools.length} schools with ${i} inspections conducted.`,Jr.left,a),n.output("blob")}function IJ(e,r){const t=Co(e,r),n=new Ll("p","mm","letter");let a=20;n.setFontSize(Vr.title),n.setTextColor(br.primary),n.setFont("helvetica","bold"),n.text("SCHOOL PERFORMANCE REPORT",Jr.left,a),a+=15;const i=t.inspections.reduce((o,u)=>{o[u.school]||(o[u.school]={school:u.school,inspections:0,ratings:[]}),o[u.school].inspections++;const l=fs(u);return l!==null&&o[u.school].ratings.push(l),o},{}),s=Object.values(i).map(o=>[o.school,o.inspections.toString(),o.ratings.length>0?(o.ratings.reduce((u,l)=>u+l,0)/o.ratings.length).toFixed(1):"N/A"]);return Zi(n,{startY:a,head:[["School","Inspections","Avg Rating"]],body:s,theme:"grid",headStyles:{fillColor:br.tableHeader},styles:{fontSize:Vr.body}}),n.output("blob")}function PJ(e,r){const t=Co(e,r),n=new Ll("p","mm","letter");let a=20;n.setFontSize(Vr.title),n.setTextColor(br.primary),n.setFont("helvetica","bold"),n.text("CATEGORY ANALYSIS REPORT",Jr.left,a),a+=15;const s=[{key:"floors",label:"Floors"},{key:"verticalHorizontalSurfaces",label:"Vertical and Horizontal Surfaces"},{key:"ceiling",label:"Ceiling"},{key:"restrooms",label:"Restrooms"},{key:"customerSatisfaction",label:"Customer Satisfaction"}].map(o=>{const u=t.inspections.map(l=>l[o.key]).filter(l=>typeof l=="number");return[o.label,u.length.toString(),u.length>0?(u.reduce((l,c)=>l+c,0)/u.length).toFixed(1):"N/A"]});return Zi(n,{startY:a,head:[["Category","Inspections","Avg Rating"]],body:s,theme:"grid",headStyles:{fillColor:br.tableHeader},styles:{fontSize:Vr.body}}),n.output("blob")}function VJ(e,r){const t=Co(e,r),n=new Ll("p","mm","letter");let a=20;if(n.setFontSize(Vr.title),n.setTextColor(br.primary),n.setFont("helvetica","bold"),n.text("CUSTOM REPORT",Jr.left,a),a+=15,r.dataTypes.inspections){n.setFontSize(Vr.heading),n.setTextColor(br.primary),n.text("INSPECTIONS",Jr.left,a),a+=10;const i=t.inspections.slice(0,10).map(s=>[s.school,s.date,fs(s)?.toFixed(1)||"N/A"]);Zi(n,{startY:a,head:[["School","Date","Rating"]],body:i,theme:"grid",headStyles:{fillColor:br.tableHeader},styles:{fontSize:Vr.body}}),a=n.lastAutoTable.finalY+10}if(r.dataTypes.custodialNotes){n.setFontSize(Vr.heading),n.setTextColor(br.primary),n.text("CUSTODIAL NOTES",Jr.left,a),a+=10;const i=t.custodialNotes.slice(0,10).map(s=>[s.school,s.date,s.notes.substring(0,50)+(s.notes.length>50?"...":"")]);Zi(n,{startY:a,head:[["School","Date","Note"]],body:i,theme:"grid",headStyles:{fillColor:br.tableHeader},styles:{fontSize:Vr.body}})}return n.output("blob")}const MJ=({inspections:e,custodialNotes:r,trigger:t,onExport:n})=>{const[a,i]=W.useState(!1),[s,o]=W.useState(!1),[u,l]=W.useState("excel"),[c,f]=W.useState("all"),[h,d]=W.useState({includeSummary:!0,includeAllInspections:!0,includeProblemAreas:!0,includeCustodialNotes:!0}),v=async()=>{o(!0);try{const g={inspections:e,custodialNotes:r,options:h};switch(u){case"excel":xQ(g);break;case"csv":bQ(g,c==="problems"?"problems":"inspections");break;case"pdf":const b={inspections:e,custodialNotes:r,activeFilters:Object.entries(h).filter(([C,k])=>k).map(([C])=>C)},y=xI(b),_=URL.createObjectURL(y),w=document.createElement("a");w.href=_,w.download=`custodial-report-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(_);break}n?.(),i(!1)}catch(g){console.error("Export failed:",g),alert(`Export failed: ${g instanceof Error?g.message:"Unknown error"}. Please try again.`)}finally{o(!1)}},p=()=>{const g=e.length*.5,N=u==="excel"?1.5:.3,b=Object.values(h).filter(Boolean).length,y=Math.round(g*N*b);return y<1024?`${y} KB`:`${(y/1024).toFixed(1)} MB`},x=()=>{switch(c){case"all":return e.length;case"filtered":return e.length;case"problems":return e.filter(g=>{const b=["floors","verticalHorizontalSurfaces","ceiling","restrooms"].map(_=>g[_]).filter(_=>_!==null);return(b.length>0?b.reduce((_,w)=>_+w,0)/b.length:5)<3}).length;case"custom":return e.length;default:return e.length}};return m.jsxDEV(af,{open:a,onOpenChange:i,children:[m.jsxDEV(xR,{asChild:!0,children:t||m.jsxDEV(We,{children:[m.jsxDEV(Qi,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:133,columnNumber:13},void 0),"Export Data"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:132,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:130,columnNumber:7},void 0),m.jsxDEV(Hl,{className:"w-[95vw] sm:max-w-2xl max-h-[90vh] p-0 overflow-hidden",children:m.jsxDEV("div",{className:"flex flex-col h-full",children:[m.jsxDEV(zl,{className:"p-6 pb-2",children:[m.jsxDEV($l,{children:"Export Data"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:141,columnNumber:13},void 0),m.jsxDEV(Gl,{children:"Choose format and options for exporting inspection data and reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:140,columnNumber:11},void 0),m.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 pt-4 space-y-6 bg-background",children:[m.jsxDEV("div",{className:"space-y-3",children:[m.jsxDEV(tr,{className:"text-base font-medium",children:"Export Format"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:151,columnNumber:13},void 0),m.jsxDEV(tF,{value:u,onValueChange:g=>l(g),children:[m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(ec,{value:"excel",id:"excel"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:154,columnNumber:17},void 0),m.jsxDEV(tr,{htmlFor:"excel",className:"flex items-center gap-2",children:[m.jsxDEV(fV,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:156,columnNumber:19},void 0),"Excel (.xlsx) - Multiple sheets with formatting"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:155,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:153,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(ec,{value:"csv",id:"csv"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:161,columnNumber:17},void 0),m.jsxDEV(tr,{htmlFor:"csv",className:"flex items-center gap-2",children:[m.jsxDEV(ja,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:163,columnNumber:19},void 0),"CSV (.csv) - Single sheet, compatible with all tools"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:162,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:160,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(ec,{value:"pdf",id:"pdf"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:168,columnNumber:17},void 0),m.jsxDEV(tr,{htmlFor:"pdf",className:"flex items-center gap-2",children:[m.jsxDEV(mV,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:170,columnNumber:19},void 0),"PDF (.pdf) - Formatted issue reports with summaries"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:169,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:167,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:152,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:150,columnNumber:11},void 0),m.jsxDEV("div",{className:"space-y-3",children:[m.jsxDEV(tr,{className:"text-base font-medium",children:"Export Scope"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:179,columnNumber:13},void 0),m.jsxDEV(el,{value:c,onValueChange:g=>f(g),children:[m.jsxDEV(js,{children:m.jsxDEV(rl,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:182,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:181,columnNumber:15},void 0),m.jsxDEV(Ls,{children:[m.jsxDEV(Un,{value:"all",children:["All Data (",e.length," inspections)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:185,columnNumber:17},void 0),m.jsxDEV(Un,{value:"filtered",children:["Filtered Data (",x()," inspections)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:186,columnNumber:17},void 0),m.jsxDEV(Un,{value:"problems",children:["Problems Only (",x()," inspections)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:187,columnNumber:17},void 0),m.jsxDEV(Un,{value:"custom",children:"Custom Selection"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:188,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:184,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:180,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:178,columnNumber:11},void 0),u==="excel"&&m.jsxDEV("div",{className:"space-y-3",children:[m.jsxDEV(tr,{className:"text-base font-medium",children:"Include in Export"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:196,columnNumber:15},void 0),m.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:"summary",checked:h.includeSummary,onCheckedChange:g=>d({...h,includeSummary:!!g})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:199,columnNumber:19},void 0),m.jsxDEV(tr,{htmlFor:"summary",children:"Executive Summary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:204,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:198,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:"inspections",checked:h.includeAllInspections,onCheckedChange:g=>d({...h,includeAllInspections:!!g})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:207,columnNumber:19},void 0),m.jsxDEV(tr,{htmlFor:"inspections",children:"All Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:212,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:206,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:"problems",checked:h.includeProblemAreas,onCheckedChange:g=>d({...h,includeProblemAreas:!!g})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:215,columnNumber:19},void 0),m.jsxDEV(tr,{htmlFor:"problems",children:"Problem Areas"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:220,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:214,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:"notes",checked:h.includeCustodialNotes,onCheckedChange:g=>d({...h,includeCustodialNotes:!!g})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:223,columnNumber:19},void 0),m.jsxDEV(tr,{htmlFor:"notes",children:"Custodial Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:228,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:222,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:197,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:195,columnNumber:13},void 0),m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{children:m.jsxDEV(Ze,{className:"text-sm",children:"Export Preview"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:237,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:236,columnNumber:13},void 0),m.jsxDEV(He,{className:"space-y-2",children:[m.jsxDEV("div",{className:"flex justify-between text-sm",children:[m.jsxDEV("span",{children:"Records:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:241,columnNumber:17},void 0),m.jsxDEV("span",{children:[x()," inspections"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:242,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:240,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex justify-between text-sm",children:[m.jsxDEV("span",{children:"Format:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:245,columnNumber:17},void 0),m.jsxDEV("span",{children:u.toUpperCase()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:246,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:244,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex justify-between text-sm",children:[m.jsxDEV("span",{children:"Estimated Size:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:249,columnNumber:17},void 0),m.jsxDEV("span",{children:p()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:250,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:248,columnNumber:15},void 0),u==="excel"&&m.jsxDEV("div",{className:"flex justify-between text-sm",children:[m.jsxDEV("span",{children:"Sheets:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:254,columnNumber:19},void 0),m.jsxDEV("span",{children:[Object.values(h).filter(Boolean).length," sheets"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:255,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:253,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:239,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:235,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:148,columnNumber:11},void 0),m.jsxDEV("div",{className:"flex justify-end gap-3 p-6 border-t bg-background",children:[m.jsxDEV(We,{variant:"outline",onClick:()=>i(!1),children:"Cancel"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:264,columnNumber:13},void 0),m.jsxDEV(We,{onClick:v,disabled:s,className:"min-w-[120px]",children:s?m.jsxDEV(m.Fragment,{children:[m.jsxDEV(ic,{className:"w-4 h-4 mr-2 animate-spin"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:274,columnNumber:19},void 0),"Exporting..."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:273,columnNumber:17},void 0):m.jsxDEV(m.Fragment,{children:[m.jsxDEV(Qi,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:279,columnNumber:19},void 0),"Export Data"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:278,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:267,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:263,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:139,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:138,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:129,columnNumber:5},void 0)},aue=({inspections:e,custodialNotes:r,onInspectionClick:t,onExportReport:n})=>{const a=W.useMemo(()=>{const o=qb(e),u=Hb(r);return{...o,urgentNotes:u,summary:{...o.summary,urgentNotesCount:u.length}}},[e,r]),i=(o,u)=>{const l=SH(o.severity);return m.jsxDEV(qe,{className:"hover:shadow-lg transition-shadow",children:[m.jsxDEV(Qe,{className:"pb-3",children:[m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[o.severity==="critical"?m.jsxDEV(vn,{className:"w-5 h-5 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:54,columnNumber:17},void 0):m.jsxDEV(Ut,{className:"w-5 h-5 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:56,columnNumber:17},void 0),m.jsxDEV(Ze,{className:"text-lg",children:o.school},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:58,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:52,columnNumber:13},void 0),m.jsxDEV(yr,{...l,children:l.text},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:60,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:51,columnNumber:11},void 0),m.jsxDEV(mr,{className:"flex items-center gap-4 text-sm",children:[m.jsxDEV("span",{className:"flex items-center gap-1",children:[m.jsxDEV(xn,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:66,columnNumber:15},void 0),o.location]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:65,columnNumber:13},void 0),m.jsxDEV("span",{className:"flex items-center gap-1",children:[m.jsxDEV(wt,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:70,columnNumber:15},void 0),new Date(o.date).toLocaleDateString()]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:69,columnNumber:13},void 0),m.jsxDEV("span",{className:"flex items-center gap-1",children:[m.jsxDEV(Aa,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:74,columnNumber:15},void 0),o.rating,"/5"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:73,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:64,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:50,columnNumber:9},void 0),m.jsxDEV(He,{className:"pt-0",children:m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("div",{className:"text-sm text-muted-foreground",children:o.severity==="critical"?"Immediate attention required":"Needs improvement"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:81,columnNumber:13},void 0),m.jsxDEV("div",{className:"flex gap-2",children:m.jsxDEV(We,{variant:"outline",size:"sm",onClick:()=>t?.(o.inspection),children:[m.jsxDEV(b4,{className:"w-4 h-4 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:93,columnNumber:17},void 0),"View Details"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:88,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:87,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:80,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:79,columnNumber:9},void 0)]},`${o.inspection.id}-${u}`,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:49,columnNumber:7},void 0)},s=(o,u)=>{const l=TH(o.severity),c=o.note;return m.jsxDEV(qe,{className:"border-l-4 border-l-red-500 hover:shadow-lg transition-shadow",children:[m.jsxDEV(Qe,{className:"pb-3",children:[m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(vn,{className:"w-5 h-5 text-red-600 animate-pulse"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:112,columnNumber:15},void 0),m.jsxDEV(Ze,{className:"text-lg",children:c.school},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:113,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:111,columnNumber:13},void 0),m.jsxDEV(yr,{...l,children:l.text},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:115,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:110,columnNumber:11},void 0),m.jsxDEV(mr,{className:"flex items-center gap-4 text-sm",children:[m.jsxDEV("span",{className:"flex items-center gap-1",children:[m.jsxDEV(xn,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:121,columnNumber:15},void 0),c.location]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:120,columnNumber:13},void 0),m.jsxDEV("span",{className:"flex items-center gap-1",children:[m.jsxDEV(wt,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:125,columnNumber:15},void 0),new Date(c.date).toLocaleDateString()]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:124,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:119,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:109,columnNumber:9},void 0),m.jsxDEV(He,{className:"pt-0",children:m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV("p",{className:"text-sm text-foreground",children:c.notes},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:132,columnNumber:13},void 0),o.keywords.length>0&&m.jsxDEV("div",{className:"flex flex-wrap gap-1",children:o.keywords.map((f,h)=>m.jsxDEV(yr,{variant:"outline",className:"text-xs",children:f},h,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:136,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:131,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:130,columnNumber:9},void 0)]},`note-${c.id}-${u}`,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:108,columnNumber:7},void 0)};return m.jsxDEV("div",{className:"space-y-6",children:[m.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsxDEV(Ze,{className:"text-sm font-medium",children:"Critical Issues"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:154,columnNumber:13},void 0),m.jsxDEV(vn,{className:"h-4 w-4 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:155,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:153,columnNumber:11},void 0),m.jsxDEV(He,{children:[m.jsxDEV("div",{className:"text-2xl font-bold text-red-600",children:a.summary.criticalCount},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:158,columnNumber:13},void 0),m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Rating < 2.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:159,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:157,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:152,columnNumber:9},void 0),m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsxDEV(Ze,{className:"text-sm font-medium",children:"Needs Attention"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:165,columnNumber:13},void 0),m.jsxDEV(Ut,{className:"h-4 w-4 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:166,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:164,columnNumber:11},void 0),m.jsxDEV(He,{children:[m.jsxDEV("div",{className:"text-2xl font-bold text-orange-600",children:a.summary.needsAttentionCount},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:169,columnNumber:13},void 0),m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Rating 2.0-3.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:170,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:168,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:163,columnNumber:9},void 0),m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsxDEV(Ze,{className:"text-sm font-medium",children:"Urgent Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:176,columnNumber:13},void 0),m.jsxDEV(ja,{className:"h-4 w-4 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:177,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:175,columnNumber:11},void 0),m.jsxDEV(He,{children:[m.jsxDEV("div",{className:"text-2xl font-bold text-red-600",children:a.summary.urgentNotesCount},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:180,columnNumber:13},void 0),m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"High priority reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:181,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:179,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:174,columnNumber:9},void 0),m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsxDEV(Ze,{className:"text-sm font-medium",children:"Affected Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:187,columnNumber:13},void 0),m.jsxDEV(xn,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:188,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:186,columnNumber:11},void 0),m.jsxDEV(He,{children:[m.jsxDEV("div",{className:"text-2xl font-bold",children:a.summary.affectedSchools.length},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:191,columnNumber:13},void 0),m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Schools with issues"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:192,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:190,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:185,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:151,columnNumber:7},void 0),m.jsxDEV("div",{className:"flex justify-end",children:m.jsxDEV(MJ,{inspections:e,custodialNotes:r,trigger:m.jsxDEV(We,{className:"bg-primary hover:bg-primary/90",children:[m.jsxDEV(Qi,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:204,columnNumber:15},void 0),"Export Problem Areas Report"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:203,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:199,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:198,columnNumber:7},void 0),a.urgentNotes.length>0&&m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(vn,{className:"w-6 h-6 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:215,columnNumber:13},void 0),m.jsxDEV("h3",{className:"text-xl font-bold text-red-600",children:"ðŸš¨ URGENT FACILITY ISSUES"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:216,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:214,columnNumber:11},void 0),m.jsxDEV("div",{className:"grid gap-4",children:a.urgentNotes.map((o,u)=>s(o,u))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:218,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:213,columnNumber:9},void 0),a.critical.length>0&&m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(vn,{className:"w-6 h-6 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:230,columnNumber:13},void 0),m.jsxDEV("h3",{className:"text-xl font-bold text-red-600",children:"ðŸ”´ CRITICAL PERFORMANCE ISSUES"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:231,columnNumber:13},void 0),m.jsxDEV(yr,{variant:"destructive",className:"ml-2",children:"Rating < 2.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:229,columnNumber:11},void 0),m.jsxDEV("div",{className:"grid gap-4",children:a.critical.map((o,u)=>i(o,u))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:236,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:228,columnNumber:9},void 0),a.needsAttention.length>0&&m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(Ut,{className:"w-6 h-6 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:248,columnNumber:13},void 0),m.jsxDEV("h3",{className:"text-xl font-bold text-orange-600",children:"ðŸŸ  NEEDS ATTENTION"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:249,columnNumber:13},void 0),m.jsxDEV(yr,{variant:"secondary",className:"ml-2",children:"Rating 2.0-3.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:250,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:247,columnNumber:11},void 0),m.jsxDEV("div",{className:"grid gap-4",children:a.needsAttention.map((o,u)=>i(o,u))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:254,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:246,columnNumber:9},void 0),a.critical.length===0&&a.needsAttention.length===0&&a.urgentNotes.length===0&&m.jsxDEV(qe,{className:"text-center py-8",children:m.jsxDEV(He,{children:m.jsxDEV("div",{className:"flex flex-col items-center gap-4",children:[m.jsxDEV("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:m.jsxDEV(Aa,{className:"w-8 h-8 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:270,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:269,columnNumber:15},void 0),m.jsxDEV("div",{children:[m.jsxDEV("h3",{className:"text-lg font-semibold text-green-600",children:"No Problem Areas Found"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:273,columnNumber:17},void 0),m.jsxDEV("p",{className:"text-muted-foreground",children:"All inspections are performing at acceptable levels. Great job!"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:274,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:272,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:268,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:267,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:266,columnNumber:9},void 0),a.summary.totalProblems>0&&m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{children:m.jsxDEV(Ze,{className:"text-lg",children:"Problem Areas Summary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:287,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:286,columnNumber:11},void 0),m.jsxDEV(He,{children:m.jsxDEV("div",{className:"space-y-2 text-sm",children:[m.jsxDEV("p",{children:[m.jsxDEV("strong",{children:"Most Problematic School:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:291,columnNumber:18},void 0)," ",a.summary.mostProblematicSchool||"N/A"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:291,columnNumber:15},void 0),m.jsxDEV("p",{children:[m.jsxDEV("strong",{children:"Affected Schools:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:292,columnNumber:18},void 0)," ",a.summary.affectedSchools.join(", ")]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:292,columnNumber:15},void 0),m.jsxDEV("p",{children:[m.jsxDEV("strong",{children:"Total Issues:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:293,columnNumber:18},void 0)," ",a.summary.totalProblems," problems across ",a.summary.affectedSchools.length," schools"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:293,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:290,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:289,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:285,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:149,columnNumber:5},void 0)},pN=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(N4,{ref:t,className:Ae("relative flex w-full touch-none select-none items-center",e),...r,children:[m.jsxDEV(dV,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:m.jsxDEV(hV,{className:"absolute h-full bg-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/slider.tsx",lineNumber:19,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/slider.tsx",lineNumber:18,columnNumber:5},void 0),m.jsxDEV(pV,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/slider.tsx",lineNumber:21,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/slider.tsx",lineNumber:10,columnNumber:3},void 0));pN.displayName=N4.displayName;const Tp=vV,Dp=xV,Ap=gV,Lo={last7Days:{from:rm(new Date,7),to:new Date},last30Days:{from:rm(new Date,30),to:new Date},thisMonth:{from:hy(new Date),to:QV(new Date)},thisQuarter:{from:hy(rm(new Date,90)),to:new Date}},jJ=[{key:"floors",label:"Floors"},{key:"verticalHorizontalSurfaces",label:"Vertical and Horizontal Surfaces"},{key:"ceiling",label:"Ceiling"},{key:"restrooms",label:"Restrooms"},{key:"customerSatisfaction",label:"Customer Satisfaction and Coordination"},{key:"trash",label:"Trash"},{key:"projectCleaning",label:"Project Cleaning"},{key:"activitySupport",label:"Activity Support"},{key:"safetyCompliance",label:"Safety and Compliance"},{key:"equipment",label:"Equipment"},{key:"monitoring",label:"Monitoring"}],iue=({inspections:e,custodialNotes:r,filters:t,onFiltersChange:n,onClearFilters:a,isOpen:i,onToggle:s})=>{const o=Is.useRef(null);Is.useEffect(()=>{i&&o.current&&o.current.scrollIntoView({behavior:"smooth",block:"start"})},[i]);const[u,l]=W.useState(t);Is.useEffect(()=>{l(t)},[t,i]);const c=Array.from(new Set(e.map(y=>y.school).filter(Boolean))).sort(),f=Array.from(new Set(e.map(y=>y.inspectorName).filter(Boolean))).sort(),h=(y,_)=>{l(w=>({...w,[y]:_}))},d=y=>{const _=Lo[y];h("dateRange",_)},v=(y,_)=>{const w=u[y]||[],C=w.includes(_)?w.filter(k=>k!==_):[...w,_];h(y,C)},p=()=>{let y=0;return u.search&&y++,(u.dateRange.from||u.dateRange.to)&&y++,u.schools.length>0&&y++,u.severityLevels.length>0&&y++,u.categories.length>0&&y++,u.inspectors.length>0&&y++,u.ratingThreshold>0&&y++,u.inspectionType!=="all"&&y++,u.showProblemsOnly&&y++,u.hasCustodialNotes&&y++,y},x=y=>y,g=p(),N=()=>{n(u),s()},b=()=>{a(),l({search:"",dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],inspectors:[],ratingThreshold:0,inspectionType:"all",showProblemsOnly:!1,hasCustodialNotes:!1})};return m.jsxDEV(qe,{className:"w-full",ref:o,children:m.jsxDEV(Tp,{open:i,onOpenChange:s,children:[m.jsxDEV(Dp,{asChild:!0,children:m.jsxDEV(Qe,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:[m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(y4,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:154,columnNumber:17},void 0),m.jsxDEV(Ze,{className:"text-lg",children:"Advanced Filters"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:155,columnNumber:17},void 0),g>0&&m.jsxDEV(yr,{variant:"secondary",className:"ml-2",children:[g," active"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:157,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:153,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[g>0&&m.jsxDEV(We,{type:"button",variant:"outline",size:"sm",onClick:y=>{y.stopPropagation(),a()},children:[m.jsxDEV(oi,{className:"w-4 h-4 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:173,columnNumber:21},void 0),"Clear All"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:164,columnNumber:19},void 0),i?m.jsxDEV(r4,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:177,columnNumber:27},void 0):m.jsxDEV($i,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:177,columnNumber:63},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:162,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:152,columnNumber:13},void 0),m.jsxDEV(mr,{children:"Filter inspections by date, school, rating, and more"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:180,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:151,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:150,columnNumber:9},void 0),m.jsxDEV(Ap,{children:m.jsxDEV(He,{className:"space-y-6",children:[m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{htmlFor:"search",children:"Search"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:190,columnNumber:15},void 0),m.jsxDEV(Vs,{id:"search",placeholder:"Search by school, room, location, or notes...",value:u.search,onChange:y=>h("search",y.target.value)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:191,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:189,columnNumber:13},void 0),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{children:"Date Range"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:201,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex gap-2 flex-wrap",children:[m.jsxDEV(We,{type:"button",variant:u.dateRange.from?.getTime()===Lo.last7Days.from.getTime()?"default":"outline",size:"sm",onClick:()=>d("last7Days"),children:"Last 7 Days"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:203,columnNumber:17},void 0),m.jsxDEV(We,{type:"button",variant:u.dateRange.from?.getTime()===Lo.last30Days.from.getTime()?"default":"outline",size:"sm",onClick:()=>d("last30Days"),children:"Last 30 Days"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:211,columnNumber:17},void 0),m.jsxDEV(We,{type:"button",variant:u.dateRange.from?.getTime()===Lo.thisMonth.from.getTime()?"default":"outline",size:"sm",onClick:()=>d("thisMonth"),children:"This Month"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:219,columnNumber:17},void 0),m.jsxDEV(We,{type:"button",variant:u.dateRange.from?.getTime()===Lo.thisQuarter.from.getTime()?"default":"outline",size:"sm",onClick:()=>d("thisQuarter"),children:"This Quarter"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:227,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:202,columnNumber:15},void 0),m.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxDEV("div",{children:[m.jsxDEV(tr,{htmlFor:"dateFrom",children:"From"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:238,columnNumber:19},void 0),m.jsxDEV(Vs,{id:"dateFrom",type:"date",value:u.dateRange.from?sc(u.dateRange.from,"yyyy-MM-dd"):"",onChange:y=>h("dateRange",{...u.dateRange,from:y.target.value?new Date(y.target.value):null})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:239,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:237,columnNumber:17},void 0),m.jsxDEV("div",{children:[m.jsxDEV(tr,{htmlFor:"dateTo",children:"To"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:250,columnNumber:19},void 0),m.jsxDEV(Vs,{id:"dateTo",type:"date",value:u.dateRange.to?sc(u.dateRange.to,"yyyy-MM-dd"):"",onChange:y=>h("dateRange",{...u.dateRange,to:y.target.value?new Date(y.target.value):null})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:251,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:249,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:236,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:200,columnNumber:13},void 0),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{children:"Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:266,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex flex-wrap gap-2",children:c.map(y=>m.jsxDEV(We,{type:"button",variant:u.schools.includes(y)?"default":"outline",size:"sm",onClick:()=>v("schools",y),children:y},y,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:269,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:267,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:265,columnNumber:13},void 0),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{children:"Severity Levels"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:284,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex gap-4",children:[m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:"critical",checked:u.severityLevels.includes("critical"),onCheckedChange:()=>v("severityLevels","critical")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:287,columnNumber:19},void 0),m.jsxDEV(tr,{htmlFor:"critical",className:"text-red-600",children:"Critical (< 2.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:292,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:286,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:"needs-attention",checked:u.severityLevels.includes("needs-attention"),onCheckedChange:()=>v("severityLevels","needs-attention")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:295,columnNumber:19},void 0),m.jsxDEV(tr,{htmlFor:"needs-attention",className:"text-orange-600",children:"Needs Attention (2.0-3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:300,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:294,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:"acceptable",checked:u.severityLevels.includes("acceptable"),onCheckedChange:()=>v("severityLevels","acceptable")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:303,columnNumber:19},void 0),m.jsxDEV(tr,{htmlFor:"acceptable",className:"text-green-600",children:"Acceptable (> 3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:308,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:302,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:285,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:283,columnNumber:13},void 0),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{children:["Minimum Rating: ",u.ratingThreshold.toFixed(1)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:315,columnNumber:15},void 0),m.jsxDEV(pN,{value:[u.ratingThreshold],onValueChange:([y])=>h("ratingThreshold",y),max:5,min:0,step:.1,className:"w-full"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:316,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex justify-between text-xs text-muted-foreground",children:[m.jsxDEV("span",{children:"0.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:325,columnNumber:17},void 0),m.jsxDEV("span",{children:"2.5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:326,columnNumber:17},void 0),m.jsxDEV("span",{children:"5.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:327,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:324,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:314,columnNumber:13},void 0),m.jsxDEV(Tp,{children:[m.jsxDEV(Dp,{asChild:!0,children:m.jsxDEV(We,{type:"button",variant:"ghost",className:"w-full justify-between p-0 h-auto",children:[m.jsxDEV(tr,{className:"text-base font-medium",children:"Categories"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:335,columnNumber:19},void 0),m.jsxDEV($i,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:336,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:334,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:333,columnNumber:15},void 0),m.jsxDEV(Ap,{className:"space-y-2 mt-2",children:m.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:jJ.map(y=>m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:y.key,checked:u.categories.includes(y.key),onCheckedChange:()=>v("categories",y.key)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:343,columnNumber:23},void 0),m.jsxDEV(tr,{htmlFor:y.key,className:"text-sm",children:y.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:348,columnNumber:23},void 0)]},y.key,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:342,columnNumber:21},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:340,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:339,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:332,columnNumber:13},void 0),m.jsxDEV(Tp,{children:[m.jsxDEV(Dp,{asChild:!0,children:m.jsxDEV(We,{type:"button",variant:"ghost",className:"w-full justify-between p-0 h-auto",children:[m.jsxDEV(tr,{className:"text-base font-medium",children:"Inspectors"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:359,columnNumber:19},void 0),m.jsxDEV($i,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:360,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:358,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:357,columnNumber:15},void 0),m.jsxDEV(Ap,{className:"space-y-2 mt-2",children:m.jsxDEV("div",{className:"flex flex-wrap gap-2",children:f.map(y=>m.jsxDEV(We,{type:"button",variant:u.inspectors.includes(y)?"default":"outline",size:"sm",onClick:()=>v("inspectors",y),title:x(y),children:y},y,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:366,columnNumber:21},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:364,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:363,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:356,columnNumber:13},void 0),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{children:"Inspection Type"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:383,columnNumber:15},void 0),m.jsxDEV(el,{value:u.inspectionType,onValueChange:y=>h("inspectionType",y),children:[m.jsxDEV(js,{children:m.jsxDEV(rl,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:389,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:388,columnNumber:17},void 0),m.jsxDEV(Ls,{children:[m.jsxDEV(Un,{value:"all",children:"All Types"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:392,columnNumber:19},void 0),m.jsxDEV(Un,{value:"single_room",children:"Single Room"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:393,columnNumber:19},void 0),m.jsxDEV(Un,{value:"whole_building",children:"Whole Building"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:394,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:391,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:384,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:382,columnNumber:13},void 0),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{children:"Quick Filters"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:401,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex gap-4",children:[m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:"problemsOnly",checked:u.showProblemsOnly,onCheckedChange:y=>h("showProblemsOnly",!!y)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:404,columnNumber:19},void 0),m.jsxDEV(tr,{htmlFor:"problemsOnly",children:"Problems Only"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:409,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:403,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:"hasNotes",checked:u.hasCustodialNotes,onCheckedChange:y=>h("hasCustodialNotes",!!y)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:412,columnNumber:19},void 0),m.jsxDEV(tr,{htmlFor:"hasNotes",children:"Has Custodial Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:417,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:411,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:402,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:400,columnNumber:13},void 0),m.jsxDEV("div",{className:"flex justify-between pt-4 border-t",children:[m.jsxDEV(We,{type:"button",variant:"outline",onClick:b,className:"flex items-center gap-2",children:[m.jsxDEV(oi,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:430,columnNumber:17},void 0),"Reset Filters"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:424,columnNumber:15},void 0),m.jsxDEV(We,{type:"button",onClick:N,className:"flex items-center gap-2",children:"Apply Filters"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:433,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:423,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:187,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:186,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:149,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:148,columnNumber:5},void 0)},Ti=e=>e??!1,iT=e=>({...e,showProblemsOnly:!!e.showProblemsOnly,hasCustodialNotes:!!e.hasCustodialNotes}),sue=({filters:e,onApplyPreset:r,schools:t})=>{const n=[{id:"critical-only",label:"Critical Only",description:"Show only critical issues (rating < 2.0)",icon:m.jsxDEV(vn,{className:"w-4 h-4 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:42,columnNumber:13},void 0),applyFilter:s=>({...s,severityLevels:["critical"],showProblemsOnly:!0,ratingThreshold:0}),isActive:s=>s.severityLevels.length===1&&s.severityLevels.includes("critical")&&Ti(s.showProblemsOnly)},{id:"asa-issues",label:"ASA Issues",description:"Focus on ASA school problems",icon:m.jsxDEV(em,{className:"w-4 h-4 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:58,columnNumber:13},void 0),applyFilter:s=>({...s,schools:["ASA School"],severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.schools.length===1&&s.schools.includes("ASA School")&&Ti(s.showProblemsOnly)},{id:"gwc-issues",label:"GWC Issues",description:"Focus on GWC school problems",icon:m.jsxDEV(em,{className:"w-4 h-4 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:74,columnNumber:13},void 0),applyFilter:s=>({...s,schools:["GWC School"],severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.schools.length===1&&s.schools.includes("GWC School")&&Ti(s.showProblemsOnly)},{id:"recent-problems",label:"Recent Problems",description:"Problems from last 30 days",icon:m.jsxDEV(wt,{className:"w-4 h-4 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:90,columnNumber:13},void 0),applyFilter:s=>({...s,dateRange:{from:new Date(Date.now()-2592e6),to:new Date},severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>iT(s).showProblemsOnly===!0&&s.severityLevels.includes("critical")&&s.severityLevels.includes("needs-attention")&&!!s.dateRange.from&&Math.abs(s.dateRange.from.getTime()-(Date.now()-2592e6))<864e5},{id:"urgent-notes",label:"Urgent Notes",description:"Show inspections with urgent custodial notes",icon:m.jsxDEV(Ut,{className:"w-4 h-4 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:113,columnNumber:13},void 0),applyFilter:s=>({...s,hasCustodialNotes:!0,severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>Ti(s.hasCustodialNotes)===!0&&Ti(s.showProblemsOnly)===!0&&s.severityLevels.includes("critical")},{id:"low-performance",label:"Low Performance",description:"All ratings below 3.0",icon:m.jsxDEV(B1,{className:"w-4 h-4 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:129,columnNumber:13},void 0),applyFilter:s=>({...s,ratingThreshold:0,severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.ratingThreshold===0&&Ti(s.showProblemsOnly)&&s.severityLevels.includes("critical")&&s.severityLevels.includes("needs-attention")},{id:"this-month",label:"This Month",description:"All inspections from current month",icon:m.jsxDEV(wt,{className:"w-4 h-4 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:146,columnNumber:13},void 0),applyFilter:s=>({...s,dateRange:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date},schools:[],severityLevels:[],showProblemsOnly:!1}),isActive:s=>{const o=iT(s);return!!s.dateRange.from&&s.dateRange.from.getMonth()===new Date().getMonth()&&s.dateRange.from.getFullYear()===new Date().getFullYear()&&o.showProblemsOnly===!1}},{id:"all-schools",label:"All Schools",description:"Show all schools with problems",icon:m.jsxDEV(em,{className:"w-4 h-4 text-purple-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:169,columnNumber:13},void 0),applyFilter:s=>({...s,schools:t,severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.schools.length===t.length&&Ti(s.showProblemsOnly)&&s.severityLevels.includes("critical")&&s.severityLevels.includes("needs-attention")}],a=s=>{const o=s.applyFilter(e);r(o)},i=(s,o)=>{o.stopPropagation(),r({search:"",dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],inspectors:[],ratingThreshold:0,inspectionType:"all",showProblemsOnly:!1,hasCustodialNotes:!1})};return m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV("h3",{className:"text-lg font-semibold",children:"Quick Filters"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:209,columnNumber:9},void 0),m.jsxDEV(yr,{variant:"outline",className:"text-xs",children:[n.filter(s=>s.isActive(e)).length," active"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:210,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:208,columnNumber:7},void 0),m.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:n.map(s=>{const o=s.isActive(e);return m.jsxDEV(We,{type:"button",variant:o?"default":"outline",className:`h-auto p-4 flex flex-col items-start gap-2 text-left relative ${o?"bg-primary text-primary-foreground border-2 border-primary shadow-lg":"hover:bg-muted/50"} ${o?"outline outline-2 outline-primary":""}`,onClick:()=>a(s),children:[m.jsxDEV("div",{className:"flex items-center gap-2 w-full",children:[s.icon,m.jsxDEV("span",{className:"font-medium text-sm",children:s.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:233,columnNumber:17},void 0),o&&m.jsxDEV("button",{type:"button",onClick:u=>i(s,u),className:"ml-auto p-1 rounded-full hover:bg-primary-foreground/20 transition-colors","aria-label":`Remove ${s.label} filter`,children:m.jsxDEV(oi,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:241,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:235,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:231,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-xs text-muted-foreground text-left",children:s.description},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:245,columnNumber:15},void 0)]},s.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:220,columnNumber:13},void 0)})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:215,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:207,columnNumber:5},void 0)},sT=[{id:"executive",title:"Executive Summary",description:"High-level overview with KPIs, trends, and critical issues for leadership",icon:V1,badge:"Best for monthly reports",color:"bg-blue-50 border-blue-200 hover:bg-blue-100",selectedColor:"bg-blue-100 border-blue-300",iconColor:"text-blue-600"},{id:"school-performance",title:"School Performance",description:"Compare schools, identify trends, and track performance over time",icon:xn,badge:"Best for comparisons",color:"bg-green-50 border-green-200 hover:bg-green-100",selectedColor:"bg-green-100 border-green-300",iconColor:"text-green-600"},{id:"category-analysis",title:"Category Analysis",description:"Deep dive into specific cleaning categories and problem areas",icon:p4,badge:"Best for detailed analysis",color:"bg-purple-50 border-purple-200 hover:bg-purple-100",selectedColor:"bg-purple-100 border-purple-300",iconColor:"text-purple-600"},{id:"issues",title:"Issues Report",description:"List of problems, critical issues, and items needing attention",icon:vn,badge:"Best for problem tracking",color:"bg-red-50 border-red-200 hover:bg-red-100",selectedColor:"bg-red-100 border-red-300",iconColor:"text-red-600"},{id:"custom",title:"Custom Report",description:"Build your own report with flexible sections and data combinations",icon:bV,badge:"Best for specific needs",color:"bg-gray-50 border-gray-200 hover:bg-gray-100",selectedColor:"bg-gray-100 border-gray-300",iconColor:"text-gray-600"}],LJ=({selectedType:e,onTypeChange:r})=>m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("div",{className:"text-center space-y-2",children:[m.jsxDEV("h3",{className:"text-lg font-semibold",children:"Choose Report Type"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:81,columnNumber:9},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Select the type of report that best fits your needs"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:82,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:80,columnNumber:7},void 0),m.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:sT.map(t=>{const n=t.icon,a=e===t.id;return m.jsxDEV(qe,{className:`cursor-pointer transition-all duration-200 ${a?`${t.selectedColor} ring-2 ring-primary/20`:`${t.color} hover:shadow-md`}`,onClick:()=>r(t.id),children:[m.jsxDEV(Qe,{className:"pb-3",children:m.jsxDEV("div",{className:"flex items-start justify-between",children:[m.jsxDEV("div",{className:"flex items-center gap-3",children:[m.jsxDEV("div",{className:`p-2 rounded-lg ${a?"bg-white":"bg-white/50"}`,children:m.jsxDEV(n,{className:`w-5 h-5 ${t.iconColor}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:106,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:105,columnNumber:21},void 0),m.jsxDEV("div",{children:[m.jsxDEV(Ze,{className:"text-base",children:t.title},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:109,columnNumber:23},void 0),m.jsxDEV(yr,{variant:"secondary",className:"text-xs mt-1",children:t.badge},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:110,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:108,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:104,columnNumber:19},void 0),a&&m.jsxDEV("div",{className:"w-5 h-5 rounded-full bg-primary flex items-center justify-center",children:m.jsxDEV("div",{className:"w-2 h-2 rounded-full bg-white"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:120,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:119,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:103,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:102,columnNumber:15},void 0),m.jsxDEV(He,{className:"pt-0",children:m.jsxDEV(mr,{className:"text-sm leading-relaxed",children:t.description},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:126,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:125,columnNumber:15},void 0)]},t.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:93,columnNumber:13},void 0)})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:87,columnNumber:7},void 0),e&&m.jsxDEV("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:m.jsxDEV("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[m.jsxDEV(ja,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:138,columnNumber:13},void 0),m.jsxDEV("span",{children:["Selected: ",m.jsxDEV("strong",{children:sT.find(t=>t.id===e)?.title},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:140,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:139,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:137,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:136,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:79,columnNumber:5},void 0),BJ=({config:e,onConfigChange:r,inspections:t,custodialNotes:n})=>{const a=DJ({inspections:t,custodialNotes:n}),i=(o,u)=>{r({...e,dataTypes:{...e.dataTypes,[o]:u}})},s=(o,u)=>{r({...e,[o]:u})};return m.jsxDEV("div",{className:"space-y-6",children:[m.jsxDEV("div",{className:"text-center space-y-2",children:[m.jsxDEV("h3",{className:"text-lg font-semibold",children:"Select Data to Include"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:52,columnNumber:9},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Choose what data and content to include in your PDF report"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:53,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:51,columnNumber:7},void 0),m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("h4",{className:"text-sm font-medium text-foreground",children:"Data Types"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:60,columnNumber:9},void 0),m.jsxDEV(qe,{className:"hover:shadow-sm transition-shadow",children:m.jsxDEV(Qe,{className:"pb-3",children:m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("div",{className:"flex items-center gap-3",children:[m.jsxDEV(it,{id:"inspections",checked:e.dataTypes.inspections,onCheckedChange:o=>i("inspections",!!o)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:66,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(ja,{className:"w-4 h-4 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:72,columnNumber:19},void 0),m.jsxDEV("div",{children:[m.jsxDEV(Ze,{className:"text-sm",children:"Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:74,columnNumber:21},void 0),m.jsxDEV(mr,{className:"text-xs",children:"Individual inspection records with ratings and details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:75,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:73,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:71,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:65,columnNumber:15},void 0),m.jsxDEV(yr,{variant:"secondary",className:"text-xs",children:[a.inspections," records"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:81,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:63,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:62,columnNumber:9},void 0),m.jsxDEV(qe,{className:"hover:shadow-sm transition-shadow",children:m.jsxDEV(Qe,{className:"pb-3",children:m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("div",{className:"flex items-center gap-3",children:[m.jsxDEV(it,{id:"custodialNotes",checked:e.dataTypes.custodialNotes,onCheckedChange:o=>i("custodialNotes",!!o)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:92,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(NV,{className:"w-4 h-4 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:98,columnNumber:19},void 0),m.jsxDEV("div",{children:[m.jsxDEV(Ze,{className:"text-sm",children:"Custodial Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:100,columnNumber:21},void 0),m.jsxDEV(mr,{className:"text-xs",children:"Notes and comments from custodial staff"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:101,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:99,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:97,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:91,columnNumber:15},void 0),m.jsxDEV(yr,{variant:"secondary",className:"text-xs",children:[a.custodialNotes," notes"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:89,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:88,columnNumber:9},void 0),m.jsxDEV(qe,{className:"hover:shadow-sm transition-shadow",children:m.jsxDEV(Qe,{className:"pb-3",children:m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("div",{className:"flex items-center gap-3",children:[m.jsxDEV(it,{id:"images",checked:e.dataTypes.images,onCheckedChange:o=>i("images",!!o)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:118,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(yV,{className:"w-4 h-4 text-purple-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:124,columnNumber:19},void 0),m.jsxDEV("div",{children:[m.jsxDEV(Ze,{className:"text-sm",children:"Images"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:126,columnNumber:21},void 0),m.jsxDEV(mr,{className:"text-xs",children:"Photos and visual documentation from inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:127,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:125,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:117,columnNumber:15},void 0),m.jsxDEV(yr,{variant:"secondary",className:"text-xs",children:[a.images," images (",a.totalSize,")"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:133,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:116,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:115,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:114,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:59,columnNumber:7},void 0),m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("h4",{className:"text-sm font-medium text-foreground",children:"Content Options"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:143,columnNumber:9},void 0),m.jsxDEV(qe,{className:"hover:shadow-sm transition-shadow",children:m.jsxDEV(Qe,{className:"pb-3",children:m.jsxDEV("div",{className:"flex items-center justify-between",children:m.jsxDEV("div",{className:"flex items-center gap-3",children:[m.jsxDEV(it,{id:"includeCharts",checked:e.includeCharts,onCheckedChange:o=>s("includeCharts",!!o)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:149,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(V1,{className:"w-4 h-4 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:155,columnNumber:19},void 0),m.jsxDEV("div",{children:[m.jsxDEV(Ze,{className:"text-sm",children:"Charts & Visualizations"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:157,columnNumber:21},void 0),m.jsxDEV(mr,{className:"text-xs",children:"Include performance charts, trends, and data visualizations"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:158,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:156,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:154,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:148,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:147,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:146,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:145,columnNumber:9},void 0),m.jsxDEV(qe,{className:"hover:shadow-sm transition-shadow",children:m.jsxDEV(Qe,{className:"pb-3",children:m.jsxDEV("div",{className:"flex items-center justify-between",children:m.jsxDEV("div",{className:"flex items-center gap-3",children:[m.jsxDEV(it,{id:"includeDetails",checked:e.includeDetails,onCheckedChange:o=>s("includeDetails",!!o)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:172,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(CV,{className:"w-4 h-4 text-indigo-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:178,columnNumber:19},void 0),m.jsxDEV("div",{children:[m.jsxDEV(Ze,{className:"text-sm",children:"Individual Details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:180,columnNumber:21},void 0),m.jsxDEV(mr,{className:"text-xs",children:"Include full inspection details instead of summary only"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:181,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:179,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:177,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:171,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:170,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:169,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:168,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:142,columnNumber:7},void 0),m.jsxDEV("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg",children:[m.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[m.jsxDEV(Yo,{className:"w-4 h-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:195,columnNumber:11},void 0),m.jsxDEV("span",{className:"text-sm font-medium",children:"Selected Data Summary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:196,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:194,columnNumber:9},void 0),m.jsxDEV("div",{className:"grid grid-cols-2 gap-4 text-xs text-muted-foreground",children:[m.jsxDEV("div",{children:[e.dataTypes.inspections&&m.jsxDEV("div",{children:["â€¢ ",a.inspections," inspections"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:201,columnNumber:15},void 0),e.dataTypes.custodialNotes&&m.jsxDEV("div",{children:["â€¢ ",a.custodialNotes," notes"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:204,columnNumber:15},void 0),e.dataTypes.images&&m.jsxDEV("div",{children:["â€¢ ",a.images," images"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:207,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:199,columnNumber:11},void 0),m.jsxDEV("div",{children:[e.includeCharts&&m.jsxDEV("div",{children:"â€¢ Charts included"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:211,columnNumber:38},void 0),e.includeDetails&&m.jsxDEV("div",{children:"â€¢ Full details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:212,columnNumber:39},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:210,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:193,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:50,columnNumber:5},void 0)};function c1({className:e,classNames:r,showOutsideDays:t=!0,...n}){return m.jsxDEV(EV,{showOutsideDays:t,className:Ae("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Ae(pl({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Ae(pl({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:({className:a,...i})=>m.jsxDEV(wV,{className:Ae("h-4 w-4",a),...i},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/calendar.tsx",lineNumber:56,columnNumber:11},this),IconRight:({className:a,...i})=>m.jsxDEV(Xc,{className:Ae("h-4 w-4",a),...i},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/calendar.tsx",lineNumber:59,columnNumber:11},this)},...n},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/calendar.tsx",lineNumber:17,columnNumber:5},this)}c1.displayName="Calendar";const $c=_V,Gc=SV,Pl=W.forwardRef(({className:e,align:r="center",sideOffset:t=4,...n},a)=>m.jsxDEV(TV,{children:m.jsxDEV(C4,{ref:a,align:r,sideOffset:t,className:Ae("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",e),...n},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/popover.tsx",lineNumber:15,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/popover.tsx",lineNumber:14,columnNumber:3},void 0));Pl.displayName=C4.displayName;const qJ=[{label:"Last 7 days",days:7},{label:"Last 30 days",days:30},{label:"Last 90 days",days:90},{label:"This year",days:365}],HJ=[{id:"critical",label:"Critical",description:"Rating â‰¤ 2 stars"},{id:"needs-attention",label:"Needs Attention",description:"Rating â‰¤ 3 stars"},{id:"acceptable",label:"Acceptable",description:"Rating > 3 stars"}],zJ=({config:e,onConfigChange:r,availableSchools:t,availableCategories:n})=>{const a=(c,f)=>{r({...e,filters:{...e.filters,[c]:f}})},i=c=>{const f=new Date,h=new Date;h.setDate(h.getDate()-c),a("dateRange",{from:h,to:f})},s=(c,f)=>{const h=e.filters[c],d=h.includes(f)?h.filter(v=>v!==f):[...h,f];a(c,d)},o=()=>{r({...e,filters:{dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],ratingThreshold:0}})},l=(()=>{let c=0;return(e.filters.dateRange.from||e.filters.dateRange.to)&&c++,e.filters.schools.length>0&&c++,e.filters.severityLevels.length>0&&c++,e.filters.categories.length>0&&c++,e.filters.ratingThreshold>0&&c++,c})();return m.jsxDEV("div",{className:"space-y-6",children:[m.jsxDEV("div",{className:"text-center space-y-2",children:[m.jsxDEV("h3",{className:"text-lg font-semibold",children:"Apply Filters"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:93,columnNumber:9},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Narrow down the data to include in your report"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:94,columnNumber:9},void 0),l>0&&m.jsxDEV("div",{className:"flex items-center justify-center gap-2",children:[m.jsxDEV(yr,{variant:"secondary",className:"text-xs",children:[l," filter",l!==1?"s":""," active"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:99,columnNumber:13},void 0),m.jsxDEV(We,{variant:"ghost",size:"sm",onClick:o,className:"text-xs h-6 px-2",children:[m.jsxDEV(oi,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:108,columnNumber:15},void 0),"Clear all"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:102,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:98,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:92,columnNumber:7},void 0),m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"pb-3",children:m.jsxDEV(Ze,{className:"text-sm flex items-center gap-2",children:[m.jsxDEV(wt,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:119,columnNumber:13},void 0),"Date Range"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:118,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:117,columnNumber:9},void 0),m.jsxDEV(He,{className:"space-y-4",children:[m.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:qJ.map(c=>m.jsxDEV(We,{variant:"outline",size:"sm",onClick:()=>i(c.days),className:"text-xs",children:c.label},c.label,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:127,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:125,columnNumber:11},void 0),m.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxDEV("div",{children:[m.jsxDEV("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"From"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:142,columnNumber:15},void 0),m.jsxDEV($c,{children:[m.jsxDEV(Gc,{asChild:!0,children:m.jsxDEV(We,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[m.jsxDEV(wt,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:148,columnNumber:21},void 0),e.filters.dateRange.from?sc(e.filters.dateRange.from,"MMM dd, yyyy"):m.jsxDEV("span",{children:"Select date"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:152,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:147,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:146,columnNumber:17},void 0),m.jsxDEV(Pl,{className:"w-auto p-0",children:m.jsxDEV(c1,{mode:"single",selected:e.filters.dateRange.from||void 0,onSelect:c=>a("dateRange",{...e.filters.dateRange,from:c||null}),initialFocus:!0},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:157,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:156,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:145,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:141,columnNumber:13},void 0),m.jsxDEV("div",{children:[m.jsxDEV("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"To"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:171,columnNumber:15},void 0),m.jsxDEV($c,{children:[m.jsxDEV(Gc,{asChild:!0,children:m.jsxDEV(We,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[m.jsxDEV(wt,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:177,columnNumber:21},void 0),e.filters.dateRange.to?sc(e.filters.dateRange.to,"MMM dd, yyyy"):m.jsxDEV("span",{children:"Select date"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:181,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:176,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:175,columnNumber:17},void 0),m.jsxDEV(Pl,{className:"w-auto p-0",children:m.jsxDEV(c1,{mode:"single",selected:e.filters.dateRange.to||void 0,onSelect:c=>a("dateRange",{...e.filters.dateRange,to:c||null}),initialFocus:!0},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:186,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:185,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:174,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:170,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:140,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:123,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:116,columnNumber:7},void 0),m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"pb-3",children:[m.jsxDEV(Ze,{className:"text-sm",children:"Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:205,columnNumber:11},void 0),m.jsxDEV(mr,{className:"text-xs",children:"Select specific schools to include"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:206,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:204,columnNumber:9},void 0),m.jsxDEV(He,{children:[m.jsxDEV("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:t.map(c=>m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:`school-${c}`,checked:e.filters.schools.includes(c),onCheckedChange:()=>s("schools",c)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:214,columnNumber:17},void 0),m.jsxDEV("label",{htmlFor:`school-${c}`,className:"text-sm",children:c},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:219,columnNumber:17},void 0)]},c,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:213,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:211,columnNumber:11},void 0),e.filters.schools.length>0&&m.jsxDEV("div",{className:"mt-2 flex flex-wrap gap-1",children:e.filters.schools.map(c=>m.jsxDEV(yr,{variant:"secondary",className:"text-xs",children:c},c,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:228,columnNumber:17},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:226,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:210,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:203,columnNumber:7},void 0),m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"pb-3",children:[m.jsxDEV(Ze,{className:"text-sm",children:"Severity Levels"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:240,columnNumber:11},void 0),m.jsxDEV(mr,{className:"text-xs",children:"Filter by problem severity"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:241,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:239,columnNumber:9},void 0),m.jsxDEV(He,{children:m.jsxDEV("div",{className:"space-y-2",children:HJ.map(c=>m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:`severity-${c.id}`,checked:e.filters.severityLevels.includes(c.id),onCheckedChange:()=>s("severityLevels",c.id)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:249,columnNumber:17},void 0),m.jsxDEV("div",{className:"flex-1",children:[m.jsxDEV("label",{htmlFor:`severity-${c.id}`,className:"text-sm font-medium",children:c.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:255,columnNumber:19},void 0),m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:c.description},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:258,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:254,columnNumber:17},void 0)]},c.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:248,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:246,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:245,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:238,columnNumber:7},void 0),m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"pb-3",children:[m.jsxDEV(Ze,{className:"text-sm",children:"Categories"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:269,columnNumber:11},void 0),m.jsxDEV(mr,{className:"text-xs",children:"Select specific cleaning categories"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:270,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:268,columnNumber:9},void 0),m.jsxDEV(He,{children:m.jsxDEV("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:n.map(c=>m.jsxDEV("div",{className:"flex items-center space-x-2",children:[m.jsxDEV(it,{id:`category-${c.key}`,checked:e.filters.categories.includes(c.key),onCheckedChange:()=>s("categories",c.key)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:278,columnNumber:17},void 0),m.jsxDEV("label",{htmlFor:`category-${c.key}`,className:"text-sm",children:c.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:283,columnNumber:17},void 0)]},c.key,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:277,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:275,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:274,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:267,columnNumber:7},void 0),m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"pb-3",children:[m.jsxDEV(Ze,{className:"text-sm",children:"Rating Threshold"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:295,columnNumber:11},void 0),m.jsxDEV(mr,{className:"text-xs",children:"Only include inspections with average rating at or below this threshold"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:296,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:294,columnNumber:9},void 0),m.jsxDEV(He,{children:m.jsxDEV("div",{className:"space-y-3",children:[m.jsxDEV(pN,{value:[e.filters.ratingThreshold],onValueChange:([c])=>a("ratingThreshold",c),max:5,min:0,step:.5,className:"w-full"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:302,columnNumber:13},void 0),m.jsxDEV("div",{className:"flex justify-between text-xs text-muted-foreground",children:[m.jsxDEV("span",{children:"All ratings"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:311,columnNumber:15},void 0),m.jsxDEV("span",{className:"font-medium",children:e.filters.ratingThreshold>0?`â‰¤ ${e.filters.ratingThreshold} stars`:"No filter"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:312,columnNumber:15},void 0),m.jsxDEV("span",{children:"1 star only"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:318,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:310,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:301,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:300,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:293,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:91,columnNumber:5},void 0)},cl=W.forwardRef(({className:e,value:r,...t},n)=>m.jsxDEV(E4,{ref:n,className:Ae("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...t,children:m.jsxDEV(DV,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/progress.tsx",lineNumber:20,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/progress.tsx",lineNumber:12,columnNumber:3},void 0));cl.displayName=E4.displayName;const $J=({config:e,inspections:r,custodialNotes:t,onExport:n,isExporting:a=!1,exportProgress:i=0})=>{const s=u1(e),o=Co({inspections:r,custodialNotes:t},e),u=_J(e,{inspections:r,custodialNotes:t}),l=SJ(e,{inspections:r,custodialNotes:t}),c=TJ(e),h=(()=>{const d={executive:{name:"Executive Summary",icon:"ðŸ“Š",color:"bg-blue-100 text-blue-800"},"school-performance":{name:"School Performance",icon:"ðŸ«",color:"bg-green-100 text-green-800"},"category-analysis":{name:"Category Analysis",icon:"ðŸŽ¯",color:"bg-purple-100 text-purple-800"},issues:{name:"Issues Report",icon:"âš ï¸",color:"bg-red-100 text-red-800"},custom:{name:"Custom Report",icon:"âš™ï¸",color:"bg-gray-100 text-gray-800"}};return d[e.reportType]||d.custom})();return m.jsxDEV("div",{className:"space-y-6",children:[m.jsxDEV("div",{className:"text-center space-y-2",children:[m.jsxDEV("h3",{className:"text-lg font-semibold",children:"Review & Export"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:59,columnNumber:9},void 0),m.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Review your selections and generate the PDF report"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:60,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:58,columnNumber:7},void 0),a&&m.jsxDEV(qe,{className:"border-primary/20 bg-primary/5",children:m.jsxDEV(He,{className:"pt-6",children:m.jsxDEV("div",{className:"space-y-3",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(ic,{className:"w-4 h-4 animate-spin text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:71,columnNumber:17},void 0),m.jsxDEV("span",{className:"text-sm font-medium",children:"Generating PDF..."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:72,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:70,columnNumber:15},void 0),m.jsxDEV(cl,{value:i,className:"w-full"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:74,columnNumber:15},void 0),m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"This may take a moment for large reports with images and charts"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:69,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:68,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:67,columnNumber:9},void 0),m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"pb-3",children:m.jsxDEV(Ze,{className:"text-sm flex items-center gap-2",children:[m.jsxDEV(ja,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:87,columnNumber:13},void 0),"Report Summary"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:86,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:85,columnNumber:9},void 0),m.jsxDEV(He,{className:"space-y-4",children:[m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("span",{className:"text-sm font-medium",children:"Report Type"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:94,columnNumber:13},void 0),m.jsxDEV(yr,{className:h.color,children:[m.jsxDEV("span",{className:"mr-1",children:h.icon},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:96,columnNumber:15},void 0),h.name]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:95,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:93,columnNumber:11},void 0),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV("span",{className:"text-sm font-medium",children:"Data Included"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:103,columnNumber:13},void 0),m.jsxDEV("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.dataTypes.inspections&&m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(Yo,{className:"w-3 h-3 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:107,columnNumber:19},void 0),m.jsxDEV("span",{children:[o.inspections.length," inspections"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:108,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:106,columnNumber:17},void 0),e.dataTypes.custodialNotes&&m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(Yo,{className:"w-3 h-3 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:113,columnNumber:19},void 0),m.jsxDEV("span",{children:[o.custodialNotes.length," notes"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:114,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:112,columnNumber:17},void 0),e.dataTypes.images&&m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(Yo,{className:"w-3 h-3 text-purple-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:119,columnNumber:19},void 0),m.jsxDEV("span",{children:"Images included"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:120,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:118,columnNumber:17},void 0),e.includeCharts&&m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(Yo,{className:"w-3 h-3 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:125,columnNumber:19},void 0),m.jsxDEV("span",{children:"Charts included"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:126,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:104,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:102,columnNumber:11},void 0),c.length>0&&m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV("span",{className:"text-sm font-medium flex items-center gap-2",children:[m.jsxDEV(y4,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:136,columnNumber:17},void 0),"Active Filters"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:135,columnNumber:15},void 0),m.jsxDEV("div",{className:"flex flex-wrap gap-1",children:c.map((d,v)=>m.jsxDEV(yr,{variant:"secondary",className:"text-xs",children:d},v,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:141,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:139,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:134,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:91,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:84,columnNumber:7},void 0),m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"pb-3",children:m.jsxDEV(Ze,{className:"text-sm",children:"Export Details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:154,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:153,columnNumber:9},void 0),m.jsxDEV(He,{className:"space-y-3",children:m.jsxDEV("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("span",{className:"text-muted-foreground",children:"File Size"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:159,columnNumber:15},void 0),m.jsxDEV("span",{className:"font-medium",children:u},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:160,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:158,columnNumber:13},void 0),m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("span",{className:"text-muted-foreground",children:"Pages"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:163,columnNumber:15},void 0),m.jsxDEV("span",{className:"font-medium",children:l},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:164,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:162,columnNumber:13},void 0),m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("span",{className:"text-muted-foreground",children:"Records"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:167,columnNumber:15},void 0),m.jsxDEV("span",{className:"font-medium",children:o.totalRecords},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:168,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:166,columnNumber:13},void 0),m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("span",{className:"text-muted-foreground",children:"Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:171,columnNumber:15},void 0),m.jsxDEV("span",{className:"font-medium",children:o.schools.length>0?o.schools.length:"All"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:172,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:170,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:157,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:156,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:152,columnNumber:7},void 0),!s.isValid&&m.jsxDEV(qe,{className:"border-red-200 bg-red-50",children:m.jsxDEV(He,{className:"pt-6",children:m.jsxDEV("div",{className:"flex items-start gap-2",children:[m.jsxDEV(Ut,{className:"w-4 h-4 text-red-600 mt-0.5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:185,columnNumber:15},void 0),m.jsxDEV("div",{className:"space-y-1",children:[m.jsxDEV("p",{className:"text-sm font-medium text-red-800",children:"Please fix the following issues:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:187,columnNumber:17},void 0),m.jsxDEV("ul",{className:"text-xs text-red-700 space-y-1",children:s.errors.map((d,v)=>m.jsxDEV("li",{children:["â€¢ ",d]},v,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:190,columnNumber:21},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:188,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:186,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:184,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:183,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:182,columnNumber:9},void 0),m.jsxDEV("div",{className:"flex justify-center",children:m.jsxDEV(We,{onClick:n,disabled:!s.isValid||a,size:"lg",className:"min-w-[200px]",children:a?m.jsxDEV(m.Fragment,{children:[m.jsxDEV(ic,{className:"w-4 h-4 mr-2 animate-spin"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:209,columnNumber:15},void 0),"Generating..."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:208,columnNumber:13},void 0):m.jsxDEV(m.Fragment,{children:[m.jsxDEV(Qi,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:214,columnNumber:15},void 0),"Export PDF Report"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:213,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:201,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:200,columnNumber:7},void 0),!a&&s.isValid&&m.jsxDEV("div",{className:"flex items-center justify-center gap-2 text-sm text-green-700 bg-green-50 p-3 rounded-lg",children:[m.jsxDEV(Pn,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:224,columnNumber:11},void 0),m.jsxDEV("span",{children:"Ready to export! Click the button above to generate your PDF."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:225,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:223,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:57,columnNumber:5},void 0)},oue=({inspections:e,custodialNotes:r,availableSchools:t,availableCategories:n,trigger:a,onExportComplete:i})=>{const{toast:s}=Qc(),[o,u]=W.useState(!1),[l,c]=W.useState(1),[f,h]=W.useState(!1),[d,v]=W.useState(0),[p,x]=W.useState({reportType:"executive",dataTypes:{inspections:!0,custodialNotes:!1,images:!1},filters:{dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],ratingThreshold:0},includeCharts:!0,includeDetails:!1}),g=[{id:1,title:"Report Type",description:"Choose your report type",isComplete:!1},{id:2,title:"Data Selection",description:"Select data to include",isComplete:!1},{id:3,title:"Filters",description:"Apply filters and criteria",isComplete:!1},{id:4,title:"Export",description:"Review and generate PDF",isComplete:!1}],N=W.useCallback((k,D)=>{},[]),b=()=>{l<g.length&&c(l+1)},y=()=>{l>1&&c(l-1)},_=k=>{x(k),u1(k),l===1&&k.reportType?N(1,!0):l===2&&(k.dataTypes.inspections||k.dataTypes.custodialNotes)?N(2,!0):l===3&&N(3,!0)},w=async()=>{try{h(!0),v(0);const k=u1(p);if(!k.isValid){s({title:"Export Error",description:k.errors.join(", "),variant:"destructive"});return}const D=setInterval(()=>{v(B=>B>=90?(clearInterval(D),B):B+Math.random()*20)},200),U=Co({inspections:e,custodialNotes:r},p);let F;switch(p.reportType){case"issues":F=xI({inspections:U.inspections,custodialNotes:U.custodialNotes,startDate:p.filters.dateRange.from||void 0,endDate:p.filters.dateRange.to||void 0,schoolFilter:p.filters.schools.length===1?p.filters.schools[0]:void 0,activeFilters:[]});break;case"executive":F=UJ({inspections:e,custodialNotes:r},p);break;case"school-performance":F=IJ({inspections:e,custodialNotes:r},p);break;case"category-analysis":F=PJ({inspections:e,custodialNotes:r},p);break;case"custom":F=VJ({inspections:e,custodialNotes:r},p);break;default:throw new Error("Invalid report type")}clearInterval(D),v(100);const L=URL.createObjectURL(F),P=document.createElement("a");P.href=L,P.download=`custodial-report-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(L),s({title:"Export Successful",description:"Your PDF report has been generated and downloaded."}),u(!1),i?.()}catch(k){console.error("Export failed:",k),s({title:"Export Failed",description:"There was an error generating your PDF report. Please try again.",variant:"destructive"})}finally{h(!1),v(0)}},C=()=>{switch(l){case 1:return m.jsxDEV(LJ,{selectedType:p.reportType,onTypeChange:k=>_({...p,reportType:k})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:226,columnNumber:11},void 0);case 2:return m.jsxDEV(BJ,{config:p,onConfigChange:_,inspections:e,custodialNotes:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:233,columnNumber:11},void 0);case 3:return m.jsxDEV(zJ,{config:p,onConfigChange:_,availableSchools:t,availableCategories:n},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:242,columnNumber:11},void 0);case 4:return m.jsxDEV($J,{config:p,inspections:e,custodialNotes:r,onExport:w,isExporting:f,exportProgress:d},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:251,columnNumber:11},void 0);default:return null}};return m.jsxDEV(af,{open:o,onOpenChange:u,children:[a&&m.jsxDEV("div",{onClick:k=>{k.preventDefault(),k.stopPropagation(),u(!0)},children:a},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:268,columnNumber:9},void 0),m.jsxDEV(Hl,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[m.jsxDEV(zl,{children:[m.jsxDEV($l,{className:"flex items-center gap-2",children:[m.jsxDEV(ja,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:281,columnNumber:13},void 0),"PDF Export Wizard"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:280,columnNumber:11},void 0),m.jsxDEV(Gl,{children:["Step ",l," of ",g.length,": ",g[l-1]?.description]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:284,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:279,columnNumber:9},void 0),m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("div",{className:"flex items-center justify-between",children:g.map((k,D)=>m.jsxDEV("div",{className:"flex items-center",children:[m.jsxDEV("div",{className:`
                  flex items-center justify-center w-8 h-8 rounded-full border-2 transition-colors
                  ${l>k.id?"bg-primary border-primary text-primary-foreground":l===k.id?"border-primary text-primary":"border-muted-foreground text-muted-foreground"}
                `,children:l>k.id?m.jsxDEV(Pn,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:304,columnNumber:21},void 0):m.jsxDEV("span",{className:"text-sm font-medium",children:k.id},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:306,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:294,columnNumber:17},void 0),D<g.length-1&&m.jsxDEV("div",{className:`
                    w-12 h-0.5 mx-2 transition-colors
                    ${l>k.id?"bg-primary":"bg-muted-foreground/30"}
                  `},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:310,columnNumber:19},void 0)]},k.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:293,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:291,columnNumber:11},void 0),m.jsxDEV("div",{className:"flex justify-between text-xs text-muted-foreground",children:g.map(k=>m.jsxDEV("div",{className:"text-center max-w-20",children:m.jsxDEV("div",{className:"font-medium",children:k.title},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:322,columnNumber:17},void 0)},k.id,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:321,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:319,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:290,columnNumber:9},void 0),m.jsxDEV("div",{className:"py-6",children:C()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:329,columnNumber:9},void 0),m.jsxDEV("div",{className:"flex items-center justify-between pt-4 border-t",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:m.jsxDEV(We,{variant:"outline",onClick:()=>u(!1),disabled:f,children:[m.jsxDEV(oi,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:341,columnNumber:15},void 0),"Cancel"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:336,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:335,columnNumber:11},void 0),m.jsxDEV("div",{className:"flex items-center gap-2",children:[l>1&&m.jsxDEV(We,{variant:"outline",onClick:y,disabled:f,children:[m.jsxDEV(AV,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:353,columnNumber:17},void 0),"Back"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:348,columnNumber:15},void 0),l<g.length&&m.jsxDEV(We,{onClick:b,disabled:f,children:["Next",m.jsxDEV(kV,{className:"w-4 h-4 ml-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:364,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:359,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:346,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:334,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:278,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:266,columnNumber:5},void 0)},lue=RV,uue=OV,GJ=FV,gI=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(A4,{className:Ae("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r,ref:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:17,columnNumber:3},void 0));gI.displayName=A4.displayName;const WJ=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(GJ,{children:[m.jsxDEV(gI,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:33,columnNumber:5},void 0),m.jsxDEV(w4,{ref:t,className:Ae("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:34,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:32,columnNumber:3},void 0));WJ.displayName=w4.displayName;const YJ=({className:e,...r})=>m.jsxDEV("div",{className:Ae("flex flex-col space-y-2 text-center sm:text-left",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:50,columnNumber:3},void 0);YJ.displayName="AlertDialogHeader";const KJ=({className:e,...r})=>m.jsxDEV("div",{className:Ae("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:64,columnNumber:3},void 0);KJ.displayName="AlertDialogFooter";const XJ=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(_4,{ref:t,className:Ae("text-lg font-semibold",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:78,columnNumber:3},void 0));XJ.displayName=_4.displayName;const QJ=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(S4,{ref:t,className:Ae("text-sm text-muted-foreground",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:90,columnNumber:3},void 0));QJ.displayName=S4.displayName;const ZJ=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(D4,{ref:t,className:Ae(pl(),e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:103,columnNumber:3},void 0));ZJ.displayName=D4.displayName;const JJ=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(T4,{ref:t,className:Ae(pl({variant:"outline"}),"mt-2 sm:mt-0",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:115,columnNumber:3},void 0));JJ.displayName=T4.displayName;var oT=1,eee=.9,ree=.8,tee=.17,kp=.1,Rp=.999,nee=.9999,aee=.99,iee=/[\\\/_+.#"@\[\(\{&]/,see=/[\\\/_+.#"@\[\(\{&]/g,oee=/[\s-]/,bI=/[\s-]/g;function f1(e,r,t,n,a,i,s){if(i===r.length)return a===e.length?oT:aee;var o=`${a},${i}`;if(s[o]!==void 0)return s[o];for(var u=n.charAt(i),l=t.indexOf(u,a),c=0,f,h,d,v;l>=0;)f=f1(e,r,t,n,l+1,i+1,s),f>c&&(l===a?f*=oT:iee.test(e.charAt(l-1))?(f*=ree,d=e.slice(a,l-1).match(see),d&&a>0&&(f*=Math.pow(Rp,d.length))):oee.test(e.charAt(l-1))?(f*=eee,v=e.slice(a,l-1).match(bI),v&&a>0&&(f*=Math.pow(Rp,v.length))):(f*=tee,a>0&&(f*=Math.pow(Rp,l-a))),e.charAt(l)!==r.charAt(i)&&(f*=nee)),(f<kp&&t.charAt(l-1)===n.charAt(i+1)||n.charAt(i+1)===n.charAt(i)&&t.charAt(l-1)!==n.charAt(i))&&(h=f1(e,r,t,n,l+1,i+2,s),h*kp>f&&(f=h*kp)),f>c&&(c=f),l=t.indexOf(u,l+1);return s[o]=c,c}function lT(e){return e.toLowerCase().replace(bI," ")}function lee(e,r,t){return e=t&&t.length>0?`${e+" "+t.join(" ")}`:e,f1(e,r,lT(e),lT(r),0,0,{})}var Bo='[cmdk-group=""]',Op='[cmdk-group-items=""]',uee='[cmdk-group-heading=""]',NI='[cmdk-item=""]',uT=`${NI}:not([aria-disabled="true"])`,m1="cmdk-item-select",Os="data-value",cee=(e,r,t)=>lee(e,r,t),yI=W.createContext(void 0),su=()=>W.useContext(yI),CI=W.createContext(void 0),vN=()=>W.useContext(CI),EI=W.createContext(void 0),wI=W.forwardRef((e,r)=>{let t=Fs(()=>{var T,E;return{search:"",value:(E=(T=e.value)!=null?T:e.defaultValue)!=null?E:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=Fs(()=>new Set),a=Fs(()=>new Map),i=Fs(()=>new Map),s=Fs(()=>new Set),o=_I(e),{label:u,children:l,value:c,onValueChange:f,filter:h,shouldFilter:d,loop:v,disablePointerSelection:p=!1,vimBindings:x=!0,...g}=e,N=Ps(),b=Ps(),y=Ps(),_=W.useRef(null),w=yee();ss(()=>{if(c!==void 0){let T=c.trim();t.current.value=T,C.emit()}},[c]),ss(()=>{w(6,P)},[]);let C=W.useMemo(()=>({subscribe:T=>(s.current.add(T),()=>s.current.delete(T)),snapshot:()=>t.current,setState:(T,E,V)=>{var I,Y,ie,le;if(!Object.is(t.current[T],E)){if(t.current[T]=E,T==="search")L(),U(),w(1,F);else if(T==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let X=document.getElementById(y);X?X.focus():(I=document.getElementById(N))==null||I.focus()}if(w(7,()=>{var X;t.current.selectedItemId=(X=B())==null?void 0:X.id,C.emit()}),V||w(5,P),((Y=o.current)==null?void 0:Y.value)!==void 0){let X=E??"";(le=(ie=o.current).onValueChange)==null||le.call(ie,X);return}}C.emit()}},emit:()=>{s.current.forEach(T=>T())}}),[]),k=W.useMemo(()=>({value:(T,E,V)=>{var I;E!==((I=i.current.get(T))==null?void 0:I.value)&&(i.current.set(T,{value:E,keywords:V}),t.current.filtered.items.set(T,D(E,V)),w(2,()=>{U(),C.emit()}))},item:(T,E)=>(n.current.add(T),E&&(a.current.has(E)?a.current.get(E).add(T):a.current.set(E,new Set([T]))),w(3,()=>{L(),U(),t.current.value||F(),C.emit()}),()=>{i.current.delete(T),n.current.delete(T),t.current.filtered.items.delete(T);let V=B();w(4,()=>{L(),V?.getAttribute("id")===T&&F(),C.emit()})}),group:T=>(a.current.has(T)||a.current.set(T,new Set),()=>{i.current.delete(T),a.current.delete(T)}),filter:()=>o.current.shouldFilter,label:u||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:N,inputId:y,labelId:b,listInnerRef:_}),[]);function D(T,E){var V,I;let Y=(I=(V=o.current)==null?void 0:V.filter)!=null?I:cee;return T?Y(T,t.current.search,E):0}function U(){if(!t.current.search||o.current.shouldFilter===!1)return;let T=t.current.filtered.items,E=[];t.current.filtered.groups.forEach(I=>{let Y=a.current.get(I),ie=0;Y.forEach(le=>{let X=T.get(le);ie=Math.max(X,ie)}),E.push([I,ie])});let V=_.current;G().sort((I,Y)=>{var ie,le;let X=I.getAttribute("id"),Q=Y.getAttribute("id");return((ie=T.get(Q))!=null?ie:0)-((le=T.get(X))!=null?le:0)}).forEach(I=>{let Y=I.closest(Op);Y?Y.appendChild(I.parentElement===Y?I:I.closest(`${Op} > *`)):V.appendChild(I.parentElement===V?I:I.closest(`${Op} > *`))}),E.sort((I,Y)=>Y[1]-I[1]).forEach(I=>{var Y;let ie=(Y=_.current)==null?void 0:Y.querySelector(`${Bo}[${Os}="${encodeURIComponent(I[0])}"]`);ie?.parentElement.appendChild(ie)})}function F(){let T=G().find(V=>V.getAttribute("aria-disabled")!=="true"),E=T?.getAttribute(Os);C.setState("value",E||void 0)}function L(){var T,E,V,I;if(!t.current.search||o.current.shouldFilter===!1){t.current.filtered.count=n.current.size;return}t.current.filtered.groups=new Set;let Y=0;for(let ie of n.current){let le=(E=(T=i.current.get(ie))==null?void 0:T.value)!=null?E:"",X=(I=(V=i.current.get(ie))==null?void 0:V.keywords)!=null?I:[],Q=D(le,X);t.current.filtered.items.set(ie,Q),Q>0&&Y++}for(let[ie,le]of a.current)for(let X of le)if(t.current.filtered.items.get(X)>0){t.current.filtered.groups.add(ie);break}t.current.filtered.count=Y}function P(){var T,E,V;let I=B();I&&(((T=I.parentElement)==null?void 0:T.firstChild)===I&&((V=(E=I.closest(Bo))==null?void 0:E.querySelector(uee))==null||V.scrollIntoView({block:"nearest"})),I.scrollIntoView({block:"nearest"}))}function B(){var T;return(T=_.current)==null?void 0:T.querySelector(`${NI}[aria-selected="true"]`)}function G(){var T;return Array.from(((T=_.current)==null?void 0:T.querySelectorAll(uT))||[])}function ue(T){let E=G()[T];E&&C.setState("value",E.getAttribute(Os))}function oe(T){var E;let V=B(),I=G(),Y=I.findIndex(le=>le===V),ie=I[Y+T];(E=o.current)!=null&&E.loop&&(ie=Y+T<0?I[I.length-1]:Y+T===I.length?I[0]:I[Y+T]),ie&&C.setState("value",ie.getAttribute(Os))}function he(T){let E=B(),V=E?.closest(Bo),I;for(;V&&!I;)V=T>0?bee(V,Bo):Nee(V,Bo),I=V?.querySelector(uT);I?C.setState("value",I.getAttribute(Os)):oe(T)}let fe=()=>ue(G().length-1),S=T=>{T.preventDefault(),T.metaKey?fe():T.altKey?he(1):oe(1)},re=T=>{T.preventDefault(),T.metaKey?ue(0):T.altKey?he(-1):oe(-1)};return W.createElement(pi.div,{ref:r,tabIndex:-1,...g,"cmdk-root":"",onKeyDown:T=>{var E;(E=g.onKeyDown)==null||E.call(g,T);let V=T.nativeEvent.isComposing||T.keyCode===229;if(!(T.defaultPrevented||V))switch(T.key){case"n":case"j":{x&&T.ctrlKey&&S(T);break}case"ArrowDown":{S(T);break}case"p":case"k":{x&&T.ctrlKey&&re(T);break}case"ArrowUp":{re(T);break}case"Home":{T.preventDefault(),ue(0);break}case"End":{T.preventDefault(),fe();break}case"Enter":{T.preventDefault();let I=B();if(I){let Y=new Event(m1);I.dispatchEvent(Y)}}}}},W.createElement("label",{"cmdk-label":"",htmlFor:k.inputId,id:k.labelId,style:Eee},u),Rf(e,T=>W.createElement(CI.Provider,{value:C},W.createElement(yI.Provider,{value:k},T))))}),fee=W.forwardRef((e,r)=>{var t,n;let a=Ps(),i=W.useRef(null),s=W.useContext(EI),o=su(),u=_I(e),l=(n=(t=u.current)==null?void 0:t.forceMount)!=null?n:s?.forceMount;ss(()=>{if(!l)return o.item(a,s?.id)},[l]);let c=SI(a,i,[e.value,e.children,i],e.keywords),f=vN(),h=di(w=>w.value&&w.value===c.current),d=di(w=>l||o.filter()===!1?!0:w.search?w.filtered.items.get(a)>0:!0);W.useEffect(()=>{let w=i.current;if(!(!w||e.disabled))return w.addEventListener(m1,v),()=>w.removeEventListener(m1,v)},[d,e.onSelect,e.disabled]);function v(){var w,C;p(),(C=(w=u.current).onSelect)==null||C.call(w,c.current)}function p(){f.setState("value",c.current,!0)}if(!d)return null;let{disabled:x,value:g,onSelect:N,forceMount:b,keywords:y,..._}=e;return W.createElement(pi.div,{ref:hl(i,r),..._,id:a,"cmdk-item":"",role:"option","aria-disabled":!!x,"aria-selected":!!h,"data-disabled":!!x,"data-selected":!!h,onPointerMove:x||o.getDisablePointerSelection()?void 0:p,onClick:x?void 0:v},e.children)}),mee=W.forwardRef((e,r)=>{let{heading:t,children:n,forceMount:a,...i}=e,s=Ps(),o=W.useRef(null),u=W.useRef(null),l=Ps(),c=su(),f=di(d=>a||c.filter()===!1?!0:d.search?d.filtered.groups.has(s):!0);ss(()=>c.group(s),[]),SI(s,o,[e.value,e.heading,u]);let h=W.useMemo(()=>({id:s,forceMount:a}),[a]);return W.createElement(pi.div,{ref:hl(o,r),...i,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},t&&W.createElement("div",{ref:u,"cmdk-group-heading":"","aria-hidden":!0,id:l},t),Rf(e,d=>W.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?l:void 0},W.createElement(EI.Provider,{value:h},d))))}),dee=W.forwardRef((e,r)=>{let{alwaysRender:t,...n}=e,a=W.useRef(null),i=di(s=>!s.search);return!t&&!i?null:W.createElement(pi.div,{ref:hl(a,r),...n,"cmdk-separator":"",role:"separator"})}),hee=W.forwardRef((e,r)=>{let{onValueChange:t,...n}=e,a=e.value!=null,i=vN(),s=di(l=>l.search),o=di(l=>l.selectedItemId),u=su();return W.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),W.createElement(pi.input,{ref:r,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":u.listId,"aria-labelledby":u.labelId,"aria-activedescendant":o,id:u.inputId,type:"text",value:a?e.value:s,onChange:l=>{a||i.setState("search",l.target.value),t?.(l.target.value)}})}),pee=W.forwardRef((e,r)=>{let{children:t,label:n="Suggestions",...a}=e,i=W.useRef(null),s=W.useRef(null),o=di(l=>l.selectedItemId),u=su();return W.useEffect(()=>{if(s.current&&i.current){let l=s.current,c=i.current,f,h=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let d=l.offsetHeight;c.style.setProperty("--cmdk-list-height",d.toFixed(1)+"px")})});return h.observe(l),()=>{cancelAnimationFrame(f),h.unobserve(l)}}},[]),W.createElement(pi.div,{ref:hl(i,r),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":n,id:u.listId},Rf(e,l=>W.createElement("div",{ref:hl(s,u.listInnerRef),"cmdk-list-sizer":""},l)))}),vee=W.forwardRef((e,r)=>{let{open:t,onOpenChange:n,overlayClassName:a,contentClassName:i,container:s,...o}=e;return W.createElement(i4,{open:t,onOpenChange:n},W.createElement(s4,{container:s},W.createElement(L1,{"cmdk-overlay":"",className:a}),W.createElement(j1,{"aria-label":e.label,"cmdk-dialog":"",className:i},W.createElement(wI,{ref:r,...o}))))}),xee=W.forwardRef((e,r)=>di(t=>t.filtered.count===0)?W.createElement(pi.div,{ref:r,...e,"cmdk-empty":"",role:"presentation"}):null),gee=W.forwardRef((e,r)=>{let{progress:t,children:n,label:a="Loading...",...i}=e;return W.createElement(pi.div,{ref:r,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Rf(e,s=>W.createElement("div",{"aria-hidden":!0},s)))}),Gt=Object.assign(wI,{List:pee,Item:fee,Input:hee,Group:mee,Separator:dee,Dialog:vee,Empty:xee,Loading:gee});function bee(e,r){let t=e.nextElementSibling;for(;t;){if(t.matches(r))return t;t=t.nextElementSibling}}function Nee(e,r){let t=e.previousElementSibling;for(;t;){if(t.matches(r))return t;t=t.previousElementSibling}}function _I(e){let r=W.useRef(e);return ss(()=>{r.current=e}),r}var ss=typeof window>"u"?W.useEffect:W.useLayoutEffect;function Fs(e){let r=W.useRef();return r.current===void 0&&(r.current=e()),r}function di(e){let r=vN(),t=()=>e(r.snapshot());return W.useSyncExternalStore(r.subscribe,t,t)}function SI(e,r,t,n=[]){let a=W.useRef(),i=su();return ss(()=>{var s;let o=(()=>{var l;for(let c of t){if(typeof c=="string")return c.trim();if(typeof c=="object"&&"current"in c)return c.current?(l=c.current.textContent)==null?void 0:l.trim():a.current}})(),u=n.map(l=>l.trim());i.value(e,o,u),(s=r.current)==null||s.setAttribute(Os,o),a.current=o}),a}var yee=()=>{let[e,r]=W.useState(),t=Fs(()=>new Map);return ss(()=>{t.current.forEach(n=>n()),t.current=new Map},[e]),(n,a)=>{t.current.set(n,a),r({})}};function Cee(e){let r=e.type;return typeof r=="function"?r(e.props):"render"in r?r.render(e.props):e}function Rf({asChild:e,children:r},t){return e&&W.isValidElement(r)?W.cloneElement(Cee(r),{ref:r.ref},t(r.props.children)):t(r)}var Eee={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const wee=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(Gt,{ref:t,className:Ae("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:13,columnNumber:3},void 0));wee.displayName=Gt.displayName;const _ee=W.forwardRef(({className:e,...r},t)=>m.jsxDEV("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[m.jsxDEV(UV,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:41,columnNumber:5},void 0),m.jsxDEV(Gt.Input,{ref:t,className:Ae("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:42,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:40,columnNumber:3},void 0));_ee.displayName=Gt.Input.displayName;const See=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(Gt.List,{ref:t,className:Ae("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:59,columnNumber:3},void 0));See.displayName=Gt.List.displayName;const Tee=W.forwardRef((e,r)=>m.jsxDEV(Gt.Empty,{ref:r,className:"py-6 text-center text-sm",...e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:72,columnNumber:3},void 0));Tee.displayName=Gt.Empty.displayName;const Dee=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(Gt.Group,{ref:t,className:Ae("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:85,columnNumber:3},void 0));Dee.displayName=Gt.Group.displayName;const Aee=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(Gt.Separator,{ref:t,className:Ae("-mx-1 h-px bg-border",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:101,columnNumber:3},void 0));Aee.displayName=Gt.Separator.displayName;const kee=W.forwardRef(({className:e,...r},t)=>m.jsxDEV(Gt.Item,{ref:t,className:Ae("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:113,columnNumber:3},void 0));kee.displayName=Gt.Item.displayName;class cue extends Is.Component{constructor(t){super(t);er(this,"handleRetry",()=>{window.location.reload()});er(this,"handleClearData",()=>{try{localStorage.clear(),console.log("LocalStorage cleared successfully")}catch(t){console.error("Failed to clear localStorage:",t)}window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){console.error("LocalStorage Error Boundary caught an error:",t),console.error("Component Stack:",n.componentStack),this.setState({errorInfo:n})}render(){const{hasError:t,error:n,errorInfo:a}=this.state,{children:i,fallback:s}=this.props;return t?s||m.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:m.jsxDEV("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[m.jsxDEV("div",{className:"flex justify-center mb-4",children:m.jsxDEV("div",{className:"rounded-full bg-red-100 p-3",children:m.jsxDEV("svg",{className:"h-8 w-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:129,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:123,columnNumber:17},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:122,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:121,columnNumber:13},this),m.jsxDEV("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:"Something Went Wrong"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:140,columnNumber:13},this),m.jsxDEV("p",{className:"text-gray-600 text-center mb-6",children:"We encountered an issue saving your preferences. This might happen if your browser's storage is full or if you're using private browsing mode."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:143,columnNumber:13},this),m.jsxDEV("div",{className:"space-y-3",children:[m.jsxDEV("button",{onClick:this.handleRetry,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors",children:"Retry"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:150,columnNumber:15},this),m.jsxDEV("button",{onClick:this.handleClearData,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-4 rounded-md transition-colors",children:"Clear Saved Data & Retry"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:156,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:149,columnNumber:13},this),n&&m.jsxDEV("details",{className:"mt-6",children:[m.jsxDEV("summary",{className:"cursor-pointer text-sm text-gray-500 hover:text-gray-700",children:"View Technical Details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:167,columnNumber:17},this),m.jsxDEV("div",{className:"mt-3 p-3 bg-gray-100 rounded text-xs font-mono overflow-auto max-h-48",children:[m.jsxDEV("div",{className:"text-red-600 font-semibold mb-2",children:[n.name,": ",n.message]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:171,columnNumber:19},this),a&&m.jsxDEV("div",{className:"text-gray-600 whitespace-pre-wrap",children:a.componentStack},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:175,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:170,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:166,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:119,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:118,columnNumber:9},this):i}}const cT={WARNING:80,CRITICAL:95};function fue(e={}){const{onWarning:r,checkInterval:t=3e4,checkOnMount:n=!0}=e,a=W.useRef(new Set),i=async()=>{try{const s=await Or.getQuotaInfo();if(!s||s.percentage===0)return;const{percentage:o,usage:u,quota:l}=s,c=f=>{const h=f/1048576;return h<1?`${(f/1024).toFixed(1)} KB`:`${h.toFixed(1)} MB`};if(o>=cT.CRITICAL){const f=`critical-${Math.floor(o)}`;a.current.has(f)||(console.warn(`[Storage Quota Monitor] CRITICAL: Storage at ${o.toFixed(1)}% capacity`),r?.(`Your browser storage is nearly full (${o.toFixed(1)}% used). Using ${c(u)} of ${c(l)} available. Please clear old data or browser cache to continue using this feature.`,o,"critical"),a.current.add(f))}else if(o>=cT.WARNING){const f=`warning-${Math.floor(o/5)*5}`;a.current.has(f)||(console.warn(`[Storage Quota Monitor] WARNING: Storage at ${o.toFixed(1)}% capacity`),r?.(`Your browser storage is ${o.toFixed(1)}% full. Using ${c(u)} of ${c(l)} available. Consider clearing old data to ensure smooth operation.`,o,"warning"),a.current.add(f))}}catch(s){console.error("[Storage Quota Monitor] Failed to check quota:",s)}};return W.useEffect(()=>{n&&i();const s=setInterval(i,t);return()=>{clearInterval(s)}},[t,n,r]),{checkQuota:i}}const mue=IV,due=PV,hue=VV,Ree=W.forwardRef(({className:e,sideOffset:r=4,...t},n)=>m.jsxDEV(k4,{ref:n,sideOffset:r,className:Ae("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e),...t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/tooltip.tsx",lineNumber:18,columnNumber:3},void 0));Ree.displayName=k4.displayName;function pue({children:e,className:r="",title:t}){return m.jsxDEV("div",{className:`w-full max-w-full bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden mx-2 sm:mx-0 ${r}`,children:[t&&m.jsxDEV("div",{className:"px-4 sm:px-6 py-4 bg-gradient-to-r from-amber-100 to-orange-100 border-b border-gray-200",children:m.jsxDEV("h3",{className:"text-lg sm:text-xl font-semibold text-amber-900 leading-tight",children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/mobile-card.tsx",lineNumber:15,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/mobile-card.tsx",lineNumber:14,columnNumber:9},this),m.jsxDEV("div",{className:"p-4 sm:p-6 space-y-4",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/mobile-card.tsx",lineNumber:18,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/mobile-card.tsx",lineNumber:12,columnNumber:5},this)}function vue({categoryLabel:e,criteria:r}){return m.jsxDEV($c,{children:[m.jsxDEV(Gc,{asChild:!0,children:m.jsxDEV(We,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 ml-2 hover:bg-blue-100 rounded-full",type:"button",children:[m.jsxDEV(R4,{className:"h-4 w-4 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:22,columnNumber:11},this),m.jsxDEV("span",{className:"sr-only",children:["View criteria for ",e]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:23,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:16,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:15,columnNumber:7},this),m.jsxDEV(Pl,{className:"w-96 max-h-96 overflow-y-auto",align:"start",children:m.jsxDEV("div",{className:"space-y-3",children:[m.jsxDEV("div",{className:"font-semibold text-sm border-b pb-2",children:[e," - Rating Criteria"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:28,columnNumber:11},this),m.jsxDEV("div",{className:"space-y-3",children:[5,4,3,2,1].map(t=>m.jsxDEV(qe,{className:"border-l-4",style:{borderLeftColor:t>=4?"#10B981":t>=3?"#F59E0B":"#EF4444"},children:m.jsxDEV(He,{className:"p-3",children:[m.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[m.jsxDEV("div",{className:"flex",children:Array.from({length:5},(n,a)=>m.jsxDEV(Aa,{className:`w-3 h-3 ${a<t?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},a,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:40,columnNumber:25},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:38,columnNumber:21},this),m.jsxDEV(yr,{variant:"secondary",className:"text-xs",children:["Rating ",t]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:50,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:37,columnNumber:19},this),m.jsxDEV("p",{className:"text-xs text-gray-700 leading-relaxed",children:r[t]},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:54,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:36,columnNumber:17},this)},t,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:33,columnNumber:15},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:31,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:27,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:26,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:14,columnNumber:5},this)}function xue({categoryLabel:e,criteria:r}){return m.jsxDEV($c,{children:[m.jsxDEV(Gc,{asChild:!0,children:m.jsxDEV(We,{variant:"outline",size:"sm",className:"w-full mt-2 text-xs",type:"button",children:[m.jsxDEV(R4,{className:"h-3 w-3 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:77,columnNumber:11},this),"View Rating Guide"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:71,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:70,columnNumber:7},this),m.jsxDEV(Pl,{className:"w-80 max-h-80 overflow-y-auto",align:"center",children:m.jsxDEV("div",{className:"space-y-3",children:[m.jsxDEV("div",{className:"font-semibold text-sm border-b pb-2",children:[e," - Rating Criteria"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:83,columnNumber:11},this),m.jsxDEV("div",{className:"space-y-3",children:[5,4,3,2,1].map(t=>m.jsxDEV(qe,{className:"border-l-4",style:{borderLeftColor:t>=4?"#10B981":t>=3?"#F59E0B":"#EF4444"},children:m.jsxDEV(He,{className:"p-3",children:[m.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[m.jsxDEV("div",{className:"flex",children:Array.from({length:5},(n,a)=>m.jsxDEV(Aa,{className:`w-3 h-3 ${a<t?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},a,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:95,columnNumber:25},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:93,columnNumber:21},this),m.jsxDEV(yr,{variant:"secondary",className:"text-xs",children:["Rating ",t]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:105,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:92,columnNumber:19},this),m.jsxDEV("p",{className:"text-xs text-gray-700 leading-relaxed",children:r[t]},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:109,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:91,columnNumber:17},this)},t,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:88,columnNumber:15},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:86,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:82,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:81,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:69,columnNumber:5},this)}function Oee({onBack:e}){const r=t=>m.jsxDEV("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(n=>m.jsxDEV(Aa,{className:`w-5 h-5 ${n<=t?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},n,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:17,columnNumber:11},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:15,columnNumber:7},this);return m.jsxDEV("div",{className:"container mx-auto p-6 max-w-6xl space-y-6",children:[m.jsxDEV("div",{className:"mb-6",children:[e&&m.jsxDEV("div",{className:"flex justify-start mb-4",children:m.jsxDEV(We,{variant:"outline",onClick:e,className:"flex-shrink-0",children:"â† Back"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:36,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:35,columnNumber:11},this),m.jsxDEV("div",{className:"text-center space-y-4",children:[m.jsxDEV("div",{className:"flex items-center justify-center gap-3",children:[m.jsxDEV(cy,{className:"w-8 h-8 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:44,columnNumber:13},this),m.jsxDEV("h1",{className:"text-3xl font-bold text-primary",children:"Rating Criteria Reference"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:45,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:43,columnNumber:11},this),m.jsxDEV("p",{className:"text-lg text-muted-foreground max-w-3xl mx-auto",children:"Complete reference guide for custodial inspection ratings. Use this to understand what each star rating means and the specific criteria for each category."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:47,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:42,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:33,columnNumber:7},this),m.jsxDEV(qe,{className:"border-2 border-primary/20",children:[m.jsxDEV(Qe,{className:"bg-primary/5",children:[m.jsxDEV(Ze,{className:"flex items-center gap-2",children:[m.jsxDEV(Aa,{className:"w-6 h-6 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:57,columnNumber:13},this),"General Rating Scale"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:56,columnNumber:11},this),m.jsxDEV(mr,{children:"This 5-star scale applies to all inspection categories"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:60,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:55,columnNumber:9},this),m.jsxDEV(He,{className:"p-6",children:m.jsxDEV("div",{className:"grid gap-4",children:zy.map((t,n)=>m.jsxDEV("div",{className:"flex items-start gap-4 p-4 rounded-lg border border-gray-200 bg-gray-50",children:[m.jsxDEV("div",{className:"flex-shrink-0",children:r(n+1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:68,columnNumber:17},this),m.jsxDEV("div",{className:"flex-1",children:[m.jsxDEV("div",{className:"font-semibold text-lg text-gray-900 mb-1",children:t.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:72,columnNumber:19},this),m.jsxDEV("div",{className:"text-gray-700",children:t.description},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:75,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:71,columnNumber:17},this)]},n,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:67,columnNumber:15},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:65,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:64,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:54,columnNumber:7},this),m.jsxDEV("div",{className:"space-y-6",children:[m.jsxDEV("div",{className:"text-center",children:[m.jsxDEV("h2",{className:"text-2xl font-bold text-primary mb-2",children:"Category-Specific Criteria"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:88,columnNumber:11},this),m.jsxDEV("p",{className:"text-muted-foreground",children:"Detailed criteria for each inspection category showing what qualifies for each star rating"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:89,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:87,columnNumber:9},this),m.jsxDEV("div",{className:"grid gap-6",children:W8.map(t=>m.jsxDEV(qe,{className:"border border-gray-200",children:[m.jsxDEV(Qe,{className:"bg-accent/10",children:[m.jsxDEV(Ze,{className:"text-xl text-primary",children:t.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:98,columnNumber:17},this),m.jsxDEV(mr,{children:["Specific criteria for rating ",t.label.toLowerCase()," cleanliness and maintenance"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:101,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:97,columnNumber:15},this),m.jsxDEV(He,{className:"p-6",children:t.criteria?m.jsxDEV("div",{className:"space-y-4",children:Object.entries(t.criteria).map(([n,a])=>m.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4",children:[m.jsxDEV("div",{className:"flex items-center gap-3 mb-3",children:[r(parseInt(n)),m.jsxDEV(yr,{variant:"outline",className:"text-sm",children:[parseInt(n)," Star",parseInt(n)>1?"s":""]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:112,columnNumber:27},this),m.jsxDEV("span",{className:"font-medium text-primary",children:zy[parseInt(n)-1]?.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:115,columnNumber:27},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:110,columnNumber:25},this),m.jsxDEV("div",{className:"text-gray-700 leading-relaxed",children:a},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:119,columnNumber:25},this)]},n,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:109,columnNumber:23},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:107,columnNumber:19},this):m.jsxDEV("div",{className:"text-center py-8 text-muted-foreground",children:[m.jsxDEV(cy,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:127,columnNumber:21},this),m.jsxDEV("p",{children:"Detailed criteria for this category will be available soon."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:128,columnNumber:21},this),m.jsxDEV("p",{className:"text-sm mt-1",children:"Use the general rating scale above for guidance."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:129,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:126,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:105,columnNumber:15},this)]},t.key,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:96,columnNumber:13},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:94,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:86,columnNumber:7},this),m.jsxDEV(qe,{className:"border-2 border-blue-200 bg-blue-50",children:[m.jsxDEV(Qe,{children:m.jsxDEV(Ze,{className:"text-blue-900",children:"How to Use This Reference"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:141,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:140,columnNumber:9},this),m.jsxDEV(He,{className:"space-y-3 text-blue-800",children:[m.jsxDEV("div",{children:[m.jsxDEV("strong",{children:"During Inspections:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:145,columnNumber:13},this)," Reference this page to ensure consistent and accurate ratings across all categories."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:144,columnNumber:11},this),m.jsxDEV("div",{children:[m.jsxDEV("strong",{children:"For Training:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:148,columnNumber:13},this)," Use this as a training guide for new inspectors to understand rating standards."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:147,columnNumber:11},this),m.jsxDEV("div",{children:[m.jsxDEV("strong",{children:"For Consistency:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:151,columnNumber:13},this)," When multiple inspectors are involved, this ensures everyone applies the same standards."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:150,columnNumber:11},this),m.jsxDEV("div",{children:[m.jsxDEV("strong",{children:"For Documentation:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:154,columnNumber:13},this)," Print or bookmark this page for offline reference during field inspections."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:153,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:143,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:139,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:31,columnNumber:5},this)}const Fee=Object.freeze(Object.defineProperty({__proto__:null,default:Oee},Symbol.toStringTag,{value:"Module"})),Uee=({size:e="md",className:r,text:t="Loading..."})=>{const n={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};return m.jsxDEV("div",{className:Ae("flex flex-col items-center justify-center p-8",r),children:[m.jsxDEV(ic,{className:Ae("animate-spin text-primary",n[e])},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/loading-spinner.tsx",lineNumber:24,columnNumber:7},void 0),t&&m.jsxDEV("p",{className:"mt-2 text-sm text-muted-foreground",children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/loading-spinner.tsx",lineNumber:26,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/loading-spinner.tsx",lineNumber:23,columnNumber:5},void 0)},gue=Uee,Iee=[{value:"ASA",label:"ASA"},{value:"LCA",label:"LCA"},{value:"GWC",label:"GWC"},{value:"OA",label:"OA"},{value:"CBR",label:"CBR"},{value:"WLC",label:"WLC"}],Pee=["January","February","March","April","May","June","July","August","September","October","November","December"];function bue({onUploadSuccess:e}){const{toast:r}=Qc(),[t,n]=W.useState({school:"",month:"",year:new Date().getFullYear().toString(),notes:"",uploadedBy:""}),[a,i]=W.useState(null),[s,o]=W.useState(!1),[u,l]=W.useState({}),c=d=>{const v=d.target.files?.[0];if(v){if(l(p=>({...p,pdfFile:""})),v.type!=="application/pdf"){const p="Only PDF files are allowed. Please select a valid PDF file.";l(x=>({...x,pdfFile:p})),r({variant:"destructive",title:"Invalid File Type",description:p}),d.target.value="",i(null);return}if(v.size>10*1024*1024){const p="PDF file must be less than 10MB. Please choose a smaller file.";l(x=>({...x,pdfFile:p})),r({variant:"destructive",title:"File Too Large",description:p}),d.target.value="",i(null);return}i(v),r({title:"âœ… PDF Selected",description:`${v.name} (${(v.size/1024/1024).toFixed(2)} MB) - Ready to upload`})}},f=()=>{const d={};if(t.school||(d.school="School is required"),t.month||(d.month="Month is required"),!t.year)d.year="Year is required";else{const v=parseInt(t.year);(isNaN(v)||v<2020||v>2100)&&(d.year="Please enter a valid year between 2020 and 2100")}return a||(d.pdfFile="PDF file is required"),l(d),Object.keys(d).length===0},h=async d=>{if(d.preventDefault(),!!f()){o(!0);try{const v=new FormData;v.append("school",t.school),v.append("month",t.month),v.append("year",t.year),a&&v.append("pdf",a),t.notes&&v.append("notes",t.notes),t.uploadedBy&&v.append("uploadedBy",t.uploadedBy);const p=await fetch("/api/monthly-feedback",{method:"POST",body:v});if(p.ok){const x=await p.json();r({title:"âœ… Upload Successful!",description:`Monthly feedback for ${t.month} ${t.year} has been uploaded.${x.hasExtractedText?" Text extracted successfully.":" (Text extraction unavailable)"}`,duration:5e3}),n({school:"",month:"",year:new Date().getFullYear().toString(),notes:"",uploadedBy:""}),i(null),l({});const g=document.getElementById("pdfFile");g&&(g.value=""),e()}else{const x=await p.json().catch(()=>({message:"Unknown error"}));r({variant:"destructive",title:"Upload Failed",description:x.message||"Failed to upload monthly feedback."})}}catch(v){console.error("Error uploading feedback:",v),r({variant:"destructive",title:"Network Error",description:"Unable to connect to the server. Please check your connection."})}finally{o(!1)}}};return m.jsxDEV("form",{onSubmit:h,children:m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{children:[m.jsxDEV(Ze,{children:"Upload Monthly Feedback"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:181,columnNumber:11},this),m.jsxDEV(mr,{children:"Upload a monthly custodial feedback email PDF"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:182,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:180,columnNumber:9},this),m.jsxDEV(He,{className:"space-y-4",children:[m.jsxDEV("div",{"aria-live":"polite",className:"sr-only"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:186,columnNumber:11},this),m.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{htmlFor:"school",children:["School ",m.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:189,columnNumber:46},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:189,columnNumber:15},this),m.jsxDEV(el,{value:t.school,onValueChange:d=>n(v=>({...v,school:d})),children:[m.jsxDEV(js,{className:u.school?"border-red-500":"",children:m.jsxDEV(rl,{placeholder:"Select school"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:192,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:191,columnNumber:17},this),m.jsxDEV(Ls,{children:Iee.map(d=>m.jsxDEV(Un,{value:d.value,children:d.label},d.value,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:196,columnNumber:21},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:194,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:190,columnNumber:15},this),u.school&&m.jsxDEV("p",{className:"text-sm text-red-500",children:u.school},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:202,columnNumber:33},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:188,columnNumber:13},this),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{htmlFor:"month",children:["Month ",m.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:206,columnNumber:44},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:206,columnNumber:15},this),m.jsxDEV(el,{value:t.month,onValueChange:d=>n(v=>({...v,month:d})),children:[m.jsxDEV(js,{className:u.month?"border-red-500":"",children:m.jsxDEV(rl,{placeholder:"Select month"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:209,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:208,columnNumber:17},this),m.jsxDEV(Ls,{children:Pee.map(d=>m.jsxDEV(Un,{value:d,children:d},d,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:213,columnNumber:21},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:211,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:207,columnNumber:15},this),u.month&&m.jsxDEV("p",{className:"text-sm text-red-500",children:u.month},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:219,columnNumber:32},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:205,columnNumber:13},this),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{htmlFor:"year",children:["Year ",m.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:223,columnNumber:42},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:223,columnNumber:15},this),m.jsxDEV(el,{value:t.year,onValueChange:d=>n(v=>({...v,year:d})),children:[m.jsxDEV(js,{className:u.year?"border-red-500":"",children:m.jsxDEV(rl,{placeholder:"Select year"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:226,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:225,columnNumber:17},this),m.jsxDEV(Ls,{children:Array.from({length:10},(d,v)=>new Date().getFullYear()-5+v).map(d=>m.jsxDEV(Un,{value:d.toString(),children:d},d,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:230,columnNumber:21},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:228,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:224,columnNumber:15},this),u.year&&m.jsxDEV("p",{className:"text-sm text-red-500",children:u.year},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:236,columnNumber:31},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:222,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:187,columnNumber:11},this),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{htmlFor:"pdfFile",children:["PDF File ",m.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:241,columnNumber:47},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:241,columnNumber:13},this),m.jsxDEV(Vs,{id:"pdfFile",type:"file",accept:".pdf,application/pdf",onChange:c,className:u.pdfFile?"border-red-500":"",required:!0},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:242,columnNumber:13},this),u.pdfFile&&m.jsxDEV("p",{className:"text-sm text-red-500",children:u.pdfFile},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:250,columnNumber:32},this),a&&m.jsxDEV("p",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[m.jsxDEV(Pn,{className:"w-4 h-4 text-green-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:253,columnNumber:17},this),a.name," (",(a.size/1024/1024).toFixed(2)," MB)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:252,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:240,columnNumber:11},this),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{htmlFor:"uploadedBy",children:"Uploaded By (Optional)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:260,columnNumber:13},this),m.jsxDEV(Vs,{id:"uploadedBy",value:t.uploadedBy,onChange:d=>n(v=>({...v,uploadedBy:d.target.value})),placeholder:"Your name",maxLength:255},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:261,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:259,columnNumber:11},this),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV(tr,{htmlFor:"notes",children:"Notes (Optional)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:271,columnNumber:13},this),m.jsxDEV(W1,{id:"notes",value:t.notes,onChange:d=>n(v=>({...v,notes:d.target.value})),placeholder:"Additional notes or context about this feedback...",rows:4,maxLength:5e3},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:272,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:270,columnNumber:11},this),m.jsxDEV(We,{type:"submit",disabled:s,className:"w-full",children:s?m.jsxDEV(m.Fragment,{children:[m.jsxDEV("span",{className:"animate-spin mr-2",children:"â³"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:285,columnNumber:17},this),"Uploading..."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:284,columnNumber:15},this):m.jsxDEV(m.Fragment,{children:[m.jsxDEV(Yk,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:290,columnNumber:17},this),"Upload Feedback"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:289,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:282,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:184,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:179,columnNumber:7},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:178,columnNumber:5},this)}function Nue({feedback:e,onView:r,onDownload:t}){const n=()=>{if(!e.extractedText)return"No text content available";const i=e.extractedText.trim();return i.length===0?"No text content available":i.length>200?i.substring(0,200)+"...":i},a=i=>i;return m.jsxDEV(qe,{children:[m.jsxDEV(Qe,{className:"pb-3",children:[m.jsxDEV(Ze,{className:"flex items-center justify-between leading-7",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(ja,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:32,columnNumber:13},this),m.jsxDEV("span",{children:[e.month," ",e.year]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:33,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:31,columnNumber:11},this),m.jsxDEV(yr,{title:a(e.school),children:e.school},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:35,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:30,columnNumber:9},this),m.jsxDEV(mr,{className:"flex items-center gap-2 mt-2",children:[m.jsxDEV(wt,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:38,columnNumber:11},this),new Date(e.createdAt).toLocaleDateString()]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:37,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:29,columnNumber:7},this),m.jsxDEV(He,{className:"pt-0",children:m.jsxDEV("div",{className:"space-y-4",children:[m.jsxDEV("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.uploadedBy&&m.jsxDEV("div",{className:"flex items-center gap-1",children:[m.jsxDEV(ni,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:48,columnNumber:17},this),m.jsxDEV("span",{children:e.uploadedBy},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:49,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:47,columnNumber:15},this),e.fileSize&&m.jsxDEV("div",{className:"flex items-center gap-1",children:[m.jsxDEV(MV,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:54,columnNumber:17},this),m.jsxDEV("span",{children:[(e.fileSize/1024/1024).toFixed(2)," MB"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:55,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:53,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:45,columnNumber:11},this),m.jsxDEV("p",{className:"text-sm text-muted-foreground line-clamp-3",children:n()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:60,columnNumber:11},this),m.jsxDEV("div",{className:"flex gap-2",children:[m.jsxDEV(We,{onClick:()=>r(e),size:"sm",variant:"default",children:[m.jsxDEV(b4,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:65,columnNumber:15},this),"View Details"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:64,columnNumber:13},this),m.jsxDEV(We,{onClick:()=>t(e),size:"sm",variant:"outline","aria-label":`Download PDF for ${e.month} ${e.year} ${e.school}`,children:[m.jsxDEV(Qi,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:74,columnNumber:15},this),"Download PDF"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:68,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:63,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:43,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:42,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:28,columnNumber:5},this)}class Vee extends Error{constructor(t,n,a,i,s){super(t);er(this,"name","Assertion");er(this,"code","ERR_ASSERTION");Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.actual=n,this.expected=a,this.generated=s,this.operator=i}}function K(e,r){TI(!!e,!1,!0,"ok","Expected value to be truthy",r)}function yue(e){TI(!1,!1,!0,"ok","Unreachable",e)}function TI(e,r,t,n,a,i){if(!e)throw i instanceof Error?i:new Vee(i||a,r,t,n,!i)}function Mee(e,r){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const jee=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Lee=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Bee={};function fT(e,r){return(Bee.jsx?Lee:jee).test(e)}const qee=/[ \t\n\f\r]/g;function Hee(e){return typeof e=="object"?e.type==="text"?mT(e.value):!1:mT(e)}function mT(e){return e.replace(qee,"")===""}class ou{constructor(r,t,n){this.normal=t,this.property=r,n&&(this.space=n)}}ou.prototype.normal={};ou.prototype.property={};ou.prototype.space=void 0;function DI(e,r){const t={},n={};for(const a of e)Object.assign(t,a.property),Object.assign(n,a.normal);return new ou(t,n,r)}function d1(e){return e.toLowerCase()}class Wt{constructor(r,t){this.attribute=t,this.property=r}}Wt.prototype.attribute="";Wt.prototype.booleanish=!1;Wt.prototype.boolean=!1;Wt.prototype.commaOrSpaceSeparated=!1;Wt.prototype.commaSeparated=!1;Wt.prototype.defined=!1;Wt.prototype.mustUseProperty=!1;Wt.prototype.number=!1;Wt.prototype.overloadedBoolean=!1;Wt.prototype.property="";Wt.prototype.spaceSeparated=!1;Wt.prototype.space=void 0;let zee=0;const Xe=gs(),Zr=gs(),h1=gs(),Ce=gs(),wr=gs(),Gs=gs(),Xt=gs();function gs(){return 2**++zee}const p1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Xe,booleanish:Zr,commaOrSpaceSeparated:Xt,commaSeparated:Gs,number:Ce,overloadedBoolean:h1,spaceSeparated:wr},Symbol.toStringTag,{value:"Module"})),Fp=Object.keys(p1);class xN extends Wt{constructor(r,t,n,a){let i=-1;if(super(r,t),dT(this,"space",a),typeof n=="number")for(;++i<Fp.length;){const s=Fp[i];dT(this,Fp[i],(n&p1[s])===p1[s])}}}xN.prototype.defined=!0;function dT(e,r,t){t&&(e[r]=t)}function Eo(e){const r={},t={};for(const[n,a]of Object.entries(e.properties)){const i=new xN(n,e.transform(e.attributes||{},n),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(n)&&(i.mustUseProperty=!0),r[n]=i,t[d1(n)]=n,t[d1(i.attribute)]=n}return new ou(r,t,e.space)}const AI=Eo({properties:{ariaActiveDescendant:null,ariaAtomic:Zr,ariaAutoComplete:null,ariaBusy:Zr,ariaChecked:Zr,ariaColCount:Ce,ariaColIndex:Ce,ariaColSpan:Ce,ariaControls:wr,ariaCurrent:null,ariaDescribedBy:wr,ariaDetails:null,ariaDisabled:Zr,ariaDropEffect:wr,ariaErrorMessage:null,ariaExpanded:Zr,ariaFlowTo:wr,ariaGrabbed:Zr,ariaHasPopup:null,ariaHidden:Zr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:wr,ariaLevel:Ce,ariaLive:null,ariaModal:Zr,ariaMultiLine:Zr,ariaMultiSelectable:Zr,ariaOrientation:null,ariaOwns:wr,ariaPlaceholder:null,ariaPosInSet:Ce,ariaPressed:Zr,ariaReadOnly:Zr,ariaRelevant:null,ariaRequired:Zr,ariaRoleDescription:wr,ariaRowCount:Ce,ariaRowIndex:Ce,ariaRowSpan:Ce,ariaSelected:Zr,ariaSetSize:Ce,ariaSort:null,ariaValueMax:Ce,ariaValueMin:Ce,ariaValueNow:Ce,ariaValueText:null,role:null},transform(e,r){return r==="role"?r:"aria-"+r.slice(4).toLowerCase()}});function kI(e,r){return r in e?e[r]:r}function RI(e,r){return kI(e,r.toLowerCase())}const $ee=Eo({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Gs,acceptCharset:wr,accessKey:wr,action:null,allow:null,allowFullScreen:Xe,allowPaymentRequest:Xe,allowUserMedia:Xe,alt:null,as:null,async:Xe,autoCapitalize:null,autoComplete:wr,autoFocus:Xe,autoPlay:Xe,blocking:wr,capture:null,charSet:null,checked:Xe,cite:null,className:wr,cols:Ce,colSpan:null,content:null,contentEditable:Zr,controls:Xe,controlsList:wr,coords:Ce|Gs,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Xe,defer:Xe,dir:null,dirName:null,disabled:Xe,download:h1,draggable:Zr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Xe,formTarget:null,headers:wr,height:Ce,hidden:h1,high:Ce,href:null,hrefLang:null,htmlFor:wr,httpEquiv:wr,id:null,imageSizes:null,imageSrcSet:null,inert:Xe,inputMode:null,integrity:null,is:null,isMap:Xe,itemId:null,itemProp:wr,itemRef:wr,itemScope:Xe,itemType:wr,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Xe,low:Ce,manifest:null,max:null,maxLength:Ce,media:null,method:null,min:null,minLength:Ce,multiple:Xe,muted:Xe,name:null,nonce:null,noModule:Xe,noValidate:Xe,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Xe,optimum:Ce,pattern:null,ping:wr,placeholder:null,playsInline:Xe,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Xe,referrerPolicy:null,rel:wr,required:Xe,reversed:Xe,rows:Ce,rowSpan:Ce,sandbox:wr,scope:null,scoped:Xe,seamless:Xe,selected:Xe,shadowRootClonable:Xe,shadowRootDelegatesFocus:Xe,shadowRootMode:null,shape:null,size:Ce,sizes:null,slot:null,span:Ce,spellCheck:Zr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ce,step:null,style:null,tabIndex:Ce,target:null,title:null,translate:null,type:null,typeMustMatch:Xe,useMap:null,value:Zr,width:Ce,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:wr,axis:null,background:null,bgColor:null,border:Ce,borderColor:null,bottomMargin:Ce,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Xe,declare:Xe,event:null,face:null,frame:null,frameBorder:null,hSpace:Ce,leftMargin:Ce,link:null,longDesc:null,lowSrc:null,marginHeight:Ce,marginWidth:Ce,noResize:Xe,noHref:Xe,noShade:Xe,noWrap:Xe,object:null,profile:null,prompt:null,rev:null,rightMargin:Ce,rules:null,scheme:null,scrolling:Zr,standby:null,summary:null,text:null,topMargin:Ce,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ce,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Xe,disableRemotePlayback:Xe,prefix:null,property:null,results:Ce,security:null,unselectable:null},space:"html",transform:RI}),Gee=Eo({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Xt,accentHeight:Ce,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ce,amplitude:Ce,arabicForm:null,ascent:Ce,attributeName:null,attributeType:null,azimuth:Ce,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ce,by:null,calcMode:null,capHeight:Ce,className:wr,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ce,diffuseConstant:Ce,direction:null,display:null,dur:null,divisor:Ce,dominantBaseline:null,download:Xe,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ce,enableBackground:null,end:null,event:null,exponent:Ce,externalResourcesRequired:null,fill:null,fillOpacity:Ce,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Gs,g2:Gs,glyphName:Gs,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ce,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ce,horizOriginX:Ce,horizOriginY:Ce,id:null,ideographic:Ce,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ce,k:Ce,k1:Ce,k2:Ce,k3:Ce,k4:Ce,kernelMatrix:Xt,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ce,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ce,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ce,overlineThickness:Ce,paintOrder:null,panose1:null,path:null,pathLength:Ce,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:wr,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ce,pointsAtY:Ce,pointsAtZ:Ce,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Xt,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Xt,rev:Xt,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Xt,requiredFeatures:Xt,requiredFonts:Xt,requiredFormats:Xt,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ce,specularExponent:Ce,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ce,strikethroughThickness:Ce,string:null,stroke:null,strokeDashArray:Xt,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ce,strokeOpacity:Ce,strokeWidth:null,style:null,surfaceScale:Ce,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Xt,tabIndex:Ce,tableValues:null,target:null,targetX:Ce,targetY:Ce,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Xt,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ce,underlineThickness:Ce,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ce,values:null,vAlphabetic:Ce,vMathematical:Ce,vectorEffect:null,vHanging:Ce,vIdeographic:Ce,version:null,vertAdvY:Ce,vertOriginX:Ce,vertOriginY:Ce,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ce,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:kI}),OI=Eo({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,r){return"xlink:"+r.slice(5).toLowerCase()}}),FI=Eo({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:RI}),UI=Eo({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,r){return"xml:"+r.slice(3).toLowerCase()}}),Wee=/[A-Z]/g,hT=/-[a-z]/g,Yee=/^data[-\w.:]+$/i;function Kee(e,r){const t=d1(r);let n=r,a=Wt;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&Yee.test(r)){if(r.charAt(4)==="-"){const i=r.slice(5).replace(hT,Qee);n="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=r.slice(4);if(!hT.test(i)){let s=i.replace(Wee,Xee);s.charAt(0)!=="-"&&(s="-"+s),r="data"+s}}a=xN}return new a(n,r)}function Xee(e){return"-"+e.toLowerCase()}function Qee(e){return e.charAt(1).toUpperCase()}const Zee=DI([AI,$ee,OI,FI,UI],"html"),gN=DI([AI,Gee,OI,FI,UI],"svg");function Jee(e){return e.join(" ").trim()}var As={},Up,pT;function ere(){if(pT)return Up;pT=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,r=/\n/g,t=/^\s*/,n=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,i=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,s=/^[;\s]*/,o=/^\s+|\s+$/g,u=`
`,l="/",c="*",f="",h="comment",d="declaration";Up=function(p,x){if(typeof p!="string")throw new TypeError("First argument must be a string");if(!p)return[];x=x||{};var g=1,N=1;function b(P){var B=P.match(r);B&&(g+=B.length);var G=P.lastIndexOf(u);N=~G?P.length-G:N+P.length}function y(){var P={line:g,column:N};return function(B){return B.position=new _(P),k(),B}}function _(P){this.start=P,this.end={line:g,column:N},this.source=x.source}_.prototype.content=p;function w(P){var B=new Error(x.source+":"+g+":"+N+": "+P);if(B.reason=P,B.filename=x.source,B.line=g,B.column=N,B.source=p,!x.silent)throw B}function C(P){var B=P.exec(p);if(B){var G=B[0];return b(G),p=p.slice(G.length),B}}function k(){C(t)}function D(P){var B;for(P=P||[];B=U();)B!==!1&&P.push(B);return P}function U(){var P=y();if(!(l!=p.charAt(0)||c!=p.charAt(1))){for(var B=2;f!=p.charAt(B)&&(c!=p.charAt(B)||l!=p.charAt(B+1));)++B;if(B+=2,f===p.charAt(B-1))return w("End of comment missing");var G=p.slice(2,B-2);return N+=2,b(G),p=p.slice(B),N+=2,P({type:h,comment:G})}}function F(){var P=y(),B=C(n);if(B){if(U(),!C(a))return w("property missing ':'");var G=C(i),ue=P({type:d,property:v(B[0].replace(e,f)),value:G?v(G[0].replace(e,f)):f});return C(s),ue}}function L(){var P=[];D(P);for(var B;B=F();)B!==!1&&(P.push(B),D(P));return P}return k(),L()};function v(p){return p?p.replace(o,f):f}return Up}var vT;function rre(){if(vT)return As;vT=1;var e=As&&As.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(As,"__esModule",{value:!0}),As.default=t;const r=e(ere());function t(n,a){let i=null;if(!n||typeof n!="string")return i;const s=(0,r.default)(n),o=typeof a=="function";return s.forEach(u=>{if(u.type!=="declaration")return;const{property:l,value:c}=u;o?a(l,c,u):c&&(i=i||{},i[l]=c)}),i}return As}var qo={},xT;function tre(){if(xT)return qo;xT=1,Object.defineProperty(qo,"__esModule",{value:!0}),qo.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,r=/-([a-z])/g,t=/^[^-]+$/,n=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,i=function(l){return!l||t.test(l)||e.test(l)},s=function(l,c){return c.toUpperCase()},o=function(l,c){return"".concat(c,"-")},u=function(l,c){return c===void 0&&(c={}),i(l)?l:(l=l.toLowerCase(),c.reactCompat?l=l.replace(a,o):l=l.replace(n,o),l.replace(r,s))};return qo.camelCase=u,qo}var Ho,gT;function nre(){if(gT)return Ho;gT=1;var e=Ho&&Ho.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},r=e(rre()),t=tre();function n(a,i){var s={};return!a||typeof a!="string"||(0,r.default)(a,function(o,u){o&&u&&(s[(0,t.camelCase)(o,i)]=u)}),s}return n.default=n,Ho=n,Ho}var are=nre();const ire=nr(are),II=PI("end"),bN=PI("start");function PI(e){return r;function r(t){const n=t&&t.position&&t.position[e]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function sre(e){const r=bN(e),t=II(e);if(r&&t)return{start:r,end:t}}function fl(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?bT(e.position):"start"in e||"end"in e?bT(e):"line"in e||"column"in e?v1(e):""}function v1(e){return NT(e&&e.line)+":"+NT(e&&e.column)}function bT(e){return v1(e&&e.start)+"-"+v1(e&&e.end)}function NT(e){return e&&typeof e=="number"?e:1}class Dt extends Error{constructor(r,t,n){super(),typeof t=="string"&&(n=t,t=void 0);let a="",i={},s=!1;if(t&&("line"in t&&"column"in t?i={place:t}:"start"in t&&"end"in t?i={place:t}:"type"in t?i={ancestors:[t],place:t.position}:i={...t}),typeof r=="string"?a=r:!i.cause&&r&&(s=!0,a=r.message,i.cause=r),!i.ruleId&&!i.source&&typeof n=="string"){const u=n.indexOf(":");u===-1?i.ruleId=n:(i.source=n.slice(0,u),i.ruleId=n.slice(u+1))}if(!i.place&&i.ancestors&&i.ancestors){const u=i.ancestors[i.ancestors.length-1];u&&(i.place=u.position)}const o=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=o?o.line:void 0,this.name=fl(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=s&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Dt.prototype.file="";Dt.prototype.name="";Dt.prototype.reason="";Dt.prototype.message="";Dt.prototype.stack="";Dt.prototype.column=void 0;Dt.prototype.line=void 0;Dt.prototype.ancestors=void 0;Dt.prototype.cause=void 0;Dt.prototype.fatal=void 0;Dt.prototype.place=void 0;Dt.prototype.ruleId=void 0;Dt.prototype.source=void 0;const NN={}.hasOwnProperty,ore=new Map,lre=/[A-Z]/g,ure=new Set(["table","tbody","thead","tfoot","tr"]),cre=new Set(["td","th"]),VI="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Cue(e,r){if(!r||r.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=r.filePath||void 0;let n;if(r.development){if(typeof r.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=gre(t,r.jsxDEV)}else{if(typeof r.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof r.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=xre(t,r.jsx,r.jsxs)}const a={Fragment:r.Fragment,ancestors:[],components:r.components||{},create:n,elementAttributeNameCase:r.elementAttributeNameCase||"react",evaluater:r.createEvaluater?r.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:r.ignoreInvalidStyle||!1,passKeys:r.passKeys!==!1,passNode:r.passNode||!1,schema:r.space==="svg"?gN:Zee,stylePropertyNameCase:r.stylePropertyNameCase||"dom",tableCellAlignToStyle:r.tableCellAlignToStyle!==!1},i=MI(a,e,void 0);return i&&typeof i!="string"?i:a.create(e,a.Fragment,{children:i||void 0},void 0)}function MI(e,r,t){if(r.type==="element")return fre(e,r,t);if(r.type==="mdxFlowExpression"||r.type==="mdxTextExpression")return mre(e,r);if(r.type==="mdxJsxFlowElement"||r.type==="mdxJsxTextElement")return hre(e,r,t);if(r.type==="mdxjsEsm")return dre(e,r);if(r.type==="root")return pre(e,r,t);if(r.type==="text")return vre(e,r)}function fre(e,r,t){const n=e.schema;let a=n;r.tagName.toLowerCase()==="svg"&&n.space==="html"&&(a=gN,e.schema=a),e.ancestors.push(r);const i=LI(e,r.tagName,!1),s=bre(e,r);let o=CN(e,r);return ure.has(r.tagName)&&(o=o.filter(function(u){return typeof u=="string"?!Hee(u):!0})),jI(e,s,i,r),yN(s,o),e.ancestors.pop(),e.schema=n,e.create(r,i,s,t)}function mre(e,r){if(r.data&&r.data.estree&&e.evaluater){const n=r.data.estree.body[0];return K(n.type==="ExpressionStatement"),e.evaluater.evaluateExpression(n.expression)}Vl(e,r.position)}function dre(e,r){if(r.data&&r.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(r.data.estree);Vl(e,r.position)}function hre(e,r,t){const n=e.schema;let a=n;r.name==="svg"&&n.space==="html"&&(a=gN,e.schema=a),e.ancestors.push(r);const i=r.name===null?e.Fragment:LI(e,r.name,!0),s=Nre(e,r),o=CN(e,r);return jI(e,s,i,r),yN(s,o),e.ancestors.pop(),e.schema=n,e.create(r,i,s,t)}function pre(e,r,t){const n={};return yN(n,CN(e,r)),e.create(r,e.Fragment,n,t)}function vre(e,r){return r.value}function jI(e,r,t,n){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(r.node=n)}function yN(e,r){if(r.length>0){const t=r.length>1?r:r[0];t&&(e.children=t)}}function xre(e,r,t){return n;function n(a,i,s,o){const l=Array.isArray(s.children)?t:r;return o?l(i,s,o):l(i,s)}}function gre(e,r){return t;function t(n,a,i,s){const o=Array.isArray(i.children),u=bN(n);return r(a,i,s,o,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function bre(e,r){const t={};let n,a;for(a in r.properties)if(a!=="children"&&NN.call(r.properties,a)){const i=yre(e,a,r.properties[a]);if(i){const[s,o]=i;e.tableCellAlignToStyle&&s==="align"&&typeof o=="string"&&cre.has(r.tagName)?n=o:t[s]=o}}if(n){const i=t.style||(t.style={});i[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return t}function Nre(e,r){const t={};for(const n of r.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&e.evaluater){const i=n.data.estree.body[0];K(i.type==="ExpressionStatement");const s=i.expression;K(s.type==="ObjectExpression");const o=s.properties[0];K(o.type==="SpreadElement"),Object.assign(t,e.evaluater.evaluateExpression(o.argument))}else Vl(e,r.position);else{const a=n.name;let i;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&e.evaluater){const o=n.value.data.estree.body[0];K(o.type==="ExpressionStatement"),i=e.evaluater.evaluateExpression(o.expression)}else Vl(e,r.position);else i=n.value===null?!0:n.value;t[a]=i}return t}function CN(e,r){const t=[];let n=-1;const a=e.passKeys?new Map:ore;for(;++n<r.children.length;){const i=r.children[n];let s;if(e.passKeys){const u=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(u){const l=a.get(u)||0;s=u+"-"+l,a.set(u,l+1)}}const o=MI(e,i,s);o!==void 0&&t.push(o)}return t}function yre(e,r,t){const n=Kee(e.schema,r);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=n.commaSeparated?Mee(t):Jee(t)),n.property==="style"){let a=typeof t=="object"?t:Cre(e,String(t));return e.stylePropertyNameCase==="css"&&(a=Ere(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&n.space?jV[n.property]||n.property:n.attribute,t]}}function Cre(e,r){try{return ire(r,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const n=t,a=new Dt("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:n,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=VI+"#cannot-parse-style-attribute",a}}function LI(e,r,t){let n;if(!t)n={type:"Literal",value:r};else if(r.includes(".")){const a=r.split(".");let i=-1,s;for(;++i<a.length;){const o=fT(a[i])?{type:"Identifier",name:a[i]}:{type:"Literal",value:a[i]};s=s?{type:"MemberExpression",object:s,property:o,computed:!!(i&&o.type==="Literal"),optional:!1}:o}K(s,"always a result"),n=s}else n=fT(r)&&!/^[a-z]/.test(r)?{type:"Identifier",name:r}:{type:"Literal",value:r};if(n.type==="Literal"){const a=n.value;return NN.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(n);Vl(e)}function Vl(e,r){const t=new Dt("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:r,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=VI+"#cannot-handle-mdx-estrees-without-createevaluater",t}function Ere(e){const r={};let t;for(t in e)NN.call(e,t)&&(r[wre(t)]=e[t]);return r}function wre(e){let r=e.replace(lre,_re);return r.slice(0,3)==="ms-"&&(r="-"+r),r}function _re(e){return"-"+e.toLowerCase()}const Eue={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},Sre={};function Tre(e,r){const t=Sre,n=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return BI(e,n,a)}function BI(e,r,t){if(Dre(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(r&&"alt"in e&&e.alt)return e.alt;if("children"in e)return yT(e.children,r,t)}return Array.isArray(e)?yT(e,r,t):""}function yT(e,r,t){const n=[];let a=-1;for(;++a<e.length;)n[a]=BI(e[a],r,t);return n.join("")}function Dre(e){return!!(e&&typeof e=="object")}const CT=document.createElement("i");function EN(e){const r="&"+e+";";CT.innerHTML=r;const t=CT.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===r?!1:t}const O={carriageReturn:-5,lineFeed:-4,carriageReturnLineFeed:-3,horizontalTab:-2,virtualSpace:-1,eof:null,nul:0,ht:9,lf:10,vt:11,cr:13,space:32,exclamationMark:33,quotationMark:34,numberSign:35,percentSign:37,ampersand:38,apostrophe:39,leftParenthesis:40,rightParenthesis:41,asterisk:42,plusSign:43,dash:45,dot:46,slash:47,digit0:48,digit1:49,digit2:50,digit3:51,digit4:52,digit5:53,digit6:54,digit7:55,digit8:56,digit9:57,colon:58,semicolon:59,lessThan:60,equalsTo:61,greaterThan:62,questionMark:63,atSign:64,uppercaseX:88,leftSquareBracket:91,backslash:92,rightSquareBracket:93,caret:94,underscore:95,graveAccent:96,lowercaseX:120,tilde:126,del:127,byteOrderMarker:65279,replacementCharacter:65533},Oe={atxHeadingOpeningFenceSizeMax:6,autolinkDomainSizeMax:63,autolinkSchemeSizeMax:32,cdataOpeningString:"CDATA[",characterGroupPunctuation:2,characterGroupWhitespace:1,characterReferenceDecimalSizeMax:7,characterReferenceHexadecimalSizeMax:6,characterReferenceNamedSizeMax:31,codeFencedSequenceSizeMin:3,contentTypeContent:"content",contentTypeFlow:"flow",contentTypeString:"string",contentTypeText:"text",hardBreakPrefixSizeMin:2,htmlBasic:6,htmlCdata:5,htmlComment:2,htmlComplete:7,htmlDeclaration:4,htmlInstruction:3,htmlRawSizeMax:8,htmlRaw:1,linkResourceDestinationBalanceMax:32,linkReferenceSizeMax:999,listItemValueSizeMax:10,numericBaseDecimal:10,numericBaseHexadecimal:16,tabSize:4,thematicBreakMarkerCountMin:3,v8MaxSafeChunkSize:1e4},A={data:"data",whitespace:"whitespace",lineEnding:"lineEnding",lineEndingBlank:"lineEndingBlank",linePrefix:"linePrefix",lineSuffix:"lineSuffix",atxHeading:"atxHeading",atxHeadingSequence:"atxHeadingSequence",atxHeadingText:"atxHeadingText",autolink:"autolink",autolinkEmail:"autolinkEmail",autolinkMarker:"autolinkMarker",autolinkProtocol:"autolinkProtocol",characterEscape:"characterEscape",characterEscapeValue:"characterEscapeValue",characterReference:"characterReference",characterReferenceMarker:"characterReferenceMarker",characterReferenceMarkerNumeric:"characterReferenceMarkerNumeric",characterReferenceMarkerHexadecimal:"characterReferenceMarkerHexadecimal",characterReferenceValue:"characterReferenceValue",codeFenced:"codeFenced",codeFencedFence:"codeFencedFence",codeFencedFenceSequence:"codeFencedFenceSequence",codeFencedFenceInfo:"codeFencedFenceInfo",codeFencedFenceMeta:"codeFencedFenceMeta",codeFlowValue:"codeFlowValue",codeIndented:"codeIndented",codeText:"codeText",codeTextData:"codeTextData",codeTextPadding:"codeTextPadding",codeTextSequence:"codeTextSequence",content:"content",definition:"definition",definitionDestination:"definitionDestination",definitionDestinationLiteral:"definitionDestinationLiteral",definitionDestinationLiteralMarker:"definitionDestinationLiteralMarker",definitionDestinationRaw:"definitionDestinationRaw",definitionDestinationString:"definitionDestinationString",definitionLabel:"definitionLabel",definitionLabelMarker:"definitionLabelMarker",definitionLabelString:"definitionLabelString",definitionMarker:"definitionMarker",definitionTitle:"definitionTitle",definitionTitleMarker:"definitionTitleMarker",definitionTitleString:"definitionTitleString",emphasis:"emphasis",emphasisSequence:"emphasisSequence",emphasisText:"emphasisText",escapeMarker:"escapeMarker",hardBreakEscape:"hardBreakEscape",hardBreakTrailing:"hardBreakTrailing",htmlFlow:"htmlFlow",htmlFlowData:"htmlFlowData",htmlText:"htmlText",htmlTextData:"htmlTextData",image:"image",label:"label",labelText:"labelText",labelLink:"labelLink",labelImage:"labelImage",labelMarker:"labelMarker",labelImageMarker:"labelImageMarker",labelEnd:"labelEnd",link:"link",paragraph:"paragraph",reference:"reference",referenceMarker:"referenceMarker",referenceString:"referenceString",resource:"resource",resourceDestination:"resourceDestination",resourceDestinationLiteral:"resourceDestinationLiteral",resourceDestinationLiteralMarker:"resourceDestinationLiteralMarker",resourceDestinationRaw:"resourceDestinationRaw",resourceDestinationString:"resourceDestinationString",resourceMarker:"resourceMarker",resourceTitle:"resourceTitle",resourceTitleMarker:"resourceTitleMarker",resourceTitleString:"resourceTitleString",setextHeading:"setextHeading",setextHeadingText:"setextHeadingText",setextHeadingLine:"setextHeadingLine",setextHeadingLineSequence:"setextHeadingLineSequence",strong:"strong",strongSequence:"strongSequence",strongText:"strongText",thematicBreak:"thematicBreak",thematicBreakSequence:"thematicBreakSequence",blockQuote:"blockQuote",blockQuotePrefix:"blockQuotePrefix",blockQuoteMarker:"blockQuoteMarker",blockQuotePrefixWhitespace:"blockQuotePrefixWhitespace",listOrdered:"listOrdered",listUnordered:"listUnordered",listItemIndent:"listItemIndent",listItemMarker:"listItemMarker",listItemPrefix:"listItemPrefix",listItemPrefixWhitespace:"listItemPrefixWhitespace",listItemValue:"listItemValue",chunkContent:"chunkContent",chunkFlow:"chunkFlow",chunkText:"chunkText",chunkString:"chunkString"},Kn={ht:"	",lf:`
`,cr:"\r",space:" ",replacementCharacter:"ï¿½"};function la(e,r,t,n){const a=e.length;let i=0,s;if(r<0?r=-r>a?0:a+r:r=r>a?a:r,t=t>0?t:0,n.length<Oe.v8MaxSafeChunkSize)s=Array.from(n),s.unshift(r,t),e.splice(...s);else for(t&&e.splice(r,t);i<n.length;)s=n.slice(i,i+Oe.v8MaxSafeChunkSize),s.unshift(r,0),e.splice(...s),i+=Oe.v8MaxSafeChunkSize,r+=Oe.v8MaxSafeChunkSize}function pn(e,r){return e.length>0?(la(e,e.length,0,r),e):r}const ET={}.hasOwnProperty;function Are(e){const r={};let t=-1;for(;++t<e.length;)kre(r,e[t]);return r}function kre(e,r){let t;for(t in r){const a=(ET.call(e,t)?e[t]:void 0)||(e[t]={}),i=r[t];let s;if(i)for(s in i){ET.call(a,s)||(a[s]=[]);const o=i[s];Rre(a[s],Array.isArray(o)?o:o?[o]:[])}}}function Rre(e,r){let t=-1;const n=[];for(;++t<r.length;)(r[t].add==="after"?e:n).push(r[t]);la(e,0,0,n)}function qI(e,r){const t=Number.parseInt(e,r);return t<O.ht||t===O.vt||t>O.cr&&t<O.space||t>O.tilde&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?Kn.replacementCharacter:String.fromCodePoint(t)}function Ws(e){return e.replace(/[\t\n\r ]+/g,Kn.space).replace(/^ | $/g,"").toLowerCase().toUpperCase()}const ea=Ci(/[A-Za-z]/),sn=Ci(/[\dA-Za-z]/),Ore=Ci(/[#-'*+\--9=?A-Z^-~]/);function x1(e){return e!==null&&(e<O.space||e===O.del)}const g1=Ci(/\d/),Fre=Ci(/[\dA-Fa-f]/),Ure=Ci(/[!-/:-@[-`{-~]/);function Pe(e){return e!==null&&e<O.horizontalTab}function Bt(e){return e!==null&&(e<O.nul||e===O.space)}function or(e){return e===O.horizontalTab||e===O.virtualSpace||e===O.space}const Ire=Ci(/\p{P}|\p{S}/u),Pre=Ci(/\s/);function Ci(e){return r;function r(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function wo(e){const r=[];let t=-1,n=0,a=0;for(;++t<e.length;){const i=e.charCodeAt(t);let s="";if(i===O.percentSign&&sn(e.charCodeAt(t+1))&&sn(e.charCodeAt(t+2)))a=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(s=String.fromCharCode(i));else if(i>55295&&i<57344){const o=e.charCodeAt(t+1);i<56320&&o>56319&&o<57344?(s=String.fromCharCode(i,o),a=1):s=Kn.replacementCharacter}else s=String.fromCharCode(i);s&&(r.push(e.slice(n,t),encodeURIComponent(s)),n=t+a+1,s=""),a&&(t+=a,a=0)}return r.join("")+e.slice(n)}function Sr(e,r,t,n){const a=n?n-1:Number.POSITIVE_INFINITY;let i=0;return s;function s(u){return or(u)?(e.enter(t),o(u)):r(u)}function o(u){return or(u)&&i++<a?(e.consume(u),o):(e.exit(t),r(u))}}const Vre={tokenize:Mre};function Mre(e){const r=e.attempt(this.parser.constructs.contentInitial,n,a);let t;return r;function n(o){if(K(o===O.eof||Pe(o),"expected eol or eof"),o===O.eof){e.consume(o);return}return e.enter(A.lineEnding),e.consume(o),e.exit(A.lineEnding),Sr(e,r,A.linePrefix)}function a(o){return K(o!==O.eof&&!Pe(o),"expected anything other than a line ending or EOF"),e.enter(A.paragraph),i(o)}function i(o){const u=e.enter(A.chunkText,{contentType:Oe.contentTypeText,previous:t});return t&&(t.next=u),t=u,s(o)}function s(o){if(o===O.eof){e.exit(A.chunkText),e.exit(A.paragraph),e.consume(o);return}return Pe(o)?(e.consume(o),e.exit(A.chunkText),i):(e.consume(o),s)}}const jre={tokenize:Lre},wT={tokenize:Bre};function Lre(e){const r=this,t=[];let n=0,a,i,s;return o;function o(b){if(n<t.length){const y=t[n];return r.containerState=y[1],K(y[0].continuation,"expected `continuation` to be defined on container construct"),e.attempt(y[0].continuation,u,l)(b)}return l(b)}function u(b){if(K(r.containerState,"expected `containerState` to be defined after continuation"),n++,r.containerState._closeFlow){r.containerState._closeFlow=void 0,a&&N();const y=r.events.length;let _=y,w;for(;_--;)if(r.events[_][0]==="exit"&&r.events[_][1].type===A.chunkFlow){w=r.events[_][1].end;break}K(w,"could not find previous flow chunk"),g(n);let C=y;for(;C<r.events.length;)r.events[C][1].end={...w},C++;return la(r.events,_+1,0,r.events.slice(y)),r.events.length=C,l(b)}return o(b)}function l(b){if(n===t.length){if(!a)return h(b);if(a.currentConstruct&&a.currentConstruct.concrete)return v(b);r.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return r.containerState={},e.check(wT,c,f)(b)}function c(b){return a&&N(),g(n),h(b)}function f(b){return r.parser.lazy[r.now().line]=n!==t.length,s=r.now().offset,v(b)}function h(b){return r.containerState={},e.attempt(wT,d,v)(b)}function d(b){return K(r.currentConstruct,"expected `currentConstruct` to be defined on tokenizer"),K(r.containerState,"expected `containerState` to be defined on tokenizer"),n++,t.push([r.currentConstruct,r.containerState]),h(b)}function v(b){if(b===O.eof){a&&N(),g(0),e.consume(b);return}return a=a||r.parser.flow(r.now()),e.enter(A.chunkFlow,{_tokenizer:a,contentType:Oe.contentTypeFlow,previous:i}),p(b)}function p(b){if(b===O.eof){x(e.exit(A.chunkFlow),!0),g(0),e.consume(b);return}return Pe(b)?(e.consume(b),x(e.exit(A.chunkFlow)),n=0,r.interrupt=void 0,o):(e.consume(b),p)}function x(b,y){K(a,"expected `childFlow` to be defined when continuing");const _=r.sliceStream(b);if(y&&_.push(null),b.previous=i,i&&(i.next=b),i=b,a.defineSkip(b.start),a.write(_),r.parser.lazy[b.start.line]){let w=a.events.length;for(;w--;)if(a.events[w][1].start.offset<s&&(!a.events[w][1].end||a.events[w][1].end.offset>s))return;const C=r.events.length;let k=C,D,U;for(;k--;)if(r.events[k][0]==="exit"&&r.events[k][1].type===A.chunkFlow){if(D){U=r.events[k][1].end;break}D=!0}for(K(U,"could not find previous flow chunk"),g(n),w=C;w<r.events.length;)r.events[w][1].end={...U},w++;la(r.events,k+1,0,r.events.slice(C)),r.events.length=w}}function g(b){let y=t.length;for(;y-- >b;){const _=t[y];r.containerState=_[1],K(_[0].exit,"expected `exit` to be defined on container construct"),_[0].exit.call(r,e)}t.length=b}function N(){K(r.containerState,"expected `containerState` to be defined when closing flow"),K(a,"expected `childFlow` to be defined when closing it"),a.write([O.eof]),i=void 0,a=void 0,r.containerState._closeFlow=void 0}}function Bre(e,r,t){return K(this.parser.constructs.disable.null,"expected `disable.null` to be populated"),Sr(e,e.attempt(this.parser.constructs.document,r,t),A.linePrefix,this.parser.constructs.disable.null.includes("codeIndented")?void 0:Oe.tabSize)}function _T(e){if(e===O.eof||Bt(e)||Pre(e))return Oe.characterGroupWhitespace;if(Ire(e))return Oe.characterGroupPunctuation}function wN(e,r,t){const n=[];let a=-1;for(;++a<e.length;){const i=e[a].resolveAll;i&&!n.includes(i)&&(r=i(r,t),n.push(i))}return r}const b1={name:"attention",resolveAll:qre,tokenize:Hre};function qre(e,r){let t=-1,n,a,i,s,o,u,l,c;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(n=t;n--;)if(e[n][0]==="exit"&&e[n][1].type==="attentionSequence"&&e[n][1]._open&&r.sliceSerialize(e[n][1]).charCodeAt(0)===r.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[n][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;u=e[n][1].end.offset-e[n][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const f={...e[n][1].end},h={...e[t][1].start};ST(f,-u),ST(h,u),s={type:u>1?A.strongSequence:A.emphasisSequence,start:f,end:{...e[n][1].end}},o={type:u>1?A.strongSequence:A.emphasisSequence,start:{...e[t][1].start},end:h},i={type:u>1?A.strongText:A.emphasisText,start:{...e[n][1].end},end:{...e[t][1].start}},a={type:u>1?A.strong:A.emphasis,start:{...s.start},end:{...o.end}},e[n][1].end={...s.start},e[t][1].start={...o.end},l=[],e[n][1].end.offset-e[n][1].start.offset&&(l=pn(l,[["enter",e[n][1],r],["exit",e[n][1],r]])),l=pn(l,[["enter",a,r],["enter",s,r],["exit",s,r],["enter",i,r]]),K(r.parser.constructs.insideSpan.null,"expected `insideSpan` to be populated"),l=pn(l,wN(r.parser.constructs.insideSpan.null,e.slice(n+1,t),r)),l=pn(l,[["exit",i,r],["enter",o,r],["exit",o,r],["exit",a,r]]),e[t][1].end.offset-e[t][1].start.offset?(c=2,l=pn(l,[["enter",e[t][1],r],["exit",e[t][1],r]])):c=0,la(e,n-1,t-n+3,l),t=n+l.length-c-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function Hre(e,r){const t=this.parser.constructs.attentionMarkers.null,n=this.previous,a=_T(n);let i;return s;function s(u){return K(u===O.asterisk||u===O.underscore,"expected asterisk or underscore"),i=u,e.enter("attentionSequence"),o(u)}function o(u){if(u===i)return e.consume(u),o;const l=e.exit("attentionSequence"),c=_T(u);K(t,"expected `attentionMarkers` to be populated");const f=!c||c===Oe.characterGroupPunctuation&&a||t.includes(u),h=!a||a===Oe.characterGroupPunctuation&&c||t.includes(n);return l._open=!!(i===O.asterisk?f:f&&(a||!h)),l._close=!!(i===O.asterisk?h:h&&(c||!f)),r(u)}}function ST(e,r){e.column+=r,e.offset+=r,e._bufferIndex+=r}const zre={name:"autolink",tokenize:$re};function $re(e,r,t){let n=0;return a;function a(d){return K(d===O.lessThan,"expected `<`"),e.enter(A.autolink),e.enter(A.autolinkMarker),e.consume(d),e.exit(A.autolinkMarker),e.enter(A.autolinkProtocol),i}function i(d){return ea(d)?(e.consume(d),s):d===O.atSign?t(d):l(d)}function s(d){return d===O.plusSign||d===O.dash||d===O.dot||sn(d)?(n=1,o(d)):l(d)}function o(d){return d===O.colon?(e.consume(d),n=0,u):(d===O.plusSign||d===O.dash||d===O.dot||sn(d))&&n++<Oe.autolinkSchemeSizeMax?(e.consume(d),o):(n=0,l(d))}function u(d){return d===O.greaterThan?(e.exit(A.autolinkProtocol),e.enter(A.autolinkMarker),e.consume(d),e.exit(A.autolinkMarker),e.exit(A.autolink),r):d===O.eof||d===O.space||d===O.lessThan||x1(d)?t(d):(e.consume(d),u)}function l(d){return d===O.atSign?(e.consume(d),c):Ore(d)?(e.consume(d),l):t(d)}function c(d){return sn(d)?f(d):t(d)}function f(d){return d===O.dot?(e.consume(d),n=0,c):d===O.greaterThan?(e.exit(A.autolinkProtocol).type=A.autolinkEmail,e.enter(A.autolinkMarker),e.consume(d),e.exit(A.autolinkMarker),e.exit(A.autolink),r):h(d)}function h(d){if((d===O.dash||sn(d))&&n++<Oe.autolinkDomainSizeMax){const v=d===O.dash?h:f;return e.consume(d),v}return t(d)}}const Of={partial:!0,tokenize:Gre};function Gre(e,r,t){return n;function n(i){return or(i)?Sr(e,a,A.linePrefix)(i):a(i)}function a(i){return i===O.eof||Pe(i)?r(i):t(i)}}const HI={continuation:{tokenize:Yre},exit:Kre,name:"blockQuote",tokenize:Wre};function Wre(e,r,t){const n=this;return a;function a(s){if(s===O.greaterThan){const o=n.containerState;return K(o,"expected `containerState` to be defined in container"),o.open||(e.enter(A.blockQuote,{_container:!0}),o.open=!0),e.enter(A.blockQuotePrefix),e.enter(A.blockQuoteMarker),e.consume(s),e.exit(A.blockQuoteMarker),i}return t(s)}function i(s){return or(s)?(e.enter(A.blockQuotePrefixWhitespace),e.consume(s),e.exit(A.blockQuotePrefixWhitespace),e.exit(A.blockQuotePrefix),r):(e.exit(A.blockQuotePrefix),r(s))}}function Yre(e,r,t){const n=this;return a;function a(s){return or(s)?(K(n.parser.constructs.disable.null,"expected `disable.null` to be populated"),Sr(e,i,A.linePrefix,n.parser.constructs.disable.null.includes("codeIndented")?void 0:Oe.tabSize)(s)):i(s)}function i(s){return e.attempt(HI,r,t)(s)}}function Kre(e){e.exit(A.blockQuote)}const zI={name:"characterEscape",tokenize:Xre};function Xre(e,r,t){return n;function n(i){return K(i===O.backslash,"expected `\\`"),e.enter(A.characterEscape),e.enter(A.escapeMarker),e.consume(i),e.exit(A.escapeMarker),a}function a(i){return Ure(i)?(e.enter(A.characterEscapeValue),e.consume(i),e.exit(A.characterEscapeValue),e.exit(A.characterEscape),r):t(i)}}const $I={name:"characterReference",tokenize:Qre};function Qre(e,r,t){const n=this;let a=0,i,s;return o;function o(f){return K(f===O.ampersand,"expected `&`"),e.enter(A.characterReference),e.enter(A.characterReferenceMarker),e.consume(f),e.exit(A.characterReferenceMarker),u}function u(f){return f===O.numberSign?(e.enter(A.characterReferenceMarkerNumeric),e.consume(f),e.exit(A.characterReferenceMarkerNumeric),l):(e.enter(A.characterReferenceValue),i=Oe.characterReferenceNamedSizeMax,s=sn,c(f))}function l(f){return f===O.uppercaseX||f===O.lowercaseX?(e.enter(A.characterReferenceMarkerHexadecimal),e.consume(f),e.exit(A.characterReferenceMarkerHexadecimal),e.enter(A.characterReferenceValue),i=Oe.characterReferenceHexadecimalSizeMax,s=Fre,c):(e.enter(A.characterReferenceValue),i=Oe.characterReferenceDecimalSizeMax,s=g1,c(f))}function c(f){if(f===O.semicolon&&a){const h=e.exit(A.characterReferenceValue);return s===sn&&!EN(n.sliceSerialize(h))?t(f):(e.enter(A.characterReferenceMarker),e.consume(f),e.exit(A.characterReferenceMarker),e.exit(A.characterReference),r)}return s(f)&&a++<i?(e.consume(f),c):t(f)}}const TT={partial:!0,tokenize:Jre},DT={concrete:!0,name:"codeFenced",tokenize:Zre};function Zre(e,r,t){const n=this,a={partial:!0,tokenize:_};let i=0,s=0,o;return u;function u(w){return l(w)}function l(w){K(w===O.graveAccent||w===O.tilde,"expected `` ` `` or `~`");const C=n.events[n.events.length-1];return i=C&&C[1].type===A.linePrefix?C[2].sliceSerialize(C[1],!0).length:0,o=w,e.enter(A.codeFenced),e.enter(A.codeFencedFence),e.enter(A.codeFencedFenceSequence),c(w)}function c(w){return w===o?(s++,e.consume(w),c):s<Oe.codeFencedSequenceSizeMin?t(w):(e.exit(A.codeFencedFenceSequence),or(w)?Sr(e,f,A.whitespace)(w):f(w))}function f(w){return w===O.eof||Pe(w)?(e.exit(A.codeFencedFence),n.interrupt?r(w):e.check(TT,p,y)(w)):(e.enter(A.codeFencedFenceInfo),e.enter(A.chunkString,{contentType:Oe.contentTypeString}),h(w))}function h(w){return w===O.eof||Pe(w)?(e.exit(A.chunkString),e.exit(A.codeFencedFenceInfo),f(w)):or(w)?(e.exit(A.chunkString),e.exit(A.codeFencedFenceInfo),Sr(e,d,A.whitespace)(w)):w===O.graveAccent&&w===o?t(w):(e.consume(w),h)}function d(w){return w===O.eof||Pe(w)?f(w):(e.enter(A.codeFencedFenceMeta),e.enter(A.chunkString,{contentType:Oe.contentTypeString}),v(w))}function v(w){return w===O.eof||Pe(w)?(e.exit(A.chunkString),e.exit(A.codeFencedFenceMeta),f(w)):w===O.graveAccent&&w===o?t(w):(e.consume(w),v)}function p(w){return K(Pe(w),"expected eol"),e.attempt(a,y,x)(w)}function x(w){return K(Pe(w),"expected eol"),e.enter(A.lineEnding),e.consume(w),e.exit(A.lineEnding),g}function g(w){return i>0&&or(w)?Sr(e,N,A.linePrefix,i+1)(w):N(w)}function N(w){return w===O.eof||Pe(w)?e.check(TT,p,y)(w):(e.enter(A.codeFlowValue),b(w))}function b(w){return w===O.eof||Pe(w)?(e.exit(A.codeFlowValue),N(w)):(e.consume(w),b)}function y(w){return e.exit(A.codeFenced),r(w)}function _(w,C,k){let D=0;return U;function U(G){return K(Pe(G),"expected eol"),w.enter(A.lineEnding),w.consume(G),w.exit(A.lineEnding),F}function F(G){return K(n.parser.constructs.disable.null,"expected `disable.null` to be populated"),w.enter(A.codeFencedFence),or(G)?Sr(w,L,A.linePrefix,n.parser.constructs.disable.null.includes("codeIndented")?void 0:Oe.tabSize)(G):L(G)}function L(G){return G===o?(w.enter(A.codeFencedFenceSequence),P(G)):k(G)}function P(G){return G===o?(D++,w.consume(G),P):D>=s?(w.exit(A.codeFencedFenceSequence),or(G)?Sr(w,B,A.whitespace)(G):B(G)):k(G)}function B(G){return G===O.eof||Pe(G)?(w.exit(A.codeFencedFence),C(G)):k(G)}}}function Jre(e,r,t){const n=this;return a;function a(s){return s===O.eof?t(s):(K(Pe(s),"expected eol"),e.enter(A.lineEnding),e.consume(s),e.exit(A.lineEnding),i)}function i(s){return n.parser.lazy[n.now().line]?t(s):r(s)}}const Ip={name:"codeIndented",tokenize:rte},ete={partial:!0,tokenize:tte};function rte(e,r,t){const n=this;return a;function a(l){return K(or(l)),e.enter(A.codeIndented),Sr(e,i,A.linePrefix,Oe.tabSize+1)(l)}function i(l){const c=n.events[n.events.length-1];return c&&c[1].type===A.linePrefix&&c[2].sliceSerialize(c[1],!0).length>=Oe.tabSize?s(l):t(l)}function s(l){return l===O.eof?u(l):Pe(l)?e.attempt(ete,s,u)(l):(e.enter(A.codeFlowValue),o(l))}function o(l){return l===O.eof||Pe(l)?(e.exit(A.codeFlowValue),s(l)):(e.consume(l),o)}function u(l){return e.exit(A.codeIndented),r(l)}}function tte(e,r,t){const n=this;return a;function a(s){return n.parser.lazy[n.now().line]?t(s):Pe(s)?(e.enter(A.lineEnding),e.consume(s),e.exit(A.lineEnding),a):Sr(e,i,A.linePrefix,Oe.tabSize+1)(s)}function i(s){const o=n.events[n.events.length-1];return o&&o[1].type===A.linePrefix&&o[2].sliceSerialize(o[1],!0).length>=Oe.tabSize?r(s):Pe(s)?a(s):t(s)}}const nte={name:"codeText",previous:GI,resolve:ate,tokenize:ite};function ate(e){let r=e.length-4,t=3,n,a;if((e[t][1].type===A.lineEnding||e[t][1].type==="space")&&(e[r][1].type===A.lineEnding||e[r][1].type==="space")){for(n=t;++n<r;)if(e[n][1].type===A.codeTextData){e[t][1].type=A.codeTextPadding,e[r][1].type=A.codeTextPadding,t+=2,r-=2;break}}for(n=t-1,r++;++n<=r;)a===void 0?n!==r&&e[n][1].type!==A.lineEnding&&(a=n):(n===r||e[n][1].type===A.lineEnding)&&(e[a][1].type=A.codeTextData,n!==a+2&&(e[a][1].end=e[n-1][1].end,e.splice(a+2,n-a-2),r-=n-a-2,n=a+2),a=void 0);return e}function GI(e){return e!==O.graveAccent||this.events[this.events.length-1][1].type===A.characterEscape}function ite(e,r,t){const n=this;let a=0,i,s;return o;function o(h){return K(h===O.graveAccent,"expected `` ` ``"),K(GI.call(n,n.previous),"expected correct previous"),e.enter(A.codeText),e.enter(A.codeTextSequence),u(h)}function u(h){return h===O.graveAccent?(e.consume(h),a++,u):(e.exit(A.codeTextSequence),l(h))}function l(h){return h===O.eof?t(h):h===O.space?(e.enter("space"),e.consume(h),e.exit("space"),l):h===O.graveAccent?(s=e.enter(A.codeTextSequence),i=0,f(h)):Pe(h)?(e.enter(A.lineEnding),e.consume(h),e.exit(A.lineEnding),l):(e.enter(A.codeTextData),c(h))}function c(h){return h===O.eof||h===O.space||h===O.graveAccent||Pe(h)?(e.exit(A.codeTextData),l(h)):(e.consume(h),c)}function f(h){return h===O.graveAccent?(e.consume(h),i++,f):i===a?(e.exit(A.codeTextSequence),e.exit(A.codeText),r(h)):(s.type=A.codeTextData,c(h))}}class ste{constructor(r){this.left=r?[...r]:[],this.right=[]}get(r){if(r<0||r>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+r+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return r<this.left.length?this.left[r]:this.right[this.right.length-r+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(r,t){const n=t??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(r,n):r>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-r+this.left.length).reverse():this.left.slice(r).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(r,t,n){const a=t||0;this.setCursor(Math.trunc(r));const i=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return n&&zo(this.left,n),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(r){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(r)}pushMany(r){this.setCursor(Number.POSITIVE_INFINITY),zo(this.left,r)}unshift(r){this.setCursor(0),this.right.push(r)}unshiftMany(r){this.setCursor(0),zo(this.right,r.reverse())}setCursor(r){if(!(r===this.left.length||r>this.left.length&&this.right.length===0||r<0&&this.left.length===0))if(r<this.left.length){const t=this.left.splice(r,Number.POSITIVE_INFINITY);zo(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-r,Number.POSITIVE_INFINITY);zo(this.left,t.reverse())}}}function zo(e,r){let t=0;if(r.length<Oe.v8MaxSafeChunkSize)e.push(...r);else for(;t<r.length;)e.push(...r.slice(t,t+Oe.v8MaxSafeChunkSize)),t+=Oe.v8MaxSafeChunkSize}function WI(e){const r={};let t=-1,n,a,i,s,o,u,l;const c=new ste(e);for(;++t<c.length;){for(;t in r;)t=r[t];if(n=c.get(t),t&&n[1].type===A.chunkFlow&&c.get(t-1)[1].type===A.listItemPrefix&&(K(n[1]._tokenizer,"expected `_tokenizer` on subtokens"),u=n[1]._tokenizer.events,i=0,i<u.length&&u[i][1].type===A.lineEndingBlank&&(i+=2),i<u.length&&u[i][1].type===A.content))for(;++i<u.length&&u[i][1].type!==A.content;)u[i][1].type===A.chunkText&&(u[i][1]._isInFirstContentOfListItem=!0,i++);if(n[0]==="enter")n[1].contentType&&(Object.assign(r,ote(c,t)),t=r[t],l=!0);else if(n[1]._container){for(i=t,a=void 0;i--;)if(s=c.get(i),s[1].type===A.lineEnding||s[1].type===A.lineEndingBlank)s[0]==="enter"&&(a&&(c.get(a)[1].type=A.lineEndingBlank),s[1].type=A.lineEnding,a=i);else if(!(s[1].type===A.linePrefix||s[1].type===A.listItemIndent))break;a&&(n[1].end={...c.get(a)[1].start},o=c.slice(a,t),o.unshift(n),c.splice(a,t-a+1,o))}}return la(e,0,Number.POSITIVE_INFINITY,c.slice(0)),!l}function ote(e,r){const t=e.get(r)[1],n=e.get(r)[2];let a=r-1;const i=[];K(t.contentType,"expected `contentType` on subtokens");let s=t._tokenizer;s||(s=n.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(s._contentTypeTextTrailing=!0));const o=s.events,u=[],l={};let c,f,h=-1,d=t,v=0,p=0;const x=[p];for(;d;){for(;e.get(++a)[1]!==d;);K(!f||d.previous===f,"expected previous to match"),K(!f||f.next===d,"expected next to match"),i.push(a),d._tokenizer||(c=n.sliceStream(d),d.next||c.push(O.eof),f&&s.defineSkip(d.start),d._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(c),d._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),f=d,d=d.next}for(d=t;++h<o.length;)o[h][0]==="exit"&&o[h-1][0]==="enter"&&o[h][1].type===o[h-1][1].type&&o[h][1].start.line!==o[h][1].end.line&&(K(d,"expected a current token"),p=h+1,x.push(p),d._tokenizer=void 0,d.previous=void 0,d=d.next);for(s.events=[],d?(d._tokenizer=void 0,d.previous=void 0,K(!d.next,"expected no next token")):x.pop(),h=x.length;h--;){const g=o.slice(x[h],x[h+1]),N=i.pop();K(N!==void 0,"expected a start position when splicing"),u.push([N,N+g.length-1]),e.splice(N,2,g)}for(u.reverse(),h=-1;++h<u.length;)l[v+u[h][0]]=v+u[h][1],v+=u[h][1]-u[h][0]-1;return l}const lte={resolve:cte,tokenize:fte},ute={partial:!0,tokenize:mte};function cte(e){return WI(e),e}function fte(e,r){let t;return n;function n(o){return K(o!==O.eof&&!Pe(o),"expected no eof or eol"),e.enter(A.content),t=e.enter(A.chunkContent,{contentType:Oe.contentTypeContent}),a(o)}function a(o){return o===O.eof?i(o):Pe(o)?e.check(ute,s,i)(o):(e.consume(o),a)}function i(o){return e.exit(A.chunkContent),e.exit(A.content),r(o)}function s(o){return K(Pe(o),"expected eol"),e.consume(o),e.exit(A.chunkContent),K(t,"expected previous token"),t.next=e.enter(A.chunkContent,{contentType:Oe.contentTypeContent,previous:t}),t=t.next,a}}function mte(e,r,t){const n=this;return a;function a(s){return K(Pe(s),"expected a line ending"),e.exit(A.chunkContent),e.enter(A.lineEnding),e.consume(s),e.exit(A.lineEnding),Sr(e,i,A.linePrefix)}function i(s){if(s===O.eof||Pe(s))return t(s);K(n.parser.constructs.disable.null,"expected `disable.null` to be populated");const o=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type===A.linePrefix&&o[2].sliceSerialize(o[1],!0).length>=Oe.tabSize?r(s):e.interrupt(n.parser.constructs.flow,t,r)(s)}}function YI(e,r,t,n,a,i,s,o,u){const l=u||Number.POSITIVE_INFINITY;let c=0;return f;function f(g){return g===O.lessThan?(e.enter(n),e.enter(a),e.enter(i),e.consume(g),e.exit(i),h):g===O.eof||g===O.space||g===O.rightParenthesis||x1(g)?t(g):(e.enter(n),e.enter(s),e.enter(o),e.enter(A.chunkString,{contentType:Oe.contentTypeString}),p(g))}function h(g){return g===O.greaterThan?(e.enter(i),e.consume(g),e.exit(i),e.exit(a),e.exit(n),r):(e.enter(o),e.enter(A.chunkString,{contentType:Oe.contentTypeString}),d(g))}function d(g){return g===O.greaterThan?(e.exit(A.chunkString),e.exit(o),h(g)):g===O.eof||g===O.lessThan||Pe(g)?t(g):(e.consume(g),g===O.backslash?v:d)}function v(g){return g===O.lessThan||g===O.greaterThan||g===O.backslash?(e.consume(g),d):d(g)}function p(g){return!c&&(g===O.eof||g===O.rightParenthesis||Bt(g))?(e.exit(A.chunkString),e.exit(o),e.exit(s),e.exit(n),r(g)):c<l&&g===O.leftParenthesis?(e.consume(g),c++,p):g===O.rightParenthesis?(e.consume(g),c--,p):g===O.eof||g===O.space||g===O.leftParenthesis||x1(g)?t(g):(e.consume(g),g===O.backslash?x:p)}function x(g){return g===O.leftParenthesis||g===O.rightParenthesis||g===O.backslash?(e.consume(g),p):p(g)}}function KI(e,r,t,n,a,i){const s=this;let o=0,u;return l;function l(d){return K(d===O.leftSquareBracket,"expected `[`"),e.enter(n),e.enter(a),e.consume(d),e.exit(a),e.enter(i),c}function c(d){return o>Oe.linkReferenceSizeMax||d===O.eof||d===O.leftSquareBracket||d===O.rightSquareBracket&&!u||d===O.caret&&!o&&"_hiddenFootnoteSupport"in s.parser.constructs?t(d):d===O.rightSquareBracket?(e.exit(i),e.enter(a),e.consume(d),e.exit(a),e.exit(n),r):Pe(d)?(e.enter(A.lineEnding),e.consume(d),e.exit(A.lineEnding),c):(e.enter(A.chunkString,{contentType:Oe.contentTypeString}),f(d))}function f(d){return d===O.eof||d===O.leftSquareBracket||d===O.rightSquareBracket||Pe(d)||o++>Oe.linkReferenceSizeMax?(e.exit(A.chunkString),c(d)):(e.consume(d),u||(u=!or(d)),d===O.backslash?h:f)}function h(d){return d===O.leftSquareBracket||d===O.backslash||d===O.rightSquareBracket?(e.consume(d),o++,f):f(d)}}function XI(e,r,t,n,a,i){let s;return o;function o(h){return h===O.quotationMark||h===O.apostrophe||h===O.leftParenthesis?(e.enter(n),e.enter(a),e.consume(h),e.exit(a),s=h===O.leftParenthesis?O.rightParenthesis:h,u):t(h)}function u(h){return h===s?(e.enter(a),e.consume(h),e.exit(a),e.exit(n),r):(e.enter(i),l(h))}function l(h){return h===s?(e.exit(i),u(s)):h===O.eof?t(h):Pe(h)?(e.enter(A.lineEnding),e.consume(h),e.exit(A.lineEnding),Sr(e,l,A.linePrefix)):(e.enter(A.chunkString,{contentType:Oe.contentTypeString}),c(h))}function c(h){return h===s||h===O.eof||Pe(h)?(e.exit(A.chunkString),l(h)):(e.consume(h),h===O.backslash?f:c)}function f(h){return h===s||h===O.backslash?(e.consume(h),c):c(h)}}function ml(e,r){let t;return n;function n(a){return Pe(a)?(e.enter(A.lineEnding),e.consume(a),e.exit(A.lineEnding),t=!0,n):or(a)?Sr(e,n,t?A.linePrefix:A.lineSuffix)(a):r(a)}}const dte={name:"definition",tokenize:pte},hte={partial:!0,tokenize:vte};function pte(e,r,t){const n=this;let a;return i;function i(d){return e.enter(A.definition),s(d)}function s(d){return K(d===O.leftSquareBracket,"expected `[`"),KI.call(n,e,o,t,A.definitionLabel,A.definitionLabelMarker,A.definitionLabelString)(d)}function o(d){return a=Ws(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),d===O.colon?(e.enter(A.definitionMarker),e.consume(d),e.exit(A.definitionMarker),u):t(d)}function u(d){return Bt(d)?ml(e,l)(d):l(d)}function l(d){return YI(e,c,t,A.definitionDestination,A.definitionDestinationLiteral,A.definitionDestinationLiteralMarker,A.definitionDestinationRaw,A.definitionDestinationString)(d)}function c(d){return e.attempt(hte,f,f)(d)}function f(d){return or(d)?Sr(e,h,A.whitespace)(d):h(d)}function h(d){return d===O.eof||Pe(d)?(e.exit(A.definition),n.parser.defined.push(a),r(d)):t(d)}}function vte(e,r,t){return n;function n(o){return Bt(o)?ml(e,a)(o):t(o)}function a(o){return XI(e,i,t,A.definitionTitle,A.definitionTitleMarker,A.definitionTitleString)(o)}function i(o){return or(o)?Sr(e,s,A.whitespace)(o):s(o)}function s(o){return o===O.eof||Pe(o)?r(o):t(o)}}const xte={name:"hardBreakEscape",tokenize:gte};function gte(e,r,t){return n;function n(i){return K(i===O.backslash,"expected `\\`"),e.enter(A.hardBreakEscape),e.consume(i),a}function a(i){return Pe(i)?(e.exit(A.hardBreakEscape),r(i)):t(i)}}const bte={name:"headingAtx",resolve:Nte,tokenize:yte};function Nte(e,r){let t=e.length-2,n=3,a,i;return e[n][1].type===A.whitespace&&(n+=2),t-2>n&&e[t][1].type===A.whitespace&&(t-=2),e[t][1].type===A.atxHeadingSequence&&(n===t-1||t-4>n&&e[t-2][1].type===A.whitespace)&&(t-=n+1===t?2:4),t>n&&(a={type:A.atxHeadingText,start:e[n][1].start,end:e[t][1].end},i={type:A.chunkText,start:e[n][1].start,end:e[t][1].end,contentType:Oe.contentTypeText},la(e,n,t-n+1,[["enter",a,r],["enter",i,r],["exit",i,r],["exit",a,r]])),e}function yte(e,r,t){let n=0;return a;function a(c){return e.enter(A.atxHeading),i(c)}function i(c){return K(c===O.numberSign,"expected `#`"),e.enter(A.atxHeadingSequence),s(c)}function s(c){return c===O.numberSign&&n++<Oe.atxHeadingOpeningFenceSizeMax?(e.consume(c),s):c===O.eof||Bt(c)?(e.exit(A.atxHeadingSequence),o(c)):t(c)}function o(c){return c===O.numberSign?(e.enter(A.atxHeadingSequence),u(c)):c===O.eof||Pe(c)?(e.exit(A.atxHeading),r(c)):or(c)?Sr(e,o,A.whitespace)(c):(e.enter(A.atxHeadingText),l(c))}function u(c){return c===O.numberSign?(e.consume(c),u):(e.exit(A.atxHeadingSequence),o(c))}function l(c){return c===O.eof||c===O.numberSign||Bt(c)?(e.exit(A.atxHeadingText),o(c)):(e.consume(c),l)}}const Cte=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],AT=["pre","script","style","textarea"],Ete={concrete:!0,name:"htmlFlow",resolveTo:Ste,tokenize:Tte},wte={partial:!0,tokenize:Ate},_te={partial:!0,tokenize:Dte};function Ste(e){let r=e.length;for(;r--&&!(e[r][0]==="enter"&&e[r][1].type===A.htmlFlow););return r>1&&e[r-2][1].type===A.linePrefix&&(e[r][1].start=e[r-2][1].start,e[r+1][1].start=e[r-2][1].start,e.splice(r-2,2)),e}function Tte(e,r,t){const n=this;let a,i,s,o,u;return l;function l(E){return c(E)}function c(E){return K(E===O.lessThan,"expected `<`"),e.enter(A.htmlFlow),e.enter(A.htmlFlowData),e.consume(E),f}function f(E){return E===O.exclamationMark?(e.consume(E),h):E===O.slash?(e.consume(E),i=!0,p):E===O.questionMark?(e.consume(E),a=Oe.htmlInstruction,n.interrupt?r:S):ea(E)?(K(E!==null),e.consume(E),s=String.fromCharCode(E),x):t(E)}function h(E){return E===O.dash?(e.consume(E),a=Oe.htmlComment,d):E===O.leftSquareBracket?(e.consume(E),a=Oe.htmlCdata,o=0,v):ea(E)?(e.consume(E),a=Oe.htmlDeclaration,n.interrupt?r:S):t(E)}function d(E){return E===O.dash?(e.consume(E),n.interrupt?r:S):t(E)}function v(E){const V=Oe.cdataOpeningString;return E===V.charCodeAt(o++)?(e.consume(E),o===V.length?n.interrupt?r:L:v):t(E)}function p(E){return ea(E)?(K(E!==null),e.consume(E),s=String.fromCharCode(E),x):t(E)}function x(E){if(E===O.eof||E===O.slash||E===O.greaterThan||Bt(E)){const V=E===O.slash,I=s.toLowerCase();return!V&&!i&&AT.includes(I)?(a=Oe.htmlRaw,n.interrupt?r(E):L(E)):Cte.includes(s.toLowerCase())?(a=Oe.htmlBasic,V?(e.consume(E),g):n.interrupt?r(E):L(E)):(a=Oe.htmlComplete,n.interrupt&&!n.parser.lazy[n.now().line]?t(E):i?N(E):b(E))}return E===O.dash||sn(E)?(e.consume(E),s+=String.fromCharCode(E),x):t(E)}function g(E){return E===O.greaterThan?(e.consume(E),n.interrupt?r:L):t(E)}function N(E){return or(E)?(e.consume(E),N):U(E)}function b(E){return E===O.slash?(e.consume(E),U):E===O.colon||E===O.underscore||ea(E)?(e.consume(E),y):or(E)?(e.consume(E),b):U(E)}function y(E){return E===O.dash||E===O.dot||E===O.colon||E===O.underscore||sn(E)?(e.consume(E),y):_(E)}function _(E){return E===O.equalsTo?(e.consume(E),w):or(E)?(e.consume(E),_):b(E)}function w(E){return E===O.eof||E===O.lessThan||E===O.equalsTo||E===O.greaterThan||E===O.graveAccent?t(E):E===O.quotationMark||E===O.apostrophe?(e.consume(E),u=E,C):or(E)?(e.consume(E),w):k(E)}function C(E){return E===u?(e.consume(E),u=null,D):E===O.eof||Pe(E)?t(E):(e.consume(E),C)}function k(E){return E===O.eof||E===O.quotationMark||E===O.apostrophe||E===O.slash||E===O.lessThan||E===O.equalsTo||E===O.greaterThan||E===O.graveAccent||Bt(E)?_(E):(e.consume(E),k)}function D(E){return E===O.slash||E===O.greaterThan||or(E)?b(E):t(E)}function U(E){return E===O.greaterThan?(e.consume(E),F):t(E)}function F(E){return E===O.eof||Pe(E)?L(E):or(E)?(e.consume(E),F):t(E)}function L(E){return E===O.dash&&a===Oe.htmlComment?(e.consume(E),ue):E===O.lessThan&&a===Oe.htmlRaw?(e.consume(E),oe):E===O.greaterThan&&a===Oe.htmlDeclaration?(e.consume(E),re):E===O.questionMark&&a===Oe.htmlInstruction?(e.consume(E),S):E===O.rightSquareBracket&&a===Oe.htmlCdata?(e.consume(E),fe):Pe(E)&&(a===Oe.htmlBasic||a===Oe.htmlComplete)?(e.exit(A.htmlFlowData),e.check(wte,T,P)(E)):E===O.eof||Pe(E)?(e.exit(A.htmlFlowData),P(E)):(e.consume(E),L)}function P(E){return e.check(_te,B,T)(E)}function B(E){return K(Pe(E)),e.enter(A.lineEnding),e.consume(E),e.exit(A.lineEnding),G}function G(E){return E===O.eof||Pe(E)?P(E):(e.enter(A.htmlFlowData),L(E))}function ue(E){return E===O.dash?(e.consume(E),S):L(E)}function oe(E){return E===O.slash?(e.consume(E),s="",he):L(E)}function he(E){if(E===O.greaterThan){const V=s.toLowerCase();return AT.includes(V)?(e.consume(E),re):L(E)}return ea(E)&&s.length<Oe.htmlRawSizeMax?(K(E!==null),e.consume(E),s+=String.fromCharCode(E),he):L(E)}function fe(E){return E===O.rightSquareBracket?(e.consume(E),S):L(E)}function S(E){return E===O.greaterThan?(e.consume(E),re):E===O.dash&&a===Oe.htmlComment?(e.consume(E),S):L(E)}function re(E){return E===O.eof||Pe(E)?(e.exit(A.htmlFlowData),T(E)):(e.consume(E),re)}function T(E){return e.exit(A.htmlFlow),r(E)}}function Dte(e,r,t){const n=this;return a;function a(s){return Pe(s)?(e.enter(A.lineEnding),e.consume(s),e.exit(A.lineEnding),i):t(s)}function i(s){return n.parser.lazy[n.now().line]?t(s):r(s)}}function Ate(e,r,t){return n;function n(a){return K(Pe(a),"expected a line ending"),e.enter(A.lineEnding),e.consume(a),e.exit(A.lineEnding),e.attempt(Of,r,t)}}const kte={name:"htmlText",tokenize:Rte};function Rte(e,r,t){const n=this;let a,i,s;return o;function o(S){return K(S===O.lessThan,"expected `<`"),e.enter(A.htmlText),e.enter(A.htmlTextData),e.consume(S),u}function u(S){return S===O.exclamationMark?(e.consume(S),l):S===O.slash?(e.consume(S),_):S===O.questionMark?(e.consume(S),b):ea(S)?(e.consume(S),k):t(S)}function l(S){return S===O.dash?(e.consume(S),c):S===O.leftSquareBracket?(e.consume(S),i=0,v):ea(S)?(e.consume(S),N):t(S)}function c(S){return S===O.dash?(e.consume(S),d):t(S)}function f(S){return S===O.eof?t(S):S===O.dash?(e.consume(S),h):Pe(S)?(s=f,oe(S)):(e.consume(S),f)}function h(S){return S===O.dash?(e.consume(S),d):f(S)}function d(S){return S===O.greaterThan?ue(S):S===O.dash?h(S):f(S)}function v(S){const re=Oe.cdataOpeningString;return S===re.charCodeAt(i++)?(e.consume(S),i===re.length?p:v):t(S)}function p(S){return S===O.eof?t(S):S===O.rightSquareBracket?(e.consume(S),x):Pe(S)?(s=p,oe(S)):(e.consume(S),p)}function x(S){return S===O.rightSquareBracket?(e.consume(S),g):p(S)}function g(S){return S===O.greaterThan?ue(S):S===O.rightSquareBracket?(e.consume(S),g):p(S)}function N(S){return S===O.eof||S===O.greaterThan?ue(S):Pe(S)?(s=N,oe(S)):(e.consume(S),N)}function b(S){return S===O.eof?t(S):S===O.questionMark?(e.consume(S),y):Pe(S)?(s=b,oe(S)):(e.consume(S),b)}function y(S){return S===O.greaterThan?ue(S):b(S)}function _(S){return ea(S)?(e.consume(S),w):t(S)}function w(S){return S===O.dash||sn(S)?(e.consume(S),w):C(S)}function C(S){return Pe(S)?(s=C,oe(S)):or(S)?(e.consume(S),C):ue(S)}function k(S){return S===O.dash||sn(S)?(e.consume(S),k):S===O.slash||S===O.greaterThan||Bt(S)?D(S):t(S)}function D(S){return S===O.slash?(e.consume(S),ue):S===O.colon||S===O.underscore||ea(S)?(e.consume(S),U):Pe(S)?(s=D,oe(S)):or(S)?(e.consume(S),D):ue(S)}function U(S){return S===O.dash||S===O.dot||S===O.colon||S===O.underscore||sn(S)?(e.consume(S),U):F(S)}function F(S){return S===O.equalsTo?(e.consume(S),L):Pe(S)?(s=F,oe(S)):or(S)?(e.consume(S),F):D(S)}function L(S){return S===O.eof||S===O.lessThan||S===O.equalsTo||S===O.greaterThan||S===O.graveAccent?t(S):S===O.quotationMark||S===O.apostrophe?(e.consume(S),a=S,P):Pe(S)?(s=L,oe(S)):or(S)?(e.consume(S),L):(e.consume(S),B)}function P(S){return S===a?(e.consume(S),a=void 0,G):S===O.eof?t(S):Pe(S)?(s=P,oe(S)):(e.consume(S),P)}function B(S){return S===O.eof||S===O.quotationMark||S===O.apostrophe||S===O.lessThan||S===O.equalsTo||S===O.graveAccent?t(S):S===O.slash||S===O.greaterThan||Bt(S)?D(S):(e.consume(S),B)}function G(S){return S===O.slash||S===O.greaterThan||Bt(S)?D(S):t(S)}function ue(S){return S===O.greaterThan?(e.consume(S),e.exit(A.htmlTextData),e.exit(A.htmlText),r):t(S)}function oe(S){return K(s,"expected return state"),K(Pe(S),"expected eol"),e.exit(A.htmlTextData),e.enter(A.lineEnding),e.consume(S),e.exit(A.lineEnding),he}function he(S){return K(n.parser.constructs.disable.null,"expected `disable.null` to be populated"),or(S)?Sr(e,fe,A.linePrefix,n.parser.constructs.disable.null.includes("codeIndented")?void 0:Oe.tabSize)(S):fe(S)}function fe(S){return e.enter(A.htmlTextData),s(S)}}const _N={name:"labelEnd",resolveAll:Ite,resolveTo:Pte,tokenize:Vte},Ote={tokenize:Mte},Fte={tokenize:jte},Ute={tokenize:Lte};function Ite(e){let r=-1;const t=[];for(;++r<e.length;){const n=e[r][1];if(t.push(e[r]),n.type===A.labelImage||n.type===A.labelLink||n.type===A.labelEnd){const a=n.type===A.labelImage?4:2;n.type=A.data,r+=a}}return e.length!==t.length&&la(e,0,e.length,t),e}function Pte(e,r){let t=e.length,n=0,a,i,s,o;for(;t--;)if(a=e[t][1],i){if(a.type===A.link||a.type===A.labelLink&&a._inactive)break;e[t][0]==="enter"&&a.type===A.labelLink&&(a._inactive=!0)}else if(s){if(e[t][0]==="enter"&&(a.type===A.labelImage||a.type===A.labelLink)&&!a._balanced&&(i=t,a.type!==A.labelLink)){n=2;break}}else a.type===A.labelEnd&&(s=t);K(i!==void 0,"`open` is supposed to be found"),K(s!==void 0,"`close` is supposed to be found");const u={type:e[i][1].type===A.labelLink?A.link:A.image,start:{...e[i][1].start},end:{...e[e.length-1][1].end}},l={type:A.label,start:{...e[i][1].start},end:{...e[s][1].end}},c={type:A.labelText,start:{...e[i+n+2][1].end},end:{...e[s-2][1].start}};return o=[["enter",u,r],["enter",l,r]],o=pn(o,e.slice(i+1,i+n+3)),o=pn(o,[["enter",c,r]]),K(r.parser.constructs.insideSpan.null,"expected `insideSpan.null` to be populated"),o=pn(o,wN(r.parser.constructs.insideSpan.null,e.slice(i+n+4,s-3),r)),o=pn(o,[["exit",c,r],e[s-2],e[s-1],["exit",l,r]]),o=pn(o,e.slice(s+1)),o=pn(o,[["exit",u,r]]),la(e,i,e.length,o),e}function Vte(e,r,t){const n=this;let a=n.events.length,i,s;for(;a--;)if((n.events[a][1].type===A.labelImage||n.events[a][1].type===A.labelLink)&&!n.events[a][1]._balanced){i=n.events[a][1];break}return o;function o(h){return K(h===O.rightSquareBracket,"expected `]`"),i?i._inactive?f(h):(s=n.parser.defined.includes(Ws(n.sliceSerialize({start:i.end,end:n.now()}))),e.enter(A.labelEnd),e.enter(A.labelMarker),e.consume(h),e.exit(A.labelMarker),e.exit(A.labelEnd),u):t(h)}function u(h){return h===O.leftParenthesis?e.attempt(Ote,c,s?c:f)(h):h===O.leftSquareBracket?e.attempt(Fte,c,s?l:f)(h):s?c(h):f(h)}function l(h){return e.attempt(Ute,c,f)(h)}function c(h){return r(h)}function f(h){return i._balanced=!0,t(h)}}function Mte(e,r,t){return n;function n(f){return K(f===O.leftParenthesis,"expected left paren"),e.enter(A.resource),e.enter(A.resourceMarker),e.consume(f),e.exit(A.resourceMarker),a}function a(f){return Bt(f)?ml(e,i)(f):i(f)}function i(f){return f===O.rightParenthesis?c(f):YI(e,s,o,A.resourceDestination,A.resourceDestinationLiteral,A.resourceDestinationLiteralMarker,A.resourceDestinationRaw,A.resourceDestinationString,Oe.linkResourceDestinationBalanceMax)(f)}function s(f){return Bt(f)?ml(e,u)(f):c(f)}function o(f){return t(f)}function u(f){return f===O.quotationMark||f===O.apostrophe||f===O.leftParenthesis?XI(e,l,t,A.resourceTitle,A.resourceTitleMarker,A.resourceTitleString)(f):c(f)}function l(f){return Bt(f)?ml(e,c)(f):c(f)}function c(f){return f===O.rightParenthesis?(e.enter(A.resourceMarker),e.consume(f),e.exit(A.resourceMarker),e.exit(A.resource),r):t(f)}}function jte(e,r,t){const n=this;return a;function a(o){return K(o===O.leftSquareBracket,"expected left bracket"),KI.call(n,e,i,s,A.reference,A.referenceMarker,A.referenceString)(o)}function i(o){return n.parser.defined.includes(Ws(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?r(o):t(o)}function s(o){return t(o)}}function Lte(e,r,t){return n;function n(i){return K(i===O.leftSquareBracket,"expected left bracket"),e.enter(A.reference),e.enter(A.referenceMarker),e.consume(i),e.exit(A.referenceMarker),a}function a(i){return i===O.rightSquareBracket?(e.enter(A.referenceMarker),e.consume(i),e.exit(A.referenceMarker),e.exit(A.reference),r):t(i)}}const Bte={name:"labelStartImage",resolveAll:_N.resolveAll,tokenize:qte};function qte(e,r,t){const n=this;return a;function a(o){return K(o===O.exclamationMark,"expected `!`"),e.enter(A.labelImage),e.enter(A.labelImageMarker),e.consume(o),e.exit(A.labelImageMarker),i}function i(o){return o===O.leftSquareBracket?(e.enter(A.labelMarker),e.consume(o),e.exit(A.labelMarker),e.exit(A.labelImage),s):t(o)}function s(o){return o===O.caret&&"_hiddenFootnoteSupport"in n.parser.constructs?t(o):r(o)}}const Hte={name:"labelStartLink",resolveAll:_N.resolveAll,tokenize:zte};function zte(e,r,t){const n=this;return a;function a(s){return K(s===O.leftSquareBracket,"expected `[`"),e.enter(A.labelLink),e.enter(A.labelMarker),e.consume(s),e.exit(A.labelMarker),e.exit(A.labelLink),i}function i(s){return s===O.caret&&"_hiddenFootnoteSupport"in n.parser.constructs?t(s):r(s)}}const Pp={name:"lineEnding",tokenize:$te};function $te(e,r){return t;function t(n){return K(Pe(n),"expected eol"),e.enter(A.lineEnding),e.consume(n),e.exit(A.lineEnding),Sr(e,r,A.linePrefix)}}const tc={name:"thematicBreak",tokenize:Gte};function Gte(e,r,t){let n=0,a;return i;function i(l){return e.enter(A.thematicBreak),s(l)}function s(l){return K(l===O.asterisk||l===O.dash||l===O.underscore,"expected `*`, `-`, or `_`"),a=l,o(l)}function o(l){return l===a?(e.enter(A.thematicBreakSequence),u(l)):n>=Oe.thematicBreakMarkerCountMin&&(l===O.eof||Pe(l))?(e.exit(A.thematicBreak),r(l)):t(l)}function u(l){return l===a?(e.consume(l),n++,u):(e.exit(A.thematicBreakSequence),or(l)?Sr(e,o,A.whitespace)(l):o(l))}}const Mt={continuation:{tokenize:Xte},exit:Zte,name:"list",tokenize:Kte},Wte={partial:!0,tokenize:Jte},Yte={partial:!0,tokenize:Qte};function Kte(e,r,t){const n=this,a=n.events[n.events.length-1];let i=a&&a[1].type===A.linePrefix?a[2].sliceSerialize(a[1],!0).length:0,s=0;return o;function o(d){K(n.containerState,"expected state");const v=n.containerState.type||(d===O.asterisk||d===O.plusSign||d===O.dash?A.listUnordered:A.listOrdered);if(v===A.listUnordered?!n.containerState.marker||d===n.containerState.marker:g1(d)){if(n.containerState.type||(n.containerState.type=v,e.enter(v,{_container:!0})),v===A.listUnordered)return e.enter(A.listItemPrefix),d===O.asterisk||d===O.dash?e.check(tc,t,l)(d):l(d);if(!n.interrupt||d===O.digit1)return e.enter(A.listItemPrefix),e.enter(A.listItemValue),u(d)}return t(d)}function u(d){return K(n.containerState,"expected state"),g1(d)&&++s<Oe.listItemValueSizeMax?(e.consume(d),u):(!n.interrupt||s<2)&&(n.containerState.marker?d===n.containerState.marker:d===O.rightParenthesis||d===O.dot)?(e.exit(A.listItemValue),l(d)):t(d)}function l(d){return K(n.containerState,"expected state"),K(d!==O.eof,"eof (`null`) is not a marker"),e.enter(A.listItemMarker),e.consume(d),e.exit(A.listItemMarker),n.containerState.marker=n.containerState.marker||d,e.check(Of,n.interrupt?t:c,e.attempt(Wte,h,f))}function c(d){return K(n.containerState,"expected state"),n.containerState.initialBlankLine=!0,i++,h(d)}function f(d){return or(d)?(e.enter(A.listItemPrefixWhitespace),e.consume(d),e.exit(A.listItemPrefixWhitespace),h):t(d)}function h(d){return K(n.containerState,"expected state"),n.containerState.size=i+n.sliceSerialize(e.exit(A.listItemPrefix),!0).length,r(d)}}function Xte(e,r,t){const n=this;return K(n.containerState,"expected state"),n.containerState._closeFlow=void 0,e.check(Of,a,i);function a(o){return K(n.containerState,"expected state"),K(typeof n.containerState.size=="number","expected size"),n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,Sr(e,r,A.listItemIndent,n.containerState.size+1)(o)}function i(o){return K(n.containerState,"expected state"),n.containerState.furtherBlankLines||!or(o)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,s(o)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,e.attempt(Yte,r,s)(o))}function s(o){return K(n.containerState,"expected state"),n.containerState._closeFlow=!0,n.interrupt=void 0,K(n.parser.constructs.disable.null,"expected `disable.null` to be populated"),Sr(e,e.attempt(Mt,r,t),A.linePrefix,n.parser.constructs.disable.null.includes("codeIndented")?void 0:Oe.tabSize)(o)}}function Qte(e,r,t){const n=this;return K(n.containerState,"expected state"),K(typeof n.containerState.size=="number","expected size"),Sr(e,a,A.listItemIndent,n.containerState.size+1);function a(i){K(n.containerState,"expected state");const s=n.events[n.events.length-1];return s&&s[1].type===A.listItemIndent&&s[2].sliceSerialize(s[1],!0).length===n.containerState.size?r(i):t(i)}}function Zte(e){K(this.containerState,"expected state"),K(typeof this.containerState.type=="string","expected type"),e.exit(this.containerState.type)}function Jte(e,r,t){const n=this;return K(n.parser.constructs.disable.null,"expected `disable.null` to be populated"),Sr(e,a,A.listItemPrefixWhitespace,n.parser.constructs.disable.null.includes("codeIndented")?void 0:Oe.tabSize+1);function a(i){const s=n.events[n.events.length-1];return!or(i)&&s&&s[1].type===A.listItemPrefixWhitespace?r(i):t(i)}}const kT={name:"setextUnderline",resolveTo:ene,tokenize:rne};function ene(e,r){let t=e.length,n,a,i;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type===A.content){n=t;break}e[t][1].type===A.paragraph&&(a=t)}else e[t][1].type===A.content&&e.splice(t,1),!i&&e[t][1].type===A.definition&&(i=t);K(a!==void 0,"expected a `text` index to be found"),K(n!==void 0,"expected a `text` index to be found"),K(e[n][2]===r,"enter context should be same"),K(e[e.length-1][2]===r,"enter context should be same");const s={type:A.setextHeading,start:{...e[n][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type=A.setextHeadingText,i?(e.splice(a,0,["enter",s,r]),e.splice(i+1,0,["exit",e[n][1],r]),e[n][1].end={...e[i][1].end}):e[n][1]=s,e.push(["exit",s,r]),e}function rne(e,r,t){const n=this;let a;return i;function i(l){let c=n.events.length,f;for(K(l===O.dash||l===O.equalsTo,"expected `=` or `-`");c--;)if(n.events[c][1].type!==A.lineEnding&&n.events[c][1].type!==A.linePrefix&&n.events[c][1].type!==A.content){f=n.events[c][1].type===A.paragraph;break}return!n.parser.lazy[n.now().line]&&(n.interrupt||f)?(e.enter(A.setextHeadingLine),a=l,s(l)):t(l)}function s(l){return e.enter(A.setextHeadingLineSequence),o(l)}function o(l){return l===a?(e.consume(l),o):(e.exit(A.setextHeadingLineSequence),or(l)?Sr(e,u,A.lineSuffix)(l):u(l))}function u(l){return l===O.eof||Pe(l)?(e.exit(A.setextHeadingLine),r(l)):t(l)}}const tne={tokenize:nne};function nne(e){const r=this,t=e.attempt(Of,n,e.attempt(this.parser.constructs.flowInitial,a,Sr(e,e.attempt(this.parser.constructs.flow,a,e.attempt(lte,a)),A.linePrefix)));return t;function n(i){if(K(i===O.eof||Pe(i),"expected eol or eof"),i===O.eof){e.consume(i);return}return e.enter(A.lineEndingBlank),e.consume(i),e.exit(A.lineEndingBlank),r.currentConstruct=void 0,t}function a(i){if(K(i===O.eof||Pe(i),"expected eol or eof"),i===O.eof){e.consume(i);return}return e.enter(A.lineEnding),e.consume(i),e.exit(A.lineEnding),r.currentConstruct=void 0,t}}const ane={resolveAll:ZI()},ine=QI("string"),sne=QI("text");function QI(e){return{resolveAll:ZI(e==="text"?one:void 0),tokenize:r};function r(t){const n=this,a=this.parser.constructs[e],i=t.attempt(a,s,o);return s;function s(c){return l(c)?i(c):o(c)}function o(c){if(c===O.eof){t.consume(c);return}return t.enter(A.data),t.consume(c),u}function u(c){return l(c)?(t.exit(A.data),i(c)):(t.consume(c),u)}function l(c){if(c===O.eof)return!0;const f=a[c];let h=-1;if(f)for(K(Array.isArray(f),"expected `disable.null` to be populated");++h<f.length;){const d=f[h];if(!d.previous||d.previous.call(n,n.previous))return!0}return!1}}}function ZI(e){return r;function r(t,n){let a=-1,i;for(;++a<=t.length;)i===void 0?t[a]&&t[a][1].type===A.data&&(i=a,a++):(!t[a]||t[a][1].type!==A.data)&&(a!==i+2&&(t[i][1].end=t[a-1][1].end,t.splice(i+2,a-i-2),a=i+2),i=void 0);return e?e(t,n):t}}function one(e,r){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type===A.lineEnding)&&e[t-1][1].type===A.data){const n=e[t-1][1],a=r.sliceStream(n);let i=a.length,s=-1,o=0,u;for(;i--;){const l=a[i];if(typeof l=="string"){for(s=l.length;l.charCodeAt(s-1)===O.space;)o++,s--;if(s)break;s=-1}else if(l===O.horizontalTab)u=!0,o++;else if(l!==O.virtualSpace){i++;break}}if(r._contentTypeTextTrailing&&t===e.length&&(o=0),o){const l={type:t===e.length||u||o<Oe.hardBreakPrefixSizeMin?A.lineSuffix:A.hardBreakTrailing,start:{_bufferIndex:i?s:n.start._bufferIndex+s,_index:n.start._index+i,line:n.end.line,column:n.end.column-o,offset:n.end.offset-o},end:{...n.end}};n.end={...l.start},n.start.offset===n.end.offset?Object.assign(n,l):(e.splice(t,0,["enter",l,r],["exit",l,r]),t+=2)}t++}return e}const lne={[O.asterisk]:Mt,[O.plusSign]:Mt,[O.dash]:Mt,[O.digit0]:Mt,[O.digit1]:Mt,[O.digit2]:Mt,[O.digit3]:Mt,[O.digit4]:Mt,[O.digit5]:Mt,[O.digit6]:Mt,[O.digit7]:Mt,[O.digit8]:Mt,[O.digit9]:Mt,[O.greaterThan]:HI},une={[O.leftSquareBracket]:dte},cne={[O.horizontalTab]:Ip,[O.virtualSpace]:Ip,[O.space]:Ip},fne={[O.numberSign]:bte,[O.asterisk]:tc,[O.dash]:[kT,tc],[O.lessThan]:Ete,[O.equalsTo]:kT,[O.underscore]:tc,[O.graveAccent]:DT,[O.tilde]:DT},mne={[O.ampersand]:$I,[O.backslash]:zI},dne={[O.carriageReturn]:Pp,[O.lineFeed]:Pp,[O.carriageReturnLineFeed]:Pp,[O.exclamationMark]:Bte,[O.ampersand]:$I,[O.asterisk]:b1,[O.lessThan]:[zre,kte],[O.leftSquareBracket]:Hte,[O.backslash]:[xte,zI],[O.rightSquareBracket]:_N,[O.underscore]:b1,[O.graveAccent]:nte},hne={null:[b1,ane]},pne={null:[O.asterisk,O.underscore]},vne={null:[]},xne=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:pne,contentInitial:une,disable:vne,document:lne,flow:fne,flowInitial:cne,insideSpan:hne,string:mne,text:dne},Symbol.toStringTag,{value:"Module"}));var $u={exports:{}},Vp,RT;function gne(){if(RT)return Vp;RT=1;var e=1e3,r=e*60,t=r*60,n=t*24,a=n*7,i=n*365.25;Vp=function(c,f){f=f||{};var h=typeof c;if(h==="string"&&c.length>0)return s(c);if(h==="number"&&isFinite(c))return f.long?u(c):o(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))};function s(c){if(c=String(c),!(c.length>100)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(c);if(f){var h=parseFloat(f[1]),d=(f[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return h*i;case"weeks":case"week":case"w":return h*a;case"days":case"day":case"d":return h*n;case"hours":case"hour":case"hrs":case"hr":case"h":return h*t;case"minutes":case"minute":case"mins":case"min":case"m":return h*r;case"seconds":case"second":case"secs":case"sec":case"s":return h*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}}}function o(c){var f=Math.abs(c);return f>=n?Math.round(c/n)+"d":f>=t?Math.round(c/t)+"h":f>=r?Math.round(c/r)+"m":f>=e?Math.round(c/e)+"s":c+"ms"}function u(c){var f=Math.abs(c);return f>=n?l(c,f,n,"day"):f>=t?l(c,f,t,"hour"):f>=r?l(c,f,r,"minute"):f>=e?l(c,f,e,"second"):c+" ms"}function l(c,f,h,d){var v=f>=h*1.5;return Math.round(c/h)+" "+d+(v?"s":"")}return Vp}var Mp,OT;function bne(){if(OT)return Mp;OT=1;function e(r){n.debug=n,n.default=n,n.coerce=l,n.disable=o,n.enable=i,n.enabled=u,n.humanize=gne(),n.destroy=c,Object.keys(r).forEach(f=>{n[f]=r[f]}),n.names=[],n.skips=[],n.formatters={};function t(f){let h=0;for(let d=0;d<f.length;d++)h=(h<<5)-h+f.charCodeAt(d),h|=0;return n.colors[Math.abs(h)%n.colors.length]}n.selectColor=t;function n(f){let h,d=null,v,p;function x(...g){if(!x.enabled)return;const N=x,b=Number(new Date),y=b-(h||b);N.diff=y,N.prev=h,N.curr=b,h=b,g[0]=n.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let _=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(C,k)=>{if(C==="%%")return"%";_++;const D=n.formatters[k];if(typeof D=="function"){const U=g[_];C=D.call(N,U),g.splice(_,1),_--}return C}),n.formatArgs.call(N,g),(N.log||n.log).apply(N,g)}return x.namespace=f,x.useColors=n.useColors(),x.color=n.selectColor(f),x.extend=a,x.destroy=n.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(v!==n.namespaces&&(v=n.namespaces,p=n.enabled(f)),p),set:g=>{d=g}}),typeof n.init=="function"&&n.init(x),x}function a(f,h){const d=n(this.namespace+(typeof h>"u"?":":h)+f);return d.log=this.log,d}function i(f){n.save(f),n.namespaces=f,n.names=[],n.skips=[];const h=(typeof f=="string"?f:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const d of h)d[0]==="-"?n.skips.push(d.slice(1)):n.names.push(d)}function s(f,h){let d=0,v=0,p=-1,x=0;for(;d<f.length;)if(v<h.length&&(h[v]===f[d]||h[v]==="*"))h[v]==="*"?(p=v,x=d,v++):(d++,v++);else if(p!==-1)v=p+1,x++,d=x;else return!1;for(;v<h.length&&h[v]==="*";)v++;return v===h.length}function o(){const f=[...n.names,...n.skips.map(h=>"-"+h)].join(",");return n.enable(""),f}function u(f){for(const h of n.skips)if(s(f,h))return!1;for(const h of n.names)if(s(f,h))return!0;return!1}function l(f){return f instanceof Error?f.stack||f.message:f}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}return Mp=e,Mp}var FT;function Nne(){return FT||(FT=1,(function(e,r){var t={};r.formatArgs=a,r.save=i,r.load=s,r.useColors=n,r.storage=o(),r.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;l.splice(1,0,c,"color: inherit");let f=0,h=0;l[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(f++,d==="%c"&&(h=f))}),l.splice(h,0,c)}r.log=console.debug||console.log||(()=>{});function i(l){try{l?r.storage.setItem("debug",l):r.storage.removeItem("debug")}catch{}}function s(){let l;try{l=r.storage.getItem("debug")||r.storage.getItem("DEBUG")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l=t.DEBUG),l}function o(){try{return localStorage}catch{}}e.exports=bne()(r);const{formatters:u}=e.exports;u.j=function(l){try{return JSON.stringify(l)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}})($u,$u.exports)),$u.exports}var yne=Nne();const Cne=nr(yne),Di=Cne("micromark");function Ene(e,r,t){let n={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},i=[];let s=[],o=[],u=!0;const l={attempt:D(C),check:D(k),consume:y,enter:_,exit:w,interrupt:D(k,{interrupt:!0})},c={code:O.eof,containerState:{},defineSkip:g,events:[],now:x,parser:e,previous:O.eof,sliceSerialize:v,sliceStream:p,write:d};let f=r.tokenize.call(c,l),h;return r.resolveAll&&i.push(r),c;function d(P){return s=pn(s,P),N(),s[s.length-1]!==O.eof?[]:(U(r,0),c.events=wN(i,c.events,c),c.events)}function v(P,B){return _ne(p(P),B)}function p(P){return wne(s,P)}function x(){const{_bufferIndex:P,_index:B,line:G,column:ue,offset:oe}=n;return{_bufferIndex:P,_index:B,line:G,column:ue,offset:oe}}function g(P){a[P.line]=P.column,L(),Di("position: define skip: `%j`",n)}function N(){let P;for(;n._index<s.length;){const B=s[n._index];if(typeof B=="string")for(P=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===P&&n._bufferIndex<B.length;)b(B.charCodeAt(n._bufferIndex));else b(B)}}function b(P){K(u===!0,"expected character to be consumed"),u=void 0,Di("main: passing `%s` to %s",P,f&&f.name),h=P,K(typeof f=="function","expected state"),f=f(P)}function y(P){K(P===h,"expected given code to equal expected code"),Di("consume: `%s`",P),K(u===void 0,"expected code to not have been consumed: this might be because `return x(code)` instead of `return x` was used"),K(P===null?c.events.length===0||c.events[c.events.length-1][0]==="exit":c.events[c.events.length-1][0]==="enter","expected last token to be open"),Pe(P)?(n.line++,n.column=1,n.offset+=P===O.carriageReturnLineFeed?2:1,L(),Di("position: after eol: `%j`",n)):P!==O.virtualSpace&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===s[n._index].length&&(n._bufferIndex=-1,n._index++)),c.previous=P,u=!0}function _(P,B){const G=B||{};return G.type=P,G.start=x(),K(typeof P=="string","expected string type"),K(P.length>0,"expected non-empty string"),Di("enter: `%s`",P),c.events.push(["enter",G,c]),o.push(G),G}function w(P){K(typeof P=="string","expected string type"),K(P.length>0,"expected non-empty string");const B=o.pop();return K(B,"cannot close w/o open tokens"),B.end=x(),K(P===B.type,"expected exit token to match current token"),K(!(B.start._index===B.end._index&&B.start._bufferIndex===B.end._bufferIndex),"expected non-empty token (`"+P+"`)"),Di("exit: `%s`",B.type),c.events.push(["exit",B,c]),B}function C(P,B){U(P,B.from)}function k(P,B){B.restore()}function D(P,B){return G;function G(ue,oe,he){let fe,S,re,T;return Array.isArray(ue)?V(ue):"tokenize"in ue?V([ue]):E(ue);function E(le){return X;function X(Q){const be=Q!==null&&le[Q],ee=Q!==null&&le.null,Ie=[...Array.isArray(be)?be:be?[be]:[],...Array.isArray(ee)?ee:ee?[ee]:[]];return V(Ie)(Q)}}function V(le){return fe=le,S=0,le.length===0?(K(he,"expected `bogusState` to be given"),he):I(le[S])}function I(le){return X;function X(Q){return T=F(),re=le,le.partial||(c.currentConstruct=le),K(c.parser.constructs.disable.null,"expected `disable.null` to be populated"),le.name&&c.parser.constructs.disable.null.includes(le.name)?ie(Q):le.tokenize.call(B?Object.assign(Object.create(c),B):c,l,Y,ie)(Q)}}function Y(le){return K(le===h,"expected code"),u=!0,P(re,T),oe}function ie(le){return K(le===h,"expected code"),u=!0,T.restore(),++S<fe.length?I(fe[S]):he}}}function U(P,B){P.resolveAll&&!i.includes(P)&&i.push(P),P.resolve&&la(c.events,B,c.events.length-B,P.resolve(c.events.slice(B),c)),P.resolveTo&&(c.events=P.resolveTo(c.events,c)),K(P.partial||c.events.length===0||c.events[c.events.length-1][0]==="exit","expected last token to end")}function F(){const P=x(),B=c.previous,G=c.currentConstruct,ue=c.events.length,oe=Array.from(o);return{from:ue,restore:he};function he(){n=P,c.previous=B,c.currentConstruct=G,c.events.length=ue,o=oe,L(),Di("position: restore: `%j`",n)}}function L(){n.line in a&&n.column<2&&(n.column=a[n.line],n.offset+=a[n.line]-1)}}function wne(e,r){const t=r.start._index,n=r.start._bufferIndex,a=r.end._index,i=r.end._bufferIndex;let s;if(t===a)K(i>-1,"expected non-negative end buffer index"),K(n>-1,"expected non-negative start buffer index"),s=[e[t].slice(n,i)];else{if(s=e.slice(t,a),n>-1){const o=s[0];typeof o=="string"?s[0]=o.slice(n):(K(n===0,"expected `startBufferIndex` to be `0`"),s.shift())}i>0&&s.push(e[a].slice(0,i))}return s}function _ne(e,r){let t=-1;const n=[];let a;for(;++t<e.length;){const i=e[t];let s;if(typeof i=="string")s=i;else switch(i){case O.carriageReturn:{s=Kn.cr;break}case O.lineFeed:{s=Kn.lf;break}case O.carriageReturnLineFeed:{s=Kn.cr+Kn.lf;break}case O.horizontalTab:{s=r?Kn.space:Kn.ht;break}case O.virtualSpace:{if(!r&&a)continue;s=Kn.space;break}default:K(typeof i=="number","expected number"),s=String.fromCharCode(i)}a=i===O.horizontalTab,n.push(s)}return n.join("")}function Sne(e){const n={constructs:Are([xne,...(e||{}).extensions||[]]),content:a(Vre),defined:[],document:a(jre),flow:a(tne),lazy:{},string:a(ine),text:a(sne)};return n;function a(i){return s;function s(o){return Ene(n,i,o)}}}function Tne(e){for(;!WI(e););return e}const UT=/[\0\t\n\r]/g;function Dne(){let e=1,r="",t=!0,n;return a;function a(i,s,o){const u=[];let l,c,f,h,d;for(i=r+(typeof i=="string"?i.toString():new TextDecoder(s||void 0).decode(i)),f=0,r="",t&&(i.charCodeAt(0)===O.byteOrderMarker&&f++,t=void 0);f<i.length;){if(UT.lastIndex=f,l=UT.exec(i),h=l&&l.index!==void 0?l.index:i.length,d=i.charCodeAt(h),!l){r=i.slice(f);break}if(d===O.lf&&f===h&&n)u.push(O.carriageReturnLineFeed),n=void 0;else switch(n&&(u.push(O.carriageReturn),n=void 0),f<h&&(u.push(i.slice(f,h)),e+=h-f),d){case O.nul:{u.push(O.replacementCharacter),e++;break}case O.ht:{for(c=Math.ceil(e/Oe.tabSize)*Oe.tabSize,u.push(O.horizontalTab);e++<c;)u.push(O.virtualSpace);break}case O.lf:{u.push(O.lineFeed),e=1;break}default:n=!0,e=1}f=h+1}return o&&(n&&u.push(O.carriageReturn),r&&u.push(r),u.push(O.eof)),u}}const Ane=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function kne(e){return e.replace(Ane,Rne)}function Rne(e,r,t){if(r)return r;if(t.charCodeAt(0)===O.numberSign){const a=t.charCodeAt(1),i=a===O.lowercaseX||a===O.uppercaseX;return qI(t.slice(i?2:1),i?Oe.numericBaseHexadecimal:Oe.numericBaseDecimal)}return EN(t)||e}const JI={}.hasOwnProperty;function One(e,r,t){return typeof r!="string"&&(t=r,r=void 0),Fne(t)(Tne(Sne(t).document().write(Dne()(e,r,!0))))}function Fne(e){const r={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(Wr),autolinkProtocol:D,autolinkEmail:D,atxHeading:i(Ye),blockQuote:i(Q),characterEscape:D,characterReference:D,codeFenced:i(be),codeFencedFenceInfo:s,codeFencedFenceMeta:s,codeIndented:i(be,s),codeText:i(ee,s),codeTextData:D,data:D,codeFlowValue:D,definition:i(Ie),definitionDestinationString:s,definitionLabelString:s,definitionTitleString:s,emphasis:i(Te),hardBreakEscape:i(Be),hardBreakTrailing:i(Be),htmlFlow:i(Ee,s),htmlFlowData:D,htmlText:i(Ee,s),htmlTextData:D,image:i(xr),label:s,link:i(Wr),listItem:i(Nr),listItemValue:h,listOrdered:i($r,f),listUnordered:i($r),paragraph:i(Tr),reference:E,referenceString:s,resourceDestinationString:s,resourceTitleString:s,setextHeading:i(Ye),strong:i(Yr),thematicBreak:i(je)},exit:{atxHeading:u(),atxHeadingSequence:_,autolink:u(),autolinkEmail:X,autolinkProtocol:le,blockQuote:u(),characterEscapeValue:U,characterReferenceMarkerHexadecimal:I,characterReferenceMarkerNumeric:I,characterReferenceValue:Y,characterReference:ie,codeFenced:u(x),codeFencedFence:p,codeFencedFenceInfo:d,codeFencedFenceMeta:v,codeFlowValue:U,codeIndented:u(g),codeText:u(G),codeTextData:U,data:U,definition:u(),definitionDestinationString:y,definitionLabelString:N,definitionTitleString:b,emphasis:u(),hardBreakEscape:u(L),hardBreakTrailing:u(L),htmlFlow:u(P),htmlFlowData:U,htmlText:u(B),htmlTextData:U,image:u(oe),label:fe,labelText:he,lineEnding:F,link:u(ue),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:V,resourceDestinationString:S,resourceTitleString:re,resource:T,setextHeading:u(k),setextHeadingLineSequence:C,setextHeadingText:w,strong:u(),thematicBreak:u()}};eP(r,(e||{}).mdastExtensions||[]);const t={};return n;function n(Z){let J={type:"root",children:[]};const xe={stack:[J],tokenStack:[],config:r,enter:o,exit:l,buffer:s,resume:c,data:t},Le=[];let pe=-1;for(;++pe<Z.length;)if(Z[pe][1].type===A.listOrdered||Z[pe][1].type===A.listUnordered)if(Z[pe][0]==="enter")Le.push(pe);else{const ke=Le.pop();K(typeof ke=="number","expected list ot be open"),pe=a(Z,ke,pe)}for(pe=-1;++pe<Z.length;){const ke=r[Z[pe][0]];JI.call(ke,Z[pe][1].type)&&ke[Z[pe][1].type].call(Object.assign({sliceSerialize:Z[pe][2].sliceSerialize},xe),Z[pe][1])}if(xe.tokenStack.length>0){const ke=xe.tokenStack[xe.tokenStack.length-1];(ke[1]||IT).call(xe,void 0,ke[0])}for(J.position={start:Ya(Z.length>0?Z[0][1].start:{line:1,column:1,offset:0}),end:Ya(Z.length>0?Z[Z.length-2][1].end:{line:1,column:1,offset:0})},pe=-1;++pe<r.transforms.length;)J=r.transforms[pe](J)||J;return J}function a(Z,J,xe){let Le=J-1,pe=-1,ke=!1,Ve,Ke,ar,Er;for(;++Le<=xe;){const rr=Z[Le];switch(rr[1].type){case A.listUnordered:case A.listOrdered:case A.blockQuote:{rr[0]==="enter"?pe++:pe--,Er=void 0;break}case A.lineEndingBlank:{rr[0]==="enter"&&(Ve&&!Er&&!pe&&!ar&&(ar=Le),Er=void 0);break}case A.linePrefix:case A.listItemValue:case A.listItemMarker:case A.listItemPrefix:case A.listItemPrefixWhitespace:break;default:Er=void 0}if(!pe&&rr[0]==="enter"&&rr[1].type===A.listItemPrefix||pe===-1&&rr[0]==="exit"&&(rr[1].type===A.listUnordered||rr[1].type===A.listOrdered)){if(Ve){let nt=Le;for(Ke=void 0;nt--;){const ur=Z[nt];if(ur[1].type===A.lineEnding||ur[1].type===A.lineEndingBlank){if(ur[0]==="exit")continue;Ke&&(Z[Ke][1].type=A.lineEndingBlank,ke=!0),ur[1].type=A.lineEnding,Ke=nt}else if(!(ur[1].type===A.linePrefix||ur[1].type===A.blockQuotePrefix||ur[1].type===A.blockQuotePrefixWhitespace||ur[1].type===A.blockQuoteMarker||ur[1].type===A.listItemIndent))break}ar&&(!Ke||ar<Ke)&&(Ve._spread=!0),Ve.end=Object.assign({},Ke?Z[Ke][1].start:rr[1].end),Z.splice(Ke||Le,0,["exit",Ve,rr[2]]),Le++,xe++}if(rr[1].type===A.listItemPrefix){const nt={type:"listItem",_spread:!1,start:Object.assign({},rr[1].start),end:void 0};Ve=nt,Z.splice(Le,0,["enter",nt,rr[2]]),Le++,xe++,ar=void 0,Er=!0}}}return Z[J][1]._spread=ke,xe}function i(Z,J){return xe;function xe(Le){o.call(this,Z(Le),Le),J&&J.call(this,Le)}}function s(){this.stack.push({type:"fragment",children:[]})}function o(Z,J,xe){const Le=this.stack[this.stack.length-1];K(Le,"expected `parent`"),K("children"in Le,"expected `parent`"),Le.children.push(Z),this.stack.push(Z),this.tokenStack.push([J,xe||void 0]),Z.position={start:Ya(J.start),end:void 0}}function u(Z){return J;function J(xe){Z&&Z.call(this,xe),l.call(this,xe)}}function l(Z,J){const xe=this.stack.pop();K(xe,"expected `node`");const Le=this.tokenStack.pop();if(Le)Le[0].type!==Z.type&&(J?J.call(this,Z,Le[0]):(Le[1]||IT).call(this,Z,Le[0]));else throw new Error("Cannot close `"+Z.type+"` ("+fl({start:Z.start,end:Z.end})+"): itâ€™s not open");K(xe.type!=="fragment","unexpected fragment `exit`ed"),K(xe.position,"expected `position` to be defined"),xe.position.end=Ya(Z.end)}function c(){return Tre(this.stack.pop())}function f(){this.data.expectingFirstListItemValue=!0}function h(Z){if(this.data.expectingFirstListItemValue){const J=this.stack[this.stack.length-2];K(J,"expected nodes on stack"),K(J.type==="list","expected list on stack"),J.start=Number.parseInt(this.sliceSerialize(Z),Oe.numericBaseDecimal),this.data.expectingFirstListItemValue=void 0}}function d(){const Z=this.resume(),J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="code","expected code on stack"),J.lang=Z}function v(){const Z=this.resume(),J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="code","expected code on stack"),J.meta=Z}function p(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function x(){const Z=this.resume(),J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="code","expected code on stack"),J.value=Z.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function g(){const Z=this.resume(),J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="code","expected code on stack"),J.value=Z.replace(/(\r?\n|\r)$/g,"")}function N(Z){const J=this.resume(),xe=this.stack[this.stack.length-1];K(xe,"expected node on stack"),K(xe.type==="definition","expected definition on stack"),xe.label=J,xe.identifier=Ws(this.sliceSerialize(Z)).toLowerCase()}function b(){const Z=this.resume(),J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="definition","expected definition on stack"),J.title=Z}function y(){const Z=this.resume(),J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="definition","expected definition on stack"),J.url=Z}function _(Z){const J=this.stack[this.stack.length-1];if(K(J,"expected node on stack"),K(J.type==="heading","expected heading on stack"),!J.depth){const xe=this.sliceSerialize(Z).length;K(xe===1||xe===2||xe===3||xe===4||xe===5||xe===6,"expected `depth` between `1` and `6`"),J.depth=xe}}function w(){this.data.setextHeadingSlurpLineEnding=!0}function C(Z){const J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="heading","expected heading on stack"),J.depth=this.sliceSerialize(Z).codePointAt(0)===O.equalsTo?1:2}function k(){this.data.setextHeadingSlurpLineEnding=void 0}function D(Z){const J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K("children"in J,"expected parent on stack");const xe=J.children;let Le=xe[xe.length-1];(!Le||Le.type!=="text")&&(Le=Ne(),Le.position={start:Ya(Z.start),end:void 0},xe.push(Le)),this.stack.push(Le)}function U(Z){const J=this.stack.pop();K(J,"expected a `node` to be on the stack"),K("value"in J,"expected a `literal` to be on the stack"),K(J.position,"expected `node` to have an open position"),J.value+=this.sliceSerialize(Z),J.position.end=Ya(Z.end)}function F(Z){const J=this.stack[this.stack.length-1];if(K(J,"expected `node`"),this.data.atHardBreak){K("children"in J,"expected `parent`");const xe=J.children[J.children.length-1];K(xe.position,"expected tail to have a starting position"),xe.position.end=Ya(Z.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&r.canContainEols.includes(J.type)&&(D.call(this,Z),U.call(this,Z))}function L(){this.data.atHardBreak=!0}function P(){const Z=this.resume(),J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="html","expected html on stack"),J.value=Z}function B(){const Z=this.resume(),J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="html","expected html on stack"),J.value=Z}function G(){const Z=this.resume(),J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="inlineCode","expected inline code on stack"),J.value=Z}function ue(){const Z=this.stack[this.stack.length-1];if(K(Z,"expected node on stack"),K(Z.type==="link","expected link on stack"),this.data.inReference){const J=this.data.referenceType||"shortcut";Z.type+="Reference",Z.referenceType=J,delete Z.url,delete Z.title}else delete Z.identifier,delete Z.label;this.data.referenceType=void 0}function oe(){const Z=this.stack[this.stack.length-1];if(K(Z,"expected node on stack"),K(Z.type==="image","expected image on stack"),this.data.inReference){const J=this.data.referenceType||"shortcut";Z.type+="Reference",Z.referenceType=J,delete Z.url,delete Z.title}else delete Z.identifier,delete Z.label;this.data.referenceType=void 0}function he(Z){const J=this.sliceSerialize(Z),xe=this.stack[this.stack.length-2];K(xe,"expected ancestor on stack"),K(xe.type==="image"||xe.type==="link","expected image or link on stack"),xe.label=kne(J),xe.identifier=Ws(J).toLowerCase()}function fe(){const Z=this.stack[this.stack.length-1];K(Z,"expected node on stack"),K(Z.type==="fragment","expected fragment on stack");const J=this.resume(),xe=this.stack[this.stack.length-1];if(K(xe,"expected node on stack"),K(xe.type==="image"||xe.type==="link","expected image or link on stack"),this.data.inReference=!0,xe.type==="link"){const Le=Z.children;xe.children=Le}else xe.alt=J}function S(){const Z=this.resume(),J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="image"||J.type==="link","expected image or link on stack"),J.url=Z}function re(){const Z=this.resume(),J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="image"||J.type==="link","expected image or link on stack"),J.title=Z}function T(){this.data.inReference=void 0}function E(){this.data.referenceType="collapsed"}function V(Z){const J=this.resume(),xe=this.stack[this.stack.length-1];K(xe,"expected node on stack"),K(xe.type==="image"||xe.type==="link","expected image reference or link reference on stack"),xe.label=J,xe.identifier=Ws(this.sliceSerialize(Z)).toLowerCase(),this.data.referenceType="full"}function I(Z){K(Z.type==="characterReferenceMarkerNumeric"||Z.type==="characterReferenceMarkerHexadecimal"),this.data.characterReferenceType=Z.type}function Y(Z){const J=this.sliceSerialize(Z),xe=this.data.characterReferenceType;let Le;if(xe)Le=qI(J,xe===A.characterReferenceMarkerNumeric?Oe.numericBaseDecimal:Oe.numericBaseHexadecimal),this.data.characterReferenceType=void 0;else{const ke=EN(J);K(ke!==!1,"expected reference to decode"),Le=ke}const pe=this.stack[this.stack.length-1];K(pe,"expected `node`"),K("value"in pe,"expected `node.value`"),pe.value+=Le}function ie(Z){const J=this.stack.pop();K(J,"expected `node`"),K(J.position,"expected `node.position`"),J.position.end=Ya(Z.end)}function le(Z){U.call(this,Z);const J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="link","expected link on stack"),J.url=this.sliceSerialize(Z)}function X(Z){U.call(this,Z);const J=this.stack[this.stack.length-1];K(J,"expected node on stack"),K(J.type==="link","expected link on stack"),J.url="mailto:"+this.sliceSerialize(Z)}function Q(){return{type:"blockquote",children:[]}}function be(){return{type:"code",lang:null,meta:null,value:""}}function ee(){return{type:"inlineCode",value:""}}function Ie(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Te(){return{type:"emphasis",children:[]}}function Ye(){return{type:"heading",depth:0,children:[]}}function Be(){return{type:"break"}}function Ee(){return{type:"html",value:""}}function xr(){return{type:"image",title:null,url:"",alt:null}}function Wr(){return{type:"link",title:null,url:"",children:[]}}function $r(Z){return{type:"list",ordered:Z.type==="listOrdered",start:null,spread:Z._spread,children:[]}}function Nr(Z){return{type:"listItem",spread:Z._spread,checked:null,children:[]}}function Tr(){return{type:"paragraph",children:[]}}function Yr(){return{type:"strong",children:[]}}function Ne(){return{type:"text",value:""}}function je(){return{type:"thematicBreak"}}}function Ya(e){return{line:e.line,column:e.column,offset:e.offset}}function eP(e,r){let t=-1;for(;++t<r.length;){const n=r[t];Array.isArray(n)?eP(e,n):Une(e,n)}}function Une(e,r){let t;for(t in r)if(JI.call(r,t))switch(t){case"canContainEols":{const n=r[t];n&&e[t].push(...n);break}case"transforms":{const n=r[t];n&&e[t].push(...n);break}case"enter":case"exit":{const n=r[t];n&&Object.assign(e[t],n);break}}}function IT(e,r){throw e?new Error("Cannot close `"+e.type+"` ("+fl({start:e.start,end:e.end})+"): a different token (`"+r.type+"`, "+fl({start:r.start,end:r.end})+") is open"):new Error("Cannot close document, a token (`"+r.type+"`, "+fl({start:r.start,end:r.end})+") is still open")}function wue(e){const r=this;r.parser=t;function t(n){return One(n,{...r.data("settings"),...e,extensions:r.data("micromarkExtensions")||[],mdastExtensions:r.data("fromMarkdownExtensions")||[]})}}function Ine(e,r){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(r),!0)};return e.patch(r,t),e.applyData(r,t)}function Pne(e,r){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(r,t),[e.applyData(r,t),{type:"text",value:`
`}]}function Vne(e,r){const t=r.value?r.value+`
`:"",n={};r.lang&&(n.className=["language-"+r.lang]);let a={type:"element",tagName:"code",properties:n,children:[{type:"text",value:t}]};return r.meta&&(a.data={meta:r.meta}),e.patch(r,a),a=e.applyData(r,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(r,a),a}function Mne(e,r){const t={type:"element",tagName:"del",properties:{},children:e.all(r)};return e.patch(r,t),e.applyData(r,t)}function jne(e,r){const t={type:"element",tagName:"em",properties:{},children:e.all(r)};return e.patch(r,t),e.applyData(r,t)}function Lne(e,r){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=String(r.identifier).toUpperCase(),a=wo(n.toLowerCase()),i=e.footnoteOrder.indexOf(n);let s,o=e.footnoteCounts.get(n);o===void 0?(o=0,e.footnoteOrder.push(n),s=e.footnoteOrder.length):s=i+1,o+=1,e.footnoteCounts.set(n,o);const u={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(s)}]};e.patch(r,u);const l={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(r,l),e.applyData(r,l)}function Bne(e,r){const t={type:"element",tagName:"h"+r.depth,properties:{},children:e.all(r)};return e.patch(r,t),e.applyData(r,t)}function qne(e,r){if(e.options.allowDangerousHtml){const t={type:"raw",value:r.value};return e.patch(r,t),e.applyData(r,t)}}function rP(e,r){const t=r.referenceType;let n="]";if(t==="collapsed"?n+="[]":t==="full"&&(n+="["+(r.label||r.identifier)+"]"),r.type==="imageReference")return[{type:"text",value:"!["+r.alt+n}];const a=e.all(r),i=a[0];i&&i.type==="text"?i.value="["+i.value:a.unshift({type:"text",value:"["});const s=a[a.length-1];return s&&s.type==="text"?s.value+=n:a.push({type:"text",value:n}),a}function Hne(e,r){const t=String(r.identifier).toUpperCase(),n=e.definitionById.get(t);if(!n)return rP(e,r);const a={src:wo(n.url||""),alt:r.alt};n.title!==null&&n.title!==void 0&&(a.title=n.title);const i={type:"element",tagName:"img",properties:a,children:[]};return e.patch(r,i),e.applyData(r,i)}function zne(e,r){const t={src:wo(r.url)};r.alt!==null&&r.alt!==void 0&&(t.alt=r.alt),r.title!==null&&r.title!==void 0&&(t.title=r.title);const n={type:"element",tagName:"img",properties:t,children:[]};return e.patch(r,n),e.applyData(r,n)}function $ne(e,r){const t={type:"text",value:r.value.replace(/\r?\n|\r/g," ")};e.patch(r,t);const n={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(r,n),e.applyData(r,n)}function Gne(e,r){const t=String(r.identifier).toUpperCase(),n=e.definitionById.get(t);if(!n)return rP(e,r);const a={href:wo(n.url||"")};n.title!==null&&n.title!==void 0&&(a.title=n.title);const i={type:"element",tagName:"a",properties:a,children:e.all(r)};return e.patch(r,i),e.applyData(r,i)}function Wne(e,r){const t={href:wo(r.url)};r.title!==null&&r.title!==void 0&&(t.title=r.title);const n={type:"element",tagName:"a",properties:t,children:e.all(r)};return e.patch(r,n),e.applyData(r,n)}function Yne(e,r,t){const n=e.all(r),a=t?Kne(t):tP(r),i={},s=[];if(typeof r.checked=="boolean"){const c=n[0];let f;c&&c.type==="element"&&c.tagName==="p"?f=c:(f={type:"element",tagName:"p",properties:{},children:[]},n.unshift(f)),f.children.length>0&&f.children.unshift({type:"text",value:" "}),f.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:r.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let o=-1;for(;++o<n.length;){const c=n[o];(a||o!==0||c.type!=="element"||c.tagName!=="p")&&s.push({type:"text",value:`
`}),c.type==="element"&&c.tagName==="p"&&!a?s.push(...c.children):s.push(c)}const u=n[n.length-1];u&&(a||u.type!=="element"||u.tagName!=="p")&&s.push({type:"text",value:`
`});const l={type:"element",tagName:"li",properties:i,children:s};return e.patch(r,l),e.applyData(r,l)}function Kne(e){let r=!1;if(e.type==="list"){r=e.spread||!1;const t=e.children;let n=-1;for(;!r&&++n<t.length;)r=tP(t[n])}return r}function tP(e){const r=e.spread;return r??e.children.length>1}function Xne(e,r){const t={},n=e.all(r);let a=-1;for(typeof r.start=="number"&&r.start!==1&&(t.start=r.start);++a<n.length;){const s=n[a];if(s.type==="element"&&s.tagName==="li"&&s.properties&&Array.isArray(s.properties.className)&&s.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const i={type:"element",tagName:r.ordered?"ol":"ul",properties:t,children:e.wrap(n,!0)};return e.patch(r,i),e.applyData(r,i)}function Qne(e,r){const t={type:"element",tagName:"p",properties:{},children:e.all(r)};return e.patch(r,t),e.applyData(r,t)}function Zne(e,r){const t={type:"root",children:e.wrap(e.all(r))};return e.patch(r,t),e.applyData(r,t)}function Jne(e,r){const t={type:"element",tagName:"strong",properties:{},children:e.all(r)};return e.patch(r,t),e.applyData(r,t)}function eae(e,r){const t=e.all(r),n=t.shift(),a=[];if(n){const s={type:"element",tagName:"thead",properties:{},children:e.wrap([n],!0)};e.patch(r.children[0],s),a.push(s)}if(t.length>0){const s={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},o=bN(r.children[1]),u=II(r.children[r.children.length-1]);o&&u&&(s.position={start:o,end:u}),a.push(s)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(r,i),e.applyData(r,i)}function rae(e,r,t){const n=t?t.children:void 0,i=(n?n.indexOf(r):1)===0?"th":"td",s=t&&t.type==="table"?t.align:void 0,o=s?s.length:r.children.length;let u=-1;const l=[];for(;++u<o;){const f=r.children[u],h={},d=s?s[u]:void 0;d&&(h.align=d);let v={type:"element",tagName:i,properties:h,children:[]};f&&(v.children=e.all(f),e.patch(f,v),v=e.applyData(f,v)),l.push(v)}const c={type:"element",tagName:"tr",properties:{},children:e.wrap(l,!0)};return e.patch(r,c),e.applyData(r,c)}function tae(e,r){const t={type:"element",tagName:"td",properties:{},children:e.all(r)};return e.patch(r,t),e.applyData(r,t)}const PT=9,VT=32;function nae(e){const r=String(e),t=/\r?\n|\r/g;let n=t.exec(r),a=0;const i=[];for(;n;)i.push(MT(r.slice(a,n.index),a>0,!0),n[0]),a=n.index+n[0].length,n=t.exec(r);return i.push(MT(r.slice(a),a>0,!1)),i.join("")}function MT(e,r,t){let n=0,a=e.length;if(r){let i=e.codePointAt(n);for(;i===PT||i===VT;)n++,i=e.codePointAt(n)}if(t){let i=e.codePointAt(a-1);for(;i===PT||i===VT;)a--,i=e.codePointAt(a-1)}return a>n?e.slice(n,a):""}function aae(e,r){const t={type:"text",value:nae(String(r.value))};return e.patch(r,t),e.applyData(r,t)}function iae(e,r){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(r,t),e.applyData(r,t)}const sae={blockquote:Ine,break:Pne,code:Vne,delete:Mne,emphasis:jne,footnoteReference:Lne,heading:Bne,html:qne,imageReference:Hne,image:zne,inlineCode:$ne,linkReference:Gne,link:Wne,listItem:Yne,list:Xne,paragraph:Qne,root:Zne,strong:Jne,table:eae,tableCell:tae,tableRow:rae,text:aae,thematicBreak:iae,toml:Gu,yaml:Gu,definition:Gu,footnoteDefinition:Gu};function Gu(){}const nP=-1,Ff=0,dl=1,Wc=2,SN=3,TN=4,DN=5,AN=6,aP=7,iP=8,jT=typeof self=="object"?self:globalThis,oae=(e,r)=>{const t=(a,i)=>(e.set(i,a),a),n=a=>{if(e.has(a))return e.get(a);const[i,s]=r[a];switch(i){case Ff:case nP:return t(s,a);case dl:{const o=t([],a);for(const u of s)o.push(n(u));return o}case Wc:{const o=t({},a);for(const[u,l]of s)o[n(u)]=n(l);return o}case SN:return t(new Date(s),a);case TN:{const{source:o,flags:u}=s;return t(new RegExp(o,u),a)}case DN:{const o=t(new Map,a);for(const[u,l]of s)o.set(n(u),n(l));return o}case AN:{const o=t(new Set,a);for(const u of s)o.add(n(u));return o}case aP:{const{name:o,message:u}=s;return t(new jT[o](u),a)}case iP:return t(BigInt(s),a);case"BigInt":return t(Object(BigInt(s)),a);case"ArrayBuffer":return t(new Uint8Array(s).buffer,s);case"DataView":{const{buffer:o}=new Uint8Array(s);return t(new DataView(o),s)}}return t(new jT[i](s),a)};return n},LT=e=>oae(new Map,e)(0),ks="",{toString:lae}={},{keys:uae}=Object,$o=e=>{const r=typeof e;if(r!=="object"||!e)return[Ff,r];const t=lae.call(e).slice(8,-1);switch(t){case"Array":return[dl,ks];case"Object":return[Wc,ks];case"Date":return[SN,ks];case"RegExp":return[TN,ks];case"Map":return[DN,ks];case"Set":return[AN,ks];case"DataView":return[dl,t]}return t.includes("Array")?[dl,t]:t.includes("Error")?[aP,t]:[Wc,t]},Wu=([e,r])=>e===Ff&&(r==="function"||r==="symbol"),cae=(e,r,t,n)=>{const a=(s,o)=>{const u=n.push(s)-1;return t.set(o,u),u},i=s=>{if(t.has(s))return t.get(s);let[o,u]=$o(s);switch(o){case Ff:{let c=s;switch(u){case"bigint":o=iP,c=s.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);c=null;break;case"undefined":return a([nP],s)}return a([o,c],s)}case dl:{if(u){let h=s;return u==="DataView"?h=new Uint8Array(s.buffer):u==="ArrayBuffer"&&(h=new Uint8Array(s)),a([u,[...h]],s)}const c=[],f=a([o,c],s);for(const h of s)c.push(i(h));return f}case Wc:{if(u)switch(u){case"BigInt":return a([u,s.toString()],s);case"Boolean":case"Number":case"String":return a([u,s.valueOf()],s)}if(r&&"toJSON"in s)return i(s.toJSON());const c=[],f=a([o,c],s);for(const h of uae(s))(e||!Wu($o(s[h])))&&c.push([i(h),i(s[h])]);return f}case SN:return a([o,s.toISOString()],s);case TN:{const{source:c,flags:f}=s;return a([o,{source:c,flags:f}],s)}case DN:{const c=[],f=a([o,c],s);for(const[h,d]of s)(e||!(Wu($o(h))||Wu($o(d))))&&c.push([i(h),i(d)]);return f}case AN:{const c=[],f=a([o,c],s);for(const h of s)(e||!Wu($o(h)))&&c.push(i(h));return f}}const{message:l}=s;return a([o,{name:u,message:l}],s)};return i},BT=(e,{json:r,lossy:t}={})=>{const n=[];return cae(!(r||t),!!r,new Map,n)(e),n},Yc=typeof structuredClone=="function"?(e,r)=>r&&("json"in r||"lossy"in r)?LT(BT(e,r)):structuredClone(e):(e,r)=>LT(BT(e,r));function fae(e,r){const t=[{type:"text",value:"â†©"}];return r>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(r)}]}),t}function mae(e,r){return"Back to reference "+(e+1)+(r>1?"-"+r:"")}function dae(e){const r=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||fae,n=e.options.footnoteBackLabel||mae,a=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",s=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let u=-1;for(;++u<e.footnoteOrder.length;){const l=e.footnoteById.get(e.footnoteOrder[u]);if(!l)continue;const c=e.all(l),f=String(l.identifier).toUpperCase(),h=wo(f.toLowerCase());let d=0;const v=[],p=e.footnoteCounts.get(f);for(;p!==void 0&&++d<=p;){v.length>0&&v.push({type:"text",value:" "});let N=typeof t=="string"?t:t(u,d);typeof N=="string"&&(N={type:"text",value:N}),v.push({type:"element",tagName:"a",properties:{href:"#"+r+"fnref-"+h+(d>1?"-"+d:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(u,d),className:["data-footnote-backref"]},children:Array.isArray(N)?N:[N]})}const x=c[c.length-1];if(x&&x.type==="element"&&x.tagName==="p"){const N=x.children[x.children.length-1];N&&N.type==="text"?N.value+=" ":x.children.push({type:"text",value:" "}),x.children.push(...v)}else c.push(...v);const g={type:"element",tagName:"li",properties:{id:r+"fn-"+h},children:e.wrap(c,!0)};e.patch(l,g),o.push(g)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...Yc(s),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const sP=(function(e){if(e==null)return xae;if(typeof e=="function")return Uf(e);if(typeof e=="object")return Array.isArray(e)?hae(e):pae(e);if(typeof e=="string")return vae(e);throw new Error("Expected function, string, or object as test")});function hae(e){const r=[];let t=-1;for(;++t<e.length;)r[t]=sP(e[t]);return Uf(n);function n(...a){let i=-1;for(;++i<r.length;)if(r[i].apply(this,a))return!0;return!1}}function pae(e){const r=e;return Uf(t);function t(n){const a=n;let i;for(i in e)if(a[i]!==r[i])return!1;return!0}}function vae(e){return Uf(r);function r(t){return t&&t.type===e}}function Uf(e){return r;function r(t,n,a){return!!(gae(t)&&e.call(this,t,typeof n=="number"?n:void 0,a||void 0))}}function xae(){return!0}function gae(e){return e!==null&&typeof e=="object"&&"type"in e}const oP=[],bae=!0,qT=!1,Nae="skip";function yae(e,r,t,n){let a;typeof r=="function"&&typeof t!="function"?(n=t,t=r):a=r;const i=sP(a),s=n?-1:1;o(e,void 0,[])();function o(u,l,c){const f=u&&typeof u=="object"?u:{};if(typeof f.type=="string"){const d=typeof f.tagName=="string"?f.tagName:typeof f.name=="string"?f.name:void 0;Object.defineProperty(h,"name",{value:"node ("+(u.type+(d?"<"+d+">":""))+")"})}return h;function h(){let d=oP,v,p,x;if((!r||i(u,l,c[c.length-1]||void 0))&&(d=Cae(t(u,c)),d[0]===qT))return d;if("children"in u&&u.children){const g=u;if(g.children&&d[0]!==Nae)for(p=(n?g.children.length:-1)+s,x=c.concat(g);p>-1&&p<g.children.length;){const N=g.children[p];if(v=o(N,p,x)(),v[0]===qT)return v;p=typeof v[1]=="number"?v[1]:p+s}}return d}}}function Cae(e){return Array.isArray(e)?e:typeof e=="number"?[bae,e]:e==null?oP:[e]}function Eae(e,r,t,n){let a,i,s;typeof r=="function"&&typeof t!="function"?(i=void 0,s=r,a=t):(i=r,s=t,a=n),yae(e,i,o,a);function o(u,l){const c=l[l.length-1],f=c?c.children.indexOf(u):void 0;return s(u,f,c)}}const N1={}.hasOwnProperty,wae={};function _ae(e,r){const t=r||wae,n=new Map,a=new Map,i=new Map,s={...sae,...t.handlers},o={all:l,applyData:Tae,definitionById:n,footnoteById:a,footnoteCounts:i,footnoteOrder:[],handlers:s,one:u,options:t,patch:Sae,wrap:Aae};return Eae(e,function(c){if(c.type==="definition"||c.type==="footnoteDefinition"){const f=c.type==="definition"?n:a,h=String(c.identifier).toUpperCase();f.has(h)||f.set(h,c)}}),o;function u(c,f){const h=c.type,d=o.handlers[h];if(N1.call(o.handlers,h)&&d)return d(o,c,f);if(o.options.passThrough&&o.options.passThrough.includes(h)){if("children"in c){const{children:p,...x}=c,g=Yc(x);return g.children=o.all(c),g}return Yc(c)}return(o.options.unknownHandler||Dae)(o,c,f)}function l(c){const f=[];if("children"in c){const h=c.children;let d=-1;for(;++d<h.length;){const v=o.one(h[d],c);if(v){if(d&&h[d-1].type==="break"&&(!Array.isArray(v)&&v.type==="text"&&(v.value=HT(v.value)),!Array.isArray(v)&&v.type==="element")){const p=v.children[0];p&&p.type==="text"&&(p.value=HT(p.value))}Array.isArray(v)?f.push(...v):f.push(v)}}}return f}}function Sae(e,r){e.position&&(r.position=sre(e))}function Tae(e,r){let t=r;if(e&&e.data){const n=e.data.hName,a=e.data.hChildren,i=e.data.hProperties;if(typeof n=="string")if(t.type==="element")t.tagName=n;else{const s="children"in t?t.children:[t];t={type:"element",tagName:n,properties:{},children:s}}t.type==="element"&&i&&Object.assign(t.properties,Yc(i)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function Dae(e,r){const t=r.data||{},n="value"in r&&!(N1.call(t,"hProperties")||N1.call(t,"hChildren"))?{type:"text",value:r.value}:{type:"element",tagName:"div",properties:{},children:e.all(r)};return e.patch(r,n),e.applyData(r,n)}function Aae(e,r){const t=[];let n=-1;for(r&&t.push({type:"text",value:`
`});++n<e.length;)n&&t.push({type:"text",value:`
`}),t.push(e[n]);return r&&e.length>0&&t.push({type:"text",value:`
`}),t}function HT(e){let r=0,t=e.charCodeAt(r);for(;t===9||t===32;)r++,t=e.charCodeAt(r);return e.slice(r)}function zT(e,r){const t=_ae(e,r),n=t.one(e,void 0),a=dae(t),i=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return a&&(K("children"in i),i.children.push({type:"text",value:`
`},a)),i}function _ue(e,r){return e&&"run"in e?async function(t,n){const a=zT(t,{file:n,...r});await e.run(a,n)}:function(t,n){return zT(t,{file:n,...e||r})}}function $T(e){if(e)throw e}var jp,GT;function kae(){if(GT)return jp;GT=1;var e=Object.prototype.hasOwnProperty,r=Object.prototype.toString,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,a=function(l){return typeof Array.isArray=="function"?Array.isArray(l):r.call(l)==="[object Array]"},i=function(l){if(!l||r.call(l)!=="[object Object]")return!1;var c=e.call(l,"constructor"),f=l.constructor&&l.constructor.prototype&&e.call(l.constructor.prototype,"isPrototypeOf");if(l.constructor&&!c&&!f)return!1;var h;for(h in l);return typeof h>"u"||e.call(l,h)},s=function(l,c){t&&c.name==="__proto__"?t(l,c.name,{enumerable:!0,configurable:!0,value:c.newValue,writable:!0}):l[c.name]=c.newValue},o=function(l,c){if(c==="__proto__")if(e.call(l,c)){if(n)return n(l,c).value}else return;return l[c]};return jp=function u(){var l,c,f,h,d,v,p=arguments[0],x=1,g=arguments.length,N=!1;for(typeof p=="boolean"&&(N=p,p=arguments[1]||{},x=2),(p==null||typeof p!="object"&&typeof p!="function")&&(p={});x<g;++x)if(l=arguments[x],l!=null)for(c in l)f=o(p,c),h=o(l,c),p!==h&&(N&&h&&(i(h)||(d=a(h)))?(d?(d=!1,v=f&&a(f)?f:[]):v=f&&i(f)?f:{},s(p,{name:c,newValue:u(N,v,h)})):typeof h<"u"&&s(p,{name:c,newValue:h}));return p},jp}var Rae=kae();const Lp=nr(Rae);function y1(e){if(typeof e!="object"||e===null)return!1;const r=Object.getPrototypeOf(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function Oae(){const e=[],r={run:t,use:n};return r;function t(...a){let i=-1;const s=a.pop();if(typeof s!="function")throw new TypeError("Expected function as last argument, not "+s);o(null,...a);function o(u,...l){const c=e[++i];let f=-1;if(u){s(u);return}for(;++f<a.length;)(l[f]===null||l[f]===void 0)&&(l[f]=a[f]);a=l,c?Fae(c,o)(...l):s(null,...l)}}function n(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),r}}function Fae(e,r){let t;return n;function n(...s){const o=e.length>s.length;let u;o&&s.push(a);try{u=e.apply(this,s)}catch(l){const c=l;if(o&&t)throw c;return a(c)}o||(u&&u.then&&typeof u.then=="function"?u.then(i,a):u instanceof Error?a(u):i(u))}function a(s,...o){t||(t=!0,r(s,...o))}function i(s){a(null,s)}}const Yn={basename:Uae,dirname:Iae,extname:Pae,join:Vae,sep:"/"};function Uae(e,r){if(r!==void 0&&typeof r!="string")throw new TypeError('"ext" argument must be a string');lu(e);let t=0,n=-1,a=e.length,i;if(r===void 0||r.length===0||r.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(i){t=a+1;break}}else n<0&&(i=!0,n=a+1);return n<0?"":e.slice(t,n)}if(r===e)return"";let s=-1,o=r.length-1;for(;a--;)if(e.codePointAt(a)===47){if(i){t=a+1;break}}else s<0&&(i=!0,s=a+1),o>-1&&(e.codePointAt(a)===r.codePointAt(o--)?o<0&&(n=a):(o=-1,n=s));return t===n?n=s:n<0&&(n=e.length),e.slice(t,n)}function Iae(e){if(lu(e),e.length===0)return".";let r=-1,t=e.length,n;for(;--t;)if(e.codePointAt(t)===47){if(n){r=t;break}}else n||(n=!0);return r<0?e.codePointAt(0)===47?"/":".":r===1&&e.codePointAt(0)===47?"//":e.slice(0,r)}function Pae(e){lu(e);let r=e.length,t=-1,n=0,a=-1,i=0,s;for(;r--;){const o=e.codePointAt(r);if(o===47){if(s){n=r+1;break}continue}t<0&&(s=!0,t=r+1),o===46?a<0?a=r:i!==1&&(i=1):a>-1&&(i=-1)}return a<0||t<0||i===0||i===1&&a===t-1&&a===n+1?"":e.slice(a,t)}function Vae(...e){let r=-1,t;for(;++r<e.length;)lu(e[r]),e[r]&&(t=t===void 0?e[r]:t+"/"+e[r]);return t===void 0?".":Mae(t)}function Mae(e){lu(e);const r=e.codePointAt(0)===47;let t=jae(e,!r);return t.length===0&&!r&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),r?"/"+t:t}function jae(e,r){let t="",n=0,a=-1,i=0,s=-1,o,u;for(;++s<=e.length;){if(s<e.length)o=e.codePointAt(s);else{if(o===47)break;o=47}if(o===47){if(!(a===s-1||i===1))if(a!==s-1&&i===2){if(t.length<2||n!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(u=t.lastIndexOf("/"),u!==t.length-1){u<0?(t="",n=0):(t=t.slice(0,u),n=t.length-1-t.lastIndexOf("/")),a=s,i=0;continue}}else if(t.length>0){t="",n=0,a=s,i=0;continue}}r&&(t=t.length>0?t+"/..":"..",n=2)}else t.length>0?t+="/"+e.slice(a+1,s):t=e.slice(a+1,s),n=s-a-1;a=s,i=0}else o===46&&i>-1?i++:i=-1}return t}function lu(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const Lae={cwd:Bae};function Bae(){return"/"}function C1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function qae(e){if(typeof e=="string")e=new URL(e);else if(!C1(e)){const r=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw r.code="ERR_INVALID_ARG_TYPE",r}if(e.protocol!=="file:"){const r=new TypeError("The URL must be of scheme file");throw r.code="ERR_INVALID_URL_SCHEME",r}return Hae(e)}function Hae(e){if(e.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const r=e.pathname;let t=-1;for(;++t<r.length;)if(r.codePointAt(t)===37&&r.codePointAt(t+1)===50){const n=r.codePointAt(t+2);if(n===70||n===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(r)}const Bp=["history","path","basename","stem","extname","dirname"];class zae{constructor(r){let t;r?C1(r)?t={path:r}:typeof r=="string"||$ae(r)?t={value:r}:t=r:t={},this.cwd="cwd"in t?"":Lae.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<Bp.length;){const i=Bp[n];i in t&&t[i]!==void 0&&t[i]!==null&&(this[i]=i==="history"?[...t[i]]:t[i])}let a;for(a in t)Bp.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Yn.basename(this.path):void 0}set basename(r){Hp(r,"basename"),qp(r,"basename"),this.path=Yn.join(this.dirname||"",r)}get dirname(){return typeof this.path=="string"?Yn.dirname(this.path):void 0}set dirname(r){WT(this.basename,"dirname"),this.path=Yn.join(r||"",this.basename)}get extname(){return typeof this.path=="string"?Yn.extname(this.path):void 0}set extname(r){if(qp(r,"extname"),WT(this.dirname,"extname"),r){if(r.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(r.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Yn.join(this.dirname,this.stem+(r||""))}get path(){return this.history[this.history.length-1]}set path(r){C1(r)&&(r=qae(r)),Hp(r,"path"),this.path!==r&&this.history.push(r)}get stem(){return typeof this.path=="string"?Yn.basename(this.path,this.extname):void 0}set stem(r){Hp(r,"stem"),qp(r,"stem"),this.path=Yn.join(this.dirname||"",r+(this.extname||""))}fail(r,t,n){const a=this.message(r,t,n);throw a.fatal=!0,a}info(r,t,n){const a=this.message(r,t,n);return a.fatal=void 0,a}message(r,t,n){const a=new Dt(r,t,n);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(r){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(r||void 0).decode(this.value)}}function qp(e,r){if(e&&e.includes(Yn.sep))throw new Error("`"+r+"` cannot be a path: did not expect `"+Yn.sep+"`")}function Hp(e,r){if(!e)throw new Error("`"+r+"` cannot be empty")}function WT(e,r){if(!e)throw new Error("Setting `"+r+"` requires `path` to be set too")}function $ae(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const Gae=(function(e){const n=this.constructor.prototype,a=n[e],i=function(){return a.apply(i,arguments)};return Object.setPrototypeOf(i,n),i}),Wae={}.hasOwnProperty;class kN extends Gae{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=Oae()}copy(){const r=new kN;let t=-1;for(;++t<this.attachers.length;){const n=this.attachers[t];r.use(...n)}return r.data(Lp(!0,{},this.namespace)),r}data(r,t){return typeof r=="string"?arguments.length===2?(Gp("data",this.frozen),this.namespace[r]=t,this):Wae.call(this.namespace,r)&&this.namespace[r]||void 0:r?(Gp("data",this.frozen),this.namespace=r,this):this.namespace}freeze(){if(this.frozen)return this;const r=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const a=t.call(r,...n);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(r){this.freeze();const t=Yu(r),n=this.parser||this.Parser;return zp("parse",n),n(String(t),t)}process(r,t){const n=this;return this.freeze(),zp("process",this.parser||this.Parser),$p("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(i,s){const o=Yu(r),u=n.parse(o);n.run(u,o,function(c,f,h){if(c||!f||!h)return l(c);const d=f,v=n.stringify(d,h);Kae(v)?h.value=v:h.result=v,l(c,h)});function l(c,f){c||!f?s(c):i?i(f):(K(t,"`done` is defined if `resolve` is not"),t(void 0,f))}}}processSync(r){let t=!1,n;return this.freeze(),zp("processSync",this.parser||this.Parser),$p("processSync",this.compiler||this.Compiler),this.process(r,a),KT("processSync","process",t),K(n,"we either bailed on an error or have a tree"),n;function a(i,s){t=!0,$T(i),n=s}}run(r,t,n){YT(r),this.freeze();const a=this.transformers;return!n&&typeof t=="function"&&(n=t,t=void 0),n?i(void 0,n):new Promise(i);function i(s,o){K(typeof t!="function","`file` canâ€™t be a `done` anymore, we checked");const u=Yu(t);a.run(r,u,l);function l(c,f,h){const d=f||r;c?o(c):s?s(d):(K(n,"`done` is defined if `resolve` is not"),n(void 0,d,h))}}}runSync(r,t){let n=!1,a;return this.run(r,t,i),KT("runSync","run",n),K(a,"we either bailed on an error or have a tree"),a;function i(s,o){$T(s),a=o,n=!0}}stringify(r,t){this.freeze();const n=Yu(t),a=this.compiler||this.Compiler;return $p("stringify",a),YT(r),a(r,n)}use(r,...t){const n=this.attachers,a=this.namespace;if(Gp("use",this.frozen),r!=null)if(typeof r=="function")u(r,t);else if(typeof r=="object")Array.isArray(r)?o(r):s(r);else throw new TypeError("Expected usable value, not `"+r+"`");return this;function i(l){if(typeof l=="function")u(l,[]);else if(typeof l=="object")if(Array.isArray(l)){const[c,...f]=l;u(c,f)}else s(l);else throw new TypeError("Expected usable value, not `"+l+"`")}function s(l){if(!("plugins"in l)&&!("settings"in l))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(l.plugins),l.settings&&(a.settings=Lp(!0,a.settings,l.settings))}function o(l){let c=-1;if(l!=null)if(Array.isArray(l))for(;++c<l.length;){const f=l[c];i(f)}else throw new TypeError("Expected a list of plugins, not `"+l+"`")}function u(l,c){let f=-1,h=-1;for(;++f<n.length;)if(n[f][0]===l){h=f;break}if(h===-1)n.push([l,...c]);else if(c.length>0){let[d,...v]=c;const p=n[h][1];y1(p)&&y1(d)&&(d=Lp(!0,p,d)),n[h]=[l,d,...v]}}}}const Sue=new kN().freeze();function zp(e,r){if(typeof r!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function $p(e,r){if(typeof r!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function Gp(e,r){if(r)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function YT(e){if(!y1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function KT(e,r,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+r+"` instead")}function Yu(e){return Yae(e)?e:new zae(e)}function Yae(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function Kae(e){return typeof e=="string"||Xae(e)}function Xae(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}function Tue({feedback:e,isOpen:r,onClose:t,onDelete:n,isAdmin:a=!1}){const{toast:i}=Qc(),[s,o]=W.useState(""),[u,l]=W.useState(!1),[c,f]=W.useState(e),[h,d]=W.useState(!1),[v,p]=W.useState(null),[x,g]=W.useState(0),N=W.useRef(null);if(W.useEffect(()=>{if(f(e),p(null),!r||!e?.id)return;let k=!1;return(async()=>{try{d(!0);const U=await fetch(`/api/monthly-feedback/${e.id}`);if(!U.ok)throw U.status===404?new Error("This feedback report was not found. It may have been deleted."):U.status===500?new Error("Server error occurred while loading the report."):new Error(`Unable to load report (Error ${U.status})`);const F=await U.json();k||f(F)}catch(U){console.error("Failed to load feedback details:",U),k||p(U instanceof Error?U.message:"We could not load this report right now.")}finally{k||d(!1)}})(),()=>{k=!0}},[r,e?.id,x]),!e)return null;const b=c??e,y={id:b.id||0,school:b.school||"Unknown School",month:b.month||"Unknown Month",year:b.year||new Date().getFullYear(),pdfUrl:b.pdfUrl||"",pdfFileName:b.pdfFileName||"document.pdf",extractedText:b.extractedText||null,notes:b.notes||null,uploadedBy:b.uploadedBy||null,fileSize:b.fileSize||null,createdAt:b.createdAt||new Date().toISOString()};W.useEffect(()=>{if(!r)return;const k=F=>{F.key==="Escape"&&t()},U=N.current?.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')?.[0];return U&&U.focus(),document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[r,t]);const _=()=>{const k=document.createElement("a");k.href=y.pdfUrl,k.download=y.pdfFileName,document.body.appendChild(k),k.click(),document.body.removeChild(k),i({title:"Download Started",description:"PDF download has started."})},w=async()=>{l(!0);try{if((await fetch(`/api/monthly-feedback/${y.id}/notes`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:s})})).ok)i({title:"Notes Saved",description:"Your notes have been saved successfully."});else throw new Error("Failed to save notes")}catch{i({variant:"destructive",title:"Save Failed",description:"Failed to save notes. Please try again."})}finally{l(!1)}},C=()=>{n&&confirm(`Are you sure you want to delete feedback for ${y.month} ${y.year}?`)&&n(y.id)};return m.jsxDEV(af,{open:r,onOpenChange:t,children:m.jsxDEV(Hl,{ref:N,className:"w-[70vw] h-[70vh] max-w-6xl overflow-hidden flex flex-col",children:[m.jsxDEV(zl,{className:"flex-shrink-0",children:[m.jsxDEV($l,{className:"flex items-center justify-between text-xl",children:[m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(ja,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:178,columnNumber:15},this),y.month," ",y.year," - ",y.school]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:177,columnNumber:13},this),m.jsxDEV(yr,{children:y.school},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:181,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:176,columnNumber:11},this),m.jsxDEV(Gl,{children:m.jsxDEV("div",{className:"flex items-center gap-4 text-sm",children:[m.jsxDEV("span",{className:"flex items-center gap-1",children:[m.jsxDEV(wt,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:186,columnNumber:17},this),new Date(y.createdAt).toLocaleDateString()]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:185,columnNumber:15},this),y.uploadedBy&&m.jsxDEV("span",{className:"flex items-center gap-1",children:[m.jsxDEV(ni,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:191,columnNumber:19},this),y.uploadedBy]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:190,columnNumber:17},this),y.fileSize&&m.jsxDEV("span",{children:["Size: ",(y.fileSize/1024/1024).toFixed(2)," MB"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:196,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:184,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:183,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:175,columnNumber:9},this),m.jsxDEV(NR,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:202,columnNumber:9},this),m.jsxDEV("div",{className:"flex-1 overflow-hidden",children:[h&&m.jsxDEV("div",{className:"p-6 text-sm text-muted-foreground",children:"Loading detailsâ€¦"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:206,columnNumber:13},this),!h&&v&&m.jsxDEV("div",{className:"p-6",children:m.jsxDEV("div",{className:"border rounded-md p-4 bg-muted/50",children:[m.jsxDEV("p",{className:"text-sm text-destructive",children:v},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:211,columnNumber:17},this),m.jsxDEV("p",{className:"text-sm text-muted-foreground mt-2",children:"You can try again or download the original PDF if available."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:212,columnNumber:17},this),m.jsxDEV("div",{className:"mt-4 flex gap-2",children:[m.jsxDEV(We,{onClick:()=>{p(null),g(k=>k+1)},variant:"outline",children:"Retry"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:216,columnNumber:19},this),m.jsxDEV(We,{onClick:t,variant:"outline",children:"Back to Feedback Reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:225,columnNumber:19},this),y.pdfUrl&&m.jsxDEV(We,{onClick:_,children:[m.jsxDEV(Qi,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:230,columnNumber:23},this),"Download PDF"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:229,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:215,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:210,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:209,columnNumber:13},this),!h&&!v&&m.jsxDEV(Y8,{defaultValue:"content",className:"w-full h-full flex flex-col",children:[m.jsxDEV(yR,{className:"grid w-full grid-cols-2 flex-shrink-0",children:[m.jsxDEV(Lg,{value:"content",children:"Extracted Content"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:241,columnNumber:15},this),m.jsxDEV(Lg,{value:"notes",children:"Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:242,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:240,columnNumber:13},this),m.jsxDEV(Bg,{value:"content",className:"flex-1 overflow-y-auto space-y-4",children:m.jsxDEV("div",{className:"border rounded-lg p-4 bg-muted/50",children:y.extractedText?m.jsxDEV("div",{className:"prose prose-sm max-w-none",children:m.jsxDEV(LV,{children:y.extractedText},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:249,columnNumber:21},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:248,columnNumber:19},this):m.jsxDEV("p",{className:"text-muted-foreground text-center py-8",children:"Text could not be extracted â€“ download the PDF to view."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:252,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:246,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:245,columnNumber:13},this),m.jsxDEV(Bg,{value:"notes",className:"flex-1 overflow-y-auto space-y-4",children:[m.jsxDEV(W1,{value:s||y.notes||"",onChange:k=>o(k.target.value),placeholder:"Add notes about this feedback...",rows:10,maxLength:5e3},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:260,columnNumber:15},this),m.jsxDEV(We,{onClick:w,disabled:u,children:u?m.jsxDEV(m.Fragment,{children:"Saving..."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:269,columnNumber:19},this):m.jsxDEV(m.Fragment,{children:[m.jsxDEV(u4,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:272,columnNumber:21},this),"Save Notes"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:271,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:267,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:259,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:239,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:204,columnNumber:9},this),m.jsxDEV(bR,{className:"flex justify-between",children:[m.jsxDEV("div",{className:"flex flex-col gap-2",children:[m.jsxDEV(We,{onClick:_,variant:"outline",children:[m.jsxDEV(Qi,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:285,columnNumber:15},this),"Download PDF"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:284,columnNumber:13},this),y.fileSize&&m.jsxDEV("p",{className:"text-xs text-muted-foreground",children:["Download original PDF â€“ ",(y.fileSize/1024/1024).toFixed(2)," MB"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:289,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:283,columnNumber:11},this),m.jsxDEV("div",{className:"flex items-center gap-2",children:[a&&n&&m.jsxDEV(We,{onClick:C,variant:"destructive",children:[m.jsxDEV(BV,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:297,columnNumber:17},this),"Delete"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:296,columnNumber:15},this),m.jsxDEV(We,{onClick:t,children:"Close"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:301,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:294,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:282,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:174,columnNumber:7},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:173,columnNumber:5},this)}function Due({school:e,score:r,complianceStatus:t,dateRange:n,compact:a=!1}){const i=r.overallScore/5*100,s=l=>l>=4?"text-green-700":l>=3?"text-green-600":l>=2?"text-yellow-600":"text-red-600",o=l=>l>=4?"bg-green-600":l>=3?"bg-green-500":l>=2?"bg-yellow-500":"bg-red-500",u=l=>{switch(l){case"green":return"default";case"yellow":return"secondary";case"red":return"destructive";default:return"outline"}};return a?m.jsxDEV(qe,{className:"hover:shadow-md transition-shadow",children:[m.jsxDEV(Qe,{className:"pb-3",children:[m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV(Ze,{className:"text-lg",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:79,columnNumber:13},this),m.jsxDEV(yr,{variant:u(t.color),children:[r.level2Compliant?m.jsxDEV(Pn,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:82,columnNumber:17},this):m.jsxDEV(Ut,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:84,columnNumber:17},this),t.text]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:80,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:78,columnNumber:11},this),n&&m.jsxDEV(mr,{className:"text-xs",children:[n.start," to ",n.end]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:90,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:77,columnNumber:9},this),m.jsxDEV(He,{children:m.jsxDEV("div",{className:"space-y-3",children:[m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("span",{className:"text-2xl font-bold",style:{color:s(r.overallScore)},children:r.overallScore.toFixed(2)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:98,columnNumber:15},this),m.jsxDEV("span",{className:"text-sm text-muted-foreground",children:"/ 5.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:101,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:97,columnNumber:13},this),m.jsxDEV(cl,{value:i,className:o(r.overallScore)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:103,columnNumber:13},this),m.jsxDEV("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[m.jsxDEV("div",{children:[m.jsxDEV("div",{className:"text-muted-foreground",children:"Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:106,columnNumber:17},this),m.jsxDEV("div",{className:"font-semibold",children:r.inspectionCount},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:107,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:105,columnNumber:15},this),m.jsxDEV("div",{children:[m.jsxDEV("div",{className:"text-muted-foreground",children:"Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:110,columnNumber:17},this),m.jsxDEV("div",{className:"font-semibold",children:r.notesCount},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:111,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:109,columnNumber:15},this),m.jsxDEV("div",{children:[m.jsxDEV("div",{className:"text-muted-foreground",children:"Avg Rating"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:114,columnNumber:17},this),m.jsxDEV("div",{className:"font-semibold",children:r.inspectionScore.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:115,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:113,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:104,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:96,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:95,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:76,columnNumber:7},this):m.jsxDEV(qe,{className:"hover:shadow-lg transition-shadow",children:[m.jsxDEV(Qe,{children:m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("div",{children:[m.jsxDEV(Ze,{className:"text-2xl",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:129,columnNumber:13},this),n&&m.jsxDEV(mr,{children:["Period: ",n.start," to ",n.end]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:131,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:128,columnNumber:11},this),m.jsxDEV(yr,{variant:u(t.color),className:"text-sm px-3 py-1",children:[r.level2Compliant?m.jsxDEV(Pn,{className:"w-4 h-4 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:138,columnNumber:15},this):m.jsxDEV(Ut,{className:"w-4 h-4 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:140,columnNumber:15},this),t.text]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:136,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:127,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:126,columnNumber:7},this),m.jsxDEV(He,{className:"space-y-6",children:[m.jsxDEV("div",{className:"text-center space-y-2",children:[m.jsxDEV("div",{className:"text-6xl font-bold",style:{color:s(r.overallScore)},children:r.overallScore.toFixed(2)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:149,columnNumber:11},this),m.jsxDEV("div",{className:"text-sm text-muted-foreground",children:"Overall Building Score (out of 5.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:152,columnNumber:11},this),m.jsxDEV(cl,{value:i,className:`h-3 ${o(r.overallScore)}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:153,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:148,columnNumber:9},this),m.jsxDEV("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t",children:[m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV("div",{className:"text-sm font-medium text-muted-foreground",children:"Inspection Average"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:159,columnNumber:13},this),m.jsxDEV("div",{className:"text-2xl font-bold",children:r.inspectionScore.toFixed(2)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:160,columnNumber:13},this),m.jsxDEV("div",{className:"text-xs text-muted-foreground",children:["75% weight â€¢ ",r.inspectionCount," inspections"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:161,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:158,columnNumber:11},this),m.jsxDEV("div",{className:"space-y-2",children:[m.jsxDEV("div",{className:"text-sm font-medium text-muted-foreground",children:"Notes Impact"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:164,columnNumber:13},this),m.jsxDEV("div",{className:"text-2xl font-bold flex items-center gap-1",children:[r.notesModifier>0?m.jsxDEV(lo,{className:"w-5 h-5 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:167,columnNumber:17},this):r.notesModifier<0?m.jsxDEV(B1,{className:"w-5 h-5 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:169,columnNumber:17},this):null,r.notesModifier>0?"+":"",r.notesModifier.toFixed(2)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:165,columnNumber:13},this),m.jsxDEV("div",{className:"text-xs text-muted-foreground",children:["25% weight â€¢ ",r.notesCount," notes"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:173,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:163,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:157,columnNumber:9},this),r.categoryBreakdown&&r.categoryBreakdown.length>0&&m.jsxDEV("div",{className:"space-y-3 pt-4 border-t",children:[m.jsxDEV("div",{className:"text-sm font-medium",children:"Category Breakdown"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:180,columnNumber:13},this),m.jsxDEV("div",{className:"space-y-2",children:r.categoryBreakdown.filter(l=>l.count>0).sort((l,c)=>c.averageRating-l.averageRating).slice(0,5).map(l=>m.jsxDEV("div",{className:"flex items-center justify-between",children:[m.jsxDEV("span",{className:"text-sm",children:l.category},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:188,columnNumber:21},this),m.jsxDEV("div",{className:"flex items-center gap-2",children:[m.jsxDEV(cl,{value:l.averageRating/5*100,className:"w-24 h-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:190,columnNumber:23},this),m.jsxDEV("span",{className:"text-sm font-semibold w-12 text-right",children:l.averageRating.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:194,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:189,columnNumber:21},this)]},l.category,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:187,columnNumber:19},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:181,columnNumber:13},this),r.categoryBreakdown.filter(l=>l.count>0).length>5&&m.jsxDEV("div",{className:"text-xs text-muted-foreground text-center",children:"Showing top 5 categories"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:202,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:179,columnNumber:11},this),m.jsxDEV("div",{className:`p-3 rounded-lg border ${r.level2Compliant?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"}`,children:m.jsxDEV("div",{className:"flex items-center gap-2",children:[r.level2Compliant?m.jsxDEV(Pn,{className:"w-5 h-5 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:217,columnNumber:15},this):m.jsxDEV(Ut,{className:"w-5 h-5 text-yellow-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:219,columnNumber:15},this),m.jsxDEV("div",{className:"text-sm",children:r.level2Compliant?m.jsxDEV("span",{className:"font-semibold text-green-800",children:"Meets Level 2 Standards (â‰¥3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:223,columnNumber:17},this):m.jsxDEV("span",{className:"font-semibold text-yellow-800",children:"Below Level 2 Standards (target: â‰¥3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:227,columnNumber:17},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:221,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:215,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:210,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:146,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:125,columnNumber:5},this)}var XT={},QT={},Go,ZT;function Ur(){if(ZT)return Go;ZT=1;var e=function(r){return r&&r.Math===Math&&r};return Go=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof Pi=="object"&&Pi)||e(typeof Go=="object"&&Go)||(function(){return this})()||Function("return this")(),Go}var Wp={},Yp,JT;function Hr(){return JT||(JT=1,Yp=function(e){try{return!!e()}catch{return!0}}),Yp}var Kp,eD;function qn(){if(eD)return Kp;eD=1;var e=Hr();return Kp=!e(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Kp}var Xp,rD;function If(){if(rD)return Xp;rD=1;var e=Hr();return Xp=!e(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),Xp}var Qp,tD;function Nt(){if(tD)return Qp;tD=1;var e=If(),r=Function.prototype.call;return Qp=e?r.bind(r):function(){return r.apply(r,arguments)},Qp}var Zp={},nD;function Qae(){if(nD)return Zp;nD=1;var e={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,t=r&&!e.call({1:2},1);return Zp.f=t?function(a){var i=r(this,a);return!!i&&i.enumerable}:e,Zp}var Jp,aD;function RN(){return aD||(aD=1,Jp=function(e,r){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:r}}),Jp}var ev,iD;function zr(){if(iD)return ev;iD=1;var e=If(),r=Function.prototype,t=r.call,n=e&&r.bind.bind(t,t);return ev=e?n:function(a){return function(){return t.apply(a,arguments)}},ev}var rv,sD;function bs(){if(sD)return rv;sD=1;var e=zr(),r=e({}.toString),t=e("".slice);return rv=function(n){return t(r(n),8,-1)},rv}var tv,oD;function lP(){if(oD)return tv;oD=1;var e=zr(),r=Hr(),t=bs(),n=Object,a=e("".split);return tv=r(function(){return!n("z").propertyIsEnumerable(0)})?function(i){return t(i)==="String"?a(i,""):n(i)}:n,tv}var nv,lD;function Pf(){return lD||(lD=1,nv=function(e){return e==null}),nv}var av,uD;function Hn(){if(uD)return av;uD=1;var e=Pf(),r=TypeError;return av=function(t){if(e(t))throw new r("Can't call method on "+t);return t},av}var iv,cD;function uu(){if(cD)return iv;cD=1;var e=lP(),r=Hn();return iv=function(t){return e(r(t))},iv}var sv,fD;function Gr(){if(fD)return sv;fD=1;var e=typeof document=="object"&&document.all;return sv=typeof e>"u"&&e!==void 0?function(r){return typeof r=="function"||r===e}:function(r){return typeof r=="function"},sv}var ov,mD;function Yt(){if(mD)return ov;mD=1;var e=Gr();return ov=function(r){return typeof r=="object"?r!==null:e(r)},ov}var lv,dD;function Ns(){if(dD)return lv;dD=1;var e=Ur(),r=Gr(),t=function(n){return r(n)?n:void 0};return lv=function(n,a){return arguments.length<2?t(e[n]):e[n]&&e[n][a]},lv}var uv,hD;function Vf(){if(hD)return uv;hD=1;var e=zr();return uv=e({}.isPrototypeOf),uv}var cv,pD;function cu(){if(pD)return cv;pD=1;var e=Ur(),r=e.navigator,t=r&&r.userAgent;return cv=t?String(t):"",cv}var fv,vD;function ON(){if(vD)return fv;vD=1;var e=Ur(),r=cu(),t=e.process,n=e.Deno,a=t&&t.versions||n&&n.version,i=a&&a.v8,s,o;return i&&(s=i.split("."),o=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!o&&r&&(s=r.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=r.match(/Chrome\/(\d+)/),s&&(o=+s[1]))),fv=o,fv}var mv,xD;function uP(){if(xD)return mv;xD=1;var e=ON(),r=Hr(),t=Ur(),n=t.String;return mv=!!Object.getOwnPropertySymbols&&!r(function(){var a=Symbol("symbol detection");return!n(a)||!(Object(a)instanceof Symbol)||!Symbol.sham&&e&&e<41}),mv}var dv,gD;function cP(){if(gD)return dv;gD=1;var e=uP();return dv=e&&!Symbol.sham&&typeof Symbol.iterator=="symbol",dv}var hv,bD;function fP(){if(bD)return hv;bD=1;var e=Ns(),r=Gr(),t=Vf(),n=cP(),a=Object;return hv=n?function(i){return typeof i=="symbol"}:function(i){var s=e("Symbol");return r(s)&&t(s.prototype,a(i))},hv}var pv,ND;function Mf(){if(ND)return pv;ND=1;var e=String;return pv=function(r){try{return e(r)}catch{return"Object"}},pv}var vv,yD;function za(){if(yD)return vv;yD=1;var e=Gr(),r=Mf(),t=TypeError;return vv=function(n){if(e(n))return n;throw new t(r(n)+" is not a function")},vv}var xv,CD;function _o(){if(CD)return xv;CD=1;var e=za(),r=Pf();return xv=function(t,n){var a=t[n];return r(a)?void 0:e(a)},xv}var gv,ED;function Zae(){if(ED)return gv;ED=1;var e=Nt(),r=Gr(),t=Yt(),n=TypeError;return gv=function(a,i){var s,o;if(i==="string"&&r(s=a.toString)&&!t(o=e(s,a))||r(s=a.valueOf)&&!t(o=e(s,a))||i!=="string"&&r(s=a.toString)&&!t(o=e(s,a)))return o;throw new n("Can't convert object to primitive value")},gv}var bv={exports:{}},Nv,wD;function ma(){return wD||(wD=1,Nv=!1),Nv}var yv,_D;function FN(){if(_D)return yv;_D=1;var e=Ur(),r=Object.defineProperty;return yv=function(t,n){try{r(e,t,{value:n,configurable:!0,writable:!0})}catch{e[t]=n}return n},yv}var SD;function UN(){if(SD)return bv.exports;SD=1;var e=ma(),r=Ur(),t=FN(),n="__core-js_shared__",a=bv.exports=r[n]||t(n,{});return(a.versions||(a.versions=[])).push({version:"3.46.0",mode:e?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"}),bv.exports}var Cv,TD;function IN(){if(TD)return Cv;TD=1;var e=UN();return Cv=function(r,t){return e[r]||(e[r]=t||{})},Cv}var Ev,DD;function jf(){if(DD)return Ev;DD=1;var e=Hn(),r=Object;return Ev=function(t){return r(e(t))},Ev}var wv,AD;function zn(){if(AD)return wv;AD=1;var e=zr(),r=jf(),t=e({}.hasOwnProperty);return wv=Object.hasOwn||function(a,i){return t(r(a),i)},wv}var _v,kD;function mP(){if(kD)return _v;kD=1;var e=zr(),r=0,t=Math.random(),n=e(1.1.toString);return _v=function(a){return"Symbol("+(a===void 0?"":a)+")_"+n(++r+t,36)},_v}var Sv,RD;function dt(){if(RD)return Sv;RD=1;var e=Ur(),r=IN(),t=zn(),n=mP(),a=uP(),i=cP(),s=e.Symbol,o=r("wks"),u=i?s.for||s:s&&s.withoutSetter||n;return Sv=function(l){return t(o,l)||(o[l]=a&&t(s,l)?s[l]:u("Symbol."+l)),o[l]},Sv}var Tv,OD;function Jae(){if(OD)return Tv;OD=1;var e=Nt(),r=Yt(),t=fP(),n=_o(),a=Zae(),i=dt(),s=TypeError,o=i("toPrimitive");return Tv=function(u,l){if(!r(u)||t(u))return u;var c=n(u,o),f;if(c){if(l===void 0&&(l="default"),f=e(c,u,l),!r(f)||t(f))return f;throw new s("Can't convert object to primitive value")}return l===void 0&&(l="number"),a(u,l)},Tv}var Dv,FD;function dP(){if(FD)return Dv;FD=1;var e=Jae(),r=fP();return Dv=function(t){var n=e(t,"string");return r(n)?n:n+""},Dv}var Av,UD;function Lf(){if(UD)return Av;UD=1;var e=Ur(),r=Yt(),t=e.document,n=r(t)&&r(t.createElement);return Av=function(a){return n?t.createElement(a):{}},Av}var kv,ID;function hP(){if(ID)return kv;ID=1;var e=qn(),r=Hr(),t=Lf();return kv=!e&&!r(function(){return Object.defineProperty(t("div"),"a",{get:function(){return 7}}).a!==7}),kv}var PD;function Bf(){if(PD)return Wp;PD=1;var e=qn(),r=Nt(),t=Qae(),n=RN(),a=uu(),i=dP(),s=zn(),o=hP(),u=Object.getOwnPropertyDescriptor;return Wp.f=e?u:function(c,f){if(c=a(c),f=i(f),o)try{return u(c,f)}catch{}if(s(c,f))return n(!r(t.f,c,f),c[f])},Wp}var Rv={},Ov,VD;function pP(){if(VD)return Ov;VD=1;var e=qn(),r=Hr();return Ov=e&&r(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Ov}var Fv,MD;function Pt(){if(MD)return Fv;MD=1;var e=Yt(),r=String,t=TypeError;return Fv=function(n){if(e(n))return n;throw new t(r(n)+" is not an object")},Fv}var jD;function Ei(){if(jD)return Rv;jD=1;var e=qn(),r=hP(),t=pP(),n=Pt(),a=dP(),i=TypeError,s=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u="enumerable",l="configurable",c="writable";return Rv.f=e?t?function(h,d,v){if(n(h),d=a(d),n(v),typeof h=="function"&&d==="prototype"&&"value"in v&&c in v&&!v[c]){var p=o(h,d);p&&p[c]&&(h[d]=v.value,v={configurable:l in v?v[l]:p[l],enumerable:u in v?v[u]:p[u],writable:!1})}return s(h,d,v)}:s:function(h,d,v){if(n(h),d=a(d),n(v),r)try{return s(h,d,v)}catch{}if("get"in v||"set"in v)throw new i("Accessors not supported");return"value"in v&&(h[d]=v.value),h},Rv}var Uv,LD;function fu(){if(LD)return Uv;LD=1;var e=qn(),r=Ei(),t=RN();return Uv=e?function(n,a,i){return r.f(n,a,t(1,i))}:function(n,a,i){return n[a]=i,n},Uv}var Iv={exports:{}},Pv,BD;function qf(){if(BD)return Pv;BD=1;var e=qn(),r=zn(),t=Function.prototype,n=e&&Object.getOwnPropertyDescriptor,a=r(t,"name"),i=a&&(function(){}).name==="something",s=a&&(!e||e&&n(t,"name").configurable);return Pv={EXISTS:a,PROPER:i,CONFIGURABLE:s},Pv}var Vv,qD;function PN(){if(qD)return Vv;qD=1;var e=zr(),r=Gr(),t=UN(),n=e(Function.toString);return r(t.inspectSource)||(t.inspectSource=function(a){return n(a)}),Vv=t.inspectSource,Vv}var Mv,HD;function eie(){if(HD)return Mv;HD=1;var e=Ur(),r=Gr(),t=e.WeakMap;return Mv=r(t)&&/native code/.test(String(t)),Mv}var jv,zD;function VN(){if(zD)return jv;zD=1;var e=IN(),r=mP(),t=e("keys");return jv=function(n){return t[n]||(t[n]=r(n))},jv}var Lv,$D;function MN(){return $D||($D=1,Lv={}),Lv}var Bv,GD;function Hf(){if(GD)return Bv;GD=1;var e=eie(),r=Ur(),t=Yt(),n=fu(),a=zn(),i=UN(),s=VN(),o=MN(),u="Object already initialized",l=r.TypeError,c=r.WeakMap,f,h,d,v=function(N){return d(N)?h(N):f(N,{})},p=function(N){return function(b){var y;if(!t(b)||(y=h(b)).type!==N)throw new l("Incompatible receiver, "+N+" required");return y}};if(e||i.state){var x=i.state||(i.state=new c);x.get=x.get,x.has=x.has,x.set=x.set,f=function(N,b){if(x.has(N))throw new l(u);return b.facade=N,x.set(N,b),b},h=function(N){return x.get(N)||{}},d=function(N){return x.has(N)}}else{var g=s("state");o[g]=!0,f=function(N,b){if(a(N,g))throw new l(u);return b.facade=N,n(N,g,b),b},h=function(N){return a(N,g)?N[g]:{}},d=function(N){return a(N,g)}}return Bv={set:f,get:h,has:d,enforce:v,getterFor:p},Bv}var WD;function vP(){if(WD)return Iv.exports;WD=1;var e=zr(),r=Hr(),t=Gr(),n=zn(),a=qn(),i=qf().CONFIGURABLE,s=PN(),o=Hf(),u=o.enforce,l=o.get,c=String,f=Object.defineProperty,h=e("".slice),d=e("".replace),v=e([].join),p=a&&!r(function(){return f(function(){},"length",{value:8}).length!==8}),x=String(String).split("String"),g=Iv.exports=function(N,b,y){h(c(b),0,7)==="Symbol("&&(b="["+d(c(b),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),y&&y.getter&&(b="get "+b),y&&y.setter&&(b="set "+b),(!n(N,"name")||i&&N.name!==b)&&(a?f(N,"name",{value:b,configurable:!0}):N.name=b),p&&y&&n(y,"arity")&&N.length!==y.arity&&f(N,"length",{value:y.arity});try{y&&n(y,"constructor")&&y.constructor?a&&f(N,"prototype",{writable:!1}):N.prototype&&(N.prototype=void 0)}catch{}var _=u(N);return n(_,"source")||(_.source=v(x,typeof b=="string"?b:"")),N};return Function.prototype.toString=g(function(){return t(this)&&l(this).source||s(this)},"toString"),Iv.exports}var qv,YD;function ys(){if(YD)return qv;YD=1;var e=Gr(),r=Ei(),t=vP(),n=FN();return qv=function(a,i,s,o){o||(o={});var u=o.enumerable,l=o.name!==void 0?o.name:i;if(e(s)&&t(s,l,o),o.global)u?a[i]=s:n(i,s);else{try{o.unsafe?a[i]&&(u=!0):delete a[i]}catch{}u?a[i]=s:r.f(a,i,{value:s,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return a},qv}var Hv={},zv,KD;function rie(){if(KD)return zv;KD=1;var e=Math.ceil,r=Math.floor;return zv=Math.trunc||function(n){var a=+n;return(a>0?r:e)(a)},zv}var $v,XD;function zf(){if(XD)return $v;XD=1;var e=rie();return $v=function(r){var t=+r;return t!==t||t===0?0:e(t)},$v}var Gv,QD;function tie(){if(QD)return Gv;QD=1;var e=zf(),r=Math.max,t=Math.min;return Gv=function(n,a){var i=e(n);return i<0?r(i+a,0):t(i,a)},Gv}var Wv,ZD;function So(){if(ZD)return Wv;ZD=1;var e=zf(),r=Math.min;return Wv=function(t){var n=e(t);return n>0?r(n,9007199254740991):0},Wv}var Yv,JD;function jN(){if(JD)return Yv;JD=1;var e=So();return Yv=function(r){return e(r.length)},Yv}var Kv,eA;function xP(){if(eA)return Kv;eA=1;var e=uu(),r=tie(),t=jN(),n=function(a){return function(i,s,o){var u=e(i),l=t(u);if(l===0)return!a&&-1;var c=r(o,l),f;if(a&&s!==s){for(;l>c;)if(f=u[c++],f!==f)return!0}else for(;l>c;c++)if((a||c in u)&&u[c]===s)return a||c||0;return!a&&-1}};return Kv={includes:n(!0),indexOf:n(!1)},Kv}var Xv,rA;function gP(){if(rA)return Xv;rA=1;var e=zr(),r=zn(),t=uu(),n=xP().indexOf,a=MN(),i=e([].push);return Xv=function(s,o){var u=t(s),l=0,c=[],f;for(f in u)!r(a,f)&&r(u,f)&&i(c,f);for(;o.length>l;)r(u,f=o[l++])&&(~n(c,f)||i(c,f));return c},Xv}var Qv,tA;function LN(){return tA||(tA=1,Qv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),Qv}var nA;function nie(){if(nA)return Hv;nA=1;var e=gP(),r=LN(),t=r.concat("length","prototype");return Hv.f=Object.getOwnPropertyNames||function(a){return e(a,t)},Hv}var Zv={},aA;function aie(){return aA||(aA=1,Zv.f=Object.getOwnPropertySymbols),Zv}var Jv,iA;function iie(){if(iA)return Jv;iA=1;var e=Ns(),r=zr(),t=nie(),n=aie(),a=Pt(),i=r([].concat);return Jv=e("Reflect","ownKeys")||function(o){var u=t.f(a(o)),l=n.f;return l?i(u,l(o)):u},Jv}var ex,sA;function sie(){if(sA)return ex;sA=1;var e=zn(),r=iie(),t=Bf(),n=Ei();return ex=function(a,i,s){for(var o=r(i),u=n.f,l=t.f,c=0;c<o.length;c++){var f=o[c];!e(a,f)&&!(s&&e(s,f))&&u(a,f,l(i,f))}},ex}var rx,oA;function bP(){if(oA)return rx;oA=1;var e=Hr(),r=Gr(),t=/#|\.prototype\./,n=function(u,l){var c=i[a(u)];return c===o?!0:c===s?!1:r(l)?e(l):!!l},a=n.normalize=function(u){return String(u).replace(t,".").toLowerCase()},i=n.data={},s=n.NATIVE="N",o=n.POLYFILL="P";return rx=n,rx}var tx,lA;function Vt(){if(lA)return tx;lA=1;var e=Ur(),r=Bf().f,t=fu(),n=ys(),a=FN(),i=sie(),s=bP();return tx=function(o,u){var l=o.target,c=o.global,f=o.stat,h,d,v,p,x,g;if(c?d=e:f?d=e[l]||a(l,{}):d=e[l]&&e[l].prototype,d)for(v in u){if(x=u[v],o.dontCallGetSet?(g=r(d,v),p=g&&g.value):p=d[v],h=s(c?v:l+(f?".":"#")+v,o.forced),!h&&p!==void 0){if(typeof x==typeof p)continue;i(x,p)}(o.sham||p&&p.sham)&&t(x,"sham",!0),n(d,v,x,o)}},tx}var nx,uA;function NP(){if(uA)return nx;uA=1;var e=Ur(),r=cu(),t=bs(),n=function(a){return r.slice(0,a.length)===a};return nx=(function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":e.Bun&&typeof Bun.version=="string"?"BUN":e.Deno&&typeof Deno.version=="object"?"DENO":t(e.process)==="process"?"NODE":e.window&&e.document?"BROWSER":"REST"})(),nx}var ax,cA;function $f(){if(cA)return ax;cA=1;var e=NP();return ax=e==="NODE",ax}var ix,fA;function oie(){if(fA)return ix;fA=1;var e=Ur();return ix=e,ix}var sx,mA;function lie(){if(mA)return sx;mA=1;var e=zr(),r=za();return sx=function(t,n,a){try{return e(r(Object.getOwnPropertyDescriptor(t,n)[a]))}catch{}},sx}var ox,dA;function uie(){if(dA)return ox;dA=1;var e=Yt();return ox=function(r){return e(r)||r===null},ox}var lx,hA;function cie(){if(hA)return lx;hA=1;var e=uie(),r=String,t=TypeError;return lx=function(n){if(e(n))return n;throw new t("Can't set "+r(n)+" as a prototype")},lx}var ux,pA;function yP(){if(pA)return ux;pA=1;var e=lie(),r=Yt(),t=Hn(),n=cie();return ux=Object.setPrototypeOf||("__proto__"in{}?(function(){var a=!1,i={},s;try{s=e(Object.prototype,"__proto__","set"),s(i,[]),a=i instanceof Array}catch{}return function(u,l){return t(u),n(l),r(u)&&(a?s(u,l):u.__proto__=l),u}})():void 0),ux}var cx,vA;function Gf(){if(vA)return cx;vA=1;var e=Ei().f,r=zn(),t=dt(),n=t("toStringTag");return cx=function(a,i,s){a&&!s&&(a=a.prototype),a&&!r(a,n)&&e(a,n,{configurable:!0,value:i})},cx}var fx,xA;function fie(){if(xA)return fx;xA=1;var e=vP(),r=Ei();return fx=function(t,n,a){return a.get&&e(a.get,n,{getter:!0}),a.set&&e(a.set,n,{setter:!0}),r.f(t,n,a)},fx}var mx,gA;function mie(){if(gA)return mx;gA=1;var e=Ns(),r=fie(),t=dt(),n=qn(),a=t("species");return mx=function(i){var s=e(i);n&&s&&!s[a]&&r(s,a,{configurable:!0,get:function(){return this}})},mx}var dx,bA;function die(){if(bA)return dx;bA=1;var e=Vf(),r=TypeError;return dx=function(t,n){if(e(n,t))return t;throw new r("Incorrect invocation")},dx}var hx,NA;function hie(){if(NA)return hx;NA=1;var e=dt(),r=e("toStringTag"),t={};return t[r]="z",hx=String(t)==="[object z]",hx}var px,yA;function BN(){if(yA)return px;yA=1;var e=hie(),r=Gr(),t=bs(),n=dt(),a=n("toStringTag"),i=Object,s=t((function(){return arguments})())==="Arguments",o=function(u,l){try{return u[l]}catch{}};return px=e?t:function(u){var l,c,f;return u===void 0?"Undefined":u===null?"Null":typeof(c=o(l=i(u),a))=="string"?c:s?t(l):(f=t(l))==="Object"&&r(l.callee)?"Arguments":f},px}var vx,CA;function pie(){if(CA)return vx;CA=1;var e=zr(),r=Hr(),t=Gr(),n=BN(),a=Ns(),i=PN(),s=function(){},o=a("Reflect","construct"),u=/^\s*(?:class|function)\b/,l=e(u.exec),c=!u.test(s),f=function(v){if(!t(v))return!1;try{return o(s,[],v),!0}catch{return!1}},h=function(v){if(!t(v))return!1;switch(n(v)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return c||!!l(u,i(v))}catch{return!0}};return h.sham=!0,vx=!o||r(function(){var d;return f(f.call)||!f(Object)||!f(function(){d=!0})||d})?h:f,vx}var xx,EA;function vie(){if(EA)return xx;EA=1;var e=pie(),r=Mf(),t=TypeError;return xx=function(n){if(e(n))return n;throw new t(r(n)+" is not a constructor")},xx}var gx,wA;function CP(){if(wA)return gx;wA=1;var e=Pt(),r=vie(),t=Pf(),n=dt(),a=n("species");return gx=function(i,s){var o=e(i).constructor,u;return o===void 0||t(u=e(o)[a])?s:r(u)},gx}var bx,_A;function EP(){if(_A)return bx;_A=1;var e=If(),r=Function.prototype,t=r.apply,n=r.call;return bx=typeof Reflect=="object"&&Reflect.apply||(e?n.bind(t):function(){return n.apply(t,arguments)}),bx}var Nx,SA;function Wf(){if(SA)return Nx;SA=1;var e=bs(),r=zr();return Nx=function(t){if(e(t)==="Function")return r(t)},Nx}var yx,TA;function qN(){if(TA)return yx;TA=1;var e=Wf(),r=za(),t=If(),n=e(e.bind);return yx=function(a,i){return r(a),i===void 0?a:t?n(a,i):function(){return a.apply(i,arguments)}},yx}var Cx,DA;function wP(){if(DA)return Cx;DA=1;var e=Ns();return Cx=e("document","documentElement"),Cx}var Ex,AA;function xie(){if(AA)return Ex;AA=1;var e=zr();return Ex=e([].slice),Ex}var wx,kA;function gie(){if(kA)return wx;kA=1;var e=TypeError;return wx=function(r,t){if(r<t)throw new e("Not enough arguments");return r},wx}var _x,RA;function _P(){if(RA)return _x;RA=1;var e=cu();return _x=/(?:ipad|iphone|ipod).*applewebkit/i.test(e),_x}var Sx,OA;function SP(){if(OA)return Sx;OA=1;var e=Ur(),r=EP(),t=qN(),n=Gr(),a=zn(),i=Hr(),s=wP(),o=xie(),u=Lf(),l=gie(),c=_P(),f=$f(),h=e.setImmediate,d=e.clearImmediate,v=e.process,p=e.Dispatch,x=e.Function,g=e.MessageChannel,N=e.String,b=0,y={},_="onreadystatechange",w,C,k,D;i(function(){w=e.location});var U=function(B){if(a(y,B)){var G=y[B];delete y[B],G()}},F=function(B){return function(){U(B)}},L=function(B){U(B.data)},P=function(B){e.postMessage(N(B),w.protocol+"//"+w.host)};return(!h||!d)&&(h=function(G){l(arguments.length,1);var ue=n(G)?G:x(G),oe=o(arguments,1);return y[++b]=function(){r(ue,void 0,oe)},C(b),b},d=function(G){delete y[G]},f?C=function(B){v.nextTick(F(B))}:p&&p.now?C=function(B){p.now(F(B))}:g&&!c?(k=new g,D=k.port2,k.port1.onmessage=L,C=t(D.postMessage,D)):e.addEventListener&&n(e.postMessage)&&!e.importScripts&&w&&w.protocol!=="file:"&&!i(P)?(C=P,e.addEventListener("message",L,!1)):_ in u("script")?C=function(B){s.appendChild(u("script"))[_]=function(){s.removeChild(this),U(B)}}:C=function(B){setTimeout(F(B),0)}),Sx={set:h,clear:d},Sx}var Tx,FA;function bie(){if(FA)return Tx;FA=1;var e=Ur(),r=qn(),t=Object.getOwnPropertyDescriptor;return Tx=function(n){if(!r)return e[n];var a=t(e,n);return a&&a.value},Tx}var Dx,UA;function TP(){if(UA)return Dx;UA=1;var e=function(){this.head=null,this.tail=null};return e.prototype={add:function(r){var t={item:r,next:null},n=this.tail;n?n.next=t:this.head=t,this.tail=t},get:function(){var r=this.head;if(r){var t=this.head=r.next;return t===null&&(this.tail=null),r.item}}},Dx=e,Dx}var Ax,IA;function Nie(){if(IA)return Ax;IA=1;var e=cu();return Ax=/ipad|iphone|ipod/i.test(e)&&typeof Pebble<"u",Ax}var kx,PA;function yie(){if(PA)return kx;PA=1;var e=cu();return kx=/web0s(?!.*chrome)/i.test(e),kx}var Rx,VA;function Cie(){if(VA)return Rx;VA=1;var e=Ur(),r=bie(),t=qN(),n=SP().set,a=TP(),i=_P(),s=Nie(),o=yie(),u=$f(),l=e.MutationObserver||e.WebKitMutationObserver,c=e.document,f=e.process,h=e.Promise,d=r("queueMicrotask"),v,p,x,g,N;if(!d){var b=new a,y=function(){var _,w;for(u&&(_=f.domain)&&_.exit();w=b.get();)try{w()}catch(C){throw b.head&&v(),C}_&&_.enter()};!i&&!u&&!o&&l&&c?(p=!0,x=c.createTextNode(""),new l(y).observe(x,{characterData:!0}),v=function(){x.data=p=!p}):!s&&h&&h.resolve?(g=h.resolve(void 0),g.constructor=h,N=t(g.then,g),v=function(){N(y)}):u?v=function(){f.nextTick(y)}:(n=t(n,e),v=function(){n(y)}),d=function(_){b.head||v(),b.add(_)}}return Rx=d,Rx}var Ox,MA;function Eie(){return MA||(MA=1,Ox=function(e,r){try{arguments.length===1?console.error(e):console.error(e,r)}catch{}}),Ox}var Fx,jA;function HN(){return jA||(jA=1,Fx=function(e){try{return{error:!1,value:e()}}catch(r){return{error:!0,value:r}}}),Fx}var Ux,LA;function mu(){if(LA)return Ux;LA=1;var e=Ur();return Ux=e.Promise,Ux}var Ix,BA;function du(){if(BA)return Ix;BA=1;var e=Ur(),r=mu(),t=Gr(),n=bP(),a=PN(),i=dt(),s=NP(),o=ma(),u=ON(),l=r&&r.prototype,c=i("species"),f=!1,h=t(e.PromiseRejectionEvent),d=n("Promise",function(){var v=a(r),p=v!==String(r);if(!p&&u===66||o&&!(l.catch&&l.finally))return!0;if(!u||u<51||!/native code/.test(v)){var x=new r(function(b){b(1)}),g=function(b){b(function(){},function(){})},N=x.constructor={};if(N[c]=g,f=x.then(function(){})instanceof g,!f)return!0}return!p&&(s==="BROWSER"||s==="DENO")&&!h});return Ix={CONSTRUCTOR:d,REJECTION_EVENT:h,SUBCLASSING:f},Ix}var Px={},qA;function hu(){if(qA)return Px;qA=1;var e=za(),r=TypeError,t=function(n){var a,i;this.promise=new n(function(s,o){if(a!==void 0||i!==void 0)throw new r("Bad Promise constructor");a=s,i=o}),this.resolve=e(a),this.reject=e(i)};return Px.f=function(n){return new t(n)},Px}var HA;function wie(){if(HA)return QT;HA=1;var e=Vt(),r=ma(),t=$f(),n=Ur(),a=oie(),i=Nt(),s=ys(),o=yP(),u=Gf(),l=mie(),c=za(),f=Gr(),h=Yt(),d=die(),v=CP(),p=SP().set,x=Cie(),g=Eie(),N=HN(),b=TP(),y=Hf(),_=mu(),w=du(),C=hu(),k="Promise",D=w.CONSTRUCTOR,U=w.REJECTION_EVENT,F=w.SUBCLASSING,L=y.getterFor(k),P=y.set,B=_&&_.prototype,G=_,ue=B,oe=n.TypeError,he=n.document,fe=n.process,S=C.f,re=S,T=!!(he&&he.createEvent&&n.dispatchEvent),E="unhandledrejection",V="rejectionhandled",I=0,Y=1,ie=2,le=1,X=2,Q,be,ee,Ie,Te=function(Ne){var je;return h(Ne)&&f(je=Ne.then)?je:!1},Ye=function(Ne,je){var Z=je.value,J=je.state===Y,xe=J?Ne.ok:Ne.fail,Le=Ne.resolve,pe=Ne.reject,ke=Ne.domain,Ve,Ke,ar;try{xe?(J||(je.rejection===X&&$r(je),je.rejection=le),xe===!0?Ve=Z:(ke&&ke.enter(),Ve=xe(Z),ke&&(ke.exit(),ar=!0)),Ve===Ne.promise?pe(new oe("Promise-chain cycle")):(Ke=Te(Ve))?i(Ke,Ve,Le,pe):Le(Ve)):pe(Z)}catch(Er){ke&&!ar&&ke.exit(),pe(Er)}},Be=function(Ne,je){Ne.notified||(Ne.notified=!0,x(function(){for(var Z=Ne.reactions,J;J=Z.get();)Ye(J,Ne);Ne.notified=!1,je&&!Ne.rejection&&xr(Ne)}))},Ee=function(Ne,je,Z){var J,xe;T?(J=he.createEvent("Event"),J.promise=je,J.reason=Z,J.initEvent(Ne,!1,!0),n.dispatchEvent(J)):J={promise:je,reason:Z},!U&&(xe=n["on"+Ne])?xe(J):Ne===E&&g("Unhandled promise rejection",Z)},xr=function(Ne){i(p,n,function(){var je=Ne.facade,Z=Ne.value,J=Wr(Ne),xe;if(J&&(xe=N(function(){t?fe.emit("unhandledRejection",Z,je):Ee(E,je,Z)}),Ne.rejection=t||Wr(Ne)?X:le,xe.error))throw xe.value})},Wr=function(Ne){return Ne.rejection!==le&&!Ne.parent},$r=function(Ne){i(p,n,function(){var je=Ne.facade;t?fe.emit("rejectionHandled",je):Ee(V,je,Ne.value)})},Nr=function(Ne,je,Z){return function(J){Ne(je,J,Z)}},Tr=function(Ne,je,Z){Ne.done||(Ne.done=!0,Z&&(Ne=Z),Ne.value=je,Ne.state=ie,Be(Ne,!0))},Yr=function(Ne,je,Z){if(!Ne.done){Ne.done=!0,Z&&(Ne=Z);try{if(Ne.facade===je)throw new oe("Promise can't be resolved itself");var J=Te(je);J?x(function(){var xe={done:!1};try{i(J,je,Nr(Yr,xe,Ne),Nr(Tr,xe,Ne))}catch(Le){Tr(xe,Le,Ne)}}):(Ne.value=je,Ne.state=Y,Be(Ne,!1))}catch(xe){Tr({done:!1},xe,Ne)}}};if(D&&(G=function(je){d(this,ue),c(je),i(Q,this);var Z=L(this);try{je(Nr(Yr,Z),Nr(Tr,Z))}catch(J){Tr(Z,J)}},ue=G.prototype,Q=function(je){P(this,{type:k,done:!1,notified:!1,parent:!1,reactions:new b,rejection:!1,state:I,value:null})},Q.prototype=s(ue,"then",function(je,Z){var J=L(this),xe=S(v(this,G));return J.parent=!0,xe.ok=f(je)?je:!0,xe.fail=f(Z)&&Z,xe.domain=t?fe.domain:void 0,J.state===I?J.reactions.add(xe):x(function(){Ye(xe,J)}),xe.promise}),be=function(){var Ne=new Q,je=L(Ne);this.promise=Ne,this.resolve=Nr(Yr,je),this.reject=Nr(Tr,je)},C.f=S=function(Ne){return Ne===G||Ne===ee?new be(Ne):re(Ne)},!r&&f(_)&&B!==Object.prototype)){Ie=B.then,F||s(B,"then",function(je,Z){var J=this;return new G(function(xe,Le){i(Ie,J,xe,Le)}).then(je,Z)},{unsafe:!0});try{delete B.constructor}catch{}o&&o(B,ue)}return e({global:!0,constructor:!0,wrap:!0,forced:D},{Promise:G}),ee=a.Promise,u(G,k,!1,!0),l(k),QT}var zA={},Vx,$A;function pu(){return $A||($A=1,Vx={}),Vx}var Mx,GA;function _ie(){if(GA)return Mx;GA=1;var e=dt(),r=pu(),t=e("iterator"),n=Array.prototype;return Mx=function(a){return a!==void 0&&(r.Array===a||n[t]===a)},Mx}var jx,WA;function DP(){if(WA)return jx;WA=1;var e=BN(),r=_o(),t=Pf(),n=pu(),a=dt(),i=a("iterator");return jx=function(s){if(!t(s))return r(s,i)||r(s,"@@iterator")||n[e(s)]},jx}var Lx,YA;function Sie(){if(YA)return Lx;YA=1;var e=Nt(),r=za(),t=Pt(),n=Mf(),a=DP(),i=TypeError;return Lx=function(s,o){var u=arguments.length<2?a(s):o;if(r(u))return t(e(u,s));throw new i(n(s)+" is not iterable")},Lx}var Bx,KA;function Tie(){if(KA)return Bx;KA=1;var e=Nt(),r=Pt(),t=_o();return Bx=function(n,a,i){var s,o;r(n);try{if(s=t(n,"return"),!s){if(a==="throw")throw i;return i}s=e(s,n)}catch(u){o=!0,s=u}if(a==="throw")throw i;if(o)throw s;return r(s),i},Bx}var qx,XA;function AP(){if(XA)return qx;XA=1;var e=qN(),r=Nt(),t=Pt(),n=Mf(),a=_ie(),i=jN(),s=Vf(),o=Sie(),u=DP(),l=Tie(),c=TypeError,f=function(d,v){this.stopped=d,this.result=v},h=f.prototype;return qx=function(d,v,p){var x=p&&p.that,g=!!(p&&p.AS_ENTRIES),N=!!(p&&p.IS_RECORD),b=!!(p&&p.IS_ITERATOR),y=!!(p&&p.INTERRUPTED),_=e(v,x),w,C,k,D,U,F,L,P=function(G){return w&&l(w,"normal"),new f(!0,G)},B=function(G){return g?(t(G),y?_(G[0],G[1],P):_(G[0],G[1])):y?_(G,P):_(G)};if(N)w=d.iterator;else if(b)w=d;else{if(C=u(d),!C)throw new c(n(d)+" is not iterable");if(a(C)){for(k=0,D=i(d);D>k;k++)if(U=B(d[k]),U&&s(h,U))return U;return new f(!1)}w=o(d,C)}for(F=N?d.next:w.next;!(L=r(F,w)).done;){try{U=B(L.value)}catch(G){l(w,"throw",G)}if(typeof U=="object"&&U&&s(h,U))return U}return new f(!1)},qx}var Hx,QA;function Die(){if(QA)return Hx;QA=1;var e=dt(),r=e("iterator"),t=!1;try{var n=0,a={next:function(){return{done:!!n++}},return:function(){t=!0}};a[r]=function(){return this},Array.from(a,function(){throw 2})}catch{}return Hx=function(i,s){try{if(!s&&!t)return!1}catch{return!1}var o=!1;try{var u={};u[r]=function(){return{next:function(){return{done:o=!0}}}},i(u)}catch{}return o},Hx}var zx,ZA;function kP(){if(ZA)return zx;ZA=1;var e=mu(),r=Die(),t=du().CONSTRUCTOR;return zx=t||!r(function(n){e.all(n).then(void 0,function(){})}),zx}var JA;function Aie(){if(JA)return zA;JA=1;var e=Vt(),r=Nt(),t=za(),n=hu(),a=HN(),i=AP(),s=kP();return e({target:"Promise",stat:!0,forced:s},{all:function(u){var l=this,c=n.f(l),f=c.resolve,h=c.reject,d=a(function(){var v=t(l.resolve),p=[],x=0,g=1;i(u,function(N){var b=x++,y=!1;g++,r(v,l,N).then(function(_){y||(y=!0,p[b]=_,--g||f(p))},h)}),--g||f(p)});return d.error&&h(d.value),c.promise}}),zA}var e3={},r3;function kie(){if(r3)return e3;r3=1;var e=Vt(),r=ma(),t=du().CONSTRUCTOR,n=mu(),a=Ns(),i=Gr(),s=ys(),o=n&&n.prototype;if(e({target:"Promise",proto:!0,forced:t,real:!0},{catch:function(l){return this.then(void 0,l)}}),!r&&i(n)){var u=a("Promise").prototype.catch;o.catch!==u&&s(o,"catch",u,{unsafe:!0})}return e3}var t3={},n3;function Rie(){if(n3)return t3;n3=1;var e=Vt(),r=Nt(),t=za(),n=hu(),a=HN(),i=AP(),s=kP();return e({target:"Promise",stat:!0,forced:s},{race:function(u){var l=this,c=n.f(l),f=c.reject,h=a(function(){var d=t(l.resolve);i(u,function(v){r(d,l,v).then(c.resolve,f)})});return h.error&&f(h.value),c.promise}}),t3}var a3={},i3;function Oie(){if(i3)return a3;i3=1;var e=Vt(),r=hu(),t=du().CONSTRUCTOR;return e({target:"Promise",stat:!0,forced:t},{reject:function(a){var i=r.f(this),s=i.reject;return s(a),i.promise}}),a3}var s3={},$x,o3;function Fie(){if(o3)return $x;o3=1;var e=Pt(),r=Yt(),t=hu();return $x=function(n,a){if(e(n),r(a)&&a.constructor===n)return a;var i=t.f(n),s=i.resolve;return s(a),i.promise},$x}var l3;function Uie(){if(l3)return s3;l3=1;var e=Vt(),r=Ns(),t=ma(),n=mu(),a=du().CONSTRUCTOR,i=Fie(),s=r("Promise"),o=t&&!a;return e({target:"Promise",stat:!0,forced:t||a},{resolve:function(l){return i(o&&this===s?n:this,l)}}),s3}var u3;function Iie(){return u3||(u3=1,wie(),Aie(),kie(),Rie(),Oie(),Uie()),XT}Iie();function c3(e,r,t,n,a,i,s){try{var o=e[i](s),u=o.value}catch(l){return void t(l)}o.done?r(u):Promise.resolve(u).then(n,a)}function Va(e){return function(){var r=this,t=arguments;return new Promise(function(n,a){var i=e.apply(r,t);function s(u){c3(i,n,a,s,o,"next",u)}function o(u){c3(i,n,a,s,o,"throw",u)}s(void 0)})}}var f3={},m3={},Gx,d3;function da(){if(d3)return Gx;d3=1;var e=BN(),r=String;return Gx=function(t){if(e(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return r(t)},Gx}var Wx,h3;function RP(){if(h3)return Wx;h3=1;var e=Pt();return Wx=function(){var r=e(this),t="";return r.hasIndices&&(t+="d"),r.global&&(t+="g"),r.ignoreCase&&(t+="i"),r.multiline&&(t+="m"),r.dotAll&&(t+="s"),r.unicode&&(t+="u"),r.unicodeSets&&(t+="v"),r.sticky&&(t+="y"),t},Wx}var Yx,p3;function OP(){if(p3)return Yx;p3=1;var e=Hr(),r=Ur(),t=r.RegExp,n=e(function(){var s=t("a","y");return s.lastIndex=2,s.exec("abcd")!==null}),a=n||e(function(){return!t("a","y").sticky}),i=n||e(function(){var s=t("^r","gy");return s.lastIndex=2,s.exec("str")!==null});return Yx={BROKEN_CARET:i,MISSED_STICKY:a,UNSUPPORTED_Y:n},Yx}var Kx={},Xx,v3;function Pie(){if(v3)return Xx;v3=1;var e=gP(),r=LN();return Xx=Object.keys||function(n){return e(n,r)},Xx}var x3;function Vie(){if(x3)return Kx;x3=1;var e=qn(),r=pP(),t=Ei(),n=Pt(),a=uu(),i=Pie();return Kx.f=e&&!r?Object.defineProperties:function(o,u){n(o);for(var l=a(u),c=i(u),f=c.length,h=0,d;f>h;)t.f(o,d=c[h++],l[d]);return o},Kx}var Qx,g3;function Yf(){if(g3)return Qx;g3=1;var e=Pt(),r=Vie(),t=LN(),n=MN(),a=wP(),i=Lf(),s=VN(),o=">",u="<",l="prototype",c="script",f=s("IE_PROTO"),h=function(){},d=function(N){return u+c+o+N+u+"/"+c+o},v=function(N){N.write(d("")),N.close();var b=N.parentWindow.Object;return N=null,b},p=function(){var N=i("iframe"),b="java"+c+":",y;return N.style.display="none",a.appendChild(N),N.src=String(b),y=N.contentWindow.document,y.open(),y.write(d("document.F=Object")),y.close(),y.F},x,g=function(){try{x=new ActiveXObject("htmlfile")}catch{}g=typeof document<"u"?document.domain&&x?v(x):p():v(x);for(var N=t.length;N--;)delete g[l][t[N]];return g()};return n[f]=!0,Qx=Object.create||function(b,y){var _;return b!==null?(h[l]=e(b),_=new h,h[l]=null,_[f]=b):_=g(),y===void 0?_:r.f(_,y)},Qx}var Zx,b3;function Mie(){if(b3)return Zx;b3=1;var e=Hr(),r=Ur(),t=r.RegExp;return Zx=e(function(){var n=t(".","s");return!(n.dotAll&&n.test(`
`)&&n.flags==="s")}),Zx}var Jx,N3;function jie(){if(N3)return Jx;N3=1;var e=Hr(),r=Ur(),t=r.RegExp;return Jx=e(function(){var n=t("(?<a>b)","g");return n.exec("b").groups.a!=="b"||"b".replace(n,"$<a>c")!=="bc"}),Jx}var eg,y3;function zN(){if(y3)return eg;y3=1;var e=Nt(),r=zr(),t=da(),n=RP(),a=OP(),i=IN(),s=Yf(),o=Hf().get,u=Mie(),l=jie(),c=i("native-string-replace",String.prototype.replace),f=RegExp.prototype.exec,h=f,d=r("".charAt),v=r("".indexOf),p=r("".replace),x=r("".slice),g=(function(){var _=/a/,w=/b*/g;return e(f,_,"a"),e(f,w,"a"),_.lastIndex!==0||w.lastIndex!==0})(),N=a.BROKEN_CARET,b=/()??/.exec("")[1]!==void 0,y=g||b||N||u||l;return y&&(h=function(w){var C=this,k=o(C),D=t(w),U=k.raw,F,L,P,B,G,ue,oe;if(U)return U.lastIndex=C.lastIndex,F=e(h,U,D),C.lastIndex=U.lastIndex,F;var he=k.groups,fe=N&&C.sticky,S=e(n,C),re=C.source,T=0,E=D;if(fe&&(S=p(S,"y",""),v(S,"g")===-1&&(S+="g"),E=x(D,C.lastIndex),C.lastIndex>0&&(!C.multiline||C.multiline&&d(D,C.lastIndex-1)!==`
`)&&(re="(?: "+re+")",E=" "+E,T++),L=new RegExp("^(?:"+re+")",S)),b&&(L=new RegExp("^"+re+"$(?!\\s)",S)),g&&(P=C.lastIndex),B=e(f,fe?L:C,E),fe?B?(B.input=x(B.input,T),B[0]=x(B[0],T),B.index=C.lastIndex,C.lastIndex+=B[0].length):C.lastIndex=0:g&&B&&(C.lastIndex=C.global?B.index+B[0].length:P),b&&B&&B.length>1&&e(c,B[0],L,function(){for(G=1;G<arguments.length-2;G++)arguments[G]===void 0&&(B[G]=void 0)}),B&&he)for(B.groups=ue=s(null),G=0;G<he.length;G++)oe=he[G],ue[oe[0]]=B[oe[1]];return B}),eg=h,eg}var C3;function Lie(){if(C3)return m3;C3=1;var e=Vt(),r=zN();return e({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r}),m3}var rg,E3;function $N(){if(E3)return rg;E3=1,Lie();var e=Nt(),r=ys(),t=zN(),n=Hr(),a=dt(),i=fu(),s=a("species"),o=RegExp.prototype;return rg=function(u,l,c,f){var h=a(u),d=!n(function(){var g={};return g[h]=function(){return 7},""[u](g)!==7}),v=d&&!n(function(){var g=!1,N=/a/;return u==="split"&&(N={},N.constructor={},N.constructor[s]=function(){return N},N.flags="",N[h]=/./[h]),N.exec=function(){return g=!0,null},N[h](""),!g});if(!d||!v||c){var p=/./[h],x=l(h,""[u],function(g,N,b,y,_){var w=N.exec;return w===t||w===o.exec?d&&!_?{done:!0,value:e(p,N,b,y)}:{done:!0,value:e(g,b,N,y)}:{done:!1}});r(String.prototype,u,x[0]),r(o,h,x[1])}f&&i(o[h],"sham",!0)},rg}var tg,w3;function Bie(){if(w3)return tg;w3=1;var e=zr(),r=zf(),t=da(),n=Hn(),a=e("".charAt),i=e("".charCodeAt),s=e("".slice),o=function(u){return function(l,c){var f=t(n(l)),h=r(c),d=f.length,v,p;return h<0||h>=d?u?"":void 0:(v=i(f,h),v<55296||v>56319||h+1===d||(p=i(f,h+1))<56320||p>57343?u?a(f,h):v:u?s(f,h,h+2):(v-55296<<10)+(p-56320)+65536)}};return tg={codeAt:o(!1),charAt:o(!0)},tg}var ng,_3;function GN(){if(_3)return ng;_3=1;var e=Bie().charAt;return ng=function(r,t,n){return t+(n?e(r,t).length:1)},ng}var ag,S3;function qie(){if(S3)return ag;S3=1;var e=Ur(),r=Hr(),t=e.RegExp,n=!r(function(){var a=!0;try{t(".","d")}catch{a=!1}var i={},s="",o=a?"dgimsy":"gimsy",u=function(h,d){Object.defineProperty(i,h,{get:function(){return s+=d,!0}})},l={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};a&&(l.hasIndices="d");for(var c in l)u(c,l[c]);var f=Object.getOwnPropertyDescriptor(t.prototype,"flags").get.call(i);return f!==o||s!==o});return ag={correct:n},ag}var ig,T3;function WN(){if(T3)return ig;T3=1;var e=Nt(),r=zn(),t=Vf(),n=qie(),a=RP(),i=RegExp.prototype;return ig=n.correct?function(s){return s.flags}:function(s){return!n.correct&&t(i,s)&&!r(s,"flags")?e(a,s):s.flags},ig}var sg,D3;function YN(){if(D3)return sg;D3=1;var e=Nt(),r=Pt(),t=Gr(),n=bs(),a=zN(),i=TypeError;return sg=function(s,o){var u=s.exec;if(t(u)){var l=e(u,s,o);return l!==null&&r(l),l}if(n(s)==="RegExp")return e(a,s,o);throw new i("RegExp#exec called on incompatible receiver")},sg}var A3;function Hie(){if(A3)return f3;A3=1;var e=Nt(),r=zr(),t=$N(),n=Pt(),a=Yt(),i=So(),s=da(),o=Hn(),u=_o(),l=GN(),c=WN(),f=YN(),h=r("".indexOf);return t("match",function(d,v,p){return[function(g){var N=o(this),b=a(g)?u(g,d):void 0;return b?e(b,g,N):new RegExp(g)[d](s(N))},function(x){var g=n(this),N=s(x),b=p(v,g,N);if(b.done)return b.value;var y=s(c(g));if(h(y,"g")===-1)return f(g,N);var _=h(y,"u")!==-1;g.lastIndex=0;for(var w=[],C=0,k;(k=f(g,N))!==null;){var D=s(k[0]);w[C]=D,D===""&&(g.lastIndex=l(N,i(g.lastIndex),_)),C++}return C===0?null:w}]}),f3}Hie();var k3={},og,R3;function zie(){if(R3)return og;R3=1;var e=zr(),r=jf(),t=Math.floor,n=e("".charAt),a=e("".replace),i=e("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,o=/\$([$&'`]|\d{1,2})/g;return og=function(u,l,c,f,h,d){var v=c+u.length,p=f.length,x=o;return h!==void 0&&(h=r(h),x=s),a(d,x,function(g,N){var b;switch(n(N,0)){case"$":return"$";case"&":return u;case"`":return i(l,0,c);case"'":return i(l,v);case"<":b=h[i(N,1,-1)];break;default:var y=+N;if(y===0)return g;if(y>p){var _=t(y/10);return _===0?g:_<=p?f[_-1]===void 0?n(N,1):f[_-1]+n(N,1):g}b=f[y-1]}return b===void 0?"":b})},og}var O3;function $ie(){if(O3)return k3;O3=1;var e=EP(),r=Nt(),t=zr(),n=$N(),a=Hr(),i=Pt(),s=Gr(),o=Yt(),u=zf(),l=So(),c=da(),f=Hn(),h=GN(),d=_o(),v=zie(),p=WN(),x=YN(),g=dt(),N=g("replace"),b=Math.max,y=Math.min,_=t([].concat),w=t([].push),C=t("".indexOf),k=t("".slice),D=function(P){return P===void 0?P:String(P)},U=(function(){return"a".replace(/./,"$0")==="$0"})(),F=(function(){return/./[N]?/./[N]("a","$0")==="":!1})(),L=!a(function(){var P=/./;return P.exec=function(){var B=[];return B.groups={a:"7"},B},"".replace(P,"$<a>")!=="7"});return n("replace",function(P,B,G){var ue=F?"$":"$0";return[function(he,fe){var S=f(this),re=o(he)?d(he,N):void 0;return re?r(re,he,S,fe):r(B,c(S),he,fe)},function(oe,he){var fe=i(this),S=c(oe);if(typeof he=="string"&&C(he,ue)===-1&&C(he,"$<")===-1){var re=G(B,fe,S,he);if(re.done)return re.value}var T=s(he);T||(he=c(he));var E=c(p(fe)),V=C(E,"g")!==-1,I;V&&(I=C(E,"u")!==-1,fe.lastIndex=0);for(var Y=[],ie;ie=x(fe,S),!(ie===null||(w(Y,ie),!V));){var le=c(ie[0]);le===""&&(fe.lastIndex=h(S,l(fe.lastIndex),I))}for(var X="",Q=0,be=0;be<Y.length;be++){ie=Y[be];for(var ee=c(ie[0]),Ie=b(y(u(ie.index),S.length),0),Te=[],Ye,Be=1;Be<ie.length;Be++)w(Te,D(ie[Be]));var Ee=ie.groups;if(T){var xr=_([ee],Te,Ie,S);Ee!==void 0&&w(xr,Ee),Ye=c(e(he,void 0,xr))}else Ye=v(ee,S,Ie,Te,Ee,he);Ie>=Q&&(X+=k(S,Q,Ie)+Ye,Q=Ie+ee.length)}return X+k(S,Q)}]},!L||!U||F),k3}$ie();var F3={},lg,U3;function Gie(){if(U3)return lg;U3=1;var e=Yt(),r=bs(),t=dt(),n=t("match");return lg=function(a){var i;return e(a)&&((i=a[n])!==void 0?!!i:r(a)==="RegExp")},lg}var ug,I3;function KN(){if(I3)return ug;I3=1;var e=Gie(),r=TypeError;return ug=function(t){if(e(t))throw new r("The method doesn't accept regular expressions");return t},ug}var cg,P3;function XN(){if(P3)return cg;P3=1;var e=dt(),r=e("match");return cg=function(t){var n=/./;try{"/./"[t](n)}catch{try{return n[r]=!1,"/./"[t](n)}catch{}}return!1},cg}var V3;function Wie(){if(V3)return F3;V3=1;var e=Vt(),r=Wf(),t=Bf().f,n=So(),a=da(),i=KN(),s=Hn(),o=XN(),u=ma(),l=r("".slice),c=Math.min,f=o("startsWith"),h=!u&&!f&&!!(function(){var d=t(String.prototype,"startsWith");return d&&!d.writable})();return e({target:"String",proto:!0,forced:!h&&!f},{startsWith:function(v){var p=a(s(this));i(v);var x=n(c(arguments.length>1?arguments[1]:void 0,p.length)),g=a(v);return l(p,x,x+g.length)===g}}),F3}Wie();var fg,M3;function Yie(){if(M3)return fg;M3=1;var e=dt(),r=Yf(),t=Ei().f,n=e("unscopables"),a=Array.prototype;return a[n]===void 0&&t(a,n,{configurable:!0,value:r(null)}),fg=function(i){a[n][i]=!0},fg}var mg,j3;function Kie(){if(j3)return mg;j3=1;var e=Hr();return mg=!e(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),mg}var dg,L3;function FP(){if(L3)return dg;L3=1;var e=zn(),r=Gr(),t=jf(),n=VN(),a=Kie(),i=n("IE_PROTO"),s=Object,o=s.prototype;return dg=a?s.getPrototypeOf:function(u){var l=t(u);if(e(l,i))return l[i];var c=l.constructor;return r(c)&&l instanceof c?c.prototype:l instanceof s?o:null},dg}var hg,B3;function UP(){if(B3)return hg;B3=1;var e=Hr(),r=Gr(),t=Yt(),n=Yf(),a=FP(),i=ys(),s=dt(),o=ma(),u=s("iterator"),l=!1,c,f,h;[].keys&&(h=[].keys(),"next"in h?(f=a(a(h)),f!==Object.prototype&&(c=f)):l=!0);var d=!t(c)||e(function(){var v={};return c[u].call(v)!==v});return d?c={}:o&&(c=n(c)),r(c[u])||i(c,u,function(){return this}),hg={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:l},hg}var pg,q3;function Xie(){if(q3)return pg;q3=1;var e=UP().IteratorPrototype,r=Yf(),t=RN(),n=Gf(),a=pu(),i=function(){return this};return pg=function(s,o,u,l){var c=o+" Iterator";return s.prototype=r(e,{next:t(+!l,u)}),n(s,c,!1,!0),a[c]=i,s},pg}var vg,H3;function Qie(){if(H3)return vg;H3=1;var e=Vt(),r=Nt(),t=ma(),n=qf(),a=Gr(),i=Xie(),s=FP(),o=yP(),u=Gf(),l=fu(),c=ys(),f=dt(),h=pu(),d=UP(),v=n.PROPER,p=n.CONFIGURABLE,x=d.IteratorPrototype,g=d.BUGGY_SAFARI_ITERATORS,N=f("iterator"),b="keys",y="values",_="entries",w=function(){return this};return vg=function(C,k,D,U,F,L,P){i(D,k,U);var B=function(V){if(V===F&&fe)return fe;if(!g&&V&&V in oe)return oe[V];switch(V){case b:return function(){return new D(this,V)};case y:return function(){return new D(this,V)};case _:return function(){return new D(this,V)}}return function(){return new D(this)}},G=k+" Iterator",ue=!1,oe=C.prototype,he=oe[N]||oe["@@iterator"]||F&&oe[F],fe=!g&&he||B(F),S=k==="Array"&&oe.entries||he,re,T,E;if(S&&(re=s(S.call(new C)),re!==Object.prototype&&re.next&&(!t&&s(re)!==x&&(o?o(re,x):a(re[N])||c(re,N,w)),u(re,G,!0,!0),t&&(h[G]=w))),v&&F===y&&he&&he.name!==y&&(!t&&p?l(oe,"name",y):(ue=!0,fe=function(){return r(he,this)})),F)if(T={values:B(y),keys:L?fe:B(b),entries:B(_)},P)for(E in T)(g||ue||!(E in oe))&&c(oe,E,T[E]);else e({target:k,proto:!0,forced:g||ue},T);return(!t||P)&&oe[N]!==fe&&c(oe,N,fe,{name:F}),h[k]=fe,T},vg}var xg,z3;function Zie(){return z3||(z3=1,xg=function(e,r){return{value:e,done:r}}),xg}var gg,$3;function IP(){if($3)return gg;$3=1;var e=uu(),r=Yie(),t=pu(),n=Hf(),a=Ei().f,i=Qie(),s=Zie(),o=ma(),u=qn(),l="Array Iterator",c=n.set,f=n.getterFor(l);gg=i(Array,"Array",function(d,v){c(this,{type:l,target:e(d),index:0,kind:v})},function(){var d=f(this),v=d.target,p=d.index++;if(!v||p>=v.length)return d.target=null,s(void 0,!0);switch(d.kind){case"keys":return s(p,!1);case"values":return s(v[p],!1)}return s([p,v[p]],!1)},"values");var h=t.Arguments=t.Array;if(r("keys"),r("values"),r("entries"),!o&&u&&h.name!=="values")try{a(h,"name",{value:"values"})}catch{}return gg}IP();var G3={},bg,W3;function Jie(){return W3||(W3=1,bg={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}),bg}var Ng,Y3;function ese(){if(Y3)return Ng;Y3=1;var e=Lf(),r=e("span").classList,t=r&&r.constructor&&r.constructor.prototype;return Ng=t===Object.prototype?void 0:t,Ng}var K3;function rse(){if(K3)return G3;K3=1;var e=Ur(),r=Jie(),t=ese(),n=IP(),a=fu(),i=Gf(),s=dt(),o=s("iterator"),u=n.values,l=function(f,h){if(f){if(f[o]!==u)try{a(f,o,u)}catch{f[o]=u}if(i(f,h,!0),r[h]){for(var d in n)if(f[d]!==n[d])try{a(f,d,n[d])}catch{f[d]=n[d]}}}};for(var c in r)l(e[c]&&e[c].prototype,c);return l(t,"DOMTokenList"),G3}rse();function tse(e,r){if(Fl(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(Fl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function nse(e){var r=tse(e,"string");return Fl(r)=="symbol"?r:r+""}function QN(e,r,t){return(r=nse(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var X3={},yg,Q3;function ase(){if(Q3)return yg;Q3=1;var e=za(),r=jf(),t=lP(),n=jN(),a=TypeError,i="Reduce of empty array with no initial value",s=function(o){return function(u,l,c,f){var h=r(u),d=t(h),v=n(h);if(e(l),v===0&&c<2)throw new a(i);var p=o?v-1:0,x=o?-1:1;if(c<2)for(;;){if(p in d){f=d[p],p+=x;break}if(p+=x,o?p<0:v<=p)throw new a(i)}for(;o?p>=0:v>p;p+=x)p in d&&(f=l(f,d[p],p,h));return f}};return yg={left:s(!1),right:s(!0)},yg}var Cg,Z3;function PP(){if(Z3)return Cg;Z3=1;var e=Hr();return Cg=function(r,t){var n=[][r];return!!n&&e(function(){n.call(null,t||function(){return 1},1)})},Cg}var J3;function ise(){if(J3)return X3;J3=1;var e=Vt(),r=ase().left,t=PP(),n=ON(),a=$f(),i=!a&&n>79&&n<83,s=i||!t("reduce");return e({target:"Array",proto:!0,forced:s},{reduce:function(u){var l=arguments.length;return r(this,u,l,l>1?arguments[1]:void 0)}}),X3}ise();var ek={},rk;function sse(){if(rk)return ek;rk=1;var e=Vt(),r=Wf(),t=Bf().f,n=So(),a=da(),i=KN(),s=Hn(),o=XN(),u=ma(),l=r("".slice),c=Math.min,f=o("endsWith"),h=!u&&!f&&!!(function(){var d=t(String.prototype,"endsWith");return d&&!d.writable})();return e({target:"String",proto:!0,forced:!h&&!f},{endsWith:function(v){var p=a(s(this));i(v);var x=arguments.length>1?arguments[1]:void 0,g=p.length,N=x===void 0?g:c(n(x),g),b=a(v);return l(p,N-b.length,N)===b}}),ek}sse();var tk={},nk;function ose(){if(nk)return tk;nk=1;var e=Nt(),r=zr(),t=$N(),n=Pt(),a=Yt(),i=Hn(),s=CP(),o=GN(),u=So(),l=da(),c=_o(),f=YN(),h=OP(),d=Hr(),v=h.UNSUPPORTED_Y,p=4294967295,x=Math.min,g=r([].push),N=r("".slice),b=!d(function(){var _=/(?:)/,w=_.exec;_.exec=function(){return w.apply(this,arguments)};var C="ab".split(_);return C.length!==2||C[0]!=="a"||C[1]!=="b"}),y="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;return t("split",function(_,w,C){var k="0".split(void 0,0).length?function(D,U){return D===void 0&&U===0?[]:e(w,this,D,U)}:w;return[function(U,F){var L=i(this),P=a(U)?c(U,_):void 0;return P?e(P,U,L,F):e(k,l(L),U,F)},function(D,U){var F=n(this),L=l(D);if(!y){var P=C(k,F,L,U,k!==w);if(P.done)return P.value}var B=s(F,RegExp),G=F.unicode,ue=(F.ignoreCase?"i":"")+(F.multiline?"m":"")+(F.unicode?"u":"")+(v?"g":"y"),oe=new B(v?"^(?:"+F.source+")":F,ue),he=U===void 0?p:U>>>0;if(he===0)return[];if(L.length===0)return f(oe,L)===null?[L]:[];for(var fe=0,S=0,re=[];S<L.length;){oe.lastIndex=v?0:S;var T=f(oe,v?N(L,S):L),E;if(T===null||(E=x(u(oe.lastIndex+(v?S:0)),L.length))===fe)S=o(L,S,G);else{if(g(re,N(L,fe,S)),re.length===he)return re;for(var V=1;V<=T.length-1;V++)if(g(re,T[V]),re.length===he)return re;S=fe=E}}return g(re,N(L,fe)),re}]},y||!b,v),tk}ose();var Wo={exports:{}},Fi={exports:{}},lse=Fi.exports,ak;function use(){return ak||(ak=1,(function(){var e,r,t,n,a,i;typeof performance<"u"&&performance!==null&&performance.now?Fi.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(Fi.exports=function(){return(e()-a)/1e6},r=process.hrtime,e=function(){var s;return s=r(),s[0]*1e9+s[1]},n=e(),i=process.uptime()*1e9,a=n-i):Date.now?(Fi.exports=function(){return Date.now()-t},t=Date.now()):(Fi.exports=function(){return new Date().getTime()-t},t=new Date().getTime())}).call(lse)),Fi.exports}var ik;function cse(){if(ik)return Wo.exports;ik=1;for(var e=use(),r=typeof window>"u"?Pi:window,t=["moz","webkit"],n="AnimationFrame",a=r["request"+n],i=r["cancel"+n]||r["cancelRequest"+n],s=0;!a&&s<t.length;s++)a=r[t[s]+"Request"+n],i=r[t[s]+"Cancel"+n]||r[t[s]+"CancelRequest"+n];if(!a||!i){var o=0,u=0,l=[],c=1e3/60;a=function(f){if(l.length===0){var h=e(),d=Math.max(0,c-(h-o));o=d+h,setTimeout(function(){var v=l.slice(0);l.length=0;for(var p=0;p<v.length;p++)if(!v[p].cancelled)try{v[p].callback(o)}catch(x){setTimeout(function(){throw x},0)}},Math.round(d))}return l.push({handle:++u,callback:f,cancelled:!1}),u},i=function(f){for(var h=0;h<l.length;h++)l[h].handle===f&&(l[h].cancelled=!0)}}return Wo.exports=function(f){return a.call(r,f)},Wo.exports.cancel=function(){i.apply(r,arguments)},Wo.exports.polyfill=function(f){f||(f=r),f.requestAnimationFrame=a,f.cancelAnimationFrame=i},Wo.exports}var fse=cse();const Eg=nr(fse);var sk={},wg,ok;function VP(){return ok||(ok=1,wg=`	
\v\f\r Â áš€â€€â€â€‚â€ƒâ€„â€…â€†â€‡â€ˆâ€‰â€Šâ€¯âŸã€€\u2028\u2029\uFEFF`),wg}var _g,lk;function mse(){if(lk)return _g;lk=1;var e=zr(),r=Hn(),t=da(),n=VP(),a=e("".replace),i=RegExp("^["+n+"]+"),s=RegExp("(^|[^"+n+"])["+n+"]+$"),o=function(u){return function(l){var c=t(r(l));return u&1&&(c=a(c,i,"")),u&2&&(c=a(c,s,"$1")),c}};return _g={start:o(1),end:o(2),trim:o(3)},_g}var Sg,uk;function dse(){if(uk)return Sg;uk=1;var e=qf().PROPER,r=Hr(),t=VP(),n="â€‹Â…á Ž";return Sg=function(a){return r(function(){return!!t[a]()||n[a]()!==n||e&&t[a].name!==a})},Sg}var ck;function hse(){if(ck)return sk;ck=1;var e=Vt(),r=mse().trim,t=dse();return e({target:"String",proto:!0,forced:t("trim")},{trim:function(){return r(this)}}),sk}hse();var Tg,fk;function pse(){return fk||(fk=1,Tg=function(e){this.ok=!1,this.alpha=1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};e=r[e]||e;for(var t=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(u){return[parseInt(u[1]),parseInt(u[2]),parseInt(u[3]),parseFloat(u[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(u){return[parseInt(u[1]),parseInt(u[2]),parseInt(u[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(u){return[parseInt(u[1],16),parseInt(u[2],16),parseInt(u[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(u){return[parseInt(u[1]+u[1],16),parseInt(u[2]+u[2],16),parseInt(u[3]+u[3],16)]}}],n=0;n<t.length;n++){var a=t[n].re,i=t[n].process,s=a.exec(e);if(s){var o=i(s);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var u=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return u.length==1&&(u="0"+u),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+u+l+c},this.getHelpXML=function(){for(var u=new Array,l=0;l<t.length;l++)for(var c=t[l].example,f=0;f<c.length;f++)u[u.length]=c[f];for(var h in r)u[u.length]=h;var d=document.createElement("ul");d.setAttribute("id","rgbcolor-examples");for(var l=0;l<u.length;l++)try{var v=document.createElement("li"),p=new RGBColor(u[l]),x=document.createElement("div");x.style.cssText="margin: 3px; border: 1px solid black; background:"+p.toHex()+"; color:"+p.toHex(),x.appendChild(document.createTextNode("test"));var g=document.createTextNode(" "+u[l]+" -> "+p.toRGB()+" -> "+p.toHex());v.appendChild(x),v.appendChild(g),d.appendChild(v)}catch{}return d}}),Tg}var vse=pse();const E1=nr(vse);var mk={},dk;function xse(){if(dk)return mk;dk=1;var e=Vt(),r=Wf(),t=xP().indexOf,n=PP(),a=r([].indexOf),i=!!a&&1/a([1],1,-0)<0,s=i||!n("indexOf");return e({target:"Array",proto:!0,forced:s},{indexOf:function(u){var l=arguments.length>1?arguments[1]:void 0;return i?a(this,u,l)||0:t(this,u,l)}}),mk}xse();var hk={},pk;function gse(){if(pk)return hk;pk=1;var e=Vt(),r=zr(),t=KN(),n=Hn(),a=da(),i=XN(),s=r("".indexOf);return e({target:"String",proto:!0,forced:!i("includes")},{includes:function(u){return!!~s(a(n(this)),a(t(u)),arguments.length>1?arguments[1]:void 0)}}),hk}gse();var vk={},Dg,xk;function bse(){if(xk)return Dg;xk=1;var e=bs();return Dg=Array.isArray||function(t){return e(t)==="Array"},Dg}var gk;function Nse(){if(gk)return vk;gk=1;var e=Vt(),r=zr(),t=bse(),n=r([].reverse),a=[1,2];return e({target:"Array",proto:!0,forced:String(a)===String(a.reverse())},{reverse:function(){return t(this)&&(this.length=this.length),n(this)}}),vk}Nse();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var MP=function(e,r){return(MP=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])})(e,r)};function jP(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function t(){this.constructor=e}MP(e,r),e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}function yse(e){var r="";Array.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var n=e[t];if(n.type===ge.CLOSE_PATH)r+="z";else if(n.type===ge.HORIZ_LINE_TO)r+=(n.relative?"h":"H")+n.x;else if(n.type===ge.VERT_LINE_TO)r+=(n.relative?"v":"V")+n.y;else if(n.type===ge.MOVE_TO)r+=(n.relative?"m":"M")+n.x+" "+n.y;else if(n.type===ge.LINE_TO)r+=(n.relative?"l":"L")+n.x+" "+n.y;else if(n.type===ge.CURVE_TO)r+=(n.relative?"c":"C")+n.x1+" "+n.y1+" "+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===ge.SMOOTH_CURVE_TO)r+=(n.relative?"s":"S")+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===ge.QUAD_TO)r+=(n.relative?"q":"Q")+n.x1+" "+n.y1+" "+n.x+" "+n.y;else if(n.type===ge.SMOOTH_QUAD_TO)r+=(n.relative?"t":"T")+n.x+" "+n.y;else{if(n.type!==ge.ARC)throw new Error('Unexpected command type "'+n.type+'" at index '+t+".");r+=(n.relative?"a":"A")+n.rX+" "+n.rY+" "+n.xRot+" "+ +n.lArcFlag+" "+ +n.sweepFlag+" "+n.x+" "+n.y}}return r}function w1(e,r){var t=e[0],n=e[1];return[t*Math.cos(r)-n*Math.sin(r),t*Math.sin(r)+n*Math.cos(r)]}function Dn(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var t=0;t<e.length;t++)if(typeof e[t]!="number")throw new Error("assertNumbers arguments["+t+"] is not a number. "+typeof e[t]+" == typeof "+e[t]);return!0}var Qa=Math.PI;function Ag(e,r,t){e.lArcFlag=e.lArcFlag===0?0:1,e.sweepFlag=e.sweepFlag===0?0:1;var n=e.rX,a=e.rY,i=e.x,s=e.y;n=Math.abs(e.rX),a=Math.abs(e.rY);var o=w1([(r-i)/2,(t-s)/2],-e.xRot/180*Qa),u=o[0],l=o[1],c=Math.pow(u,2)/Math.pow(n,2)+Math.pow(l,2)/Math.pow(a,2);1<c&&(n*=Math.sqrt(c),a*=Math.sqrt(c)),e.rX=n,e.rY=a;var f=Math.pow(n,2)*Math.pow(l,2)+Math.pow(a,2)*Math.pow(u,2),h=(e.lArcFlag!==e.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(n,2)*Math.pow(a,2)-f)/f)),d=n*l/a*h,v=-a*u/n*h,p=w1([d,v],e.xRot/180*Qa);e.cX=p[0]+(r+i)/2,e.cY=p[1]+(t+s)/2,e.phi1=Math.atan2((l-v)/a,(u-d)/n),e.phi2=Math.atan2((-l-v)/a,(-u-d)/n),e.sweepFlag===0&&e.phi2>e.phi1&&(e.phi2-=2*Qa),e.sweepFlag===1&&e.phi2<e.phi1&&(e.phi2+=2*Qa),e.phi1*=180/Qa,e.phi2*=180/Qa}function bk(e,r,t){Dn(e,r,t);var n=e*e+r*r-t*t;if(0>n)return[];if(n===0)return[[e*t/(e*e+r*r),r*t/(e*e+r*r)]];var a=Math.sqrt(n);return[[(e*t+r*a)/(e*e+r*r),(r*t-e*a)/(e*e+r*r)],[(e*t-r*a)/(e*e+r*r),(r*t+e*a)/(e*e+r*r)]]}var Qr,xa=Math.PI/180;function Nk(e,r,t){return(1-t)*e+t*r}function yk(e,r,t,n){return e+Math.cos(n/180*Qa)*r+Math.sin(n/180*Qa)*t}function Ck(e,r,t,n){var a=1e-6,i=r-e,s=t-r,o=3*i+3*(n-t)-6*s,u=6*(s-i),l=3*i;return Math.abs(o)<a?[-l/u]:(function(c,f,h){var d=c*c/4-f;if(d<-h)return[];if(d<=h)return[-c/2];var v=Math.sqrt(d);return[-c/2-v,-c/2+v]})(u/o,l/o,a)}function Ek(e,r,t,n,a){var i=1-a;return e*(i*i*i)+r*(3*i*i*a)+t*(3*i*a*a)+n*(a*a*a)}(function(e){function r(){return a((function(o,u,l){return o.relative&&(o.x1!==void 0&&(o.x1+=u),o.y1!==void 0&&(o.y1+=l),o.x2!==void 0&&(o.x2+=u),o.y2!==void 0&&(o.y2+=l),o.x!==void 0&&(o.x+=u),o.y!==void 0&&(o.y+=l),o.relative=!1),o}))}function t(){var o=NaN,u=NaN,l=NaN,c=NaN;return a((function(f,h,d){return f.type&ge.SMOOTH_CURVE_TO&&(f.type=ge.CURVE_TO,o=isNaN(o)?h:o,u=isNaN(u)?d:u,f.x1=f.relative?h-o:2*h-o,f.y1=f.relative?d-u:2*d-u),f.type&ge.CURVE_TO?(o=f.relative?h+f.x2:f.x2,u=f.relative?d+f.y2:f.y2):(o=NaN,u=NaN),f.type&ge.SMOOTH_QUAD_TO&&(f.type=ge.QUAD_TO,l=isNaN(l)?h:l,c=isNaN(c)?d:c,f.x1=f.relative?h-l:2*h-l,f.y1=f.relative?d-c:2*d-c),f.type&ge.QUAD_TO?(l=f.relative?h+f.x1:f.x1,c=f.relative?d+f.y1:f.y1):(l=NaN,c=NaN),f}))}function n(){var o=NaN,u=NaN;return a((function(l,c,f){if(l.type&ge.SMOOTH_QUAD_TO&&(l.type=ge.QUAD_TO,o=isNaN(o)?c:o,u=isNaN(u)?f:u,l.x1=l.relative?c-o:2*c-o,l.y1=l.relative?f-u:2*f-u),l.type&ge.QUAD_TO){o=l.relative?c+l.x1:l.x1,u=l.relative?f+l.y1:l.y1;var h=l.x1,d=l.y1;l.type=ge.CURVE_TO,l.x1=((l.relative?0:c)+2*h)/3,l.y1=((l.relative?0:f)+2*d)/3,l.x2=(l.x+2*h)/3,l.y2=(l.y+2*d)/3}else o=NaN,u=NaN;return l}))}function a(o){var u=0,l=0,c=NaN,f=NaN;return function(h){if(isNaN(c)&&!(h.type&ge.MOVE_TO))throw new Error("path must start with moveto");var d=o(h,u,l,c,f);return h.type&ge.CLOSE_PATH&&(u=c,l=f),h.x!==void 0&&(u=h.relative?u+h.x:h.x),h.y!==void 0&&(l=h.relative?l+h.y:h.y),h.type&ge.MOVE_TO&&(c=u,f=l),d}}function i(o,u,l,c,f,h){return Dn(o,u,l,c,f,h),a((function(d,v,p,x){var g=d.x1,N=d.x2,b=d.relative&&!isNaN(x),y=d.x!==void 0?d.x:b?0:v,_=d.y!==void 0?d.y:b?0:p;function w(T){return T*T}d.type&ge.HORIZ_LINE_TO&&u!==0&&(d.type=ge.LINE_TO,d.y=d.relative?0:p),d.type&ge.VERT_LINE_TO&&l!==0&&(d.type=ge.LINE_TO,d.x=d.relative?0:v),d.x!==void 0&&(d.x=d.x*o+_*l+(b?0:f)),d.y!==void 0&&(d.y=y*u+d.y*c+(b?0:h)),d.x1!==void 0&&(d.x1=d.x1*o+d.y1*l+(b?0:f)),d.y1!==void 0&&(d.y1=g*u+d.y1*c+(b?0:h)),d.x2!==void 0&&(d.x2=d.x2*o+d.y2*l+(b?0:f)),d.y2!==void 0&&(d.y2=N*u+d.y2*c+(b?0:h));var C=o*c-u*l;if(d.xRot!==void 0&&(o!==1||u!==0||l!==0||c!==1))if(C===0)delete d.rX,delete d.rY,delete d.xRot,delete d.lArcFlag,delete d.sweepFlag,d.type=ge.LINE_TO;else{var k=d.xRot*Math.PI/180,D=Math.sin(k),U=Math.cos(k),F=1/w(d.rX),L=1/w(d.rY),P=w(U)*F+w(D)*L,B=2*D*U*(F-L),G=w(D)*F+w(U)*L,ue=P*c*c-B*u*c+G*u*u,oe=B*(o*c+u*l)-2*(P*l*c+G*o*u),he=P*l*l-B*o*l+G*o*o,fe=(Math.atan2(oe,ue-he)+Math.PI)%Math.PI/2,S=Math.sin(fe),re=Math.cos(fe);d.rX=Math.abs(C)/Math.sqrt(ue*w(re)+oe*S*re+he*w(S)),d.rY=Math.abs(C)/Math.sqrt(ue*w(S)-oe*S*re+he*w(re)),d.xRot=180*fe/Math.PI}return d.sweepFlag!==void 0&&0>C&&(d.sweepFlag=+!d.sweepFlag),d}))}function s(){return function(o){var u={};for(var l in o)u[l]=o[l];return u}}e.ROUND=function(o){function u(l){return Math.round(l*o)/o}return o===void 0&&(o=1e13),Dn(o),function(l){return l.x1!==void 0&&(l.x1=u(l.x1)),l.y1!==void 0&&(l.y1=u(l.y1)),l.x2!==void 0&&(l.x2=u(l.x2)),l.y2!==void 0&&(l.y2=u(l.y2)),l.x!==void 0&&(l.x=u(l.x)),l.y!==void 0&&(l.y=u(l.y)),l.rX!==void 0&&(l.rX=u(l.rX)),l.rY!==void 0&&(l.rY=u(l.rY)),l}},e.TO_ABS=r,e.TO_REL=function(){return a((function(o,u,l){return o.relative||(o.x1!==void 0&&(o.x1-=u),o.y1!==void 0&&(o.y1-=l),o.x2!==void 0&&(o.x2-=u),o.y2!==void 0&&(o.y2-=l),o.x!==void 0&&(o.x-=u),o.y!==void 0&&(o.y-=l),o.relative=!0),o}))},e.NORMALIZE_HVZ=function(o,u,l){return o===void 0&&(o=!0),u===void 0&&(u=!0),l===void 0&&(l=!0),a((function(c,f,h,d,v){if(isNaN(d)&&!(c.type&ge.MOVE_TO))throw new Error("path must start with moveto");return u&&c.type&ge.HORIZ_LINE_TO&&(c.type=ge.LINE_TO,c.y=c.relative?0:h),l&&c.type&ge.VERT_LINE_TO&&(c.type=ge.LINE_TO,c.x=c.relative?0:f),o&&c.type&ge.CLOSE_PATH&&(c.type=ge.LINE_TO,c.x=c.relative?d-f:d,c.y=c.relative?v-h:v),c.type&ge.ARC&&(c.rX===0||c.rY===0)&&(c.type=ge.LINE_TO,delete c.rX,delete c.rY,delete c.xRot,delete c.lArcFlag,delete c.sweepFlag),c}))},e.NORMALIZE_ST=t,e.QT_TO_C=n,e.INFO=a,e.SANITIZE=function(o){o===void 0&&(o=0),Dn(o);var u=NaN,l=NaN,c=NaN,f=NaN;return a((function(h,d,v,p,x){var g=Math.abs,N=!1,b=0,y=0;if(h.type&ge.SMOOTH_CURVE_TO&&(b=isNaN(u)?0:d-u,y=isNaN(l)?0:v-l),h.type&(ge.CURVE_TO|ge.SMOOTH_CURVE_TO)?(u=h.relative?d+h.x2:h.x2,l=h.relative?v+h.y2:h.y2):(u=NaN,l=NaN),h.type&ge.SMOOTH_QUAD_TO?(c=isNaN(c)?d:2*d-c,f=isNaN(f)?v:2*v-f):h.type&ge.QUAD_TO?(c=h.relative?d+h.x1:h.x1,f=h.relative?v+h.y1:h.y2):(c=NaN,f=NaN),h.type&ge.LINE_COMMANDS||h.type&ge.ARC&&(h.rX===0||h.rY===0||!h.lArcFlag)||h.type&ge.CURVE_TO||h.type&ge.SMOOTH_CURVE_TO||h.type&ge.QUAD_TO||h.type&ge.SMOOTH_QUAD_TO){var _=h.x===void 0?0:h.relative?h.x:h.x-d,w=h.y===void 0?0:h.relative?h.y:h.y-v;b=isNaN(c)?h.x1===void 0?b:h.relative?h.x:h.x1-d:c-d,y=isNaN(f)?h.y1===void 0?y:h.relative?h.y:h.y1-v:f-v;var C=h.x2===void 0?0:h.relative?h.x:h.x2-d,k=h.y2===void 0?0:h.relative?h.y:h.y2-v;g(_)<=o&&g(w)<=o&&g(b)<=o&&g(y)<=o&&g(C)<=o&&g(k)<=o&&(N=!0)}return h.type&ge.CLOSE_PATH&&g(d-p)<=o&&g(v-x)<=o&&(N=!0),N?[]:h}))},e.MATRIX=i,e.ROTATE=function(o,u,l){u===void 0&&(u=0),l===void 0&&(l=0),Dn(o,u,l);var c=Math.sin(o),f=Math.cos(o);return i(f,c,-c,f,u-u*f+l*c,l-u*c-l*f)},e.TRANSLATE=function(o,u){return u===void 0&&(u=0),Dn(o,u),i(1,0,0,1,o,u)},e.SCALE=function(o,u){return u===void 0&&(u=o),Dn(o,u),i(o,0,0,u,0,0)},e.SKEW_X=function(o){return Dn(o),i(1,0,Math.atan(o),1,0,0)},e.SKEW_Y=function(o){return Dn(o),i(1,Math.atan(o),0,1,0,0)},e.X_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),Dn(o),i(-1,0,0,1,o,0)},e.Y_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),Dn(o),i(1,0,0,-1,0,o)},e.A_TO_C=function(){return a((function(o,u,l){return ge.ARC===o.type?(function(c,f,h){var d,v,p,x;c.cX||Ag(c,f,h);for(var g=Math.min(c.phi1,c.phi2),N=Math.max(c.phi1,c.phi2)-g,b=Math.ceil(N/90),y=new Array(b),_=f,w=h,C=0;C<b;C++){var k=Nk(c.phi1,c.phi2,C/b),D=Nk(c.phi1,c.phi2,(C+1)/b),U=D-k,F=4/3*Math.tan(U*xa/4),L=[Math.cos(k*xa)-F*Math.sin(k*xa),Math.sin(k*xa)+F*Math.cos(k*xa)],P=L[0],B=L[1],G=[Math.cos(D*xa),Math.sin(D*xa)],ue=G[0],oe=G[1],he=[ue+F*Math.sin(D*xa),oe-F*Math.cos(D*xa)],fe=he[0],S=he[1];y[C]={relative:c.relative,type:ge.CURVE_TO};var re=function(T,E){var V=w1([T*c.rX,E*c.rY],c.xRot),I=V[0],Y=V[1];return[c.cX+I,c.cY+Y]};d=re(P,B),y[C].x1=d[0],y[C].y1=d[1],v=re(fe,S),y[C].x2=v[0],y[C].y2=v[1],p=re(ue,oe),y[C].x=p[0],y[C].y=p[1],c.relative&&(y[C].x1-=_,y[C].y1-=w,y[C].x2-=_,y[C].y2-=w,y[C].x-=_,y[C].y-=w),_=(x=[y[C].x,y[C].y])[0],w=x[1]}return y})(o,o.relative?0:u,o.relative?0:l):o}))},e.ANNOTATE_ARCS=function(){return a((function(o,u,l){return o.relative&&(u=0,l=0),ge.ARC===o.type&&Ag(o,u,l),o}))},e.CLONE=s,e.CALCULATE_BOUNDS=function(){var o=function(h){var d={};for(var v in h)d[v]=h[v];return d},u=r(),l=n(),c=t(),f=a((function(h,d,v){var p=c(l(u(o(h))));function x(S){S>f.maxX&&(f.maxX=S),S<f.minX&&(f.minX=S)}function g(S){S>f.maxY&&(f.maxY=S),S<f.minY&&(f.minY=S)}if(p.type&ge.DRAWING_COMMANDS&&(x(d),g(v)),p.type&ge.HORIZ_LINE_TO&&x(p.x),p.type&ge.VERT_LINE_TO&&g(p.y),p.type&ge.LINE_TO&&(x(p.x),g(p.y)),p.type&ge.CURVE_TO){x(p.x),g(p.y);for(var N=0,b=Ck(d,p.x1,p.x2,p.x);N<b.length;N++)0<(fe=b[N])&&1>fe&&x(Ek(d,p.x1,p.x2,p.x,fe));for(var y=0,_=Ck(v,p.y1,p.y2,p.y);y<_.length;y++)0<(fe=_[y])&&1>fe&&g(Ek(v,p.y1,p.y2,p.y,fe))}if(p.type&ge.ARC){x(p.x),g(p.y),Ag(p,d,v);for(var w=p.xRot/180*Math.PI,C=Math.cos(w)*p.rX,k=Math.sin(w)*p.rX,D=-Math.sin(w)*p.rY,U=Math.cos(w)*p.rY,F=p.phi1<p.phi2?[p.phi1,p.phi2]:-180>p.phi2?[p.phi2+360,p.phi1+360]:[p.phi2,p.phi1],L=F[0],P=F[1],B=function(S){var re=S[0],T=S[1],E=180*Math.atan2(T,re)/Math.PI;return E<L?E+360:E},G=0,ue=bk(D,-C,0).map(B);G<ue.length;G++)(fe=ue[G])>L&&fe<P&&x(yk(p.cX,C,D,fe));for(var oe=0,he=bk(U,-k,0).map(B);oe<he.length;oe++){var fe;(fe=he[oe])>L&&fe<P&&g(yk(p.cY,k,U,fe))}}return h}));return f.minX=1/0,f.maxX=-1/0,f.minY=1/0,f.maxY=-1/0,f}})(Qr||(Qr={}));var Tn,LP=(function(){function e(){}return e.prototype.round=function(r){return this.transform(Qr.ROUND(r))},e.prototype.toAbs=function(){return this.transform(Qr.TO_ABS())},e.prototype.toRel=function(){return this.transform(Qr.TO_REL())},e.prototype.normalizeHVZ=function(r,t,n){return this.transform(Qr.NORMALIZE_HVZ(r,t,n))},e.prototype.normalizeST=function(){return this.transform(Qr.NORMALIZE_ST())},e.prototype.qtToC=function(){return this.transform(Qr.QT_TO_C())},e.prototype.aToC=function(){return this.transform(Qr.A_TO_C())},e.prototype.sanitize=function(r){return this.transform(Qr.SANITIZE(r))},e.prototype.translate=function(r,t){return this.transform(Qr.TRANSLATE(r,t))},e.prototype.scale=function(r,t){return this.transform(Qr.SCALE(r,t))},e.prototype.rotate=function(r,t,n){return this.transform(Qr.ROTATE(r,t,n))},e.prototype.matrix=function(r,t,n,a,i,s){return this.transform(Qr.MATRIX(r,t,n,a,i,s))},e.prototype.skewX=function(r){return this.transform(Qr.SKEW_X(r))},e.prototype.skewY=function(r){return this.transform(Qr.SKEW_Y(r))},e.prototype.xSymmetry=function(r){return this.transform(Qr.X_AXIS_SYMMETRY(r))},e.prototype.ySymmetry=function(r){return this.transform(Qr.Y_AXIS_SYMMETRY(r))},e.prototype.annotateArcs=function(){return this.transform(Qr.ANNOTATE_ARCS())},e})(),Cse=function(e){return e===" "||e==="	"||e==="\r"||e===`
`},wk=function(e){return 48<=e.charCodeAt(0)&&e.charCodeAt(0)<=57},Ese=(function(e){function r(){var t=e.call(this)||this;return t.curNumber="",t.curCommandType=-1,t.curCommandRelative=!1,t.canParseCommandOrComma=!0,t.curNumberHasExp=!1,t.curNumberHasExpDigits=!1,t.curNumberHasDecimal=!1,t.curArgs=[],t}return jP(r,e),r.prototype.finish=function(t){if(t===void 0&&(t=[]),this.parse(" ",t),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return t},r.prototype.parse=function(t,n){var a=this;n===void 0&&(n=[]);for(var i=function(f){n.push(f),a.curArgs.length=0,a.canParseCommandOrComma=!0},s=0;s<t.length;s++){var o=t[s],u=!(this.curCommandType!==ge.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),l=wk(o)&&(this.curNumber==="0"&&o==="0"||u);if(!wk(o)||l)if(o!=="e"&&o!=="E")if(o!=="-"&&o!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(o!=="."||this.curNumberHasExp||this.curNumberHasDecimal||u){if(this.curNumber&&this.curCommandType!==-1){var c=Number(this.curNumber);if(isNaN(c))throw new SyntaxError("Invalid number ending at "+s);if(this.curCommandType===ge.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>c)throw new SyntaxError('Expected positive number, got "'+c+'" at index "'+s+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+s+'"')}this.curArgs.push(c),this.curArgs.length===wse[this.curCommandType]&&(ge.HORIZ_LINE_TO===this.curCommandType?i({type:ge.HORIZ_LINE_TO,relative:this.curCommandRelative,x:c}):ge.VERT_LINE_TO===this.curCommandType?i({type:ge.VERT_LINE_TO,relative:this.curCommandRelative,y:c}):this.curCommandType===ge.MOVE_TO||this.curCommandType===ge.LINE_TO||this.curCommandType===ge.SMOOTH_QUAD_TO?(i({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),ge.MOVE_TO===this.curCommandType&&(this.curCommandType=ge.LINE_TO)):this.curCommandType===ge.CURVE_TO?i({type:ge.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===ge.SMOOTH_CURVE_TO?i({type:ge.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===ge.QUAD_TO?i({type:ge.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===ge.ARC&&i({type:ge.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!Cse(o))if(o===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(o!=="+"&&o!=="-"&&o!==".")if(l)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+s+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+s+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,o!=="z"&&o!=="Z")if(o==="h"||o==="H")this.curCommandType=ge.HORIZ_LINE_TO,this.curCommandRelative=o==="h";else if(o==="v"||o==="V")this.curCommandType=ge.VERT_LINE_TO,this.curCommandRelative=o==="v";else if(o==="m"||o==="M")this.curCommandType=ge.MOVE_TO,this.curCommandRelative=o==="m";else if(o==="l"||o==="L")this.curCommandType=ge.LINE_TO,this.curCommandRelative=o==="l";else if(o==="c"||o==="C")this.curCommandType=ge.CURVE_TO,this.curCommandRelative=o==="c";else if(o==="s"||o==="S")this.curCommandType=ge.SMOOTH_CURVE_TO,this.curCommandRelative=o==="s";else if(o==="q"||o==="Q")this.curCommandType=ge.QUAD_TO,this.curCommandRelative=o==="q";else if(o==="t"||o==="T")this.curCommandType=ge.SMOOTH_QUAD_TO,this.curCommandRelative=o==="t";else{if(o!=="a"&&o!=="A")throw new SyntaxError('Unexpected character "'+o+'" at index '+s+".");this.curCommandType=ge.ARC,this.curCommandRelative=o==="a"}else n.push({type:ge.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal=o==="."}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return n},r.prototype.transform=function(t){return Object.create(this,{parse:{value:function(n,a){a===void 0&&(a=[]);for(var i=0,s=Object.getPrototypeOf(this).parse.call(this,n);i<s.length;i++){var o=s[i],u=t(o);Array.isArray(u)?a.push.apply(a,u):a.push(u)}return a}}})},r})(LP),ge=(function(e){function r(t){var n=e.call(this)||this;return n.commands=typeof t=="string"?r.parse(t):t,n}return jP(r,e),r.prototype.encode=function(){return r.encode(this.commands)},r.prototype.getBounds=function(){var t=Qr.CALCULATE_BOUNDS();return this.transform(t),t},r.prototype.transform=function(t){for(var n=[],a=0,i=this.commands;a<i.length;a++){var s=t(i[a]);Array.isArray(s)?n.push.apply(n,s):n.push(s)}return this.commands=n,this},r.encode=function(t){return yse(t)},r.parse=function(t){var n=new Ese,a=[];return n.parse(t,a),n.finish(a),a},r.CLOSE_PATH=1,r.MOVE_TO=2,r.HORIZ_LINE_TO=4,r.VERT_LINE_TO=8,r.LINE_TO=16,r.CURVE_TO=32,r.SMOOTH_CURVE_TO=64,r.QUAD_TO=128,r.SMOOTH_QUAD_TO=256,r.ARC=512,r.LINE_COMMANDS=r.LINE_TO|r.HORIZ_LINE_TO|r.VERT_LINE_TO,r.DRAWING_COMMANDS=r.HORIZ_LINE_TO|r.VERT_LINE_TO|r.LINE_TO|r.CURVE_TO|r.SMOOTH_CURVE_TO|r.QUAD_TO|r.SMOOTH_QUAD_TO|r.ARC,r})(LP),wse=((Tn={})[ge.MOVE_TO]=2,Tn[ge.LINE_TO]=2,Tn[ge.HORIZ_LINE_TO]=1,Tn[ge.VERT_LINE_TO]=1,Tn[ge.CLOSE_PATH]=0,Tn[ge.QUAD_TO]=4,Tn[ge.SMOOTH_QUAD_TO]=2,Tn[ge.CURVE_TO]=6,Tn[ge.SMOOTH_CURVE_TO]=4,Tn[ge.ARC]=7,Tn),_k={},Sk;function _se(){if(Sk)return _k;Sk=1;var e=qf().PROPER,r=ys(),t=Pt(),n=da(),a=Hr(),i=WN(),s="toString",o=RegExp.prototype,u=o[s],l=a(function(){return u.call({source:"a",flags:"b"})!=="/a/b"}),c=e&&u.name!==s;return(l||c)&&r(o,s,function(){var h=t(this),d=n(h.source),v=n(i(h));return"/"+d+"/"+v},{unsafe:!0}),_k}_se();function nc(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nc=function(r){return typeof r}:nc=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},nc(e)}function Sse(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var Tse=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],Dse=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function Ase(e,r,t,n,a){if(typeof e=="string"&&(e=document.getElementById(e)),!e||nc(e)!=="object"||!("getContext"in e))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var i=e.getContext("2d");try{return i.getImageData(r,t,n,a)}catch(s){throw new Error("unable to access image data: "+s)}}function kse(e,r,t,n,a,i){if(!(isNaN(i)||i<1)){i|=0;var s=Ase(e,r,t,n,a);s=Rse(s,r,t,n,a,i),e.getContext("2d").putImageData(s,r,t)}}function Rse(e,r,t,n,a,i){for(var s=e.data,o=2*i+1,u=n-1,l=a-1,c=i+1,f=c*(c+1)/2,h=new Tk,d=h,v,p=1;p<o;p++)d=d.next=new Tk,p===c&&(v=d);d.next=h;for(var x=null,g=null,N=0,b=0,y=Tse[i],_=Dse[i],w=0;w<a;w++){d=h;for(var C=s[b],k=s[b+1],D=s[b+2],U=s[b+3],F=0;F<c;F++)d.r=C,d.g=k,d.b=D,d.a=U,d=d.next;for(var L=0,P=0,B=0,G=0,ue=c*C,oe=c*k,he=c*D,fe=c*U,S=f*C,re=f*k,T=f*D,E=f*U,V=1;V<c;V++){var I=b+((u<V?u:V)<<2),Y=s[I],ie=s[I+1],le=s[I+2],X=s[I+3],Q=c-V;S+=(d.r=Y)*Q,re+=(d.g=ie)*Q,T+=(d.b=le)*Q,E+=(d.a=X)*Q,L+=Y,P+=ie,B+=le,G+=X,d=d.next}x=h,g=v;for(var be=0;be<n;be++){var ee=E*y>>>_;if(s[b+3]=ee,ee!==0){var Ie=255/ee;s[b]=(S*y>>>_)*Ie,s[b+1]=(re*y>>>_)*Ie,s[b+2]=(T*y>>>_)*Ie}else s[b]=s[b+1]=s[b+2]=0;S-=ue,re-=oe,T-=he,E-=fe,ue-=x.r,oe-=x.g,he-=x.b,fe-=x.a;var Te=be+i+1;Te=N+(Te<u?Te:u)<<2,L+=x.r=s[Te],P+=x.g=s[Te+1],B+=x.b=s[Te+2],G+=x.a=s[Te+3],S+=L,re+=P,T+=B,E+=G,x=x.next;var Ye=g,Be=Ye.r,Ee=Ye.g,xr=Ye.b,Wr=Ye.a;ue+=Be,oe+=Ee,he+=xr,fe+=Wr,L-=Be,P-=Ee,B-=xr,G-=Wr,g=g.next,b+=4}N+=n}for(var $r=0;$r<n;$r++){b=$r<<2;var Nr=s[b],Tr=s[b+1],Yr=s[b+2],Ne=s[b+3],je=c*Nr,Z=c*Tr,J=c*Yr,xe=c*Ne,Le=f*Nr,pe=f*Tr,ke=f*Yr,Ve=f*Ne;d=h;for(var Ke=0;Ke<c;Ke++)d.r=Nr,d.g=Tr,d.b=Yr,d.a=Ne,d=d.next;for(var ar=n,Er=0,rr=0,nt=0,ur=0,un=1;un<=i;un++){b=ar+$r<<2;var _i=c-un;Le+=(d.r=Nr=s[b])*_i,pe+=(d.g=Tr=s[b+1])*_i,ke+=(d.b=Yr=s[b+2])*_i,Ve+=(d.a=Ne=s[b+3])*_i,ur+=Nr,Er+=Tr,rr+=Yr,nt+=Ne,d=d.next,un<l&&(ar+=n)}b=$r,x=h,g=v;for(var Do=0;Do<a;Do++){var yt=b<<2;s[yt+3]=Ne=Ve*y>>>_,Ne>0?(Ne=255/Ne,s[yt]=(Le*y>>>_)*Ne,s[yt+1]=(pe*y>>>_)*Ne,s[yt+2]=(ke*y>>>_)*Ne):s[yt]=s[yt+1]=s[yt+2]=0,Le-=je,pe-=Z,ke-=J,Ve-=xe,je-=x.r,Z-=x.g,J-=x.b,xe-=x.a,yt=$r+((yt=Do+c)<l?yt:l)*n<<2,Le+=ur+=x.r=s[yt],pe+=Er+=x.g=s[yt+1],ke+=rr+=x.b=s[yt+2],Ve+=nt+=x.a=s[yt+3],x=x.next,je+=Nr=g.r,Z+=Tr=g.g,J+=Yr=g.b,xe+=Ne=g.a,ur-=Nr,Er-=Tr,rr-=Yr,nt-=Ne,g=g.next,b+=n}}return e}var Tk=function e(){Sse(this,e),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function Ose(){var{DOMParser:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:e,createCanvas(t,n){return new OffscreenCanvas(t,n)},createImage(t){return Va(function*(){var n=yield fetch(t),a=yield n.blob(),i=yield createImageBitmap(a);return i})()}};return(typeof DOMParser<"u"||typeof e>"u")&&Reflect.deleteProperty(r,"DOMParser"),r}function Fse(e){var{DOMParser:r,canvas:t,fetch:n}=e;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:r,fetch:n,createCanvas:t.createCanvas,createImage:t.loadImage}}var Use=Object.freeze({__proto__:null,offscreen:Ose,node:Fse});function Cs(e){return e.replace(/(?!\u3000)\s+/gm," ")}function BP(e){return e.replace(/^[\n \t]+/,"")}function qP(e){return e.replace(/[\n \t]+$/,"")}function qt(e){var r=(e||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return r.map(parseFloat)}var Ise=/^[A-Z-]+$/;function HP(e){return Ise.test(e)?e.toLowerCase():e}function ZN(e){var r=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(e)||[];return r[2]||r[3]||r[4]}function zP(e){if(!e.startsWith("rgb"))return e;var r=3,t=e.replace(/\d+(\.\d+)?/g,(n,a)=>r--&&a?String(Math.round(parseFloat(n))):n);return t}var Pse=/(\[[^\]]+\])/g,Vse=/(#[^\s+>~.[:]+)/g,Mse=/(\.[^\s+>~.[:]+)/g,jse=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,Lse=/(:[\w-]+\([^)]*\))/gi,Bse=/(:[^\s+>~.[:]+)/g,qse=/([^\s+>~.[:]+)/g;function Ai(e,r){var t=r.exec(e);return t?[e.replace(r," "),t.length]:[e,0]}function $P(e){var r=[0,0,0],t=e.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),n=0;return[t,n]=Ai(t,Pse),r[1]+=n,[t,n]=Ai(t,Vse),r[0]+=n,[t,n]=Ai(t,Mse),r[1]+=n,[t,n]=Ai(t,jse),r[2]+=n,[t,n]=Ai(t,Lse),r[1]+=n,[t,n]=Ai(t,Bse),r[1]+=n,t=t.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[t,n]=Ai(t,qse),r[2]+=n,r.join("")}var Xi=1e-8;function _1(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))}function Kc(e,r){return(e[0]*r[0]+e[1]*r[1])/(_1(e)*_1(r))}function S1(e,r){return(e[0]*r[1]<e[1]*r[0]?-1:1)*Math.acos(Kc(e,r))}function T1(e){return e*e*e}function D1(e){return 3*e*e*(1-e)}function A1(e){return 3*e*(1-e)*(1-e)}function k1(e){return(1-e)*(1-e)*(1-e)}function R1(e){return e*e}function O1(e){return 2*e*(1-e)}function F1(e){return(1-e)*(1-e)}class Me{constructor(r,t,n){this.document=r,this.name=t,this.value=n,this.isNormalizedColor=!1}static empty(r){return new Me(r,"EMPTY","")}split(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ",{document:t,name:n}=this;return Cs(this.getString()).trim().split(r).map(a=>new Me(t,n,a))}hasValue(r){var{value:t}=this;return t!==null&&t!==""&&(r||t!==0)&&typeof t<"u"}isString(r){var{value:t}=this,n=typeof t=="string";return!n||!r?n:r.test(t)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var r=this.getString();switch(!0){case r.endsWith("px"):case/^[0-9]+$/.test(r):return!0;default:return!1}}setValue(r){return this.value=r,this}getValue(r){return typeof r>"u"||this.hasValue()?this.value:r}getNumber(r){if(!this.hasValue())return typeof r>"u"?0:parseFloat(r);var{value:t}=this,n=parseFloat(t);return this.isString(/%$/)&&(n/=100),n}getString(r){return typeof r>"u"||this.hasValue()?typeof this.value>"u"?"":String(this.value):String(r)}getColor(r){var t=this.getString(r);return this.isNormalizedColor||(this.isNormalizedColor=!0,t=zP(t),this.value=t),t}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;var[n,a]=typeof r=="boolean"?[void 0,r]:[r],{viewPort:i}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(i.computeSize("x"),i.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(i.computeSize("x"),i.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*i.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*i.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&a):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*i.computeSize(n);default:{var s=this.getNumber();return t&&s<1?s*i.computeSize(n):s}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var r=this.getString(),t=/#([^)'"]+)/.exec(r);return t&&(t=t[1]),t||(t=r),this.document.definitions[t]}getFillStyleDefinition(r,t){var n=this.getDefinition();if(!n)return null;if(typeof n.createGradient=="function")return n.createGradient(this.document.ctx,r,t);if(typeof n.createPattern=="function"){if(n.getHrefAttribute().hasValue()){var a=n.getAttribute("patternTransform");n=n.getHrefAttribute().getDefinition(),a.hasValue()&&n.getAttribute("patternTransform",!0).setValue(a.value)}return n.createPattern(this.document.ctx,r,t)}return null}getTextBaseline(){return this.hasValue()?Me.textBaselineMapping[this.getString()]:null}addOpacity(r){for(var t=this.getColor(),n=t.length,a=0,i=0;i<n&&(t[i]===","&&a++,a!==3);i++);if(r.hasValue()&&this.isString()&&a!==3){var s=new E1(t);s.ok&&(s.alpha=r.getNumber(),t=s.toRGBA())}return new Me(this.document,this.name,t)}}Me.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class GP{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(r,t){this.viewPorts.push({width:r,height:t})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:r}=this;return r[r.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(r){return typeof r=="number"?r:r==="x"?this.width:r==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}}class Br{constructor(r,t){this.x=r,this.y=t}static parse(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,[n=t,a=t]=qt(r);return new Br(n,a)}static parseScale(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,[n=t,a=n]=qt(r);return new Br(n,a)}static parsePath(r){for(var t=qt(r),n=t.length,a=[],i=0;i<n;i+=2)a.push(new Br(t[i],t[i+1]));return a}angleTo(r){return Math.atan2(r.y-this.y,r.x-this.x)}applyTransform(r){var{x:t,y:n}=this,a=t*r[0]+n*r[2]+r[4],i=t*r[1]+n*r[3]+r[5];this.x=a,this.y=i}}class WP{constructor(r){this.screen=r,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:r,onClick:t,onMouseMove:n}=this,a=r.ctx.canvas;a.onclick=t,a.onmousemove=n,this.working=!0}}stop(){if(this.working){var r=this.screen.ctx.canvas;this.working=!1,r.onclick=null,r.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:r,events:t,eventElements:n}=this,{style:a}=r.ctx.canvas;a&&(a.cursor=""),t.forEach((i,s)=>{for(var{run:o}=i,u=n[s];u;)o(u),u=u.parent}),this.events=[],this.eventElements=[]}}checkPath(r,t){if(!(!this.working||!t)){var{events:n,eventElements:a}=this;n.forEach((i,s)=>{var{x:o,y:u}=i;!a[s]&&t.isPointInPath&&t.isPointInPath(o,u)&&(a[s]=r)})}}checkBoundingBox(r,t){if(!(!this.working||!t)){var{events:n,eventElements:a}=this;n.forEach((i,s)=>{var{x:o,y:u}=i;!a[s]&&t.isPointInBox(o,u)&&(a[s]=r)})}}mapXY(r,t){for(var{window:n,ctx:a}=this.screen,i=new Br(r,t),s=a.canvas;s;)i.x-=s.offsetLeft,i.y-=s.offsetTop,s=s.offsetParent;return n.scrollX&&(i.x+=n.scrollX),n.scrollY&&(i.y+=n.scrollY),i}onClick(r){var{x:t,y:n}=this.mapXY(r.clientX,r.clientY);this.events.push({type:"onclick",x:t,y:n,run(a){a.onClick&&a.onClick()}})}onMouseMove(r){var{x:t,y:n}=this.mapXY(r.clientX,r.clientY);this.events.push({type:"onmousemove",x:t,y:n,run(a){a.onMouseMove&&a.onMouseMove()}})}}var YP=typeof window<"u"?window:null,KP=typeof fetch<"u"?fetch.bind(void 0):null;class vu{constructor(r){var{fetch:t=KP,window:n=YP}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.ctx=r,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new GP,this.mouse=new WP(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=n,this.fetch=t}wait(r){this.waits.push(r)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var r=this.waits.every(t=>t());return r&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=r,r}setDefaults(r){r.strokeStyle="rgba(0,0,0,0)",r.lineCap="butt",r.lineJoin="miter",r.miterLimit=4}setViewBox(r){var{document:t,ctx:n,aspectRatio:a,width:i,desiredWidth:s,height:o,desiredHeight:u,minX:l=0,minY:c=0,refX:f,refY:h,clip:d=!1,clipX:v=0,clipY:p=0}=r,x=Cs(a).replace(/^defer\s/,""),[g,N]=x.split(" "),b=g||"xMidYMid",y=N||"meet",_=i/s,w=o/u,C=Math.min(_,w),k=Math.max(_,w),D=s,U=u;y==="meet"&&(D*=C,U*=C),y==="slice"&&(D*=k,U*=k);var F=new Me(t,"refX",f),L=new Me(t,"refY",h),P=F.hasValue()&&L.hasValue();if(P&&n.translate(-C*F.getPixels("x"),-C*L.getPixels("y")),d){var B=C*v,G=C*p;n.beginPath(),n.moveTo(B,G),n.lineTo(i,G),n.lineTo(i,o),n.lineTo(B,o),n.closePath(),n.clip()}if(!P){var ue=y==="meet"&&C===w,oe=y==="slice"&&k===w,he=y==="meet"&&C===_,fe=y==="slice"&&k===_;b.startsWith("xMid")&&(ue||oe)&&n.translate(i/2-D/2,0),b.endsWith("YMid")&&(he||fe)&&n.translate(0,o/2-U/2),b.startsWith("xMax")&&(ue||oe)&&n.translate(i-D,0),b.endsWith("YMax")&&(he||fe)&&n.translate(0,o-U)}switch(!0){case b==="none":n.scale(_,w);break;case y==="meet":n.scale(C,C);break;case y==="slice":n.scale(k,k);break}n.translate(-l,-c)}start(r){var{enableRedraw:t=!1,ignoreMouse:n=!1,ignoreAnimation:a=!1,ignoreDimensions:i=!1,ignoreClear:s=!1,forceRedraw:o,scaleWidth:u,scaleHeight:l,offsetX:c,offsetY:f}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{FRAMERATE:h,mouse:d}=this,v=1e3/h;if(this.frameDuration=v,this.readyPromise=new Promise(b=>{this.resolveReady=b}),this.isReady()&&this.render(r,i,s,u,l,c,f),!!t){var p=Date.now(),x=p,g=0,N=()=>{p=Date.now(),g=p-x,g>=v&&(x=p-g%v,this.shouldUpdate(a,o)&&(this.render(r,i,s,u,l,c,f),d.runEvents())),this.intervalId=Eg(N)};n||d.start(),this.intervalId=Eg(N)}}stop(){this.intervalId&&(Eg.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(r,t){if(!r){var{frameDuration:n}=this,a=this.animations.reduce((i,s)=>s.update(n)||i,!1);if(a)return!0}return!!(typeof t=="function"&&t()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(r,t,n,a,i,s,o){var{CLIENT_WIDTH:u,CLIENT_HEIGHT:l,viewPort:c,ctx:f,isFirstRender:h}=this,d=f.canvas;c.clear(),d.width&&d.height?c.setCurrent(d.width,d.height):c.setCurrent(u,l);var v=r.getStyle("width"),p=r.getStyle("height");!t&&(h||typeof a!="number"&&typeof i!="number")&&(v.hasValue()&&(d.width=v.getPixels("x"),d.style&&(d.style.width="".concat(d.width,"px"))),p.hasValue()&&(d.height=p.getPixels("y"),d.style&&(d.style.height="".concat(d.height,"px"))));var x=d.clientWidth||d.width,g=d.clientHeight||d.height;if(t&&v.hasValue()&&p.hasValue()&&(x=v.getPixels("x"),g=p.getPixels("y")),c.setCurrent(x,g),typeof s=="number"&&r.getAttribute("x",!0).setValue(s),typeof o=="number"&&r.getAttribute("y",!0).setValue(o),typeof a=="number"||typeof i=="number"){var N=qt(r.getAttribute("viewBox").getString()),b=0,y=0;if(typeof a=="number"){var _=r.getStyle("width");_.hasValue()?b=_.getPixels("x")/a:isNaN(N[2])||(b=N[2]/a)}if(typeof i=="number"){var w=r.getStyle("height");w.hasValue()?y=w.getPixels("y")/i:isNaN(N[3])||(y=N[3]/i)}b||(b=y),y||(y=b),r.getAttribute("width",!0).setValue(a),r.getAttribute("height",!0).setValue(i);var C=r.getStyle("transform",!0,!0);C.setValue("".concat(C.getString()," scale(").concat(1/b,", ").concat(1/y,")"))}n||f.clearRect(0,0,x,g),r.render(f),h&&(this.isFirstRender=!1)}}vu.defaultWindow=YP;vu.defaultFetch=KP;var{defaultFetch:Hse}=vu,zse=typeof DOMParser<"u"?DOMParser:null;class ac{constructor(){var{fetch:r=Hse,DOMParser:t=zse}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fetch=r,this.DOMParser=t}parse(r){var t=this;return Va(function*(){return r.startsWith("<")?t.parseFromString(r):t.load(r)})()}parseFromString(r){var t=new this.DOMParser;try{return this.checkDocument(t.parseFromString(r,"image/svg+xml"))}catch{return this.checkDocument(t.parseFromString(r,"text/xml"))}}checkDocument(r){var t=r.getElementsByTagName("parsererror")[0];if(t)throw new Error(t.textContent);return r}load(r){var t=this;return Va(function*(){var n=yield t.fetch(r),a=yield n.text();return t.parseFromString(a)})()}}class XP{constructor(r,t){this.type="translate",this.point=null,this.point=Br.parse(t)}apply(r){var{x:t,y:n}=this.point;r.translate(t||0,n||0)}unapply(r){var{x:t,y:n}=this.point;r.translate(-1*t||0,-1*n||0)}applyToPoint(r){var{x:t,y:n}=this.point;r.applyTransform([1,0,0,1,t||0,n||0])}}class QP{constructor(r,t,n){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var a=qt(t);this.angle=new Me(r,"angle",a[0]),this.originX=n[0],this.originY=n[1],this.cx=a[1]||0,this.cy=a[2]||0}apply(r){var{cx:t,cy:n,originX:a,originY:i,angle:s}=this,o=t+a.getPixels("x"),u=n+i.getPixels("y");r.translate(o,u),r.rotate(s.getRadians()),r.translate(-o,-u)}unapply(r){var{cx:t,cy:n,originX:a,originY:i,angle:s}=this,o=t+a.getPixels("x"),u=n+i.getPixels("y");r.translate(o,u),r.rotate(-1*s.getRadians()),r.translate(-o,-u)}applyToPoint(r){var{cx:t,cy:n,angle:a}=this,i=a.getRadians();r.applyTransform([1,0,0,1,t||0,n||0]),r.applyTransform([Math.cos(i),Math.sin(i),-Math.sin(i),Math.cos(i),0,0]),r.applyTransform([1,0,0,1,-t||0,-n||0])}}class ZP{constructor(r,t,n){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var a=Br.parseScale(t);(a.x===0||a.y===0)&&(a.x=Xi,a.y=Xi),this.scale=a,this.originX=n[0],this.originY=n[1]}apply(r){var{scale:{x:t,y:n},originX:a,originY:i}=this,s=a.getPixels("x"),o=i.getPixels("y");r.translate(s,o),r.scale(t,n||t),r.translate(-s,-o)}unapply(r){var{scale:{x:t,y:n},originX:a,originY:i}=this,s=a.getPixels("x"),o=i.getPixels("y");r.translate(s,o),r.scale(1/t,1/n||t),r.translate(-s,-o)}applyToPoint(r){var{x:t,y:n}=this.scale;r.applyTransform([t||0,0,0,n||0,0,0])}}class JN{constructor(r,t,n){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=qt(t),this.originX=n[0],this.originY=n[1]}apply(r){var{originX:t,originY:n,matrix:a}=this,i=t.getPixels("x"),s=n.getPixels("y");r.translate(i,s),r.transform(a[0],a[1],a[2],a[3],a[4],a[5]),r.translate(-i,-s)}unapply(r){var{originX:t,originY:n,matrix:a}=this,i=a[0],s=a[2],o=a[4],u=a[1],l=a[3],c=a[5],f=0,h=0,d=1,v=1/(i*(l*d-c*h)-s*(u*d-c*f)+o*(u*h-l*f)),p=t.getPixels("x"),x=n.getPixels("y");r.translate(p,x),r.transform(v*(l*d-c*h),v*(c*f-u*d),v*(o*h-s*d),v*(i*d-o*f),v*(s*c-o*l),v*(o*u-i*c)),r.translate(-p,-x)}applyToPoint(r){r.applyTransform(this.matrix)}}class ey extends JN{constructor(r,t,n){super(r,t,n),this.type="skew",this.angle=null,this.angle=new Me(r,"angle",t)}}class JP extends ey{constructor(r,t,n){super(r,t,n),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}}class e5 extends ey{constructor(r,t,n){super(r,t,n),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}function $se(e){return Cs(e).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function Gse(e){var[r,t]=e.split("(");return[r.trim(),t.trim().replace(")","")]}class hi{constructor(r,t,n){this.document=r,this.transforms=[];var a=$se(t);a.forEach(i=>{if(i!=="none"){var[s,o]=Gse(i),u=hi.transformTypes[s];typeof u<"u"&&this.transforms.push(new u(this.document,o,n))}})}static fromElement(r,t){var n=t.getStyle("transform",!1,!0),[a,i=a]=t.getStyle("transform-origin",!1,!0).split(),s=[a,i];return n.hasValue()?new hi(r,n.getString(),s):null}apply(r){for(var{transforms:t}=this,n=t.length,a=0;a<n;a++)t[a].apply(r)}unapply(r){for(var{transforms:t}=this,n=t.length,a=n-1;a>=0;a--)t[a].unapply(r)}applyToPoint(r){for(var{transforms:t}=this,n=t.length,a=0;a<n;a++)t[a].applyToPoint(r)}}hi.transformTypes={translate:XP,rotate:QP,scale:ZP,matrix:JN,skewX:JP,skewY:e5};let Mr=class U1{constructor(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.document=r,this.node=t,this.captureTextNodes=n,this.attributes=Object.create(null),this.styles=Object.create(null),this.stylesSpecificity=Object.create(null),this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!(!t||t.nodeType!==1)){if(Array.from(t.attributes).forEach(o=>{var u=HP(o.nodeName);this.attributes[u]=new Me(r,u,o.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var a=this.getAttribute("style").getString().split(";").map(o=>o.trim());a.forEach(o=>{if(o){var[u,l]=o.split(":").map(c=>c.trim());this.styles[u]=new Me(r,u,l)}})}var{definitions:i}=r,s=this.getAttribute("id");s.hasValue()&&(i[s.getString()]||(i[s.getString()]=this)),Array.from(t.childNodes).forEach(o=>{if(o.nodeType===1)this.addChild(o);else if(n&&(o.nodeType===3||o.nodeType===4)){var u=r.createTextNode(o);u.getText().length>0&&this.addChild(u)}})}}getAttribute(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.attributes[r];if(!n&&t){var a=new Me(this.document,r,"");return this.attributes[r]=a,a}return n||Me.empty(this.document)}getHrefAttribute(){for(var r in this.attributes)if(r==="href"||r.endsWith(":href"))return this.attributes[r];return Me.empty(this.document)}getStyle(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.styles[r];if(a)return a;var i=this.getAttribute(r);if(i!=null&&i.hasValue())return this.styles[r]=i,i;if(!n){var{parent:s}=this;if(s){var o=s.getStyle(r);if(o!=null&&o.hasValue())return o}}if(t){var u=new Me(this.document,r,"");return this.styles[r]=u,u}return a||Me.empty(this.document)}render(r){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(r.save(),this.getStyle("mask").hasValue()){var t=this.getStyle("mask").getDefinition();t&&(this.applyEffects(r),t.apply(r,this))}else if(this.getStyle("filter").getValue("none")!=="none"){var n=this.getStyle("filter").getDefinition();n&&(this.applyEffects(r),n.apply(r,this))}else this.setContext(r),this.renderChildren(r),this.clearContext(r);r.restore()}}setContext(r){}applyEffects(r){var t=hi.fromElement(this.document,this);t&&t.apply(r);var n=this.getStyle("clip-path",!1,!0);if(n.hasValue()){var a=n.getDefinition();a&&a.apply(r)}}clearContext(r){}renderChildren(r){this.children.forEach(t=>{t.render(r)})}addChild(r){var t=r instanceof U1?r:this.document.createElement(r);t.parent=this,U1.ignoreChildTypes.includes(t.type)||this.children.push(t)}matchesSelector(r){var t,{node:n}=this;if(typeof n.matches=="function")return n.matches(r);var a=(t=n.getAttribute)===null||t===void 0?void 0:t.call(n,"class");return!a||a===""?!1:a.split(" ").some(i=>".".concat(i)===r)}addStylesFromStyleDefinition(){var{styles:r,stylesSpecificity:t}=this.document;for(var n in r)if(!n.startsWith("@")&&this.matchesSelector(n)){var a=r[n],i=t[n];if(a)for(var s in a){var o=this.stylesSpecificity[s];typeof o>"u"&&(o="000"),i>=o&&(this.styles[s]=a[s],this.stylesSpecificity[s]=i)}}}removeStyles(r,t){var n=t.reduce((a,i)=>{var s=r.getStyle(i);if(!s.hasValue())return a;var o=s.getString();return s.setValue(""),[...a,[i,o]]},[]);return n}restoreStyles(r,t){t.forEach(n=>{var[a,i]=n;r.getStyle(a,!0).setValue(i)})}isFirstChild(){var r;return((r=this.parent)===null||r===void 0?void 0:r.children.indexOf(this))===0}};Mr.ignoreChildTypes=["title"];class r5 extends Mr{constructor(r,t,n){super(r,t,n)}}function Wse(e){var r=e.trim();return/^('|")/.test(r)?r:'"'.concat(r,'"')}function Yse(e){return typeof process>"u"?e:e.trim().split(",").map(Wse).join(",")}function Kse(e){if(!e)return"";var r=e.trim().toLowerCase();switch(r){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return r;default:return/^oblique\s+(-|)\d+deg$/.test(r)?r:""}}function Xse(e){if(!e)return"";var r=e.trim().toLowerCase();switch(r){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return r;default:return/^[\d.]+$/.test(r)?r:""}}class _t{constructor(r,t,n,a,i,s){var o=s?typeof s=="string"?_t.parse(s):s:{};this.fontFamily=i||o.fontFamily,this.fontSize=a||o.fontSize,this.fontStyle=r||o.fontStyle,this.fontWeight=n||o.fontWeight,this.fontVariant=t||o.fontVariant}static parse(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n="",a="",i="",s="",o="",u=Cs(r).trim().split(" "),l={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return u.forEach(c=>{switch(!0){case(!l.fontStyle&&_t.styles.includes(c)):c!=="inherit"&&(n=c),l.fontStyle=!0;break;case(!l.fontVariant&&_t.variants.includes(c)):c!=="inherit"&&(a=c),l.fontStyle=!0,l.fontVariant=!0;break;case(!l.fontWeight&&_t.weights.includes(c)):c!=="inherit"&&(i=c),l.fontStyle=!0,l.fontVariant=!0,l.fontWeight=!0;break;case!l.fontSize:c!=="inherit"&&([s]=c.split("/")),l.fontStyle=!0,l.fontVariant=!0,l.fontWeight=!0,l.fontSize=!0;break;default:c!=="inherit"&&(o+=c)}}),new _t(n,a,i,s,o,t)}toString(){return[Kse(this.fontStyle),this.fontVariant,Xse(this.fontWeight),this.fontSize,Yse(this.fontFamily)].join(" ").trim()}}_t.styles="normal|italic|oblique|inherit";_t.variants="normal|small-caps|inherit";_t.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class En{constructor(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.NaN,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.NaN,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Number.NaN,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Number.NaN;this.x1=r,this.y1=t,this.x2=n,this.y2=a,this.addPoint(r,t),this.addPoint(n,a)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(r,t){typeof r<"u"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=r,this.x2=r),r<this.x1&&(this.x1=r),r>this.x2&&(this.x2=r)),typeof t<"u"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))}addX(r){this.addPoint(r,null)}addY(r){this.addPoint(null,r)}addBoundingBox(r){if(r){var{x1:t,y1:n,x2:a,y2:i}=r;this.addPoint(t,n),this.addPoint(a,i)}}sumCubic(r,t,n,a,i){return Math.pow(1-r,3)*t+3*Math.pow(1-r,2)*r*n+3*(1-r)*Math.pow(r,2)*a+Math.pow(r,3)*i}bezierCurveAdd(r,t,n,a,i){var s=6*t-12*n+6*a,o=-3*t+9*n-9*a+3*i,u=3*n-3*t;if(o===0){if(s===0)return;var l=-u/s;0<l&&l<1&&(r?this.addX(this.sumCubic(l,t,n,a,i)):this.addY(this.sumCubic(l,t,n,a,i)));return}var c=Math.pow(s,2)-4*u*o;if(!(c<0)){var f=(-s+Math.sqrt(c))/(2*o);0<f&&f<1&&(r?this.addX(this.sumCubic(f,t,n,a,i)):this.addY(this.sumCubic(f,t,n,a,i)));var h=(-s-Math.sqrt(c))/(2*o);0<h&&h<1&&(r?this.addX(this.sumCubic(h,t,n,a,i)):this.addY(this.sumCubic(h,t,n,a,i)))}}addBezierCurve(r,t,n,a,i,s,o,u){this.addPoint(r,t),this.addPoint(o,u),this.bezierCurveAdd(!0,r,n,i,o),this.bezierCurveAdd(!1,t,a,s,u)}addQuadraticCurve(r,t,n,a,i,s){var o=r+.6666666666666666*(n-r),u=t+2/3*(a-t),l=o+1/3*(i-r),c=u+1/3*(s-t);this.addBezierCurve(r,t,o,l,u,c,i,s)}isPointInBox(r,t){var{x1:n,y1:a,x2:i,y2:s}=this;return n<=r&&r<=i&&a<=t&&t<=s}}class Ge extends ge{constructor(r){super(r.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new Br(0,0),this.control=new Br(0,0),this.current=new Br(0,0),this.points=[],this.angles=[]}isEnd(){var{i:r,commands:t}=this;return r>=t.length-1}next(){var r=this.commands[++this.i];return this.previousCommand=this.command,this.command=r,r}getPoint(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y",n=new Br(this.command[r],this.command[t]);return this.makeAbsolute(n)}getAsControlPoint(r,t){var n=this.getPoint(r,t);return this.control=n,n}getAsCurrentPoint(r,t){var n=this.getPoint(r,t);return this.current=n,n}getReflectedControlPoint(){var r=this.previousCommand.type;if(r!==ge.CURVE_TO&&r!==ge.SMOOTH_CURVE_TO&&r!==ge.QUAD_TO&&r!==ge.SMOOTH_QUAD_TO)return this.current;var{current:{x:t,y:n},control:{x:a,y:i}}=this,s=new Br(2*t-a,2*n-i);return s}makeAbsolute(r){if(this.command.relative){var{x:t,y:n}=this.current;r.x+=t,r.y+=n}return r}addMarker(r,t,n){var{points:a,angles:i}=this;n&&i.length>0&&!i[i.length-1]&&(i[i.length-1]=a[a.length-1].angleTo(n)),this.addMarkerAngle(r,t?t.angleTo(r):null)}addMarkerAngle(r,t){this.points.push(r),this.angles.push(t)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:r}=this,t=r.length,n=0;n<t;n++)if(!r[n]){for(var a=n+1;a<t;a++)if(r[a]){r[n]=r[a];break}}return r}}class wi extends Mr{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var r=1,t=this;t;){var n=t.getStyle("opacity",!1,!0);n.hasValue(!0)&&(r*=n.getNumber()),t=t.parent}return r}setContext(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!t){var n=this.getStyle("fill"),a=this.getStyle("fill-opacity"),i=this.getStyle("stroke"),s=this.getStyle("stroke-opacity");if(n.isUrlDefinition()){var o=n.getFillStyleDefinition(this,a);o&&(r.fillStyle=o)}else if(n.hasValue()){n.getString()==="currentColor"&&n.setValue(this.getStyle("color").getColor());var u=n.getColor();u!=="inherit"&&(r.fillStyle=u==="none"?"rgba(0,0,0,0)":u)}if(a.hasValue()){var l=new Me(this.document,"fill",r.fillStyle).addOpacity(a).getColor();r.fillStyle=l}if(i.isUrlDefinition()){var c=i.getFillStyleDefinition(this,s);c&&(r.strokeStyle=c)}else if(i.hasValue()){i.getString()==="currentColor"&&i.setValue(this.getStyle("color").getColor());var f=i.getString();f!=="inherit"&&(r.strokeStyle=f==="none"?"rgba(0,0,0,0)":f)}if(s.hasValue()){var h=new Me(this.document,"stroke",r.strokeStyle).addOpacity(s).getString();r.strokeStyle=h}var d=this.getStyle("stroke-width");if(d.hasValue()){var v=d.getPixels();r.lineWidth=v||Xi}var p=this.getStyle("stroke-linecap"),x=this.getStyle("stroke-linejoin"),g=this.getStyle("stroke-miterlimit"),N=this.getStyle("stroke-dasharray"),b=this.getStyle("stroke-dashoffset");if(p.hasValue()&&(r.lineCap=p.getString()),x.hasValue()&&(r.lineJoin=x.getString()),g.hasValue()&&(r.miterLimit=g.getNumber()),N.hasValue()&&N.getString()!=="none"){var y=qt(N.getString());typeof r.setLineDash<"u"?r.setLineDash(y):typeof r.webkitLineDash<"u"?r.webkitLineDash=y:typeof r.mozDash<"u"&&!(y.length===1&&y[0]===0)&&(r.mozDash=y);var _=b.getPixels();typeof r.lineDashOffset<"u"?r.lineDashOffset=_:typeof r.webkitLineDashOffset<"u"?r.webkitLineDashOffset=_:typeof r.mozDashOffset<"u"&&(r.mozDashOffset=_)}}if(this.modifiedEmSizeStack=!1,typeof r.font<"u"){var w=this.getStyle("font"),C=this.getStyle("font-style"),k=this.getStyle("font-variant"),D=this.getStyle("font-weight"),U=this.getStyle("font-size"),F=this.getStyle("font-family"),L=new _t(C.getString(),k.getString(),D.getString(),U.hasValue()?"".concat(U.getPixels(!0),"px"):"",F.getString(),_t.parse(w.getString(),r.font));C.setValue(L.fontStyle),k.setValue(L.fontVariant),D.setValue(L.fontWeight),U.setValue(L.fontSize),F.setValue(L.fontFamily),r.font=L.toString(),U.isPixels()&&(this.document.emSize=U.getPixels(),this.modifiedEmSizeStack=!0)}t||(this.applyEffects(r),r.globalAlpha=this.calculateOpacity())}clearContext(r){super.clearContext(r),this.modifiedEmSizeStack&&this.document.popEmSize()}}class fr extends wi{constructor(r,t,n){super(r,t,n),this.type="path",this.pathParser=null,this.pathParser=new Ge(this.getAttribute("d").getString())}path(r){var{pathParser:t}=this,n=new En;for(t.reset(),r&&r.beginPath();!t.isEnd();)switch(t.next().type){case Ge.MOVE_TO:this.pathM(r,n);break;case Ge.LINE_TO:this.pathL(r,n);break;case Ge.HORIZ_LINE_TO:this.pathH(r,n);break;case Ge.VERT_LINE_TO:this.pathV(r,n);break;case Ge.CURVE_TO:this.pathC(r,n);break;case Ge.SMOOTH_CURVE_TO:this.pathS(r,n);break;case Ge.QUAD_TO:this.pathQ(r,n);break;case Ge.SMOOTH_QUAD_TO:this.pathT(r,n);break;case Ge.ARC:this.pathA(r,n);break;case Ge.CLOSE_PATH:this.pathZ(r,n);break}return n}getBoundingBox(r){return this.path()}getMarkers(){var{pathParser:r}=this,t=r.getMarkerPoints(),n=r.getMarkerAngles(),a=t.map((i,s)=>[i,n[s]]);return a}renderChildren(r){this.path(r),this.document.screen.mouse.checkPath(this,r);var t=this.getStyle("fill-rule");r.fillStyle!==""&&(t.getString("inherit")!=="inherit"?r.fill(t.getString()):r.fill()),r.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(r.save(),r.setTransform(1,0,0,1,0,0),r.stroke(),r.restore()):r.stroke());var n=this.getMarkers();if(n){var a=n.length-1,i=this.getStyle("marker-start"),s=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(i.isUrlDefinition()){var u=i.getDefinition(),[l,c]=n[0];u.render(r,l,c)}if(s.isUrlDefinition())for(var f=s.getDefinition(),h=1;h<a;h++){var[d,v]=n[h];f.render(r,d,v)}if(o.isUrlDefinition()){var p=o.getDefinition(),[x,g]=n[a];p.render(r,x,g)}}}static pathM(r){var t=r.getAsCurrentPoint();return r.start=r.current,{point:t}}pathM(r,t){var{pathParser:n}=this,{point:a}=fr.pathM(n),{x:i,y:s}=a;n.addMarker(a),t.addPoint(i,s),r&&r.moveTo(i,s)}static pathL(r){var{current:t}=r,n=r.getAsCurrentPoint();return{current:t,point:n}}pathL(r,t){var{pathParser:n}=this,{current:a,point:i}=fr.pathL(n),{x:s,y:o}=i;n.addMarker(i,a),t.addPoint(s,o),r&&r.lineTo(s,o)}static pathH(r){var{current:t,command:n}=r,a=new Br((n.relative?t.x:0)+n.x,t.y);return r.current=a,{current:t,point:a}}pathH(r,t){var{pathParser:n}=this,{current:a,point:i}=fr.pathH(n),{x:s,y:o}=i;n.addMarker(i,a),t.addPoint(s,o),r&&r.lineTo(s,o)}static pathV(r){var{current:t,command:n}=r,a=new Br(t.x,(n.relative?t.y:0)+n.y);return r.current=a,{current:t,point:a}}pathV(r,t){var{pathParser:n}=this,{current:a,point:i}=fr.pathV(n),{x:s,y:o}=i;n.addMarker(i,a),t.addPoint(s,o),r&&r.lineTo(s,o)}static pathC(r){var{current:t}=r,n=r.getPoint("x1","y1"),a=r.getAsControlPoint("x2","y2"),i=r.getAsCurrentPoint();return{current:t,point:n,controlPoint:a,currentPoint:i}}pathC(r,t){var{pathParser:n}=this,{current:a,point:i,controlPoint:s,currentPoint:o}=fr.pathC(n);n.addMarker(o,s,i),t.addBezierCurve(a.x,a.y,i.x,i.y,s.x,s.y,o.x,o.y),r&&r.bezierCurveTo(i.x,i.y,s.x,s.y,o.x,o.y)}static pathS(r){var{current:t}=r,n=r.getReflectedControlPoint(),a=r.getAsControlPoint("x2","y2"),i=r.getAsCurrentPoint();return{current:t,point:n,controlPoint:a,currentPoint:i}}pathS(r,t){var{pathParser:n}=this,{current:a,point:i,controlPoint:s,currentPoint:o}=fr.pathS(n);n.addMarker(o,s,i),t.addBezierCurve(a.x,a.y,i.x,i.y,s.x,s.y,o.x,o.y),r&&r.bezierCurveTo(i.x,i.y,s.x,s.y,o.x,o.y)}static pathQ(r){var{current:t}=r,n=r.getAsControlPoint("x1","y1"),a=r.getAsCurrentPoint();return{current:t,controlPoint:n,currentPoint:a}}pathQ(r,t){var{pathParser:n}=this,{current:a,controlPoint:i,currentPoint:s}=fr.pathQ(n);n.addMarker(s,i,i),t.addQuadraticCurve(a.x,a.y,i.x,i.y,s.x,s.y),r&&r.quadraticCurveTo(i.x,i.y,s.x,s.y)}static pathT(r){var{current:t}=r,n=r.getReflectedControlPoint();r.control=n;var a=r.getAsCurrentPoint();return{current:t,controlPoint:n,currentPoint:a}}pathT(r,t){var{pathParser:n}=this,{current:a,controlPoint:i,currentPoint:s}=fr.pathT(n);n.addMarker(s,i,i),t.addQuadraticCurve(a.x,a.y,i.x,i.y,s.x,s.y),r&&r.quadraticCurveTo(i.x,i.y,s.x,s.y)}static pathA(r){var{current:t,command:n}=r,{rX:a,rY:i,xRot:s,lArcFlag:o,sweepFlag:u}=n,l=s*(Math.PI/180),c=r.getAsCurrentPoint(),f=new Br(Math.cos(l)*(t.x-c.x)/2+Math.sin(l)*(t.y-c.y)/2,-Math.sin(l)*(t.x-c.x)/2+Math.cos(l)*(t.y-c.y)/2),h=Math.pow(f.x,2)/Math.pow(a,2)+Math.pow(f.y,2)/Math.pow(i,2);h>1&&(a*=Math.sqrt(h),i*=Math.sqrt(h));var d=(o===u?-1:1)*Math.sqrt((Math.pow(a,2)*Math.pow(i,2)-Math.pow(a,2)*Math.pow(f.y,2)-Math.pow(i,2)*Math.pow(f.x,2))/(Math.pow(a,2)*Math.pow(f.y,2)+Math.pow(i,2)*Math.pow(f.x,2)));isNaN(d)&&(d=0);var v=new Br(d*a*f.y/i,d*-i*f.x/a),p=new Br((t.x+c.x)/2+Math.cos(l)*v.x-Math.sin(l)*v.y,(t.y+c.y)/2+Math.sin(l)*v.x+Math.cos(l)*v.y),x=S1([1,0],[(f.x-v.x)/a,(f.y-v.y)/i]),g=[(f.x-v.x)/a,(f.y-v.y)/i],N=[(-f.x-v.x)/a,(-f.y-v.y)/i],b=S1(g,N);return Kc(g,N)<=-1&&(b=Math.PI),Kc(g,N)>=1&&(b=0),{currentPoint:c,rX:a,rY:i,sweepFlag:u,xAxisRotation:l,centp:p,a1:x,ad:b}}pathA(r,t){var{pathParser:n}=this,{currentPoint:a,rX:i,rY:s,sweepFlag:o,xAxisRotation:u,centp:l,a1:c,ad:f}=fr.pathA(n),h=1-o?1:-1,d=c+h*(f/2),v=new Br(l.x+i*Math.cos(d),l.y+s*Math.sin(d));if(n.addMarkerAngle(v,d-h*Math.PI/2),n.addMarkerAngle(a,d-h*Math.PI),t.addPoint(a.x,a.y),r&&!isNaN(c)&&!isNaN(f)){var p=i>s?i:s,x=i>s?1:i/s,g=i>s?s/i:1;r.translate(l.x,l.y),r.rotate(u),r.scale(x,g),r.arc(0,0,p,c,c+f,!!(1-o)),r.scale(1/x,1/g),r.rotate(-u),r.translate(-l.x,-l.y)}}static pathZ(r){r.current=r.start}pathZ(r,t){fr.pathZ(this.pathParser),r&&t.x1!==t.x2&&t.y1!==t.y2&&r.closePath()}}class ry extends fr{constructor(r,t,n){super(r,t,n),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class Ma extends wi{constructor(r,t,n){super(r,t,new.target===Ma?!0:n),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(r,t);var n=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();n&&(r.textBaseline=n)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(r){if(this.type!=="text")return this.getTElementBoundingBox(r);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(r);var t=null;return this.children.forEach((n,a)=>{var i=this.getChildBoundingBox(r,this,this,a);t?t.addBoundingBox(i):t=i}),t}getFontSize(){var{document:r,parent:t}=this,n=_t.parse(r.ctx.font).fontSize,a=t.getStyle("font-size").getNumber(n);return a}getTElementBoundingBox(r){var t=this.getFontSize();return new En(this.x,this.y-t,this.x+this.measureText(r),this.y)}getGlyph(r,t,n){var a=t[n],i=null;if(r.isArabic){var s=t.length,o=t[n-1],u=t[n+1],l="isolated";if((n===0||o===" ")&&n<s-1&&u!==" "&&(l="terminal"),n>0&&o!==" "&&n<s-1&&u!==" "&&(l="medial"),n>0&&o!==" "&&(n===s-1||u===" ")&&(l="initial"),typeof r.glyphs[a]<"u"){var c=r.glyphs[a];i=c instanceof ry?c:c[l]}}else i=r.glyphs[a];return i||(i=r.missingGlyph),i}getText(){return""}getTextFromNode(r){var t=r||this.node,n=Array.from(t.parentNode.childNodes),a=n.indexOf(t),i=n.length-1,s=Cs(t.textContent||"");return a===0&&(s=BP(s)),a===i&&(s=qP(s)),s}renderChildren(r){if(this.type!=="text"){this.renderTElementChildren(r);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(r),this.children.forEach((n,a)=>{this.renderChild(r,this,this,a)});var{mouse:t}=this.document.screen;t.isWorking()&&t.checkBoundingBox(this,this.getBoundingBox(r))}renderTElementChildren(r){var{document:t,parent:n}=this,a=this.getText(),i=n.getStyle("font-family").getDefinition();if(i){for(var{unitsPerEm:s}=i.fontFace,o=_t.parse(t.ctx.font),u=n.getStyle("font-size").getNumber(o.fontSize),l=n.getStyle("font-style").getString(o.fontStyle),c=u/s,f=i.isRTL?a.split("").reverse().join(""):a,h=qt(n.getAttribute("dx").getString()),d=f.length,v=0;v<d;v++){var p=this.getGlyph(i,f,v);r.translate(this.x,this.y),r.scale(c,-c);var x=r.lineWidth;r.lineWidth=r.lineWidth*s/u,l==="italic"&&r.transform(1,0,.4,1,0,0),p.render(r),l==="italic"&&r.transform(1,0,-.4,1,0,0),r.lineWidth=x,r.scale(1/c,-1/c),r.translate(-this.x,-this.y),this.x+=u*(p.horizAdvX||i.horizAdvX)/s,typeof h[v]<"u"&&!isNaN(h[v])&&(this.x+=h[v])}return}var{x:g,y:N}=this;r.fillStyle&&r.fillText(a,g,N),r.strokeStyle&&r.strokeText(a,g,N)}applyAnchoring(){if(!(this.textChunkStart>=this.leafTexts.length)){var r=this.leafTexts[this.textChunkStart],t=r.getStyle("text-anchor").getString("start"),n=!1,a=0;t==="start"&&!n||t==="end"&&n?a=r.x-this.minX:t==="end"&&!n||t==="start"&&n?a=r.x-this.maxX:a=r.x-(this.minX+this.maxX)/2;for(var i=this.textChunkStart;i<this.leafTexts.length;i++)this.leafTexts[i].x+=a;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}}adjustChildCoordinatesRecursive(r){this.children.forEach((t,n)=>{this.adjustChildCoordinatesRecursiveCore(r,this,this,n)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(r,t,n,a){var i=n.children[a];i.children.length>0?i.children.forEach((s,o)=>{t.adjustChildCoordinatesRecursiveCore(r,t,i,o)}):this.adjustChildCoordinates(r,t,n,a)}adjustChildCoordinates(r,t,n,a){var i=n.children[a];if(typeof i.measureText!="function")return i;r.save(),i.setContext(r,!0);var s=i.getAttribute("x"),o=i.getAttribute("y"),u=i.getAttribute("dx"),l=i.getAttribute("dy"),c=i.getStyle("font-family").getDefinition(),f=!!c&&c.isRTL;a===0&&(s.hasValue()||s.setValue(i.getInheritedAttribute("x")),o.hasValue()||o.setValue(i.getInheritedAttribute("y")),u.hasValue()||u.setValue(i.getInheritedAttribute("dx")),l.hasValue()||l.setValue(i.getInheritedAttribute("dy")));var h=i.measureText(r);return f&&(t.x-=h),s.hasValue()?(t.applyAnchoring(),i.x=s.getPixels("x"),u.hasValue()&&(i.x+=u.getPixels("x"))):(u.hasValue()&&(t.x+=u.getPixels("x")),i.x=t.x),t.x=i.x,f||(t.x+=h),o.hasValue()?(i.y=o.getPixels("y"),l.hasValue()&&(i.y+=l.getPixels("y"))):(l.hasValue()&&(t.y+=l.getPixels("y")),i.y=t.y),t.y=i.y,t.leafTexts.push(i),t.minX=Math.min(t.minX,i.x,i.x+h),t.maxX=Math.max(t.maxX,i.x,i.x+h),i.clearContext(r),r.restore(),i}getChildBoundingBox(r,t,n,a){var i=n.children[a];if(typeof i.getBoundingBox!="function")return null;var s=i.getBoundingBox(r);return s?(i.children.forEach((o,u)=>{var l=t.getChildBoundingBox(r,t,i,u);s.addBoundingBox(l)}),s):null}renderChild(r,t,n,a){var i=n.children[a];i.render(r),i.children.forEach((s,o)=>{t.renderChild(r,t,i,o)})}measureText(r){var{measureCache:t}=this;if(~t)return t;var n=this.getText(),a=this.measureTargetText(r,n);return this.measureCache=a,a}measureTargetText(r,t){if(!t.length)return 0;var{parent:n}=this,a=n.getStyle("font-family").getDefinition();if(a){for(var i=this.getFontSize(),s=a.isRTL?t.split("").reverse().join(""):t,o=qt(n.getAttribute("dx").getString()),u=s.length,l=0,c=0;c<u;c++){var f=this.getGlyph(a,s,c);l+=(f.horizAdvX||a.horizAdvX)*i/a.fontFace.unitsPerEm,typeof o[c]<"u"&&!isNaN(o[c])&&(l+=o[c])}return l}if(!r.measureText)return t.length*10;r.save(),this.setContext(r,!0);var{width:h}=r.measureText(t);return this.clearContext(r),r.restore(),h}getInheritedAttribute(r){for(var t=this;t instanceof Ma&&t.isFirstChild();){var n=t.parent.getAttribute(r);if(n.hasValue(!0))return n.getValue("0");t=t.parent}return null}}class xu extends Ma{constructor(r,t,n){super(r,t,new.target===xu?!0:n),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}}class Qse extends xu{constructor(){super(...arguments),this.type="textNode"}}class To extends wi{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(r){var t,{document:n}=this,{screen:a,window:i}=n,s=r.canvas;if(a.setDefaults(r),s.style&&typeof r.font<"u"&&i&&typeof i.getComputedStyle<"u"){r.font=i.getComputedStyle(s).getPropertyValue("font");var o=new Me(n,"fontSize",_t.parse(r.font).fontSize);o.hasValue()&&(n.rootEmSize=o.getPixels("y"),n.emSize=n.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:u,height:l}=a.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var c=this.getAttribute("refX"),f=this.getAttribute("refY"),h=this.getAttribute("viewBox"),d=h.hasValue()?qt(h.getString()):null,v=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible",p=0,x=0,g=0,N=0;d&&(p=d[0],x=d[1]),this.root||(u=this.getStyle("width").getPixels("x"),l=this.getStyle("height").getPixels("y"),this.type==="marker"&&(g=p,N=x,p=0,x=0)),a.viewPort.setCurrent(u,l),this.node&&(!this.parent||((t=this.node.parentNode)===null||t===void 0?void 0:t.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(r),r.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),d&&(u=d[2],l=d[3]),n.setViewBox({ctx:r,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:a.viewPort.width,desiredWidth:u,height:a.viewPort.height,desiredHeight:l,minX:p,minY:x,refX:c.getValue(),refY:f.getValue(),clip:v,clipX:g,clipY:N}),d&&(a.viewPort.removeCurrent(),a.viewPort.setCurrent(u,l))}clearContext(r){super.clearContext(r),this.document.screen.viewPort.removeCurrent()}resize(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.getAttribute("width",!0),i=this.getAttribute("height",!0),s=this.getAttribute("viewBox"),o=this.getAttribute("style"),u=a.getNumber(0),l=i.getNumber(0);if(n)if(typeof n=="string")this.getAttribute("preserveAspectRatio",!0).setValue(n);else{var c=this.getAttribute("preserveAspectRatio");c.hasValue()&&c.setValue(c.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(a.setValue(r),i.setValue(t),s.hasValue()||s.setValue("0 0 ".concat(u||r," ").concat(l||t)),o.hasValue()){var f=this.getStyle("width"),h=this.getStyle("height");f.hasValue()&&f.setValue("".concat(r,"px")),h.hasValue()&&h.setValue("".concat(t,"px"))}}}class ty extends fr{constructor(){super(...arguments),this.type="rect"}path(r){var t=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),a=this.getStyle("width",!1,!0).getPixels("x"),i=this.getStyle("height",!1,!0).getPixels("y"),s=this.getAttribute("rx"),o=this.getAttribute("ry"),u=s.getPixels("x"),l=o.getPixels("y");if(s.hasValue()&&!o.hasValue()&&(l=u),o.hasValue()&&!s.hasValue()&&(u=l),u=Math.min(u,a/2),l=Math.min(l,i/2),r){var c=4*((Math.sqrt(2)-1)/3);r.beginPath(),i>0&&a>0&&(r.moveTo(t+u,n),r.lineTo(t+a-u,n),r.bezierCurveTo(t+a-u+c*u,n,t+a,n+l-c*l,t+a,n+l),r.lineTo(t+a,n+i-l),r.bezierCurveTo(t+a,n+i-l+c*l,t+a-u+c*u,n+i,t+a-u,n+i),r.lineTo(t+u,n+i),r.bezierCurveTo(t+u-c*u,n+i,t,n+i-l+c*l,t,n+i-l),r.lineTo(t,n+l),r.bezierCurveTo(t,n+l-c*l,t+u-c*u,n,t+u,n),r.closePath())}return new En(t,n,t+a,n+i)}getMarkers(){return null}}class t5 extends fr{constructor(){super(...arguments),this.type="circle"}path(r){var t=this.getAttribute("cx").getPixels("x"),n=this.getAttribute("cy").getPixels("y"),a=this.getAttribute("r").getPixels();return r&&a>0&&(r.beginPath(),r.arc(t,n,a,0,Math.PI*2,!1),r.closePath()),new En(t-a,n-a,t+a,n+a)}getMarkers(){return null}}class n5 extends fr{constructor(){super(...arguments),this.type="ellipse"}path(r){var t=4*((Math.sqrt(2)-1)/3),n=this.getAttribute("rx").getPixels("x"),a=this.getAttribute("ry").getPixels("y"),i=this.getAttribute("cx").getPixels("x"),s=this.getAttribute("cy").getPixels("y");return r&&n>0&&a>0&&(r.beginPath(),r.moveTo(i+n,s),r.bezierCurveTo(i+n,s+t*a,i+t*n,s+a,i,s+a),r.bezierCurveTo(i-t*n,s+a,i-n,s+t*a,i-n,s),r.bezierCurveTo(i-n,s-t*a,i-t*n,s-a,i,s-a),r.bezierCurveTo(i+t*n,s-a,i+n,s-t*a,i+n,s),r.closePath()),new En(i-n,s-a,i+n,s+a)}getMarkers(){return null}}class a5 extends fr{constructor(){super(...arguments),this.type="line"}getPoints(){return[new Br(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new Br(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(r){var[{x:t,y:n},{x:a,y:i}]=this.getPoints();return r&&(r.beginPath(),r.moveTo(t,n),r.lineTo(a,i)),new En(t,n,a,i)}getMarkers(){var[r,t]=this.getPoints(),n=r.angleTo(t);return[[r,n],[t,n]]}}class ny extends fr{constructor(r,t,n){super(r,t,n),this.type="polyline",this.points=[],this.points=Br.parsePath(this.getAttribute("points").getString())}path(r){var{points:t}=this,[{x:n,y:a}]=t,i=new En(n,a);return r&&(r.beginPath(),r.moveTo(n,a)),t.forEach(s=>{var{x:o,y:u}=s;i.addPoint(o,u),r&&r.lineTo(o,u)}),i}getMarkers(){var{points:r}=this,t=r.length-1,n=[];return r.forEach((a,i)=>{i!==t&&n.push([a,a.angleTo(r[i+1])])}),n.length>0&&n.push([r[r.length-1],n[n.length-1][1]]),n}}class i5 extends ny{constructor(){super(...arguments),this.type="polygon"}path(r){var t=super.path(r),[{x:n,y:a}]=this.points;return r&&(r.lineTo(n,a),r.closePath()),t}}class s5 extends Mr{constructor(){super(...arguments),this.type="pattern"}createPattern(r,t,n){var a=this.getStyle("width").getPixels("x",!0),i=this.getStyle("height").getPixels("y",!0),s=new To(this.document,null);s.attributes.viewBox=new Me(this.document,"viewBox",this.getAttribute("viewBox").getValue()),s.attributes.width=new Me(this.document,"width","".concat(a,"px")),s.attributes.height=new Me(this.document,"height","".concat(i,"px")),s.attributes.transform=new Me(this.document,"transform",this.getAttribute("patternTransform").getValue()),s.children=this.children;var o=this.document.createCanvas(a,i),u=o.getContext("2d"),l=this.getAttribute("x"),c=this.getAttribute("y");l.hasValue()&&c.hasValue()&&u.translate(l.getPixels("x",!0),c.getPixels("y",!0)),n.hasValue()?this.styles["fill-opacity"]=n:Reflect.deleteProperty(this.styles,"fill-opacity");for(var f=-1;f<=1;f++)for(var h=-1;h<=1;h++)u.save(),s.attributes.x=new Me(this.document,"x",f*o.width),s.attributes.y=new Me(this.document,"y",h*o.height),s.render(u),u.restore();var d=r.createPattern(o,"repeat");return d}}class o5 extends Mr{constructor(){super(...arguments),this.type="marker"}render(r,t,n){if(t){var{x:a,y:i}=t,s=this.getAttribute("orient").getString("auto"),o=this.getAttribute("markerUnits").getString("strokeWidth");r.translate(a,i),s==="auto"&&r.rotate(n),o==="strokeWidth"&&r.scale(r.lineWidth,r.lineWidth),r.save();var u=new To(this.document,null);u.type=this.type,u.attributes.viewBox=new Me(this.document,"viewBox",this.getAttribute("viewBox").getValue()),u.attributes.refX=new Me(this.document,"refX",this.getAttribute("refX").getValue()),u.attributes.refY=new Me(this.document,"refY",this.getAttribute("refY").getValue()),u.attributes.width=new Me(this.document,"width",this.getAttribute("markerWidth").getValue()),u.attributes.height=new Me(this.document,"height",this.getAttribute("markerHeight").getValue()),u.attributes.overflow=new Me(this.document,"overflow",this.getAttribute("overflow").getValue()),u.attributes.fill=new Me(this.document,"fill",this.getAttribute("fill").getColor("black")),u.attributes.stroke=new Me(this.document,"stroke",this.getAttribute("stroke").getValue("none")),u.children=this.children,u.render(r),r.restore(),o==="strokeWidth"&&r.scale(1/r.lineWidth,1/r.lineWidth),s==="auto"&&r.rotate(-n),r.translate(-a,-i)}}}class l5 extends Mr{constructor(){super(...arguments),this.type="defs"}render(){}}class Kf extends wi{constructor(){super(...arguments),this.type="g"}getBoundingBox(r){var t=new En;return this.children.forEach(n=>{t.addBoundingBox(n.getBoundingBox(r))}),t}}class ay extends Mr{constructor(r,t,n){super(r,t,n),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:a,children:i}=this;i.forEach(s=>{s.type==="stop"&&a.push(s)})}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(r,t,n){var a=this;this.getHrefAttribute().hasValue()&&(a=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(a));var{stops:i}=a,s=this.getGradient(r,t);if(!s)return this.addParentOpacity(n,i[i.length-1].color);if(i.forEach(x=>{s.addColorStop(x.offset,this.addParentOpacity(n,x.color))}),this.getAttribute("gradientTransform").hasValue()){var{document:o}=this,{MAX_VIRTUAL_PIXELS:u,viewPort:l}=o.screen,[c]=l.viewPorts,f=new ty(o,null);f.attributes.x=new Me(o,"x",-u/3),f.attributes.y=new Me(o,"y",-u/3),f.attributes.width=new Me(o,"width",u),f.attributes.height=new Me(o,"height",u);var h=new Kf(o,null);h.attributes.transform=new Me(o,"transform",this.getAttribute("gradientTransform").getValue()),h.children=[f];var d=new To(o,null);d.attributes.x=new Me(o,"x",0),d.attributes.y=new Me(o,"y",0),d.attributes.width=new Me(o,"width",c.width),d.attributes.height=new Me(o,"height",c.height),d.children=[h];var v=o.createCanvas(c.width,c.height),p=v.getContext("2d");return p.fillStyle=s,d.render(p),p.createPattern(v,"no-repeat")}return s}inheritStopContainer(r){this.attributesToInherit.forEach(t=>{!this.getAttribute(t).hasValue()&&r.getAttribute(t).hasValue()&&this.getAttribute(t,!0).setValue(r.getAttribute(t).getValue())})}addParentOpacity(r,t){if(r.hasValue()){var n=new Me(this.document,"color",t);return n.addOpacity(r).getColor()}return t}}class u5 extends ay{constructor(r,t,n){super(r,t,n),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(r,t){var n=this.getGradientUnits()==="objectBoundingBox",a=n?t.getBoundingBox(r):null;if(n&&!a)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var i=n?a.x+a.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),s=n?a.y+a.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),o=n?a.x+a.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),u=n?a.y+a.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return i===o&&s===u?null:r.createLinearGradient(i,s,o,u)}}class c5 extends ay{constructor(r,t,n){super(r,t,n),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(r,t){var n=this.getGradientUnits()==="objectBoundingBox",a=t.getBoundingBox(r);if(n&&!a)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var i=n?a.x+a.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),s=n?a.y+a.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),o=i,u=s;this.getAttribute("fx").hasValue()&&(o=n?a.x+a.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(u=n?a.y+a.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var l=n?(a.width+a.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),c=this.getAttribute("fr").getPixels();return r.createRadialGradient(o,u,c,i,s,l)}}class f5 extends Mr{constructor(r,t,n){super(r,t,n),this.type="stop";var a=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),i=this.getStyle("stop-opacity"),s=this.getStyle("stop-color",!0);s.getString()===""&&s.setValue("#000"),i.hasValue()&&(s=s.addOpacity(i)),this.offset=a,this.color=s.getColor()}}class Xf extends Mr{constructor(r,t,n){super(r,t,n),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,r.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new Me(r,"values",null);var a=this.getAttribute("values");a.hasValue()&&this.values.setValue(a.getString().split(";"))}getProperty(){var r=this.getAttribute("attributeType").getString(),t=this.getAttribute("attributeName").getString();return r==="CSS"?this.parent.getStyle(t,!0):this.parent.getAttribute(t,!0)}calcValue(){var{initialUnits:r}=this,{progress:t,from:n,to:a}=this.getProgress(),i=n.getNumber()+(a.getNumber()-n.getNumber())*t;return r==="%"&&(i*=100),"".concat(i).concat(r)}update(r){var{parent:t}=this,n=this.getProperty();if(this.initialValue||(this.initialValue=n.getString(),this.initialUnits=n.getUnits()),this.duration>this.maxDuration){var a=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(a==="freeze"&&!this.frozen)this.frozen=!0,t.animationFrozen=!0,t.animationFrozenValue=n.getString();else if(a==="remove"&&!this.removed)return this.removed=!0,n.setValue(t.animationFrozen?t.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=r;var i=!1;if(this.begin<this.duration){var s=this.calcValue(),o=this.getAttribute("type");if(o.hasValue()){var u=o.getString();s="".concat(u,"(").concat(s,")")}n.setValue(s),i=!0}return i}getProgress(){var{document:r,values:t}=this,n={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(t.hasValue()){var a=n.progress*(t.getValue().length-1),i=Math.floor(a),s=Math.ceil(a);n.from=new Me(r,"from",parseFloat(t.getValue()[i])),n.to=new Me(r,"to",parseFloat(t.getValue()[s])),n.progress=(a-i)/(s-i)}else n.from=this.from,n.to=this.to;return n}}class m5 extends Xf{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:r,from:t,to:n}=this.getProgress(),a=new E1(t.getColor()),i=new E1(n.getColor());if(a.ok&&i.ok){var s=a.r+(i.r-a.r)*r,o=a.g+(i.g-a.g)*r,u=a.b+(i.b-a.b)*r;return"rgb(".concat(Math.floor(s),", ").concat(Math.floor(o),", ").concat(Math.floor(u),")")}return this.getAttribute("from").getColor()}}class d5 extends Xf{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:r,from:t,to:n}=this.getProgress(),a=qt(t.getString()),i=qt(n.getString()),s=a.map((o,u)=>{var l=i[u];return o+(l-o)*r}).join(" ");return s}}class h5 extends Mr{constructor(r,t,n){super(r,t,n),this.type="font",this.glyphs=Object.create(null),this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:a}=r,{children:i}=this;for(var s of i)switch(s.type){case"font-face":{this.fontFace=s;var o=s.getStyle("font-family");o.hasValue()&&(a[o.getString()]=this);break}case"missing-glyph":this.missingGlyph=s;break;case"glyph":{var u=s;u.arabicForm?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[u.unicode]>"u"&&(this.glyphs[u.unicode]=Object.create(null)),this.glyphs[u.unicode][u.arabicForm]=u):this.glyphs[u.unicode]=u;break}}}render(){}}class p5 extends Mr{constructor(r,t,n){super(r,t,n),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}}class v5 extends fr{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}}class x5 extends Ma{constructor(){super(...arguments),this.type="tref"}getText(){var r=this.getHrefAttribute().getDefinition();if(r){var t=r.children[0];if(t)return t.getText()}return""}}class g5 extends Ma{constructor(r,t,n){super(r,t,n),this.type="a";var{childNodes:a}=t,i=a[0],s=a.length>0&&Array.from(a).every(o=>o.nodeType===3);this.hasText=s,this.text=s?this.getTextFromNode(i):""}getText(){return this.text}renderChildren(r){if(this.hasText){super.renderChildren(r);var{document:t,x:n,y:a}=this,{mouse:i}=t.screen,s=new Me(t,"fontSize",_t.parse(t.ctx.font).fontSize);i.isWorking()&&i.checkBoundingBox(this,new En(n,a-s.getPixels("y"),n+this.measureText(r),a))}else if(this.children.length>0){var o=new Kf(this.document,null);o.children=this.children,o.parent=this,o.render(r)}}onClick(){var{window:r}=this.document;r&&r.open(this.getHrefAttribute().getString())}onMouseMove(){var r=this.document.ctx;r.canvas.style.cursor="pointer"}}function Dk(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ku(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Dk(Object(t),!0).forEach(function(n){QN(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Dk(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}class b5 extends Ma{constructor(r,t,n){super(r,t,n),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var a=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(a)}getText(){return this.text}path(r){var{dataArray:t}=this;r&&r.beginPath(),t.forEach(n=>{var{type:a,points:i}=n;switch(a){case Ge.LINE_TO:r&&r.lineTo(i[0],i[1]);break;case Ge.MOVE_TO:r&&r.moveTo(i[0],i[1]);break;case Ge.CURVE_TO:r&&r.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case Ge.QUAD_TO:r&&r.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case Ge.ARC:{var[s,o,u,l,c,f,h,d]=i,v=u>l?u:l,p=u>l?1:u/l,x=u>l?l/u:1;r&&(r.translate(s,o),r.rotate(h),r.scale(p,x),r.arc(0,0,v,c,c+f,!!(1-d)),r.scale(1/p,1/x),r.rotate(-h),r.translate(-s,-o));break}case Ge.CLOSE_PATH:r&&r.closePath();break}})}renderChildren(r){this.setTextData(r),r.save();var t=this.parent.getStyle("text-decoration").getString(),n=this.getFontSize(),{glyphInfo:a}=this,i=r.fillStyle;t==="underline"&&r.beginPath(),a.forEach((s,o)=>{var{p0:u,p1:l,rotation:c,text:f}=s;r.save(),r.translate(u.x,u.y),r.rotate(c),r.fillStyle&&r.fillText(f,0,0),r.strokeStyle&&r.strokeText(f,0,0),r.restore(),t==="underline"&&(o===0&&r.moveTo(u.x,u.y+n/8),r.lineTo(l.x,l.y+n/5))}),t==="underline"&&(r.lineWidth=n/20,r.strokeStyle=i,r.stroke(),r.closePath()),r.restore()}getLetterSpacingAt(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[r]||0}findSegmentToFitChar(r,t,n,a,i,s,o,u,l){var c=s,f=this.measureText(r,u);u===" "&&t==="justify"&&n<a&&(f+=(a-n)/i),l>-1&&(c+=this.getLetterSpacingAt(l));var h=this.textHeight/20,d=this.getEquidistantPointOnPath(c,h,0),v=this.getEquidistantPointOnPath(c+f,h,0),p={p0:d,p1:v},x=d&&v?Math.atan2(v.y-d.y,v.x-d.x):0;if(o){var g=Math.cos(Math.PI/2+x)*o,N=Math.cos(-x)*o;p.p0=Ku(Ku({},d),{},{x:d.x+g,y:d.y+N}),p.p1=Ku(Ku({},v),{},{x:v.x+g,y:v.y+N})}return c+=f,{offset:c,segment:p,rotation:x}}measureText(r,t){var{measuresCache:n}=this,a=t||this.getText();if(n.has(a))return n.get(a);var i=this.measureTargetText(r,a);return n.set(a,i),i}setTextData(r){if(!this.glyphInfo){var t=this.getText(),n=t.split(""),a=t.split(" ").length-1,i=this.parent.getAttribute("dx").split().map(y=>y.getPixels("x")),s=this.parent.getAttribute("dy").getPixels("y"),o=this.parent.getStyle("text-anchor").getString("start"),u=this.getStyle("letter-spacing"),l=this.parent.getStyle("letter-spacing"),c=0;!u.hasValue()||u.getValue()==="inherit"?c=l.getPixels():u.hasValue()&&u.getValue()!=="initial"&&u.getValue()!=="unset"&&(c=u.getPixels());var f=[],h=t.length;this.letterSpacingCache=f;for(var d=0;d<h;d++)f.push(typeof i[d]<"u"?i[d]:c);var v=f.reduce((y,_,w)=>w===0?0:y+_||0,0),p=this.measureText(r),x=Math.max(p+v,0);this.textWidth=p,this.textHeight=this.getFontSize(),this.glyphInfo=[];var g=this.getPathLength(),N=this.getStyle("startOffset").getNumber(0)*g,b=0;(o==="middle"||o==="center")&&(b=-x/2),(o==="end"||o==="right")&&(b=-x),b+=N,n.forEach((y,_)=>{var{offset:w,segment:C,rotation:k}=this.findSegmentToFitChar(r,o,x,g,a,b,s,y,_);b=w,!(!C.p0||!C.p1)&&this.glyphInfo.push({text:n[_],p0:C.p0,p1:C.p1,rotation:k})})}}parsePathData(r){if(this.pathLength=-1,!r)return[];var t=[],{pathParser:n}=r;for(n.reset();!n.isEnd();){var{current:a}=n,i=a?a.x:0,s=a?a.y:0,o=n.next(),u=o.type,l=[];switch(o.type){case Ge.MOVE_TO:this.pathM(n,l);break;case Ge.LINE_TO:u=this.pathL(n,l);break;case Ge.HORIZ_LINE_TO:u=this.pathH(n,l);break;case Ge.VERT_LINE_TO:u=this.pathV(n,l);break;case Ge.CURVE_TO:this.pathC(n,l);break;case Ge.SMOOTH_CURVE_TO:u=this.pathS(n,l);break;case Ge.QUAD_TO:this.pathQ(n,l);break;case Ge.SMOOTH_QUAD_TO:u=this.pathT(n,l);break;case Ge.ARC:l=this.pathA(n);break;case Ge.CLOSE_PATH:fr.pathZ(n);break}o.type!==Ge.CLOSE_PATH?t.push({type:u,points:l,start:{x:i,y:s},pathLength:this.calcLength(i,s,u,l)}):t.push({type:Ge.CLOSE_PATH,points:[],pathLength:0})}return t}pathM(r,t){var{x:n,y:a}=fr.pathM(r).point;t.push(n,a)}pathL(r,t){var{x:n,y:a}=fr.pathL(r).point;return t.push(n,a),Ge.LINE_TO}pathH(r,t){var{x:n,y:a}=fr.pathH(r).point;return t.push(n,a),Ge.LINE_TO}pathV(r,t){var{x:n,y:a}=fr.pathV(r).point;return t.push(n,a),Ge.LINE_TO}pathC(r,t){var{point:n,controlPoint:a,currentPoint:i}=fr.pathC(r);t.push(n.x,n.y,a.x,a.y,i.x,i.y)}pathS(r,t){var{point:n,controlPoint:a,currentPoint:i}=fr.pathS(r);return t.push(n.x,n.y,a.x,a.y,i.x,i.y),Ge.CURVE_TO}pathQ(r,t){var{controlPoint:n,currentPoint:a}=fr.pathQ(r);t.push(n.x,n.y,a.x,a.y)}pathT(r,t){var{controlPoint:n,currentPoint:a}=fr.pathT(r);return t.push(n.x,n.y,a.x,a.y),Ge.QUAD_TO}pathA(r){var{rX:t,rY:n,sweepFlag:a,xAxisRotation:i,centp:s,a1:o,ad:u}=fr.pathA(r);return a===0&&u>0&&(u-=2*Math.PI),a===1&&u<0&&(u+=2*Math.PI),[s.x,s.y,t,n,o,u,i,a]}calcLength(r,t,n,a){var i=0,s=null,o=null,u=0;switch(n){case Ge.LINE_TO:return this.getLineLength(r,t,a[0],a[1]);case Ge.CURVE_TO:for(i=0,s=this.getPointOnCubicBezier(0,r,t,a[0],a[1],a[2],a[3],a[4],a[5]),u=.01;u<=1;u+=.01)o=this.getPointOnCubicBezier(u,r,t,a[0],a[1],a[2],a[3],a[4],a[5]),i+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;return i;case Ge.QUAD_TO:for(i=0,s=this.getPointOnQuadraticBezier(0,r,t,a[0],a[1],a[2],a[3]),u=.01;u<=1;u+=.01)o=this.getPointOnQuadraticBezier(u,r,t,a[0],a[1],a[2],a[3]),i+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;return i;case Ge.ARC:{i=0;var l=a[4],c=a[5],f=a[4]+c,h=Math.PI/180;if(Math.abs(l-f)<h&&(h=Math.abs(l-f)),s=this.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],l,0),c<0)for(u=l-h;u>f;u-=h)o=this.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],u,0),i+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;else for(u=l+h;u<f;u+=h)o=this.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],u,0),i+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;return o=this.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],f,0),i+=this.getLineLength(s.x,s.y,o.x,o.y),i}}return 0}getPointOnLine(r,t,n,a,i){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:t,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:n,u=(i-n)/(a-t+Xi),l=Math.sqrt(r*r/(1+u*u));a<t&&(l*=-1);var c=u*l,f=null;if(a===t)f={x:s,y:o+c};else if((o-n)/(s-t+Xi)===u)f={x:s+l,y:o+c};else{var h=0,d=0,v=this.getLineLength(t,n,a,i);if(v<Xi)return null;var p=(s-t)*(a-t)+(o-n)*(i-n);p/=v*v,h=t+p*(a-t),d=n+p*(i-n);var x=this.getLineLength(s,o,h,d),g=Math.sqrt(r*r-x*x);l=Math.sqrt(g*g/(1+u*u)),a<t&&(l*=-1),c=u*l,f={x:h+l,y:d+c}}return f}getPointOnPath(r){var t=this.getPathLength(),n=0,a=null;if(r<-5e-5||r-5e-5>t)return null;var{dataArray:i}=this;for(var s of i){if(s&&(s.pathLength<5e-5||n+s.pathLength+5e-5<r)){n+=s.pathLength;continue}var o=r-n,u=0;switch(s.type){case Ge.LINE_TO:a=this.getPointOnLine(o,s.start.x,s.start.y,s.points[0],s.points[1],s.start.x,s.start.y);break;case Ge.ARC:{var l=s.points[4],c=s.points[5],f=s.points[4]+c;if(u=l+o/s.pathLength*c,c<0&&u<f||c>=0&&u>f)break;a=this.getPointOnEllipticalArc(s.points[0],s.points[1],s.points[2],s.points[3],u,s.points[6]);break}case Ge.CURVE_TO:u=o/s.pathLength,u>1&&(u=1),a=this.getPointOnCubicBezier(u,s.start.x,s.start.y,s.points[0],s.points[1],s.points[2],s.points[3],s.points[4],s.points[5]);break;case Ge.QUAD_TO:u=o/s.pathLength,u>1&&(u=1),a=this.getPointOnQuadraticBezier(u,s.start.x,s.start.y,s.points[0],s.points[1],s.points[2],s.points[3]);break}if(a)return a;break}return null}getLineLength(r,t,n,a){return Math.sqrt((n-r)*(n-r)+(a-t)*(a-t))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((r,t)=>t.pathLength>0?r+t.pathLength:r,0)),this.pathLength}getPointOnCubicBezier(r,t,n,a,i,s,o,u,l){var c=u*T1(r)+s*D1(r)+a*A1(r)+t*k1(r),f=l*T1(r)+o*D1(r)+i*A1(r)+n*k1(r);return{x:c,y:f}}getPointOnQuadraticBezier(r,t,n,a,i,s,o){var u=s*R1(r)+a*O1(r)+t*F1(r),l=o*R1(r)+i*O1(r)+n*F1(r);return{x:u,y:l}}getPointOnEllipticalArc(r,t,n,a,i,s){var o=Math.cos(s),u=Math.sin(s),l={x:n*Math.cos(i),y:a*Math.sin(i)};return{x:r+(l.x*o-l.y*u),y:t+(l.x*u+l.y*o)}}buildEquidistantCache(r,t){var n=this.getPathLength(),a=t||.25,i=r||n/100;if(!this.equidistantCache||this.equidistantCache.step!==i||this.equidistantCache.precision!==a){this.equidistantCache={step:i,precision:a,points:[]};for(var s=0,o=0;o<=n;o+=a){var u=this.getPointOnPath(o),l=this.getPointOnPath(o+a);!u||!l||(s+=this.getLineLength(u.x,u.y,l.x,l.y),s>=i&&(this.equidistantCache.points.push({x:u.x,y:u.y,distance:o}),s-=i))}}}getEquidistantPointOnPath(r,t,n){if(this.buildEquidistantCache(t,n),r<0||r-this.getPathLength()>5e-5)return null;var a=Math.round(r/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[a]||null}}var Zse=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class N5 extends wi{constructor(r,t,n){super(r,t,n),this.type="image",this.loaded=!1;var a=this.getHrefAttribute().getString();if(a){var i=a.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(a);r.images.push(this),i?this.loadSvg(a):this.loadImage(a),this.isSvg=i}}loadImage(r){var t=this;return Va(function*(){try{var n=yield t.document.createImage(r);t.image=n}catch(a){console.error('Error while loading image "'.concat(r,'":'),a)}t.loaded=!0})()}loadSvg(r){var t=this;return Va(function*(){var n=Zse.exec(r);if(n){var a=n[5];n[4]==="base64"?t.image=atob(a):t.image=decodeURIComponent(a)}else try{var i=yield t.document.fetch(r),s=yield i.text();t.image=s}catch(o){console.error('Error while loading image "'.concat(r,'":'),o)}t.loaded=!0})()}renderChildren(r){var{document:t,image:n,loaded:a}=this,i=this.getAttribute("x").getPixels("x"),s=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),u=this.getStyle("height").getPixels("y");if(!(!a||!n||!o||!u)){if(r.save(),r.translate(i,s),this.isSvg){var l=t.canvg.forkString(r,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:o,scaleHeight:u});l.document.documentElement.parent=this,l.render()}else{var c=this.image;t.setViewBox({ctx:r,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:o,desiredWidth:c.width,height:u,desiredHeight:c.height}),this.loaded&&(typeof c.complete>"u"||c.complete)&&r.drawImage(c,0,0)}r.restore()}}getBoundingBox(){var r=this.getAttribute("x").getPixels("x"),t=this.getAttribute("y").getPixels("y"),n=this.getStyle("width").getPixels("x"),a=this.getStyle("height").getPixels("y");return new En(r,t,r+n,t+a)}}class y5 extends wi{constructor(){super(...arguments),this.type="symbol"}render(r){}}class C5{constructor(r){this.document=r,this.loaded=!1,r.fonts.push(this)}load(r,t){var n=this;return Va(function*(){try{var{document:a}=n,i=yield a.canvg.parser.load(t),s=i.getElementsByTagName("font");Array.from(s).forEach(o=>{var u=a.createElement(o);a.definitions[r]=u})}catch(o){console.error('Error while loading font "'.concat(t,'":'),o)}n.loaded=!0})()}}class iy extends Mr{constructor(r,t,n){super(r,t,n),this.type="style";var a=Cs(Array.from(t.childNodes).map(s=>s.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")),i=a.split("}");i.forEach(s=>{var o=s.trim();if(o){var u=o.split("{"),l=u[0].split(","),c=u[1].split(";");l.forEach(f=>{var h=f.trim();if(h){var d=r.styles[h]||{};if(c.forEach(x=>{var g=x.indexOf(":"),N=x.substr(0,g).trim(),b=x.substr(g+1,x.length-g).trim();N&&b&&(d[N]=new Me(r,N,b))}),r.styles[h]=d,r.stylesSpecificity[h]=$P(h),h==="@font-face"){var v=d["font-family"].getString().replace(/"|'/g,""),p=d.src.getString().split(",");p.forEach(x=>{if(x.indexOf('format("svg")')>0){var g=ZN(x);g&&new C5(r).load(v,g)}})}}})}})}}iy.parseExternalUrl=ZN;class E5 extends wi{constructor(){super(...arguments),this.type="use"}setContext(r){super.setContext(r);var t=this.getAttribute("x"),n=this.getAttribute("y");t.hasValue()&&r.translate(t.getPixels("x"),0),n.hasValue()&&r.translate(0,n.getPixels("y"))}path(r){var{element:t}=this;t&&t.path(r)}renderChildren(r){var{document:t,element:n}=this;if(n){var a=n;if(n.type==="symbol"&&(a=new To(t,null),a.attributes.viewBox=new Me(t,"viewBox",n.getAttribute("viewBox").getString()),a.attributes.preserveAspectRatio=new Me(t,"preserveAspectRatio",n.getAttribute("preserveAspectRatio").getString()),a.attributes.overflow=new Me(t,"overflow",n.getAttribute("overflow").getString()),a.children=n.children,n.styles.opacity=new Me(t,"opacity",this.calculateOpacity())),a.type==="svg"){var i=this.getStyle("width",!1,!0),s=this.getStyle("height",!1,!0);i.hasValue()&&(a.attributes.width=new Me(t,"width",i.getString())),s.hasValue()&&(a.attributes.height=new Me(t,"height",s.getString()))}var o=a.parent;a.parent=this,a.render(r),a.parent=o}}getBoundingBox(r){var{element:t}=this;return t?t.getBoundingBox(r):null}elementTransform(){var{document:r,element:t}=this;return hi.fromElement(r,t)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}}function Xu(e,r,t,n,a,i){return e[t*n*4+r*4+i]}function Qu(e,r,t,n,a,i,s){e[t*n*4+r*4+i]=s}function Xr(e,r,t){var n=e[r];return n*t}function ga(e,r,t,n){return r+Math.cos(e)*t+Math.sin(e)*n}class sy extends Mr{constructor(r,t,n){super(r,t,n),this.type="feColorMatrix";var a=qt(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{var i=a[0];a=[.213+.787*i,.715-.715*i,.072-.072*i,0,0,.213-.213*i,.715+.285*i,.072-.072*i,0,0,.213-.213*i,.715-.715*i,.072+.928*i,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{var s=a[0]*Math.PI/180;a=[ga(s,.213,.787,-.213),ga(s,.715,-.715,-.715),ga(s,.072,-.072,.928),0,0,ga(s,.213,-.213,.143),ga(s,.715,.285,.14),ga(s,.072,-.072,-.283),0,0,ga(s,.213,-.213,-.787),ga(s,.715,-.715,.715),ga(s,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=a,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(r,t,n,a,i){for(var{includeOpacity:s,matrix:o}=this,u=r.getImageData(0,0,a,i),l=0;l<i;l++)for(var c=0;c<a;c++){var f=Xu(u.data,c,l,a,i,0),h=Xu(u.data,c,l,a,i,1),d=Xu(u.data,c,l,a,i,2),v=Xu(u.data,c,l,a,i,3),p=Xr(o,0,f)+Xr(o,1,h)+Xr(o,2,d)+Xr(o,3,v)+Xr(o,4,1),x=Xr(o,5,f)+Xr(o,6,h)+Xr(o,7,d)+Xr(o,8,v)+Xr(o,9,1),g=Xr(o,10,f)+Xr(o,11,h)+Xr(o,12,d)+Xr(o,13,v)+Xr(o,14,1),N=Xr(o,15,f)+Xr(o,16,h)+Xr(o,17,d)+Xr(o,18,v)+Xr(o,19,1);s&&(p=0,x=0,g=0,N*=v/255),Qu(u.data,c,l,a,i,0,p),Qu(u.data,c,l,a,i,1,x),Qu(u.data,c,l,a,i,2,g),Qu(u.data,c,l,a,i,3,N)}r.clearRect(0,0,a,i),r.putImageData(u,0,0)}}class gu extends Mr{constructor(){super(...arguments),this.type="mask"}apply(r,t){var{document:n}=this,a=this.getAttribute("x").getPixels("x"),i=this.getAttribute("y").getPixels("y"),s=this.getStyle("width").getPixels("x"),o=this.getStyle("height").getPixels("y");if(!s&&!o){var u=new En;this.children.forEach(v=>{u.addBoundingBox(v.getBoundingBox(r))}),a=Math.floor(u.x1),i=Math.floor(u.y1),s=Math.floor(u.width),o=Math.floor(u.height)}var l=this.removeStyles(t,gu.ignoreStyles),c=n.createCanvas(a+s,i+o),f=c.getContext("2d");n.screen.setDefaults(f),this.renderChildren(f),new sy(n,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(f,0,0,a+s,i+o);var h=n.createCanvas(a+s,i+o),d=h.getContext("2d");n.screen.setDefaults(d),t.render(d),d.globalCompositeOperation="destination-in",d.fillStyle=f.createPattern(c,"no-repeat"),d.fillRect(0,0,a+s,i+o),r.fillStyle=d.createPattern(h,"no-repeat"),r.fillRect(0,0,a+s,i+o),this.restoreStyles(t,l)}render(r){}}gu.ignoreStyles=["mask","transform","clip-path"];var Ak=()=>{};class w5 extends Mr{constructor(){super(...arguments),this.type="clipPath"}apply(r){var{document:t}=this,n=Reflect.getPrototypeOf(r),{beginPath:a,closePath:i}=r;n&&(n.beginPath=Ak,n.closePath=Ak),Reflect.apply(a,r,[]),this.children.forEach(s=>{if(!(typeof s.path>"u")){var o=typeof s.elementTransform<"u"?s.elementTransform():null;o||(o=hi.fromElement(t,s)),o&&o.apply(r),s.path(r),n&&(n.closePath=i),o&&o.unapply(r)}}),Reflect.apply(i,r,[]),r.clip(),n&&(n.beginPath=a,n.closePath=i)}render(r){}}class bu extends Mr{constructor(){super(...arguments),this.type="filter"}apply(r,t){var{document:n,children:a}=this,i=t.getBoundingBox(r);if(i){var s=0,o=0;a.forEach(g=>{var N=g.extraFilterDistance||0;s=Math.max(s,N),o=Math.max(o,N)});var u=Math.floor(i.width),l=Math.floor(i.height),c=u+2*s,f=l+2*o;if(!(c<1||f<1)){var h=Math.floor(i.x),d=Math.floor(i.y),v=this.removeStyles(t,bu.ignoreStyles),p=n.createCanvas(c,f),x=p.getContext("2d");n.screen.setDefaults(x),x.translate(-h+s,-d+o),t.render(x),a.forEach(g=>{typeof g.apply=="function"&&g.apply(x,0,0,c,f)}),r.drawImage(p,0,0,c,f,h-s,d-o,c,f),this.restoreStyles(t,v)}}}render(r){}}bu.ignoreStyles=["filter","transform","clip-path"];class _5 extends Mr{constructor(r,t,n){super(r,t,n),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(r,t,n,a,i){}}class S5 extends Mr{constructor(){super(...arguments),this.type="feMorphology"}apply(r,t,n,a,i){}}class T5 extends Mr{constructor(){super(...arguments),this.type="feComposite"}apply(r,t,n,a,i){}}class D5 extends Mr{constructor(r,t,n){super(r,t,n),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(r,t,n,a,i){var{document:s,blurRadius:o}=this,u=s.window?s.window.document.body:null,l=r.canvas;l.id=s.getUniqueId(),u&&(l.style.display="none",u.appendChild(l)),kse(l,t,n,a,i,o),u&&u.removeChild(l)}}class A5 extends Mr{constructor(){super(...arguments),this.type="title"}}class k5 extends Mr{constructor(){super(...arguments),this.type="desc"}}var Jse={svg:To,rect:ty,circle:t5,ellipse:n5,line:a5,polyline:ny,polygon:i5,path:fr,pattern:s5,marker:o5,defs:l5,linearGradient:u5,radialGradient:c5,stop:f5,animate:Xf,animateColor:m5,animateTransform:d5,font:h5,"font-face":p5,"missing-glyph":v5,glyph:ry,text:Ma,tspan:xu,tref:x5,a:g5,textPath:b5,image:N5,g:Kf,symbol:y5,style:iy,use:E5,mask:gu,clipPath:w5,filter:bu,feDropShadow:_5,feMorphology:S5,feComposite:T5,feColorMatrix:sy,feGaussianBlur:D5,title:A5,desc:k5};function kk(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function eoe(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?kk(Object(t),!0).forEach(function(n){QN(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):kk(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function roe(e,r){var t=document.createElement("canvas");return t.width=e,t.height=r,t}function toe(e){return I1.apply(this,arguments)}function I1(){return I1=Va(function*(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=document.createElement("img");return r&&(t.crossOrigin="Anonymous"),new Promise((n,a)=>{t.onload=()=>{n(t)},t.onerror=(i,s,o,u,l)=>{a(l)},t.src=e})}),I1.apply(this,arguments)}class Da{constructor(r){var{rootEmSize:t=12,emSize:n=12,createCanvas:a=Da.createCanvas,createImage:i=Da.createImage,anonymousCrossOrigin:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.canvg=r,this.definitions=Object.create(null),this.styles=Object.create(null),this.stylesSpecificity=Object.create(null),this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=r.screen,this.rootEmSize=t,this.emSize=n,this.createCanvas=a,this.createImage=this.bindCreateImage(i,s),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(r,t){return typeof t=="boolean"?(n,a)=>r(n,typeof a=="boolean"?a:t):r}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:r}=this;return r[r.length-1]}set emSize(r){var{emSizeStack:t}=this;t.push(r)}popEmSize(){var{emSizeStack:r}=this;r.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(r=>r.loaded)}isFontsLoaded(){return this.fonts.every(r=>r.loaded)}createDocumentElement(r){var t=this.createElement(r.documentElement);return t.root=!0,t.addStylesFromStyleDefinition(),this.documentElement=t,t}createElement(r){var t=r.nodeName.replace(/^[^:]+:/,""),n=Da.elementTypes[t];return typeof n<"u"?new n(this,r):new r5(this,r)}createTextNode(r){return new Qse(this,r)}setViewBox(r){this.screen.setViewBox(eoe({document:this},r))}}Da.createCanvas=roe;Da.createImage=toe;Da.elementTypes=Jse;function Rk(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ki(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Rk(Object(t),!0).forEach(function(n){QN(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Rk(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}class ji{constructor(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.parser=new ac(n),this.screen=new vu(r,n),this.options=n;var a=new Da(this,n),i=a.createDocumentElement(t);this.document=a,this.documentElement=i}static from(r,t){var n=arguments;return Va(function*(){var a=n.length>2&&n[2]!==void 0?n[2]:{},i=new ac(a),s=yield i.parse(t);return new ji(r,s,a)})()}static fromString(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=new ac(n),i=a.parseFromString(t);return new ji(r,i,n)}fork(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ji.from(r,t,ki(ki({},this.options),n))}forkString(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ji.fromString(r,t,ki(ki({},this.options),n))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var r=arguments,t=this;return Va(function*(){var n=r.length>0&&r[0]!==void 0?r[0]:{};t.start(ki({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},n)),yield t.ready(),t.stop()})()}start(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{documentElement:t,screen:n,options:a}=this;n.start(t,ki(ki({enableRedraw:!0},a),r))}stop(){this.screen.stop()}resize(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(r,t,n)}}const Aue=Object.freeze(Object.defineProperty({__proto__:null,AElement:g5,AnimateColorElement:m5,AnimateElement:Xf,AnimateTransformElement:d5,BoundingBox:En,CB1:T1,CB2:D1,CB3:A1,CB4:k1,Canvg:ji,CircleElement:t5,ClipPathElement:w5,DefsElement:l5,DescElement:k5,Document:Da,Element:Mr,EllipseElement:n5,FeColorMatrixElement:sy,FeCompositeElement:T5,FeDropShadowElement:_5,FeGaussianBlurElement:D5,FeMorphologyElement:S5,FilterElement:bu,Font:_t,FontElement:h5,FontFaceElement:p5,GElement:Kf,GlyphElement:ry,GradientElement:ay,ImageElement:N5,LineElement:a5,LinearGradientElement:u5,MarkerElement:o5,MaskElement:gu,Matrix:JN,MissingGlyphElement:v5,Mouse:WP,PSEUDO_ZERO:Xi,Parser:ac,PathElement:fr,PathParser:Ge,PatternElement:s5,Point:Br,PolygonElement:i5,PolylineElement:ny,Property:Me,QB1:R1,QB2:O1,QB3:F1,RadialGradientElement:c5,RectElement:ty,RenderedElement:wi,Rotate:QP,SVGElement:To,SVGFontLoader:C5,Scale:ZP,Screen:vu,Skew:ey,SkewX:JP,SkewY:e5,StopElement:f5,StyleElement:iy,SymbolElement:y5,TRefElement:x5,TSpanElement:xu,TextElement:Ma,TextPathElement:b5,TitleElement:A5,Transform:hi,Translate:XP,UnknownElement:r5,UseElement:E5,ViewPort:GP,compressSpaces:Cs,default:ji,getSelectorSpecificity:$P,normalizeAttributeName:HP,normalizeColor:zP,parseExternalUrl:ZN,presets:Use,toNumbers:qt,trimLeft:BP,trimRight:qP,vectorMagnitude:_1,vectorsAngle:S1,vectorsRatio:Kc},Symbol.toStringTag,{value:"Module"}));export{xue as $,lue as A,We as B,qe as C,af as D,KJ as E,JJ as F,ZJ as G,W8 as H,Vs as I,poe as J,xoe as K,tr as L,moe as M,Eu as N,mue as O,Tp as P,Dp as Q,Ap as R,el as S,Y8 as T,NR as U,due as V,hue as W,Ree as X,cl as Y,pue as Z,Poe as _,Qc as a,zle as a$,zy as a0,vue as a1,hoe as a2,Goe as a3,Xoe as a4,Koe as a5,zoe as a6,$oe as a7,Yoe as a8,Woe as a9,Dle as aA,Ale as aB,Ole as aC,Zoe as aD,q6 as aE,vle as aF,xle as aG,ple as aH,hle as aI,dle as aJ,mle as aK,FR as aL,fle as aM,ele as aN,Joe as aO,lle as aP,cle as aQ,ule as aR,Ile as aS,Ple as aT,Vle as aU,Mle as aV,jle as aW,Lle as aX,Hle as aY,qle as aZ,$le as a_,ole as aa,Qoe as ab,sle as ac,ile as ad,ale as ae,nle as af,tle as ag,rle as ah,H6 as ai,Cle as aj,Ele as ak,wle as al,kle as am,Rle as an,xb as ao,yO as ap,k7 as aq,_le as ar,Tle as as,Sle as at,gle as au,iE as av,yle as aw,Nle as ax,Nl as ay,ble as az,Qe as b,yoe as b$,Ble as b0,Gle as b1,Voe as b2,Due as b3,Hoe as b4,sue as b5,iue as b6,MJ as b7,oue as b8,Xle as b9,Or as bA,cue as bB,$c as bC,Gc as bD,Pl as bE,wee as bF,_ee as bG,Tee as bH,Dee as bI,kee as bJ,Boe as bK,Loe as bL,Fl as bM,nue as bN,tue as bO,rue as bP,vi as bQ,foe as bR,nr as bS,Aoe as bT,Coe as bU,Eoe as bV,woe as bW,_oe as bX,Soe as bY,Doe as bZ,Toe as b_,aue as ba,Wle as bb,Yle as bc,Kle as bd,Qle as be,Zle as bf,Jle as bg,eue as bh,Nue as bi,bue as bj,Tue as bk,doe as bl,voe as bm,B8 as bn,q8 as bo,H8 as bp,z8 as bq,G8 as br,$8 as bs,qoe as bt,boe as bu,goe as bv,Noe as bw,joe as bx,Moe as by,fue as bz,Ze as c,Foe as c0,F8 as c1,Ooe as c2,mc as c3,Ioe as c4,Roe as c5,Uoe as c6,koe as c7,Ule as c8,Fle as c9,Sue as ca,wue as cb,_ue as cc,zae as cd,yue as ce,Eae as cf,Cue as cg,Eue as ch,Aue as ci,mr as d,He as e,gue as f,yR as g,Lg as h,Bg as i,yr as j,xR as k,Hl as l,zl as m,$l as n,Gl as o,js as p,rl as q,Ls as r,Un as s,W1 as t,rM as u,uue as v,WJ as w,YJ as x,XJ as y,QJ as z};
