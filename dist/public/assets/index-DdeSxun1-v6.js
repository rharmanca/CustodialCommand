const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/inspection-pages-DOJgFRVN-v6.js","assets/vendor-yOkX1T9n-v6.js","assets/ui-BA32w1ww-v6.js","assets/utils-Cj9wHvoQ-v6.js","assets/forms-BJ8Awwap-v6.js","assets/charts-core-ghokHKd6-v6.js","assets/pdf-export-JyY94Pcb-v6.js","assets/data-pages-Bfwjy2va-v6.js","assets/notes-pages-BA77IFGC-v6.js","assets/building-inspection-Bh3Dkb57-v6.js","assets/admin-pages-B5v7X2xk-v6.js","assets/feedback-pages-Bj5cmIWP-v6.js","assets/dashboard-pages-BCpuSdsS-v6.js"])))=>i.map(i=>d[i]);
var B3=Object.defineProperty,U3=Object.defineProperties;var q3=Object.getOwnPropertyDescriptors;var Bl=Object.getOwnPropertySymbols;var a1=Object.prototype.hasOwnProperty,s1=Object.prototype.propertyIsEnumerable;var o1=e=>{throw TypeError(e)},Ul=Math.pow,ef=(e,t,r)=>t in e?B3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,q=(e,t)=>{for(var r in t||(t={}))a1.call(t,r)&&ef(e,r,t[r]);if(Bl)for(var r of Bl(t))s1.call(t,r)&&ef(e,r,t[r]);return e},ce=(e,t)=>U3(e,q3(t));var we=(e,t)=>{var r={};for(var n in e)a1.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Bl)for(var n of Bl(e))t.indexOf(n)<0&&s1.call(e,n)&&(r[n]=e[n]);return r};var Ge=(e,t,r)=>ef(e,typeof t!="symbol"?t+"":t,r),tf=(e,t,r)=>t.has(e)||o1("Cannot "+r);var se=(e,t,r)=>(tf(e,t,"read from private field"),r?r.call(e):t.get(e)),Ke=(e,t,r)=>t.has(e)?o1("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Pe=(e,t,r,n)=>(tf(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),lr=(e,t,r)=>(tf(e,t,"access private method"),r);var ql=(e,t,r,n)=>({set _(i){Pe(e,t,i,r)},get _(){return se(e,t,n)}});var lt=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{o(r.next(l))}catch(c){i(c)}},s=l=>{try{o(r.throw(l))}catch(c){i(c)}},o=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,s);o((r=r.apply(e,t)).next())});import{r as H,O as z3,j as f,Q as hT,V as dT,W as mT,Y as pT,X as qi,Z as gT,_ as xT,$ as vT,z as _r,i as rg,E as En,a0 as yT,a1 as l1,l as wT,a2 as H3,a3 as bT,H as $3,a4 as V3,x as an,a5 as ng,U as Mi,a6 as W3,R as hs,a7 as G3,a8 as _T,a9 as Y3,aa as X3,ab as ST,ac as K3,ad as Ea,ae as Q3,af as TT,ag as Z3,ah as ET,ai as J3,g as ig,aj as eR,ak as NT,al as AT,am as CT,an as kT,ao as RT,ap as OT,aq as tR,ar as FT,as as ag,at as rR,au as IT,av as jT,aw as sg,h as du,k as DT,ax as PT,ay as nR,az as MT,aA as LT,aB as BT,b as Ms,aC as UT,w as nn,aD as og,aE as iR,aF as Ym,p as zi,u as cr,F as wi,aG as aR,aH as c1,aI as qT,aJ as zT,aK as sR,aL as oR,aM as HT,aN as lR,y as Oa,aO as cR,aP as uR,n as Ac,aQ as $T,aR as VT,aS as fR,aT as hR,aU as dR,aV as mR,aW as pR,aX as gR,G as WT,aY as rf,a as xR,aZ as vR,a_ as yR,a$ as wR,b0 as wo,b1 as bR,b2 as _R,b3 as SR,b4 as TR,b5 as ER,b6 as GT,b7 as YT,b8 as NR,b9 as AR,A as CR,ba as kR,bb as RR,bc as OR,bd as XT,be as KT,bf as QT,bg as ZT,bh as JT,bi as eE,bj as ds,bk as Zi,bl as Bo,bm as FR,bn as IR,bo as jR,bp as DR,bq as tE,C as rE,e as u1,br as PR,bs as MR,bt as LR,T as BR}from"./vendor-yOkX1T9n-v6.js";import{o as nE,a as iE,s as Lr,n as dn,l as bo,i as UR}from"./forms-BJ8Awwap-v6.js";import{R as lg,L as qR,C as aE,X as sE,Y as oE,T as lE,a as cE,b as f1,B as zR,c as h1,d as d1,e as HR,P as $R,f as VR,g as WR,h as GR}from"./charts-core-ghokHKd6-v6.js";import{c as uE,t as YR,s as nf,a as m1,f as Cc,e as XR}from"./utils-Cj9wHvoQ-v6.js";import{E as dl,a as Fa}from"./pdf-export-JyY94Pcb-v6.js";import"./ui-BA32w1ww-v6.js";import"./index-DdeSxun1-v6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var _o=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Xe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var af={exports:{}},sf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p1;function KR(){return p1||(p1=1,(function(e){function t(ee,re){var O=ee.length;ee.push(re);e:for(;0<O;){var ge=O-1>>>1,B=ee[ge];if(0<i(B,re))ee[ge]=re,ee[O]=B,O=ge;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var re=ee[0],O=ee.pop();if(O!==re){ee[0]=O;e:for(var ge=0,B=ee.length,_=B>>>1;ge<_;){var M=2*(ge+1)-1,U=ee[M],V=M+1,le=ee[V];if(0>i(U,O))V<B&&0>i(le,U)?(ee[ge]=le,ee[V]=O,ge=V):(ee[ge]=U,ee[M]=O,ge=M);else if(V<B&&0>i(le,O))ee[ge]=le,ee[V]=O,ge=V;else break e}}return re}function i(ee,re){var O=ee.sortIndex-re.sortIndex;return O!==0?O:ee.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,h=null,m=3,d=!1,g=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ee){for(var re=r(c);re!==null;){if(re.callback===null)n(c);else if(re.startTime<=ee)n(c),re.sortIndex=re.expirationTime,t(l,re);else break;re=r(c)}}function w(ee){if(p=!1,y(ee),!g)if(r(l)!==null)g=!0,fe(k);else{var re=r(c);re!==null&&he(w,re.startTime-ee)}}function k(ee,re){g=!1,p&&(p=!1,v(E),E=-1),d=!0;var O=m;try{for(y(re),h=r(l);h!==null&&(!(h.expirationTime>re)||ee&&!C());){var ge=h.callback;if(typeof ge=="function"){h.callback=null,m=h.priorityLevel;var B=ge(h.expirationTime<=re);re=e.unstable_now(),typeof B=="function"?h.callback=B:h===r(l)&&n(l),y(re)}else n(l);h=r(l)}if(h!==null)var _=!0;else{var M=r(c);M!==null&&he(w,M.startTime-re),_=!1}return _}finally{h=null,m=O,d=!1}}var T=!1,S=null,E=-1,A=5,R=-1;function C(){return!(e.unstable_now()-R<A)}function j(){if(S!==null){var ee=e.unstable_now();R=ee;var re=!0;try{re=S(!0,ee)}finally{re?z():(T=!1,S=null)}}else T=!1}var z;if(typeof b=="function")z=function(){b(j)};else if(typeof MessageChannel!="undefined"){var G=new MessageChannel,W=G.port2;G.port1.onmessage=j,z=function(){W.postMessage(null)}}else z=function(){x(j,0)};function fe(ee){S=ee,T||(T=!0,z())}function he(ee,re){E=x(function(){ee(e.unstable_now())},re)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){g||d||(g=!0,fe(k))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ee){switch(m){case 1:case 2:case 3:var re=3;break;default:re=m}var O=m;m=re;try{return ee()}finally{m=O}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,re){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var O=m;m=ee;try{return re()}finally{m=O}},e.unstable_scheduleCallback=function(ee,re,O){var ge=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?ge+O:ge):O=ge,ee){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=O+B,ee={id:u++,callback:re,priorityLevel:ee,startTime:O,expirationTime:B,sortIndex:-1},O>ge?(ee.sortIndex=O,t(c,ee),r(l)===null&&ee===r(c)&&(p?(v(E),E=-1):p=!0,he(w,O-ge))):(ee.sortIndex=B,t(l,ee),g||d||(g=!0,fe(k))),ee},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(ee){var re=m;return function(){var O=m;m=re;try{return ee.apply(this,arguments)}finally{m=O}}}})(sf)),sf}var g1;function RQ(){return g1||(g1=1,af.exports=KR()),af.exports}const QR="modulepreload",ZR=function(e){return"/"+e},x1={},Ji=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){let s=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=s(r.map(c=>{if(c=ZR(c),c in x1)return;x1[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":QR,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((d,g)=>{m.addEventListener("load",d),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return i.then(s=>{for(const o of s||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})},v1=768;function JR(){const[e,t]=H.useState(void 0),[r,n]=H.useState(!1),[i,a]=H.useState("portrait");return H.useEffect(()=>{const s=window.matchMedia(`(max-width: ${v1-1}px)`),o=window.matchMedia("(orientation: portrait)"),l=()=>{t(window.innerWidth<v1),a(o.matches?"portrait":"landscape")},c=()=>{n("ontouchstart"in window||navigator.maxTouchPoints>0)};return s.addEventListener("change",l),o.addEventListener("change",l),l(),c(),()=>{s.removeEventListener("change",l),o.removeEventListener("change",l)}},[]),{isMobile:!!e,isTouch:r,orientation:i}}function eO(){const[e,t]=H.useState([]),r=H.useCallback(c=>{const u=Math.random().toString(36).substr(2,9),h=c.type==="error"?7e3:5e3,m=ce(q({},c),{id:u,duration:c.duration||h});return t(d=>[...d,m]),m.duration!==0&&setTimeout(()=>{n(u)},m.duration),u},[]),n=H.useCallback(c=>{t(u=>u.filter(h=>h.id!==c))},[]),i=H.useCallback(()=>{t([])},[]),a=H.useCallback((c,u,h)=>r({type:"success",message:c,title:u||"Success",duration:h}),[r]),s=H.useCallback((c,u,h)=>r({type:"error",message:c,title:u||"Error",duration:h}),[r]),o=H.useCallback((c,u,h)=>r({type:"info",message:c,title:u||"Info",duration:h}),[r]),l=H.useCallback((c,u,h)=>r({type:"warning",message:c,title:u||"Warning",duration:h}),[r]);return{notifications:e,addNotification:r,removeNotification:n,clearAllNotifications:i,showSuccess:a,showError:s,showInfo:o,showWarning:l}}const xa=class xa{constructor(){Ge(this,"storage",new Map);Ge(this,"useLocalStorage");Ge(this,"warnings",new Set);this.useLocalStorage=this.checkLocalStorageAvailability(),this.useLocalStorage||console.warn("SafeLocalStorage: localStorage is unavailable. Using in-memory fallback storage. Data will not persist across page reloads.")}static getInstance(){return xa.instance||(xa.instance=new xa),xa.instance}checkLocalStorageAvailability(){try{if(typeof window=="undefined"||!("localStorage"in window))return!1;const t=window.localStorage,r="__safe_storage_test__",n="test";t.setItem(r,n);const i=t.getItem(r);return t.removeItem(r),i===n}catch(t){return!1}}setItem(t,r){if(this.useLocalStorage)try{localStorage.setItem(t,r);return}catch(n){this.handleStorageError(n,"setItem")}this.storage.set(t,r)}getItem(t){if(this.useLocalStorage)try{return localStorage.getItem(t)}catch(r){this.handleStorageError(r,"getItem")}return this.storage.get(t)||null}removeItem(t){if(this.useLocalStorage)try{localStorage.removeItem(t);return}catch(r){this.handleStorageError(r,"removeItem")}this.storage.delete(t)}clear(){if(this.useLocalStorage)try{localStorage.clear();return}catch(t){this.handleStorageError(t,"clear")}this.storage.clear()}keys(){if(this.useLocalStorage)try{return Object.keys(localStorage)}catch(t){this.handleStorageError(t,"keys")}return Array.from(this.storage.keys())}get length(){if(this.useLocalStorage)try{return localStorage.length}catch(t){this.handleStorageError(t,"length")}return this.storage.size}isUsingLocalStorage(){return this.useLocalStorage}getQuotaInfo(){return lt(this,null,function*(){if("storage"in navigator&&"estimate"in navigator.storage)try{const t=yield navigator.storage.estimate(),r=t.usage||0,n=t.quota||0,i=n>0?r/n*100:0;return{usage:r,quota:n,percentage:Math.round(i*100)/100}}catch(t){console.warn("SafeLocalStorage: Unable to get quota info",t)}return null})}handleStorageError(t,r){const n=`${r}:${t.name}`;this.warnings.has(n)||(console.warn(`SafeLocalStorage: ${r} failed with ${t.name}. Switching to in-memory fallback storage.`,t),this.warnings.add(n)),(t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&console.error("SafeLocalStorage: Storage quota exceeded. Consider clearing old data or increasing storage allocation."),this.useLocalStorage&&(this.useLocalStorage=!1,console.warn("SafeLocalStorage: Permanently switched to in-memory fallback mode for this session."))}};Ge(xa,"instance");let Xm=xa;const bt=Xm.getInstance(),tO=1,rO=1e6;let of=0;function nO(){return of=(of+1)%Number.MAX_SAFE_INTEGER,of.toString()}const lf=new Map,y1=e=>{if(lf.has(e))return;const t=setTimeout(()=>{lf.delete(e),To({type:"REMOVE_TOAST",toastId:e})},rO);lf.set(e,t)},iO=(e,t)=>{switch(t.type){case"ADD_TOAST":return ce(q({},e),{toasts:[t.toast,...e.toasts].slice(0,tO)});case"UPDATE_TOAST":return ce(q({},e),{toasts:e.toasts.map(r=>r.id===t.toast.id?q(q({},r),t.toast):r)});case"DISMISS_TOAST":{const{toastId:r}=t;return r?y1(r):e.toasts.forEach(n=>{y1(n.id)}),ce(q({},e),{toasts:e.toasts.map(n=>n.id===r||r===void 0?ce(q({},n),{open:!1}):n)})}case"REMOVE_TOAST":return t.toastId===void 0?ce(q({},e),{toasts:[]}):ce(q({},e),{toasts:e.toasts.filter(r=>r.id!==t.toastId)})}},wc=[];let bc={toasts:[]};function To(e){bc=iO(bc,e),wc.forEach(t=>{t(bc)})}function aO(t){var e=we(t,[]);const r=nO(),n=a=>To({type:"UPDATE_TOAST",toast:ce(q({},a),{id:r})}),i=()=>To({type:"DISMISS_TOAST",toastId:r});return To({type:"ADD_TOAST",toast:ce(q({},e),{id:r,open:!0,onOpenChange:a=>{a||i()}})}),{id:r,dismiss:i,update:n}}function mu(){const[e,t]=H.useState(bc);return H.useEffect(()=>(wc.push(t),()=>{const r=wc.indexOf(t);r>-1&&wc.splice(r,1)}),[e]),ce(q({},e),{toast:aO,dismiss:r=>To({type:"DISMISS_TOAST",toastId:r})})}const w1=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,b1=uE,pu=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return b1(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:i,defaultVariants:a}=t,s=Object.keys(i).map(c=>{const u=r==null?void 0:r[c],h=a==null?void 0:a[c];if(u===null)return null;const m=w1(u)||w1(h);return i[c][m]}),o=r&&Object.entries(r).reduce((c,u)=>{let[h,m]=u;return m===void 0||(c[h]=m),c},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,u)=>{let g=u,{class:h,className:m}=g,d=we(g,["class","className"]);return Object.entries(d).every(p=>{let[x,v]=p;return Array.isArray(v)?v.includes(q(q({},a),o)[x]):q(q({},a),o)[x]===v})?[...c,h,m]:c},[]);return b1(e,s,l,r==null?void 0:r.class,r==null?void 0:r.className)};function Ee(...e){return YR(uE(e))}const sO=z3,fE=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(gT,q({ref:r,className:Ee("fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-[999999] flex max-h-screen w-auto flex-col items-center justify-center p-4 pointer-events-none",e),style:{maxWidth:"500px"}},t))});fE.displayName=gT.displayName;const oO=pu("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-lg border-2 p-6 pr-8 shadow-xl transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-top-full data-[state=open]:slide-in-from-top-full backdrop-blur-sm",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),hE=H.forwardRef((i,n)=>{var a=i,{className:e,variant:t}=a,r=we(a,["className","variant"]);return f.jsx(hT,q({ref:n,className:Ee(oO({variant:t}),e)},r))});hE.displayName=hT.displayName;const lO=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(xT,q({ref:r,className:Ee("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e)},t))});lO.displayName=xT.displayName;const dE=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(pT,ce(q({ref:r,className:Ee("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":""},t),{children:f.jsx(qi,{className:"h-4 w-4"})}))});dE.displayName=pT.displayName;const mE=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(dT,q({ref:r,className:Ee("text-sm font-semibold",e)},t))});mE.displayName=dT.displayName;const pE=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(mT,q({ref:r,className:Ee("text-sm opacity-90",e)},t))});pE.displayName=mT.displayName;function cO(){const{toasts:e}=mu();return f.jsxs(sO,{children:[e.map(function(s){var o=s,{id:t,title:r,description:n,action:i}=o,a=we(o,["id","title","description","action"]);return f.jsxs(hE,ce(q({},a),{children:[f.jsxs("div",{className:"grid gap-1",children:[r&&f.jsx(mE,{children:r}),n&&f.jsx(pE,{children:n})]}),i,f.jsx(dE,{})]}),t)}),f.jsx(fE,{})]})}const Uo=pu("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-semibold ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 shadow-md hover:shadow-lg active:scale-95 min-h-[48px] touch-manipulation",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 border-3 border-primary/30 hover:border-primary/40 shadow-lg hover:shadow-xl",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 border-3 border-destructive/30 hover:border-destructive/40 shadow-lg hover:shadow-xl",outline:"border-3 border-input bg-background hover:bg-accent hover:text-accent-foreground hover:border-accent/50 shadow-md hover:shadow-lg",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 border-3 border-secondary/30 hover:border-secondary/40 shadow-md hover:shadow-lg",ghost:"hover:bg-accent hover:text-accent-foreground border-3 border-transparent hover:border-accent/20",link:"text-primary underline-offset-4 hover:underline border-3 border-transparent"},size:{default:"h-12 px-6 py-3 font-semibold min-h-[48px]",sm:"h-10 rounded-md px-4 font-medium min-h-[44px]",lg:"h-14 rounded-md px-8 font-semibold text-base min-h-[56px]",icon:"h-12 w-12 min-h-[48px] min-w-[48px]"}},defaultVariants:{variant:"default",size:"default"}}),Le=H.forwardRef((s,a)=>{var o=s,{className:e,variant:t,size:r,asChild:n=!1}=o,i=we(o,["className","variant","size","asChild"]);const l=n?vT:"button";return f.jsx(l,q({className:Ee(Uo({variant:t,size:r,className:e})),ref:a},i))});Le.displayName="Button";function uO({notifications:e,onRemove:t}){return e.length?f.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(r=>f.jsx("div",{className:`
            p-4 rounded-lg shadow-lg max-w-sm cursor-pointer transform transition-all
            ${r.type==="success"?"bg-green-50 border border-green-200 text-green-800":""}
            ${r.type==="error"?"bg-red-50 border border-red-200 text-red-800":""}
            ${r.type==="warning"?"bg-yellow-50 border border-yellow-200 text-yellow-800":""}
            ${r.type==="info"?"bg-blue-50 border border-blue-200 text-blue-800":""}
          `,onClick:()=>t(r.id),children:f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h4",{className:"font-medium",children:r.title}),f.jsx("p",{className:"text-sm mt-1",children:r.message})]}),f.jsx("button",{onClick:n=>{n.stopPropagation(),t(r.id)},className:"ml-2 text-gray-400 hover:text-gray-600",children:"Ã—"})]})},r.id))}):null}const fO=pu("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ht(n){var i=n,{className:e,variant:t}=i,r=we(i,["className","variant"]);return f.jsx("div",q({className:Ee(fO({variant:t}),e)},r))}const Fe=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx("div",q({ref:r,className:Ee("rounded-lg border-2 bg-card text-card-foreground shadow-md transition-all duration-300","[@media(hover:hover)_and_(pointer:fine)]:hover:-translate-y-1 [@media(hover:hover)_and_(pointer:fine)]:hover:shadow-xl",e)},t))});Fe.displayName="Card";const ze=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx("div",q({ref:r,className:Ee("flex flex-col space-y-1.5 p-6 bg-gradient-to-r from-primary/5 to-accent/5 border-b border-border/50",e)},t))});ze.displayName="CardHeader";const He=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx("h3",q({ref:r,className:Ee("text-2xl font-bold leading-none tracking-tight text-foreground",e)},t))});He.displayName="CardTitle";const nt=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx("p",q({ref:r,className:Ee("text-sm text-muted-foreground",e)},t))});nt.displayName="CardDescription";const je=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx("div",q({ref:r,className:Ee("p-6 pt-0",e)},t))});je.displayName="CardContent";const hO=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx("div",q({ref:r,className:Ee("flex items-center p-6 pt-0",e)},t))});hO.displayName="CardFooter";function dO({className:e}){const[t,r]=H.useState(navigator.onLine),[n,i]=H.useState([]),[a,s]=H.useState(!1);H.useEffect(()=>{const h=()=>r(!0),m=()=>r(!1);return window.addEventListener("online",h),window.addEventListener("offline",m),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",d=>{d.data.type==="FORM_SYNC_SUCCESS"&&i(g=>g.filter(p=>p.id!==d.data.formId))}),o(),()=>{window.removeEventListener("online",h),window.removeEventListener("offline",m)}},[]);const o=()=>lt(null,null,function*(){if("serviceWorker"in navigator&&navigator.serviceWorker.controller){const h=new MessageChannel;h.port1.onmessage=m=>{if(m.data.type==="OFFLINE_FORMS_RESPONSE"){const d=Object.values(m.data.forms);i(d)}},navigator.serviceWorker.controller.postMessage({type:"GET_OFFLINE_FORMS"},[h.port2])}}),l=()=>t?n.length>0?f.jsx(rg,{className:"w-4 h-4 text-yellow-500"}):f.jsx(En,{className:"w-4 h-4 text-green-500"}):f.jsx(yT,{className:"w-4 h-4 text-red-500"}),c=()=>t?n.length>0?`${n.length} form${n.length>1?"s":""} pending sync`:"Online":"Offline",u=()=>t?n.length>0?"secondary":"default":"destructive";return t&&n.length===0?null:f.jsx("div",{className:e,children:f.jsx(Fe,{className:"border-l-4 border-l-blue-500",children:f.jsxs(je,{className:"p-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[l(),f.jsx("span",{className:"text-sm font-medium",children:c()}),n.length>0&&f.jsx(ht,{variant:u(),className:"text-xs",children:n.length})]}),n.length>0&&f.jsx(Le,{variant:"ghost",size:"sm",onClick:()=>s(!a),className:"text-xs",children:a?"Hide":"Details"})]}),a&&n.length>0&&f.jsxs("div",{className:"mt-3 space-y-2",children:[f.jsx("div",{className:"text-xs text-muted-foreground",children:"Forms saved offline will be submitted when connection is restored:"}),n.map(h=>f.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded text-xs",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(_r,{className:"w-3 h-3 text-yellow-500"}),f.jsxs("span",{children:[h.data.school," - ",new Date(h.timestamp).toLocaleTimeString()]})]}),f.jsx(ht,{variant:"outline",className:"text-xs",children:h.retryCount>0?`Retry ${h.retryCount}`:"Pending"})]},h.id))]}),!t&&f.jsx("div",{className:"mt-2 text-xs text-muted-foreground",children:"Your forms are being saved locally and will sync when you're back online."})]})})})}function mO({notifications:e,onRemove:t,maxNotifications:r=5}){const[n,i]=H.useState([]);H.useEffect(()=>{const l=[...e].sort((c,u)=>u.timestamp.getTime()-c.timestamp.getTime()).slice(0,r);i(l),l.forEach(c=>{if(!c.persistent&&c.duration!==0){const u=c.duration||5e3;setTimeout(()=>{t(c.id)},u)}})},[e,t,r]);const a=l=>{switch(l){case"success":return f.jsx(En,{className:"w-5 h-5 text-green-600"});case"error":return f.jsx(_r,{className:"w-5 h-5 text-red-600"});case"warning":return f.jsx(_r,{className:"w-5 h-5 text-yellow-600"});case"info":return f.jsx(l1,{className:"w-5 h-5 text-blue-600"});case"offline":return f.jsx(yT,{className:"w-5 h-5 text-orange-600"});case"sync":return f.jsx(wT,{className:"w-5 h-5 text-blue-600"});default:return f.jsx(l1,{className:"w-5 h-5 text-gray-600"})}},s=l=>{switch(l){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-yellow-50 border-yellow-200";case"info":return"bg-blue-50 border-blue-200";case"offline":return"bg-orange-50 border-orange-200";case"sync":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}},o=l=>{switch(l){case"success":return"text-green-900";case"error":return"text-red-900";case"warning":return"text-yellow-900";case"info":return"text-blue-900";case"offline":return"text-orange-900";case"sync":return"text-blue-900";default:return"text-gray-900"}};return n.length===0?null:f.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm w-full",children:n.map(l=>f.jsx("div",{className:`relative p-4 rounded-lg border shadow-lg transition-all duration-300 transform animate-in slide-in-from-right-full ${s(l.type)}`,children:f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsx("div",{className:"flex-shrink-0",children:a(l.type)}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:`text-sm font-semibold ${o(l.type)}`,children:l.title}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"text-xs text-muted-foreground",children:l.timestamp.toLocaleTimeString()}),f.jsx(Le,{variant:"ghost",size:"sm",onClick:()=>t(l.id),className:"h-6 w-6 p-0 hover:bg-black/10",children:f.jsx(qi,{className:"w-3 h-3"})})]})]}),f.jsx("p",{className:`text-sm mt-1 ${o(l.type)} opacity-90`,children:l.message}),l.actions&&l.actions.length>0&&f.jsx("div",{className:"flex space-x-2 mt-3",children:l.actions.map((c,u)=>f.jsx(Le,{variant:c.variant||"outline",size:"sm",onClick:c.action,className:"text-xs h-7",children:c.label},u))})]})]})},l.id))})}function pO(){const[e,t]=H.useState([]),r=h=>{const m=ce(q({},h),{id:`notification_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date});return t(d=>[...d,m]),m.id};return{notifications:e,addNotification:r,removeNotification:h=>{t(m=>m.filter(d=>d.id!==h))},clearAllNotifications:()=>{t([])},showSuccess:(h,m,d)=>r(q({type:"success",title:h,message:m},d)),showError:(h,m,d)=>r(q({type:"error",title:h,message:m,persistent:!0},d)),showWarning:(h,m,d)=>r(q({type:"warning",title:h,message:m},d)),showInfo:(h,m,d)=>r(q({type:"info",title:h,message:m},d)),showOffline:(h,m,d)=>r(q({type:"offline",title:h,message:m,persistent:!0},d)),showSync:(h,m,d)=>r(q({type:"sync",title:h,message:m},d))}}var gu=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},xu=typeof window=="undefined"||"Deno"in globalThis;function vn(){}function gO(e,t){return typeof e=="function"?e(t):e}function xO(e){return typeof e=="number"&&e>=0&&e!==1/0}function vO(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Km(e,t){return typeof e=="function"?e(t):e}function yO(e,t){return typeof e=="function"?e(t):e}function _1(e,t){const{type:r="all",exact:n,fetchStatus:i,predicate:a,queryKey:s,stale:o}=e;if(s){if(n){if(t.queryHash!==cg(s,t.options))return!1}else if(!zo(t.queryKey,s))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||i&&i!==t.state.fetchStatus||a&&!a(t))}function S1(e,t){const{exact:r,status:n,predicate:i,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(r){if(qo(t.options.mutationKey)!==qo(a))return!1}else if(!zo(t.options.mutationKey,a))return!1}return!(n&&t.state.status!==n||i&&!i(t))}function cg(e,t){return((t==null?void 0:t.queryKeyHashFn)||qo)(e)}function qo(e){return JSON.stringify(e,(t,r)=>Qm(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function zo(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>zo(e[r],t[r])):!1}function gE(e,t){if(e===t)return e;const r=T1(e)&&T1(t);if(r||Qm(e)&&Qm(t)){const n=r?e:Object.keys(e),i=n.length,a=r?t:Object.keys(t),s=a.length,o=r?[]:{},l=new Set(n);let c=0;for(let u=0;u<s;u++){const h=r?u:a[u];(!r&&l.has(h)||r)&&e[h]===void 0&&t[h]===void 0?(o[h]=void 0,c++):(o[h]=gE(e[h],t[h]),o[h]===e[h]&&e[h]!==void 0&&c++)}return i===s&&c===i?e:o}return t}function T1(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Qm(e){if(!E1(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!E1(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function E1(e){return Object.prototype.toString.call(e)==="[object Object]"}function wO(e){return new Promise(t=>{setTimeout(t,e)})}function bO(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?gE(e,t):t}function _O(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function SO(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var ug=Symbol();function xE(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ug?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var wa,Fi,Es,iT,TO=(iT=class extends gu{constructor(){super();Ke(this,wa);Ke(this,Fi);Ke(this,Es);Pe(this,Es,t=>{if(!xu&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){se(this,Fi)||this.setEventListener(se(this,Es))}onUnsubscribe(){var t;this.hasListeners()||((t=se(this,Fi))==null||t.call(this),Pe(this,Fi,void 0))}setEventListener(t){var r;Pe(this,Es,t),(r=se(this,Fi))==null||r.call(this),Pe(this,Fi,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){se(this,wa)!==t&&(Pe(this,wa,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof se(this,wa)=="boolean"?se(this,wa):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},wa=new WeakMap,Fi=new WeakMap,Es=new WeakMap,iT),vE=new TO,Ns,Ii,As,aT,EO=(aT=class extends gu{constructor(){super();Ke(this,Ns,!0);Ke(this,Ii);Ke(this,As);Pe(this,As,t=>{if(!xu&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){se(this,Ii)||this.setEventListener(se(this,As))}onUnsubscribe(){var t;this.hasListeners()||((t=se(this,Ii))==null||t.call(this),Pe(this,Ii,void 0))}setEventListener(t){var r;Pe(this,As,t),(r=se(this,Ii))==null||r.call(this),Pe(this,Ii,t(this.setOnline.bind(this)))}setOnline(t){se(this,Ns)!==t&&(Pe(this,Ns,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return se(this,Ns)}},Ns=new WeakMap,Ii=new WeakMap,As=new WeakMap,aT),kc=new EO;function NO(){let e,t;const r=new Promise((i,a)=>{e=i,t=a});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),e(i)},r.reject=i=>{n({status:"rejected",reason:i}),t(i)},r}function AO(e){return Math.min(1e3*Ul(2,e),3e4)}function yE(e){return(e!=null?e:"online")==="online"?kc.isOnline():!0}var wE=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function bE(e){let t=!1,r=0,n;const i=NO(),a=()=>i.status!=="pending",s=p=>{var x;a()||(m(new wE(p)),(x=e.abort)==null||x.call(e))},o=()=>{t=!0},l=()=>{t=!1},c=()=>vE.isFocused()&&(e.networkMode==="always"||kc.isOnline())&&e.canRun(),u=()=>yE(e.networkMode)&&e.canRun(),h=p=>{a()||(n==null||n(),i.resolve(p))},m=p=>{a()||(n==null||n(),i.reject(p))},d=()=>new Promise(p=>{var x;n=v=>{(a()||c())&&p(v)},(x=e.onPause)==null||x.call(e)}).then(()=>{var p;n=void 0,a()||(p=e.onContinue)==null||p.call(e)}),g=()=>{if(a())return;let p;const x=r===0?e.initialPromise:void 0;try{p=x!=null?x:e.fn()}catch(v){p=Promise.reject(v)}Promise.resolve(p).then(h).catch(v=>{var T,S,E;if(a())return;const b=(T=e.retry)!=null?T:xu?0:3,y=(S=e.retryDelay)!=null?S:AO,w=typeof y=="function"?y(r,v):y,k=b===!0||typeof b=="number"&&r<b||typeof b=="function"&&b(r,v);if(t||!k){m(v);return}r++,(E=e.onFail)==null||E.call(e,r,v),wO(w).then(()=>c()?void 0:d()).then(()=>{t?m(v):g()})})};return{promise:i,status:()=>i.status,cancel:s,continue:()=>(n==null||n(),i),cancelRetry:o,continueRetry:l,canStart:u,start:()=>(u()?g():d().then(g),i)}}var CO=e=>setTimeout(e,0);function kO(){let e=[],t=0,r=o=>{o()},n=o=>{o()},i=CO;const a=o=>{t?e.push(o):i(()=>{r(o)})},s=()=>{const o=e;e=[],o.length&&i(()=>{n(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||s()}return l},batchCalls:o=>(...l)=>{a(()=>{o(...l)})},schedule:a,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{i=o}}}var wr=kO(),ba,sT,_E=(sT=class{constructor(){Ke(this,ba)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),xO(this.gcTime)&&Pe(this,ba,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e!=null?e:xu?1/0:300*1e3)}clearGcTimeout(){se(this,ba)&&(clearTimeout(se(this,ba)),Pe(this,ba,void 0))}},ba=new WeakMap,sT),Cs,ks,en,_a,Vt,fl,Sa,yn,ni,oT,RO=(oT=class extends _E{constructor(t){var r;super();Ke(this,yn);Ke(this,Cs);Ke(this,ks);Ke(this,en);Ke(this,_a);Ke(this,Vt);Ke(this,fl);Ke(this,Sa);Pe(this,Sa,!1),Pe(this,fl,t.defaultOptions),this.setOptions(t.options),this.observers=[],Pe(this,_a,t.client),Pe(this,en,se(this,_a).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Pe(this,Cs,FO(this.options)),this.state=(r=t.state)!=null?r:se(this,Cs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=se(this,Vt))==null?void 0:t.promise}setOptions(t){this.options=q(q({},se(this,fl)),t),this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&se(this,en).remove(this)}setData(t,r){const n=bO(this.state.data,t,this.options);return lr(this,yn,ni).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){lr(this,yn,ni).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,i;const r=(n=se(this,Vt))==null?void 0:n.promise;return(i=se(this,Vt))==null||i.cancel(t),r?r.then(vn).catch(vn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(se(this,Cs))}isActive(){return this.observers.some(t=>yO(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ug||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Km(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!vO(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=se(this,Vt))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=se(this,Vt))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),se(this,en).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(se(this,Vt)&&(se(this,Sa)?se(this,Vt).cancel({revert:!0}):se(this,Vt).cancelRetry()),this.scheduleGc()),se(this,en).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||lr(this,yn,ni).call(this,{type:"invalidate"})}fetch(t,r){return lt(this,null,function*(){var l,c,u,h,m,d,g,p,x,v,b,y;if(this.state.fetchStatus!=="idle"&&((l=se(this,Vt))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(se(this,Vt))return se(this,Vt).continueRetry(),se(this,Vt).promise}if(t&&this.setOptions(t),!this.options.queryFn){const w=this.observers.find(k=>k.options.queryFn);w&&this.setOptions(w.options)}const n=new AbortController,i=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(Pe(this,Sa,!0),n.signal)})},a=()=>{const w=xE(this.options,r),T=(()=>{const S={client:se(this,_a),queryKey:this.queryKey,meta:this.meta};return i(S),S})();return Pe(this,Sa,!1),this.options.persister?this.options.persister(w,T,this):w(T)},o=(()=>{const w={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:se(this,_a),state:this.state,fetchFn:a};return i(w),w})();(c=this.options.behavior)==null||c.onFetch(o,this),Pe(this,ks,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=o.fetchOptions)==null?void 0:u.meta))&&lr(this,yn,ni).call(this,{type:"fetch",meta:(h=o.fetchOptions)==null?void 0:h.meta}),Pe(this,Vt,bE({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,abort:n.abort.bind(n),onFail:(w,k)=>{lr(this,yn,ni).call(this,{type:"failed",failureCount:w,error:k})},onPause:()=>{lr(this,yn,ni).call(this,{type:"pause"})},onContinue:()=>{lr(this,yn,ni).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const w=yield se(this,Vt).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(d=(m=se(this,en).config).onSuccess)==null||d.call(m,w,this),(p=(g=se(this,en).config).onSettled)==null||p.call(g,w,this.state.error,this),w}catch(w){if(w instanceof wE){if(w.silent)return se(this,Vt).promise;if(w.revert){if(this.setState(ce(q({},se(this,ks)),{fetchStatus:"idle"})),this.state.data===void 0)throw w;return this.state.data}}throw lr(this,yn,ni).call(this,{type:"error",error:w}),(v=(x=se(this,en).config).onError)==null||v.call(x,w,this),(y=(b=se(this,en).config).onSettled)==null||y.call(b,this.state.data,w,this),w}finally{this.scheduleGc()}})}},Cs=new WeakMap,ks=new WeakMap,en=new WeakMap,_a=new WeakMap,Vt=new WeakMap,fl=new WeakMap,Sa=new WeakMap,yn=new WeakSet,ni=function(t){const r=n=>{var i,a;switch(t.type){case"failed":return ce(q({},n),{fetchFailureCount:t.failureCount,fetchFailureReason:t.error});case"pause":return ce(q({},n),{fetchStatus:"paused"});case"continue":return ce(q({},n),{fetchStatus:"fetching"});case"fetch":return ce(q(q({},n),OO(n.data,this.options)),{fetchMeta:(i=t.meta)!=null?i:null});case"success":const s=q(ce(q({},n),{data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:(a=t.dataUpdatedAt)!=null?a:Date.now(),error:null,isInvalidated:!1,status:"success"}),!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null});return Pe(this,ks,t.manual?s:void 0),s;case"error":const o=t.error;return ce(q({},n),{error:o,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"});case"invalidate":return ce(q({},n),{isInvalidated:!0});case"setState":return q(q({},n),t.state)}};this.state=r(this.state),wr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),se(this,en).notify({query:this,type:"updated",action:t})})},oT);function OO(e,t){return q({fetchFailureCount:0,fetchFailureReason:null,fetchStatus:yE(t.networkMode)?"fetching":"paused"},e===void 0&&{error:null,status:"pending"})}function FO(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n!=null?n:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Pn,lT,IO=(lT=class extends gu{constructor(t={}){super();Ke(this,Pn);this.config=t,Pe(this,Pn,new Map)}build(t,r,n){var o;const i=r.queryKey,a=(o=r.queryHash)!=null?o:cg(i,r);let s=this.get(a);return s||(s=new RO({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(s)),s}add(t){se(this,Pn).has(t.queryHash)||(se(this,Pn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=se(this,Pn).get(t.queryHash);r&&(t.destroy(),r===t&&se(this,Pn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){wr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return se(this,Pn).get(t)}getAll(){return[...se(this,Pn).values()]}find(t){const r=q({exact:!0},t);return this.getAll().find(n=>_1(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>_1(t,n)):r}notify(t){wr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){wr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){wr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Pn=new WeakMap,lT),Mn,xr,Ta,Ln,ki,cT,jO=(cT=class extends _E{constructor(t){super();Ke(this,Ln);Ke(this,Mn);Ke(this,xr);Ke(this,Ta);this.mutationId=t.mutationId,Pe(this,xr,t.mutationCache),Pe(this,Mn,[]),this.state=t.state||DO(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){se(this,Mn).includes(t)||(se(this,Mn).push(t),this.clearGcTimeout(),se(this,xr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Pe(this,Mn,se(this,Mn).filter(r=>r!==t)),this.scheduleGc(),se(this,xr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){se(this,Mn).length||(this.state.status==="pending"?this.scheduleGc():se(this,xr).remove(this))}continue(){var t,r;return(r=(t=se(this,Ta))==null?void 0:t.continue())!=null?r:this.execute(this.state.variables)}execute(t){return lt(this,null,function*(){var a,s,o,l,c,u,h,m,d,g,p,x,v,b,y,w,k,T,S,E,A;const r=()=>{lr(this,Ln,ki).call(this,{type:"continue"})};Pe(this,Ta,bE({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(R,C)=>{lr(this,Ln,ki).call(this,{type:"failed",failureCount:R,error:C})},onPause:()=>{lr(this,Ln,ki).call(this,{type:"pause"})},onContinue:r,retry:(a=this.options.retry)!=null?a:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>se(this,xr).canRun(this)}));const n=this.state.status==="pending",i=!se(this,Ta).canStart();try{if(n)r();else{lr(this,Ln,ki).call(this,{type:"pending",variables:t,isPaused:i}),yield(o=(s=se(this,xr).config).onMutate)==null?void 0:o.call(s,t,this);const C=yield(c=(l=this.options).onMutate)==null?void 0:c.call(l,t);C!==this.state.context&&lr(this,Ln,ki).call(this,{type:"pending",context:C,variables:t,isPaused:i})}const R=yield se(this,Ta).start();return yield(h=(u=se(this,xr).config).onSuccess)==null?void 0:h.call(u,R,t,this.state.context,this),yield(d=(m=this.options).onSuccess)==null?void 0:d.call(m,R,t,this.state.context),yield(p=(g=se(this,xr).config).onSettled)==null?void 0:p.call(g,R,null,this.state.variables,this.state.context,this),yield(v=(x=this.options).onSettled)==null?void 0:v.call(x,R,null,t,this.state.context),lr(this,Ln,ki).call(this,{type:"success",data:R}),R}catch(R){try{throw yield(y=(b=se(this,xr).config).onError)==null?void 0:y.call(b,R,t,this.state.context,this),yield(k=(w=this.options).onError)==null?void 0:k.call(w,R,t,this.state.context),yield(S=(T=se(this,xr).config).onSettled)==null?void 0:S.call(T,void 0,R,this.state.variables,this.state.context,this),yield(A=(E=this.options).onSettled)==null?void 0:A.call(E,void 0,R,t,this.state.context),R}finally{lr(this,Ln,ki).call(this,{type:"error",error:R})}}finally{se(this,xr).runNext(this)}})}},Mn=new WeakMap,xr=new WeakMap,Ta=new WeakMap,Ln=new WeakSet,ki=function(t){const r=n=>{switch(t.type){case"failed":return ce(q({},n),{failureCount:t.failureCount,failureReason:t.error});case"pause":return ce(q({},n),{isPaused:!0});case"continue":return ce(q({},n),{isPaused:!1});case"pending":return ce(q({},n),{context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()});case"success":return ce(q({},n),{data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1});case"error":return ce(q({},n),{data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"})}};this.state=r(this.state),wr.batch(()=>{se(this,Mn).forEach(n=>{n.onMutationUpdate(t)}),se(this,xr).notify({mutation:this,type:"updated",action:t})})},cT);function DO(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ai,wn,hl,uT,PO=(uT=class extends gu{constructor(t={}){super();Ke(this,ai);Ke(this,wn);Ke(this,hl);this.config=t,Pe(this,ai,new Set),Pe(this,wn,new Map),Pe(this,hl,0)}build(t,r,n){const i=new jO({mutationCache:this,mutationId:++ql(this,hl)._,options:t.defaultMutationOptions(r),state:n});return this.add(i),i}add(t){se(this,ai).add(t);const r=zl(t);if(typeof r=="string"){const n=se(this,wn).get(r);n?n.push(t):se(this,wn).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(se(this,ai).delete(t)){const r=zl(t);if(typeof r=="string"){const n=se(this,wn).get(r);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&se(this,wn).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=zl(t);if(typeof r=="string"){const n=se(this,wn).get(r),i=n==null?void 0:n.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){var n,i;const r=zl(t);if(typeof r=="string"){const a=(n=se(this,wn).get(r))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(i=a==null?void 0:a.continue())!=null?i:Promise.resolve()}else return Promise.resolve()}clear(){wr.batch(()=>{se(this,ai).forEach(t=>{this.notify({type:"removed",mutation:t})}),se(this,ai).clear(),se(this,wn).clear()})}getAll(){return Array.from(se(this,ai))}find(t){const r=q({exact:!0},t);return this.getAll().find(n=>S1(r,n))}findAll(t={}){return this.getAll().filter(r=>S1(t,r))}notify(t){wr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return wr.batch(()=>Promise.all(t.map(r=>r.continue().catch(vn))))}},ai=new WeakMap,wn=new WeakMap,hl=new WeakMap,uT);function zl(e){var t;return(t=e.options.scope)==null?void 0:t.id}function N1(e){return{onFetch:(t,r)=>{var u,h,m,d,g;const n=t.options,i=(m=(h=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:m.direction,a=((d=t.state.data)==null?void 0:d.pages)||[],s=((g=t.state.data)==null?void 0:g.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const c=()=>lt(null,null,function*(){var y;let p=!1;const x=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(t.signal.aborted?p=!0:t.signal.addEventListener("abort",()=>{p=!0}),t.signal)})},v=xE(t.options,t.fetchOptions),b=(w,k,T)=>lt(null,null,function*(){if(p)return Promise.reject();if(k==null&&w.pages.length)return Promise.resolve(w);const E=(()=>{const j={client:t.client,queryKey:t.queryKey,pageParam:k,direction:T?"backward":"forward",meta:t.options.meta};return x(j),j})(),A=yield v(E),{maxPages:R}=t.options,C=T?SO:_O;return{pages:C(w.pages,A,R),pageParams:C(w.pageParams,k,R)}});if(i&&a.length){const w=i==="backward",k=w?MO:A1,T={pages:a,pageParams:s},S=k(n,T);o=yield b(T,S,w)}else{const w=e!=null?e:a.length;do{const k=l===0?(y=s[0])!=null?y:n.initialPageParam:A1(n,o);if(l>0&&k==null)break;o=yield b(o,k),l++}while(l<w)}return o});t.options.persister?t.fetchFn=()=>{var p,x;return(x=(p=t.options).persister)==null?void 0:x.call(p,c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=c}}}function A1(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function MO(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var At,ji,Di,Rs,Os,Pi,Fs,Is,fT,LO=(fT=class{constructor(e={}){Ke(this,At);Ke(this,ji);Ke(this,Di);Ke(this,Rs);Ke(this,Os);Ke(this,Pi);Ke(this,Fs);Ke(this,Is);Pe(this,At,e.queryCache||new IO),Pe(this,ji,e.mutationCache||new PO),Pe(this,Di,e.defaultOptions||{}),Pe(this,Rs,new Map),Pe(this,Os,new Map),Pe(this,Pi,0)}mount(){ql(this,Pi)._++,se(this,Pi)===1&&(Pe(this,Fs,vE.subscribe(e=>lt(this,null,function*(){e&&(yield this.resumePausedMutations(),se(this,At).onFocus())}))),Pe(this,Is,kc.subscribe(e=>lt(this,null,function*(){e&&(yield this.resumePausedMutations(),se(this,At).onOnline())}))))}unmount(){var e,t;ql(this,Pi)._--,se(this,Pi)===0&&((e=se(this,Fs))==null||e.call(this),Pe(this,Fs,void 0),(t=se(this,Is))==null||t.call(this),Pe(this,Is,void 0))}isFetching(e){return se(this,At).findAll(ce(q({},e),{fetchStatus:"fetching"})).length}isMutating(e){return se(this,ji).findAll(ce(q({},e),{status:"pending"})).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=se(this,At).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=se(this,At).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Km(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return se(this,At).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),i=se(this,At).get(n.queryHash),a=i==null?void 0:i.state.data,s=gO(t,a);if(s!==void 0)return se(this,At).build(this,n).setData(s,ce(q({},r),{manual:!0}))}setQueriesData(e,t,r){return wr.batch(()=>se(this,At).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=se(this,At).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=se(this,At);wr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=se(this,At);return wr.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries(q({type:"active"},e),t)))}cancelQueries(e,t={}){const r=q({revert:!0},t),n=wr.batch(()=>se(this,At).findAll(e).map(i=>i.cancel(r)));return Promise.all(n).then(vn).catch(vn)}invalidateQueries(e,t={}){return wr.batch(()=>{var r,n;return se(this,At).findAll(e).forEach(i=>{i.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries(ce(q({},e),{type:(n=(r=e==null?void 0:e.refetchType)!=null?r:e==null?void 0:e.type)!=null?n:"active"}),t)})}refetchQueries(e,t={}){var i;const r=ce(q({},t),{cancelRefetch:(i=t.cancelRefetch)!=null?i:!0}),n=wr.batch(()=>se(this,At).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let s=a.fetch(void 0,r);return r.throwOnError||(s=s.catch(vn)),a.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(vn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=se(this,At).build(this,t);return r.isStaleByTime(Km(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(vn).catch(vn)}fetchInfiniteQuery(e){return e.behavior=N1(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(vn).catch(vn)}ensureInfiniteQueryData(e){return e.behavior=N1(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return kc.isOnline()?se(this,ji).resumePausedMutations():Promise.resolve()}getQueryCache(){return se(this,At)}getMutationCache(){return se(this,ji)}getDefaultOptions(){return se(this,Di)}setDefaultOptions(e){Pe(this,Di,e)}setQueryDefaults(e,t){se(this,Rs).set(qo(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...se(this,Rs).values()],r={};return t.forEach(n=>{zo(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){se(this,Os).set(qo(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...se(this,Os).values()],r={};return t.forEach(n=>{zo(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t=ce(q(q(q({},se(this,Di).queries),this.getQueryDefaults(e.queryKey)),e),{_defaulted:!0});return t.queryHash||(t.queryHash=cg(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ug&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:ce(q(q(q({},se(this,Di).mutations),(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey)),e),{_defaulted:!0})}clear(){se(this,At).clear(),se(this,ji).clear()}},At=new WeakMap,ji=new WeakMap,Di=new WeakMap,Rs=new WeakMap,Os=new WeakMap,Pi=new WeakMap,Fs=new WeakMap,Is=new WeakMap,fT);function BO(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var r,n,i,a,s=[],o="",l=e.split("/");for(l[0]||l.shift();i=l.shift();)r=i[0],r==="*"?(s.push(r),o+=i[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(n=i.indexOf("?",1),a=i.indexOf(".",1),s.push(i.substring(1,~n?n:~a?a:i.length)),o+=~n&&!~a?"(?:/([^/]+?))?":"/([^/]+?)",~a&&(o+=(~n?"?":"")+"\\"+i.substring(a))):o+="/"+i;return{keys:s,pattern:new RegExp("^"+o+(t?"(?=$|/)":"/?$"),"i")}}var cf={exports:{}},uf={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C1;function UO(){if(C1)return uf;C1=1;var e=H3();function t(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,i=e.useEffect,a=e.useLayoutEffect,s=e.useDebugValue;function o(h,m){var d=m(),g=n({inst:{value:d,getSnapshot:m}}),p=g[0].inst,x=g[1];return a(function(){p.value=d,p.getSnapshot=m,l(p)&&x({inst:p})},[h,d,m]),i(function(){return l(p)&&x({inst:p}),h(function(){l(p)&&x({inst:p})})},[h]),s(d),d}function l(h){var m=h.getSnapshot;h=h.value;try{var d=m();return!r(h,d)}catch(g){return!0}}function c(h,m){return m()}var u=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?c:o;return uf.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,uf}var k1;function qO(){return k1||(k1=1,cf.exports=UO()),cf.exports}var zO=qO();const HO="popstate",fg="pushState",hg="replaceState",$O="hashchange",R1=[HO,fg,hg,$O],VO=e=>{for(const t of R1)addEventListener(t,e);return()=>{for(const t of R1)removeEventListener(t,e)}},SE=(e,t)=>zO.useSyncExternalStore(VO,e,t),WO=()=>location.search,GO=({ssrSearch:e=""}={})=>SE(WO,()=>e),O1=()=>location.pathname,YO=({ssrPath:e}={})=>SE(O1,e?()=>e:O1),XO=(e,{replace:t=!1,state:r=null}={})=>history[t?hg:fg](r,"",e),KO=(e={})=>[YO(e),XO],F1=Symbol.for("wouter_v3");if(typeof history!="undefined"&&typeof window[F1]=="undefined"){for(const e of[fg,hg]){const t=history[e];history[e]=function(){const r=t.apply(this,arguments),n=new Event(e);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,F1,{value:!0})}const QO=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",TE=(e="")=>e==="/"?"":e,ZO=(e,t)=>e[0]==="~"?e.slice(1):TE(t)+e,JO=(e="",t)=>QO(I1(TE(e)),I1(t)),I1=e=>{try{return decodeURI(e)}catch(t){return e}},EE={hook:KO,searchHook:GO,parser:BO,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},NE=H.createContext(EE),dg=()=>H.useContext(NE),eF={};H.createContext(eF);const AE=e=>{const[t,r]=e.hook(e);return[JO(e.base,t),bT((n,i)=>r(ZO(n,e.base),i))]},tF=()=>AE(dg()),rF=r=>{var n=r,{children:e}=n,t=we(n,["children"]);var m,d,g,p;const i=dg(),a=t.hook?EE:i;let s=a;const[o,l]=(d=(m=t.ssrPath)==null?void 0:m.split("?"))!=null?d:[];l&&(t.ssrSearch=l,t.ssrPath=o),t.hrefs=(p=t.hrefs)!=null?p:(g=t.hook)==null?void 0:g.hrefs;let c=H.useRef({}),u=c.current,h=u;for(let x in a){const v=x==="base"?a[x]+(t[x]||""):t[x]||a[x];u===h&&v!==h[x]&&(c.current=h=q({},h)),h[x]=v,(v!==a[x]||v!==s[x])&&(s=h)}return H.createElement(NE.Provider,{value:s,children:e})};H.forwardRef((e,t)=>{const r=dg(),[n,i]=AE(r),x=e,{to:a="",href:s=a,onClick:o,asChild:l,children:c,className:u,replace:h,state:m}=x,d=we(x,["to","href","onClick","asChild","children","className","replace","state"]),g=bT(v=>{v.ctrlKey||v.metaKey||v.altKey||v.shiftKey||v.button!==0||(o==null||o(v),v.defaultPrevented||(v.preventDefault(),i(s,e)))}),p=r.hrefs(s[0]==="~"?s.slice(1):r.base+s,r);return l&&H.isValidElement(c)?H.cloneElement(c,{onClick:g,href:p}):H.createElement("a",ce(q({},d),{onClick:g,href:p,className:u!=null&&u.call?u(n===s):u,children:c,ref:t}))});function nF(){if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw new Error("XMLHttpRequest not supported")}}function iF(e,t={}){return new Promise(function(r,n){var i=nF(),a=t.method||"GET";if(i.open(a,e,!0),i.withCredentials=t.credentials==="include",t.headers)for(var s in t.headers)t.headers.hasOwnProperty(s)&&i.setRequestHeader(s,t.headers[s]);i.onreadystatechange=function(){if(i.readyState===4){var o={ok:i.status>=200&&i.status<300,status:i.status,statusText:i.statusText,text:function(){return Promise.resolve(i.responseText)},json:function(){try{return Promise.resolve(JSON.parse(i.responseText))}catch(l){return Promise.reject(l)}}};o.ok?r(o):n(new Error(i.status+": "+i.statusText))}},i.onerror=function(){n(new Error("Network error"))},i.send(t.body||null)})}var aF=typeof fetch!="undefined"?fetch:iF;function sF(e){return new Promise(function(t,r){e.ok?t(e):e.text().then(function(n){r(new Error(e.status+": "+(n||e.statusText)))})})}const oF=({on401:e})=>function({queryKey:t}){return new Promise(function(r,n){aF(t.join("/"),{credentials:"include"}).then(function(i){return sF(i).then(function(){return i.json()})}).then(r).catch(n)})},lF=new LO({defaultOptions:{queries:{queryFn:oF({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),cF=({className:e})=>{const[t]=tF(),r=[{id:"home",label:"Home",icon:$3,href:"/",active:t==="/"},{id:"inspection",label:"Inspect",icon:V3,href:"/custodial-inspection",active:t==="/custodial-inspection"},{id:"building",label:"Building",icon:an,href:"/whole-building-inspection",active:t==="/whole-building-inspection"},{id:"data",label:"Data",icon:ng,href:"/inspection-data",active:t==="/inspection-data"},{id:"admin",label:"Admin",icon:Mi,href:"/admin-inspections",active:t==="/admin-inspections"}];return f.jsxs("div",{className:Ee("fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50 md:hidden",e),children:[f.jsx("div",{className:"grid grid-cols-5 py-2",children:r.map(n=>{const i=n.icon;return f.jsxs("a",{href:n.href,className:Ee("flex flex-col items-center justify-center py-2 px-1 text-xs transition-colors duration-200 touch-manipulation",n.active?"text-blue-600":"text-gray-600 hover:text-gray-900 active:scale-95"),children:[f.jsxs("div",{className:"relative",children:[f.jsx(i,{className:Ee("h-6 w-6 transition-transform duration-200",n.active&&"scale-110")}),n.active&&f.jsx("div",{className:"absolute -top-1 -right-1 h-2 w-2 bg-blue-600 rounded-full animate-pulse"})]}),f.jsx("span",{className:Ee("mt-1 font-medium text-[10px] leading-tight",n.active&&"font-semibold"),children:n.label})]},n.id)})}),f.jsx("div",{className:"h-safe-area-inset-bottom bg-white"})]})},ff=({href:e,children:t,className:r})=>f.jsx("a",{href:e,className:Ee("sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-blue-600 text-white px-4 py-2 rounded-md z-50 transition-all duration-200 hover:bg-blue-700",r),children:t}),uF=()=>({announce:(t,r="polite")=>{const n=document.createElement("div");n.setAttribute("aria-live",r),n.setAttribute("aria-atomic","true"),n.className="sr-only",n.textContent=t,document.body.appendChild(n),setTimeout(()=>{document.body.removeChild(n)},1e3)}}),fF=()=>{H.useEffect(()=>{const e=t=>{if(t.key==="Escape"){const r=document.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');r.length>0&&r[0].focus()}if(t.key==="Tab"&&t.shiftKey){const r=document.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(r.length>0){const n=r[r.length-1];document.activeElement===n&&(t.preventDefault(),r.length>1&&r[0].focus())}}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[])},hF=()=>{const e=H.useCallback(()=>{const r=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),n=[];let i=0;return r.forEach((a,s)=>{var l;const o=parseInt(a.tagName.charAt(1));s>0&&o>i+1&&n.push(`Skipped heading level: h${i} to h${o} at "${a.textContent}"`),(l=a.textContent)!=null&&l.trim()||n.push(`Empty ${a.tagName} found`),i=o}),n},[]),t=H.useCallback(()=>{const r=document.querySelectorAll("h1, h2, h3, h4, h5, h6");return Array.from(r).map(n=>{var i;return{level:parseInt(n.tagName.charAt(1)),text:((i=n.textContent)==null?void 0:i.trim())||"",id:n.id||""}})},[]);return{validateHeadingStructure:e,getHeadingOutline:t}},dF=()=>({validateImages:H.useCallback(()=>{const t=document.querySelectorAll("img"),r=[];return t.forEach((n,i)=>{const a=n.getAttribute("alt");a===null&&r.push(`Image ${i+1}: Missing alt attribute`),a===""&&!n.getAttribute("role")&&r.push(`Image ${i+1}: Decorative image should have role="presentation" or alt=""`),a&&a.length>125&&r.push(`Image ${i+1}: Alt text too long (${a.length} chars), consider using longdesc`)}),r},[])}),mF=()=>({validateLinks:H.useCallback(()=>{const t=document.querySelectorAll("a[href]"),r=[],n=new Set;return t.forEach((i,a)=>{var l,c;const s=((l=i.textContent)==null?void 0:l.trim())||"";i.getAttribute("href"),!s&&!i.querySelector("img")&&r.push(`Link ${a+1}: Empty link text`),["click here","read more","learn more","here","more"].includes(s.toLowerCase())&&r.push(`Link ${a+1}: Generic link text "${s}" - be more descriptive`),n.has(s)?r.push(`Link ${a+1}: Duplicate link text "${s}" - ensure context or make unique`):n.add(s),i.getAttribute("target")==="_blank"&&!((c=i.getAttribute("aria-label"))!=null&&c.includes("opens"))&&r.push(`Link ${a+1}: Opens new window without accessibility warning`)}),r},[])}),pF=()=>({validateForms:H.useCallback(()=>{const t=document.querySelectorAll("form"),r=[];return t.forEach((n,i)=>{n.querySelectorAll("input, select, textarea").forEach((s,o)=>{var d;const l=s.tagName.toLowerCase(),c=s.id,u=c?document.querySelector(`label[for="${c}"]`):!1,h=s.getAttribute("aria-label"),m=s.getAttribute("aria-labelledby");if(!u&&!h&&!m&&r.push(`Form ${i+1}, ${l} ${o+1}: Missing label or aria-label`),s.hasAttribute("required")){const g=s.getAttribute("aria-required")==="true",p=u&&((d=u==null?void 0:u.textContent)==null?void 0:d.includes("*"));!g&&!p&&r.push(`Form ${i+1}, ${l} ${o+1}: Required field not clearly indicated`)}if(s.classList.contains("error")||s.getAttribute("aria-invalid")==="true"){const g=s.getAttribute("aria-describedby");g&&document.getElementById(g)||r.push(`Form ${i+1}, ${l} ${o+1}: Invalid field has no error message`)}})}),r},[])}),gF=()=>{const[e,t]=H.useState(!1);return H.useEffect(()=>{const r=navigator.userAgent.toLowerCase(),n=r.includes("nvda")||r.includes(" jaws")||r.includes("dragon")||window.speechSynthesis!==void 0,i=window.matchMedia("(prefers-reduced-motion: reduce)").matches,a=window.matchMedia("(prefers-contrast: high)").matches;t(n||i||a)},[]),e},xF=()=>({runQuickAudit:H.useCallback(()=>{const t=[],{validateHeadingStructure:r}=hF();t.push(...r());const{validateImages:n}=dF();t.push(...n());const{validateLinks:i}=mF();t.push(...i());const{validateForms:a}=pF();return t.push(...a()),document.documentElement.getAttribute("lang")||t.push("Missing lang attribute on html element"),(!document.title||document.title.length===0)&&t.push("Missing or empty page title"),{violations:t,score:Math.max(0,100-t.length*5),total:t.length}},[])}),vF=()=>{const[e,t]=H.useState("medium"),r=H.useCallback(()=>{t(a=>a==="small"?"medium":"large")},[]),n=H.useCallback(()=>{t(a=>a==="large"?"medium":"small")},[]),i=H.useCallback(()=>{t("medium")},[]);return{textSize:e,increaseTextSize:r,decreaseTextSize:n,resetTextSize:i}},yF=()=>{H.useEffect(()=>{const e=t=>{if(t.ctrlKey||t.metaKey)switch(t.key){case"+":case"=":t.preventDefault(),document.body.style.fontSize="larger";break;case"-":t.preventDefault(),document.body.style.fontSize="smaller";break;case"0":t.preventDefault(),document.body.style.fontSize="";break}if(t.altKey)switch(t.key){case"m":t.preventDefault();const r=document.querySelector('main, [role="main"]');r&&(r.focus(),r.scrollIntoView());break;case"n":t.preventDefault();const n=document.querySelector('nav, [role="navigation"]');n&&(n.focus(),n.scrollIntoView());break;case"h":t.preventDefault();const i=document.querySelector("h1");i&&(i.focus(),i.scrollIntoView());break}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[])},wF=H.lazy(()=>Ji(()=>import("./inspection-pages-DOJgFRVN-v6.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),bF=H.lazy(()=>Ji(()=>import("./data-pages-Bfwjy2va-v6.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),_F=H.lazy(()=>Ji(()=>import("./notes-pages-BA77IFGC-v6.js"),__vite__mapDeps([8,1,2,3,4,5,6]))),SF=H.lazy(()=>Ji(()=>import("./building-inspection-Bh3Dkb57-v6.js"),__vite__mapDeps([9,1,2,3,4,5,6]))),TF=H.lazy(()=>Ji(()=>Promise.resolve().then(()=>wW),void 0)),EF=H.lazy(()=>Ji(()=>import("./admin-pages-B5v7X2xk-v6.js"),__vite__mapDeps([10,1,2,3,4,5,6]))),NF=H.lazy(()=>Ji(()=>import("./feedback-pages-Bj5cmIWP-v6.js"),__vite__mapDeps([11,1,2,3,4,5,6]))),AF=H.lazy(()=>Ji(()=>import("./dashboard-pages-BCpuSdsS-v6.js"),__vite__mapDeps([12,1,2,3,4,5,6]))),Ei=()=>f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:f.jsxs("div",{className:"text-center max-w-md mx-auto",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),f.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Loading..."}),f.jsx("p",{className:"text-muted-foreground",children:"Please wait while we load the page."})]})});class CF extends hs.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}render(){return this.state.hasError?f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:f.jsxs("div",{className:"text-center max-w-md mx-auto",children:[f.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),f.jsx("p",{className:"text-gray-600 mb-4",children:"Please refresh the page to try again."}),f.jsx("button",{onClick:()=>window.location.reload(),className:"modern-button bg-primary hover:bg-primary/90 border-primary text-primary-foreground",children:"Refresh Page"})]})}):this.props.children}}function kF(){const[e,t]=H.useState("Custodial"),[r,n]=H.useState(!1),[i,a]=H.useState(!1),[s,o]=H.useState(!1);JR();const{announce:l}=uF();fF(),yF();const{runQuickAudit:c}=xF(),{textSize:u,increaseTextSize:h,decreaseTextSize:m}=vF(),d=gF();H.useEffect(()=>{},[c]);const{notifications:g,removeNotification:p}=eO(),{notifications:x,removeNotification:v,showSuccess:b,showInfo:y}=pO();H.useEffect(()=>{e!=="Custodial"&&l(`Navigated to ${{"Custodial Inspection":"Single Area Inspection Form","Custodial Notes":"Custodial Concern Reporting Form","Inspection Data":"Inspection Data and Reports","Whole Building Inspection":"Whole Building Inspection Form","Rating Criteria":"Rating Criteria Reference Guide","admin-inspections":"Admin Inspections Panel","Monthly Feedback":"Monthly Feedback Reports","Scores Dashboard":"Building Scores Dashboard"}[e]||e}`)},[e,l]),H.useEffect(()=>{const T=()=>{document.querySelectorAll("form").forEach(A=>{A.noValidate=!0,A.querySelectorAll("input[pattern]").forEach(R=>{const C=R;C.setAttribute("data-pattern",C.getAttribute("pattern")||""),C.removeAttribute("pattern")}),A.addEventListener("invalid",R=>{R.preventDefault()},!0)})};T();const S=new MutationObserver(T);return S.observe(document.documentElement,{childList:!0,subtree:!0}),()=>S.disconnect()},[]),H.useEffect(()=>{const T=()=>{const R=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");a(R),R&&!bt.getItem("pwa-install-shown")&&(o(!0),bt.setItem("pwa-install-shown","true"),setTimeout(()=>o(!1),5e3),b("App Installed Successfully!","You can now access Custodial Command directly from your home screen.",{duration:5e3}))};T(),(()=>{const C=bt.getItem("app-version");if(C&&C!=="v6"){console.log("App version updated, clearing cache..."),"caches"in window&&caches.keys().then(W=>{W.forEach(fe=>{caches.delete(fe)})});const j=["app-version","pwa-install-shown"];bt.keys().filter(W=>!j.includes(W)).forEach(W=>bt.removeItem(W)),bt.setItem("app-version","v6"),y("App Updated","ðŸ”„ App updated! Reloading with latest version..."),setTimeout(()=>window.location.reload(),2e3);return}bt.setItem("app-version","v6")})();const E=()=>{a(!0),o(!0),bt.setItem("pwa-install-shown","true"),setTimeout(()=>o(!1),5e3),b("App Installed Successfully!","You can now access Custodial Command directly from your home screen.",{duration:5e3})};window.addEventListener("appinstalled",E);const A=window.matchMedia("(display-mode: standalone)");return A.addEventListener("change",T),()=>{window.removeEventListener("appinstalled",E),A.removeEventListener("change",T)}},[]);const w=[{name:"Home",path:"Custodial"}],k=()=>{try{switch(e){case"Custodial":return f.jsxs("div",{className:"p-8 text-center",children:[f.jsxs("div",{className:"mb-8 max-w-2xl mx-auto",children:[s&&f.jsxs("div",{className:"mb-4 p-4 bg-accent/20 border-2 border-accent/50 rounded-lg shadow-md",children:[f.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[f.jsx("span",{className:"text-2xl",children:"âœ…"}),f.jsx("span",{className:"text-lg font-bold text-accent-foreground",children:"App Successfully Installed!"})]}),f.jsx("p",{className:"text-center text-accent-foreground mt-2",children:"You can now access Custodial Command directly from your home screen."})]}),i?f.jsxs("div",{className:"mb-4 p-4 bg-accent/20 border-2 border-accent/50 rounded-lg shadow-md",children:[f.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[f.jsx("span",{className:"text-xl",children:"ðŸ“±"}),f.jsx("span",{className:"text-lg font-bold text-accent-foreground",children:"Running as Installed App"}),f.jsx("span",{className:"text-xl",children:"âœ…"})]}),f.jsx("p",{className:"text-center text-accent-foreground mt-1 text-sm",children:"App is installed and working offline-ready"})]}):f.jsxs("button",{onClick:()=>n(!r),className:"w-full p-4 bg-amber-100 border-2 border-amber-300 rounded-lg shadow-md hover:bg-amber-150 transition-colors flex items-center justify-between",children:[f.jsx("span",{className:"text-lg font-bold text-amber-900",children:"ðŸ“± Install on Your Mobile Device"}),f.jsx("span",{className:"text-amber-900 text-xl",children:r?"âˆ’":"+"})]}),!i&&r&&f.jsx("div",{className:"mt-4 p-6 bg-amber-50 border-2 border-amber-300 rounded-lg shadow-md",children:f.jsxs("div",{className:"text-amber-800 space-y-3",children:[f.jsxs("div",{className:"bg-white p-3 rounded border border-amber-200",children:[f.jsx("p",{className:"font-semibold text-amber-900 mb-1",children:"iPhone/iPad:"}),f.jsx("p",{className:"text-sm",children:"1. Tap the Share button (â–¡â†—) in Safari"}),f.jsx("p",{className:"text-sm",children:'2. Scroll down and tap "Add to Home Screen"'}),f.jsx("p",{className:"text-sm",children:'3. Tap "Add" to install the app'})]}),f.jsxs("div",{className:"bg-white p-3 rounded border border-amber-200",children:[f.jsx("p",{className:"font-semibold text-amber-900 mb-1",children:"Android:"}),f.jsx("p",{className:"text-sm",children:"1. Tap the menu (â‹®) in Chrome or your browser"}),f.jsx("p",{className:"text-sm",children:'2. Select "Add to Home screen" or "Install app"'}),f.jsx("p",{className:"text-sm",children:'3. Tap "Add" or "Install" to confirm'})]}),f.jsx("p",{className:"text-center text-sm font-medium text-amber-700 mt-3",children:"Once installed, access the app directly from your home screen like any other app!"}),f.jsx("div",{className:"mt-4 p-3 bg-accent/10 border border-accent/30 rounded",children:f.jsx("p",{className:"text-center text-sm font-medium text-accent-foreground",children:"âœ“ Works offline after installation - previously viewed pages remain accessible"})})]})})]}),f.jsxs("div",{className:"space-y-6 mb-6",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide px-2",children:"Submit Inspections"}),f.jsxs("div",{className:"responsive-grid",children:[f.jsx("button",{onClick:()=>t("Custodial Notes"),className:"modern-button bg-blue-600 hover:bg-blue-700 border-blue-600 text-white shadow-md hover:shadow-lg transition-shadow",children:f.jsx("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“ Report A Custodial Concern"})}),f.jsx("button",{onClick:()=>t("Custodial Inspection"),className:"modern-button bg-blue-600 hover:bg-blue-700 border-blue-600 text-white shadow-md hover:shadow-lg transition-shadow",children:f.jsx("span",{className:"flex items-center justify-center gap-2",children:"ðŸ” Single Area Inspection"})}),f.jsx("button",{onClick:()=>t("Whole Building Inspection"),className:"modern-button bg-blue-600 hover:bg-blue-700 border-blue-600 text-white shadow-md hover:shadow-lg transition-shadow",children:f.jsx("span",{className:"flex items-center justify-center gap-2",children:"ðŸ¢ Building Inspection"})})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide px-2",children:"View & Reports"}),f.jsxs("div",{className:"responsive-grid",children:[f.jsx("button",{onClick:()=>t("Scores Dashboard"),className:"modern-button bg-emerald-600 hover:bg-emerald-700 border-emerald-600 text-white shadow-md hover:shadow-lg transition-shadow",children:f.jsx("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“ˆ Building Scores Dashboard"})}),f.jsx("button",{onClick:()=>t("Inspection Data"),className:"modern-button bg-green-600 hover:bg-green-700 border-green-600 text-white shadow-md hover:shadow-lg transition-shadow",children:f.jsx("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“Š View Data & Reports"})}),f.jsx("button",{onClick:()=>t("Monthly Feedback"),className:"modern-button bg-purple-600 hover:bg-purple-700 border-purple-600 text-white shadow-md hover:shadow-lg transition-shadow",children:f.jsx("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“„ Monthly Feedback Reports"})}),f.jsx("button",{onClick:()=>t("Rating Criteria"),className:"modern-button bg-gray-600 hover:bg-gray-700 border-gray-600 text-white shadow-sm hover:shadow-md transition-shadow",children:f.jsx("span",{className:"flex items-center justify-center gap-2",children:"â„¹ï¸ Rating Criteria Guide"})})]})]})]}),f.jsx("p",{className:"text-lg text-muted-foreground text-center",children:"Cleanliness is a duty for all."})]});case"Custodial Inspection":return f.jsx(H.Suspense,{fallback:f.jsx(Ei,{}),children:f.jsx(wF,{onBack:()=>t("Custodial")})});case"Inspection Data":return f.jsx(H.Suspense,{fallback:f.jsx(Ei,{}),children:f.jsx(bF,{onBack:()=>t("Custodial")})});case"Custodial Notes":return f.jsx(H.Suspense,{fallback:f.jsx(Ei,{}),children:f.jsx(_F,{onBack:()=>t("Custodial")})});case"Whole Building Inspection":return f.jsx(H.Suspense,{fallback:f.jsx(Ei,{}),children:f.jsx(SF,{onBack:()=>t("Custodial")})});case"Rating Criteria":return f.jsx(H.Suspense,{fallback:f.jsx(Ei,{}),children:f.jsx(TF,{onBack:()=>t("Custodial")})});case"admin-inspections":return f.jsx(H.Suspense,{fallback:f.jsx(Ei,{}),children:f.jsx(EF,{onBack:()=>t("Custodial")})});case"Monthly Feedback":return f.jsx(H.Suspense,{fallback:f.jsx(Ei,{}),children:f.jsx(NF,{onBack:()=>t("Custodial")})});case"Scores Dashboard":return f.jsx(H.Suspense,{fallback:f.jsx(Ei,{}),children:f.jsx(AF,{onBack:()=>t("Custodial")})});default:return f.jsxs("div",{className:"p-8 text-center",children:[f.jsx("h1",{className:"text-2xl font-bold",children:"Page Not Found"}),f.jsx("button",{onClick:()=>t("Custodial"),className:"mt-4 modern-button bg-primary hover:bg-primary/90 border-primary text-primary-foreground",children:"Return Home"})]})}}catch(T){return console.error("Error rendering page:",T),f.jsxs("div",{className:"p-8 text-center",children:[f.jsx("h1",{className:"text-2xl font-bold text-red-600",children:"Error Loading Page"}),f.jsx("p",{className:"mt-2 text-gray-600",children:"Something went wrong. Please try again."}),f.jsx("button",{onClick:()=>t("Custodial"),className:"mt-4 modern-button bg-primary hover:bg-primary/90 border-primary text-primary-foreground",children:"Return Home"})]})}};return f.jsx(CF,{children:f.jsx(W3,{client:lF,children:f.jsx(rF,{children:f.jsxs("div",{className:"bg-background text-foreground min-h-screen pb-16 lg:pb-0","data-testid":"app-container",lang:"en",children:[f.jsxs("div",{className:"sr-only",role:"navigation","aria-label":"Skip links",children:[f.jsx(ff,{href:"#main-content",children:"Skip to main content"}),f.jsx(ff,{href:"#navigation",children:"Skip to navigation"}),f.jsx(ff,{href:"#footer",children:"Skip to footer"})]}),f.jsxs("div",{className:"main-container",children:[f.jsxs("header",{className:"w-full header-container rounded-xl shadow-sm",role:"banner",children:[f.jsx("h1",{className:"font-bold modern-header tracking-tight",id:"app-title",children:"CA Custodial Command"}),f.jsx("div",{className:"sr-only","aria-live":"polite",children:d&&"Screen reader mode detected"})]}),f.jsx("nav",{className:"w-full nav-container rounded-xl shadow-sm",role:"navigation","aria-labelledby":"app-title",id:"navigation",children:f.jsxs("div",{className:"button-container",role:"menubar",children:[w.map(T=>f.jsx("button",{onClick:()=>t(T.path),className:`modern-button ${e===T.path?"bg-primary/80":""}`,role:"menuitem","aria-current":e===T.path?"page":void 0,"aria-label":`${T.name} page${e===T.path?", current page":""}`,children:T.name},T.name)),f.jsx("button",{onClick:()=>t("admin-inspections"),className:"modern-button bg-red-600 hover:bg-red-700 border-red-600 text-white",role:"menuitem","aria-label":"Admin inspections panel","aria-current":e==="admin-inspections"?"page":void 0,children:"Admin"})]})}),f.jsx("div",{className:"w-full nav-container rounded-xl shadow-sm mb-4",role:"toolbar","aria-label":"Text size controls",children:f.jsxs("div",{className:"button-container",children:[f.jsxs("button",{onClick:m,className:"modern-button bg-secondary hover:bg-secondary/80","aria-label":"Decrease text size",disabled:u==="small",children:[f.jsx("span",{"aria-hidden":"true",children:"A-"}),f.jsx("span",{className:"sr-only",children:"Decrease text size"})]}),f.jsxs("span",{className:"text-sm text-muted-foreground px-2","aria-live":"polite","aria-label":`Current text size: ${u}`,children:["Text Size: ",u.charAt(0).toUpperCase()+u.slice(1)]}),f.jsxs("button",{onClick:h,className:"modern-button bg-secondary hover:bg-secondary/80","aria-label":"Increase text size",disabled:u==="large",children:[f.jsx("span",{"aria-hidden":"true",children:"A+"}),f.jsx("span",{className:"sr-only",children:"Increase text size"})]})]})}),f.jsx(dO,{className:"mb-4"}),f.jsx("main",{id:"main-content",className:"w-full content-area rounded-xl shadow-sm",role:"main","aria-label":"Main content",tabIndex:-1,children:k()})]}),f.jsxs("footer",{className:"w-full mt-6 text-center text-muted-foreground text-sm",role:"contentinfo",id:"footer",children:[f.jsx("p",{children:"Â© 2025 Shared Service Command. All rights reserved. For the People!"}),f.jsx("div",{className:"mt-2 text-xs",children:f.jsx("span",{"aria-label":"Accessibility information",children:"WCAG 2.2 AA Compliant | Screen reader friendly"})})]}),f.jsx(cF,{className:"lg:hidden"}),f.jsxs("div",{"aria-live":"polite","aria-label":"Application notifications",role:"region",children:[f.jsx(cO,{}),f.jsx(uO,{notifications:g,onRemove:p}),f.jsx(mO,{notifications:x,onRemove:v})]}),f.jsx("div",{className:"sr-only","aria-live":"assertive","aria-atomic":"true",id:"screen-reader-announcements"})]})})})})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("Service Worker registered successfully:",e.scope),setInterval(()=>{e.update()},300*1e3)}).catch(e=>{console.error("Service Worker registration failed:",e)})});const CE=document.getElementById("root");if(!CE)throw new Error("Could not find root element");const RF=G3.createRoot(CE);RF.render(f.jsx(kF,{}));const Hl={DRAFT_INSPECTION:"custodial-draft-inspection",DRAFT_BUILDING_INSPECTION:"custodial-draft-building-inspection",DRAFT_CUSTODIAL_NOTE:"custodial-draft-custodial-note",USER_PREFERENCES:"custodial-user-preferences",LEGACY_INSPECTION_DRAFTS:"custodial_inspection_drafts",LEGACY_BUILDING_DRAFTS:"building_form_drafts"},Na={MAX_DRAFT_SIZE:5*1024*1024,MAX_TOTAL_STORAGE:8*1024*1024,MAX_DRAFTS_PER_TYPE:10,IMAGE_QUALITY:.7,MAX_IMAGE_DIMENSIONS:{width:1200,height:1200}},Zm=()=>{let e=0;const t=bt.keys();for(const r of t){const n=bt.getItem(r);n&&(e+=n.length+r.length)}return e},OF=e=>new Promise((t,r)=>{const n=document.createElement("canvas"),i=n.getContext("2d"),a=new Image;a.onload=()=>{const{width:s,height:o}=Na.MAX_IMAGE_DIMENSIONS;let{width:l,height:c}=a;if(l>s||c>o){const h=Math.min(s/l,o/c);l*=h,c*=h}n.width=l,n.height=c,i==null||i.drawImage(a,0,0,l,c);const u=n.toDataURL("image/jpeg",Na.IMAGE_QUALITY);t(u)},a.onerror=r,a.src=URL.createObjectURL(e)}),OQ=(e,t)=>{try{const r={data:t,timestamp:Date.now()},n=JSON.stringify(r);if(n.length>Na.MAX_DRAFT_SIZE){console.warn(`Draft too large (${Math.round(n.length/1024)}KB). Skipping save.`);return}if(Zm()+n.length>Na.MAX_TOTAL_STORAGE&&(Jm(),Zm()+n.length>Na.MAX_TOTAL_STORAGE)){console.warn("Storage limit reached. Cannot save draft.");return}bt.setItem(e,n)}catch(r){if(console.error("Failed to save draft to localStorage:",r),r instanceof Error&&r.name==="QuotaExceededError"){Jm();try{bt.setItem(e,JSON.stringify({data:t,timestamp:Date.now()}))}catch(n){console.error("Failed to save draft even after cleanup:",n)}}}},FQ=e=>{try{const t=bt.getItem(e);if(!t)return null;const r=JSON.parse(t);return Date.now()-r.timestamp>10080*60*1e3?(bt.removeItem(e),null):r.data}catch(t){return console.error("Failed to load draft from localStorage:",t),null}},IQ=e=>{try{bt.removeItem(e)}catch(t){console.error("Failed to clear draft from localStorage:",t)}},Jm=()=>{try{const e=Date.now()-6048e5,t=[],r=bt.keys();for(const n of r)if(n.startsWith("custodial-"))try{const i=bt.getItem(n);if(i){const a=JSON.parse(i);a.timestamp&&a.timestamp<e&&t.push(n)}}catch(i){t.push(n)}t.forEach(n=>bt.removeItem(n)),console.log(`Cleaned up ${t.length} old drafts`)}catch(e){console.error("Failed to cleanup old drafts:",e)}},jQ=()=>{try{bt.getItem(Hl.LEGACY_INSPECTION_DRAFTS)&&(console.log("Migrating legacy inspection drafts..."),bt.removeItem(Hl.LEGACY_INSPECTION_DRAFTS)),bt.getItem(Hl.LEGACY_BUILDING_DRAFTS)&&(console.log("Migrating legacy building inspection drafts..."),bt.removeItem(Hl.LEGACY_BUILDING_DRAFTS)),Jm()}catch(e){console.error("Failed to migrate legacy drafts:",e)}},DQ=e=>lt(null,null,function*(){try{return e.size<500*1024?new Promise((t,r)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)}):yield OF(e)}catch(t){throw console.error("Failed to process image for storage:",t),t}}),PQ=()=>{const e=Zm(),t=bt.keys().filter(r=>r.startsWith("custodial-")).length;return{totalSizeKB:Math.round(e/1024),totalSizeMB:Math.round(e/(1024*1024)*100)/100,draftCount:t,limitMB:Math.round(Na.MAX_TOTAL_STORAGE/(1024*1024)),usagePercent:Math.round(e/Na.MAX_TOTAL_STORAGE*100)}};function MQ(r){return lt(this,arguments,function*(e,t={}){const{maxWidth:n=1920,maxHeight:i=1080,quality:a=.8,maxSizeKB:s=500}=t;return new Promise((o,l)=>{const c=document.createElement("canvas"),u=c.getContext("2d"),h=new Image;h.onload=()=>{let{width:m,height:d}=h;if(m>n||d>i){const x=Math.min(n/m,i/d);m=m*x,d=d*x}c.width=m,c.height=d,u==null||u.drawImage(h,0,0,m,d);let g=a;const p=()=>{c.toBlob(x=>{if(!x){l(new Error("Failed to compress image"));return}if(x.size/1024>s&&g>.1)g-=.1,p();else{const b=new File([x],e.name,{type:"image/jpeg",lastModified:Date.now()});o({compressedFile:b,originalSize:e.size,compressedSize:x.size,compressionRatio:(e.size-x.size)/e.size})}},"image/jpeg",g)};p()},h.onerror=()=>l(new Error("Failed to load image")),h.src=URL.createObjectURL(e)})})}function LQ(e,t=500){return e.size/1024>t}function BQ(e){if(e===0)return"0 Bytes";const t=1024,r=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,n)).toFixed(2))+" "+r[n]}const ms=H.forwardRef((i,n)=>{var a=i,{className:e,type:t}=a,r=we(a,["className","type"]);return f.jsx("input",q({type:t,className:Ee("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground","transition-all duration-200 ease-out","border-3 border-[hsl(var(--border))] bg-[hsl(var(--card))] text-[hsl(var(--card-foreground))]","focus:outline-none focus:ring-0 focus:border-[hsl(var(--primary))] focus:shadow-[0_0_0_4px_hsl(var(--primary)_/_0.2)] focus:bg-[hsl(var(--background))]","hover:border-[hsl(var(--primary)_/_0.8)] hover:shadow-[0_0_0_2px_hsl(var(--primary)_/_0.1)]","disabled:cursor-not-allowed disabled:opacity-50","transform-gpu will-change-auto",e),ref:n},r))});ms.displayName="Input";const FF=pu("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ye=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(_T,q({ref:r,className:Ee(FF(),e)},t))});Ye.displayName=_T.displayName;const mg=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx("textarea",q({className:Ee("flex min-h-[80px] w-full rounded-md bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground","transition-all duration-200 ease-out","border-3 border-[hsl(var(--border))] bg-[hsl(var(--card))] text-[hsl(var(--card-foreground))]","focus:outline-none focus:ring-0 focus:border-[hsl(var(--primary))] focus:shadow-[0_0_0_4px_hsl(var(--primary)_/_0.2)] focus:bg-[hsl(var(--background))]","hover:border-[hsl(var(--primary)_/_0.8)] hover:shadow-[0_0_0_2px_hsl(var(--primary)_/_0.1)]","disabled:cursor-not-allowed disabled:opacity-50","transform-gpu will-change-auto",e),ref:r},t))});mg.displayName="Textarea";const IF=["top","right","bottom","left"],Hi=Math.min,Ur=Math.max,Rc=Math.round,$l=Math.floor,Hn=e=>({x:e,y:e}),jF={left:"right",right:"left",bottom:"top",top:"bottom"},DF={start:"end",end:"start"};function ep(e,t,r){return Ur(e,Hi(t,r))}function di(e,t){return typeof e=="function"?e(t):e}function mi(e){return e.split("-")[0]}function Ls(e){return e.split("-")[1]}function pg(e){return e==="x"?"y":"x"}function gg(e){return e==="y"?"height":"width"}const PF=new Set(["top","bottom"]);function qn(e){return PF.has(mi(e))?"y":"x"}function xg(e){return pg(qn(e))}function MF(e,t,r){r===void 0&&(r=!1);const n=Ls(e),i=xg(e),a=gg(i);let s=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(s=Oc(s)),[s,Oc(s)]}function LF(e){const t=Oc(e);return[tp(e),t,tp(t)]}function tp(e){return e.replace(/start|end/g,t=>DF[t])}const j1=["left","right"],D1=["right","left"],BF=["top","bottom"],UF=["bottom","top"];function qF(e,t,r){switch(e){case"top":case"bottom":return r?t?D1:j1:t?j1:D1;case"left":case"right":return t?BF:UF;default:return[]}}function zF(e,t,r,n){const i=Ls(e);let a=qF(mi(e),r==="start",n);return i&&(a=a.map(s=>s+"-"+i),t&&(a=a.concat(a.map(tp)))),a}function Oc(e){return e.replace(/left|right|bottom|top/g,t=>jF[t])}function HF(e){return q({top:0,right:0,bottom:0,left:0},e)}function kE(e){return typeof e!="number"?HF(e):{top:e,right:e,bottom:e,left:e}}function Fc(e){const{x:t,y:r,width:n,height:i}=e;return{width:n,height:i,top:r,left:t,right:t+n,bottom:r+i,x:t,y:r}}function P1(e,t,r){let{reference:n,floating:i}=e;const a=qn(t),s=xg(t),o=gg(s),l=mi(t),c=a==="y",u=n.x+n.width/2-i.width/2,h=n.y+n.height/2-i.height/2,m=n[o]/2-i[o]/2;let d;switch(l){case"top":d={x:u,y:n.y-i.height};break;case"bottom":d={x:u,y:n.y+n.height};break;case"right":d={x:n.x+n.width,y:h};break;case"left":d={x:n.x-i.width,y:h};break;default:d={x:n.x,y:n.y}}switch(Ls(t)){case"start":d[s]-=m*(r&&c?-1:1);break;case"end":d[s]+=m*(r&&c?-1:1);break}return d}const $F=(e,t,r)=>lt(null,null,function*(){const{placement:n="bottom",strategy:i="absolute",middleware:a=[],platform:s}=r,o=a.filter(Boolean),l=yield s.isRTL==null?void 0:s.isRTL(t);let c=yield s.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:h}=P1(c,n,l),m=n,d={},g=0;for(let p=0;p<o.length;p++){const{name:x,fn:v}=o[p],{x:b,y,data:w,reset:k}=yield v({x:u,y:h,initialPlacement:n,placement:m,strategy:i,middlewareData:d,rects:c,platform:s,elements:{reference:e,floating:t}});u=b!=null?b:u,h=y!=null?y:h,d=ce(q({},d),{[x]:q(q({},d[x]),w)}),k&&g<=50&&(g++,typeof k=="object"&&(k.placement&&(m=k.placement),k.rects&&(c=k.rects===!0?yield s.getElementRects({reference:e,floating:t,strategy:i}):k.rects),{x:u,y:h}=P1(c,m,l)),p=-1)}return{x:u,y:h,placement:m,strategy:i,middlewareData:d}});function Ho(e,t){return lt(this,null,function*(){var r;t===void 0&&(t={});const{x:n,y:i,platform:a,rects:s,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:m=!1,padding:d=0}=di(t,e),g=kE(d),x=o[m?h==="floating"?"reference":"floating":h],v=Fc(yield a.getClippingRect({element:(r=yield a.isElement==null?void 0:a.isElement(x))==null||r?x:x.contextElement||(yield a.getDocumentElement==null?void 0:a.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),b=h==="floating"?{x:n,y:i,width:s.floating.width,height:s.floating.height}:s.reference,y=yield a.getOffsetParent==null?void 0:a.getOffsetParent(o.floating),w=(yield a.isElement==null?void 0:a.isElement(y))?(yield a.getScale==null?void 0:a.getScale(y))||{x:1,y:1}:{x:1,y:1},k=Fc(a.convertOffsetParentRelativeRectToViewportRelativeRect?yield a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:b,offsetParent:y,strategy:l}):b);return{top:(v.top-k.top+g.top)/w.y,bottom:(k.bottom-v.bottom+g.bottom)/w.y,left:(v.left-k.left+g.left)/w.x,right:(k.right-v.right+g.right)/w.x}})}const VF=e=>({name:"arrow",options:e,fn(r){return lt(this,null,function*(){const{x:n,y:i,placement:a,rects:s,platform:o,elements:l,middlewareData:c}=r,{element:u,padding:h=0}=di(e,r)||{};if(u==null)return{};const m=kE(h),d={x:n,y:i},g=xg(a),p=gg(g),x=yield o.getDimensions(u),v=g==="y",b=v?"top":"left",y=v?"bottom":"right",w=v?"clientHeight":"clientWidth",k=s.reference[p]+s.reference[g]-d[g]-s.floating[p],T=d[g]-s.reference[g],S=yield o.getOffsetParent==null?void 0:o.getOffsetParent(u);let E=S?S[w]:0;(!E||!(yield o.isElement==null?void 0:o.isElement(S)))&&(E=l.floating[w]||s.floating[p]);const A=k/2-T/2,R=E/2-x[p]/2-1,C=Hi(m[b],R),j=Hi(m[y],R),z=C,G=E-x[p]-j,W=E/2-x[p]/2+A,fe=ep(z,W,G),he=!c.arrow&&Ls(a)!=null&&W!==fe&&s.reference[p]/2-(W<z?C:j)-x[p]/2<0,ee=he?W<z?W-z:W-G:0;return{[g]:d[g]+ee,data:q({[g]:fe,centerOffset:W-fe-ee},he&&{alignmentOffset:ee}),reset:he}})}}),WF=function(e){return e===void 0&&(e={}),{name:"flip",options:e,fn(r){return lt(this,null,function*(){var n,i;const{placement:a,middlewareData:s,rects:o,initialPlacement:l,platform:c,elements:u}=r,W=di(e,r),{mainAxis:h=!0,crossAxis:m=!0,fallbackPlacements:d,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:x=!0}=W,v=we(W,["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"]);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const b=mi(a),y=qn(l),w=mi(l)===l,k=yield c.isRTL==null?void 0:c.isRTL(u.floating),T=d||(w||!x?[Oc(l)]:LF(l)),S=p!=="none";!d&&S&&T.push(...zF(l,x,p,k));const E=[l,...T],A=yield Ho(r,v),R=[];let C=((i=s.flip)==null?void 0:i.overflows)||[];if(h&&R.push(A[b]),m){const fe=MF(a,o,k);R.push(A[fe[0]],A[fe[1]])}if(C=[...C,{placement:a,overflows:R}],!R.every(fe=>fe<=0)){var j,z;const fe=(((j=s.flip)==null?void 0:j.index)||0)+1,he=E[fe];if(he&&(!(m==="alignment"?y!==qn(he):!1)||C.every(O=>qn(O.placement)===y?O.overflows[0]>0:!0)))return{data:{index:fe,overflows:C},reset:{placement:he}};let ee=(z=C.filter(re=>re.overflows[0]<=0).sort((re,O)=>re.overflows[1]-O.overflows[1])[0])==null?void 0:z.placement;if(!ee)switch(g){case"bestFit":{var G;const re=(G=C.filter(O=>{if(S){const ge=qn(O.placement);return ge===y||ge==="y"}return!0}).map(O=>[O.placement,O.overflows.filter(ge=>ge>0).reduce((ge,B)=>ge+B,0)]).sort((O,ge)=>O[1]-ge[1])[0])==null?void 0:G[0];re&&(ee=re);break}case"initialPlacement":ee=l;break}if(a!==ee)return{reset:{placement:ee}}}return{}})}}};function M1(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function L1(e){return IF.some(t=>e[t]>=0)}const GF=function(e){return e===void 0&&(e={}),{name:"hide",options:e,fn(r){return lt(this,null,function*(){const{rects:n}=r,s=di(e,r),{strategy:i="referenceHidden"}=s,a=we(s,["strategy"]);switch(i){case"referenceHidden":{const o=yield Ho(r,ce(q({},a),{elementContext:"reference"})),l=M1(o,n.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:L1(l)}}}case"escaped":{const o=yield Ho(r,ce(q({},a),{altBoundary:!0})),l=M1(o,n.floating);return{data:{escapedOffsets:l,escaped:L1(l)}}}default:return{}}})}}},RE=new Set(["left","top"]);function YF(e,t){return lt(this,null,function*(){const{placement:r,platform:n,elements:i}=e,a=yield n.isRTL==null?void 0:n.isRTL(i.floating),s=mi(r),o=Ls(r),l=qn(r)==="y",c=RE.has(s)?-1:1,u=a&&l?-1:1,h=di(t,e);let{mainAxis:m,crossAxis:d,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return o&&typeof g=="number"&&(d=o==="end"?g*-1:g),l?{x:d*u,y:m*c}:{x:m*c,y:d*u}})}const XF=function(e){return e===void 0&&(e=0),{name:"offset",options:e,fn(r){return lt(this,null,function*(){var n,i;const{x:a,y:s,placement:o,middlewareData:l}=r,c=yield YF(r,e);return o===((n=l.offset)==null?void 0:n.placement)&&(i=l.arrow)!=null&&i.alignmentOffset?{}:{x:a+c.x,y:s+c.y,data:ce(q({},c),{placement:o})}})}}},KF=function(e){return e===void 0&&(e={}),{name:"shift",options:e,fn(r){return lt(this,null,function*(){const{x:n,y:i,placement:a}=r,v=di(e,r),{mainAxis:s=!0,crossAxis:o=!1,limiter:l={fn:b=>{let{x:y,y:w}=b;return{x:y,y:w}}}}=v,c=we(v,["mainAxis","crossAxis","limiter"]),u={x:n,y:i},h=yield Ho(r,c),m=qn(mi(a)),d=pg(m);let g=u[d],p=u[m];if(s){const b=d==="y"?"top":"left",y=d==="y"?"bottom":"right",w=g+h[b],k=g-h[y];g=ep(w,g,k)}if(o){const b=m==="y"?"top":"left",y=m==="y"?"bottom":"right",w=p+h[b],k=p-h[y];p=ep(w,p,k)}const x=l.fn(ce(q({},r),{[d]:g,[m]:p}));return ce(q({},x),{data:{x:x.x-n,y:x.y-i,enabled:{[d]:s,[m]:o}}})})}}},QF=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:i,rects:a,middlewareData:s}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=di(e,t),u={x:r,y:n},h=qn(i),m=pg(h);let d=u[m],g=u[h];const p=di(o,t),x=typeof p=="number"?{mainAxis:p,crossAxis:0}:q({mainAxis:0,crossAxis:0},p);if(l){const y=m==="y"?"height":"width",w=a.reference[m]-a.floating[y]+x.mainAxis,k=a.reference[m]+a.reference[y]-x.mainAxis;d<w?d=w:d>k&&(d=k)}if(c){var v,b;const y=m==="y"?"width":"height",w=RE.has(mi(i)),k=a.reference[h]-a.floating[y]+(w&&((v=s.offset)==null?void 0:v[h])||0)+(w?0:x.crossAxis),T=a.reference[h]+a.reference[y]+(w?0:((b=s.offset)==null?void 0:b[h])||0)-(w?x.crossAxis:0);g<k?g=k:g>T&&(g=T)}return{[m]:d,[h]:g}}}},ZF=function(e){return e===void 0&&(e={}),{name:"size",options:e,fn(r){return lt(this,null,function*(){var n,i;const{placement:a,rects:s,platform:o,elements:l}=r,C=di(e,r),{apply:c=()=>{}}=C,u=we(C,["apply"]),h=yield Ho(r,u),m=mi(a),d=Ls(a),g=qn(a)==="y",{width:p,height:x}=s.floating;let v,b;m==="top"||m==="bottom"?(v=m,b=d===((yield o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(b=m,v=d==="end"?"top":"bottom");const y=x-h.top-h.bottom,w=p-h.left-h.right,k=Hi(x-h[v],y),T=Hi(p-h[b],w),S=!r.middlewareData.shift;let E=k,A=T;if((n=r.middlewareData.shift)!=null&&n.enabled.x&&(A=w),(i=r.middlewareData.shift)!=null&&i.enabled.y&&(E=y),S&&!d){const j=Ur(h.left,0),z=Ur(h.right,0),G=Ur(h.top,0),W=Ur(h.bottom,0);g?A=p-2*(j!==0||z!==0?j+z:Ur(h.left,h.right)):E=x-2*(G!==0||W!==0?G+W:Ur(h.top,h.bottom))}yield c(ce(q({},r),{availableWidth:A,availableHeight:E}));const R=yield o.getDimensions(l.floating);return p!==R.width||x!==R.height?{reset:{rects:!0}}:{}})}}};function vu(){return typeof window!="undefined"}function Bs(e){return OE(e)?(e.nodeName||"").toLowerCase():"#document"}function Wr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Xn(e){var t;return(t=(OE(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function OE(e){return vu()?e instanceof Node||e instanceof Wr(e).Node:!1}function An(e){return vu()?e instanceof Element||e instanceof Wr(e).Element:!1}function Vn(e){return vu()?e instanceof HTMLElement||e instanceof Wr(e).HTMLElement:!1}function B1(e){return!vu()||typeof ShadowRoot=="undefined"?!1:e instanceof ShadowRoot||e instanceof Wr(e).ShadowRoot}const JF=new Set(["inline","contents"]);function ml(e){const{overflow:t,overflowX:r,overflowY:n,display:i}=Cn(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!JF.has(i)}const eI=new Set(["table","td","th"]);function tI(e){return eI.has(Bs(e))}const rI=[":popover-open",":modal"];function yu(e){return rI.some(t=>{try{return e.matches(t)}catch(r){return!1}})}const nI=["transform","translate","scale","rotate","perspective"],iI=["transform","translate","scale","rotate","perspective","filter"],aI=["paint","layout","strict","content"];function vg(e){const t=yg(),r=An(e)?Cn(e):e;return nI.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||iI.some(n=>(r.willChange||"").includes(n))||aI.some(n=>(r.contain||"").includes(n))}function sI(e){let t=$i(e);for(;Vn(t)&&!js(t);){if(vg(t))return t;if(yu(t))return null;t=$i(t)}return null}function yg(){return typeof CSS=="undefined"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const oI=new Set(["html","body","#document"]);function js(e){return oI.has(Bs(e))}function Cn(e){return Wr(e).getComputedStyle(e)}function wu(e){return An(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function $i(e){if(Bs(e)==="html")return e;const t=e.assignedSlot||e.parentNode||B1(e)&&e.host||Xn(e);return B1(t)?t.host:t}function FE(e){const t=$i(e);return js(t)?e.ownerDocument?e.ownerDocument.body:e.body:Vn(t)&&ml(t)?t:FE(t)}function $o(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const i=FE(e),a=i===((n=e.ownerDocument)==null?void 0:n.body),s=Wr(i);if(a){const o=rp(s);return t.concat(s,s.visualViewport||[],ml(i)?i:[],o&&r?$o(o):[])}return t.concat(i,$o(i,[],r))}function rp(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function IE(e){const t=Cn(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const i=Vn(e),a=i?e.offsetWidth:r,s=i?e.offsetHeight:n,o=Rc(r)!==a||Rc(n)!==s;return o&&(r=a,n=s),{width:r,height:n,$:o}}function wg(e){return An(e)?e:e.contextElement}function ps(e){const t=wg(e);if(!Vn(t))return Hn(1);const r=t.getBoundingClientRect(),{width:n,height:i,$:a}=IE(t);let s=(a?Rc(r.width):r.width)/n,o=(a?Rc(r.height):r.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!o||!Number.isFinite(o))&&(o=1),{x:s,y:o}}const lI=Hn(0);function jE(e){const t=Wr(e);return!yg()||!t.visualViewport?lI:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function cI(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Wr(e)?!1:t}function Ia(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect(),a=wg(e);let s=Hn(1);t&&(n?An(n)&&(s=ps(n)):s=ps(e));const o=cI(a,r,n)?jE(a):Hn(0);let l=(i.left+o.x)/s.x,c=(i.top+o.y)/s.y,u=i.width/s.x,h=i.height/s.y;if(a){const m=Wr(a),d=n&&An(n)?Wr(n):n;let g=m,p=rp(g);for(;p&&n&&d!==g;){const x=ps(p),v=p.getBoundingClientRect(),b=Cn(p),y=v.left+(p.clientLeft+parseFloat(b.paddingLeft))*x.x,w=v.top+(p.clientTop+parseFloat(b.paddingTop))*x.y;l*=x.x,c*=x.y,u*=x.x,h*=x.y,l+=y,c+=w,g=Wr(p),p=rp(g)}}return Fc({width:u,height:h,x:l,y:c})}function bu(e,t){const r=wu(e).scrollLeft;return t?t.left+r:Ia(Xn(e)).left+r}function DE(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-bu(e,r),i=r.top+t.scrollTop;return{x:n,y:i}}function uI(e){let{elements:t,rect:r,offsetParent:n,strategy:i}=e;const a=i==="fixed",s=Xn(n),o=t?yu(t.floating):!1;if(n===s||o&&a)return r;let l={scrollLeft:0,scrollTop:0},c=Hn(1);const u=Hn(0),h=Vn(n);if((h||!h&&!a)&&((Bs(n)!=="body"||ml(s))&&(l=wu(n)),Vn(n))){const d=Ia(n);c=ps(n),u.x=d.x+n.clientLeft,u.y=d.y+n.clientTop}const m=s&&!h&&!a?DE(s,l):Hn(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+m.x,y:r.y*c.y-l.scrollTop*c.y+u.y+m.y}}function fI(e){return Array.from(e.getClientRects())}function hI(e){const t=Xn(e),r=wu(e),n=e.ownerDocument.body,i=Ur(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=Ur(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let s=-r.scrollLeft+bu(e);const o=-r.scrollTop;return Cn(n).direction==="rtl"&&(s+=Ur(t.clientWidth,n.clientWidth)-i),{width:i,height:a,x:s,y:o}}const U1=25;function dI(e,t){const r=Wr(e),n=Xn(e),i=r.visualViewport;let a=n.clientWidth,s=n.clientHeight,o=0,l=0;if(i){a=i.width,s=i.height;const u=yg();(!u||u&&t==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}const c=bu(n);if(c<=0){const u=n.ownerDocument,h=u.body,m=getComputedStyle(h),d=u.compatMode==="CSS1Compat"&&parseFloat(m.marginLeft)+parseFloat(m.marginRight)||0,g=Math.abs(n.clientWidth-h.clientWidth-d);g<=U1&&(a-=g)}else c<=U1&&(a+=c);return{width:a,height:s,x:o,y:l}}const mI=new Set(["absolute","fixed"]);function pI(e,t){const r=Ia(e,!0,t==="fixed"),n=r.top+e.clientTop,i=r.left+e.clientLeft,a=Vn(e)?ps(e):Hn(1),s=e.clientWidth*a.x,o=e.clientHeight*a.y,l=i*a.x,c=n*a.y;return{width:s,height:o,x:l,y:c}}function q1(e,t,r){let n;if(t==="viewport")n=dI(e,r);else if(t==="document")n=hI(Xn(e));else if(An(t))n=pI(t,r);else{const i=jE(e);n={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return Fc(n)}function PE(e,t){const r=$i(e);return r===t||!An(r)||js(r)?!1:Cn(r).position==="fixed"||PE(r,t)}function gI(e,t){const r=t.get(e);if(r)return r;let n=$o(e,[],!1).filter(o=>An(o)&&Bs(o)!=="body"),i=null;const a=Cn(e).position==="fixed";let s=a?$i(e):e;for(;An(s)&&!js(s);){const o=Cn(s),l=vg(s);!l&&o.position==="fixed"&&(i=null),(a?!l&&!i:!l&&o.position==="static"&&!!i&&mI.has(i.position)||ml(s)&&!l&&PE(e,s))?n=n.filter(u=>u!==s):i=o,s=$i(s)}return t.set(e,n),n}function xI(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e;const s=[...r==="clippingAncestors"?yu(t)?[]:gI(t,this._c):[].concat(r),n],o=s[0],l=s.reduce((c,u)=>{const h=q1(t,u,i);return c.top=Ur(h.top,c.top),c.right=Hi(h.right,c.right),c.bottom=Hi(h.bottom,c.bottom),c.left=Ur(h.left,c.left),c},q1(t,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function vI(e){const{width:t,height:r}=IE(e);return{width:t,height:r}}function yI(e,t,r){const n=Vn(t),i=Xn(t),a=r==="fixed",s=Ia(e,!0,a,t);let o={scrollLeft:0,scrollTop:0};const l=Hn(0);function c(){l.x=bu(i)}if(n||!n&&!a)if((Bs(t)!=="body"||ml(i))&&(o=wu(t)),n){const d=Ia(t,!0,a,t);l.x=d.x+t.clientLeft,l.y=d.y+t.clientTop}else i&&c();a&&!n&&i&&c();const u=i&&!n&&!a?DE(i,o):Hn(0),h=s.left+o.scrollLeft-l.x-u.x,m=s.top+o.scrollTop-l.y-u.y;return{x:h,y:m,width:s.width,height:s.height}}function hf(e){return Cn(e).position==="static"}function z1(e,t){if(!Vn(e)||Cn(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Xn(e)===r&&(r=r.ownerDocument.body),r}function ME(e,t){const r=Wr(e);if(yu(e))return r;if(!Vn(e)){let i=$i(e);for(;i&&!js(i);){if(An(i)&&!hf(i))return i;i=$i(i)}return r}let n=z1(e,t);for(;n&&tI(n)&&hf(n);)n=z1(n,t);return n&&js(n)&&hf(n)&&!vg(n)?r:n||sI(e)||r}const wI=function(e){return lt(this,null,function*(){const t=this.getOffsetParent||ME,r=this.getDimensions,n=yield r(e.floating);return{reference:yI(e.reference,yield t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}})};function bI(e){return Cn(e).direction==="rtl"}const _I={convertOffsetParentRelativeRectToViewportRelativeRect:uI,getDocumentElement:Xn,getClippingRect:xI,getOffsetParent:ME,getElementRects:wI,getClientRects:fI,getDimensions:vI,getScale:ps,isElement:An,isRTL:bI};function LE(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function SI(e,t){let r=null,n;const i=Xn(e);function a(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function s(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),a();const c=e.getBoundingClientRect(),{left:u,top:h,width:m,height:d}=c;if(o||t(),!m||!d)return;const g=$l(h),p=$l(i.clientWidth-(u+m)),x=$l(i.clientHeight-(h+d)),v=$l(u),y={rootMargin:-g+"px "+-p+"px "+-x+"px "+-v+"px",threshold:Ur(0,Hi(1,l))||1};let w=!0;function k(T){const S=T[0].intersectionRatio;if(S!==l){if(!w)return s();S?s(!1,S):n=setTimeout(()=>{s(!1,1e-7)},1e3)}S===1&&!LE(c,e.getBoundingClientRect())&&s(),w=!1}try{r=new IntersectionObserver(k,ce(q({},y),{root:i.ownerDocument}))}catch(T){r=new IntersectionObserver(k,y)}r.observe(e)}return s(!0),a}function UQ(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=wg(e),u=i||a?[...c?$o(c):[],...$o(t)]:[];u.forEach(v=>{i&&v.addEventListener("scroll",r,{passive:!0}),a&&v.addEventListener("resize",r)});const h=c&&o?SI(c,r):null;let m=-1,d=null;s&&(d=new ResizeObserver(v=>{let[b]=v;b&&b.target===c&&d&&(d.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var y;(y=d)==null||y.observe(t)})),r()}),c&&!l&&d.observe(c),d.observe(t));let g,p=l?Ia(e):null;l&&x();function x(){const v=Ia(e);p&&!LE(p,v)&&r(),p=v,g=requestAnimationFrame(x)}return r(),()=>{var v;u.forEach(b=>{i&&b.removeEventListener("scroll",r),a&&b.removeEventListener("resize",r)}),h==null||h(),(v=d)==null||v.disconnect(),d=null,l&&cancelAnimationFrame(g)}}const qQ=XF,zQ=KF,HQ=WF,$Q=ZF,VQ=GF,WQ=VF,GQ=QF,YQ=(e,t,r)=>{const n=new Map,i=q({platform:_I},r),a=ce(q({},i.platform),{_c:n});return $F(e,t,ce(q({},i),{platform:a}))};var TI=function(e){if(typeof document=="undefined")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},es=new WeakMap,Vl=new WeakMap,Wl={},df=0,BE=function(e){return e&&(e.host||BE(e.parentNode))},EI=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=BE(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},NI=function(e,t,r,n){var i=EI(t,Array.isArray(e)?e:[e]);Wl[r]||(Wl[r]=new WeakMap);var a=Wl[r],s=[],o=new Set,l=new Set(i),c=function(h){!h||o.has(h)||(o.add(h),c(h.parentNode))};i.forEach(c);var u=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(m){if(o.has(m))u(m);else try{var d=m.getAttribute(n),g=d!==null&&d!=="false",p=(es.get(m)||0)+1,x=(a.get(m)||0)+1;es.set(m,p),a.set(m,x),s.push(m),p===1&&g&&Vl.set(m,!0),x===1&&m.setAttribute(r,"true"),g||m.setAttribute(n,"true")}catch(v){console.error("aria-hidden: cannot operate on ",m,v)}})};return u(t),o.clear(),df++,function(){s.forEach(function(h){var m=es.get(h)-1,d=a.get(h)-1;es.set(h,m),a.set(h,d),m||(Vl.has(h)||h.removeAttribute(n),Vl.delete(h)),d||h.removeAttribute(r)}),df--,df||(es=new WeakMap,es=new WeakMap,Vl=new WeakMap,Wl={})}},XQ=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),i=TI(e);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live], script"))),NI(n,i,r,"aria-hidden")):function(){return null}},Ic=function(){return Ic=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Ic.apply(this,arguments)};function AI(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function KQ(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function mf(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function CI(e,t){var r=H.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=t,r.facade}var kI=typeof window!="undefined"?H.useLayoutEffect:H.useEffect,H1=new WeakMap;function QQ(e,t){var r=CI(null,function(n){return e.forEach(function(i){return mf(i,n)})});return kI(function(){var n=H1.get(r);if(n){var i=new Set(n),a=new Set(e),s=r.current;i.forEach(function(o){a.has(o)||mf(o,null)}),a.forEach(function(o){i.has(o)||mf(o,s)})}H1.set(r,e)},[e]),r}function RI(e){return e}function OI(e,t){t===void 0&&(t=RI);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(a){var s=t(a,n);return r.push(s),function(){r=r.filter(function(o){return o!==s})}},assignSyncMedium:function(a){for(n=!0;r.length;){var s=r;r=[],s.forEach(a)}r={push:function(o){return a(o)},filter:function(){return r}}},assignMedium:function(a){n=!0;var s=[];if(r.length){var o=r;r=[],o.forEach(a),s=r}var l=function(){var u=s;s=[],u.forEach(a)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),r}}}};return i}function ZQ(e){e===void 0&&(e={});var t=OI(null);return t.options=Ic({async:!0,ssr:!1},e),t}var UE=function(e){var t=e.sideCar,r=AI(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return H.createElement(n,Ic({},r))};UE.isSideCarExport=!0;function JQ(e,t){return e.useMedium(t),UE}var eZ=function(){if(typeof __webpack_nonce__!="undefined")return __webpack_nonce__};const Eo=Y3,No=X3,gs=H.forwardRef((i,n)=>{var a=i,{className:e,children:t}=a,r=we(a,["className","children"]);return f.jsxs(ST,ce(q({ref:n,className:Ee("flex h-10 w-full items-center justify-between rounded-md bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground","transition-all duration-200 ease-out","border-3 border-[hsl(var(--border))] bg-[hsl(var(--card))] text-[hsl(var(--card-foreground))]","focus:outline-none focus:ring-0 focus:border-[hsl(var(--primary))] focus:shadow-[0_0_0_4px_hsl(var(--primary)_/_0.2)] focus:bg-[hsl(var(--background))]","hover:border-[hsl(var(--primary)_/_0.8)] hover:shadow-[0_0_0_2px_hsl(var(--primary)_/_0.1)]","disabled:cursor-not-allowed disabled:opacity-50","transform-gpu will-change-auto","[&>span]:line-clamp-1",e)},r),{children:[t,f.jsx(K3,{asChild:!0,children:f.jsx(Ea,{className:"h-4 w-4 opacity-50"})})]}))});gs.displayName=ST.displayName;const qE=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(NT,ce(q({ref:r,className:Ee("flex cursor-default items-center justify-center py-1",e)},t),{children:f.jsx(AT,{className:"h-4 w-4"})}))});qE.displayName=NT.displayName;const zE=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(CT,ce(q({ref:r,className:Ee("flex cursor-default items-center justify-center py-1",e)},t),{children:f.jsx(Ea,{className:"h-4 w-4"})}))});zE.displayName=CT.displayName;const xs=H.forwardRef((a,i)=>{var s=a,{className:e,children:t,position:r="popper"}=s,n=we(s,["className","children","position"]);return f.jsx(Q3,{children:f.jsxs(TT,ce(q({ref:i,className:Ee("relative z-[9999] max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-white text-gray-900 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r},n),{children:[f.jsx(qE,{}),f.jsx(Z3,{className:Ee("p-1 bg-white",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),f.jsx(zE,{})]}))})});xs.displayName=TT.displayName;const FI=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(kT,q({ref:r,className:Ee("py-1.5 pl-8 pr-2 text-sm font-semibold",e)},t))});FI.displayName=kT.displayName;const Sn=H.forwardRef((i,n)=>{var a=i,{className:e,children:t}=a,r=we(a,["className","children"]);return f.jsxs(ET,ce(q({ref:n,className:Ee("relative flex w-full cursor-pointer select-none items-center rounded-sm py-2 pl-8 pr-4 text-sm bg-white text-gray-900 outline-none hover:bg-gray-100 focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e)},r),{children:[f.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:f.jsx(J3,{children:f.jsx(ig,{className:"h-4 w-4 text-blue-600"})})}),f.jsx(eR,{className:"truncate",children:t})]}))});Sn.displayName=ET.displayName;const II=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(RT,q({ref:r,className:Ee("-mx-1 my-1 h-px bg-muted",e)},t))});II.displayName=RT.displayName;const _u=OT,HE=tR,jI=FT,$E=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(sg,q({ref:r,className:Ee("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e)},t))});$E.displayName=sg.displayName;const pl=H.forwardRef((i,n)=>{var a=i,{className:e,children:t}=a,r=we(a,["className","children"]);return f.jsxs(jI,{children:[f.jsx($E,{}),f.jsxs(ag,ce(q({ref:n,className:Ee("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e)},r),{children:[t,f.jsxs(rR,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[f.jsx(qi,{className:"h-4 w-4"}),f.jsx("span",{className:"sr-only",children:"Close"})]})]}))]})});pl.displayName=ag.displayName;const gl=r=>{var n=r,{className:e}=n,t=we(n,["className"]);return f.jsx("div",q({className:Ee("flex flex-col space-y-1.5 text-center sm:text-left",e)},t))};gl.displayName="DialogHeader";const VE=r=>{var n=r,{className:e}=n,t=we(n,["className"]);return f.jsx("div",q({className:Ee("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e)},t))};VE.displayName="DialogFooter";const xl=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(IT,q({ref:r,className:Ee("text-lg font-semibold leading-none tracking-tight",e)},t))});xl.displayName=IT.displayName;const vl=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(jT,q({ref:r,className:Ee("text-sm text-muted-foreground",e)},t))});vl.displayName=jT.displayName;function Gl(...e){return e.filter(Boolean).join(" ")}function tZ({title:e,children:t,defaultCollapsed:r=!0,className:n,titleClassName:i,contentClassName:a,disabled:s=!1}){const[o,l]=H.useState(r),c=()=>{s||l(!o)};return f.jsxs("div",{className:Gl("border border-gray-200 rounded-lg overflow-hidden",n||""),children:[f.jsxs("button",{type:"button",onClick:c,disabled:s,className:Gl("w-full justify-between p-4 h-auto font-medium text-left hover:bg-gray-50 border-none rounded-none flex items-center bg-transparent cursor-pointer",s?"cursor-not-allowed opacity-50":"",i||""),children:[f.jsx("span",{className:"text-base",children:e}),o?f.jsx(du,{className:"w-5 h-5 transition-transform duration-200"}):f.jsx(Ea,{className:"w-5 h-5 transition-transform duration-200"})]}),f.jsx("div",{className:Gl("transition-all duration-300 ease-in-out overflow-hidden",o?"max-h-0":"max-h-[2000px]"),children:f.jsx("div",{className:Gl("p-4 pt-0",a||""),children:t})})]})}const DI=H.forwardRef((r,t)=>{var e=we(r,[]);return f.jsx("nav",q({ref:t,"aria-label":"breadcrumb"},e))});DI.displayName="Breadcrumb";const PI=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx("ol",q({ref:r,className:Ee("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",e)},t))});PI.displayName="BreadcrumbList";const MI=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx("li",q({ref:r,className:Ee("inline-flex items-center gap-1.5",e)},t))});MI.displayName="BreadcrumbItem";const LI=H.forwardRef((i,n)=>{var a=i,{asChild:e,className:t}=a,r=we(a,["asChild","className"]);const s=e?vT:"a";return f.jsx(s,q({ref:n,className:Ee("transition-colors hover:text-foreground",t)},r))});LI.displayName="BreadcrumbLink";const BI=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx("span",q({ref:r,role:"link","aria-disabled":"true","aria-current":"page",className:Ee("font-normal text-foreground",e)},t))});BI.displayName="BreadcrumbPage";const UI=n=>{var i=n,{children:e,className:t}=i,r=we(i,["children","className"]);return f.jsx("li",ce(q({role:"presentation","aria-hidden":"true",className:Ee("[&>svg]:w-3.5 [&>svg]:h-3.5",t)},r),{children:e!=null?e:f.jsx(du,{})}))};UI.displayName="BreadcrumbSeparator";const $1=[{stars:1,label:"Unkempt Neglect",description:"Crisis"},{stars:2,label:"Moderate Dinginess",description:"Reactive"},{stars:3,label:"Casual Inattention",description:"Managed Care"},{stars:4,label:"Ordinary Tidiness",description:"Comprehensive Care"},{stars:5,label:"Orderly Spotlessness",description:"Showpiece Facility"}],qI=[{key:"floors",label:"Floors",criteria:{5:"Floors and base moldings shine and/or are bright and clean; colors are fresh. No dirt buildup in corners or along walls.",4:"Floors and base moldings shine and/or are bright and clean. There is no buildup in corners along walls, but there can be up to two days' worth of dust, dirt, stains, or streaks.",3:"Floors are swept or vacuumed clean, but upon close observation there can be stains. A buildup of dirt and/or floor finish in corners and along walls can be seen. There are dull spots and/or matted carpet in walking lanes. Base molding is dull and dingy with streaks or splashes.",2:"Floors are swept or vacuumed clean, but are dull, dingy, and stained. There is an obvious buildup of dirt and/or floor finish in corners and along walls. There is a dull path and/or obviously matted carpet in the walking lanes. Base molding is dull and dingy with streaks or splashes.",1:"Floors and carpet are dull, dirty, dingy, scuffed, and/or matted. There is a conspicuous buildup of old dirt and/or floor finish in corners and along walls. Base molding is dirty, stained, and streaked. Gum, stains, dirt, dust balls, and trash are broadcast."}},{key:"verticalHorizontalSurfaces",label:"Vertical and Horizontal Surfaces",criteria:{5:"All vertical and horizontal surfaces have a freshly cleaned or polished appearance and have no accumulation of dust, dirt, marks, streaks, smudges, or fingerprints. Windows, glass, sills, frames, and related surfaces are free of dust, smudges, fingerprints etc.",4:"All vertical and horizontal surfaces are clean, but marks, dust, smudges, and fingerprints are noticeable upon close observation. Windows appear clean, but on close inspection marks, dust, cobwebs may be found. Sills and frames may have visible dust, dirt, or cobwebs on them.",3:"All vertical and horizontal surfaces have obvious dust, dirt, marks, smudges, and fingerprints. Windows frames are dusty and dirty, window glass is acceptable but it is obvious they have not been cleaned.",2:"All vertical and horizontal surfaces have conspicuous dust, dirt, smudges, fingerprints, and marks. At a quick glance windows are visibly dirty.",1:"All vertical and horizontal surfaces have major accumulations of dust, dirt, smudges, and fingerprints, all of which will be difficult to remove. Lack of attention is obvious. Window glass has obvious smudges, dirt, and marks. Frames are visibly dirty, dusty, and cobwebs are appearing."}},{key:"ceiling",label:"Ceiling",criteria:{5:"Ceilings and air vents are clean and free of dust/debris including cobwebs. No deficiencies.",4:"Ceilings and air vents are clean but dust/debris/cobwebs are noticeable upon close inspection.",3:"Ceilings and air vents have obvious dust/debris/cobwebs.",2:"Ceilings and air vents have conspicuous dust/debris/cobwebs.",1:"Ceilings and air vents have major accumulation of dust/debris/cobwebs."}},{key:"restrooms",label:"Restrooms",criteria:{5:"Consistent Monitoring: Restrooms must be regularly checked for use and cleanliness. Stocked and Maintained: Supplies (soap, paper products, etc.) must be fully stocked at all times. Spotless and Polished: Surfaces must be free of dirt, smudges, and water stains, with polished fixtures and mirrors. Graffiti-Free: No graffiti or defacement is present. Pleasant Odor: Restrooms must have a fresh, pleasant scent with no unpleasant odors.",4:"Routine Monitoring: Restrooms are checked regularly but may have minor lapses between inspections. Adequately Stocked: Supplies are generally available, though occasional low stock may occur. Clean but Lived-In: Surfaces are mostly clean, but minor smudges, water spots, or streaks may be present. Graffiti-Free: No significant graffiti, though faint markings or minor blemishes may be visible. Neutral Odor: The restroom has no strong odorsâ€”neither noticeably fresh nor unpleasant.",3:"Infrequent Monitoring: Restrooms are checked sporadically, leading to noticeable gaps in maintenance. Partially Stocked: Supplies are inconsistentâ€”some items may be low or temporarily unavailable. Visible Wear: Surfaces show clear signs of use, including smudges, water spots, and minor grime. Minor Graffiti: Small or faint graffiti, scratches, or markings are present but not overwhelming. Slight Odor: A faint but noticeable stale or musty odor may be present, though not overpowering.",2:"Inconsistent Monitoring: Restrooms are rarely checked, leading to noticeable lapses in cleanliness and maintenance. Low Stock: Many supplies are missing, and those that remain are often running low. Dirty Surfaces: Surfaces show significant grime, stains, and streaks. Cleaning is overdue, and the overall appearance is visibly unkempt. Graffiti and Damage: Obvious graffiti, markings, or damage is present in several areas. Unpleasant Odor: A strong, unpleasant odor may be present, creating a noticeable discomfort for users.",1:"Rare or No Monitoring: Restrooms are infrequently checked or completely overlooked, leading to prolonged periods of neglect. No Stock: Essential supplies are completely absent or inadequate, with no immediate plans to restock. Filthy Surfaces: Surfaces are visibly dirty, with heavy stains, grime, and possibly mold or mildew. The overall environment is unsanitary. Extensive Graffiti and Damage: Graffiti, damage, or vandalism is widespread and has not been addressed. Strong, Offensive Odor: The restroom emits a strong, unpleasant odor, often foul, making the space uncomfortable and potentially unsanitary."}},{key:"customerSatisfaction",label:"Customer Satisfaction and Coordination",criteria:{5:"Proud of facilities, have a high level of trust for the custodial organization.",4:"Satisfied with custodial-related services, usually complimentary of custodial staff.",3:"Accustomed to basic level of custodial care. Generally able to perform mission duties. Lack of pride in physical environment.",2:"Generally critical of cost, responsiveness, and quality of custodial services.",1:"Consistent customer ridicule, mistrust of custodial services."}},{key:"trash",label:"Trash",criteria:{5:"Interior trash cans only hold daily waste, and are clean and free from odor. Dumpster area is free from litter, dumpsters are closed and if applicable after hours locked. Exterior grounds are free from litter, and exterior trash cans are well placed and maintained.",4:"Most interior trash cans only hold daily waste, and are largely clean and free from odor. Dumpster area is free from litter, dumpsters are closed and if applicable after hours locked. Exterior grounds have some litter but appear to be regularly tended to. Exterior trash cans are present, maintenance is frequency of emptying is unclear but acceptable.",3:"Interior trash is regularly cleared, some cans are ill maintained and have odor. Litter is present near dumpsters. Some litter is blowing around exterior and does not appear to be addressed on a regular basis.",2:"Trash containers smell, are stained and are frequently at capacity with old trash. Litter is present at dumpster area, dumpsters are poorly secured and contributing to exterior litter issues. Exterior litter is present and obvious.",1:"Trash containers smell, are stained and are overflowing with old trash. Dumpster areas are overflowing, litter is present near dumpsters and does not appear regularly cleaned. Exterior litter is present, and affecting the overall appearance of school."}},{key:"projectCleaning",label:"Project Cleaning",criteria:{5:"Break work scope is completed on time and regarded well by school based staff. Items are organized, prioritized, and presented by custodial team. Work exceeds expectations.",4:"Break work scope is mostly completed, however not on time and some work is shifted throughout year. Custodial team organizes most items. Work meets expectations.",3:"Priority break work items are completed, some are pushed to a later date. Items have been organized, prioritized, and presented by school and network. Most of the work meets expectations.",2:"Break work items must be requested and organized by school or network. Some items are not able to be completed. Completed work does not meet expectations.",1:"There are insufficient funds and staffing for project cleaning."}},{key:"activitySupport",label:"Activity Support",criteria:{5:"Activity (athletics, events, afterschool activities) support happens, and is planned along with the weekly routine. All comments are complimentary. Activity support compliments and does not impede regular work.",4:"Activity support happens, and is planned along with the weekly routine. Most comments are complimentary.",3:"Activity support happens, and is planned along with the weekly routine. Work at times do not meet customer expectations. Comments are generally complimentary. Activity support is at the expense of some other duties.",2:"Activity support happens, but staffing is not allocated. Support is done by redirecting staff away from normal custodial duties on a routine basis.",1:"Activity support happens ad hoc and often leads to duties not being completed."}},{key:"safetyCompliance",label:"Safety and Compliance",criteria:{5:"All chemicals are properly labeled, secured, and used in accordance with manufacturer instructions. Gas, propane, and highly combustible items are stored off site. Closets are organized and compliant with DHH regulations.",4:"Most chemicals are properly labeled, secured, and used in accordance with manufacturer instructions. Gas, propane, and highly combustible items are stored off site. Some disorganization and lack of tidiness in closets.",3:"Some chemicals are properly labeled, secured. Proper use of chemicals is not clear, visible misuse of chemicals such as buildup or material damage is present. Gas, propane, and highly combustible items are usually stored off site, though often after use left on campus. Closets are dirty, though organizational and safety systems appear to be present.",2:"Many chemicals not labeled. Proper use of chemicals is not clear, visible misuse of chemicals such as buildup or material damage is present. Gas, propane, and highly combustible items can be found on site. Closets are dirty, no apparent regular organization or safety assessment.",1:"Improper use and knowledge of chemicals is widespread. Closets are consistently disorganized, dirty, and lacking safety precautions. Combustible materials prohibited may be present. It is unclear if there are any organizational or safety systems in place."}},{key:"equipment",label:"Equipment",criteria:{5:"There is sufficient equipment, located within reasonable proximity to the responsible areas. Equipment is kept in good repair and is replaced as needed. Equipment is evaluated and optimized for the tasks at hand. Equipment is being used in facility with regularity.",4:"There is sufficient equipment, located within reasonable proximity to the responsible areas. Equipment is kept in good repair and is replaced as needed. Equipment is evaluated and optimized for the tasks at hand.",3:"There is sufficient equipment, located within reasonable proximity to the responsible areas. Equipment is replaced as needed, but may not be the optimal equipment for the tasks at hand.",2:"Equipment is frequently shared and transported and occasionally in disrepair, but there is a basic inventory of equipment on hand.",1:"There is no or minimal capital investment for custodial operations. Equipment is limited and in disrepair. Staff do not use available equipment and or not trained on operation."}},{key:"monitoring",label:"Monitoring",criteria:{5:"Real-Time Monitoring: A system is in place to track performance and cleanliness frequently, with some elements monitored in real time. Contract Alignment: Performance standards are fully aligned with the specifications outlined in the contract. Responsive Feedback: Feedback from schools is actively sought, quickly addressed, and incorporated into service improvements.",4:"Regular Monitoring: A system is in place to track performance and cleanliness at scheduled intervals, though not in real time. Contract Compliance: Performance generally aligns with contractual standards, with only occasional minor deviations. Feedback Incorporated: Feedback from schools is generally addressed in a timely manner and used to improve services.",3:"Periodic Monitoring: Performance is monitored intermittently, leading to some inconsistencies in cleanliness and efficiency. Partial Contract Compliance: Standards are mostly followed, but occasional oversights or delays occur. Reactive Feedback Response: Feedback from schools is addressed, but often with some delay.",2:"Infrequent Monitoring: Performance is rarely tracked, leading to noticeable inconsistencies. Contract Deviations: Several standards outlined in the contract are not being consistently met. Delayed Feedback Response: Feedback from schools is often ignored or addressed with significant delay.",1:"No Monitoring: Performance is rarely or never tracked, resulting in significant inefficiencies. Contract Non-Compliance: Most contractual standards are not being met. Disregarded Feedback: Feedback from schools is ignored or dismissed."}}];function rZ({message:e="Loading..."}){return f.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",role:"status","aria-live":"polite","aria-label":e,children:f.jsxs("div",{className:"bg-card p-6 rounded-lg shadow-xl max-w-sm w-full mx-4",children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-primary border-t-transparent rounded-full","aria-hidden":"true"})}),f.jsx("p",{className:"text-center text-foreground font-medium text-lg",children:e}),f.jsx("span",{className:"sr-only",children:e})]})})}const nZ=nE({school:Lr().min(1,"School is required").max(100,"School name too long"),date:Lr().min(1,"Date is required").refine(e=>!isNaN(Date.parse(e)),"Invalid date format"),inspectionType:bo("single_room").default("single_room"),locationDescription:Lr().min(3,"Please describe the location (minimum 3 characters)").max(500,"Location description too long"),roomNumber:Lr().max(50,"Room number too long").optional().or(bo("")),locationCategory:Lr().max(100,"Location category too long").optional().or(bo("")),floors:dn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),verticalHorizontalSurfaces:dn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),ceiling:dn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),restrooms:dn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),customerSatisfaction:dn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),trash:dn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),projectCleaning:dn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),activitySupport:dn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),safetyCompliance:dn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),equipment:dn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),monitoring:dn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),notes:Lr().max(5e3,"Notes too long").optional().or(bo("")),images:iE(Lr()).max(5,"Maximum 5 images allowed").default([])}),iZ={school:"",date:"",inspectionType:"single_room",locationDescription:"",roomNumber:"",locationCategory:"",floors:0,verticalHorizontalSurfaces:0,ceiling:0,restrooms:0,customerSatisfaction:0,trash:0,projectCleaning:0,activitySupport:0,safetyCompliance:0,equipment:0,monitoring:0,notes:"",images:[]},aZ=nE({inspectorName:Lr().min(1,"Inspector name is required").max(100,"Inspector name too long"),school:Lr().min(1,"School is required").max(100,"School name too long"),date:Lr().min(1,"Date is required").refine(e=>!isNaN(Date.parse(e)),"Invalid date format"),location:Lr().min(1,"Location is required").max(200,"Location too long"),locationDescription:Lr().max(500,"Location description too long").optional().or(bo("")),notes:Lr().min(10,"Please provide a detailed description (minimum 10 characters)").max(5e3,"Notes too long"),images:iE(UR(File)).max(5,"Maximum 5 images allowed").optional().default([])}),sZ={inspectorName:"",school:"",date:new Date().toISOString().split("T")[0],location:"",locationDescription:"",notes:"",images:[]};function oZ({status:e,lastSaved:t,errorMessage:r,className:n=""}){const[i,a]=H.useState("");H.useEffect(()=>{if(!t){a("");return}const c=()=>{const m=new Date().getTime()-t.getTime(),d=Math.floor(m/1e3),g=Math.floor(d/60);d<10?a("just now"):d<60?a(`${d}s ago`):g<60?a(`${g}m ago`):a(t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))};c();const u=setInterval(c,1e4);return()=>clearInterval(u)},[t]);const o=(()=>{switch(e){case"saving":return{icon:DT,text:"Saving...",bgColor:"bg-blue-100 border-blue-300",textColor:"text-blue-800",iconColor:"text-blue-600",animate:!0};case"saved":return{icon:ig,text:i?`Saved ${i}`:"Saved",bgColor:"bg-green-100 border-green-300",textColor:"text-green-800",iconColor:"text-green-600",animate:!1};case"error":return{icon:_r,text:r||"Save failed",bgColor:"bg-red-100 border-red-300",textColor:"text-red-800",iconColor:"text-red-600",animate:!1};default:return{icon:rg,text:"Not saved",bgColor:"bg-gray-100 border-gray-300",textColor:"text-gray-700",iconColor:"text-gray-500",animate:!1}}})(),l=o.icon;return f.jsxs("div",{className:`fixed bottom-4 right-4 z-50 flex items-center gap-2 px-4 py-2 rounded-lg border-2 shadow-lg transition-all duration-200 ${o.bgColor} ${n}`,role:"status","aria-live":"polite",children:[f.jsx(l,{className:`h-4 w-4 ${o.iconColor} ${o.animate?"animate-pulse":""}`}),f.jsx("span",{className:`text-sm font-medium ${o.textColor}`,children:o.text})]})}const WE=H.forwardRef((a,i)=>{var s=a,{className:e,orientation:t="horizontal",decorative:r=!0}=s,n=we(s,["className","orientation","decorative"]);return f.jsx(PT,q({ref:i,decorative:r,orientation:t,className:Ee("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e)},n))});WE.displayName=PT.displayName;const zI=nR,GE=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(MT,q({ref:r,className:Ee("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e)},t))});GE.displayName=MT.displayName;const np=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(LT,q({ref:r,className:Ee("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e)},t))});np.displayName=LT.displayName;const ip=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(BT,q({ref:r,className:Ee("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e)},t))});ip.displayName=BT.displayName;function lZ(r){var n=r,{className:e}=n,t=we(n,["className"]);return f.jsx("div",q({className:Ee("animate-pulse rounded-md bg-muted",e)},t))}var pf,V1;function Or(){if(V1)return pf;V1=1;var e=Array.isArray;return pf=e,pf}var gf,W1;function YE(){if(W1)return gf;W1=1;var e=typeof _o=="object"&&_o&&_o.Object===Object&&_o;return gf=e,gf}var xf,G1;function Kn(){if(G1)return xf;G1=1;var e=YE(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return xf=r,xf}var vf,Y1;function yl(){if(Y1)return vf;Y1=1;var e=Kn(),t=e.Symbol;return vf=t,vf}var yf,X1;function HI(){if(X1)return yf;X1=1;var e=yl(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,i=e?e.toStringTag:void 0;function a(s){var o=r.call(s,i),l=s[i];try{s[i]=void 0;var c=!0}catch(h){}var u=n.call(s);return c&&(o?s[i]=l:delete s[i]),u}return yf=a,yf}var wf,K1;function $I(){if(K1)return wf;K1=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return wf=r,wf}var bf,Q1;function bi(){if(Q1)return bf;Q1=1;var e=yl(),t=HI(),r=$I(),n="[object Null]",i="[object Undefined]",a=e?e.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?t(o):r(o)}return bf=s,bf}var _f,Z1;function _i(){if(Z1)return _f;Z1=1;function e(t){return t!=null&&typeof t=="object"}return _f=e,_f}var Sf,J1;function Us(){if(J1)return Sf;J1=1;var e=bi(),t=_i(),r="[object Symbol]";function n(i){return typeof i=="symbol"||t(i)&&e(i)==r}return Sf=n,Sf}var Tf,ev;function bg(){if(ev)return Tf;ev=1;var e=Or(),t=Us(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(e(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||t(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return Tf=i,Tf}var Ef,tv;function ea(){if(tv)return Ef;tv=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Ef=e,Ef}var Nf,rv;function _g(){if(rv)return Nf;rv=1;var e=bi(),t=ea(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!t(o))return!1;var l=e(o);return l==n||l==i||l==r||l==a}return Nf=s,Nf}var Af,nv;function VI(){if(nv)return Af;nv=1;var e=Kn(),t=e["__core-js_shared__"];return Af=t,Af}var Cf,iv;function WI(){if(iv)return Cf;iv=1;var e=VI(),t=(function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!t&&t in n}return Cf=r,Cf}var kf,av;function XE(){if(av)return kf;av=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch(i){}try{return n+""}catch(i){}}return""}return kf=r,kf}var Rf,sv;function GI(){if(sv)return Rf;sv=1;var e=_g(),t=WI(),r=ea(),n=XE(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,l=s.toString,c=o.hasOwnProperty,u=RegExp("^"+l.call(c).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(m){if(!r(m)||t(m))return!1;var d=e(m)?u:a;return d.test(n(m))}return Rf=h,Rf}var Of,ov;function YI(){if(ov)return Of;ov=1;function e(t,r){return t==null?void 0:t[r]}return Of=e,Of}var Ff,lv;function qa(){if(lv)return Ff;lv=1;var e=GI(),t=YI();function r(n,i){var a=t(n,i);return e(a)?a:void 0}return Ff=r,Ff}var If,cv;function Su(){if(cv)return If;cv=1;var e=qa(),t=e(Object,"create");return If=t,If}var jf,uv;function XI(){if(uv)return jf;uv=1;var e=Su();function t(){this.__data__=e?e(null):{},this.size=0}return jf=t,jf}var Df,fv;function KI(){if(fv)return Df;fv=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Df=e,Df}var Pf,hv;function QI(){if(hv)return Pf;hv=1;var e=Su(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(e){var o=s[a];return o===t?void 0:o}return n.call(s,a)?s[a]:void 0}return Pf=i,Pf}var Mf,dv;function ZI(){if(dv)return Mf;dv=1;var e=Su(),t=Object.prototype,r=t.hasOwnProperty;function n(i){var a=this.__data__;return e?a[i]!==void 0:r.call(a,i)}return Mf=n,Mf}var Lf,mv;function JI(){if(mv)return Lf;mv=1;var e=Su(),t="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=e&&i===void 0?t:i,this}return Lf=r,Lf}var Bf,pv;function ej(){if(pv)return Bf;pv=1;var e=XI(),t=KI(),r=QI(),n=ZI(),i=JI();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,Bf=a,Bf}var Uf,gv;function tj(){if(gv)return Uf;gv=1;function e(){this.__data__=[],this.size=0}return Uf=e,Uf}var qf,xv;function Sg(){if(xv)return qf;xv=1;function e(t,r){return t===r||t!==t&&r!==r}return qf=e,qf}var zf,vv;function Tu(){if(vv)return zf;vv=1;var e=Sg();function t(r,n){for(var i=r.length;i--;)if(e(r[i][0],n))return i;return-1}return zf=t,zf}var Hf,yv;function rj(){if(yv)return Hf;yv=1;var e=Tu(),t=Array.prototype,r=t.splice;function n(i){var a=this.__data__,s=e(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():r.call(a,s,1),--this.size,!0}return Hf=n,Hf}var $f,wv;function nj(){if(wv)return $f;wv=1;var e=Tu();function t(r){var n=this.__data__,i=e(n,r);return i<0?void 0:n[i][1]}return $f=t,$f}var Vf,bv;function ij(){if(bv)return Vf;bv=1;var e=Tu();function t(r){return e(this.__data__,r)>-1}return Vf=t,Vf}var Wf,_v;function aj(){if(_v)return Wf;_v=1;var e=Tu();function t(r,n){var i=this.__data__,a=e(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return Wf=t,Wf}var Gf,Sv;function Eu(){if(Sv)return Gf;Sv=1;var e=tj(),t=rj(),r=nj(),n=ij(),i=aj();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,Gf=a,Gf}var Yf,Tv;function Tg(){if(Tv)return Yf;Tv=1;var e=qa(),t=Kn(),r=e(t,"Map");return Yf=r,Yf}var Xf,Ev;function sj(){if(Ev)return Xf;Ev=1;var e=ej(),t=Eu(),r=Tg();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return Xf=n,Xf}var Kf,Nv;function oj(){if(Nv)return Kf;Nv=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Kf=e,Kf}var Qf,Av;function Nu(){if(Av)return Qf;Av=1;var e=oj();function t(r,n){var i=r.__data__;return e(n)?i[typeof n=="string"?"string":"hash"]:i.map}return Qf=t,Qf}var Zf,Cv;function lj(){if(Cv)return Zf;Cv=1;var e=Nu();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return Zf=t,Zf}var Jf,kv;function cj(){if(kv)return Jf;kv=1;var e=Nu();function t(r){return e(this,r).get(r)}return Jf=t,Jf}var eh,Rv;function uj(){if(Rv)return eh;Rv=1;var e=Nu();function t(r){return e(this,r).has(r)}return eh=t,eh}var th,Ov;function fj(){if(Ov)return th;Ov=1;var e=Nu();function t(r,n){var i=e(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return th=t,th}var rh,Fv;function Eg(){if(Fv)return rh;Fv=1;var e=sj(),t=lj(),r=cj(),n=uj(),i=fj();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,rh=a,rh}var nh,Iv;function KE(){if(Iv)return nh;Iv=1;var e=Eg(),t="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],l=a.cache;if(l.has(o))return l.get(o);var c=n.apply(this,s);return a.cache=l.set(o,c)||l,c};return a.cache=new(r.Cache||e),a}return r.Cache=e,nh=r,nh}var ih,jv;function hj(){if(jv)return ih;jv=1;var e=KE(),t=500;function r(n){var i=e(n,function(s){return a.size===t&&a.clear(),s}),a=i.cache;return i}return ih=r,ih}var ah,Dv;function dj(){if(Dv)return ah;Dv=1;var e=hj(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(t,function(s,o,l,c){a.push(l?c.replace(r,"$1"):o||s)}),a});return ah=n,ah}var sh,Pv;function Ng(){if(Pv)return sh;Pv=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,a=Array(i);++n<i;)a[n]=r(t[n],n,t);return a}return sh=e,sh}var oh,Mv;function mj(){if(Mv)return oh;Mv=1;var e=yl(),t=Ng(),r=Or(),n=Us(),i=e?e.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return t(o,s)+"";if(n(o))return a?a.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return oh=s,oh}var lh,Lv;function QE(){if(Lv)return lh;Lv=1;var e=mj();function t(r){return r==null?"":e(r)}return lh=t,lh}var ch,Bv;function ZE(){if(Bv)return ch;Bv=1;var e=Or(),t=bg(),r=dj(),n=QE();function i(a,s){return e(a)?a:t(a,s)?[a]:r(n(a))}return ch=i,ch}var uh,Uv;function Au(){if(Uv)return uh;Uv=1;var e=Us();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return uh=t,uh}var fh,qv;function Ag(){if(qv)return fh;qv=1;var e=ZE(),t=Au();function r(n,i){i=e(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[t(i[a++])];return a&&a==s?n:void 0}return fh=r,fh}var hh,zv;function JE(){if(zv)return hh;zv=1;var e=Ag();function t(r,n,i){var a=r==null?void 0:e(r,n);return a===void 0?i:a}return hh=t,hh}var pj=JE();const cZ=Xe(pj);var dh,Hv;function gj(){if(Hv)return dh;Hv=1;function e(t){return t==null}return dh=e,dh}var xj=gj();const uZ=Xe(xj);var mh,$v;function vj(){if($v)return mh;$v=1;var e=bi(),t=Or(),r=_i(),n="[object String]";function i(a){return typeof a=="string"||!t(a)&&r(a)&&e(a)==n}return mh=i,mh}var yj=vj();const fZ=Xe(yj);var wj=_g();const hZ=Xe(wj);var bj=ea();const dZ=Xe(bj);var ph,Vv;function eN(){if(Vv)return ph;Vv=1;var e=bi(),t=_i(),r="[object Number]";function n(i){return typeof i=="number"||t(i)&&e(i)==r}return ph=n,ph}var gh,Wv;function _j(){if(Wv)return gh;Wv=1;var e=eN();function t(r){return e(r)&&r!=+r}return gh=t,gh}var Sj=_j();const mZ=Xe(Sj);var Tj=eN();const pZ=Xe(Tj);var xh,Gv;function Ej(){if(Gv)return xh;Gv=1;function e(t,r,n){var i=-1,a=t.length;r<0&&(r=-r>a?0:a+r),n=n>a?a:n,n<0&&(n+=a),a=r>n?0:n-r>>>0,r>>>=0;for(var s=Array(a);++i<a;)s[i]=t[i+r];return s}return xh=e,xh}var vh,Yv;function Nj(){if(Yv)return vh;Yv=1;var e=Ej();function t(r,n,i){var a=r.length;return i=i===void 0?a:i,!n&&i>=a?r:e(r,n,i)}return vh=t,vh}var yh,Xv;function tN(){if(Xv)return yh;Xv=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,a="\\ufe0e\\ufe0f",s="\\u200d",o=RegExp("["+s+e+i+a+"]");function l(c){return o.test(c)}return yh=l,yh}var wh,Kv;function Aj(){if(Kv)return wh;Kv=1;function e(t){return t.split("")}return wh=e,wh}var bh,Qv;function Cj(){if(Qv)return bh;Qv=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,a="\\ufe0e\\ufe0f",s="["+e+"]",o="["+i+"]",l="\\ud83c[\\udffb-\\udfff]",c="(?:"+o+"|"+l+")",u="[^"+e+"]",h="(?:\\ud83c[\\udde6-\\uddff]){2}",m="[\\ud800-\\udbff][\\udc00-\\udfff]",d="\\u200d",g=c+"?",p="["+a+"]?",x="(?:"+d+"(?:"+[u,h,m].join("|")+")"+p+g+")*",v=p+g+x,b="(?:"+[u+o+"?",o,h,m,s].join("|")+")",y=RegExp(l+"(?="+l+")|"+b+v,"g");function w(k){return k.match(y)||[]}return bh=w,bh}var _h,Zv;function kj(){if(Zv)return _h;Zv=1;var e=Aj(),t=tN(),r=Cj();function n(i){return t(i)?r(i):e(i)}return _h=n,_h}var Sh,Jv;function Rj(){if(Jv)return Sh;Jv=1;var e=Nj(),t=tN(),r=kj(),n=QE();function i(a){return function(s){s=n(s);var o=t(s)?r(s):void 0,l=o?o[0]:s.charAt(0),c=o?e(o,1).join(""):s.slice(1);return l[a]()+c}}return Sh=i,Sh}var Th,ey;function Oj(){if(ey)return Th;ey=1;var e=Rj(),t=e("toUpperCase");return Th=t,Th}var Fj=Oj();const gZ=Xe(Fj);function pt(e){return function(){return e}}const rN=Math.cos,jc=Math.sin,Rn=Math.sqrt,Dc=Math.PI,Cu=2*Dc,ap=Math.PI,sp=2*ap,da=1e-6,Ij=sp-da;function nN(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function jj(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return nN;const r=Ul(10,t);return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class Dj{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?nN:jj(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,a,s){this._append`C${+t},${+r},${+n},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(t,r,n,i,a){if(t=+t,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,l=n-t,c=i-r,u=s-t,h=o-r,m=u*u+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(m>da)if(!(Math.abs(h*l-c*u)>da)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let d=n-s,g=i-o,p=l*l+c*c,x=d*d+g*g,v=Math.sqrt(p),b=Math.sqrt(m),y=a*Math.tan((ap-Math.acos((p+m-x)/(2*v*b)))/2),w=y/b,k=y/v;Math.abs(w-1)>da&&this._append`L${t+w*u},${r+w*h}`,this._append`A${a},${a},0,0,${+(h*d>u*g)},${this._x1=t+k*l},${this._y1=r+k*c}`}}arc(t,r,n,i,a,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),l=n*Math.sin(i),c=t+o,u=r+l,h=1^s,m=s?i-a:a-i;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>da||Math.abs(this._y1-u)>da)&&this._append`L${c},${u}`,n&&(m<0&&(m=m%sp+sp),m>Ij?this._append`A${n},${n},0,1,${h},${t-o},${r-l}A${n},${n},0,1,${h},${this._x1=c},${this._y1=u}`:m>da&&this._append`A${n},${n},0,${+(m>=ap)},${h},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function Cg(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Dj(t)}function kg(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function iN(e){this._context=e}iN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function aN(e){return new iN(e)}function sN(e){return e[0]}function oN(e){return e[1]}function Pj(e,t){var r=pt(!0),n=null,i=aN,a=null,s=Cg(o);e=typeof e=="function"?e:e===void 0?sN:pt(e),t=typeof t=="function"?t:t===void 0?oN:pt(t);function o(l){var c,u=(l=kg(l)).length,h,m=!1,d;for(n==null&&(a=i(d=s())),c=0;c<=u;++c)!(c<u&&r(h=l[c],c,l))===m&&((m=!m)?a.lineStart():a.lineEnd()),m&&a.point(+e(h,c,l),+t(h,c,l));if(d)return a=null,d+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:pt(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:pt(+l),o):t},o.defined=function(l){return arguments.length?(r=typeof l=="function"?l:pt(!!l),o):r},o.curve=function(l){return arguments.length?(i=l,n!=null&&(a=i(n)),o):i},o.context=function(l){return arguments.length?(l==null?n=a=null:a=i(n=l),o):n},o}function xZ(e,t,r){var n=null,i=pt(!0),a=null,s=aN,o=null,l=Cg(c);e=typeof e=="function"?e:e===void 0?sN:pt(+e),t=typeof t=="function"?t:pt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?oN:pt(+r);function c(h){var m,d,g,p=(h=kg(h)).length,x,v=!1,b,y=new Array(p),w=new Array(p);for(a==null&&(o=s(b=l())),m=0;m<=p;++m){if(!(m<p&&i(x=h[m],m,h))===v)if(v=!v)d=m,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),g=m-1;g>=d;--g)o.point(y[g],w[g]);o.lineEnd(),o.areaEnd()}v&&(y[m]=+e(x,m,h),w[m]=+t(x,m,h),o.point(n?+n(x,m,h):y[m],r?+r(x,m,h):w[m]))}if(b)return o=null,b+""||null}function u(){return Pj().defined(i).curve(s).context(a)}return c.x=function(h){return arguments.length?(e=typeof h=="function"?h:pt(+h),n=null,c):e},c.x0=function(h){return arguments.length?(e=typeof h=="function"?h:pt(+h),c):e},c.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:pt(+h),c):n},c.y=function(h){return arguments.length?(t=typeof h=="function"?h:pt(+h),r=null,c):t},c.y0=function(h){return arguments.length?(t=typeof h=="function"?h:pt(+h),c):t},c.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:pt(+h),c):r},c.lineX0=c.lineY0=function(){return u().x(e).y(t)},c.lineY1=function(){return u().x(e).y(r)},c.lineX1=function(){return u().x(n).y(t)},c.defined=function(h){return arguments.length?(i=typeof h=="function"?h:pt(!!h),c):i},c.curve=function(h){return arguments.length?(s=h,a!=null&&(o=s(a)),c):s},c.context=function(h){return arguments.length?(h==null?a=o=null:o=s(a=h),c):a},c}class lN{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function vZ(e){return new lN(e,!0)}function yZ(e){return new lN(e,!1)}const Mj={draw(e,t){const r=Rn(t/Dc);e.moveTo(r,0),e.arc(0,0,r,0,Cu)}},wZ={draw(e,t){const r=Rn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},cN=Rn(1/3),Lj=cN*2,bZ={draw(e,t){const r=Rn(t/Lj),n=r*cN;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},_Z={draw(e,t){const r=Rn(t),n=-r/2;e.rect(n,n,r,r)}},Bj=.8908130915292852,uN=jc(Dc/10)/jc(7*Dc/10),Uj=jc(Cu/10)*uN,qj=-rN(Cu/10)*uN,SZ={draw(e,t){const r=Rn(t*Bj),n=Uj*r,i=qj*r;e.moveTo(0,-r),e.lineTo(n,i);for(let a=1;a<5;++a){const s=Cu*a/5,o=rN(s),l=jc(s);e.lineTo(l*r,-o*r),e.lineTo(o*n-l*i,l*n+o*i)}e.closePath()}},Eh=Rn(3),TZ={draw(e,t){const r=-Rn(t/(Eh*3));e.moveTo(0,r*2),e.lineTo(-Eh*r,-r),e.lineTo(Eh*r,-r),e.closePath()}},Qr=-.5,Zr=Rn(3)/2,op=1/Rn(12),zj=(op/2+1)*3,EZ={draw(e,t){const r=Rn(t/zj),n=r/2,i=r*op,a=n,s=r*op+r,o=-a,l=s;e.moveTo(n,i),e.lineTo(a,s),e.lineTo(o,l),e.lineTo(Qr*n-Zr*i,Zr*n+Qr*i),e.lineTo(Qr*a-Zr*s,Zr*a+Qr*s),e.lineTo(Qr*o-Zr*l,Zr*o+Qr*l),e.lineTo(Qr*n+Zr*i,Qr*i-Zr*n),e.lineTo(Qr*a+Zr*s,Qr*s-Zr*a),e.lineTo(Qr*o+Zr*l,Qr*l-Zr*o),e.closePath()}};function NZ(e,t){let r=null,n=Cg(i);e=typeof e=="function"?e:pt(e||Mj),t=typeof t=="function"?t:pt(t===void 0?64:+t);function i(){let a;if(r||(r=a=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(e=typeof a=="function"?a:pt(a),i):e},i.size=function(a){return arguments.length?(t=typeof a=="function"?a:pt(+a),i):t},i.context=function(a){return arguments.length?(r=a==null?null:a,i):r},i}function Pc(){}function Mc(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function fN(e){this._context=e}fN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Mc(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Mc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function AZ(e){return new fN(e)}function hN(e){this._context=e}hN.prototype={areaStart:Pc,areaEnd:Pc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Mc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function CZ(e){return new hN(e)}function dN(e){this._context=e}dN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Mc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kZ(e){return new dN(e)}function mN(e){this._context=e}mN.prototype={areaStart:Pc,areaEnd:Pc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function RZ(e){return new mN(e)}function ty(e){return e<0?-1:1}function ry(e,t,r){var n=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(n||i<0&&-0),s=(r-e._y1)/(i||n<0&&-0),o=(a*i+s*n)/(n+i);return(ty(a)+ty(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(o))||0}function ny(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Nh(e,t,r){var n=e._x0,i=e._y0,a=e._x1,s=e._y1,o=(a-n)/3;e._context.bezierCurveTo(n+o,i+o*t,a-o,s-o*r,a,s)}function Lc(e){this._context=e}Lc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Nh(this,this._t0,ny(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Nh(this,ny(this,r=ry(this,e,t)),r);break;default:Nh(this,this._t0,r=ry(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function pN(e){this._context=new gN(e)}(pN.prototype=Object.create(Lc.prototype)).point=function(e,t){Lc.prototype.point.call(this,t,e)};function gN(e){this._context=e}gN.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,a){this._context.bezierCurveTo(t,e,n,r,a,i)}};function OZ(e){return new Lc(e)}function FZ(e){return new pN(e)}function xN(e){this._context=e}xN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=iy(e),i=iy(t),a=0,s=1;s<r;++a,++s)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function iy(e){var t,r=e.length-1,n,i=new Array(r),a=new Array(r),s=new Array(r);for(i[0]=0,a[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,s[t]-=n*s[t-1];for(i[r-1]=s[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(s[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function IZ(e){return new xN(e)}function ku(e,t){this._context=e,this._t=t}ku.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function jZ(e){return new ku(e,.5)}function DZ(e){return new ku(e,0)}function PZ(e){return new ku(e,1)}function Vo(e,t){if((s=e.length)>1)for(var r=1,n,i,a=e[t[0]],s,o=a.length;r<s;++r)for(i=a,a=e[t[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function ay(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Hj(e,t){return e[t]}function $j(e){const t=[];return t.key=e,t}function MZ(){var e=pt([]),t=ay,r=Vo,n=Hj;function i(a){var s=Array.from(e.apply(this,arguments),$j),o,l=s.length,c=-1,u;for(const h of a)for(o=0,++c;o<l;++o)(s[o][c]=[0,+n(h,s[o].key,c,a)]).data=h;for(o=0,u=kg(t(s));o<l;++o)s[u[o]].index=o;return r(s,u),s}return i.keys=function(a){return arguments.length?(e=typeof a=="function"?a:pt(Array.from(a)),i):e},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:pt(+a),i):n},i.order=function(a){return arguments.length?(t=a==null?ay:typeof a=="function"?a:pt(Array.from(a)),i):t},i.offset=function(a){return arguments.length?(r=a==null?Vo:a,i):r},i}function LZ(e,t){if((n=e.length)>0){for(var r,n,i=0,a=e[0].length,s;i<a;++i){for(s=r=0;r<n;++r)s+=e[r][i][1]||0;if(s)for(r=0;r<n;++r)e[r][i][1]/=s}Vo(e,t)}}function BZ(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,a=n.length;r<a;++r){for(var s=0,o=0;s<i;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Vo(e,t)}}function UZ(e,t){if(!(!((s=e.length)>0)||!((a=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,a,s;n<a;++n){for(var o=0,l=0,c=0;o<s;++o){for(var u=e[t[o]],h=u[n][1]||0,m=u[n-1][1]||0,d=(h-m)/2,g=0;g<o;++g){var p=e[t[g]],x=p[n][1]||0,v=p[n-1][1]||0;d+=x-v}l+=h,c+=d*h}i[n-1][1]+=i[n-1][0]=r,l&&(r-=c/l)}i[n-1][1]+=i[n-1][0]=r,Vo(e,t)}}var Ah,sy;function Vj(){if(sy)return Ah;sy=1;var e=Eu();function t(){this.__data__=new e,this.size=0}return Ah=t,Ah}var Ch,oy;function Wj(){if(oy)return Ch;oy=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return Ch=e,Ch}var kh,ly;function Gj(){if(ly)return kh;ly=1;function e(t){return this.__data__.get(t)}return kh=e,kh}var Rh,cy;function Yj(){if(cy)return Rh;cy=1;function e(t){return this.__data__.has(t)}return Rh=e,Rh}var Oh,uy;function Xj(){if(uy)return Oh;uy=1;var e=Eu(),t=Tg(),r=Eg(),n=200;function i(a,s){var o=this.__data__;if(o instanceof e){var l=o.__data__;if(!t||l.length<n-1)return l.push([a,s]),this.size=++o.size,this;o=this.__data__=new r(l)}return o.set(a,s),this.size=o.size,this}return Oh=i,Oh}var Fh,fy;function vN(){if(fy)return Fh;fy=1;var e=Eu(),t=Vj(),r=Wj(),n=Gj(),i=Yj(),a=Xj();function s(o){var l=this.__data__=new e(o);this.size=l.size}return s.prototype.clear=t,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,Fh=s,Fh}var Ih,hy;function Kj(){if(hy)return Ih;hy=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return Ih=t,Ih}var jh,dy;function Qj(){if(dy)return jh;dy=1;function e(t){return this.__data__.has(t)}return jh=e,jh}var Dh,my;function yN(){if(my)return Dh;my=1;var e=Eg(),t=Kj(),r=Qj();function n(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new e;++a<s;)this.add(i[a])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,Dh=n,Dh}var Ph,py;function wN(){if(py)return Ph;py=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(t[n],n,t))return!0;return!1}return Ph=e,Ph}var Mh,gy;function bN(){if(gy)return Mh;gy=1;function e(t,r){return t.has(r)}return Mh=e,Mh}var Lh,xy;function _N(){if(xy)return Lh;xy=1;var e=yN(),t=wN(),r=bN(),n=1,i=2;function a(s,o,l,c,u,h){var m=l&n,d=s.length,g=o.length;if(d!=g&&!(m&&g>d))return!1;var p=h.get(s),x=h.get(o);if(p&&x)return p==o&&x==s;var v=-1,b=!0,y=l&i?new e:void 0;for(h.set(s,o),h.set(o,s);++v<d;){var w=s[v],k=o[v];if(c)var T=m?c(k,w,v,o,s,h):c(w,k,v,s,o,h);if(T!==void 0){if(T)continue;b=!1;break}if(y){if(!t(o,function(S,E){if(!r(y,E)&&(w===S||u(w,S,l,c,h)))return y.push(E)})){b=!1;break}}else if(!(w===k||u(w,k,l,c,h))){b=!1;break}}return h.delete(s),h.delete(o),b}return Lh=a,Lh}var Bh,vy;function Zj(){if(vy)return Bh;vy=1;var e=Kn(),t=e.Uint8Array;return Bh=t,Bh}var Uh,yy;function Jj(){if(yy)return Uh;yy=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i,a){n[++r]=[a,i]}),n}return Uh=e,Uh}var qh,wy;function Rg(){if(wy)return qh;wy=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i){n[++r]=i}),n}return qh=e,qh}var zh,by;function eD(){if(by)return zh;by=1;var e=yl(),t=Zj(),r=Sg(),n=_N(),i=Jj(),a=Rg(),s=1,o=2,l="[object Boolean]",c="[object Date]",u="[object Error]",h="[object Map]",m="[object Number]",d="[object RegExp]",g="[object Set]",p="[object String]",x="[object Symbol]",v="[object ArrayBuffer]",b="[object DataView]",y=e?e.prototype:void 0,w=y?y.valueOf:void 0;function k(T,S,E,A,R,C,j){switch(E){case b:if(T.byteLength!=S.byteLength||T.byteOffset!=S.byteOffset)return!1;T=T.buffer,S=S.buffer;case v:return!(T.byteLength!=S.byteLength||!C(new t(T),new t(S)));case l:case c:case m:return r(+T,+S);case u:return T.name==S.name&&T.message==S.message;case d:case p:return T==S+"";case h:var z=i;case g:var G=A&s;if(z||(z=a),T.size!=S.size&&!G)return!1;var W=j.get(T);if(W)return W==S;A|=o,j.set(T,S);var fe=n(z(T),z(S),A,R,C,j);return j.delete(T),fe;case x:if(w)return w.call(T)==w.call(S)}return!1}return zh=k,zh}var Hh,_y;function SN(){if(_y)return Hh;_y=1;function e(t,r){for(var n=-1,i=r.length,a=t.length;++n<i;)t[a+n]=r[n];return t}return Hh=e,Hh}var $h,Sy;function tD(){if(Sy)return $h;Sy=1;var e=SN(),t=Or();function r(n,i,a){var s=i(n);return t(n)?s:e(s,a(n))}return $h=r,$h}var Vh,Ty;function rD(){if(Ty)return Vh;Ty=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,a=0,s=[];++n<i;){var o=t[n];r(o,n,t)&&(s[a++]=o)}return s}return Vh=e,Vh}var Wh,Ey;function nD(){if(Ey)return Wh;Ey=1;function e(){return[]}return Wh=e,Wh}var Gh,Ny;function iD(){if(Ny)return Gh;Ny=1;var e=rD(),t=nD(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),e(i(s),function(o){return n.call(s,o)}))}:t;return Gh=a,Gh}var Yh,Ay;function aD(){if(Ay)return Yh;Ay=1;function e(t,r){for(var n=-1,i=Array(t);++n<t;)i[n]=r(n);return i}return Yh=e,Yh}var Xh,Cy;function sD(){if(Cy)return Xh;Cy=1;var e=bi(),t=_i(),r="[object Arguments]";function n(i){return t(i)&&e(i)==r}return Xh=n,Xh}var Kh,ky;function Og(){if(ky)return Kh;ky=1;var e=sD(),t=_i(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,a=e((function(){return arguments})())?e:function(s){return t(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return Kh=a,Kh}var Yl={exports:{}},Qh,Ry;function oD(){if(Ry)return Qh;Ry=1;function e(){return!1}return Qh=e,Qh}var Oy;function TN(){return Oy||(Oy=1,(function(e,t){var r=Kn(),n=oD(),i=t&&!t.nodeType&&t,a=i&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===i,o=s?r.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||n;e.exports=c})(Yl,Yl.exports)),Yl.exports}var Zh,Fy;function Fg(){if(Fy)return Zh;Fy=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i==null?e:i,!!i&&(a=="number"||a!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}return Zh=r,Zh}var Jh,Iy;function Ig(){if(Iy)return Jh;Iy=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return Jh=t,Jh}var e0,jy;function lD(){if(jy)return e0;jy=1;var e=bi(),t=Ig(),r=_i(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",l="[object Function]",c="[object Map]",u="[object Number]",h="[object Object]",m="[object RegExp]",d="[object Set]",g="[object String]",p="[object WeakMap]",x="[object ArrayBuffer]",v="[object DataView]",b="[object Float32Array]",y="[object Float64Array]",w="[object Int8Array]",k="[object Int16Array]",T="[object Int32Array]",S="[object Uint8Array]",E="[object Uint8ClampedArray]",A="[object Uint16Array]",R="[object Uint32Array]",C={};C[b]=C[y]=C[w]=C[k]=C[T]=C[S]=C[E]=C[A]=C[R]=!0,C[n]=C[i]=C[x]=C[a]=C[v]=C[s]=C[o]=C[l]=C[c]=C[u]=C[h]=C[m]=C[d]=C[g]=C[p]=!1;function j(z){return r(z)&&t(z.length)&&!!C[e(z)]}return e0=j,e0}var t0,Dy;function EN(){if(Dy)return t0;Dy=1;function e(t){return function(r){return t(r)}}return t0=e,t0}var Xl={exports:{}},Py;function cD(){return Py||(Py=1,(function(e,t){var r=YE(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===n,s=a&&r.process,o=(function(){try{var l=i&&i.require&&i.require("util").types;return l||s&&s.binding&&s.binding("util")}catch(c){}})();e.exports=o})(Xl,Xl.exports)),Xl.exports}var r0,My;function NN(){if(My)return r0;My=1;var e=lD(),t=EN(),r=cD(),n=r&&r.isTypedArray,i=n?t(n):e;return r0=i,r0}var n0,Ly;function uD(){if(Ly)return n0;Ly=1;var e=aD(),t=Og(),r=Or(),n=TN(),i=Fg(),a=NN(),s=Object.prototype,o=s.hasOwnProperty;function l(c,u){var h=r(c),m=!h&&t(c),d=!h&&!m&&n(c),g=!h&&!m&&!d&&a(c),p=h||m||d||g,x=p?e(c.length,String):[],v=x.length;for(var b in c)(u||o.call(c,b))&&!(p&&(b=="length"||d&&(b=="offset"||b=="parent")||g&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||i(b,v)))&&x.push(b);return x}return n0=l,n0}var i0,By;function fD(){if(By)return i0;By=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||e;return r===i}return i0=t,i0}var a0,Uy;function AN(){if(Uy)return a0;Uy=1;function e(t,r){return function(n){return t(r(n))}}return a0=e,a0}var s0,qy;function hD(){if(qy)return s0;qy=1;var e=AN(),t=e(Object.keys,Object);return s0=t,s0}var o0,zy;function dD(){if(zy)return o0;zy=1;var e=fD(),t=hD(),r=Object.prototype,n=r.hasOwnProperty;function i(a){if(!e(a))return t(a);var s=[];for(var o in Object(a))n.call(a,o)&&o!="constructor"&&s.push(o);return s}return o0=i,o0}var l0,Hy;function wl(){if(Hy)return l0;Hy=1;var e=_g(),t=Ig();function r(n){return n!=null&&t(n.length)&&!e(n)}return l0=r,l0}var c0,$y;function Ru(){if($y)return c0;$y=1;var e=uD(),t=dD(),r=wl();function n(i){return r(i)?e(i):t(i)}return c0=n,c0}var u0,Vy;function mD(){if(Vy)return u0;Vy=1;var e=tD(),t=iD(),r=Ru();function n(i){return e(i,r,t)}return u0=n,u0}var f0,Wy;function pD(){if(Wy)return f0;Wy=1;var e=mD(),t=1,r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o,l,c,u){var h=o&t,m=e(a),d=m.length,g=e(s),p=g.length;if(d!=p&&!h)return!1;for(var x=d;x--;){var v=m[x];if(!(h?v in s:n.call(s,v)))return!1}var b=u.get(a),y=u.get(s);if(b&&y)return b==s&&y==a;var w=!0;u.set(a,s),u.set(s,a);for(var k=h;++x<d;){v=m[x];var T=a[v],S=s[v];if(l)var E=h?l(S,T,v,s,a,u):l(T,S,v,a,s,u);if(!(E===void 0?T===S||c(T,S,o,l,u):E)){w=!1;break}k||(k=v=="constructor")}if(w&&!k){var A=a.constructor,R=s.constructor;A!=R&&"constructor"in a&&"constructor"in s&&!(typeof A=="function"&&A instanceof A&&typeof R=="function"&&R instanceof R)&&(w=!1)}return u.delete(a),u.delete(s),w}return f0=i,f0}var h0,Gy;function gD(){if(Gy)return h0;Gy=1;var e=qa(),t=Kn(),r=e(t,"DataView");return h0=r,h0}var d0,Yy;function xD(){if(Yy)return d0;Yy=1;var e=qa(),t=Kn(),r=e(t,"Promise");return d0=r,d0}var m0,Xy;function CN(){if(Xy)return m0;Xy=1;var e=qa(),t=Kn(),r=e(t,"Set");return m0=r,m0}var p0,Ky;function vD(){if(Ky)return p0;Ky=1;var e=qa(),t=Kn(),r=e(t,"WeakMap");return p0=r,p0}var g0,Qy;function yD(){if(Qy)return g0;Qy=1;var e=gD(),t=Tg(),r=xD(),n=CN(),i=vD(),a=bi(),s=XE(),o="[object Map]",l="[object Object]",c="[object Promise]",u="[object Set]",h="[object WeakMap]",m="[object DataView]",d=s(e),g=s(t),p=s(r),x=s(n),v=s(i),b=a;return(e&&b(new e(new ArrayBuffer(1)))!=m||t&&b(new t)!=o||r&&b(r.resolve())!=c||n&&b(new n)!=u||i&&b(new i)!=h)&&(b=function(y){var w=a(y),k=w==l?y.constructor:void 0,T=k?s(k):"";if(T)switch(T){case d:return m;case g:return o;case p:return c;case x:return u;case v:return h}return w}),g0=b,g0}var x0,Zy;function wD(){if(Zy)return x0;Zy=1;var e=vN(),t=_N(),r=eD(),n=pD(),i=yD(),a=Or(),s=TN(),o=NN(),l=1,c="[object Arguments]",u="[object Array]",h="[object Object]",m=Object.prototype,d=m.hasOwnProperty;function g(p,x,v,b,y,w){var k=a(p),T=a(x),S=k?u:i(p),E=T?u:i(x);S=S==c?h:S,E=E==c?h:E;var A=S==h,R=E==h,C=S==E;if(C&&s(p)){if(!s(x))return!1;k=!0,A=!1}if(C&&!A)return w||(w=new e),k||o(p)?t(p,x,v,b,y,w):r(p,x,S,v,b,y,w);if(!(v&l)){var j=A&&d.call(p,"__wrapped__"),z=R&&d.call(x,"__wrapped__");if(j||z){var G=j?p.value():p,W=z?x.value():x;return w||(w=new e),y(G,W,v,b,w)}}return C?(w||(w=new e),n(p,x,v,b,y,w)):!1}return x0=g,x0}var v0,Jy;function jg(){if(Jy)return v0;Jy=1;var e=wD(),t=_i();function r(n,i,a,s,o){return n===i?!0:n==null||i==null||!t(n)&&!t(i)?n!==n&&i!==i:e(n,i,a,s,r,o)}return v0=r,v0}var y0,ew;function bD(){if(ew)return y0;ew=1;var e=vN(),t=jg(),r=1,n=2;function i(a,s,o,l){var c=o.length,u=c,h=!l;if(a==null)return!u;for(a=Object(a);c--;){var m=o[c];if(h&&m[2]?m[1]!==a[m[0]]:!(m[0]in a))return!1}for(;++c<u;){m=o[c];var d=m[0],g=a[d],p=m[1];if(h&&m[2]){if(g===void 0&&!(d in a))return!1}else{var x=new e;if(l)var v=l(g,p,d,a,s,x);if(!(v===void 0?t(p,g,r|n,l,x):v))return!1}}return!0}return y0=i,y0}var w0,tw;function kN(){if(tw)return w0;tw=1;var e=ea();function t(r){return r===r&&!e(r)}return w0=t,w0}var b0,rw;function _D(){if(rw)return b0;rw=1;var e=kN(),t=Ru();function r(n){for(var i=t(n),a=i.length;a--;){var s=i[a],o=n[s];i[a]=[s,o,e(o)]}return i}return b0=r,b0}var _0,nw;function RN(){if(nw)return _0;nw=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return _0=e,_0}var S0,iw;function SD(){if(iw)return S0;iw=1;var e=bD(),t=_D(),r=RN();function n(i){var a=t(i);return a.length==1&&a[0][2]?r(a[0][0],a[0][1]):function(s){return s===i||e(s,i,a)}}return S0=n,S0}var T0,aw;function TD(){if(aw)return T0;aw=1;function e(t,r){return t!=null&&r in Object(t)}return T0=e,T0}var E0,sw;function ED(){if(sw)return E0;sw=1;var e=ZE(),t=Og(),r=Or(),n=Fg(),i=Ig(),a=Au();function s(o,l,c){l=e(l,o);for(var u=-1,h=l.length,m=!1;++u<h;){var d=a(l[u]);if(!(m=o!=null&&c(o,d)))break;o=o[d]}return m||++u!=h?m:(h=o==null?0:o.length,!!h&&i(h)&&n(d,h)&&(r(o)||t(o)))}return E0=s,E0}var N0,ow;function ND(){if(ow)return N0;ow=1;var e=TD(),t=ED();function r(n,i){return n!=null&&t(n,i,e)}return N0=r,N0}var A0,lw;function AD(){if(lw)return A0;lw=1;var e=jg(),t=JE(),r=ND(),n=bg(),i=kN(),a=RN(),s=Au(),o=1,l=2;function c(u,h){return n(u)&&i(h)?a(s(u),h):function(m){var d=t(m,u);return d===void 0&&d===h?r(m,u):e(h,d,o|l)}}return A0=c,A0}var C0,cw;function qs(){if(cw)return C0;cw=1;function e(t){return t}return C0=e,C0}var k0,uw;function CD(){if(uw)return k0;uw=1;function e(t){return function(r){return r==null?void 0:r[t]}}return k0=e,k0}var R0,fw;function kD(){if(fw)return R0;fw=1;var e=Ag();function t(r){return function(n){return e(n,r)}}return R0=t,R0}var O0,hw;function RD(){if(hw)return O0;hw=1;var e=CD(),t=kD(),r=bg(),n=Au();function i(a){return r(a)?e(n(a)):t(a)}return O0=i,O0}var F0,dw;function Qn(){if(dw)return F0;dw=1;var e=SD(),t=AD(),r=qs(),n=Or(),i=RD();function a(s){return typeof s=="function"?s:s==null?r:typeof s=="object"?n(s)?t(s[0],s[1]):e(s):i(s)}return F0=a,F0}var I0,mw;function ON(){if(mw)return I0;mw=1;function e(t,r,n,i){for(var a=t.length,s=n+(i?1:-1);i?s--:++s<a;)if(r(t[s],s,t))return s;return-1}return I0=e,I0}var j0,pw;function OD(){if(pw)return j0;pw=1;function e(t){return t!==t}return j0=e,j0}var D0,gw;function FD(){if(gw)return D0;gw=1;function e(t,r,n){for(var i=n-1,a=t.length;++i<a;)if(t[i]===r)return i;return-1}return D0=e,D0}var P0,xw;function ID(){if(xw)return P0;xw=1;var e=ON(),t=OD(),r=FD();function n(i,a,s){return a===a?r(i,a,s):e(i,t,s)}return P0=n,P0}var M0,vw;function jD(){if(vw)return M0;vw=1;var e=ID();function t(r,n){var i=r==null?0:r.length;return!!i&&e(r,n,0)>-1}return M0=t,M0}var L0,yw;function DD(){if(yw)return L0;yw=1;function e(t,r,n){for(var i=-1,a=t==null?0:t.length;++i<a;)if(n(r,t[i]))return!0;return!1}return L0=e,L0}var B0,ww;function PD(){if(ww)return B0;ww=1;function e(){}return B0=e,B0}var U0,bw;function MD(){if(bw)return U0;bw=1;var e=CN(),t=PD(),r=Rg(),n=1/0,i=e&&1/r(new e([,-0]))[1]==n?function(a){return new e(a)}:t;return U0=i,U0}var q0,_w;function LD(){if(_w)return q0;_w=1;var e=yN(),t=jD(),r=DD(),n=bN(),i=MD(),a=Rg(),s=200;function o(l,c,u){var h=-1,m=t,d=l.length,g=!0,p=[],x=p;if(u)g=!1,m=r;else if(d>=s){var v=c?null:i(l);if(v)return a(v);g=!1,m=n,x=new e}else x=c?[]:p;e:for(;++h<d;){var b=l[h],y=c?c(b):b;if(b=u||b!==0?b:0,g&&y===y){for(var w=x.length;w--;)if(x[w]===y)continue e;c&&x.push(y),p.push(b)}else m(x,y,u)||(x!==p&&x.push(y),p.push(b))}return p}return q0=o,q0}var z0,Sw;function BD(){if(Sw)return z0;Sw=1;var e=Qn(),t=LD();function r(n,i){return n&&n.length?t(n,e(i,2)):[]}return z0=r,z0}var UD=BD();const qZ=Xe(UD);var H0,Tw;function qD(){if(Tw)return H0;Tw=1;var e=yl(),t=Og(),r=Or(),n=e?e.isConcatSpreadable:void 0;function i(a){return r(a)||t(a)||!!(n&&a&&a[n])}return H0=i,H0}var $0,Ew;function FN(){if(Ew)return $0;Ew=1;var e=SN(),t=qD();function r(n,i,a,s,o){var l=-1,c=n.length;for(a||(a=t),o||(o=[]);++l<c;){var u=n[l];i>0&&a(u)?i>1?r(u,i-1,a,s,o):e(o,u):s||(o[o.length]=u)}return o}return $0=r,$0}var V0,Nw;function zD(){if(Nw)return V0;Nw=1;function e(t){return function(r,n,i){for(var a=-1,s=Object(r),o=i(r),l=o.length;l--;){var c=o[t?l:++a];if(n(s[c],c,s)===!1)break}return r}}return V0=e,V0}var W0,Aw;function HD(){if(Aw)return W0;Aw=1;var e=zD(),t=e();return W0=t,W0}var G0,Cw;function IN(){if(Cw)return G0;Cw=1;var e=HD(),t=Ru();function r(n,i){return n&&e(n,i,t)}return G0=r,G0}var Y0,kw;function $D(){if(kw)return Y0;kw=1;var e=wl();function t(r,n){return function(i,a){if(i==null)return i;if(!e(i))return r(i,a);for(var s=i.length,o=n?s:-1,l=Object(i);(n?o--:++o<s)&&a(l[o],o,l)!==!1;);return i}}return Y0=t,Y0}var X0,Rw;function Dg(){if(Rw)return X0;Rw=1;var e=IN(),t=$D(),r=t(e);return X0=r,X0}var K0,Ow;function jN(){if(Ow)return K0;Ow=1;var e=Dg(),t=wl();function r(n,i){var a=-1,s=t(n)?Array(n.length):[];return e(n,function(o,l,c){s[++a]=i(o,l,c)}),s}return K0=r,K0}var Q0,Fw;function VD(){if(Fw)return Q0;Fw=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return Q0=e,Q0}var Z0,Iw;function WD(){if(Iw)return Z0;Iw=1;var e=Us();function t(r,n){if(r!==n){var i=r!==void 0,a=r===null,s=r===r,o=e(r),l=n!==void 0,c=n===null,u=n===n,h=e(n);if(!c&&!h&&!o&&r>n||o&&l&&u&&!c&&!h||a&&l&&u||!i&&u||!s)return 1;if(!a&&!o&&!h&&r<n||h&&i&&s&&!a&&!o||c&&i&&s||!l&&s||!u)return-1}return 0}return Z0=t,Z0}var J0,jw;function GD(){if(jw)return J0;jw=1;var e=WD();function t(r,n,i){for(var a=-1,s=r.criteria,o=n.criteria,l=s.length,c=i.length;++a<l;){var u=e(s[a],o[a]);if(u){if(a>=c)return u;var h=i[a];return u*(h=="desc"?-1:1)}}return r.index-n.index}return J0=t,J0}var ed,Dw;function YD(){if(Dw)return ed;Dw=1;var e=Ng(),t=Ag(),r=Qn(),n=jN(),i=VD(),a=EN(),s=GD(),o=qs(),l=Or();function c(u,h,m){h.length?h=e(h,function(p){return l(p)?function(x){return t(x,p.length===1?p[0]:p)}:p}):h=[o];var d=-1;h=e(h,a(r));var g=n(u,function(p,x,v){var b=e(h,function(y){return y(p)});return{criteria:b,index:++d,value:p}});return i(g,function(p,x){return s(p,x,m)})}return ed=c,ed}var td,Pw;function XD(){if(Pw)return td;Pw=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return td=e,td}var rd,Mw;function KD(){if(Mw)return rd;Mw=1;var e=XD(),t=Math.max;function r(n,i,a){return i=t(i===void 0?n.length-1:i,0),function(){for(var s=arguments,o=-1,l=t(s.length-i,0),c=Array(l);++o<l;)c[o]=s[i+o];o=-1;for(var u=Array(i+1);++o<i;)u[o]=s[o];return u[i]=a(c),e(n,this,u)}}return rd=r,rd}var nd,Lw;function QD(){if(Lw)return nd;Lw=1;function e(t){return function(){return t}}return nd=e,nd}var id,Bw;function DN(){if(Bw)return id;Bw=1;var e=qa(),t=(function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch(n){}})();return id=t,id}var ad,Uw;function ZD(){if(Uw)return ad;Uw=1;var e=QD(),t=DN(),r=qs(),n=t?function(i,a){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(a),writable:!0})}:r;return ad=n,ad}var sd,qw;function JD(){if(qw)return sd;qw=1;var e=800,t=16,r=Date.now;function n(i){var a=0,s=0;return function(){var o=r(),l=t-(o-s);if(s=o,l>0){if(++a>=e)return arguments[0]}else a=0;return i.apply(void 0,arguments)}}return sd=n,sd}var od,zw;function eP(){if(zw)return od;zw=1;var e=ZD(),t=JD(),r=t(e);return od=r,od}var ld,Hw;function tP(){if(Hw)return ld;Hw=1;var e=qs(),t=KD(),r=eP();function n(i,a){return r(t(i,a,e),i+"")}return ld=n,ld}var cd,$w;function Ou(){if($w)return cd;$w=1;var e=Sg(),t=wl(),r=Fg(),n=ea();function i(a,s,o){if(!n(o))return!1;var l=typeof s;return(l=="number"?t(o)&&r(s,o.length):l=="string"&&s in o)?e(o[s],a):!1}return cd=i,cd}var ud,Vw;function rP(){if(Vw)return ud;Vw=1;var e=FN(),t=YD(),r=tP(),n=Ou(),i=r(function(a,s){if(a==null)return[];var o=s.length;return o>1&&n(a,s[0],s[1])?s=[]:o>2&&n(s[0],s[1],s[2])&&(s=[s[0]]),t(a,e(s,1),[])});return ud=i,ud}var nP=rP();const zZ=Xe(nP);var fd,Ww;function iP(){if(Ww)return fd;Ww=1;var e=Kn(),t=function(){return e.Date.now()};return fd=t,fd}var hd,Gw;function aP(){if(Gw)return hd;Gw=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return hd=t,hd}var dd,Yw;function sP(){if(Yw)return dd;Yw=1;var e=aP(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return dd=r,dd}var md,Xw;function PN(){if(Xw)return md;Xw=1;var e=sP(),t=ea(),r=Us(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function l(c){if(typeof c=="number")return c;if(r(c))return n;if(t(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=t(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=e(c);var h=a.test(c);return h||s.test(c)?o(c.slice(2),h?2:8):i.test(c)?n:+c}return md=l,md}var pd,Kw;function oP(){if(Kw)return pd;Kw=1;var e=ea(),t=iP(),r=PN(),n="Expected a function",i=Math.max,a=Math.min;function s(o,l,c){var u,h,m,d,g,p,x=0,v=!1,b=!1,y=!0;if(typeof o!="function")throw new TypeError(n);l=r(l)||0,e(c)&&(v=!!c.leading,b="maxWait"in c,m=b?i(r(c.maxWait)||0,l):m,y="trailing"in c?!!c.trailing:y);function w(z){var G=u,W=h;return u=h=void 0,x=z,d=o.apply(W,G),d}function k(z){return x=z,g=setTimeout(E,l),v?w(z):d}function T(z){var G=z-p,W=z-x,fe=l-G;return b?a(fe,m-W):fe}function S(z){var G=z-p,W=z-x;return p===void 0||G>=l||G<0||b&&W>=m}function E(){var z=t();if(S(z))return A(z);g=setTimeout(E,T(z))}function A(z){return g=void 0,y&&u?w(z):(u=h=void 0,d)}function R(){g!==void 0&&clearTimeout(g),x=0,u=p=h=g=void 0}function C(){return g===void 0?d:A(t())}function j(){var z=t(),G=S(z);if(u=arguments,h=this,p=z,G){if(g===void 0)return k(p);if(b)return clearTimeout(g),g=setTimeout(E,l),w(p)}return g===void 0&&(g=setTimeout(E,l)),d}return j.cancel=R,j.flush=C,j}return pd=s,pd}var gd,Qw;function lP(){if(Qw)return gd;Qw=1;var e=oP(),t=ea(),r="Expected a function";function n(i,a,s){var o=!0,l=!0;if(typeof i!="function")throw new TypeError(r);return t(s)&&(o="leading"in s?!!s.leading:o,l="trailing"in s?!!s.trailing:l),e(i,a,{leading:o,maxWait:a,trailing:l})}return gd=n,gd}var cP=lP();const HZ=Xe(cP);function Ui(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function uP(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Pg(e){let t,r,n;e.length!==2?(t=Ui,r=(o,l)=>Ui(e(o),l),n=(o,l)=>e(o)-l):(t=e===Ui||e===uP?e:fP,r=e,n=e);function i(o,l,c=0,u=o.length){if(c<u){if(t(l,l)!==0)return u;do{const h=c+u>>>1;r(o[h],l)<0?c=h+1:u=h}while(c<u)}return c}function a(o,l,c=0,u=o.length){if(c<u){if(t(l,l)!==0)return u;do{const h=c+u>>>1;r(o[h],l)<=0?c=h+1:u=h}while(c<u)}return c}function s(o,l,c=0,u=o.length){const h=i(o,l,c,u-1);return h>c&&n(o[h-1],l)>-n(o[h],l)?h-1:h}return{left:i,center:s,right:a}}function fP(){return 0}function MN(e){return e===null?NaN:+e}function*hP(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const dP=Pg(Ui),bl=dP.right;Pg(MN).center;class Zw extends Map{constructor(t,r=gP){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(Jw(this,t))}has(t){return super.has(Jw(this,t))}set(t,r){return super.set(mP(this,t),r)}delete(t){return super.delete(pP(this,t))}}function Jw({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function mP({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function pP({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function gP(e){return e!==null&&typeof e=="object"?e.valueOf():e}function xP(e=Ui){if(e===Ui)return LN;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function LN(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const vP=Math.sqrt(50),yP=Math.sqrt(10),wP=Math.sqrt(2);function Bc(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),s=a>=vP?10:a>=yP?5:a>=wP?2:1;let o,l,c;return i<0?(c=Math.pow(10,-i)/s,o=Math.round(e*c),l=Math.round(t*c),o/c<e&&++o,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*s,o=Math.round(e/c),l=Math.round(t/c),o*c<e&&++o,l*c>t&&--l),l<o&&.5<=r&&r<2?Bc(e,t,r*2):[o,l,c]}function lp(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,a,s]=n?Bc(t,e,r):Bc(e,t,r);if(!(a>=i))return[];const o=a-i+1,l=new Array(o);if(n)if(s<0)for(let c=0;c<o;++c)l[c]=(a-c)/-s;else for(let c=0;c<o;++c)l[c]=(a-c)*s;else if(s<0)for(let c=0;c<o;++c)l[c]=(i+c)/-s;else for(let c=0;c<o;++c)l[c]=(i+c)*s;return l}function cp(e,t,r){return t=+t,e=+e,r=+r,Bc(e,t,r)[2]}function up(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?cp(t,e,r):cp(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function e2(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function t2(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function BN(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?LN:xP(i);n>r;){if(n-r>600){const l=n-r+1,c=t-r+1,u=Math.log(l),h=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1),d=Math.max(r,Math.floor(t-c*h/l+m)),g=Math.min(n,Math.floor(t+(l-c)*h/l+m));BN(e,t,d,g,i)}const a=e[t];let s=r,o=n;for(io(e,r,t),i(e[n],a)>0&&io(e,r,n);s<o;){for(io(e,s,o),++s,--o;i(e[s],a)<0;)++s;for(;i(e[o],a)>0;)--o}i(e[r],a)===0?io(e,r,o):(++o,io(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function io(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function bP(e,t,r){if(e=Float64Array.from(hP(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return t2(e);if(t>=1)return e2(e);var n,i=(n-1)*t,a=Math.floor(i),s=e2(BN(e,a).subarray(0,a+1)),o=t2(e.subarray(a+1));return s+(o-s)*(i-a)}}function _P(e,t,r=MN){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,a=Math.floor(i),s=+r(e[a],a,e),o=+r(e[a+1],a+1,e);return s+(o-s)*(i-a)}}function SP(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(i);++n<i;)a[n]=e+n*r;return a}function cn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Si(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const fp=Symbol("implicit");function Mg(){var e=new Zw,t=[],r=[],n=fp;function i(a){let s=e.get(a);if(s===void 0){if(n!==fp)return n;e.set(a,s=t.push(a)-1)}return r[s%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Zw;for(const s of a)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return Mg(t,r).unknown(n)},cn.apply(i,arguments),i}function Lg(){var e=Mg().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,a,s,o=!1,l=0,c=0,u=.5;delete e.unknown;function h(){var m=t().length,d=i<n,g=d?i:n,p=d?n:i;a=(p-g)/Math.max(1,m-l+c*2),o&&(a=Math.floor(a)),g+=(p-g-a*(m-l))*u,s=a*(1-l),o&&(g=Math.round(g),s=Math.round(s));var x=SP(m).map(function(v){return g+a*v});return r(d?x.reverse():x)}return e.domain=function(m){return arguments.length?(t(m),h()):t()},e.range=function(m){return arguments.length?([n,i]=m,n=+n,i=+i,h()):[n,i]},e.rangeRound=function(m){return[n,i]=m,n=+n,i=+i,o=!0,h()},e.bandwidth=function(){return s},e.step=function(){return a},e.round=function(m){return arguments.length?(o=!!m,h()):o},e.padding=function(m){return arguments.length?(l=Math.min(1,c=+m),h()):l},e.paddingInner=function(m){return arguments.length?(l=Math.min(1,m),h()):l},e.paddingOuter=function(m){return arguments.length?(c=+m,h()):c},e.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),h()):u},e.copy=function(){return Lg(t(),[n,i]).round(o).paddingInner(l).paddingOuter(c).align(u)},cn.apply(h(),arguments)}function UN(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return UN(t())},e}function TP(){return UN(Lg.apply(null,arguments).paddingInner(1))}function Bg(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function qN(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function _l(){}var Wo=.7,Uc=1/Wo,vs="\\s*([+-]?\\d+)\\s*",Go="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",EP=/^#([0-9a-f]{3,8})$/,NP=new RegExp(`^rgb\\(${vs},${vs},${vs}\\)$`),AP=new RegExp(`^rgb\\(${$n},${$n},${$n}\\)$`),CP=new RegExp(`^rgba\\(${vs},${vs},${vs},${Go}\\)$`),kP=new RegExp(`^rgba\\(${$n},${$n},${$n},${Go}\\)$`),RP=new RegExp(`^hsl\\(${Go},${$n},${$n}\\)$`),OP=new RegExp(`^hsla\\(${Go},${$n},${$n},${Go}\\)$`),r2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bg(_l,Yo,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:n2,formatHex:n2,formatHex8:FP,formatHsl:IP,formatRgb:i2,toString:i2});function n2(){return this.rgb().formatHex()}function FP(){return this.rgb().formatHex8()}function IP(){return zN(this).formatHsl()}function i2(){return this.rgb().formatRgb()}function Yo(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=EP.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?a2(t):r===3?new Er(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Kl(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Kl(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=NP.exec(e))?new Er(t[1],t[2],t[3],1):(t=AP.exec(e))?new Er(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=CP.exec(e))?Kl(t[1],t[2],t[3],t[4]):(t=kP.exec(e))?Kl(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=RP.exec(e))?l2(t[1],t[2]/100,t[3]/100,1):(t=OP.exec(e))?l2(t[1],t[2]/100,t[3]/100,t[4]):r2.hasOwnProperty(e)?a2(r2[e]):e==="transparent"?new Er(NaN,NaN,NaN,0):null}function a2(e){return new Er(e>>16&255,e>>8&255,e&255,1)}function Kl(e,t,r,n){return n<=0&&(e=t=r=NaN),new Er(e,t,r,n)}function jP(e){return e instanceof _l||(e=Yo(e)),e?(e=e.rgb(),new Er(e.r,e.g,e.b,e.opacity)):new Er}function hp(e,t,r,n){return arguments.length===1?jP(e):new Er(e,t,r,n==null?1:n)}function Er(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Bg(Er,hp,qN(_l,{brighter(e){return e=e==null?Uc:Math.pow(Uc,e),new Er(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Wo:Math.pow(Wo,e),new Er(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Er(Aa(this.r),Aa(this.g),Aa(this.b),qc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:s2,formatHex:s2,formatHex8:DP,formatRgb:o2,toString:o2}));function s2(){return`#${va(this.r)}${va(this.g)}${va(this.b)}`}function DP(){return`#${va(this.r)}${va(this.g)}${va(this.b)}${va((isNaN(this.opacity)?1:this.opacity)*255)}`}function o2(){const e=qc(this.opacity);return`${e===1?"rgb(":"rgba("}${Aa(this.r)}, ${Aa(this.g)}, ${Aa(this.b)}${e===1?")":`, ${e})`}`}function qc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Aa(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function va(e){return e=Aa(e),(e<16?"0":"")+e.toString(16)}function l2(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new bn(e,t,r,n)}function zN(e){if(e instanceof bn)return new bn(e.h,e.s,e.l,e.opacity);if(e instanceof _l||(e=Yo(e)),!e)return new bn;if(e instanceof bn)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),s=NaN,o=a-i,l=(a+i)/2;return o?(t===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-t)/o+2:s=(t-r)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new bn(s,o,l,e.opacity)}function PP(e,t,r,n){return arguments.length===1?zN(e):new bn(e,t,r,n==null?1:n)}function bn(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Bg(bn,PP,qN(_l,{brighter(e){return e=e==null?Uc:Math.pow(Uc,e),new bn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Wo:Math.pow(Wo,e),new bn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Er(xd(e>=240?e-240:e+120,i,n),xd(e,i,n),xd(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new bn(c2(this.h),Ql(this.s),Ql(this.l),qc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=qc(this.opacity);return`${e===1?"hsl(":"hsla("}${c2(this.h)}, ${Ql(this.s)*100}%, ${Ql(this.l)*100}%${e===1?")":`, ${e})`}`}}));function c2(e){return e=(e||0)%360,e<0?e+360:e}function Ql(e){return Math.max(0,Math.min(1,e||0))}function xd(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Ug=e=>()=>e;function MP(e,t){return function(r){return e+r*t}}function LP(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function BP(e){return(e=+e)==1?HN:function(t,r){return r-t?LP(t,r,e):Ug(isNaN(t)?r:t)}}function HN(e,t){var r=t-e;return r?MP(e,r):Ug(isNaN(e)?t:e)}const u2=(function e(t){var r=BP(t);function n(i,a){var s=r((i=hp(i)).r,(a=hp(a)).r),o=r(i.g,a.g),l=r(i.b,a.b),c=HN(i.opacity,a.opacity);return function(u){return i.r=s(u),i.g=o(u),i.b=l(u),i.opacity=c(u),i+""}}return n.gamma=e,n})(1);function UP(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function qP(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function zP(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=zs(e[s],t[s]);for(;s<r;++s)a[s]=t[s];return function(o){for(s=0;s<n;++s)a[s]=i[s](o);return a}}function HP(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function zc(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function $P(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=zs(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var dp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,vd=new RegExp(dp.source,"g");function VP(e){return function(){return e}}function WP(e){return function(t){return e(t)+""}}function GP(e,t){var r=dp.lastIndex=vd.lastIndex=0,n,i,a,s=-1,o=[],l=[];for(e=e+"",t=t+"";(n=dp.exec(e))&&(i=vd.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,l.push({i:s,x:zc(n,i)})),r=vd.lastIndex;return r<t.length&&(a=t.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?l[0]?WP(l[0].x):VP(t):(t=l.length,function(c){for(var u=0,h;u<t;++u)o[(h=l[u]).i]=h.x(c);return o.join("")})}function zs(e,t){var r=typeof t,n;return t==null||r==="boolean"?Ug(t):(r==="number"?zc:r==="string"?(n=Yo(t))?(t=n,u2):GP:t instanceof Yo?u2:t instanceof Date?HP:qP(t)?UP:Array.isArray(t)?zP:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?$P:zc)(e,t)}function qg(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function YP(e,t){t===void 0&&(t=e,e=zs);for(var r=0,n=t.length-1,i=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(i,i=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return a[o](s-o)}}function XP(e){return function(){return e}}function Hc(e){return+e}var f2=[0,1];function br(e){return e}function mp(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:XP(isNaN(t)?NaN:.5)}function KP(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function QP(e,t,r){var n=e[0],i=e[1],a=t[0],s=t[1];return i<n?(n=mp(i,n),a=r(s,a)):(n=mp(n,i),a=r(a,s)),function(o){return a(n(o))}}function ZP(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)i[s]=mp(e[s],e[s+1]),a[s]=r(t[s],t[s+1]);return function(o){var l=bl(e,o,1,n)-1;return a[l](i[l](o))}}function Sl(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Fu(){var e=f2,t=f2,r=zs,n,i,a,s=br,o,l,c;function u(){var m=Math.min(e.length,t.length);return s!==br&&(s=KP(e[0],e[m-1])),o=m>2?ZP:QP,l=c=null,h}function h(m){return m==null||isNaN(m=+m)?a:(l||(l=o(e.map(n),t,r)))(n(s(m)))}return h.invert=function(m){return s(i((c||(c=o(t,e.map(n),zc)))(m)))},h.domain=function(m){return arguments.length?(e=Array.from(m,Hc),u()):e.slice()},h.range=function(m){return arguments.length?(t=Array.from(m),u()):t.slice()},h.rangeRound=function(m){return t=Array.from(m),r=qg,u()},h.clamp=function(m){return arguments.length?(s=m?!0:br,u()):s!==br},h.interpolate=function(m){return arguments.length?(r=m,u()):r},h.unknown=function(m){return arguments.length?(a=m,h):a},function(m,d){return n=m,i=d,u()}}function zg(){return Fu()(br,br)}function JP(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function $c(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Ds(e){return e=$c(Math.abs(e)),e?e[1]:NaN}function eM(e,t){return function(r,n){for(var i=r.length,a=[],s=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),a.push(r.substring(i-=o,i+o)),!((l+=o+1)>n));)o=e[s=(s+1)%e.length];return a.reverse().join(t)}}function tM(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var rM=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Xo(e){if(!(t=rM.exec(e)))throw new Error("invalid format: "+e);var t;return new Hg({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Xo.prototype=Hg.prototype;function Hg(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Hg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function nM(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var $N;function iM(e,t){var r=$c(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-($N=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+$c(e,Math.max(0,t+a-1))[0]}function h2(e,t){var r=$c(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const d2={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:JP,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>h2(e*100,t),r:h2,s:iM,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function m2(e){return e}var p2=Array.prototype.map,g2=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function aM(e){var t=e.grouping===void 0||e.thousands===void 0?m2:eM(p2.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?m2:tM(p2.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"âˆ’":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(h){h=Xo(h);var m=h.fill,d=h.align,g=h.sign,p=h.symbol,x=h.zero,v=h.width,b=h.comma,y=h.precision,w=h.trim,k=h.type;k==="n"?(b=!0,k="g"):d2[k]||(y===void 0&&(y=12),w=!0,k="g"),(x||m==="0"&&d==="=")&&(x=!0,m="0",d="=");var T=p==="$"?r:p==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",S=p==="$"?n:/[%p]/.test(k)?s:"",E=d2[k],A=/[defgprs%]/.test(k);y=y===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function R(C){var j=T,z=S,G,W,fe;if(k==="c")z=E(C)+z,C="";else{C=+C;var he=C<0||1/C<0;if(C=isNaN(C)?l:E(Math.abs(C),y),w&&(C=nM(C)),he&&+C==0&&g!=="+"&&(he=!1),j=(he?g==="("?g:o:g==="-"||g==="("?"":g)+j,z=(k==="s"?g2[8+$N/3]:"")+z+(he&&g==="("?")":""),A){for(G=-1,W=C.length;++G<W;)if(fe=C.charCodeAt(G),48>fe||fe>57){z=(fe===46?i+C.slice(G+1):C.slice(G))+z,C=C.slice(0,G);break}}}b&&!x&&(C=t(C,1/0));var ee=j.length+C.length+z.length,re=ee<v?new Array(v-ee+1).join(m):"";switch(b&&x&&(C=t(re+C,re.length?v-z.length:1/0),re=""),d){case"<":C=j+C+z+re;break;case"=":C=j+re+C+z;break;case"^":C=re.slice(0,ee=re.length>>1)+j+C+z+re.slice(ee);break;default:C=re+j+C+z;break}return a(C)}return R.toString=function(){return h+""},R}function u(h,m){var d=c((h=Xo(h),h.type="f",h)),g=Math.max(-8,Math.min(8,Math.floor(Ds(m)/3)))*3,p=Math.pow(10,-g),x=g2[8+g/3];return function(v){return d(p*v)+x}}return{format:c,formatPrefix:u}}var Zl,$g,VN;sM({thousands:",",grouping:[3],currency:["$",""]});function sM(e){return Zl=aM(e),$g=Zl.format,VN=Zl.formatPrefix,Zl}function oM(e){return Math.max(0,-Ds(Math.abs(e)))}function lM(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ds(t)/3)))*3-Ds(Math.abs(e)))}function cM(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ds(t)-Ds(e))+1}function WN(e,t,r,n){var i=up(e,t,r),a;switch(n=Xo(n==null?",f":n),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=lM(i,s))&&(n.precision=a),VN(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=cM(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=oM(i))&&(n.precision=a-(n.type==="%")*2);break}}return $g(n)}function ta(e){var t=e.domain;return e.ticks=function(r){var n=t();return lp(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var i=t();return WN(i[0],i[i.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,s=n[i],o=n[a],l,c,u=10;for(o<s&&(c=s,s=o,o=c,c=i,i=a,a=c);u-- >0;){if(c=cp(s,o,r),c===l)return n[i]=s,n[a]=o,t(n);if(c>0)s=Math.floor(s/c)*c,o=Math.ceil(o/c)*c;else if(c<0)s=Math.ceil(s*c)/c,o=Math.floor(o*c)/c;else break;l=c}return e},e}function GN(){var e=zg();return e.copy=function(){return Sl(e,GN())},cn.apply(e,arguments),ta(e)}function YN(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Hc),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return YN(e).unknown(t)},e=arguments.length?Array.from(e,Hc):[0,1],ta(r)}function XN(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],s;return a<i&&(s=r,r=n,n=s,s=i,i=a,a=s),e[r]=t.floor(i),e[n]=t.ceil(a),e}function x2(e){return Math.log(e)}function v2(e){return Math.exp(e)}function uM(e){return-Math.log(-e)}function fM(e){return-Math.exp(-e)}function hM(e){return isFinite(e)?+("1e"+e):e<0?0:e}function dM(e){return e===10?hM:e===Math.E?Math.exp:t=>Math.pow(e,t)}function mM(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function y2(e){return(t,r)=>-e(-t,r)}function Vg(e){const t=e(x2,v2),r=t.domain;let n=10,i,a;function s(){return i=mM(n),a=dM(n),r()[0]<0?(i=y2(i),a=y2(a),e(uM,fM)):e(x2,v2),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const l=r();let c=l[0],u=l[l.length-1];const h=u<c;h&&([c,u]=[u,c]);let m=i(c),d=i(u),g,p;const x=o==null?10:+o;let v=[];if(!(n%1)&&d-m<x){if(m=Math.floor(m),d=Math.ceil(d),c>0){for(;m<=d;++m)for(g=1;g<n;++g)if(p=m<0?g/a(-m):g*a(m),!(p<c)){if(p>u)break;v.push(p)}}else for(;m<=d;++m)for(g=n-1;g>=1;--g)if(p=m>0?g/a(-m):g*a(m),!(p<c)){if(p>u)break;v.push(p)}v.length*2<x&&(v=lp(c,u,x))}else v=lp(m,d,Math.min(d-m,x)).map(a);return h?v.reverse():v},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=Xo(l)).precision==null&&(l.trim=!0),l=$g(l)),o===1/0)return l;const c=Math.max(1,n*o/t.ticks().length);return u=>{let h=u/a(Math.round(i(u)));return h*n<n-.5&&(h*=n),h<=c?l(u):""}},t.nice=()=>r(XN(r(),{floor:o=>a(Math.floor(i(o))),ceil:o=>a(Math.ceil(i(o)))})),t}function KN(){const e=Vg(Fu()).domain([1,10]);return e.copy=()=>Sl(e,KN()).base(e.base()),cn.apply(e,arguments),e}function w2(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function b2(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Wg(e){var t=1,r=e(w2(t),b2(t));return r.constant=function(n){return arguments.length?e(w2(t=+n),b2(t)):t},ta(r)}function QN(){var e=Wg(Fu());return e.copy=function(){return Sl(e,QN()).constant(e.constant())},cn.apply(e,arguments)}function _2(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function pM(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function gM(e){return e<0?-e*e:e*e}function Gg(e){var t=e(br,br),r=1;function n(){return r===1?e(br,br):r===.5?e(pM,gM):e(_2(r),_2(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},ta(t)}function Yg(){var e=Gg(Fu());return e.copy=function(){return Sl(e,Yg()).exponent(e.exponent())},cn.apply(e,arguments),e}function xM(){return Yg.apply(null,arguments).exponent(.5)}function S2(e){return Math.sign(e)*e*e}function vM(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function ZN(){var e=zg(),t=[0,1],r=!1,n;function i(a){var s=vM(e(a));return isNaN(s)?n:r?Math.round(s):s}return i.invert=function(a){return e.invert(S2(a))},i.domain=function(a){return arguments.length?(e.domain(a),i):e.domain()},i.range=function(a){return arguments.length?(e.range((t=Array.from(a,Hc)).map(S2)),i):t.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(e.clamp(a),i):e.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return ZN(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},cn.apply(i,arguments),ta(i)}function JN(){var e=[],t=[],r=[],n;function i(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=_P(e,s/o);return a}function a(s){return s==null||isNaN(s=+s)?n:t[bl(r,s)]}return a.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},a.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Ui),i()},a.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return JN().domain(e).range(t).unknown(n)},cn.apply(a,arguments)}function eA(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function s(l){return l!=null&&l<=l?i[bl(n,l,0,r)]:a}function o(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return s}return s.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},s.range=function(l){return arguments.length?(r=(i=Array.from(l)).length-1,o()):i.slice()},s.invertExtent=function(l){var c=i.indexOf(l);return c<0?[NaN,NaN]:c<1?[e,n[0]]:c>=r?[n[r-1],t]:[n[c-1],n[c]]},s.unknown=function(l){return arguments.length&&(a=l),s},s.thresholds=function(){return n.slice()},s.copy=function(){return eA().domain([e,t]).range(i).unknown(a)},cn.apply(ta(s),arguments)}function tA(){var e=[.5],t=[0,1],r,n=1;function i(a){return a!=null&&a<=a?t[bl(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var s=t.indexOf(a);return[e[s-1],e[s]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return tA().domain(e).range(t).unknown(r)},cn.apply(i,arguments)}const yd=new Date,wd=new Date;function $t(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(e(a=new Date(+a)),a),i.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),i.round=a=>{const s=i(a),o=i.ceil(a);return a-s<o-a?s:o},i.offset=(a,s)=>(t(a=new Date(+a),s==null?1:Math.floor(s)),a),i.range=(a,s,o)=>{const l=[];if(a=i.ceil(a),o=o==null?1:Math.floor(o),!(a<s)||!(o>0))return l;let c;do l.push(c=new Date(+a)),t(a,o),e(a);while(c<a&&a<s);return l},i.filter=a=>$t(s=>{if(s>=s)for(;e(s),!a(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!a(s););else for(;--o>=0;)for(;t(s,1),!a(s););}),r&&(i.count=(a,s)=>(yd.setTime(+a),wd.setTime(+s),e(yd),e(wd),Math.floor(r(yd,wd))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?s=>n(s)%a===0:s=>i.count(0,s)%a===0):i)),i}const pp=$t(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);pp.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?$t(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):pp);const si=1e3,sn=si*60,oi=sn*60,pi=oi*24,Xg=pi*7,T2=pi*30,bd=pi*365,us=$t(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*si)},(e,t)=>(t-e)/si,e=>e.getUTCSeconds()),rA=$t(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*si)},(e,t)=>{e.setTime(+e+t*sn)},(e,t)=>(t-e)/sn,e=>e.getMinutes()),nA=$t(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*sn)},(e,t)=>(t-e)/sn,e=>e.getUTCMinutes()),iA=$t(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*si-e.getMinutes()*sn)},(e,t)=>{e.setTime(+e+t*oi)},(e,t)=>(t-e)/oi,e=>e.getHours()),aA=$t(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*oi)},(e,t)=>(t-e)/oi,e=>e.getUTCHours()),Iu=$t(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*sn)/pi,e=>e.getDate()-1),Kg=$t(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/pi,e=>e.getUTCDate()-1),yM=$t(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/pi,e=>Math.floor(e/pi));function za(e){return $t(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*sn)/Xg)}const Qg=za(0),gp=za(1);za(2);za(3);const Ko=za(4);za(5);za(6);function Ha(e){return $t(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Xg)}const Zg=Ha(0),xp=Ha(1);Ha(2);Ha(3);const Qo=Ha(4);Ha(5);Ha(6);const sA=$t(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),oA=$t(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),Vi=$t(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Vi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:$t(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});const Wi=$t(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Wi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:$t(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});function lA(e,t,r,n,i,a){const s=[[us,1,si],[us,5,5*si],[us,15,15*si],[us,30,30*si],[a,1,sn],[a,5,5*sn],[a,15,15*sn],[a,30,30*sn],[i,1,oi],[i,3,3*oi],[i,6,6*oi],[i,12,12*oi],[n,1,pi],[n,2,2*pi],[r,1,Xg],[t,1,T2],[t,3,3*T2],[e,1,bd]];function o(c,u,h){const m=u<c;m&&([c,u]=[u,c]);const d=h&&typeof h.range=="function"?h:l(c,u,h),g=d?d.range(c,+u+1):[];return m?g.reverse():g}function l(c,u,h){const m=Math.abs(u-c)/h,d=Pg(([,,x])=>x).right(s,m);if(d===s.length)return e.every(up(c/bd,u/bd,h));if(d===0)return pp.every(Math.max(up(c,u,h),1));const[g,p]=s[m/s[d-1][2]<s[d][2]/m?d-1:d];return g.every(p)}return[o,l]}const[wM,bM]=lA(Wi,oA,Zg,yM,aA,nA),[_M,SM]=lA(Vi,sA,Qg,Iu,iA,rA);function _d(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Sd(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ao(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function TM(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,s=e.shortDays,o=e.months,l=e.shortMonths,c=so(i),u=oo(i),h=so(a),m=oo(a),d=so(s),g=oo(s),p=so(o),x=oo(o),v=so(l),b=oo(l),y={a:he,A:ee,b:re,B:O,c:null,d:R2,e:R2,f:GM,g:n5,G:a5,H:$M,I:VM,j:WM,L:cA,m:YM,M:XM,p:ge,q:B,Q:I2,s:j2,S:KM,u:QM,U:ZM,V:JM,w:e5,W:t5,x:null,X:null,y:r5,Y:i5,Z:s5,"%":F2},w={a:_,A:M,b:U,B:V,c:null,d:O2,e:O2,f:u5,g:w5,G:_5,H:o5,I:l5,j:c5,L:fA,m:f5,M:h5,p:le,q:de,Q:I2,s:j2,S:d5,u:m5,U:p5,V:g5,w:x5,W:v5,x:null,X:null,y:y5,Y:b5,Z:S5,"%":F2},k={a:R,A:C,b:j,B:z,c:G,d:C2,e:C2,f:UM,g:A2,G:N2,H:k2,I:k2,j:PM,L:BM,m:DM,M:MM,p:A,q:jM,Q:zM,s:HM,S:LM,u:kM,U:RM,V:OM,w:CM,W:FM,x:W,X:fe,y:A2,Y:N2,Z:IM,"%":qM};y.x=T(r,y),y.X=T(n,y),y.c=T(t,y),w.x=T(r,w),w.X=T(n,w),w.c=T(t,w);function T(K,J){return function(Se){var te=[],$e=-1,Ne=0,Je=K.length,Be,Te,Ot;for(Se instanceof Date||(Se=new Date(+Se));++$e<Je;)K.charCodeAt($e)===37&&(te.push(K.slice(Ne,$e)),(Te=E2[Be=K.charAt(++$e)])!=null?Be=K.charAt(++$e):Te=Be==="e"?" ":"0",(Ot=J[Be])&&(Be=Ot(Se,Te)),te.push(Be),Ne=$e+1);return te.push(K.slice(Ne,$e)),te.join("")}}function S(K,J){return function(Se){var te=ao(1900,void 0,1),$e=E(te,K,Se+="",0),Ne,Je;if($e!=Se.length)return null;if("Q"in te)return new Date(te.Q);if("s"in te)return new Date(te.s*1e3+("L"in te?te.L:0));if(J&&!("Z"in te)&&(te.Z=0),"p"in te&&(te.H=te.H%12+te.p*12),te.m===void 0&&(te.m="q"in te?te.q:0),"V"in te){if(te.V<1||te.V>53)return null;"w"in te||(te.w=1),"Z"in te?(Ne=Sd(ao(te.y,0,1)),Je=Ne.getUTCDay(),Ne=Je>4||Je===0?xp.ceil(Ne):xp(Ne),Ne=Kg.offset(Ne,(te.V-1)*7),te.y=Ne.getUTCFullYear(),te.m=Ne.getUTCMonth(),te.d=Ne.getUTCDate()+(te.w+6)%7):(Ne=_d(ao(te.y,0,1)),Je=Ne.getDay(),Ne=Je>4||Je===0?gp.ceil(Ne):gp(Ne),Ne=Iu.offset(Ne,(te.V-1)*7),te.y=Ne.getFullYear(),te.m=Ne.getMonth(),te.d=Ne.getDate()+(te.w+6)%7)}else("W"in te||"U"in te)&&("w"in te||(te.w="u"in te?te.u%7:"W"in te?1:0),Je="Z"in te?Sd(ao(te.y,0,1)).getUTCDay():_d(ao(te.y,0,1)).getDay(),te.m=0,te.d="W"in te?(te.w+6)%7+te.W*7-(Je+5)%7:te.w+te.U*7-(Je+6)%7);return"Z"in te?(te.H+=te.Z/100|0,te.M+=te.Z%100,Sd(te)):_d(te)}}function E(K,J,Se,te){for(var $e=0,Ne=J.length,Je=Se.length,Be,Te;$e<Ne;){if(te>=Je)return-1;if(Be=J.charCodeAt($e++),Be===37){if(Be=J.charAt($e++),Te=k[Be in E2?J.charAt($e++):Be],!Te||(te=Te(K,Se,te))<0)return-1}else if(Be!=Se.charCodeAt(te++))return-1}return te}function A(K,J,Se){var te=c.exec(J.slice(Se));return te?(K.p=u.get(te[0].toLowerCase()),Se+te[0].length):-1}function R(K,J,Se){var te=d.exec(J.slice(Se));return te?(K.w=g.get(te[0].toLowerCase()),Se+te[0].length):-1}function C(K,J,Se){var te=h.exec(J.slice(Se));return te?(K.w=m.get(te[0].toLowerCase()),Se+te[0].length):-1}function j(K,J,Se){var te=v.exec(J.slice(Se));return te?(K.m=b.get(te[0].toLowerCase()),Se+te[0].length):-1}function z(K,J,Se){var te=p.exec(J.slice(Se));return te?(K.m=x.get(te[0].toLowerCase()),Se+te[0].length):-1}function G(K,J,Se){return E(K,t,J,Se)}function W(K,J,Se){return E(K,r,J,Se)}function fe(K,J,Se){return E(K,n,J,Se)}function he(K){return s[K.getDay()]}function ee(K){return a[K.getDay()]}function re(K){return l[K.getMonth()]}function O(K){return o[K.getMonth()]}function ge(K){return i[+(K.getHours()>=12)]}function B(K){return 1+~~(K.getMonth()/3)}function _(K){return s[K.getUTCDay()]}function M(K){return a[K.getUTCDay()]}function U(K){return l[K.getUTCMonth()]}function V(K){return o[K.getUTCMonth()]}function le(K){return i[+(K.getUTCHours()>=12)]}function de(K){return 1+~~(K.getUTCMonth()/3)}return{format:function(K){var J=T(K+="",y);return J.toString=function(){return K},J},parse:function(K){var J=S(K+="",!1);return J.toString=function(){return K},J},utcFormat:function(K){var J=T(K+="",w);return J.toString=function(){return K},J},utcParse:function(K){var J=S(K+="",!0);return J.toString=function(){return K},J}}}var E2={"-":"",_:" ",0:"0"},Kt=/^\s*\d+/,EM=/^%/,NM=/[\\^$*+?|[\]().{}]/g;function Ze(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function AM(e){return e.replace(NM,"\\$&")}function so(e){return new RegExp("^(?:"+e.map(AM).join("|")+")","i")}function oo(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function CM(e,t,r){var n=Kt.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function kM(e,t,r){var n=Kt.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function RM(e,t,r){var n=Kt.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function OM(e,t,r){var n=Kt.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function FM(e,t,r){var n=Kt.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function N2(e,t,r){var n=Kt.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function A2(e,t,r){var n=Kt.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function IM(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function jM(e,t,r){var n=Kt.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function DM(e,t,r){var n=Kt.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function C2(e,t,r){var n=Kt.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function PM(e,t,r){var n=Kt.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function k2(e,t,r){var n=Kt.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function MM(e,t,r){var n=Kt.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function LM(e,t,r){var n=Kt.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function BM(e,t,r){var n=Kt.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function UM(e,t,r){var n=Kt.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function qM(e,t,r){var n=EM.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function zM(e,t,r){var n=Kt.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function HM(e,t,r){var n=Kt.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function R2(e,t){return Ze(e.getDate(),t,2)}function $M(e,t){return Ze(e.getHours(),t,2)}function VM(e,t){return Ze(e.getHours()%12||12,t,2)}function WM(e,t){return Ze(1+Iu.count(Vi(e),e),t,3)}function cA(e,t){return Ze(e.getMilliseconds(),t,3)}function GM(e,t){return cA(e,t)+"000"}function YM(e,t){return Ze(e.getMonth()+1,t,2)}function XM(e,t){return Ze(e.getMinutes(),t,2)}function KM(e,t){return Ze(e.getSeconds(),t,2)}function QM(e){var t=e.getDay();return t===0?7:t}function ZM(e,t){return Ze(Qg.count(Vi(e)-1,e),t,2)}function uA(e){var t=e.getDay();return t>=4||t===0?Ko(e):Ko.ceil(e)}function JM(e,t){return e=uA(e),Ze(Ko.count(Vi(e),e)+(Vi(e).getDay()===4),t,2)}function e5(e){return e.getDay()}function t5(e,t){return Ze(gp.count(Vi(e)-1,e),t,2)}function r5(e,t){return Ze(e.getFullYear()%100,t,2)}function n5(e,t){return e=uA(e),Ze(e.getFullYear()%100,t,2)}function i5(e,t){return Ze(e.getFullYear()%1e4,t,4)}function a5(e,t){var r=e.getDay();return e=r>=4||r===0?Ko(e):Ko.ceil(e),Ze(e.getFullYear()%1e4,t,4)}function s5(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ze(t/60|0,"0",2)+Ze(t%60,"0",2)}function O2(e,t){return Ze(e.getUTCDate(),t,2)}function o5(e,t){return Ze(e.getUTCHours(),t,2)}function l5(e,t){return Ze(e.getUTCHours()%12||12,t,2)}function c5(e,t){return Ze(1+Kg.count(Wi(e),e),t,3)}function fA(e,t){return Ze(e.getUTCMilliseconds(),t,3)}function u5(e,t){return fA(e,t)+"000"}function f5(e,t){return Ze(e.getUTCMonth()+1,t,2)}function h5(e,t){return Ze(e.getUTCMinutes(),t,2)}function d5(e,t){return Ze(e.getUTCSeconds(),t,2)}function m5(e){var t=e.getUTCDay();return t===0?7:t}function p5(e,t){return Ze(Zg.count(Wi(e)-1,e),t,2)}function hA(e){var t=e.getUTCDay();return t>=4||t===0?Qo(e):Qo.ceil(e)}function g5(e,t){return e=hA(e),Ze(Qo.count(Wi(e),e)+(Wi(e).getUTCDay()===4),t,2)}function x5(e){return e.getUTCDay()}function v5(e,t){return Ze(xp.count(Wi(e)-1,e),t,2)}function y5(e,t){return Ze(e.getUTCFullYear()%100,t,2)}function w5(e,t){return e=hA(e),Ze(e.getUTCFullYear()%100,t,2)}function b5(e,t){return Ze(e.getUTCFullYear()%1e4,t,4)}function _5(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Qo(e):Qo.ceil(e),Ze(e.getUTCFullYear()%1e4,t,4)}function S5(){return"+0000"}function F2(){return"%"}function I2(e){return+e}function j2(e){return Math.floor(+e/1e3)}var Jl,dA,mA;T5({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function T5(e){return Jl=TM(e),dA=Jl.format,mA=Jl.utcFormat,Jl}function E5(e){return new Date(e)}function N5(e){return e instanceof Date?+e:+new Date(+e)}function Jg(e,t,r,n,i,a,s,o,l,c){var u=zg(),h=u.invert,m=u.domain,d=c(".%L"),g=c(":%S"),p=c("%I:%M"),x=c("%I %p"),v=c("%a %d"),b=c("%b %d"),y=c("%B"),w=c("%Y");function k(T){return(l(T)<T?d:o(T)<T?g:s(T)<T?p:a(T)<T?x:n(T)<T?i(T)<T?v:b:r(T)<T?y:w)(T)}return u.invert=function(T){return new Date(h(T))},u.domain=function(T){return arguments.length?m(Array.from(T,N5)):m().map(E5)},u.ticks=function(T){var S=m();return e(S[0],S[S.length-1],T==null?10:T)},u.tickFormat=function(T,S){return S==null?k:c(S)},u.nice=function(T){var S=m();return(!T||typeof T.range!="function")&&(T=t(S[0],S[S.length-1],T==null?10:T)),T?m(XN(S,T)):u},u.copy=function(){return Sl(u,Jg(e,t,r,n,i,a,s,o,l,c))},u}function A5(){return cn.apply(Jg(_M,SM,Vi,sA,Qg,Iu,iA,rA,us,dA).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function C5(){return cn.apply(Jg(wM,bM,Wi,oA,Zg,Kg,aA,nA,us,mA).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ju(){var e=0,t=1,r,n,i,a,s=br,o=!1,l;function c(h){return h==null||isNaN(h=+h)?l:s(i===0?.5:(h=(a(h)-r)*i,o?Math.max(0,Math.min(1,h)):h))}c.domain=function(h){return arguments.length?([e,t]=h,r=a(e=+e),n=a(t=+t),i=r===n?0:1/(n-r),c):[e,t]},c.clamp=function(h){return arguments.length?(o=!!h,c):o},c.interpolator=function(h){return arguments.length?(s=h,c):s};function u(h){return function(m){var d,g;return arguments.length?([d,g]=m,s=h(d,g),c):[s(0),s(1)]}}return c.range=u(zs),c.rangeRound=u(qg),c.unknown=function(h){return arguments.length?(l=h,c):l},function(h){return a=h,r=h(e),n=h(t),i=r===n?0:1/(n-r),c}}function ra(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function pA(){var e=ta(ju()(br));return e.copy=function(){return ra(e,pA())},Si.apply(e,arguments)}function gA(){var e=Vg(ju()).domain([1,10]);return e.copy=function(){return ra(e,gA()).base(e.base())},Si.apply(e,arguments)}function xA(){var e=Wg(ju());return e.copy=function(){return ra(e,xA()).constant(e.constant())},Si.apply(e,arguments)}function ex(){var e=Gg(ju());return e.copy=function(){return ra(e,ex()).exponent(e.exponent())},Si.apply(e,arguments)}function k5(){return ex.apply(null,arguments).exponent(.5)}function vA(){var e=[],t=br;function r(n){if(n!=null&&!isNaN(n=+n))return t((bl(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Ui),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>bP(e,a/n))},r.copy=function(){return vA(t).domain(e)},Si.apply(r,arguments)}function Du(){var e=0,t=.5,r=1,n=1,i,a,s,o,l,c=br,u,h=!1,m;function d(p){return isNaN(p=+p)?m:(p=.5+((p=+u(p))-a)*(n*p<n*a?o:l),c(h?Math.max(0,Math.min(1,p)):p))}d.domain=function(p){return arguments.length?([e,t,r]=p,i=u(e=+e),a=u(t=+t),s=u(r=+r),o=i===a?0:.5/(a-i),l=a===s?0:.5/(s-a),n=a<i?-1:1,d):[e,t,r]},d.clamp=function(p){return arguments.length?(h=!!p,d):h},d.interpolator=function(p){return arguments.length?(c=p,d):c};function g(p){return function(x){var v,b,y;return arguments.length?([v,b,y]=x,c=YP(p,[v,b,y]),d):[c(0),c(.5),c(1)]}}return d.range=g(zs),d.rangeRound=g(qg),d.unknown=function(p){return arguments.length?(m=p,d):m},function(p){return u=p,i=p(e),a=p(t),s=p(r),o=i===a?0:.5/(a-i),l=a===s?0:.5/(s-a),n=a<i?-1:1,d}}function yA(){var e=ta(Du()(br));return e.copy=function(){return ra(e,yA())},Si.apply(e,arguments)}function wA(){var e=Vg(Du()).domain([.1,1,10]);return e.copy=function(){return ra(e,wA()).base(e.base())},Si.apply(e,arguments)}function bA(){var e=Wg(Du());return e.copy=function(){return ra(e,bA()).constant(e.constant())},Si.apply(e,arguments)}function tx(){var e=Gg(Du());return e.copy=function(){return ra(e,tx()).exponent(e.exponent())},Si.apply(e,arguments)}function R5(){return tx.apply(null,arguments).exponent(.5)}const $Z=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Lg,scaleDiverging:yA,scaleDivergingLog:wA,scaleDivergingPow:tx,scaleDivergingSqrt:R5,scaleDivergingSymlog:bA,scaleIdentity:YN,scaleImplicit:fp,scaleLinear:GN,scaleLog:KN,scaleOrdinal:Mg,scalePoint:TP,scalePow:Yg,scaleQuantile:JN,scaleQuantize:eA,scaleRadial:ZN,scaleSequential:pA,scaleSequentialLog:gA,scaleSequentialPow:ex,scaleSequentialQuantile:vA,scaleSequentialSqrt:k5,scaleSequentialSymlog:xA,scaleSqrt:xM,scaleSymlog:QN,scaleThreshold:tA,scaleTime:A5,scaleUtc:C5,tickFormat:WN},Symbol.toStringTag,{value:"Module"}));var Td,D2;function Pu(){if(D2)return Td;D2=1;var e=Us();function t(r,n,i){for(var a=-1,s=r.length;++a<s;){var o=r[a],l=n(o);if(l!=null&&(c===void 0?l===l&&!e(l):i(l,c)))var c=l,u=o}return u}return Td=t,Td}var Ed,P2;function _A(){if(P2)return Ed;P2=1;function e(t,r){return t>r}return Ed=e,Ed}var Nd,M2;function O5(){if(M2)return Nd;M2=1;var e=Pu(),t=_A(),r=qs();function n(i){return i&&i.length?e(i,r,t):void 0}return Nd=n,Nd}var F5=O5();const VZ=Xe(F5);var Ad,L2;function SA(){if(L2)return Ad;L2=1;function e(t,r){return t<r}return Ad=e,Ad}var Cd,B2;function I5(){if(B2)return Cd;B2=1;var e=Pu(),t=SA(),r=qs();function n(i){return i&&i.length?e(i,r,t):void 0}return Cd=n,Cd}var j5=I5();const WZ=Xe(j5);var kd,U2;function D5(){if(U2)return kd;U2=1;var e=Ng(),t=Qn(),r=jN(),n=Or();function i(a,s){var o=n(a)?e:r;return o(a,t(s,3))}return kd=i,kd}var Rd,q2;function P5(){if(q2)return Rd;q2=1;var e=FN(),t=D5();function r(n,i){return e(t(n,i),1)}return Rd=r,Rd}var M5=P5();const GZ=Xe(M5);var Od,z2;function L5(){if(z2)return Od;z2=1;var e=jg();function t(r,n){return e(r,n)}return Od=t,Od}var B5=L5();const YZ=Xe(B5);var Hs=1e9,U5={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},nx,_t=!0,on="[DecimalError] ",Ca=on+"Invalid argument: ",rx=on+"Exponent out of range: ",$s=Math.floor,ma=Math.pow,q5=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Hr,Wt=1e7,xt=7,TA=9007199254740991,Vc=$s(TA/xt),ke={};ke.absoluteValue=ke.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ke.comparedTo=ke.cmp=function(e){var t,r,n,i,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(n=a.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};ke.decimalPlaces=ke.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*xt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};ke.dividedBy=ke.div=function(e){return li(this,new this.constructor(e))};ke.dividedToIntegerBy=ke.idiv=function(e){var t=this,r=t.constructor;return dt(li(t,new r(e),0,1),r.precision)};ke.equals=ke.eq=function(e){return!this.cmp(e)};ke.exponent=function(){return Mt(this)};ke.greaterThan=ke.gt=function(e){return this.cmp(e)>0};ke.greaterThanOrEqualTo=ke.gte=function(e){return this.cmp(e)>=0};ke.isInteger=ke.isint=function(){return this.e>this.d.length-2};ke.isNegative=ke.isneg=function(){return this.s<0};ke.isPositive=ke.ispos=function(){return this.s>0};ke.isZero=function(){return this.s===0};ke.lessThan=ke.lt=function(e){return this.cmp(e)<0};ke.lessThanOrEqualTo=ke.lte=function(e){return this.cmp(e)<1};ke.logarithm=ke.log=function(e){var t,r=this,n=r.constructor,i=n.precision,a=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Hr))throw Error(on+"NaN");if(r.s<1)throw Error(on+(r.s?"NaN":"-Infinity"));return r.eq(Hr)?new n(0):(_t=!1,t=li(Zo(r,a),Zo(e,a),a),_t=!0,dt(t,i))};ke.minus=ke.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?AA(t,e):EA(t,(e.s=-e.s,e))};ke.modulo=ke.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(on+"NaN");return r.s?(_t=!1,t=li(r,e,0,1).times(e),_t=!0,r.minus(t)):dt(new n(r),i)};ke.naturalExponential=ke.exp=function(){return NA(this)};ke.naturalLogarithm=ke.ln=function(){return Zo(this)};ke.negated=ke.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ke.plus=ke.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?EA(t,e):AA(t,(e.s=-e.s,e))};ke.precision=ke.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ca+e);if(t=Mt(i)+1,n=i.d.length-1,r=n*xt+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};ke.squareRoot=ke.sqrt=function(){var e,t,r,n,i,a,s,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(on+"NaN")}for(e=Mt(o),_t=!1,i=Math.sqrt(+o),i==0||i==1/0?(t=zn(o.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=$s((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new l(t)):n=new l(i.toString()),r=l.precision,i=s=r+3;;)if(a=n,n=a.plus(li(o,a,s+2)).times(.5),zn(a.d).slice(0,s)===(t=zn(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),i==s&&t=="4999"){if(dt(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(t!="9999")break;s+=4}return _t=!0,dt(n,r)};ke.times=ke.mul=function(e){var t,r,n,i,a,s,o,l,c,u=this,h=u.constructor,m=u.d,d=(e=new h(e)).d;if(!u.s||!e.s)return new h(0);for(e.s*=u.s,r=u.e+e.e,l=m.length,c=d.length,l<c&&(a=m,m=d,d=a,s=l,l=c,c=s),a=[],s=l+c,n=s;n--;)a.push(0);for(n=c;--n>=0;){for(t=0,i=l+n;i>n;)o=a[i]+d[n]*m[i-n-1]+t,a[i--]=o%Wt|0,t=o/Wt|0;a[i]=(a[i]+t)%Wt|0}for(;!a[--s];)a.pop();return t?++r:a.shift(),e.d=a,e.e=r,_t?dt(e,h.precision):e};ke.toDecimalPlaces=ke.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Wn(e,0,Hs),t===void 0?t=n.rounding:Wn(t,0,8),dt(r,e+Mt(r)+1,t))};ke.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=ja(n,!0):(Wn(e,0,Hs),t===void 0?t=i.rounding:Wn(t,0,8),n=dt(new i(n),e+1,t),r=ja(n,!0,e+1)),r};ke.toFixed=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?ja(i):(Wn(e,0,Hs),t===void 0?t=a.rounding:Wn(t,0,8),n=dt(new a(i),e+Mt(i)+1,t),r=ja(n.abs(),!1,e+Mt(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};ke.toInteger=ke.toint=function(){var e=this,t=e.constructor;return dt(new t(e),Mt(e)+1,t.rounding)};ke.toNumber=function(){return+this};ke.toPower=ke.pow=function(e){var t,r,n,i,a,s,o=this,l=o.constructor,c=12,u=+(e=new l(e));if(!e.s)return new l(Hr);if(o=new l(o),!o.s){if(e.s<1)throw Error(on+"Infinity");return o}if(o.eq(Hr))return o;if(n=l.precision,e.eq(Hr))return dt(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,a=o.s,s){if((r=u<0?-u:u)<=TA){for(i=new l(Hr),t=Math.ceil(n/xt+4),_t=!1;r%2&&(i=i.times(o),$2(i.d,t)),r=$s(r/2),r!==0;)o=o.times(o),$2(o.d,t);return _t=!0,e.s<0?new l(Hr).div(i):dt(i,n)}}else if(a<0)throw Error(on+"NaN");return a=a<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,_t=!1,i=e.times(Zo(o,n+c)),_t=!0,i=NA(i),i.s=a,i};ke.toPrecision=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?(r=Mt(i),n=ja(i,r<=a.toExpNeg||r>=a.toExpPos)):(Wn(e,1,Hs),t===void 0?t=a.rounding:Wn(t,0,8),i=dt(new a(i),e,t),r=Mt(i),n=ja(i,e<=r||r<=a.toExpNeg,e)),n};ke.toSignificantDigits=ke.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Wn(e,1,Hs),t===void 0?t=n.rounding:Wn(t,0,8)),dt(new n(r),e,t)};ke.toString=ke.valueOf=ke.val=ke.toJSON=ke[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Mt(e),r=e.constructor;return ja(e,t<=r.toExpNeg||t>=r.toExpPos)};function EA(e,t){var r,n,i,a,s,o,l,c,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),_t?dt(t,h):t;if(l=e.d,c=t.d,s=e.e,i=t.e,l=l.slice(),a=s-i,a){for(a<0?(n=l,a=-a,o=c.length):(n=c,i=s,o=l.length),s=Math.ceil(h/xt),o=s>o?s+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=l.length,a=c.length,o-a<0&&(a=o,n=c,c=l,l=n),r=0;a;)r=(l[--a]=l[a]+c[a]+r)/Wt|0,l[a]%=Wt;for(r&&(l.unshift(r),++i),o=l.length;l[--o]==0;)l.pop();return t.d=l,t.e=i,_t?dt(t,h):t}function Wn(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Ca+e)}function zn(e){var t,r,n,i=e.length-1,a="",s=e[0];if(i>0){for(a+=s,t=1;t<i;t++)n=e[t]+"",r=xt-n.length,r&&(a+=Ri(r)),a+=n;s=e[t],n=s+"",r=xt-n.length,r&&(a+=Ri(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}var li=(function(){function e(n,i){var a,s=0,o=n.length;for(n=n.slice();o--;)a=n[o]*i+s,n[o]=a%Wt|0,s=a/Wt|0;return s&&n.unshift(s),n}function t(n,i,a,s){var o,l;if(a!=s)l=a>s?1:-1;else for(o=l=0;o<a;o++)if(n[o]!=i[o]){l=n[o]>i[o]?1:-1;break}return l}function r(n,i,a){for(var s=0;a--;)n[a]-=s,s=n[a]<i[a]?1:0,n[a]=s*Wt+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,s){var o,l,c,u,h,m,d,g,p,x,v,b,y,w,k,T,S,E,A=n.constructor,R=n.s==i.s?1:-1,C=n.d,j=i.d;if(!n.s)return new A(n);if(!i.s)throw Error(on+"Division by zero");for(l=n.e-i.e,S=j.length,k=C.length,d=new A(R),g=d.d=[],c=0;j[c]==(C[c]||0);)++c;if(j[c]>(C[c]||0)&&--l,a==null?b=a=A.precision:s?b=a+(Mt(n)-Mt(i))+1:b=a,b<0)return new A(0);if(b=b/xt+2|0,c=0,S==1)for(u=0,j=j[0],b++;(c<k||u)&&b--;c++)y=u*Wt+(C[c]||0),g[c]=y/j|0,u=y%j|0;else{for(u=Wt/(j[0]+1)|0,u>1&&(j=e(j,u),C=e(C,u),S=j.length,k=C.length),w=S,p=C.slice(0,S),x=p.length;x<S;)p[x++]=0;E=j.slice(),E.unshift(0),T=j[0],j[1]>=Wt/2&&++T;do u=0,o=t(j,p,S,x),o<0?(v=p[0],S!=x&&(v=v*Wt+(p[1]||0)),u=v/T|0,u>1?(u>=Wt&&(u=Wt-1),h=e(j,u),m=h.length,x=p.length,o=t(h,p,m,x),o==1&&(u--,r(h,S<m?E:j,m))):(u==0&&(o=u=1),h=j.slice()),m=h.length,m<x&&h.unshift(0),r(p,h,x),o==-1&&(x=p.length,o=t(j,p,S,x),o<1&&(u++,r(p,S<x?E:j,x))),x=p.length):o===0&&(u++,p=[0]),g[c++]=u,o&&p[0]?p[x++]=C[w]||0:(p=[C[w]],x=1);while((w++<k||p[0]!==void 0)&&b--)}return g[0]||g.shift(),d.e=l,dt(d,s?a+Mt(d)+1:a)}})();function NA(e,t){var r,n,i,a,s,o,l=0,c=0,u=e.constructor,h=u.precision;if(Mt(e)>16)throw Error(rx+Mt(e));if(!e.s)return new u(Hr);for(_t=!1,o=h,s=new u(.03125);e.abs().gte(.1);)e=e.times(s),c+=5;for(n=Math.log(ma(2,c))/Math.LN10*2+5|0,o+=n,r=i=a=new u(Hr),u.precision=o;;){if(i=dt(i.times(e),o),r=r.times(++l),s=a.plus(li(i,r,o)),zn(s.d).slice(0,o)===zn(a.d).slice(0,o)){for(;c--;)a=dt(a.times(a),o);return u.precision=h,t==null?(_t=!0,dt(a,h)):a}a=s}}function Mt(e){for(var t=e.e*xt,r=e.d[0];r>=10;r/=10)t++;return t}function Fd(e,t,r){if(t>e.LN10.sd())throw _t=!0,r&&(e.precision=r),Error(on+"LN10 precision limit exceeded");return dt(new e(e.LN10),t)}function Ri(e){for(var t="";e--;)t+="0";return t}function Zo(e,t){var r,n,i,a,s,o,l,c,u,h=1,m=10,d=e,g=d.d,p=d.constructor,x=p.precision;if(d.s<1)throw Error(on+(d.s?"NaN":"-Infinity"));if(d.eq(Hr))return new p(0);if(t==null?(_t=!1,c=x):c=t,d.eq(10))return t==null&&(_t=!0),Fd(p,c);if(c+=m,p.precision=c,r=zn(g),n=r.charAt(0),a=Mt(d),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)d=d.times(e),r=zn(d.d),n=r.charAt(0),h++;a=Mt(d),n>1?(d=new p("0."+r),a++):d=new p(n+"."+r.slice(1))}else return l=Fd(p,c+2,x).times(a+""),d=Zo(new p(n+"."+r.slice(1)),c-m).plus(l),p.precision=x,t==null?(_t=!0,dt(d,x)):d;for(o=s=d=li(d.minus(Hr),d.plus(Hr),c),u=dt(d.times(d),c),i=3;;){if(s=dt(s.times(u),c),l=o.plus(li(s,new p(i),c)),zn(l.d).slice(0,c)===zn(o.d).slice(0,c))return o=o.times(2),a!==0&&(o=o.plus(Fd(p,c+2,x).times(a+""))),o=li(o,new p(h),c),p.precision=x,t==null?(_t=!0,dt(o,x)):o;o=l,i+=2}}function H2(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=$s(r/xt),e.d=[],n=(r+1)%xt,r<0&&(n+=xt),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=xt;n<i;)e.d.push(+t.slice(n,n+=xt));t=t.slice(n),n=xt-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),_t&&(e.e>Vc||e.e<-Vc))throw Error(rx+r)}else e.s=0,e.e=0,e.d=[0];return e}function dt(e,t,r){var n,i,a,s,o,l,c,u,h=e.d;for(s=1,a=h[0];a>=10;a/=10)s++;if(n=t-s,n<0)n+=xt,i=t,c=h[u=0];else{if(u=Math.ceil((n+1)/xt),a=h.length,u>=a)return e;for(c=a=h[u],s=1;a>=10;a/=10)s++;n%=xt,i=n-xt+s}if(r!==void 0&&(a=ma(10,s-i-1),o=c/a%10|0,l=t<0||h[u+1]!==void 0||c%a,l=r<4?(o||l)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||l||r==6&&(n>0?i>0?c/ma(10,s-i):0:h[u-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return l?(a=Mt(e),h.length=1,t=t-a-1,h[0]=ma(10,(xt-t%xt)%xt),e.e=$s(-t/xt)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(n==0?(h.length=u,a=1,u--):(h.length=u+1,a=ma(10,xt-n),h[u]=i>0?(c/ma(10,s-i)%ma(10,i)|0)*a:0),l)for(;;)if(u==0){(h[0]+=a)==Wt&&(h[0]=1,++e.e);break}else{if(h[u]+=a,h[u]!=Wt)break;h[u--]=0,a=1}for(n=h.length;h[--n]===0;)h.pop();if(_t&&(e.e>Vc||e.e<-Vc))throw Error(rx+Mt(e));return e}function AA(e,t){var r,n,i,a,s,o,l,c,u,h,m=e.constructor,d=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),_t?dt(t,d):t;if(l=e.d,h=t.d,n=t.e,c=e.e,l=l.slice(),s=c-n,s){for(u=s<0,u?(r=l,s=-s,o=h.length):(r=h,n=c,o=l.length),i=Math.max(Math.ceil(d/xt),o)+2,s>i&&(s=i,r.length=1),r.reverse(),i=s;i--;)r.push(0);r.reverse()}else{for(i=l.length,o=h.length,u=i<o,u&&(o=i),i=0;i<o;i++)if(l[i]!=h[i]){u=l[i]<h[i];break}s=0}for(u&&(r=l,l=h,h=r,t.s=-t.s),o=l.length,i=h.length-o;i>0;--i)l[o++]=0;for(i=h.length;i>s;){if(l[--i]<h[i]){for(a=i;a&&l[--a]===0;)l[a]=Wt-1;--l[a],l[i]+=Wt}l[i]-=h[i]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(t.d=l,t.e=n,_t?dt(t,d):t):new m(0)}function ja(e,t,r){var n,i=Mt(e),a=zn(e.d),s=a.length;return t?(r&&(n=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+Ri(n):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+Ri(-i-1)+a,r&&(n=r-s)>0&&(a+=Ri(n))):i>=s?(a+=Ri(i+1-s),r&&(n=r-i-1)>0&&(a=a+"."+Ri(n))):((n=i+1)<s&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(a+="."),a+=Ri(n))),e.s<0?"-"+a:a}function $2(e,t){if(e.length>t)return e.length=t,!0}function CA(e){var t,r,n;function i(a){var s=this;if(!(s instanceof i))return new i(a);if(s.constructor=i,a instanceof i){s.s=a.s,s.e=a.e,s.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Ca+a);if(a>0)s.s=1;else if(a<0)a=-a,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(a===~~a&&a<1e7){s.e=0,s.d=[a];return}return H2(s,a.toString())}else if(typeof a!="string")throw Error(Ca+a);if(a.charCodeAt(0)===45?(a=a.slice(1),s.s=-1):s.s=1,q5.test(a))H2(s,a);else throw Error(Ca+a)}if(i.prototype=ke,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=CA,i.config=i.set=z5,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function z5(e){if(!e||typeof e!="object")throw Error(on+"Object expected");var t,r,n,i=["precision",1,Hs,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if($s(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(Ca+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Ca+r+": "+n);return this}var nx=CA(U5);Hr=new nx(1);const XZ=nx;var H5="Invariant failed";function KZ(e,t){throw new Error(H5)}var Id,V2;function $5(){if(V2)return Id;V2=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return Id=e,Id}var V5=$5();const QZ=Xe(V5);var jd={exports:{}},Dd,W2;function W5(){if(W2)return Dd;W2=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Dd=e,Dd}var Pd,G2;function G5(){if(G2)return Pd;G2=1;var e=W5();function t(){}function r(){}return r.resetWarningCache=t,Pd=function(){function n(s,o,l,c,u,h){if(h!==e){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:t};return a.PropTypes=a,a},Pd}var Y2;function Y5(){return Y2||(Y2=1,jd.exports=G5()()),jd.exports}var X5=Y5();const ZZ=Xe(X5);var K5=Object.getOwnPropertyNames,Q5=Object.getOwnPropertySymbols,Z5=Object.prototype.hasOwnProperty;function X2(e,t){return function(n,i,a){return e(n,i,a)&&t(n,i,a)}}function ec(e){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,i);var a=i.cache,s=a.get(r),o=a.get(n);if(s&&o)return s===n&&o===r;a.set(r,n),a.set(n,r);var l=e(r,n,i);return a.delete(r),a.delete(n),l}}function K2(e){return K5(e).concat(Q5(e))}var J5=Object.hasOwn||(function(e,t){return Z5.call(e,t)});function $a(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var e8="__v",t8="__o",r8="_owner",Q2=Object.getOwnPropertyDescriptor,Z2=Object.keys;function n8(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function i8(e,t){return $a(e.getTime(),t.getTime())}function a8(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function s8(e,t){return e===t}function J2(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var i=new Array(n),a=e.entries(),s,o,l=0;(s=a.next())&&!s.done;){for(var c=t.entries(),u=!1,h=0;(o=c.next())&&!o.done;){if(i[h]){h++;continue}var m=s.value,d=o.value;if(r.equals(m[0],d[0],l,h,e,t,r)&&r.equals(m[1],d[1],m[0],d[0],e,t,r)){u=i[h]=!0;break}h++}if(!u)return!1;l++}return!0}var o8=$a;function l8(e,t,r){var n=Z2(e),i=n.length;if(Z2(t).length!==i)return!1;for(;i-- >0;)if(!kA(e,t,r,n[i]))return!1;return!0}function lo(e,t,r){var n=K2(e),i=n.length;if(K2(t).length!==i)return!1;for(var a,s,o;i-- >0;)if(a=n[i],!kA(e,t,r,a)||(s=Q2(e,a),o=Q2(t,a),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function c8(e,t){return $a(e.valueOf(),t.valueOf())}function u8(e,t){return e.source===t.source&&e.flags===t.flags}function eb(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var i=new Array(n),a=e.values(),s,o;(s=a.next())&&!s.done;){for(var l=t.values(),c=!1,u=0;(o=l.next())&&!o.done;){if(!i[u]&&r.equals(s.value,o.value,s.value,o.value,e,t,r)){c=i[u]=!0;break}u++}if(!c)return!1}return!0}function f8(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function h8(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function kA(e,t,r,n){return(n===r8||n===t8||n===e8)&&(e.$$typeof||t.$$typeof)?!0:J5(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var d8="[object Arguments]",m8="[object Boolean]",p8="[object Date]",g8="[object Error]",x8="[object Map]",v8="[object Number]",y8="[object Object]",w8="[object RegExp]",b8="[object Set]",_8="[object String]",S8="[object URL]",T8=Array.isArray,tb=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,rb=Object.assign,E8=Object.prototype.toString.call.bind(Object.prototype.toString);function N8(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,i=e.areFunctionsEqual,a=e.areMapsEqual,s=e.areNumbersEqual,o=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,c=e.areRegExpsEqual,u=e.areSetsEqual,h=e.areTypedArraysEqual,m=e.areUrlsEqual;return function(g,p,x){if(g===p)return!0;if(g==null||p==null)return!1;var v=typeof g;if(v!==typeof p)return!1;if(v!=="object")return v==="number"?s(g,p,x):v==="function"?i(g,p,x):!1;var b=g.constructor;if(b!==p.constructor)return!1;if(b===Object)return o(g,p,x);if(T8(g))return t(g,p,x);if(tb!=null&&tb(g))return h(g,p,x);if(b===Date)return r(g,p,x);if(b===RegExp)return c(g,p,x);if(b===Map)return a(g,p,x);if(b===Set)return u(g,p,x);var y=E8(g);return y===p8?r(g,p,x):y===w8?c(g,p,x):y===x8?a(g,p,x):y===b8?u(g,p,x):y===y8?typeof g.then!="function"&&typeof p.then!="function"&&o(g,p,x):y===S8?m(g,p,x):y===g8?n(g,p,x):y===d8?o(g,p,x):y===m8||y===v8||y===_8?l(g,p,x):!1}}function A8(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,i={areArraysEqual:n?lo:n8,areDatesEqual:i8,areErrorsEqual:a8,areFunctionsEqual:s8,areMapsEqual:n?X2(J2,lo):J2,areNumbersEqual:o8,areObjectsEqual:n?lo:l8,arePrimitiveWrappersEqual:c8,areRegExpsEqual:u8,areSetsEqual:n?X2(eb,lo):eb,areTypedArraysEqual:n?lo:f8,areUrlsEqual:h8};if(r&&(i=rb({},i,r(i))),t){var a=ec(i.areArraysEqual),s=ec(i.areMapsEqual),o=ec(i.areObjectsEqual),l=ec(i.areSetsEqual);i=rb({},i,{areArraysEqual:a,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:l})}return i}function C8(e){return function(t,r,n,i,a,s,o){return e(t,r,o)}}function k8(e){var t=e.circular,r=e.comparator,n=e.createState,i=e.equals,a=e.strict;if(n)return function(l,c){var u=n(),h=u.cache,m=h===void 0?t?new WeakMap:void 0:h,d=u.meta;return r(l,c,{cache:m,equals:i,meta:d,strict:a})};if(t)return function(l,c){return r(l,c,{cache:new WeakMap,equals:i,meta:void 0,strict:a})};var s={cache:void 0,equals:i,meta:void 0,strict:a};return function(l,c){return r(l,c,s)}}var JZ=na();na({strict:!0});na({circular:!0});na({circular:!0,strict:!0});na({createInternalComparator:function(){return $a}});na({strict:!0,createInternalComparator:function(){return $a}});na({circular:!0,createInternalComparator:function(){return $a}});na({circular:!0,createInternalComparator:function(){return $a},strict:!0});function na(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,i=e.createState,a=e.strict,s=a===void 0?!1:a,o=A8(e),l=N8(o),c=n?n(l):C8(l);return k8({circular:r,comparator:l,createState:i,equals:c,strict:s})}var Md,nb;function R8(){if(nb)return Md;nb=1;var e=Pu(),t=_A(),r=Qn();function n(i,a){return i&&i.length?e(i,r(a,2),t):void 0}return Md=n,Md}var O8=R8();const eJ=Xe(O8);var Ld,ib;function F8(){if(ib)return Ld;ib=1;var e=Pu(),t=Qn(),r=SA();function n(i,a){return i&&i.length?e(i,t(a,2),r):void 0}return Ld=n,Ld}var I8=F8();const tJ=Xe(I8);var Bd,ab;function j8(){if(ab)return Bd;ab=1;var e=AN(),t=e(Object.getPrototypeOf,Object);return Bd=t,Bd}var Ud,sb;function D8(){if(sb)return Ud;sb=1;var e=bi(),t=j8(),r=_i(),n="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,l=s.call(Object);function c(u){if(!r(u)||e(u)!=n)return!1;var h=t(u);if(h===null)return!0;var m=o.call(h,"constructor")&&h.constructor;return typeof m=="function"&&m instanceof m&&s.call(m)==l}return Ud=c,Ud}var P8=D8();const rJ=Xe(P8);var qd,ob;function M8(){if(ob)return qd;ob=1;var e=bi(),t=_i(),r="[object Boolean]";function n(i){return i===!0||i===!1||t(i)&&e(i)==r}return qd=n,qd}var L8=M8();const nJ=Xe(L8);var zd,lb;function B8(){if(lb)return zd;lb=1;function e(t){return t&&t.length?t[0]:void 0}return zd=e,zd}var Hd,cb;function U8(){return cb||(cb=1,Hd=B8()),Hd}var q8=U8();const iJ=Xe(q8);var $d,ub;function z8(){if(ub)return $d;ub=1;var e=Math.ceil,t=Math.max;function r(n,i,a,s){for(var o=-1,l=t(e((i-n)/(a||1)),0),c=Array(l);l--;)c[s?l:++o]=n,n+=a;return c}return $d=r,$d}var Vd,fb;function RA(){if(fb)return Vd;fb=1;var e=PN(),t=1/0,r=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var a=i<0?-1:1;return a*r}return i===i?i:0}return Vd=n,Vd}var Wd,hb;function H8(){if(hb)return Wd;hb=1;var e=z8(),t=Ou(),r=RA();function n(i){return function(a,s,o){return o&&typeof o!="number"&&t(a,s,o)&&(s=o=void 0),a=r(a),s===void 0?(s=a,a=0):s=r(s),o=o===void 0?a<s?1:-1:r(o),e(a,s,o,i)}}return Wd=n,Wd}var Gd,db;function $8(){if(db)return Gd;db=1;var e=H8(),t=e();return Gd=t,Gd}var V8=$8();const aJ=Xe(V8);var Yd,mb;function W8(){if(mb)return Yd;mb=1;var e=Dg();function t(r,n){var i;return e(r,function(a,s,o){return i=n(a,s,o),!i}),!!i}return Yd=t,Yd}var Xd,pb;function G8(){if(pb)return Xd;pb=1;var e=wN(),t=Qn(),r=W8(),n=Or(),i=Ou();function a(s,o,l){var c=n(s)?e:r;return l&&i(s,o,l)&&(o=void 0),c(s,t(o,3))}return Xd=a,Xd}var Y8=G8();const sJ=Xe(Y8);var Kd,gb;function X8(){if(gb)return Kd;gb=1;var e=DN();function t(r,n,i){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return Kd=t,Kd}var Qd,xb;function K8(){if(xb)return Qd;xb=1;var e=X8(),t=IN(),r=Qn();function n(i,a){var s={};return a=r(a,3),t(i,function(o,l,c){e(s,l,a(o,l,c))}),s}return Qd=n,Qd}var Q8=K8();const oJ=Xe(Q8);var Zd,vb;function Z8(){if(vb)return Zd;vb=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(!r(t[n],n,t))return!1;return!0}return Zd=e,Zd}var Jd,yb;function J8(){if(yb)return Jd;yb=1;var e=Dg();function t(r,n){var i=!0;return e(r,function(a,s,o){return i=!!n(a,s,o),i}),i}return Jd=t,Jd}var em,wb;function e6(){if(wb)return em;wb=1;var e=Z8(),t=J8(),r=Qn(),n=Or(),i=Ou();function a(s,o,l){var c=n(s)?e:t;return l&&i(s,o,l)&&(o=void 0),c(s,r(o,3))}return em=a,em}var t6=e6();const lJ=Xe(t6);var tm,bb;function r6(){if(bb)return tm;bb=1;var e=Qn(),t=wl(),r=Ru();function n(i){return function(a,s,o){var l=Object(a);if(!t(a)){var c=e(s,3);a=r(a),s=function(h){return c(l[h],h,l)}}var u=i(a,s,o);return u>-1?l[c?a[u]:u]:void 0}}return tm=n,tm}var rm,_b;function n6(){if(_b)return rm;_b=1;var e=RA();function t(r){var n=e(r),i=n%1;return n===n?i?n-i:n:0}return rm=t,rm}var nm,Sb;function i6(){if(Sb)return nm;Sb=1;var e=ON(),t=Qn(),r=n6(),n=Math.max;function i(a,s,o){var l=a==null?0:a.length;if(!l)return-1;var c=o==null?0:r(o);return c<0&&(c=n(l+c,0)),e(a,t(s,3),c)}return nm=i,nm}var im,Tb;function a6(){if(Tb)return im;Tb=1;var e=r6(),t=i6(),r=e(t);return im=r,im}var s6=a6();const cJ=Xe(s6);var o6=KE();const uJ=Xe(o6);var am={exports:{}},Eb;function l6(){return Eb||(Eb=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function a(l,c,u,h,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var d=new i(u,h||l,m),g=r?r+c:c;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],d]:l._events[g].push(d):(l._events[g]=d,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)t.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var m=0,d=h.length,g=new Array(d);m<d;m++)g[m]=h[m].fn;return g},o.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(c,u,h,m,d,g){var p=r?r+c:c;if(!this._events[p])return!1;var x=this._events[p],v=arguments.length,b,y;if(x.fn){switch(x.once&&this.removeListener(c,x.fn,void 0,!0),v){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,h),!0;case 4:return x.fn.call(x.context,u,h,m),!0;case 5:return x.fn.call(x.context,u,h,m,d),!0;case 6:return x.fn.call(x.context,u,h,m,d,g),!0}for(y=1,b=new Array(v-1);y<v;y++)b[y-1]=arguments[y];x.fn.apply(x.context,b)}else{var w=x.length,k;for(y=0;y<w;y++)switch(x[y].once&&this.removeListener(c,x[y].fn,void 0,!0),v){case 1:x[y].fn.call(x[y].context);break;case 2:x[y].fn.call(x[y].context,u);break;case 3:x[y].fn.call(x[y].context,u,h);break;case 4:x[y].fn.call(x[y].context,u,h,m);break;default:if(!b)for(k=1,b=new Array(v-1);k<v;k++)b[k-1]=arguments[k];x[y].fn.apply(x[y].context,b)}}return!0},o.prototype.on=function(c,u,h){return a(this,c,u,h,!1)},o.prototype.once=function(c,u,h){return a(this,c,u,h,!0)},o.prototype.removeListener=function(c,u,h,m){var d=r?r+c:c;if(!this._events[d])return this;if(!u)return s(this,d),this;var g=this._events[d];if(g.fn)g.fn===u&&(!m||g.once)&&(!h||g.context===h)&&s(this,d);else{for(var p=0,x=[],v=g.length;p<v;p++)(g[p].fn!==u||m&&!g[p].once||h&&g[p].context!==h)&&x.push(g[p]);x.length?this._events[d]=x.length===1?x[0]:x:s(this,d)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(am)),am.exports}var c6=l6();const fJ=Xe(c6),hJ=({data:e,title:t="Performance Trends",description:r="Average ratings over time"})=>{const n=({active:i,payload:a,label:s})=>i&&a&&a.length?f.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg",children:[f.jsx("p",{className:"font-medium text-foreground mb-2",children:s}),a.map((o,l)=>f.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:o.color}}),f.jsxs("span",{className:"text-muted-foreground",children:[o.name,":"]}),f.jsx("span",{className:"font-medium text-foreground",children:o.value})]},l))]}):null;return f.jsxs(Fe,{className:"w-full offscreen-content layout-contained",children:[f.jsxs(ze,{children:[f.jsxs(He,{className:"flex items-center gap-2 text-foreground",children:[f.jsx(Ms,{className:"w-5 h-5 text-primary"}),t]}),f.jsx(nt,{className:"text-muted-foreground",children:r})]}),f.jsx(je,{children:f.jsx("div",{className:"h-80 w-full",children:f.jsx(lg,{width:"100%",height:"100%",children:f.jsxs(qR,{data:e,margin:{top:5,right:30,left:20,bottom:5},children:[f.jsx(aE,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.3}),f.jsx(sE,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1}),f.jsx(oE,{domain:[1,5],stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1}),f.jsx(lE,{content:f.jsx(n,{})}),f.jsx(cE,{}),f.jsx(f1,{type:"monotone",dataKey:"averageRating",stroke:"hsl(var(--chart-1))",strokeWidth:3,dot:{fill:"hsl(var(--chart-1))",strokeWidth:2,r:4},activeDot:{r:6,stroke:"hsl(var(--chart-1))",strokeWidth:2}}),f.jsx(f1,{type:"monotone",dataKey:"totalInspections",stroke:"hsl(var(--chart-2))",strokeWidth:2,strokeDasharray:"5 5",dot:{fill:"hsl(var(--chart-2))",strokeWidth:2,r:3}})]})})})})]})},dJ=({data:e,title:t="School Performance Comparison",description:r="Average ratings and inspection counts by school",showThresholds:n=!0})=>{const i=({active:a,payload:s,label:o})=>a&&s&&s.length?f.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg",children:[f.jsx("p",{className:"font-medium text-foreground mb-2",children:o}),s.map((l,c)=>f.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:l.color}}),f.jsxs("span",{className:"text-muted-foreground",children:[l.name,":"]}),f.jsx("span",{className:"font-medium text-foreground",children:l.value})]},c))]}):null;return f.jsxs(Fe,{className:"w-full offscreen-content layout-contained",children:[f.jsxs(ze,{children:[f.jsxs(He,{className:"flex items-center gap-2 text-foreground",children:[f.jsx(an,{className:"w-5 h-5 text-primary"}),t]}),f.jsx(nt,{className:"text-muted-foreground",children:r})]}),f.jsxs(je,{children:[f.jsx("div",{className:"h-80 w-full",children:f.jsx(lg,{width:"100%",height:"100%",children:f.jsxs(zR,{data:e,margin:{top:20,right:30,left:20,bottom:5},children:[f.jsx(aE,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.3}),f.jsx(sE,{dataKey:"school",stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1,angle:-45,textAnchor:"end",height:80}),f.jsx(oE,{stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1}),f.jsx(lE,{content:f.jsx(i,{})}),f.jsx(cE,{}),n&&f.jsxs(f.Fragment,{children:[f.jsx(h1,{y:3,stroke:"#10B981",strokeDasharray:"5 5",strokeWidth:2,label:{value:"Acceptable (3.0)",position:"top"}}),f.jsx(h1,{y:2,stroke:"#EF4444",strokeDasharray:"5 5",strokeWidth:2,label:{value:"Critical (2.0)",position:"top"}})]}),f.jsx(d1,{dataKey:"averageRating",fill:"hsl(var(--chart-1))",name:"Average Rating",radius:[2,2,0,0]}),f.jsx(d1,{dataKey:"totalInspections",fill:"hsl(var(--chart-2))",name:"Total Inspections",radius:[2,2,0,0]})]})})}),n&&f.jsxs("div",{className:"mt-4 flex items-center gap-4 text-sm text-muted-foreground",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-4 h-0.5 bg-green-500 border-dashed border-t-2"}),f.jsx("span",{children:"Acceptable Threshold (3.0)"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-4 h-0.5 bg-red-500 border-dashed border-t-2"}),f.jsx("span",{children:"Critical Threshold (2.0)"})]})]})]})]})},mJ=({data:e,title:t="Category Performance Analysis",description:r="Performance ratings across all inspection categories",showProblemHighlighting:n=!0})=>{const i=s=>s<2?{level:"critical",color:"#EF4444",icon:nn}:s<3?{level:"needs-attention",color:"#F59E0B",icon:_r}:{level:"acceptable",color:"#10B981",icon:En},a=s=>{const{payload:o,x:l,y:c,textAnchor:u}=s,h=e.find(d=>d.category===o.value),m=h?i(h.rating):null;return f.jsxs("g",{transform:`translate(${l},${c})`,children:[f.jsx("text",{x:0,y:0,dy:16,textAnchor:u,fontSize:12,fill:(m==null?void 0:m.color)||"hsl(var(--muted-foreground))",fontWeight:n&&(m==null?void 0:m.level)!=="acceptable"?"bold":"normal",children:o.value}),n&&(m==null?void 0:m.level)!=="acceptable"&&f.jsx("circle",{cx:-20,cy:0,r:4,fill:(m==null?void 0:m.color)||"#EF4444"})]})};return f.jsxs(Fe,{className:"w-full offscreen-content layout-contained",children:[f.jsxs(ze,{children:[f.jsxs(He,{className:"flex items-center gap-2 text-foreground",children:[f.jsx(UT,{className:"w-5 h-5 text-primary"}),t]}),f.jsx(nt,{className:"text-muted-foreground",children:r})]}),f.jsxs(je,{children:[f.jsx("div",{className:"h-80 w-full",children:f.jsx(lg,{width:"100%",height:"100%",children:f.jsxs(HR,{data:e,margin:{top:20,right:30,left:20,bottom:5},children:[f.jsx($R,{stroke:"hsl(var(--border))",opacity:.3}),f.jsx(VR,{dataKey:"category",tick:f.jsx(a,{})}),f.jsx(WR,{domain:[0,5],tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},axisLine:!1}),f.jsx(GR,{name:"Performance",dataKey:"rating",stroke:"hsl(var(--chart-1))",fill:"hsl(var(--chart-1))",fillOpacity:.2,strokeWidth:2})]})})}),n&&f.jsxs("div",{className:"mt-4 space-y-3",children:[f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:e.map(s=>{const o=i(s.rating);return o.level==="acceptable"?null:f.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted/50",children:[f.jsx(o.icon,{className:"w-4 h-4",style:{color:o.color}}),f.jsx("span",{className:"font-medium",children:s.category}),f.jsxs("span",{className:"text-muted-foreground",children:["(",s.rating.toFixed(1),")"]})]},s.category)})}),f.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(nn,{className:"w-4 h-4 text-red-500"}),f.jsx("span",{children:"Critical (< 2.0)"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(_r,{className:"w-4 h-4 text-orange-500"}),f.jsx("span",{children:"Needs Attention (2.0-3.0)"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(En,{className:"w-4 h-4 text-green-500"}),f.jsx("span",{children:"Acceptable (> 3.0)"})]})]})]})]})]})},pJ=({title:e,value:t,description:r,trend:n,icon:i,color:a="primary",className:s=""})=>{const l=(h=>{switch(h){case"primary":return{text:"text-primary",bg:"bg-primary/10",border:"border-primary/20"};case"secondary":return{text:"text-secondary",bg:"bg-secondary/10",border:"border-secondary/20"};case"success":return{text:"text-green-600",bg:"bg-green-50",border:"border-green-200"};case"warning":return{text:"text-yellow-600",bg:"bg-yellow-50",border:"border-yellow-200"};case"destructive":return{text:"text-destructive",bg:"bg-destructive/10",border:"border-destructive/20"};default:return{text:"text-primary",bg:"bg-primary/10",border:"border-primary/20"}}})(a),c=h=>h>0?f.jsx(Ms,{className:"w-4 h-4"}):h<0?f.jsx(og,{className:"w-4 h-4"}):f.jsx(iR,{className:"w-4 h-4"}),u=h=>h>0?"text-green-600":h<0?"text-red-600":"text-muted-foreground";return f.jsxs(Fe,{className:s,children:[f.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsx(He,{className:"text-sm font-medium text-muted-foreground",children:e}),i&&f.jsx("div",{className:`p-2 rounded-lg ${l.bg} ${l.border} border`,children:f.jsx(i,{className:`w-4 h-4 ${l.text}`})})]}),f.jsx(je,{children:f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"text-2xl font-bold text-foreground",children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),n&&f.jsxs("div",{className:`flex items-center gap-1 text-sm ${u(n.value)}`,children:[c(n.value),f.jsxs("span",{className:"font-medium",children:[n.value>0?"+":"",n.value,"%"]}),f.jsx("span",{className:"text-muted-foreground",children:n.period})]})]})})]})},gJ=({data:e,title:t="Room Performance Heatmap",description:r="Visual overview of room performance ratings",maxRoomsPerRow:n=8,onRoomClick:i})=>{const[a,s]=H.useState(null),o=m=>m>=4.5?"bg-green-100 text-green-800 border-green-200":m>=3.5?"bg-yellow-100 text-yellow-800 border-yellow-200":m>=2.5?"bg-orange-100 text-orange-800 border-orange-200":"bg-red-100 text-red-800 border-red-200",l=m=>m>=4.5?"Excellent":m>=3.5?"Good":m>=2.5?"Fair":"Needs Attention",c=m=>m<2?{level:"critical",color:"#EF4444",icon:nn}:m<3?{level:"needs-attention",color:"#F59E0B",icon:_r}:{level:"acceptable",color:"#10B981",icon:En},u=m=>{s(m),i==null||i(m)},h=e.reduce((m,d)=>(m[d.school]||(m[d.school]=[]),m[d.school].push(d),m),{});return f.jsxs(Fe,{className:"w-full offscreen-content layout-contained",children:[f.jsxs(ze,{children:[f.jsxs(He,{className:"flex items-center gap-2 text-foreground",children:[f.jsx(Ym,{className:"w-5 h-5 text-primary"}),t]}),f.jsx(nt,{className:"text-muted-foreground",children:r})]}),f.jsx(je,{children:f.jsxs("div",{className:"space-y-6",children:[Object.entries(h).map(([m,d])=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(an,{className:"w-4 h-4 text-muted-foreground"}),f.jsx("h3",{className:"font-medium text-foreground",children:m}),f.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",d.length," rooms)"]})]}),f.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${Math.min(n,d.length)}, 1fr)`},children:d.map(g=>f.jsxs(_u,{children:[f.jsx(HE,{asChild:!0,children:f.jsxs("div",{className:`
                          p-3 text-center text-xs rounded-lg border-2 transition-all duration-200 hover:scale-105 cursor-pointer
                          ${o(g.rating)}
                        `,title:`Room ${g.number}: ${g.rating.toFixed(1)}/5 - ${l(g.rating)}`,onClick:()=>u(g),children:[f.jsx("div",{className:"font-bold text-sm mb-1",children:g.number}),f.jsx("div",{className:"text-xs opacity-75",children:g.rating.toFixed(1)})]})}),f.jsxs(pl,{className:"max-w-2xl",children:[f.jsxs(gl,{children:[f.jsxs(xl,{className:"flex items-center gap-2",children:[f.jsx(Ym,{className:"w-5 h-5"}),"Room ",g.number," - ",g.school]}),f.jsx(vl,{children:"Detailed performance analysis and inspection history"})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(Fe,{children:f.jsxs(je,{className:"p-4",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(zi,{className:"w-4 h-4"}),f.jsx("span",{className:"text-sm font-medium",children:"Current Rating"})]}),f.jsxs("div",{className:"text-2xl font-bold",style:{color:c(g.rating).color},children:[g.rating.toFixed(1),"/5"]}),f.jsx("div",{className:"text-xs text-muted-foreground",children:l(g.rating)})]})}),f.jsx(Fe,{children:f.jsxs(je,{className:"p-4",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(cr,{className:"w-4 h-4"}),f.jsx("span",{className:"text-sm font-medium",children:"Last Inspection"})]}),f.jsx("div",{className:"text-lg font-semibold",children:new Date(g.lastInspection).toLocaleDateString()})]})}),f.jsx(Fe,{children:f.jsxs(je,{className:"p-4",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[hs.createElement(c(g.rating).icon,{className:"w-4 h-4"}),f.jsx("span",{className:"text-sm font-medium",children:"Status"})]}),f.jsx(ht,{variant:c(g.rating).level==="critical"?"destructive":c(g.rating).level==="needs-attention"?"secondary":"default",className:"text-xs",children:c(g.rating).level.replace("-"," ").toUpperCase()})]})})]}),g.categories&&f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-medium mb-3",children:"Category Performance"}),f.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(g.categories).map(([p,x])=>f.jsxs("div",{className:"flex justify-between items-center p-2 bg-muted/50 rounded",children:[f.jsx("span",{className:"text-sm",children:p}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-sm font-medium",children:x.toFixed(1)}),x<3&&f.jsx(nn,{className:"w-3 h-3 text-orange-500"})]})]},p))})]}),g.inspectionHistory&&g.inspectionHistory.length>0&&f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-medium mb-3",children:"Inspection History"}),f.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:g.inspectionHistory.slice(0,5).map((p,x)=>f.jsxs("div",{className:"flex justify-between items-center p-2 bg-muted/30 rounded text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:new Date(p.date).toLocaleDateString()}),p.inspector&&f.jsxs("span",{className:"text-muted-foreground ml-2",children:["by ",p.inspector]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"font-medium",children:p.rating.toFixed(1)}),p.rating<3&&f.jsx(nn,{className:"w-3 h-3 text-orange-500"})]})]},x))})]}),g.photos&&g.photos.length>0&&f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-medium mb-3",children:"Inspection Photos"}),f.jsx("div",{className:"grid grid-cols-2 gap-2",children:g.photos.slice(0,4).map((p,x)=>f.jsx("div",{className:"aspect-square bg-muted rounded overflow-hidden",children:f.jsx("img",{src:p,alt:`Room ${g.number} photo ${x+1}`,className:"w-full h-full object-cover"})},x))})]})]})]})]},`${m}-${g.number}`))})]},m)),f.jsxs("div",{className:"border-t border-border pt-4",children:[f.jsx("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Performance Legend"}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded bg-green-100 border border-green-200"}),f.jsx("span",{className:"text-muted-foreground",children:"Excellent (4.5+)"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded bg-yellow-100 border border-yellow-200"}),f.jsx("span",{className:"text-muted-foreground",children:"Good (3.5-4.4)"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded bg-orange-100 border border-orange-200"}),f.jsx("span",{className:"text-muted-foreground",children:"Fair (2.5-3.4)"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded bg-red-100 border border-red-200"}),f.jsx("span",{className:"text-muted-foreground",children:"Needs Attention (<2.5)"})]})]})]})]})})]})},ix=({groupName:e,inspections:t,type:r,onInspectionClick:n})=>{const[i,a]=H.useState(!1),s=t.length,o=t.map(g=>{const x=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(v=>g[v]).filter(v=>typeof v=="number");return x.length>0?x.reduce((v,b)=>v+b,0)/x.length:null}).filter(g=>g!==null),l=o.length>0?Math.round(o.reduce((g,p)=>g+p,0)/o.length*10)/10:0,c=t.length>0?{earliest:new Date(Math.min(...t.map(g=>new Date(g.date).getTime()))),latest:new Date(Math.max(...t.map(g=>new Date(g.date).getTime())))}:null,u=()=>{switch(r){case"school":return f.jsx(an,{className:"w-4 h-4"});case"date":return f.jsx(cr,{className:"w-4 h-4"});case"inspector":return f.jsx(Mi,{className:"w-4 h-4"});default:return f.jsx(wi,{className:"w-4 h-4"})}},h=()=>{switch(r){case"school":return"School";case"date":return"Month";case"inspector":return"Inspector";default:return"Group"}},m=g=>f.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(p=>f.jsx(zi,{className:`w-3 h-3 ${p<=g?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},p)),f.jsx("span",{className:"ml-1 text-xs text-muted-foreground",children:g.toFixed(1)})]}),d=()=>{if(!c)return"";const g=p=>p.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${g(c.earliest)} - ${g(c.latest)}`};return f.jsxs(Fe,{className:"w-full",children:[f.jsxs(ze,{className:"cursor-pointer",onClick:()=>a(!i),children:[f.jsxs(He,{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[u(),f.jsx("span",{className:"text-foreground",children:e})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs(ht,{variant:"secondary",className:"text-xs",children:[s," inspections"]}),f.jsx(Le,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:i?f.jsx(Ea,{className:"w-4 h-4"}):f.jsx(du,{className:"w-4 h-4"})})]})]}),f.jsxs(nt,{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("span",{className:"text-sm text-muted-foreground",children:[h(),": ",e]}),c&&f.jsx("span",{className:"text-xs text-muted-foreground",children:d()})]}),l>0&&f.jsx("div",{className:"flex items-center gap-1",children:m(Math.round(l))})]})]}),i&&f.jsx(je,{className:"pt-0",children:f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-3 bg-muted/30 rounded-lg",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-lg font-bold text-foreground",children:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Total"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-lg font-bold text-primary",children:l.toFixed(1)}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Avg Rating"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-lg font-bold text-green-600",children:t.filter(g=>g.inspectionType==="single_room").length}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Single Room"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-lg font-bold text-blue-600",children:t.filter(g=>g.inspectionType==="whole_building").length}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Building"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Individual Inspections"}),t.sort((g,p)=>new Date(p.date).getTime()-new Date(g.date).getTime()).map(g=>{var x;const p=(()=>{const b=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(y=>g[y]).filter(y=>typeof y=="number");return b.length>0?Math.round(b.reduce((y,w)=>y+w,0)/b.length*10)/10:0})();return f.jsxs("div",{className:"flex items-center justify-between p-3 border border-border rounded-lg hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>n==null?void 0:n(g),children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(Ym,{className:"w-3 h-3 text-muted-foreground"}),f.jsx("span",{className:"text-sm font-medium text-foreground",children:g.inspectionType==="single_room"?`Room ${(x=g.roomNumber)!=null?x:"Not specified"}`:`Building: ${g.buildingName||g.locationDescription||"Whole Building"}`})]}),f.jsx(ht,{variant:g.inspectionType==="single_room"?"default":"secondary",className:"text-xs",children:g.inspectionType==="single_room"?"Single Room":"Whole Building"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[p>0&&f.jsx("div",{className:"flex items-center gap-1",children:m(Math.round(p))}),f.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(g.date).toLocaleDateString()})]})]},g.id)})]})]})})]})},xJ=({inspections:e,onInspectionClick:t})=>{const r=e.reduce((o,l)=>(o[l.school]||(o[l.school]=[]),o[l.school].push(l),o),{}),n=Object.entries(r).sort(([,o],[,l])=>l.length-o.length),i=n.length,a=e.length,s=i>0?Math.round(a/i*10)/10:0;return f.jsxs("div",{className:"space-y-6",children:[f.jsxs(Fe,{children:[f.jsxs(ze,{children:[f.jsxs(He,{className:"flex items-center gap-2 text-foreground",children:[f.jsx(an,{className:"w-5 h-5 text-primary"}),"School Performance Overview"]}),f.jsx(nt,{className:"text-muted-foreground",children:"Inspections grouped by school with performance metrics"})]}),f.jsx(je,{children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{className:"text-center p-4 bg-primary/10 rounded-lg",children:[f.jsx("div",{className:"flex items-center justify-center mb-2",children:f.jsx(an,{className:"w-6 h-6 text-primary"})}),f.jsx("p",{className:"text-2xl font-bold text-foreground",children:i}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Schools"})]}),f.jsxs("div",{className:"text-center p-4 bg-secondary/10 rounded-lg",children:[f.jsx("div",{className:"flex items-center justify-center mb-2",children:f.jsx(Ms,{className:"w-6 h-6 text-secondary"})}),f.jsx("p",{className:"text-2xl font-bold text-foreground",children:a}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Inspections"})]}),f.jsxs("div",{className:"text-center p-4 bg-accent/10 rounded-lg",children:[f.jsx("div",{className:"flex items-center justify-center mb-2",children:f.jsx(aR,{className:"w-6 h-6 text-accent"})}),f.jsx("p",{className:"text-2xl font-bold text-foreground",children:s}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg per School"})]})]})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[f.jsx(an,{className:"w-5 h-5 text-primary"}),"Schools (",i,")"]}),n.length===0?f.jsx(Fe,{children:f.jsxs(je,{className:"text-center py-8",children:[f.jsx(an,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),f.jsx("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No School Data"}),f.jsx("p",{className:"text-muted-foreground",children:"No inspection data available for school grouping."})]})}):f.jsx("div",{className:"space-y-3",children:n.map(([o,l])=>f.jsx(ix,{groupName:o,inspections:l,type:"school",onInspectionClick:t},o))})]})]})},vJ=({inspections:e,onInspectionClick:t})=>{const r=e.reduce((u,h)=>{const m=new Date(h.date),d=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}`,g=m.toLocaleDateString("en-US",{month:"long",year:"numeric"});return u[d]||(u[d]={monthName:g,inspections:[]}),u[d].inspections.push(h),u},{}),n=Object.entries(r).sort(([u],[h])=>h.localeCompare(u)),i=n.length,a=e.length,s=i>0?Math.round(a/i*10)/10:0,o=new Date().toISOString().slice(0,7),l=r[o],c=(l==null?void 0:l.inspections.length)||0;return f.jsxs("div",{className:"space-y-6",children:[f.jsxs(Fe,{children:[f.jsxs(ze,{children:[f.jsxs(He,{className:"flex items-center gap-2 text-foreground",children:[f.jsx(cr,{className:"w-5 h-5 text-primary"}),"Monthly Performance Overview"]}),f.jsx(nt,{className:"text-muted-foreground",children:"Inspections grouped by month with trend analysis"})]}),f.jsx(je,{children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{className:"text-center p-4 bg-primary/10 rounded-lg",children:[f.jsx("div",{className:"flex items-center justify-center mb-2",children:f.jsx(cr,{className:"w-6 h-6 text-primary"})}),f.jsx("p",{className:"text-2xl font-bold text-foreground",children:i}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Months"})]}),f.jsxs("div",{className:"text-center p-4 bg-secondary/10 rounded-lg",children:[f.jsx("div",{className:"flex items-center justify-center mb-2",children:f.jsx(Ms,{className:"w-6 h-6 text-secondary"})}),f.jsx("p",{className:"text-2xl font-bold text-foreground",children:a}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Inspections"})]}),f.jsxs("div",{className:"text-center p-4 bg-accent/10 rounded-lg",children:[f.jsx("div",{className:"flex items-center justify-center mb-2",children:f.jsx(rg,{className:"w-6 h-6 text-accent"})}),f.jsx("p",{className:"text-2xl font-bold text-foreground",children:s}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg per Month"})]})]})})]}),l&&f.jsx(Fe,{className:"border-primary/20 bg-primary/5",children:f.jsxs(ze,{children:[f.jsxs(He,{className:"flex items-center gap-2 text-primary",children:[f.jsx(cr,{className:"w-5 h-5"}),"Current Month: ",l.monthName]}),f.jsxs(nt,{children:[c," inspections this month"]})]})}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[f.jsx(cr,{className:"w-5 h-5 text-primary"}),"Monthly Breakdown (",i," months)"]}),n.length===0?f.jsx(Fe,{children:f.jsxs(je,{className:"text-center py-8",children:[f.jsx(cr,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),f.jsx("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No Monthly Data"}),f.jsx("p",{className:"text-muted-foreground",children:"No inspection data available for monthly grouping."})]})}):f.jsx("div",{className:"space-y-3",children:n.map(([u,h])=>f.jsx(ix,{groupName:h.monthName,inspections:h.inspections,type:"date",onInspectionClick:t},u))})]})]})},yJ=({inspections:e,onInspectionClick:t})=>{const r=e.reduce((c,u)=>{const h=u.inspectorName||"Unknown Inspector";return c[h]||(c[h]=[]),c[h].push(u),c},{}),n=Object.entries(r).sort(([,c],[,u])=>u.length-c.length),i=n.length,a=e.length,s=i>0?Math.round(a/i*10)/10:0,o=n[0],l=(o==null?void 0:o[1].length)||0;return f.jsxs("div",{className:"space-y-6",children:[f.jsxs(Fe,{children:[f.jsxs(ze,{children:[f.jsxs(He,{className:"flex items-center gap-2 text-foreground",children:[f.jsx(Mi,{className:"w-5 h-5 text-primary"}),"Inspector Performance Overview"]}),f.jsx(nt,{className:"text-muted-foreground",children:"Inspections grouped by inspector with performance metrics"})]}),f.jsx(je,{children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{className:"text-center p-4 bg-primary/10 rounded-lg",children:[f.jsx("div",{className:"flex items-center justify-center mb-2",children:f.jsx(Mi,{className:"w-6 h-6 text-primary"})}),f.jsx("p",{className:"text-2xl font-bold text-foreground",children:i}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Inspectors"})]}),f.jsxs("div",{className:"text-center p-4 bg-secondary/10 rounded-lg",children:[f.jsx("div",{className:"flex items-center justify-center mb-2",children:f.jsx(Ms,{className:"w-6 h-6 text-secondary"})}),f.jsx("p",{className:"text-2xl font-bold text-foreground",children:a}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Inspections"})]}),f.jsxs("div",{className:"text-center p-4 bg-accent/10 rounded-lg",children:[f.jsx("div",{className:"flex items-center justify-center mb-2",children:f.jsx(c1,{className:"w-6 h-6 text-accent"})}),f.jsx("p",{className:"text-2xl font-bold text-foreground",children:s}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg per Inspector"})]})]})})]}),o&&f.jsx(Fe,{className:"border-primary/20 bg-primary/5",children:f.jsxs(ze,{children:[f.jsxs(He,{className:"flex items-center gap-2 text-primary",children:[f.jsx(c1,{className:"w-5 h-5"}),"Top Performer: ",o[0]]}),f.jsxs(nt,{children:[l," inspections completed"]})]})}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[f.jsx(Mi,{className:"w-5 h-5 text-primary"}),"Inspectors (",i,")"]}),n.length===0?f.jsx(Fe,{children:f.jsxs(je,{className:"text-center py-8",children:[f.jsx(Mi,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),f.jsx("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No Inspector Data"}),f.jsx("p",{className:"text-muted-foreground",children:"No inspection data available for inspector grouping."})]})}):f.jsx("div",{className:"space-y-3",children:n.map(([c,u])=>f.jsx(ix,{groupName:c,inspections:u,type:"inspector",onInspectionClick:t},c))})]})]})},u6=2,f6=3;function Va(e){const r=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(i=>e[i]).filter(i=>typeof i=="number");if(r.length===0)return null;const n=r.reduce((i,a)=>i+a,0)/r.length;return Math.round(n*10)/10}function ax(e){return e<u6?"critical":e<f6?"needs-attention":"acceptable"}function h6(e){const t=["urgent","emergency","safety","hazard","leak","flood","fire","electrical"],r=["immediate","asap","critical","dangerous","broken","damaged"],n=["needs","require","attention","maintenance","repair"],i=`${e.notes} ${e.location} ${e.locationDescription}`.toLowerCase();let a="low";const s=[];return t.some(o=>i.includes(o))?(a="urgent",s.push(...t.filter(o=>i.includes(o)))):r.some(o=>i.includes(o))?(a="high",s.push(...r.filter(o=>i.includes(o)))):n.some(o=>i.includes(o))&&(a="medium",s.push(...n.filter(o=>i.includes(o)))),{note:e,severity:a,keywords:s}}function sx(e){var s;const t=[],r=[];e.forEach(o=>{const l=Va(o);if(l===null)return;const c=ax(l);if(c==="acceptable")return;const u={inspection:o,rating:l,severity:c,location:o.inspectionType==="single_room"?`Room ${o.roomNumber}`:o.buildingName||o.locationDescription||"Whole Building",school:o.school,date:o.date};c==="critical"?t.push(u):r.push(u)}),t.sort((o,l)=>o.rating-l.rating),r.sort((o,l)=>o.rating-l.rating);const n=new Set([...t,...r].map(o=>o.school)),i=[...t,...r].reduce((o,l)=>(o[l.school]=(o[l.school]||0)+1,o),{}),a=((s=Object.entries(i).sort(([,o],[,l])=>l-o)[0])==null?void 0:s[0])||null;return{critical:t,needsAttention:r,urgentNotes:[],summary:{totalProblems:t.length+r.length,criticalCount:t.length,needsAttentionCount:r.length,urgentNotesCount:0,affectedSchools:Array.from(n),mostProblematicSchool:a,mostProblematicCategory:null}}}function ox(e){return e.map(h6).filter(t=>t.severity==="urgent"||t.severity==="high").sort((t,r)=>{const n={urgent:0,high:1,medium:2,low:3};return n[t.severity]-n[r.severity]})}function d6(e){switch(e){case"critical":return{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200",text:"Critical"};case"needs-attention":return{variant:"secondary",className:"bg-orange-100 text-orange-800 border-orange-200",text:"Needs Attention"};case"acceptable":return{variant:"default",className:"bg-green-100 text-green-800 border-green-200",text:"Acceptable"}}}function m6(e){switch(e){case"urgent":return{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200 animate-pulse",text:"URGENT"};case"high":return{variant:"secondary",className:"bg-orange-100 text-orange-800 border-orange-200",text:"High Priority"};case"medium":return{variant:"outline",className:"bg-yellow-100 text-yellow-800 border-yellow-200",text:"Medium Priority"};case"low":return{variant:"outline",className:"bg-gray-100 text-gray-800 border-gray-200",text:"Low Priority"}}}const OA=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(qT,ce(q({className:Ee("grid gap-2",e)},t),{ref:r}))});OA.displayName=qT.displayName;const _c=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(zT,ce(q({ref:r,className:Ee("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e)},t),{children:f.jsx(sR,{className:"flex items-center justify-center",children:f.jsx(oR,{className:"h-2.5 w-2.5 fill-current text-current"})})}))});_c.displayName=zT.displayName;const Ht=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(HT,ce(q({ref:r,className:Ee("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e)},t),{children:f.jsx(lR,{className:Ee("flex items-center justify-center text-current"),children:f.jsx(ig,{className:"h-4 w-4"})})}))});Ht.displayName=HT.displayName;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Wc={};Wc.version="0.18.5";var FA=1252,p6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],IA=function(e){p6.indexOf(e)!=-1&&(FA=e)};function g6(){IA(1252)}var Jo=function(e){IA(e)};function x6(){Jo(1200),g6()}var tc=function(t){return String.fromCharCode(t)},Nb=function(t){return String.fromCharCode(t)},Ab,Li="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function el(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,n=e.charCodeAt(c++),s=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=Li.charAt(a)+Li.charAt(s)+Li.charAt(o)+Li.charAt(l);return t}function gi(e){var t="",r=0,n=0,i=0,a=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=Li.indexOf(e.charAt(c++)),s=Li.indexOf(e.charAt(c++)),r=a<<2|s>>4,t+=String.fromCharCode(r),o=Li.indexOf(e.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Li.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var et=(function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node})(),Ti=(function(){if(typeof Buffer!="undefined"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Da(e){return et?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}function Cb(e){return et?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}var _n=function(t){return et?Ti(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Mu(e){if(typeof ArrayBuffer=="undefined")return _n(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Tl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function v6(e){if(typeof Uint8Array=="undefined")throw new Error("Unsupported");return new Uint8Array(e)}var er=et?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ti(t)}))}:function(e){if(typeof Uint8Array!="undefined"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function y6(e){for(var t=[],r=0,n=e.length+250,i=Da(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(s&3)<<4,i[r++]=128|o&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Da(65535),n=65530)}return t.push(i.slice(0,r)),er(t)}var Ao=/\u0000/g,rc=/[\u0001-\u0006]/g;function ys(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Tn(e,t){var r=""+e;return r.length>=t?r:Ct("0",t-r.length)+r}function lx(e,t){var r=""+e;return r.length>=t?r:Ct(" ",t-r.length)+r}function Gc(e,t){var r=""+e;return r.length>=t?r:r+Ct(" ",t-r.length)}function w6(e,t){var r=""+Math.round(e);return r.length>=t?r:Ct("0",t-r.length)+r}function b6(e,t){var r=""+e;return r.length>=t?r:Ct("0",t-r.length)+r}var kb=Math.pow(2,32);function ts(e,t){if(e>kb||e<-kb)return w6(e,t);var r=Math.round(e);return b6(r,t)}function Yc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Rb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],sm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function _6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var Rt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},Ob={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},S6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xc(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(i);c<t&&(h=Math.floor(i),o=h*s+a,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),a=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=a):(u=c,o=s)),!r)return[0,n*o,u];var m=Math.floor(n*o/u);return[m,n*o-m*u,u]}function nc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,s=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=R6(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var jA=new Date(1899,11,31,0,0,0),T6=jA.getTime(),E6=new Date(1900,2,1,0,0,0);function DA(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=E6&&(r+=1440*60*1e3),(r-(T6+(e.getTimezoneOffset()-jA.getTimezoneOffset())*6e4))/(1440*60*1e3)}function cx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function N6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function A6(e){var t=e<0?12:11,r=cx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function C6(e){var t=cx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function k6(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=A6(e):t===10?r=e.toFixed(10).substr(0,12):r=C6(e),cx(N6(r.toUpperCase()))}function vp(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):k6(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Gi(14,DA(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function R6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function O6(e,t,r,n){var i="",a=0,s=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return sm[r.m-1][1];case 5:return sm[r.m-1][0];default:return sm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Rb[r.q][0];default:return Rb[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Tn(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),t==="s"?a===0?"0":""+a/s:(i=Tn(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Tn(l,c):"";return u}function Bi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var PA=/%/g;function F6(e,t,r){var n=t.replace(PA,""),i=t.length-n.length;return ci(e,n,r*Math.pow(10,2*i))+Ct("%",i)}function I6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ci(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function MA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+MA(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var LA=/# (\?+)( ?)\/( ?)(\d+)/;function j6(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(s===0?Ct(" ",e[1].length+1+e[4].length):lx(s,e[1].length)+e[2]+"/"+e[3]+Tn(o,e[4].length))}function D6(e,t,r){return r+(t===0?"":""+t)+Ct(" ",e[1].length+2+e[4].length)}var BA=/^#*0*\.([0#]+)/,UA=/\).*[0#]/,qA=/\(###\) ###\\?-####/;function vr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Fb(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ib(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function P6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function M6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Jr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(UA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jr("n",n,r):"("+Jr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return I6(e,t,r);if(t.indexOf("%")!==-1)return F6(e,t,r);if(t.indexOf("E")!==-1)return MA(t,r);if(t.charCodeAt(0)===36)return"$"+Jr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ts(l,t.length);if(t.match(/^[#?]+$/))return i=ts(r,0),i==="0"&&(i=""),i.length>t.length?i:vr(t.substr(0,t.length-i.length))+i;if(a=t.match(LA))return j6(a,l,c);if(t.match(/^#+0+$/))return c+ts(l,t.length-t.indexOf("0"));if(a=t.match(BA))return i=Fb(r,a[1].length).replace(/^([^\.]+)$/,"$1."+vr(a[1])).replace(/\.$/,"."+vr(a[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+Ct("0",vr(a[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+Fb(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Bi(ts(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):Bi(""+(Math.floor(r)+P6(r,a[1].length)))+"."+Tn(Ib(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Jr(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ys(Jr(e,t.replace(/[\\-]/g,""),r)),s=0,ys(ys(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<i.length?i.charAt(s++):g==="0"?"0":""}));if(t.match(qA))return i=Jr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Xc(l,Math.pow(10,s)-1,!1),i=""+c,u=ci("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=Gc(o[2],s),u.length<a[4].length&&(u=vr(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Xc(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?lx(o[1],s)+a[2]+"/"+a[3]+Gc(o[2],s):Ct(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=ts(r,0),t.length<=i.length?i:vr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=t.indexOf(".")-s,m=t.length-i.length-h;return vr(t.substr(0,h)+i+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=Ib(r,a[1].length),r<0?"-"+Jr(e,t,-r):Bi(M6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Tn(0,3-g.length):"")+g})+"."+Tn(s,a[1].length);switch(t){case"###,##0.00":return Jr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Bi(ts(l,0));return d!=="0"?c+d:"";case"###,###.00":return Jr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Jr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function L6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ci(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function B6(e,t,r){var n=t.replace(PA,""),i=t.length-n.length;return ci(e,n,r*Math.pow(10,2*i))+Ct("%",i)}function zA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+zA(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function In(e,t,r){if(e.charCodeAt(0)===40&&!t.match(UA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?In("n",n,r):"("+In("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return L6(e,t,r);if(t.indexOf("%")!==-1)return B6(e,t,r);if(t.indexOf("E")!==-1)return zA(t,r);if(t.charCodeAt(0)===36)return"$"+In(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Tn(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:vr(t.substr(0,t.length-i.length))+i;if(a=t.match(LA))return D6(a,l,c);if(t.match(/^#+0+$/))return c+Tn(l,t.length-t.indexOf("0"));if(a=t.match(BA))return i=(""+r).replace(/^([^\.]+)$/,"$1."+vr(a[1])).replace(/\.$/,"."+vr(a[1])),i=i.replace(/\.(\d*)$/,function(g,p){return"."+p+Ct("0",vr(a[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Bi(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+In(e,t,-r):Bi(""+r)+"."+Ct("0",a[1].length);if(a=t.match(/^#,#*,#0/))return In(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ys(In(e,t.replace(/[\\-]/g,""),r)),s=0,ys(ys(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<i.length?i.charAt(s++):g==="0"?"0":""}));if(t.match(qA))return i=In(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Xc(l,Math.pow(10,s)-1,!1),i=""+c,u=ci("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=Gc(o[2],s),u.length<a[4].length&&(u=vr(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Xc(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?lx(o[1],s)+a[2]+"/"+a[3]+Gc(o[2],s):Ct(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:vr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=t.indexOf(".")-s,m=t.length-i.length-h;return vr(t.substr(0,h)+i+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+In(e,t,-r):Bi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Tn(0,3-g.length):"")+g})+"."+Tn(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=Bi(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return In(e,t.slice(0,t.lastIndexOf(".")),r)+vr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ci(e,t,r){return(r|0)===r?In(e,t,r):Jr(e,t,r)}function U6(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var HA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function $A(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Yc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(HA))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function q6(e,t,r,n){for(var i=[],a="",s=0,o="",l="t",c,u,h,m="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Yc(e,s))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(h=e.charCodeAt(++s))!==34&&s<e.length;)a+=String.fromCharCode(h);i[i.length]={t:"t",v:a},++s;break;case"\\":var d=e.charAt(++s),g=d==="("||d===")"?d:"t";i[i.length]={t:g,v:d},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(c==null&&(c=nc(t,r,e.charAt(s+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=nc(t,r),c==null))return"";for(a=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:a},l=o;break;case"A":case"a":case"ä¸Š":var p={t:o,v:o};if(c==null&&(c=nc(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",m="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",s+=5,m="h"):e.substr(s,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(c!=null&&(p.v=c.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),p.t="T",s+=5,m="h"):(p.t="t",++s),c==null&&p.t==="T")return"";i[i.length]=p,l=o;break;case"[":for(a=o;e.charAt(s++)!=="]"&&s<e.length;)a+=e.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(HA)){if(c==null&&(c=nc(t,r),c==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",$A(e)||(i[i.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++s<e.length&&(o=e.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)a+=e.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++s;break}var x=0,v=0,b;for(s=i.length-1,l="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=m,l="h",x<1&&(x=1);break;case"s":(b=i[s].v.match(/\.0+$/))&&(v=Math.max(v,b[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":l=i[s].t;break;case"m":l==="s"&&(i[s].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&i[s].v.match(/[Hh]/)&&(x=1),x<2&&i[s].v.match(/[Mm]/)&&(x=2),x<3&&i[s].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",w;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=O6(i[s].t.charCodeAt(0),i[s].v,c,v),i[s].t="t";break;case"n":case"?":for(w=s+1;i[w]!=null&&((o=i[w].t)==="?"||o==="D"||(o===" "||o==="t")&&i[w+1]!=null&&(i[w+1].t==="?"||i[w+1].t==="t"&&i[w+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[w].v==="/"||i[w].v===" "&&i[w+1]!=null&&i[w+1].t=="?"));)i[s].v+=i[w].v,i[w]={v:"",t:";"},++w;y+=i[s].v,s=w-1;break;case"G":i[s].t="t",i[s].v=vp(t,r);break}var k="",T,S;if(y.length>0){y.charCodeAt(0)==40?(T=t<0&&y.charCodeAt(0)===45?-t:t,S=ci("n",y,T)):(T=t<0&&n>1?-t:t,S=ci("n",y,T),T<0&&i[0]&&i[0].t=="t"&&(S=S.substr(1),i[0].v="-"+i[0].v)),w=S.length-1;var E=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){E=s;break}var A=i.length;if(E===i.length&&S.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(w>=i[s].v.length-1?(w-=i[s].v.length,i[s].v=S.substr(w+1,i[s].v.length)):w<0?i[s].v="":(i[s].v=S.substr(0,w+1),w=-1),i[s].t="t",A=s);w>=0&&A<i.length&&(i[A].v=S.substr(0,w+1)+i[A].v)}else if(E!==i.length&&S.indexOf("E")===-1){for(w=S.indexOf(".")-1,s=E;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(u=i[s].v.indexOf(".")>-1&&s===E?i[s].v.indexOf(".")-1:i[s].v.length-1,k=i[s].v.substr(u+1);u>=0;--u)w>=0&&(i[s].v.charAt(u)==="0"||i[s].v.charAt(u)==="#")&&(k=S.charAt(w--)+k);i[s].v=k,i[s].t="t",A=s}for(w>=0&&A<i.length&&(i[A].v=S.substr(0,w+1)+i[A].v),w=S.indexOf(".")+1,s=E;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==E)){for(u=i[s].v.indexOf(".")>-1&&s===E?i[s].v.indexOf(".")+1:0,k=i[s].v.substr(0,u);u<i[s].v.length;++u)w<S.length&&(k+=S.charAt(w++));i[s].v=k,i[s].t="t",A=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(T=n>1&&t<0&&s>0&&i[s-1].v==="-"?-t:t,i[s].v=ci(i[s].t,i[s].v,T),i[s].t="t");var R="";for(s=0;s!==i.length;++s)i[s]!=null&&(R+=i[s].v);return R}var jb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Db(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function z6(e,t){var r=U6(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(jb),o=r[1].match(jb);return Db(t,s)?[n,r[0]]:Db(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,a]}function Gi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Rt)[e],n==null&&(n=r.table&&r.table[Ob[e]]||Rt[Ob[e]]),n==null&&(n=S6[e]||"General");break}if(Yc(n,0))return vp(t,r);t instanceof Date&&(t=DA(t,r.date1904));var i=z6(n,t);if(Yc(i[1]))return vp(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return q6(i[1],t,r,i[0])}function VA(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Rt[r]==null){t<0&&(t=r);continue}if(Rt[r]==e){t=r;break}}t<0&&(t=391)}return Rt[t]=e,t}function Lu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&VA(e[t],t)}function Bu(){Rt=_6()}var WA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function H6(e){var t=typeof e=="number"?Rt[e]:e;return t=t.replace(WA,"(\\d+)"),new RegExp("^"+t+"$")}function $6(e,t,r){var n=-1,i=-1,a=-1,s=-1,o=-1,l=-1;(t.match(WA)||[]).forEach(function(h,m){var d=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":s=d;break;case"s":l=d;break;case"m":s>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&a==-1?u:c+"T"+u}var V6=(function(){var e={};e.version="1.2.0";function t(){for(var S=0,E=new Array(256),A=0;A!=256;++A)S=A,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,E[A]=S;return typeof Int32Array!="undefined"?new Int32Array(E):E}var r=t();function n(S){var E=0,A=0,R=0,C=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)C[R]=S[R];for(R=0;R!=256;++R)for(A=S[R],E=256+R;E<4096;E+=256)A=C[E]=A>>>8^S[A&255];var j=[];for(R=1;R!=16;++R)j[R-1]=typeof Int32Array!="undefined"?C.subarray(R*256,R*256+256):C.slice(R*256,R*256+256);return j}var i=n(r),a=i[0],s=i[1],o=i[2],l=i[3],c=i[4],u=i[5],h=i[6],m=i[7],d=i[8],g=i[9],p=i[10],x=i[11],v=i[12],b=i[13],y=i[14];function w(S,E){for(var A=E^-1,R=0,C=S.length;R<C;)A=A>>>8^r[(A^S.charCodeAt(R++))&255];return~A}function k(S,E){for(var A=E^-1,R=S.length-15,C=0;C<R;)A=y[S[C++]^A&255]^b[S[C++]^A>>8&255]^v[S[C++]^A>>16&255]^x[S[C++]^A>>>24]^p[S[C++]]^g[S[C++]]^d[S[C++]]^m[S[C++]]^h[S[C++]]^u[S[C++]]^c[S[C++]]^l[S[C++]]^o[S[C++]]^s[S[C++]]^a[S[C++]]^r[S[C++]];for(R+=15;C<R;)A=A>>>8^r[(A^S[C++])&255];return~A}function T(S,E){for(var A=E^-1,R=0,C=S.length,j=0,z=0;R<C;)j=S.charCodeAt(R++),j<128?A=A>>>8^r[(A^j)&255]:j<2048?(A=A>>>8^r[(A^(192|j>>6&31))&255],A=A>>>8^r[(A^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,z=S.charCodeAt(R++)&1023,A=A>>>8^r[(A^(240|j>>8&7))&255],A=A>>>8^r[(A^(128|j>>2&63))&255],A=A>>>8^r[(A^(128|z>>6&15|(j&3)<<4))&255],A=A>>>8^r[(A^(128|z&63))&255]):(A=A>>>8^r[(A^(224|j>>12&15))&255],A=A>>>8^r[(A^(128|j>>6&63))&255],A=A>>>8^r[(A^(128|j&63))&255]);return~A}return e.table=r,e.bstr=w,e.buf=k,e.str=T,e})(),ct=(function(){var t={};t.version="1.2.1";function r(N,D){for(var F=N.split("/"),I=D.split("/"),P=0,L=0,X=Math.min(F.length,I.length);P<X;++P){if(L=F[P].length-I[P].length)return L;if(F[P]!=I[P])return F[P]<I[P]?-1:1}return F.length-I.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var D=N.lastIndexOf("/");return D===-1?N:N.slice(0,D+1)}function i(N){if(N.charAt(N.length-1)=="/")return i(N.slice(0,-1));var D=N.lastIndexOf("/");return D===-1?N:N.slice(D+1)}function a(N,D){typeof D=="string"&&(D=new Date(D));var F=D.getHours();F=F<<6|D.getMinutes(),F=F<<5|D.getSeconds()>>>1,N.write_shift(2,F);var I=D.getFullYear()-1980;I=I<<4|D.getMonth()+1,I=I<<5|D.getDate(),N.write_shift(2,I)}function s(N){var D=N.read_shift(2)&65535,F=N.read_shift(2)&65535,I=new Date,P=F&31;F>>>=5;var L=F&15;F>>>=4,I.setMilliseconds(0),I.setFullYear(F+1980),I.setMonth(L-1),I.setDate(P);var X=D&31;D>>>=5;var ae=D&63;return D>>>=6,I.setHours(D),I.setMinutes(ae),I.setSeconds(X<<1),I}function o(N){Br(N,0);for(var D={},F=0;N.l<=N.length-4;){var I=N.read_shift(2),P=N.read_shift(2),L=N.l+P,X={};switch(I){case 21589:F=N.read_shift(1),F&1&&(X.mtime=N.read_shift(4)),P>5&&(F&2&&(X.atime=N.read_shift(4)),F&4&&(X.ctime=N.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}N.l=L,D[I]=X}return D}var l;function c(){return l||(l={})}function u(N,D){if(N[0]==80&&N[1]==75)return la(N,D);if((N[0]|32)==109&&(N[1]|32)==105)return I3(N,D);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var F=3,I=512,P=0,L=0,X=0,ae=0,Y=0,Q=[],Z=N.slice(0,512);Br(Z,0);var me=h(Z);switch(F=me[0],F){case 3:I=512;break;case 4:I=4096;break;case 0:if(me[1]==0)return la(N,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}I!==512&&(Z=N.slice(0,I),Br(Z,28));var _e=N.slice(0,I);m(Z,F);var Ce=Z.read_shift(4,"i");if(F===3&&Ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ce);Z.l+=4,X=Z.read_shift(4,"i"),Z.l+=4,Z.chk("00100000","Mini Stream Cutoff Size: "),ae=Z.read_shift(4,"i"),P=Z.read_shift(4,"i"),Y=Z.read_shift(4,"i"),L=Z.read_shift(4,"i");for(var ve=-1,Ae=0;Ae<109&&(ve=Z.read_shift(4,"i"),!(ve<0));++Ae)Q[Ae]=ve;var De=d(N,I);x(Y,L,De,I,Q);var St=b(De,X,Q,I);St[X].name="!Directory",P>0&&ae!==z&&(St[ae].name="!MiniFAT"),St[Q[0]].name="!FAT",St.fat_addrs=Q,St.ssz=I;var Tt={},or=[],to=[],ro=[];y(X,St,De,or,P,Tt,to,ae),g(to,ro,or),or.shift();var no={FileIndex:to,FullPaths:ro};return D&&D.raw&&(no.raw={header:_e,sectors:De}),no}function h(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(G,"Header Signature: "),N.l+=16;var D=N.read_shift(2,"u");return[N.read_shift(2,"u"),D]}function m(N,D){var F=9;switch(N.l+=2,F=N.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function d(N,D){for(var F=Math.ceil(N.length/D)-1,I=[],P=1;P<F;++P)I[P-1]=N.slice(P*D,(P+1)*D);return I[F-1]=N.slice(F*D),I}function g(N,D,F){for(var I=0,P=0,L=0,X=0,ae=0,Y=F.length,Q=[],Z=[];I<Y;++I)Q[I]=Z[I]=I,D[I]=F[I];for(;ae<Z.length;++ae)I=Z[ae],P=N[I].L,L=N[I].R,X=N[I].C,Q[I]===I&&(P!==-1&&Q[P]!==P&&(Q[I]=Q[P]),L!==-1&&Q[L]!==L&&(Q[I]=Q[L])),X!==-1&&(Q[X]=I),P!==-1&&I!=Q[I]&&(Q[P]=Q[I],Z.lastIndexOf(P)<ae&&Z.push(P)),L!==-1&&I!=Q[I]&&(Q[L]=Q[I],Z.lastIndexOf(L)<ae&&Z.push(L));for(I=1;I<Y;++I)Q[I]===I&&(L!==-1&&Q[L]!==L?Q[I]=Q[L]:P!==-1&&Q[P]!==P&&(Q[I]=Q[P]));for(I=1;I<Y;++I)if(N[I].type!==0){if(ae=I,ae!=Q[ae])do ae=Q[ae],D[I]=D[ae]+"/"+D[I];while(ae!==0&&Q[ae]!==-1&&ae!=Q[ae]);Q[I]=-1}for(D[0]+="/",I=1;I<Y;++I)N[I].type!==2&&(D[I]+="/")}function p(N,D,F){for(var I=N.start,P=N.size,L=[],X=I;F&&P>0&&X>=0;)L.push(D.slice(X*j,X*j+j)),P-=j,X=ga(F,X*4);return L.length===0?ne(0):er(L).slice(0,N.size)}function x(N,D,F,I,P){var L=z;if(N===z){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var X=F[N],ae=(I>>>2)-1;if(!X)return;for(var Y=0;Y<ae&&(L=ga(X,Y*4))!==z;++Y)P.push(L);x(ga(X,I-4),D-1,F,I,P)}}function v(N,D,F,I,P){var L=[],X=[];P||(P=[]);var ae=I-1,Y=0,Q=0;for(Y=D;Y>=0;){P[Y]=!0,L[L.length]=Y,X.push(N[Y]);var Z=F[Math.floor(Y*4/I)];if(Q=Y*4&ae,I<4+Q)throw new Error("FAT boundary crossed: "+Y+" 4 "+I);if(!N[Z])break;Y=ga(N[Z],Q)}return{nodes:L,data:Hb([X])}}function b(N,D,F,I){var P=N.length,L=[],X=[],ae=[],Y=[],Q=I-1,Z=0,me=0,_e=0,Ce=0;for(Z=0;Z<P;++Z)if(ae=[],_e=Z+D,_e>=P&&(_e-=P),!X[_e]){Y=[];var ve=[];for(me=_e;me>=0;){ve[me]=!0,X[me]=!0,ae[ae.length]=me,Y.push(N[me]);var Ae=F[Math.floor(me*4/I)];if(Ce=me*4&Q,I<4+Ce)throw new Error("FAT boundary crossed: "+me+" 4 "+I);if(!N[Ae]||(me=ga(N[Ae],Ce),ve[me]))break}L[_e]={nodes:ae,data:Hb([Y])}}return L}function y(N,D,F,I,P,L,X,ae){for(var Y=0,Q=I.length?2:0,Z=D[N].data,me=0,_e=0,Ce;me<Z.length;me+=128){var ve=Z.slice(me,me+128);Br(ve,64),_e=ve.read_shift(2),Ce=mx(ve,0,_e-Q),I.push(Ce);var Ae={name:Ce,type:ve.read_shift(1),color:ve.read_shift(1),L:ve.read_shift(4,"i"),R:ve.read_shift(4,"i"),C:ve.read_shift(4,"i"),clsid:ve.read_shift(16),state:ve.read_shift(4,"i"),start:0,size:0},De=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);De!==0&&(Ae.ct=w(ve,ve.l-8));var St=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);St!==0&&(Ae.mt=w(ve,ve.l-8)),Ae.start=ve.read_shift(4,"i"),Ae.size=ve.read_shift(4,"i"),Ae.size<0&&Ae.start<0&&(Ae.size=Ae.type=0,Ae.start=z,Ae.name=""),Ae.type===5?(Y=Ae.start,P>0&&Y!==z&&(D[Y].name="!StreamData")):Ae.size>=4096?(Ae.storage="fat",D[Ae.start]===void 0&&(D[Ae.start]=v(F,Ae.start,D.fat_addrs,D.ssz)),D[Ae.start].name=Ae.name,Ae.content=D[Ae.start].data.slice(0,Ae.size)):(Ae.storage="minifat",Ae.size<0?Ae.size=0:Y!==z&&Ae.start!==z&&D[Y]&&(Ae.content=p(Ae,D[Y].data,(D[ae]||{}).data))),Ae.content&&Br(Ae.content,0),L[Ce]=Ae,X.push(Ae)}}function w(N,D){return new Date((zr(N,D+4)/1e7*Math.pow(2,32)+zr(N,D)/1e7-11644473600)*1e3)}function k(N,D){return c(),u(l.readFileSync(N),D)}function T(N,D){var F=D&&D.type;switch(F||et&&Buffer.isBuffer(N)&&(F="buffer"),F||"base64"){case"file":return k(N,D);case"base64":return u(_n(gi(N)),D);case"binary":return u(_n(N),D)}return u(N,D)}function S(N,D){var F=D||{},I=F.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=I+"/",N.FileIndex[0]={name:I,type:5}),F.CLSID&&(N.FileIndex[0].clsid=F.CLSID),E(N)}function E(N){var D="Sh33tJ5";if(!ct.find(N,"/"+D)){var F=ne(4);F[0]=55,F[1]=F[3]=50,F[2]=54,N.FileIndex.push({name:D,type:2,content:F,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+D),A(N)}}function A(N,D){S(N);for(var F=!1,I=!1,P=N.FullPaths.length-1;P>=0;--P){var L=N.FileIndex[P];switch(L.type){case 0:I?F=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:I=!0,isNaN(L.R*L.L*L.C)&&(F=!0),L.R>-1&&L.L>-1&&L.R==L.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!D)){var X=new Date(1987,1,19),ae=0,Y=Object.create?Object.create(null):{},Q=[];for(P=0;P<N.FullPaths.length;++P)Y[N.FullPaths[P]]=!0,N.FileIndex[P].type!==0&&Q.push([N.FullPaths[P],N.FileIndex[P]]);for(P=0;P<Q.length;++P){var Z=n(Q[P][0]);I=Y[Z],I||(Q.push([Z,{name:i(Z).replace("/",""),type:1,clsid:fe,ct:X,mt:X,content:null}]),Y[Z]=!0)}for(Q.sort(function(Ce,ve){return r(Ce[0],ve[0])}),N.FullPaths=[],N.FileIndex=[],P=0;P<Q.length;++P)N.FullPaths[P]=Q[P][0],N.FileIndex[P]=Q[P][1];for(P=0;P<Q.length;++P){var me=N.FileIndex[P],_e=N.FullPaths[P];if(me.name=i(_e).replace("/",""),me.L=me.R=me.C=-(me.color=1),me.size=me.content?me.content.length:0,me.start=0,me.clsid=me.clsid||fe,P===0)me.C=Q.length>1?1:-1,me.size=0,me.type=5;else if(_e.slice(-1)=="/"){for(ae=P+1;ae<Q.length&&n(N.FullPaths[ae])!=_e;++ae);for(me.C=ae>=Q.length?-1:ae,ae=P+1;ae<Q.length&&n(N.FullPaths[ae])!=n(_e);++ae);me.R=ae>=Q.length?-1:ae,me.type=1}else n(N.FullPaths[P+1]||"")==n(_e)&&(me.R=P+1),me.type=2}}}function R(N,D){var F=D||{};if(F.fileType=="mad")return j3(N,F);switch(A(N),F.fileType){case"zip":return sr(N,F)}var I=(function(Ce){for(var ve=0,Ae=0,De=0;De<Ce.FileIndex.length;++De){var St=Ce.FileIndex[De];if(St.content){var Tt=St.content.length;Tt>0&&(Tt<4096?ve+=Tt+63>>6:Ae+=Tt+511>>9)}}for(var or=Ce.FullPaths.length+3>>2,to=ve+7>>3,ro=ve+127>>7,no=to+Ae+or+ro,ca=no+127>>7,Ju=ca<=109?0:Math.ceil((ca-109)/127);no+ca+Ju+127>>7>ca;)Ju=++ca<=109?0:Math.ceil((ca-109)/127);var Zn=[1,Ju,ca,ro,or,Ae,ve,0];return Ce.FileIndex[0].size=ve<<6,Zn[7]=(Ce.FileIndex[0].start=Zn[0]+Zn[1]+Zn[2]+Zn[3]+Zn[4]+Zn[5])+(Zn[6]+7>>3),Zn})(N),P=ne(I[7]<<9),L=0,X=0;{for(L=0;L<8;++L)P.write_shift(1,W[L]);for(L=0;L<8;++L)P.write_shift(2,0);for(P.write_shift(2,62),P.write_shift(2,3),P.write_shift(2,65534),P.write_shift(2,9),P.write_shift(2,6),L=0;L<3;++L)P.write_shift(2,0);for(P.write_shift(4,0),P.write_shift(4,I[2]),P.write_shift(4,I[0]+I[1]+I[2]+I[3]-1),P.write_shift(4,0),P.write_shift(4,4096),P.write_shift(4,I[3]?I[0]+I[1]+I[2]-1:z),P.write_shift(4,I[3]),P.write_shift(-4,I[1]?I[0]-1:z),P.write_shift(4,I[1]),L=0;L<109;++L)P.write_shift(-4,L<I[2]?I[1]+L:-1)}if(I[1])for(X=0;X<I[1];++X){for(;L<236+X*127;++L)P.write_shift(-4,L<I[2]?I[1]+L:-1);P.write_shift(-4,X===I[1]-1?z:X+1)}var ae=function(Ce){for(X+=Ce;L<X-1;++L)P.write_shift(-4,L+1);Ce&&(++L,P.write_shift(-4,z))};for(X=L=0,X+=I[1];L<X;++L)P.write_shift(-4,he.DIFSECT);for(X+=I[2];L<X;++L)P.write_shift(-4,he.FATSECT);ae(I[3]),ae(I[4]);for(var Y=0,Q=0,Z=N.FileIndex[0];Y<N.FileIndex.length;++Y)Z=N.FileIndex[Y],Z.content&&(Q=Z.content.length,!(Q<4096)&&(Z.start=X,ae(Q+511>>9)));for(ae(I[6]+7>>3);P.l&511;)P.write_shift(-4,he.ENDOFCHAIN);for(X=L=0,Y=0;Y<N.FileIndex.length;++Y)Z=N.FileIndex[Y],Z.content&&(Q=Z.content.length,!(!Q||Q>=4096)&&(Z.start=X,ae(Q+63>>6)));for(;P.l&511;)P.write_shift(-4,he.ENDOFCHAIN);for(L=0;L<I[4]<<2;++L){var me=N.FullPaths[L];if(!me||me.length===0){for(Y=0;Y<17;++Y)P.write_shift(4,0);for(Y=0;Y<3;++Y)P.write_shift(4,-1);for(Y=0;Y<12;++Y)P.write_shift(4,0);continue}Z=N.FileIndex[L],L===0&&(Z.start=Z.size?Z.start-1:z);var _e=L===0&&F.root||Z.name;if(Q=2*(_e.length+1),P.write_shift(64,_e,"utf16le"),P.write_shift(2,Q),P.write_shift(1,Z.type),P.write_shift(1,Z.color),P.write_shift(-4,Z.L),P.write_shift(-4,Z.R),P.write_shift(-4,Z.C),Z.clsid)P.write_shift(16,Z.clsid,"hex");else for(Y=0;Y<4;++Y)P.write_shift(4,0);P.write_shift(4,Z.state||0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,Z.start),P.write_shift(4,Z.size),P.write_shift(4,0)}for(L=1;L<N.FileIndex.length;++L)if(Z=N.FileIndex[L],Z.size>=4096)if(P.l=Z.start+1<<9,et&&Buffer.isBuffer(Z.content))Z.content.copy(P,P.l,0,Z.size),P.l+=Z.size+511&-512;else{for(Y=0;Y<Z.size;++Y)P.write_shift(1,Z.content[Y]);for(;Y&511;++Y)P.write_shift(1,0)}for(L=1;L<N.FileIndex.length;++L)if(Z=N.FileIndex[L],Z.size>0&&Z.size<4096)if(et&&Buffer.isBuffer(Z.content))Z.content.copy(P,P.l,0,Z.size),P.l+=Z.size+63&-64;else{for(Y=0;Y<Z.size;++Y)P.write_shift(1,Z.content[Y]);for(;Y&63;++Y)P.write_shift(1,0)}if(et)P.l=P.length;else for(;P.l<P.length;)P.write_shift(1,0);return P}function C(N,D){var F=N.FullPaths.map(function(Y){return Y.toUpperCase()}),I=F.map(function(Y){var Q=Y.split("/");return Q[Q.length-(Y.slice(-1)=="/"?2:1)]}),P=!1;D.charCodeAt(0)===47?(P=!0,D=F[0].slice(0,-1)+D):P=D.indexOf("/")!==-1;var L=D.toUpperCase(),X=P===!0?F.indexOf(L):I.indexOf(L);if(X!==-1)return N.FileIndex[X];var ae=!L.match(rc);for(L=L.replace(Ao,""),ae&&(L=L.replace(rc,"!")),X=0;X<F.length;++X)if((ae?F[X].replace(rc,"!"):F[X]).replace(Ao,"")==L||(ae?I[X].replace(rc,"!"):I[X]).replace(Ao,"")==L)return N.FileIndex[X];return null}var j=64,z=-2,G="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(N,D,F){c();var I=R(N,F);l.writeFileSync(D,I)}function re(N){for(var D=new Array(N.length),F=0;F<N.length;++F)D[F]=String.fromCharCode(N[F]);return D.join("")}function O(N,D){var F=R(N,D);switch(D&&D.type||"buffer"){case"file":return c(),l.writeFileSync(D.filename,F),F;case"binary":return typeof F=="string"?F:re(F);case"base64":return el(typeof F=="string"?F:re(F));case"buffer":if(et)return Buffer.isBuffer(F)?F:Ti(F);case"array":return typeof F=="string"?_n(F):F}return F}var ge;function B(N){try{var D=N.InflateRaw,F=new D;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)ge=N;else throw new Error("zlib does not expose bytesRead")}catch(I){console.error("cannot use native zlib: "+(I.message||I))}}function _(N,D){if(!ge)return ar(N,D);var F=ge.InflateRaw,I=new F,P=I._processChunk(N.slice(N.l),I._finishFlushFlag);return N.l+=I.bytesRead,P}function M(N){return ge?ge.deflateRawSync(N):We(N)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(N){var D=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(D>>16|D>>8|D)&255}for(var K=typeof Uint8Array!="undefined",J=K?new Uint8Array(256):[],Se=0;Se<256;++Se)J[Se]=de(Se);function te(N,D){var F=J[N&255];return D<=8?F>>>8-D:(F=F<<8|J[N>>8&255],D<=16?F>>>16-D:(F=F<<8|J[N>>16&255],F>>>24-D))}function $e(N,D){var F=D&7,I=D>>>3;return(N[I]|(F<=6?0:N[I+1]<<8))>>>F&3}function Ne(N,D){var F=D&7,I=D>>>3;return(N[I]|(F<=5?0:N[I+1]<<8))>>>F&7}function Je(N,D){var F=D&7,I=D>>>3;return(N[I]|(F<=4?0:N[I+1]<<8))>>>F&15}function Be(N,D){var F=D&7,I=D>>>3;return(N[I]|(F<=3?0:N[I+1]<<8))>>>F&31}function Te(N,D){var F=D&7,I=D>>>3;return(N[I]|(F<=1?0:N[I+1]<<8))>>>F&127}function Ot(N,D,F){var I=D&7,P=D>>>3,L=(1<<F)-1,X=N[P]>>>I;return F<8-I||(X|=N[P+1]<<8-I,F<16-I)||(X|=N[P+2]<<16-I,F<24-I)||(X|=N[P+3]<<24-I),X&L}function mr(N,D,F){var I=D&7,P=D>>>3;return I<=5?N[P]|=(F&7)<<I:(N[P]|=F<<I&255,N[P+1]=(F&7)>>8-I),D+3}function Qt(N,D,F){var I=D&7,P=D>>>3;return F=(F&1)<<I,N[P]|=F,D+1}function ir(N,D,F){var I=D&7,P=D>>>3;return F<<=I,N[P]|=F&255,F>>>=8,N[P+1]=F,D+8}function Yr(N,D,F){var I=D&7,P=D>>>3;return F<<=I,N[P]|=F&255,F>>>=8,N[P+1]=F&255,N[P+2]=F>>>8,D+16}function jr(N,D){var F=N.length,I=2*F>D?2*F:D+5,P=0;if(F>=D)return N;if(et){var L=Cb(I);if(N.copy)N.copy(L);else for(;P<N.length;++P)L[P]=N[P];return L}else if(K){var X=new Uint8Array(I);if(X.set)X.set(N);else for(;P<F;++P)X[P]=N[P];return X}return N.length=I,N}function ft(N){for(var D=new Array(N),F=0;F<N;++F)D[F]=0;return D}function On(N,D,F){var I=1,P=0,L=0,X=0,ae=0,Y=N.length,Q=K?new Uint16Array(32):ft(32);for(L=0;L<32;++L)Q[L]=0;for(L=Y;L<F;++L)N[L]=0;Y=N.length;var Z=K?new Uint16Array(Y):ft(Y);for(L=0;L<Y;++L)Q[P=N[L]]++,I<P&&(I=P),Z[L]=0;for(Q[0]=0,L=1;L<=I;++L)Q[L+16]=ae=ae+Q[L-1]<<1;for(L=0;L<Y;++L)ae=N[L],ae!=0&&(Z[L]=Q[ae+16]++);var me=0;for(L=0;L<Y;++L)if(me=N[L],me!=0)for(ae=te(Z[L],I)>>I-me,X=(1<<I+4-me)-1;X>=0;--X)D[ae|X<<me]=me&15|L<<4;return I}var ie=K?new Uint16Array(512):ft(512),xe=K?new Uint16Array(32):ft(32);if(!K){for(var Oe=0;Oe<512;++Oe)ie[Oe]=0;for(Oe=0;Oe<32;++Oe)xe[Oe]=0}(function(){for(var N=[],D=0;D<32;D++)N.push(5);On(N,xe,32);var F=[];for(D=0;D<=143;D++)F.push(8);for(;D<=255;D++)F.push(9);for(;D<=279;D++)F.push(7);for(;D<=287;D++)F.push(8);On(F,ie,288)})();var Ue=(function(){for(var D=K?new Uint8Array(32768):[],F=0,I=0;F<le.length-1;++F)for(;I<le[F+1];++I)D[I]=F;for(;I<32768;++I)D[I]=29;var P=K?new Uint8Array(259):[];for(F=0,I=0;F<V.length-1;++F)for(;I<V[F+1];++I)P[I]=F;function L(ae,Y){for(var Q=0;Q<ae.length;){var Z=Math.min(65535,ae.length-Q),me=Q+Z==ae.length;for(Y.write_shift(1,+me),Y.write_shift(2,Z),Y.write_shift(2,~Z&65535);Z-- >0;)Y[Y.l++]=ae[Q++]}return Y.l}function X(ae,Y){for(var Q=0,Z=0,me=K?new Uint16Array(32768):[];Z<ae.length;){var _e=Math.min(65535,ae.length-Z);if(_e<10){for(Q=mr(Y,Q,+(Z+_e==ae.length)),Q&7&&(Q+=8-(Q&7)),Y.l=Q/8|0,Y.write_shift(2,_e),Y.write_shift(2,~_e&65535);_e-- >0;)Y[Y.l++]=ae[Z++];Q=Y.l*8;continue}Q=mr(Y,Q,+(Z+_e==ae.length)+2);for(var Ce=0;_e-- >0;){var ve=ae[Z];Ce=(Ce<<5^ve)&32767;var Ae=-1,De=0;if((Ae=me[Ce])&&(Ae|=Z&-32768,Ae>Z&&(Ae-=32768),Ae<Z))for(;ae[Ae+De]==ae[Z+De]&&De<250;)++De;if(De>2){ve=P[De],ve<=22?Q=ir(Y,Q,J[ve+1]>>1)-1:(ir(Y,Q,3),Q+=5,ir(Y,Q,J[ve-23]>>5),Q+=3);var St=ve<8?0:ve-4>>2;St>0&&(Yr(Y,Q,De-V[ve]),Q+=St),ve=D[Z-Ae],Q=ir(Y,Q,J[ve]>>3),Q-=3;var Tt=ve<4?0:ve-2>>1;Tt>0&&(Yr(Y,Q,Z-Ae-le[ve]),Q+=Tt);for(var or=0;or<De;++or)me[Ce]=Z&32767,Ce=(Ce<<5^ae[Z])&32767,++Z;_e-=De-1}else ve<=143?ve=ve+48:Q=Qt(Y,Q,1),Q=ir(Y,Q,J[ve]),me[Ce]=Z&32767,++Z}Q=ir(Y,Q,0)-1}return Y.l=(Q+7)/8|0,Y.l}return function(Y,Q){return Y.length<8?L(Y,Q):X(Y,Q)}})();function We(N){var D=ne(50+Math.floor(N.length*1.1)),F=Ue(N,D);return D.slice(0,F)}var Ut=K?new Uint16Array(32768):ft(32768),pr=K?new Uint16Array(32768):ft(32768),gr=K?new Uint16Array(128):ft(128),hn=1,Xr=1;function qt(N,D){var F=Be(N,D)+257;D+=5;var I=Be(N,D)+1;D+=5;var P=Je(N,D)+4;D+=4;for(var L=0,X=K?new Uint8Array(19):ft(19),ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,Q=K?new Uint8Array(8):ft(8),Z=K?new Uint8Array(8):ft(8),me=X.length,_e=0;_e<P;++_e)X[U[_e]]=L=Ne(N,D),Y<L&&(Y=L),Q[L]++,D+=3;var Ce=0;for(Q[0]=0,_e=1;_e<=Y;++_e)Z[_e]=Ce=Ce+Q[_e-1]<<1;for(_e=0;_e<me;++_e)(Ce=X[_e])!=0&&(ae[_e]=Z[Ce]++);var ve=0;for(_e=0;_e<me;++_e)if(ve=X[_e],ve!=0){Ce=J[ae[_e]]>>8-ve;for(var Ae=(1<<7-ve)-1;Ae>=0;--Ae)gr[Ce|Ae<<ve]=ve&7|_e<<3}var De=[];for(Y=1;De.length<F+I;)switch(Ce=gr[Te(N,D)],D+=Ce&7,Ce>>>=3){case 16:for(L=3+$e(N,D),D+=2,Ce=De[De.length-1];L-- >0;)De.push(Ce);break;case 17:for(L=3+Ne(N,D),D+=3;L-- >0;)De.push(0);break;case 18:for(L=11+Te(N,D),D+=7;L-- >0;)De.push(0);break;default:De.push(Ce),Y<Ce&&(Y=Ce);break}var St=De.slice(0,F),Tt=De.slice(F);for(_e=F;_e<286;++_e)St[_e]=0;for(_e=I;_e<30;++_e)Tt[_e]=0;return hn=On(St,Ut,286),Xr=On(Tt,pr,30),D}function Kr(N,D){if(N[0]==3&&!(N[1]&3))return[Da(D),2];for(var F=0,I=0,P=Cb(D||1<<18),L=0,X=P.length>>>0,ae=0,Y=0;(I&1)==0;){if(I=Ne(N,F),F+=3,I>>>1)I>>1==1?(ae=9,Y=5):(F=qt(N,F),ae=hn,Y=Xr);else{F&7&&(F+=8-(F&7));var Q=N[F>>>3]|N[(F>>>3)+1]<<8;if(F+=32,Q>0)for(!D&&X<L+Q&&(P=jr(P,L+Q),X=P.length);Q-- >0;)P[L++]=N[F>>>3],F+=8;continue}for(;;){!D&&X<L+32767&&(P=jr(P,L+32767),X=P.length);var Z=Ot(N,F,ae),me=I>>>1==1?ie[Z]:Ut[Z];if(F+=me&15,me>>>=4,(me>>>8&255)===0)P[L++]=me;else{if(me==256)break;me-=257;var _e=me<8?0:me-4>>2;_e>5&&(_e=0);var Ce=L+V[me];_e>0&&(Ce+=Ot(N,F,_e),F+=_e),Z=Ot(N,F,Y),me=I>>>1==1?xe[Z]:pr[Z],F+=me&15,me>>>=4;var ve=me<4?0:me-2>>1,Ae=le[me];for(ve>0&&(Ae+=Ot(N,F,ve),F+=ve),!D&&X<Ce&&(P=jr(P,Ce+100),X=P.length);L<Ce;)P[L]=P[L-Ae],++L}}}return D?[P,F+7>>>3]:[P.slice(0,L),F+7>>>3]}function ar(N,D){var F=N.slice(N.l||0),I=Kr(F,D);return N.l+=I[1],I[0]}function oa(N,D){if(N)typeof console!="undefined"&&console.error(D);else throw new Error(D)}function la(N,D){var F=N;Br(F,0);var I=[],P=[],L={FileIndex:I,FullPaths:P};S(L,{root:D.root});for(var X=F.length-4;(F[X]!=80||F[X+1]!=75||F[X+2]!=5||F[X+3]!=6)&&X>=0;)--X;F.l=X+4,F.l+=4;var ae=F.read_shift(2);F.l+=6;var Y=F.read_shift(4);for(F.l=Y,X=0;X<ae;++X){F.l+=20;var Q=F.read_shift(4),Z=F.read_shift(4),me=F.read_shift(2),_e=F.read_shift(2),Ce=F.read_shift(2);F.l+=8;var ve=F.read_shift(4),Ae=o(F.slice(F.l+me,F.l+me+_e));F.l+=me+_e+Ce;var De=F.l;F.l=ve+4,eo(F,Q,Z,L,Ae),F.l=De}return L}function eo(N,D,F,I,P){N.l+=2;var L=N.read_shift(2),X=N.read_shift(2),ae=s(N);if(L&8257)throw new Error("Unsupported ZIP encryption");for(var Y=N.read_shift(4),Q=N.read_shift(4),Z=N.read_shift(4),me=N.read_shift(2),_e=N.read_shift(2),Ce="",ve=0;ve<me;++ve)Ce+=String.fromCharCode(N[N.l++]);if(_e){var Ae=o(N.slice(N.l,N.l+_e));(Ae[21589]||{}).mt&&(ae=Ae[21589].mt),((P||{})[21589]||{}).mt&&(ae=P[21589].mt)}N.l+=_e;var De=N.slice(N.l,N.l+Q);switch(X){case 8:De=_(N,Z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var St=!1;L&8&&(Y=N.read_shift(4),Y==134695760&&(Y=N.read_shift(4),St=!0),Q=N.read_shift(4),Z=N.read_shift(4)),Q!=D&&oa(St,"Bad compressed size: "+D+" != "+Q),Z!=F&&oa(St,"Bad uncompressed size: "+F+" != "+Z),Zu(I,Ce,De,{unsafe:!0,mt:ae})}function sr(N,D){var F=D||{},I=[],P=[],L=ne(1),X=F.compression?8:0,ae=0,Y=0,Q=0,Z=0,me=0,_e=N.FullPaths[0],Ce=_e,ve=N.FileIndex[0],Ae=[],De=0;for(Y=1;Y<N.FullPaths.length;++Y)if(Ce=N.FullPaths[Y].slice(_e.length),ve=N.FileIndex[Y],!(!ve.size||!ve.content||Ce=="Sh33tJ5")){var St=Z,Tt=ne(Ce.length);for(Q=0;Q<Ce.length;++Q)Tt.write_shift(1,Ce.charCodeAt(Q)&127);Tt=Tt.slice(0,Tt.l),Ae[me]=V6.buf(ve.content,0);var or=ve.content;X==8&&(or=M(or)),L=ne(30),L.write_shift(4,67324752),L.write_shift(2,20),L.write_shift(2,ae),L.write_shift(2,X),ve.mt?a(L,ve.mt):L.write_shift(4,0),L.write_shift(-4,Ae[me]),L.write_shift(4,or.length),L.write_shift(4,ve.content.length),L.write_shift(2,Tt.length),L.write_shift(2,0),Z+=L.length,I.push(L),Z+=Tt.length,I.push(Tt),Z+=or.length,I.push(or),L=ne(46),L.write_shift(4,33639248),L.write_shift(2,0),L.write_shift(2,20),L.write_shift(2,ae),L.write_shift(2,X),L.write_shift(4,0),L.write_shift(-4,Ae[me]),L.write_shift(4,or.length),L.write_shift(4,ve.content.length),L.write_shift(2,Tt.length),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(4,0),L.write_shift(4,St),De+=L.l,P.push(L),De+=Tt.length,P.push(Tt),++me}return L=ne(22),L.write_shift(4,101010256),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,me),L.write_shift(2,me),L.write_shift(4,De),L.write_shift(4,Z),L.write_shift(2,0),er([er(I),er(P),L])}var Ll={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function C3(N,D){if(N.ctype)return N.ctype;var F=N.name||"",I=F.match(/\.([^\.]+)$/);return I&&Ll[I[1]]||D&&(I=(F=D).match(/[\.\\]([^\.\\])+$/),I&&Ll[I[1]])?Ll[I[1]]:"application/octet-stream"}function k3(N){for(var D=el(N),F=[],I=0;I<D.length;I+=76)F.push(D.slice(I,I+76));return F.join(`\r
`)+`\r
`}function R3(N){var D=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var Z=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(Z.length==1?"0"+Z:Z)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],I=D.split(`\r
`),P=0;P<I.length;++P){var L=I[P];if(L.length==0){F.push("");continue}for(var X=0;X<L.length;){var ae=76,Y=L.slice(X,X+ae);Y.charAt(ae-1)=="="?ae--:Y.charAt(ae-2)=="="?ae-=2:Y.charAt(ae-3)=="="&&(ae-=3),Y=L.slice(X,X+ae),X+=ae,X<L.length&&(Y+="="),F.push(Y)}}return F.join(`\r
`)}function O3(N){for(var D=[],F=0;F<N.length;++F){for(var I=N[F];F<=N.length&&I.charAt(I.length-1)=="=";)I=I.slice(0,I.length-1)+N[++F];D.push(I)}for(var P=0;P<D.length;++P)D[P]=D[P].replace(/[=][0-9A-Fa-f]{2}/g,function(L){return String.fromCharCode(parseInt(L.slice(1),16))});return _n(D.join(`\r
`))}function F3(N,D,F){for(var I="",P="",L="",X,ae=0;ae<10;++ae){var Y=D[ae];if(!Y||Y.match(/^\s*$/))break;var Q=Y.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":I=Q[2].trim();break;case"content-type":L=Q[2].trim();break;case"content-transfer-encoding":P=Q[2].trim();break}}switch(++ae,P.toLowerCase()){case"base64":X=_n(gi(D.slice(ae).join("")));break;case"quoted-printable":X=O3(D.slice(ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+P)}var Z=Zu(N,I.slice(F.length),X,{unsafe:!0});L&&(Z.ctype=L)}function I3(N,D){if(re(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=D&&D.root||"",I=(et&&Buffer.isBuffer(N)?N.toString("binary"):re(N)).split(`\r
`),P=0,L="";for(P=0;P<I.length;++P)if(L=I[P],!!/^Content-Location:/i.test(L)&&(L=L.slice(L.indexOf("file")),F||(F=L.slice(0,L.lastIndexOf("/")+1)),L.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),L.slice(0,F.length)!=F););var X=(I[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var ae="--"+(X[1]||""),Y=[],Q=[],Z={FileIndex:Y,FullPaths:Q};S(Z);var me,_e=0;for(P=0;P<I.length;++P){var Ce=I[P];Ce!==ae&&Ce!==ae+"--"||(_e++&&F3(Z,I.slice(me,P),F),me=P)}return Z}function j3(N,D){var F=D||{},I=F.boundary||"SheetJS";I="------="+I;for(var P=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+I.slice(2)+'"',"","",""],L=N.FullPaths[0],X=L,ae=N.FileIndex[0],Y=1;Y<N.FullPaths.length;++Y)if(X=N.FullPaths[Y].slice(L.length),ae=N.FileIndex[Y],!(!ae.size||!ae.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(De){return"_x"+De.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(De){return"_u"+De.charCodeAt(0).toString(16)+"_"});for(var Q=ae.content,Z=et&&Buffer.isBuffer(Q)?Q.toString("binary"):re(Q),me=0,_e=Math.min(1024,Z.length),Ce=0,ve=0;ve<=_e;++ve)(Ce=Z.charCodeAt(ve))>=32&&Ce<128&&++me;var Ae=me>=_e*4/5;P.push(I),P.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+X),P.push("Content-Transfer-Encoding: "+(Ae?"quoted-printable":"base64")),P.push("Content-Type: "+C3(ae,X)),P.push(""),P.push(Ae?R3(Z):k3(Z))}return P.push(I+`--\r
`),P.join(`\r
`)}function D3(N){var D={};return S(D,N),D}function Zu(N,D,F,I){var P=I&&I.unsafe;P||S(N);var L=!P&&ct.find(N,D);if(!L){var X=N.FullPaths[0];D.slice(0,X.length)==X?X=D:(X.slice(-1)!="/"&&(X+="/"),X=(X+D).replace("//","/")),L={name:i(D),type:2},N.FileIndex.push(L),N.FullPaths.push(X),P||ct.utils.cfb_gc(N)}return L.content=F,L.size=F?F.length:0,I&&(I.CLSID&&(L.clsid=I.CLSID),I.mt&&(L.mt=I.mt),I.ct&&(L.ct=I.ct)),L}function P3(N,D){S(N);var F=ct.find(N,D);if(F){for(var I=0;I<N.FileIndex.length;++I)if(N.FileIndex[I]==F)return N.FileIndex.splice(I,1),N.FullPaths.splice(I,1),!0}return!1}function M3(N,D,F){S(N);var I=ct.find(N,D);if(I){for(var P=0;P<N.FileIndex.length;++P)if(N.FileIndex[P]==I)return N.FileIndex[P].name=i(F),N.FullPaths[P]=F,!0}return!1}function L3(N){A(N,!0)}return t.find=C,t.read=T,t.parse=u,t.write=O,t.writeFile=ee,t.utils={cfb_new:D3,cfb_add:Zu,cfb_del:P3,cfb_mov:M3,cfb_gc:L3,ReadShift:ko,CheckField:uC,prep_blob:Br,bconcat:er,use_zlib:B,_deflateRaw:We,_inflateRaw:ar,consts:he},t})();function W6(e){return typeof e=="string"?Mu(e):Array.isArray(e)?v6(e):e}function El(e,t,r){if(typeof Deno!="undefined"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Mu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?rl(t):t;if(typeof IE_SaveFile!="undefined")return IE_SaveFile(n,e);if(typeof Blob!="undefined"){var i=new Blob([W6(n)],{type:"application/octet-stream"});if(typeof navigator!="undefined"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs!="undefined")return saveAs(i,e);if(typeof URL!="undefined"&&typeof document!="undefined"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Tl(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function nr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Pb(e,t){for(var r=[],n=nr(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function ux(e){for(var t=[],r=nr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Uu(e){for(var t=[],r=nr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function G6(e){for(var t=[],r=nr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Kc=new Date(1899,11,30,0,0,0);function kr(e,t){var r=e.getTime(),n=Kc.getTime()+(e.getTimezoneOffset()-Kc.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var GA=new Date,Y6=Kc.getTime()+(GA.getTimezoneOffset()-Kc.getTimezoneOffset())*6e4,Mb=GA.getTimezoneOffset();function YA(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Y6),t.getTimezoneOffset()!==Mb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Mb)*6e4),t}var Lb=new Date("2017-02-19T19:06:09.000Z"),XA=isNaN(Lb.getFullYear())?new Date("2/19/17"):Lb,X6=XA.getFullYear()==2017;function Sr(e,t){var r=new Date(e);if(X6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(XA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function qu(e,t){if(et&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder!="undefined")try{var r={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(a){return r[a]||a})}catch(a){}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Rr(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Rr(e[r]));return t}function Ct(e,t){for(var r="";r.length<t;)r+=e;return r}function ui(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var K6=["january","february","march","april","may","june","july","august","september","october","november","december"];function tl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&K6.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Ve(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return et?n=Ti(r):n=y6(r),ct.utils.cfb_add(e,t,n)}ct.utils.cfb_add(e,t,r)}else e.file(t,r)}function fx(){return ct.utils.cfb_new()}var Bt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Q6={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},hx=ux(Q6),dx=/[&<>'"]/g,Z6=/[\u0000-\u0008\u000b-\u001f]/g;function st(e){var t=e+"";return t.replace(dx,function(r){return hx[r]}).replace(Z6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Bb(e){return st(e).replace(/ /g,"_x0020_")}var KA=/[\u0000-\u001f]/g;function J6(e){var t=e+"";return t.replace(dx,function(r){return hx[r]}).replace(/\n/g,"<br/>").replace(KA,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function eL(e){var t=e+"";return t.replace(dx,function(r){return hx[r]}).replace(KA,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function tL(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function rL(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function om(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Ub(e){var t=Da(2*e.length),r,n,i=1,a=0,s=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[a++]=s&255,t[a++]=s>>>8,s=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function qb(e){return Ti(e,"binary").toString("utf8")}var ic="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",Co=et&&(qb(ic)==om(ic)&&qb||Ub(ic)==om(ic)&&Ub)||om,rl=et?function(e){return Ti(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},nL=(function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}})(),QA=/(^\s|\s$|\n)/;function tr(e,t){return"<"+e+(t.match(QA)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function nl(e){return nr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ye(e,t,r){return"<"+e+(r!=null?nl(r):"")+(t!=null?(t.match(QA)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function yp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function iL(e,t){switch(typeof e){case"string":var r=ye("vt:lpwstr",st(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ye((e|0)==e?"vt:i4":"vt:r8",st(String(e)));case"boolean":return ye("vt:bool",e?"true":"false")}if(e instanceof Date)return ye("vt:filetime",yp(e));throw new Error("Unable to serialize "+e)}var Gt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Vs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],qr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function aL(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function sL(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=n?-t:t;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var zb=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Hb=et?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ti(t)})):zb(e)}:zb,$b=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(So(e,i)));return n.join("").replace(Ao,"")},mx=et?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ao,""):$b(e,t,r)}:$b,Vb=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},ZA=et?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Vb(e,t,r)}:Vb,Wb=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(os(e,i)));return n.join("")},Nl=et?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Wb(t,r,n)}:Wb,JA=function(e,t){var r=zr(e,t);return r>0?Nl(e,t+4,t+4+r-1):""},eC=JA,tC=function(e,t){var r=zr(e,t);return r>0?Nl(e,t+4,t+4+r-1):""},rC=tC,nC=function(e,t){var r=2*zr(e,t);return r>0?Nl(e,t+4,t+4+r-1):""},iC=nC,aC=function(t,r){var n=zr(t,r);return n>0?mx(t,r+4,r+4+n):""},sC=aC,oC=function(e,t){var r=zr(e,t);return r>0?Nl(e,t+4,t+4+r):""},lC=oC,cC=function(e,t){return aL(e,t)},Qc=cC,px=function(t){return Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array};et&&(eC=function(t,r){if(!Buffer.isBuffer(t))return JA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},rC=function(t,r){if(!Buffer.isBuffer(t))return tC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},iC=function(t,r){if(!Buffer.isBuffer(t))return nC(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},sC=function(t,r){if(!Buffer.isBuffer(t))return aC(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},lC=function(t,r){if(!Buffer.isBuffer(t))return oC(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Qc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):cC(t,r)},px=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array});var os=function(e,t){return e[t]},So=function(e,t){return e[t+1]*256+e[t]},oL=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},zr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ga=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},lL=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ko(e,t){var r="",n,i,a=[],s,o,l,c;switch(t){case"dbcs":if(c=this.l,et&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(So(this,c)),c+=2;e*=2;break;case"utf8":r=Nl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=mx(this,this.l,this.l+e);break;case"wstr":return ko.call(this,e,"dbcs");case"lpstr-ansi":r=eC(this,this.l),e=4+zr(this,this.l);break;case"lpstr-cp":r=rC(this,this.l),e=4+zr(this,this.l);break;case"lpwstr":r=iC(this,this.l),e=4+2*zr(this,this.l);break;case"lpp4":e=4+zr(this,this.l),r=sC(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+zr(this,this.l),r=lC(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=os(this,this.l+e++))!==0;)a.push(tc(s));r=a.join("");break;case"_wstr":for(e=0,r="";(s=So(this,this.l+e))!==0;)a.push(tc(s)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=os(this,c),this.l=c+1,o=ko.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(tc(So(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=os(this,c),this.l=c+1,o=ko.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(tc(os(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return n=os(this,this.l),this.l++,n;case 2:return n=(t==="i"?oL:So)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?ga:lL)(this,this.l),this.l+=4,n):(i=zr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Qc(this,this.l):i=Qc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=ZA(this,this.l,e);break}}return this.l+=e,r}var cL=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},uL=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},fL=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function hL(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)fL(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,cL(this,t,this.l);break;case 8:if(n=8,r==="f"){sL(this,t,this.l);break}case 16:break;case-4:n=4,uL(this,t,this.l);break}return this.l+=n,this}function uC(e,t){var r=ZA(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Br(e,t){e.l=t,e.read_shift=ko,e.chk=uC,e.write_shift=hL}function Gn(e,t){e.l+=t}function ne(e){var t=Da(e);return Br(t,0),t}function Nr(){var e=[],t=et?256:2048,r=function(c){var u=ne(c);return Br(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},s=function(){return i(),er(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:s,_bufs:e}}function oe(e,t,r,n){var i=+t,a;if(!isNaN(i)){n||(n=az[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var s=e.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&px(r)&&e.push(r)}}function Ro(e,t,r){var n=Rr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Gb(e,t,r){var n=Rr(e);return n.s=Ro(n.s,t.s,r),n.e=Ro(n.e,t.s,r),n}function Oo(e,t){if(e.cRel&&e.c<0)for(e=Rr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Rr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ot(e);return!e.cRel&&e.cRel!=null&&(r=pL(r)),!e.rRel&&e.rRel!=null&&(r=dL(r)),r}function lm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+fr(e.s.c)+":"+(e.e.cRel?"":"$")+fr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+rr(e.s.r)+":"+(e.e.rRel?"":"$")+rr(e.e.r):Oo(e.s,t.biff)+":"+Oo(e.e,t.biff)}function gx(e){return parseInt(mL(e),10)-1}function rr(e){return""+(e+1)}function dL(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function mL(e){return e.replace(/\$(\d+)$/,"$1")}function xx(e){for(var t=gL(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function fr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function pL(e){return e.replace(/^([A-Z])/,"$$$1")}function gL(e){return e.replace(/^\$([A-Z])/,"$1")}function xL(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Yt(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function ot(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Gr(e){var t=e.indexOf(":");return t==-1?{s:Yt(e),e:Yt(e)}:{s:Yt(e.slice(0,t)),e:Yt(e.slice(t+1))}}function Lt(e,t){return typeof t=="undefined"||typeof t=="number"?Lt(e.s,e.e):(typeof e!="string"&&(e=ot(e)),typeof t!="string"&&(t=ot(t)),e==t?e:e+":"+t)}function yt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Yb(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Gi(e.z,r?kr(t):t)}catch(n){}try{return e.w=Gi((e.XF||{}).numFmtId||(r?14:0),r?kr(t):t)}catch(n){return""+t}}function xi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Al[e.v]||e.v:t==null?Yb(e,e.v):Yb(e,t))}function Wa(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function fC(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Yt(n.origin):n.origin;s=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=yt(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[h].length;++m)if(typeof t[h][m]!="undefined"){var d={v:t[h][m]},g=s+h,p=o+m;if(c.s.r>g&&(c.s.r=g),c.s.c>p&&(c.s.c=p),c.e.r<g&&(c.e.r=g),c.e.c<p&&(c.e.c=p),t[h][m]&&typeof t[h][m]=="object"&&!Array.isArray(t[h][m])&&!(t[h][m]instanceof Date))d=t[h][m];else if(Array.isArray(d.v)&&(d.f=t[h][m][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Rt[14],n.cellDates?(d.t="d",d.w=Gi(d.z,kr(d.v))):(d.t="n",d.v=kr(d.v),d.w=Gi(d.z,d.v))):d.t="s";if(i)a[g]||(a[g]=[]),a[g][p]&&a[g][p].z&&(d.z=a[g][p].z),a[g][p]=d;else{var x=ot({c:p,r:g});a[x]&&a[x].z&&(d.z=a[x].z),a[x]=d}}}return c.s.c<1e7&&(a["!ref"]=Lt(c)),a}function Ws(e,t){return fC(null,e,t)}function vL(e){return e.read_shift(4,"i")}function Nn(e,t){return t||(t=ne(4)),t.write_shift(4,e),t}function hr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Xt(e,t){var r=!1;return t==null&&(r=!0,t=ne(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function yL(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function wL(e,t){return t||(t=ne(4)),t.write_shift(2,0),t.write_shift(2,0),t}function vx(e,t){var r=e.l,n=e.read_shift(1),i=hr(e),a=[],s={t:i,h:i};if((n&1)!==0){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(yL(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function bL(e,t){var r=!1;return t==null&&(r=!0,t=ne(15+4*e.t.length)),t.write_shift(1,0),Xt(e.t,t),r?t.slice(0,t.l):t}var _L=vx;function SL(e,t){var r=!1;return t==null&&(r=!0,t=ne(23+4*e.t.length)),t.write_shift(1,1),Xt(e.t,t),t.write_shift(4,1),wL({},t),r?t.slice(0,t.l):t}function un(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ga(e,t){return t==null&&(t=ne(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ya(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Xa(e,t){return t==null&&(t=ne(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var TL=hr,hC=Xt;function yx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Zc(e,t){var r=!1;return t==null&&(r=!0,t=ne(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var EL=hr,wp=yx,wx=Zc;function dC(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Qc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ga(t,0)>>2;return r?i/100:i}function mC(e,t){t==null&&(t=ne(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function pC(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function NL(e,t){return t||(t=ne(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ka=pC,Gs=NL;function Ys(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Pa(e,t){return(t||ne(8)).write_shift(8,e,"f")}function AL(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=PL[i];c&&(t.rgb=a_(c));break;case 2:t.rgb=a_([s,o,l]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Jc(e,t){if(t||(t=ne(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function CL(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function kL(e,t){t||(t=ne(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var gC=2,Mr=3,ac=11,eu=19,sc=64,RL=65,OL=71,FL=4108,IL=4126,Jt=80,Xb={1:{n:"CodePage",t:gC},2:{n:"Category",t:Jt},3:{n:"PresentationFormat",t:Jt},4:{n:"ByteCount",t:Mr},5:{n:"LineCount",t:Mr},6:{n:"ParagraphCount",t:Mr},7:{n:"SlideCount",t:Mr},8:{n:"NoteCount",t:Mr},9:{n:"HiddenCount",t:Mr},10:{n:"MultimediaClipCount",t:Mr},11:{n:"ScaleCrop",t:ac},12:{n:"HeadingPairs",t:FL},13:{n:"TitlesOfParts",t:IL},14:{n:"Manager",t:Jt},15:{n:"Company",t:Jt},16:{n:"LinksUpToDate",t:ac},17:{n:"CharacterCount",t:Mr},19:{n:"SharedDoc",t:ac},22:{n:"HyperlinksChanged",t:ac},23:{n:"AppVersion",t:Mr,p:"version"},24:{n:"DigSig",t:RL},26:{n:"ContentType",t:Jt},27:{n:"ContentStatus",t:Jt},28:{n:"Language",t:Jt},29:{n:"Version",t:Jt},255:{},2147483648:{n:"Locale",t:eu},2147483651:{n:"Behavior",t:eu},1919054434:{}},Kb={1:{n:"CodePage",t:gC},2:{n:"Title",t:Jt},3:{n:"Subject",t:Jt},4:{n:"Author",t:Jt},5:{n:"Keywords",t:Jt},6:{n:"Comments",t:Jt},7:{n:"Template",t:Jt},8:{n:"LastAuthor",t:Jt},9:{n:"RevNumber",t:Jt},10:{n:"EditTime",t:sc},11:{n:"LastPrinted",t:sc},12:{n:"CreatedDate",t:sc},13:{n:"ModifiedDate",t:sc},14:{n:"PageCount",t:Mr},15:{n:"WordCount",t:Mr},16:{n:"CharCount",t:Mr},17:{n:"Thumbnail",t:OL},18:{n:"Application",t:Jt},19:{n:"DocSecurity",t:Mr},255:{},2147483648:{n:"Locale",t:eu},2147483651:{n:"Behavior",t:eu},1919054434:{}};function jL(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var DL=jL([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),PL=Rr(DL),Al={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ML={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},oc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function xC(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function vC(e,t){var r=G6(ML),n=[],i;n[n.length]=Bt,n[n.length]=ye("Types",null,{xmlns:Gt.CT,"xmlns:xsd":Gt.xsd,"xmlns:xsi":Gt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ye("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=ye("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:oc[l][t.bookType]||oc[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(c){n[n.length]=ye("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:oc[l][t.bookType]||oc[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=ye("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return a("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Qe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function yC(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ws(e){var t=[Bt,ye("Relationships",null,{xmlns:Gt.RELS})];return nr(e["!id"]).forEach(function(r){t[t.length]=ye("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function at(e,t,r,n,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Qe.HLINK,Qe.XPATH,Qe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function LL(e){var t=[Bt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Qb(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function BL(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function UL(e){var t=[Bt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Qb(e[r][0],e[r][1])),t.push(BL("",e[r][0]));return t.push(Qb("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function wC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Wc.version+"</meta:generator></office:meta></office:document-meta>"}var ka=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function cm(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=st(t),n[n.length]=r?ye(e,t,r):tr(e,t))}function bC(e,t){var r=t||{},n=[Bt,ye("cp:coreProperties",null,{"xmlns:cp":Gt.CORE_PROPS,"xmlns:dc":Gt.dc,"xmlns:dcterms":Gt.dcterms,"xmlns:dcmitype":Gt.dcmitype,"xmlns:xsi":Gt.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&cm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:yp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&cm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:yp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=ka.length;++a){var s=ka[a],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&cm(s[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var bs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],_C=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function SC(e){var t=[],r=ye;return e||(e={}),e.Application="SheetJS",t[t.length]=Bt,t[t.length]=ye("Properties",null,{xmlns:Gt.EXT_PROPS,"xmlns:vt":Gt.vt}),bs.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=st(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+st(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function TC(e){var t=[Bt,ye("Properties",null,{xmlns:Gt.CUST_PROPS,"xmlns:vt":Gt.vt})];if(!e)return t.join("");var r=1;return nr(e).forEach(function(i){++r,t[t.length]=ye("property",iL(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:st(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Zb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function qL(e,t){var r=[];return nr(Zb).map(function(n){for(var i=0;i<ka.length;++i)if(ka[i][1]==n)return ka[i];for(i=0;i<bs.length;++i)if(bs[i][1]==n)return bs[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(tr(Zb[n[1]]||n[1],i))}}),ye("DocumentProperties",r.join(""),{xmlns:qr.o})}function zL(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&nr(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var s=0;s<ka.length;++s)if(a==ka[s][1])return;for(s=0;s<bs.length;++s)if(a==bs[s][1])return;for(s=0;s<r.length;++s)if(a==r[s])return;var o=e[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(ye(Bb(a),o,{"dt:dt":l}))}}),t&&nr(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var s=t[a],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),i.push(ye(Bb(a),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+qr.o+'">'+i.join("")+"</"+n+">"}function HL(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var s=ne(8);return s.write_shift(4,n),s.write_shift(4,i),s}function Jb(e,t){var r=ne(4),n=ne(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ne(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=HL(t);break;case 31:case 80:for(n=ne(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return er([r,n])}var EC=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function $L(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function e_(e,t,r){var n=ne(8),i=[],a=[],s=8,o=0,l=ne(8),c=ne(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),i.push(c),s+=8+l.length,!t){c=ne(8),c.write_shift(4,0),i.unshift(c);var u=[ne(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=ne(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=er(u),a.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(EC.indexOf(e[o][0])>-1||_C.indexOf(e[o][0])>-1)&&e[o][1]!=null){var m=e[o][1],d=0;if(t){d=+t[e[o][0]];var g=r[d];if(g.p=="version"&&typeof m=="string"){var p=m.split(".");m=(+p[0]<<16)+(+p[1]||0)}l=Jb(g.t,m)}else{var x=$L(m);x==-1&&(x=31,m=String(m)),l=Jb(x,m)}a.push(l),c=ne(8),c.write_shift(4,t?d:2+o),i.push(c),s+=8+l.length}var v=8*(a.length+1);for(o=0;o<a.length;++o)i[o].write_shift(4,v),v+=a[o].length;return n.write_shift(4,s),n.write_shift(4,a.length),er([n].concat(i).concat(a))}function t_(e,t,r,n,i,a){var s=ne(i?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,ct.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,i?68:48);var l=e_(e,r,n);if(o.push(l),i){var c=e_(i,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+l.length),o.push(c)}return er(o)}function VL(e,t){t||(t=ne(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function WL(e,t){return e.read_shift(t)===1}function yr(e,t){return t||(t=ne(2)),t.write_shift(2,+!!e),t}function NC(e){return e.read_shift(2,"u")}function tn(e,t){return t||(t=ne(2)),t.write_shift(2,e),t}function AC(e,t,r){return r||(r=ne(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function CC(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?e.read_shift(n,i):"";return s}function GL(e){var t=e.t||"",r=ne(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ne(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return er(i)}function YL(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function XL(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):YL(e,n,r)}function KL(e,t,r){if(r.biff>5)return XL(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function kC(e,t,r){return r||(r=ne(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function r_(e,t){t||(t=ne(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function QL(e){var t=ne(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(a==28)n=n.slice(1),r_(n,t);else if(a&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&r_(i>-1?n.slice(i+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Ma(e,t,r,n){return n||(n=ne(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function ZL(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[i,a,s]}function JL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function RC(e,t){return t||(t=ne(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function bx(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ne(i);return a.write_shift(2,n),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function eB(e,t){var r=!t||t.biff==8,n=ne(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function tB(e,t){var r=!t||t.biff>=8?2:1,n=ne(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function rB(e,t){var r=ne(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=GL(e[i]);var a=er([r].concat(n));return a.parts=[r.length].concat(n.map(function(s){return s.length})),a}function nB(){var e=ne(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function iB(e){var t=ne(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function aB(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,a=ne(i);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function sB(e,t,r,n){var i=ne(10);return Ma(e,t,n,i),i.write_shift(4,r),i}function oB(e,t,r,n,i){var a=!i||i.biff==8,s=ne(8+ +a+(1+a)*r.length);return Ma(e,t,n,s),s.write_shift(2,r.length),a&&s.write_shift(1,1),s.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),s}function lB(e,t,r,n){var i=r&&r.biff==5;n||(n=ne(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function cB(e,t){var r=t.biff==8||!t.biff?4:2,n=ne(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function n_(e,t,r,n){var i=r&&r.biff==5;n||(n=ne(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function uB(e){var t=ne(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function fB(e,t,r,n,i,a){var s=ne(8);return Ma(e,t,n,s),AC(r,a,s),s}function hB(e,t,r,n){var i=ne(14);return Ma(e,t,n,i),Pa(r,i),i}function dB(e,t,r){if(r.biff<8)return mB(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(ZL(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function mB(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=CC(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function pB(e){var t=ne(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)RC(e[r],t);return t}function gB(e){var t=ne(24),r=Yt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return er([t,QL(e[1])])}function xB(e){var t=e[1].Tooltip,r=ne(10+2*(t.length+1));r.write_shift(2,2048);var n=Yt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function vB(e){return e||(e=ne(4)),e.write_shift(2,1),e.write_shift(2,1),e}function yB(e,t,r){if(!r.cellStyles)return Gn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:a,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function wB(e,t){var r=ne(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function bB(e){for(var t=ne(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function _B(e,t,r){var n=ne(15);return kl(n,e,t),n.write_shift(8,r,"f"),n}function SB(e,t,r){var n=ne(9);return kl(n,e,t),n.write_shift(2,r),n}var TB=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ux({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Da(1);switch(l.type){case"base64":u=_n(gi(o));break;case"binary":u=_n(o);break;case"buffer":case"array":u=o;break}Br(u,0);var h=u.read_shift(1),m=!!(h&136),d=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,m=!0;break;case 49:d=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var p=0,x=521;h==2&&(p=u.read_shift(2)),u.l+=3,h!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),h!=2&&(x=u.read_shift(2));var v=u.read_shift(2),b=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var y=[],w={},k=Math.min(u.length,h==2?521:x-10-(d?264:0)),T=g?32:11;u.l<k&&u[u.l]!=13;)switch(w={},w.name=Ab.utils.decode(b,u.slice(u.l,u.l+T)).replace(/[\u0000\r\n].*$/g,""),u.l+=T,w.type=String.fromCharCode(u.read_shift(1)),h!=2&&!g&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),h==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&y.push(w),h!=2&&(u.l+=g?13:14),w.type){case"B":(!d||w.len!=8)&&l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var S=0,E=0;for(c[0]=[],E=0;E!=y.length;++E)c[0][E]=y[E].name;for(;p-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++S]=[],E=0,E=0;E!=y.length;++E){var A=u.slice(u.l,u.l+y[E].len);u.l+=y[E].len,Br(A,0);var R=Ab.utils.decode(b,A);switch(y[E].type){case"C":R.trim().length&&(c[S][E]=R.replace(/\s+$/,""));break;case"D":R.length===8?c[S][E]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):c[S][E]=R;break;case"F":c[S][E]=parseFloat(R.trim());break;case"+":case"I":c[S][E]=g?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":c[S][E]=!0;break;case"N":case"F":c[S][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[S][E]="##MEMO##"+(g?parseInt(R.trim(),10):A.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(c[S][E]=+R||0);break;case"@":c[S][E]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":c[S][E]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":c[S][E]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[S][E]=-A.read_shift(-8,"f");break;case"B":if(d&&y[E].len==8){c[S][E]=A.read_shift(8,"f");break}case"G":case"P":A.l+=y[E].len;break;case"0":if(y[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[E].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Ws(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(o,l){try{return Wa(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&Jo(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Nr(),h=au(o,{header:1,raw:!0,cellDates:!0}),m=h[0],d=h.slice(1),g=o["!cols"]||[],p=0,x=0,v=0,b=1;for(p=0;p<m.length;++p){if(((g[p]||{}).DBF||{}).name){m[p]=g[p].DBF.name,++v;continue}if(m[p]!=null){if(++v,typeof m[p]=="number"&&(m[p]=m[p].toString(10)),typeof m[p]!="string")throw new Error("DBF Invalid column name "+m[p]+" |"+typeof m[p]+"|");if(m.indexOf(m[p])!==p){for(x=0;x<1024;++x)if(m.indexOf(m[p]+"_"+x)==-1){m[p]+="_"+x;break}}}}var y=yt(o["!ref"]),w=[],k=[],T=[];for(p=0;p<=y.e.c-y.s.c;++p){var S="",E="",A=0,R=[];for(x=0;x<d.length;++x)d[x][p]!=null&&R.push(d[x][p]);if(R.length==0||m[p]==null){w[p]="?";continue}for(x=0;x<R.length;++x){switch(typeof R[x]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=R[x]instanceof Date?"D":"C";break;default:E="C"}A=Math.max(A,String(R[x]).length),S=S&&S!=E?"C":E}A>250&&(A=250),E=((g[p]||{}).DBF||{}).type,E=="C"&&g[p].DBF.len>A&&(A=g[p].DBF.len),S=="B"&&E=="N"&&(S="N",T[p]=g[p].DBF.dec,A=g[p].DBF.len),k[p]=S=="C"||E=="N"?A:a[S]||0,b+=k[p],w[p]=S}var C=u.next(32);for(C.write_shift(4,318902576),C.write_shift(4,d.length),C.write_shift(2,296+32*v),C.write_shift(2,b),p=0;p<4;++p)C.write_shift(4,0);for(C.write_shift(4,0|(+t[FA]||3)<<8),p=0,x=0;p<m.length;++p)if(m[p]!=null){var j=u.next(32),z=(m[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,z,"sbcs"),j.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),j.write_shift(4,x),j.write_shift(1,k[p]||a[w[p]]||0),j.write_shift(1,T[p]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),x+=k[p]||a[w[p]]||0}var G=u.next(264);for(G.write_shift(4,13),p=0;p<65;++p)G.write_shift(4,0);for(p=0;p<d.length;++p){var W=u.next(b);for(W.write_shift(1,0),x=0;x<m.length;++x)if(m[x]!=null)switch(w[x]){case"L":W.write_shift(1,d[p][x]==null?63:d[p][x]?84:70);break;case"B":W.write_shift(8,d[p][x]||0,"f");break;case"N":var fe="0";for(typeof d[p][x]=="number"&&(fe=d[p][x].toFixed(T[x]||0)),v=0;v<k[x]-fe.length;++v)W.write_shift(1,32);W.write_shift(1,fe,"sbcs");break;case"D":d[p][x]?(W.write_shift(4,("0000"+d[p][x].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(d[p][x].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+d[p][x].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var he=String(d[p][x]!=null?d[p][x]:"").slice(0,k[x]);for(W.write_shift(1,he,"sbcs"),v=0;v<k[x]-he.length;++v)W.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}})(),EB=(function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+nr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,d){var g=e[d];return typeof g=="number"?Nb(g):g},n=function(m,d,g){var p=d.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?m:Nb(p)};e["|"]=254;function i(m,d){switch(d.type){case"base64":return a(gi(m),d);case"binary":return a(m,d);case"buffer":return a(et&&Buffer.isBuffer(m)?m.toString("binary"):Tl(m),d);case"array":return a(qu(m),d)}throw new Error("Unrecognized type "+d.type)}function a(m,d){var g=m.split(/[\n\r]+/),p=-1,x=-1,v=0,b=0,y=[],w=[],k=null,T={},S=[],E=[],A=[],R=0,C;for(+d.codepage>=0&&Jo(+d.codepage);v!==g.length;++v){R=0;var j=g[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),z=j.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),G=z[0],W;if(j.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&w.push(j.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,he=!1,ee=!1,re=!1,O=-1,ge=-1;for(b=1;b<z.length;++b)switch(z[b].charAt(0)){case"A":break;case"X":x=parseInt(z[b].slice(1))-1,he=!0;break;case"Y":for(p=parseInt(z[b].slice(1))-1,he||(x=0),C=y.length;C<=p;++C)y[C]=[];break;case"K":W=z[b].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(ui(W))?isNaN(tl(W).getDate())||(W=Sr(W)):(W=ui(W),k!==null&&$A(k)&&(W=YA(W))),fe=!0;break;case"E":re=!0;var B=S7(z[b].slice(1),{r:p,c:x});y[p][x]=[y[p][x],B];break;case"S":ee=!0,y[p][x]=[y[p][x],"S5S"];break;case"G":break;case"R":O=parseInt(z[b].slice(1))-1;break;case"C":ge=parseInt(z[b].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+j)}if(fe&&(y[p][x]&&y[p][x].length==2?y[p][x][0]=W:y[p][x]=W,k=null),ee){if(re)throw new Error("SYLK shared formula cannot have own formula");var _=O>-1&&y[O][ge];if(!_||!_[1])throw new Error("SYLK shared formula cannot find base");y[p][x][1]=T7(_[1],{r:p-O,c:x-ge})}break;case"F":var M=0;for(b=1;b<z.length;++b)switch(z[b].charAt(0)){case"X":x=parseInt(z[b].slice(1))-1,++M;break;case"Y":for(p=parseInt(z[b].slice(1))-1,C=y.length;C<=p;++C)y[C]=[];break;case"M":R=parseInt(z[b].slice(1))/20;break;case"F":break;case"G":break;case"P":k=w[parseInt(z[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=z[b].slice(1).split(" "),C=parseInt(A[0],10);C<=parseInt(A[1],10);++C)R=parseInt(A[2],10),E[C-1]=R===0?{hidden:!0}:{wch:R},_x(E[C-1]);break;case"C":x=parseInt(z[b].slice(1))-1,E[x]||(E[x]={});break;case"R":p=parseInt(z[b].slice(1))-1,S[p]||(S[p]={}),R>0?(S[p].hpt=R,S[p].hpx=DC(R)):R===0&&(S[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+j)}M<1&&(k=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+j)}}return S.length>0&&(T["!rows"]=S),E.length>0&&(T["!cols"]=E),d&&d.sheetRows&&(y=y.slice(0,d.sheetRows)),[y,T]}function s(m,d){var g=i(m,d),p=g[0],x=g[1],v=Ws(p,d);return nr(x).forEach(function(b){v[b]=x[b]}),v}function o(m,d){return Wa(s(m,d),d)}function l(m,d,g,p){var x="C;Y"+(g+1)+";X"+(p+1)+";K";switch(m.t){case"n":x+=m.v||0,m.f&&!m.F&&(x+=";E"+Tx(m.f,{r:g,c:p}));break;case"b":x+=m.v?"TRUE":"FALSE";break;case"e":x+=m.w||m.v;break;case"d":x+='"'+(m.w||m.v)+'"';break;case"s":x+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function c(m,d){d.forEach(function(g,p){var x="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=tu(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=ru(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&m.push(x)})}function u(m,d){d.forEach(function(g,p){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*nu(g.hpx)+";"),x.length>2&&m.push(x+"R"+(p+1))})}function h(m,d){var g=["ID;PWXL;N;E"],p=[],x=yt(m["!ref"]),v,b=Array.isArray(m),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&c(g,m["!cols"]),m["!rows"]&&u(g,m["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var w=x.s.r;w<=x.e.r;++w)for(var k=x.s.c;k<=x.e.c;++k){var T=ot({r:w,c:k});v=b?(m[w]||[])[k]:m[T],!(!v||v.v==null&&(!v.f||v.F))&&p.push(l(v,m,w,k))}return g.join(y)+y+p.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:s,from_sheet:h}})(),NB=(function(){function e(a,s){switch(s.type){case"base64":return t(gi(a),s);case"binary":return t(a,s);case"buffer":return t(et&&Buffer.isBuffer(a)?a.toString("binary"):Tl(a),s);case"array":return t(qu(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){for(var o=a.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var m=o[u].trim().split(","),d=m[0],g=m[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+d){case-1:if(p==="BOT"){h[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?h[l][c]=!0:p==="FALSE"?h[l][c]=!1:isNaN(ui(g))?isNaN(tl(g).getDate())?h[l][c]=g:h[l][c]=Sr(g):h[l][c]=ui(g),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),h[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function r(a,s){return Ws(e(a,s),s)}function n(a,s){return Wa(r(a,s),s)}var i=(function(){var a=function(l,c,u,h,m){l.push(c),l.push(u+","+h),l.push('"'+m.replace(/"/g,'""')+'"')},s=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=yt(l["!ref"]),h,m=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){s(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var p=ot({r:d,c:g});if(h=m?(l[d]||[])[g]:l[p],!h){s(c,1,0,"");continue}switch(h.t){case"n":var x=h.w;!x&&h.v!=null&&(x=h.v),x==null?h.f&&!h.F?s(c,1,0,"="+h.f):s(c,1,0,""):s(c,0,x,"V");break;case"b":s(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Gi(h.z||Rt[14],kr(Sr(h.v)))),s(c,0,h.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var v=`\r
`,b=c.join(v);return b}})();return{to_workbook:n,to_sheet:r,from_sheet:i}})(),OC=(function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var d=h.split(`
`),g=-1,p=-1,x=0,v=[];x!==d.length;++x){var b=d[x].trim().split(":");if(b[0]==="cell"){var y=Yt(b[1]);if(v.length<=y.r)for(g=v.length;g<=y.r;++g)v[g]||(v[g]=[]);switch(g=y.r,p=y.c,b[2]){case"t":v[g][p]=e(b[3]);break;case"v":v[g][p]=+b[3];break;case"vtf":var w=b[b.length-1];case"vtc":switch(b[3]){case"nl":v[g][p]=!!+b[4];break;default:v[g][p]=+b[4];break}b[2]=="vtf"&&(v[g][p]=[v[g][p],w])}}}return m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}function n(h,m){return Ws(r(h,m),m)}function i(h,m){return Wa(n(h,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var m=[],d=[],g,p="",x=Gr(h["!ref"]),v=Array.isArray(h),b=x.s.r;b<=x.e.r;++b)for(var y=x.s.c;y<=x.e.c;++y)if(p=ot({r:b,c:y}),g=v?(h[b]||[])[y]:h[p],!(!g||g.v==null||g.t==="z")){switch(d=["cell",p,"t"],g.t){case"s":case"str":d.push(t(g.v));break;case"n":g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=t(g.f)):(d[2]="v",d[3]=g.v);break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var w=kr(Sr(g.v));d[2]="vtc",d[3]="nd",d[4]=""+w,d[5]=g.w||Gi(g.z||Rt[14],w);break;case"e":continue}m.push(d.join(":"))}return m.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(h){return[a,s,o,s,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}})(),AB=(function(){function e(u,h,m,d,g){g.raw?h[m][d]=u:u===""||(u==="TRUE"?h[m][d]=!0:u==="FALSE"?h[m][d]=!1:isNaN(ui(u))?isNaN(tl(u).getDate())?h[m][d]=u:h[m][d]=Sr(u):h[m][d]=ui(u))}function t(u,h){var m=h||{},d=[];if(!u||u.length===0)return d;for(var g=u.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var x=10,v=0,b=0;b<=p;++b)v=g[b].indexOf(" "),v==-1?v=g[b].length:v++,x=Math.max(x,v);for(b=0;b<=p;++b){d[b]=[];var y=0;for(e(g[b].slice(0,x).trim(),d,b,y,m),y=1;y<=(g[b].length-x)/10+1;++y)e(g[b].slice(x+(y-1)*10,x+y*10).trim(),d,b,y,m)}return m.sheetRows&&(d=d.slice(0,m.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},m=!1,d=0,g=0;d<u.length;++d)(g=u.charCodeAt(d))==34?m=!m:!m&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d]);if(!g.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d])}return g.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),r[g.pop()[1]]||44}function a(u,h){var m=h||{},d="",g=m.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):m&&m.FS?d=m.FS:d=i(u.slice(0,1024));var x=0,v=0,b=0,y=0,w=0,k=d.charCodeAt(0),T=!1,S=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var A=m.dateNF!=null?H6(m.dateNF):null;function R(){var C=u.slice(y,w),j={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)j.t="z";else if(m.raw)j.t="s",j.v=C;else if(C.trim().length===0)j.t="s",j.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(j.t="s",j.v=C.slice(2,-1).replace(/""/g,'"')):E7(C)?(j.t="n",j.f=C.slice(1)):(j.t="s",j.v=C);else if(C=="TRUE")j.t="b",j.v=!0;else if(C=="FALSE")j.t="b",j.v=!1;else if(!isNaN(b=ui(C)))j.t="n",m.cellText!==!1&&(j.w=C),j.v=b;else if(!isNaN(tl(C).getDate())||A&&C.match(A)){j.z=m.dateNF||Rt[14];var z=0;A&&C.match(A)&&(C=$6(C,m.dateNF,C.match(A)||[]),z=1),m.cellDates?(j.t="d",j.v=Sr(C,z)):(j.t="n",j.v=kr(Sr(C,z))),m.cellText!==!1&&(j.w=Gi(j.z,j.v instanceof Date?kr(j.v):j.v)),m.cellNF||delete j.z}else j.t="s",j.v=C;if(j.t=="z"||(m.dense?(g[x]||(g[x]=[]),g[x][v]=j):g[ot({c:v,r:x})]=j),y=w+1,E=u.charCodeAt(y),p.e.c<v&&(p.e.c=v),p.e.r<x&&(p.e.r=x),S==k)++v;else if(v=0,++x,m.sheetRows&&m.sheetRows<=x)return!0}e:for(;w<u.length;++w)switch(S=u.charCodeAt(w)){case 34:E===34&&(T=!T);break;case k:case 10:case 13:if(!T&&R())break e;break}return w-y>0&&R(),g["!ref"]=Lt(p),g}function s(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,h):Ws(t(u,h),h)}function o(u,h){var m="",d=h.type=="string"?[0,0,0,0]:Bz(u,h);switch(h.type){case"base64":m=gi(u);break;case"binary":m=u;break;case"buffer":h.codepage==65001?m=u.toString("utf8"):m=et&&Buffer.isBuffer(u)?u.toString("binary"):Tl(u);break;case"array":m=qu(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?m=Co(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001&&(m=Co(m)),m.slice(0,19)=="socialcalc:version:"?OC.to_sheet(h.type=="string"?m:Co(m),h):s(m,h)}function l(u,h){return Wa(o(u,h),h)}function c(u){for(var h=[],m=yt(u["!ref"]),d,g=Array.isArray(u),p=m.s.r;p<=m.e.r;++p){for(var x=[],v=m.s.c;v<=m.e.c;++v){var b=ot({r:p,c:v});if(d=g?(u[p]||[])[v]:u[b],!d||d.v==null){x.push("          ");continue}for(var y=(d.w||(xi(d),d.w)||"").slice(0,10);y.length<10;)y+=" ";x.push(y+(v===0?" ":""))}h.push(x.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})(),i_=(function(){function e(B,_,M){if(B){Br(B,B.l||0);for(var U=M.Enum||O;B.l<B.length;){var V=B.read_shift(2),le=U[V]||U[65535],de=B.read_shift(2),K=B.l+de,J=le.f&&le.f(B,de,M);if(B.l=K,_(J,le,V))return}}}function t(B,_){switch(_.type){case"base64":return r(_n(gi(B)),_);case"binary":return r(_n(B),_);case"buffer":case"array":return r(B,_)}throw"Unsupported type "+_.type}function r(B,_){if(!B)return B;var M=_||{},U=M.dense?[]:{},V="Sheet1",le="",de=0,K={},J=[],Se=[],te={s:{r:0,c:0},e:{r:0,c:0}},$e=M.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)M.Enum=O,e(B,function(Te,Ot,mr){switch(mr){case 0:M.vers=Te,Te>=4096&&(M.qpro=!0);break;case 6:te=Te;break;case 204:Te&&(le=Te);break;case 222:le=Te;break;case 15:case 51:M.qpro||(Te[1].v=Te[1].v.slice(1));case 13:case 14:case 16:mr==14&&(Te[2]&112)==112&&(Te[2]&15)>1&&(Te[2]&15)<15&&(Te[1].z=M.dateNF||Rt[14],M.cellDates&&(Te[1].t="d",Te[1].v=YA(Te[1].v))),M.qpro&&Te[3]>de&&(U["!ref"]=Lt(te),K[V]=U,J.push(V),U=M.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},de=Te[3],V=le||"Sheet"+(de+1),le="");var Qt=M.dense?(U[Te[0].r]||[])[Te[0].c]:U[ot(Te[0])];if(Qt){Qt.t=Te[1].t,Qt.v=Te[1].v,Te[1].z!=null&&(Qt.z=Te[1].z),Te[1].f!=null&&(Qt.f=Te[1].f);break}M.dense?(U[Te[0].r]||(U[Te[0].r]=[]),U[Te[0].r][Te[0].c]=Te[1]):U[ot(Te[0])]=Te[1];break}},M);else if(B[2]==26||B[2]==14)M.Enum=ge,B[2]==14&&(M.qpro=!0,B.l=0),e(B,function(Te,Ot,mr){switch(mr){case 204:V=Te;break;case 22:Te[1].v=Te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Te[3]>de&&(U["!ref"]=Lt(te),K[V]=U,J.push(V),U=M.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},de=Te[3],V="Sheet"+(de+1)),$e>0&&Te[0].r>=$e)break;M.dense?(U[Te[0].r]||(U[Te[0].r]=[]),U[Te[0].r][Te[0].c]=Te[1]):U[ot(Te[0])]=Te[1],te.e.c<Te[0].c&&(te.e.c=Te[0].c),te.e.r<Te[0].r&&(te.e.r=Te[0].r);break;case 27:Te[14e3]&&(Se[Te[14e3][0]]=Te[14e3][1]);break;case 1537:Se[Te[0]]=Te[1],Te[0]==de&&(V=Te[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(U["!ref"]=Lt(te),K[le||V]=U,J.push(le||V),!Se.length)return{SheetNames:J,Sheets:K};for(var Ne={},Je=[],Be=0;Be<Se.length;++Be)K[J[Be]]?(Je.push(Se[Be]||J[Be]),Ne[Se[Be]]=K[Se[Be]]||K[J[Be]]):(Je.push(Se[Be]),Ne[Se[Be]]={"!ref":"A1"});return{SheetNames:Je,Sheets:Ne}}function n(B,_){var M=_||{};if(+M.codepage>=0&&Jo(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var U=Nr(),V=yt(B["!ref"]),le=Array.isArray(B),de=[];be(U,0,a(1030)),be(U,6,l(V));for(var K=Math.min(V.e.r,8191),J=V.s.r;J<=K;++J)for(var Se=rr(J),te=V.s.c;te<=V.e.c;++te){J===V.s.r&&(de[te]=fr(te));var $e=de[te]+Se,Ne=le?(B[J]||[])[te]:B[$e];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")(Ne.v|0)==Ne.v&&Ne.v>=-32768&&Ne.v<=32767?be(U,13,d(J,te,Ne.v)):be(U,14,p(J,te,Ne.v));else{var Je=xi(Ne);be(U,15,h(J,te,Je.slice(0,239)))}}return be(U,1),U.end()}function i(B,_){var M=_||{};if(+M.codepage>=0&&Jo(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var U=Nr();be(U,0,s(B));for(var V=0,le=0;V<B.SheetNames.length;++V)(B.Sheets[B.SheetNames[V]]||{})["!ref"]&&be(U,27,re(B.SheetNames[V],le++));var de=0;for(V=0;V<B.SheetNames.length;++V){var K=B.Sheets[B.SheetNames[V]];if(!(!K||!K["!ref"])){for(var J=yt(K["!ref"]),Se=Array.isArray(K),te=[],$e=Math.min(J.e.r,8191),Ne=J.s.r;Ne<=$e;++Ne)for(var Je=rr(Ne),Be=J.s.c;Be<=J.e.c;++Be){Ne===J.s.r&&(te[Be]=fr(Be));var Te=te[Be]+Je,Ot=Se?(K[Ne]||[])[Be]:K[Te];if(!(!Ot||Ot.t=="z"))if(Ot.t=="n")be(U,23,R(Ne,Be,de,Ot.v));else{var mr=xi(Ot);be(U,22,S(Ne,Be,de,mr.slice(0,239)))}}++de}}return be(U,1),U.end()}function a(B){var _=ne(2);return _.write_shift(2,B),_}function s(B){var _=ne(26);_.write_shift(2,4096),_.write_shift(2,4),_.write_shift(4,0);for(var M=0,U=0,V=0,le=0;le<B.SheetNames.length;++le){var de=B.SheetNames[le],K=B.Sheets[de];if(!(!K||!K["!ref"])){++V;var J=Gr(K["!ref"]);M<J.e.r&&(M=J.e.r),U<J.e.c&&(U=J.e.c)}}return M>8191&&(M=8191),_.write_shift(2,M),_.write_shift(1,V),_.write_shift(1,U),_.write_shift(2,0),_.write_shift(2,0),_.write_shift(1,1),_.write_shift(1,2),_.write_shift(4,0),_.write_shift(4,0),_}function o(B,_,M){var U={s:{c:0,r:0},e:{c:0,r:0}};return _==8&&M.qpro?(U.s.c=B.read_shift(1),B.l++,U.s.r=B.read_shift(2),U.e.c=B.read_shift(1),B.l++,U.e.r=B.read_shift(2),U):(U.s.c=B.read_shift(2),U.s.r=B.read_shift(2),_==12&&M.qpro&&(B.l+=2),U.e.c=B.read_shift(2),U.e.r=B.read_shift(2),_==12&&M.qpro&&(B.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function l(B){var _=ne(8);return _.write_shift(2,B.s.c),_.write_shift(2,B.s.r),_.write_shift(2,B.e.c),_.write_shift(2,B.e.r),_}function c(B,_,M){var U=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(U[0].c=B.read_shift(1),U[3]=B.read_shift(1),U[0].r=B.read_shift(2),B.l+=2):(U[2]=B.read_shift(1),U[0].c=B.read_shift(2),U[0].r=B.read_shift(2)),U}function u(B,_,M){var U=B.l+_,V=c(B,_,M);if(V[1].t="s",M.vers==20768){B.l++;var le=B.read_shift(1);return V[1].v=B.read_shift(le,"utf8"),V}return M.qpro&&B.l++,V[1].v=B.read_shift(U-B.l,"cstr"),V}function h(B,_,M){var U=ne(7+M.length);U.write_shift(1,255),U.write_shift(2,_),U.write_shift(2,B),U.write_shift(1,39);for(var V=0;V<U.length;++V){var le=M.charCodeAt(V);U.write_shift(1,le>=128?95:le)}return U.write_shift(1,0),U}function m(B,_,M){var U=c(B,_,M);return U[1].v=B.read_shift(2,"i"),U}function d(B,_,M){var U=ne(7);return U.write_shift(1,255),U.write_shift(2,_),U.write_shift(2,B),U.write_shift(2,M,"i"),U}function g(B,_,M){var U=c(B,_,M);return U[1].v=B.read_shift(8,"f"),U}function p(B,_,M){var U=ne(13);return U.write_shift(1,255),U.write_shift(2,_),U.write_shift(2,B),U.write_shift(8,M,"f"),U}function x(B,_,M){var U=B.l+_,V=c(B,_,M);if(V[1].v=B.read_shift(8,"f"),M.qpro)B.l=U;else{var le=B.read_shift(2);w(B.slice(B.l,B.l+le),V),B.l+=le}return V}function v(B,_,M){var U=_&32768;return _&=-32769,_=(U?B:0)+(_>=8192?_-16384:_),(U?"":"$")+(M?fr(_):rr(_))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(B,_){Br(B,0);for(var M=[],U=0,V="",le="",de="",K="";B.l<B.length;){var J=B[B.l++];switch(J){case 0:M.push(B.read_shift(8,"f"));break;case 1:le=v(_[0].c,B.read_shift(2),!0),V=v(_[0].r,B.read_shift(2),!1),M.push(le+V);break;case 2:{var Se=v(_[0].c,B.read_shift(2),!0),te=v(_[0].r,B.read_shift(2),!1);le=v(_[0].c,B.read_shift(2),!0),V=v(_[0].r,B.read_shift(2),!1),M.push(Se+te+":"+le+V)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(B.read_shift(2));break;case 6:{for(var $e="";J=B[B.l++];)$e+=String.fromCharCode(J);M.push('"'+$e.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:K=M.pop(),de=M.pop(),M.push(["AND","OR"][J-20]+"("+de+","+K+")");break;default:if(J<32&&y[J])K=M.pop(),de=M.pop(),M.push(de+y[J]+K);else if(b[J]){if(U=b[J][1],U==69&&(U=B[B.l++]),U>M.length){console.error("WK1 bad formula parse 0x"+J.toString(16)+":|"+M.join("|")+"|");return}var Ne=M.slice(-U);M.length-=U,M.push(b[J][0]+"("+Ne.join(",")+")")}else return J<=7?console.error("WK1 invalid opcode "+J.toString(16)):J<=24?console.error("WK1 unsupported op "+J.toString(16)):J<=30?console.error("WK1 invalid opcode "+J.toString(16)):J<=115?console.error("WK1 unsupported function opcode "+J.toString(16)):console.error("WK1 unrecognized opcode "+J.toString(16))}}M.length==1?_[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function k(B){var _=[{c:0,r:0},{t:"n",v:0},0];return _[0].r=B.read_shift(2),_[3]=B[B.l++],_[0].c=B[B.l++],_}function T(B,_){var M=k(B);return M[1].t="s",M[1].v=B.read_shift(_-4,"cstr"),M}function S(B,_,M,U){var V=ne(6+U.length);V.write_shift(2,B),V.write_shift(1,M),V.write_shift(1,_),V.write_shift(1,39);for(var le=0;le<U.length;++le){var de=U.charCodeAt(le);V.write_shift(1,de>=128?95:de)}return V.write_shift(1,0),V}function E(B,_){var M=k(B);M[1].v=B.read_shift(2);var U=M[1].v>>1;if(M[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return M[1].v=U,M}function A(B,_){var M=k(B),U=B.read_shift(4),V=B.read_shift(4),le=B.read_shift(2);if(le==65535)return U===0&&V===3221225472?(M[1].t="e",M[1].v=15):U===0&&V===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var de=le&32768;return le=(le&32767)-16446,M[1].v=(1-de*2)*(V*Math.pow(2,le+32)+U*Math.pow(2,le)),M}function R(B,_,M,U){var V=ne(14);if(V.write_shift(2,B),V.write_shift(1,M),V.write_shift(1,_),U==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var le=0,de=0,K=0,J=0;return U<0&&(le=1,U=-U),de=Math.log2(U)|0,U/=Math.pow(2,de-31),J=U>>>0,(J&2147483648)==0&&(U/=2,++de,J=U>>>0),U-=J,J|=2147483648,J>>>=0,U*=Math.pow(2,32),K=U>>>0,V.write_shift(4,K),V.write_shift(4,J),de+=16383+(le?32768:0),V.write_shift(2,de),V}function C(B,_){var M=A(B);return B.l+=_-14,M}function j(B,_){var M=k(B),U=B.read_shift(4);return M[1].v=U>>6,M}function z(B,_){var M=k(B),U=B.read_shift(8,"f");return M[1].v=U,M}function G(B,_){var M=z(B);return B.l+=_-10,M}function W(B,_){return B[B.l+_-1]==0?B.read_shift(_,"cstr"):""}function fe(B,_){var M=B[B.l++];M>_-1&&(M=_-1);for(var U="";U.length<M;)U+=String.fromCharCode(B[B.l++]);return U}function he(B,_,M){if(!(!M.qpro||_<21)){var U=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var V=B.read_shift(_-21,"cstr");return[U,V]}}function ee(B,_){for(var M={},U=B.l+_;B.l<U;){var V=B.read_shift(2);if(V==14e3){for(M[V]=[0,""],M[V][0]=B.read_shift(2);B[B.l];)M[V][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return M}function re(B,_){var M=ne(5+B.length);M.write_shift(2,14e3),M.write_shift(2,_);for(var U=0;U<B.length;++U){var V=B.charCodeAt(U);M[M.l++]=V>127?95:V}return M[M.l++]=0,M}var O={0:{n:"BOF",f:NC},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}})(),CB=/^\s|\s$|[\t\n\r]/;function FC(e,t){if(!t.bookSST)return"";var r=[Bt];r[r.length]=ye("sst",null,{xmlns:Vs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(CB)&&(a+=' xml:space="preserve"'),a+=">"+st(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function kB(e){return[e.read_shift(4),e.read_shift(4)]}function RB(e,t){return t||(t=ne(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var OB=bL;function FB(e){var t=Nr();oe(t,159,RB(e));for(var r=0;r<e.length;++r)oe(t,19,OB(e[r]));return oe(t,160),t.end()}function IB(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function IC(e){var t=0,r,n=IB(e),i=n.length+1,a,s,o,l,c;for(r=Da(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],o=(t&16384)===0?0:1,l=t<<1&32767,c=o|l,t=c^s;return t^52811}var jB=(function(){function e(i,a){switch(a.type){case"base64":return t(gi(i),a);case"binary":return t(i,a);case"buffer":return t(et&&Buffer.isBuffer(i)?i.toString("binary"):Tl(i),a);case"array":return t(qu(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var s=a||{},o=s.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var m=/\\\w+\b/g,d=0,g,p=-1;g=m.exec(u);){switch(g[0]){case"\\cell":var x=u.slice(d,m.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var v={v:x,t:"s"};Array.isArray(o)?o[h][p]=v:o[ot({r:h,c:p})]=v}break}d=m.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=Lt(c),o}function r(i,a){return Wa(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=yt(i["!ref"]),o,l=Array.isArray(i),c=s.s.r;c<=s.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var h=ot({r:c,c:u});o=l?(i[c]||[])[u]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(xi(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function a_(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var DB=6,fi=DB;function tu(e){return Math.floor((e+Math.round(128/fi)/256)*fi)}function ru(e){return Math.floor((e-5)/fi*100+.5)/100}function bp(e){return Math.round((e*fi+5)/fi*256)/256}function _x(e){e.width?(e.wpx=tu(e.width),e.wch=ru(e.wpx),e.MDW=fi):e.wpx?(e.wch=ru(e.wpx),e.width=bp(e.wch),e.MDW=fi):typeof e.wch=="number"&&(e.width=bp(e.wch),e.wpx=tu(e.width),e.MDW=fi),e.customWidth&&delete e.customWidth}var PB=96,jC=PB;function nu(e){return e*96/jC}function DC(e){return e*jC/96}function MB(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ye("numFmt",null,{numFmtId:n,formatCode:st(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ye("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function LB(e){var t=[];return t[t.length]=ye("cellXfs",null),e.forEach(function(r){t[t.length]=ye("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ye("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function PC(e,t){var r=[Bt,ye("styleSheet",null,{xmlns:Vs[0],"xmlns:vt":Gt.vt})],n;return e.SSF&&(n=MB(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=LB(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function BB(e,t){var r=e.read_shift(2),n=hr(e);return[r,n]}function UB(e,t,r){r||(r=ne(6+4*t.length)),r.write_shift(2,e),Xt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function qB(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=CL(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=AL(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=hr(e),n}function zB(e,t){t||(t=ne(153)),t.write_shift(2,e.sz*20),kL(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Jc(e.color,t);var n=0;return n=2,t.write_shift(1,n),Xt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var HB=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],um,$B=Gn;function s_(e,t){t||(t=ne(84)),um||(um=ux(HB));var r=um[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Jc({auto:1},t),Jc({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function VB(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function MC(e,t,r){r||(r=ne(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function co(e,t){return t||(t=ne(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var WB=Gn;function GB(e,t){return t||(t=ne(51)),t.write_shift(1,0),co(null,t),co(null,t),co(null,t),co(null,t),co(null,t),t.length>t.l?t.slice(0,t.l):t}function YB(e,t){return t||(t=ne(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Zc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function XB(e,t,r){var n=ne(2052);return n.write_shift(4,e),Zc(t,n),Zc(r,n),n.length>n.l?n.slice(0,n.l):n}function KB(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(oe(e,615,Nn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&oe(e,44,UB(i,t[i]))}),oe(e,616))}}function QB(e){var t=1;oe(e,611,Nn(t)),oe(e,43,zB({sz:12,color:{theme:1},name:"Calibri",family:2})),oe(e,612)}function ZB(e){var t=2;oe(e,603,Nn(t)),oe(e,45,s_({patternType:"none"})),oe(e,45,s_({patternType:"gray125"})),oe(e,604)}function JB(e){var t=1;oe(e,613,Nn(t)),oe(e,46,GB()),oe(e,614)}function e7(e){var t=1;oe(e,626,Nn(t)),oe(e,47,MC({numFmtId:0},65535)),oe(e,627)}function t7(e,t){oe(e,617,Nn(t.length)),t.forEach(function(r){oe(e,47,MC(r,0))}),oe(e,618)}function r7(e){var t=1;oe(e,619,Nn(t)),oe(e,48,YB({xfId:0,name:"Normal"})),oe(e,620)}function n7(e){var t=0;oe(e,505,Nn(t)),oe(e,506)}function i7(e){var t=0;oe(e,508,XB(t,"TableStyleMedium9","PivotStyleMedium4")),oe(e,509)}function a7(e,t){var r=Nr();return oe(r,278),KB(r,e.SSF),QB(r),ZB(r),JB(r),e7(r),t7(r,t.cellXfs),r7(r),n7(r),i7(r),oe(r,279),r.end()}function LC(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Bt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function s7(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:hr(e)}}function o7(e){var t=ne(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Xt(e.name,t),t.slice(0,t.l)}function l7(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function c7(e){var t=ne(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function u7(e,t){var r=ne(8+2*t.length);return r.write_shift(4,e),Xt(t,r),r.slice(0,r.l)}function f7(e){return e.l+=4,e.read_shift(4)!=0}function h7(e,t){var r=ne(8);return r.write_shift(4,e),r.write_shift(4,1),r}function d7(){var e=Nr();return oe(e,332),oe(e,334,Nn(1)),oe(e,335,o7({name:"XLDAPR",version:12e4,flags:3496657072})),oe(e,336),oe(e,339,u7(1,"XLDAPR")),oe(e,52),oe(e,35,Nn(514)),oe(e,4096,Nn(0)),oe(e,4097,tn(1)),oe(e,36),oe(e,53),oe(e,340),oe(e,337,h7(1)),oe(e,51,c7([[1,0]])),oe(e,338),oe(e,333),e.end()}function BC(){var e=[Bt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function m7(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ot(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var fs=1024;function UC(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ye("xml",null,{"xmlns:v":qr.v,"xmlns:o":qr.o,"xmlns:x":qr.x,"xmlns:mv":qr.mv}).replace(/\/>/,">"),ye("o:shapelayout",ye("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ye("v:shapetype",[ye("v:stroke",null,{joinstyle:"miter"}),ye("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];fs<e*1e3;)fs+=1e3;return t.forEach(function(a){var s=Yt(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ye("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ye("v:fill",l,o),u={on:"t",obscured:"t"};++fs,i=i.concat(["<v:shape"+nl({id:"_x0000_s"+fs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ye("v:shadow",null,u),ye("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",tr("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),tr("x:AutoFill","False"),tr("x:Row",String(s.r)),tr("x:Column",String(s.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function qC(e){var t=[Bt,ye("comments",null,{xmlns:Vs[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var a=st(i.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(st(l.a))),a.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),a.length<=1)t.push(tr("t",st(a[0]||"")));else{for(var s=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)s+=`Reply:
    `+a[o]+`
`;t.push(tr("t",st(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function p7(e,t,r){var n=[Bt,ye("ThreadedComments",null,{xmlns:Gt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var a="";(i[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(ye("threadedComment",tr("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function g7(e){var t=[Bt,ye("personList",null,{xmlns:Gt.TCMNT,"xmlns:x":Vs[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ye("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function x7(e){var t={};t.iauthor=e.read_shift(4);var r=Ka(e);return t.rfx=r.s,t.ref=ot(r.s),e.l+=16,t}function v7(e,t){return t==null&&(t=ne(36)),t.write_shift(4,e[1].iauthor),Gs(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var y7=hr;function w7(e){return Xt(e.slice(0,54))}function b7(e){var t=Nr(),r=[];return oe(t,628),oe(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),oe(t,632,w7(i.a)))})}),oe(t,631),oe(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var a={s:Yt(n[0]),e:Yt(n[0])};oe(t,635,v7([a,i])),i.t&&i.t.length>0&&oe(t,637,SL(i)),oe(t,636),delete i.iauthor})}),oe(t,634),oe(t,629),t.end()}function _7(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&ct.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var zC=["xlsb","xlsm","xlam","biff8","xla"],S7=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,s){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+fr(u)+(l?"":"$")+rr(c)}return function(i,a){return t=a,i.replace(e,r)}})(),Sx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Tx=(function(){return function(t,r){return t.replace(Sx,function(n,i,a,s,o,l){var c=xx(s)-(a?0:r.c),u=gx(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",m=c==0?"":a?c+1:"["+c+"]";return i+"R"+h+"C"+m})}})();function T7(e,t){return e.replace(Sx,function(r,n,i,a,s,o){return n+(i=="$"?i+a:fr(xx(a)+t.c))+(s=="$"?s+o:rr(gx(o)+t.r))})}function E7(e){return e.length!=1}function Ft(e){e.l+=1}function Yi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function HC(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return $C(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=Yi(e),o=Yi(e);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function $C(e){var t=Yi(e),r=Yi(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function N7(e,t,r){if(r.biff<8)return $C(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Yi(e),s=Yi(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function VC(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return A7(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Yi(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function A7(e){var t=Yi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function C7(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function k7(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return R7(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function R7(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function O7(e,t,r){var n=(e[e.l++]&96)>>5,i=HC(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function F7(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var s=HC(e,a,r);return[n,i,s]}function I7(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function j7(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function D7(e,t,r){var n=(e[e.l++]&96)>>5,i=N7(e,t-1,r);return[n,i]}function P7(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function o_(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function M7(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function L7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function B7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function U7(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function q7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function WC(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function z7(e){return e.read_shift(2),WC(e)}function H7(e){return e.read_shift(2),WC(e)}function $7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=VC(e,0,r);return[n,i]}function V7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=k7(e,0,r);return[n,i]}function W7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=VC(e,0,r);return[n,i,a]}function G7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[G9[i],XC[i],n]}function Y7(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:X7(e);return[i,(a[0]===0?XC:W9)[a[1]]]}function X7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function K7(e,t,r){e.l+=r&&r.biff==2?3:4}function Q7(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Z7(e){return e.l++,Al[e.read_shift(1)]}function J7(e){return e.l++,e.read_shift(2)}function e9(e){return e.l++,e.read_shift(1)!==0}function t9(e){return e.l++,Ys(e)}function r9(e,t,r){return e.l++,CC(e,t-1,r)}function n9(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=WL(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Al[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ys(e);break;case 2:r[1]=KL(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function i9(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?Ka:JL)(e));return i}function a9(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=n9(e,r.biff);return s}function s9(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function o9(e,t,r){if(r.biff==5)return l9(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function l9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function c9(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function u9(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function f9(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function h9(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var d9=Gn,m9=Gn,p9=Gn;function Cl(e,t,r){return e.l+=2,[C7(e)]}function Ex(e){return e.l+=6,[]}var g9=Cl,x9=Ex,v9=Ex,y9=Cl;function GC(e){return e.l+=2,[NC(e),e.read_shift(2)&1]}var w9=Cl,b9=GC,_9=Ex,S9=Cl,T9=Cl,E9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function N9(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),s=E9[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:i,C:a}}function A9(e){return e.l+=2,[e.read_shift(4)]}function C9(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function k9(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function R9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function O9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function F9(e){return e.l+=4,[0,0]}var l_={1:{n:"PtgExp",f:Q7},2:{n:"PtgTbl",f:p9},3:{n:"PtgAdd",f:Ft},4:{n:"PtgSub",f:Ft},5:{n:"PtgMul",f:Ft},6:{n:"PtgDiv",f:Ft},7:{n:"PtgPower",f:Ft},8:{n:"PtgConcat",f:Ft},9:{n:"PtgLt",f:Ft},10:{n:"PtgLe",f:Ft},11:{n:"PtgEq",f:Ft},12:{n:"PtgGe",f:Ft},13:{n:"PtgGt",f:Ft},14:{n:"PtgNe",f:Ft},15:{n:"PtgIsect",f:Ft},16:{n:"PtgUnion",f:Ft},17:{n:"PtgRange",f:Ft},18:{n:"PtgUplus",f:Ft},19:{n:"PtgUminus",f:Ft},20:{n:"PtgPercent",f:Ft},21:{n:"PtgParen",f:Ft},22:{n:"PtgMissArg",f:Ft},23:{n:"PtgStr",f:r9},26:{n:"PtgSheet",f:C9},27:{n:"PtgEndSheet",f:k9},28:{n:"PtgErr",f:Z7},29:{n:"PtgBool",f:e9},30:{n:"PtgInt",f:J7},31:{n:"PtgNum",f:t9},32:{n:"PtgArray",f:P7},33:{n:"PtgFunc",f:G7},34:{n:"PtgFuncVar",f:Y7},35:{n:"PtgName",f:s9},36:{n:"PtgRef",f:$7},37:{n:"PtgArea",f:O7},38:{n:"PtgMemArea",f:c9},39:{n:"PtgMemErr",f:d9},40:{n:"PtgMemNoMem",f:m9},41:{n:"PtgMemFunc",f:u9},42:{n:"PtgRefErr",f:f9},43:{n:"PtgAreaErr",f:I7},44:{n:"PtgRefN",f:V7},45:{n:"PtgAreaN",f:D7},46:{n:"PtgMemAreaN",f:R9},47:{n:"PtgMemNoMemN",f:O9},57:{n:"PtgNameX",f:o9},58:{n:"PtgRef3d",f:W7},59:{n:"PtgArea3d",f:F7},60:{n:"PtgRefErr3d",f:h9},61:{n:"PtgAreaErr3d",f:j7},255:{}},I9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},j9={1:{n:"PtgElfLel",f:GC},2:{n:"PtgElfRw",f:S9},3:{n:"PtgElfCol",f:g9},6:{n:"PtgElfRwV",f:T9},7:{n:"PtgElfColV",f:y9},10:{n:"PtgElfRadical",f:w9},11:{n:"PtgElfRadicalS",f:_9},13:{n:"PtgElfColS",f:x9},15:{n:"PtgElfColSV",f:v9},16:{n:"PtgElfRadicalLel",f:b9},25:{n:"PtgList",f:N9},29:{n:"PtgSxName",f:A9},255:{}},D9={0:{n:"PtgAttrNoop",f:F9},1:{n:"PtgAttrSemi",f:q7},2:{n:"PtgAttrIf",f:B7},4:{n:"PtgAttrChoose",f:M7},8:{n:"PtgAttrGoto",f:L7},16:{n:"PtgAttrSum",f:K7},32:{n:"PtgAttrBaxcel",f:o_},33:{n:"PtgAttrBaxcel",f:o_},64:{n:"PtgAttrSpace",f:z7},65:{n:"PtgAttrSpaceSemi",f:H7},128:{n:"PtgAttrIfError",f:U7},255:{}};function P9(e,t,r,n){if(n.biff<8)return Gn(e,t);for(var i=e.l+t,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=a9(e,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=i9(e,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=i-e.l,t!==0&&a.push(Gn(e,t)),a}function M9(e,t,r){for(var n=e.l+t,i,a,s=[];n!=e.l;)t=n-e.l,a=e[e.l],i=l_[a]||l_[I9[a]],(a===24||a===25)&&(i=(a===24?j9:D9)[e[e.l+1]]),!i||!i.f?Gn(e,t):s.push([i.n,i.f(e,t,r)]);return s}function L9(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var B9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function U9(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function YC(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function c_(e,t,r){var n=YC(e,t,r);return n=="#REF"?n:U9(n,r)}function Ps(e,t,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0}},o=[],l,c,u,h=0,m=0,d,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,x="",v=0,b=e[0].length;v<b;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:x=Ct(" ",e[0][p][1][1]);break;case 1:x=Ct("\r",e[0][p][1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+x,p=-1}o.push(c+B9[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ro(y[1][1],s,i),o.push(Oo(u,a));break;case"PtgRefN":u=r?Ro(y[1][1],r,i):y[1][1],o.push(Oo(u,a));break;case"PtgRef3d":h=y[1][1],u=Ro(y[1][2],s,i),g=c_(n,h,i),o.push(g+"!"+Oo(u,a));break;case"PtgFunc":case"PtgFuncVar":var w=y[1][0],k=y[1][1];w||(w=0),w&=127;var T=w==0?[]:o.slice(-w);o.length-=w,k==="User"&&(k=T.shift()),o.push(k+"("+T.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":d=Gb(y[1][1],r?{s:r}:s,i),o.push(lm(d,i));break;case"PtgArea":d=Gb(y[1][1],s,i),o.push(lm(d,i));break;case"PtgArea3d":h=y[1][1],d=y[1][2],g=c_(n,h,i),o.push(g+"!"+lm(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=y[1][2];var S=(n.names||[])[m-1]||(n[0]||[])[m],E=S?S.Name:"SH33TJSNAME"+String(m);E&&E.slice(0,6)=="_xlfn."&&!i.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var A=y[1][1];m=y[1][2];var R;if(i.biff<=5)A<0&&(A=-A),n[A]&&(R=n[A][m]);else{var C="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][m]&&n[A][m].itab>0&&(C=n.SheetNames[n[A][m].itab-1]+"!"):C=n.SheetNames[m-1]+"!"),n[A]&&n[A][m])C+=n[A][m].Name;else if(n[0]&&n[0][m])C+=n[0][m].Name;else{var j=(YC(n,A,i)||"").split(";;");j[m-1]?C=j[m-1]:C+="SH33TJSERRX"}o.push(C);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var z="(",G=")";if(p>=0){switch(x="",e[0][p][1][0]){case 2:z=Ct(" ",e[0][p][1][1])+z;break;case 3:z=Ct("\r",e[0][p][1][1])+z;break;case 4:G=Ct(" ",e[0][p][1][1])+G;break;case 5:G=Ct("\r",e[0][p][1][1])+G;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(z+o.pop()+G);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var W={c:r.c,r:r.r};if(n.sharedf[ot(u)]){var fe=n.sharedf[ot(u)];o.push(Ps(fe,s,W,n,i))}else{var he=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Ps(c[1],s,W,n,i)),he=!0;break}he||o.push(y[1])}break;case"PtgArray":o.push("{"+L9(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&ee.indexOf(e[0][v][0])==-1){y=e[0][p];var re=!0;switch(y[1][0]){case 4:re=!1;case 0:x=Ct(" ",y[1][1]);break;case 5:re=!1;case 1:x=Ct("\r",y[1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((re?x:"")+o.pop()+(re?"":x)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function q9(e){if(e==null){var t=ne(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Pa(e);return Pa(0)}function z9(e,t,r,n,i){var a=Ma(t,r,i),s=q9(e.v),o=ne(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=ne(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var h=er([a,s,o,c]);return h}function zu(e,t,r){var n=e.read_shift(4),i=M9(e,n,r),a=e.read_shift(4),s=a>0?P9(e,a,i,r):null;return[i,s]}var H9=zu,Hu=zu,$9=zu,V9=zu,W9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},XC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},G9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Y9(e){var t="of:="+e.replace(Sx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function X9(e){return e.replace(/\./,"!")}var Fo=typeof Map!="undefined";function Nx(e,t,r){var n=0,i=e.length;if(r){if(Fo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Fo?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Fo?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function $u(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(fi=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ru(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=bp(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function KC(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ia(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,a=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){VA(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=a;++i)if(e[i].numFmtId===n)return i;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function K9(e,t,r){if(e&&e["!ref"]){var n=yt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Q9(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Lt(e[r])+'"/>';return t+"</mergeCells>"}function Z9(e,t,r,n,i){var a=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch(u){}a=!0,s.codeName=rl(st(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+ye("outlinePr",null,c)}!a&&!o||(i[i.length]=ye("sheetPr",o,s))}var J9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],eU=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function tU(e){var t={sheet:1};return J9.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),eU.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=IC(e.password).toString(16).toUpperCase()),ye("sheetProtection",null,t)}function rU(e){return KC(e),ye("pageMargins",null,e)}function nU(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=ye("col",null,$u(i,n)));return r[r.length]="</cols>",r.join("")}function iU(e,t,r,n){var i=typeof e.ref=="string"?e.ref:Lt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,s=Gr(i);s.s.r==s.e.r&&(s.e.r=Gr(t["!ref"]).e.r,i=Lt(s));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ye("autoFilter",null,{ref:i})}function aU(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ye("sheetViews",ye("sheetView",null,i),{})}function sU(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",a=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Al[e.v];break;case"d":n&&n.cellDates?i=Sr(e.v,-1).toISOString():(e=Rr(e),e.t="n",i=""+(e.v=kr(Sr(e.v)))),typeof e.z=="undefined"&&(e.z=Rt[14]);break;default:i=e.v;break}var o=tr("v",st(i)),l={r:t},c=ia(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=tr("v",""+Nx(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=a&&(e.t=a,e.v=s),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ye("f",st(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),ye("c",o,l)}function oU(e,t,r,n){var i=[],a=[],s=yt(e["!ref"]),o="",l,c="",u=[],h=0,m=0,d=e["!rows"],g=Array.isArray(e),p={r:c},x,v=-1;for(m=s.s.c;m<=s.e.c;++m)u[m]=fr(m);for(h=s.s.r;h<=s.e.r;++h){for(a=[],c=rr(h),m=s.s.c;m<=s.e.c;++m){l=u[m]+c;var b=g?(e[h]||[])[m]:e[l];b!==void 0&&(o=sU(b,l,e,t))!=null&&a.push(o)}(a.length>0||d&&d[h])&&(p={r:c},d&&d[h]&&(x=d[h],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=nu(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),i[i.length]=ye("row",a.join(""),p))}if(d)for(;h<d.length;++h)d&&d[h]&&(p={r:h+1},x=d[h],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=nu(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level),i[i.length]=ye("row","",p));return i.join("")}function QC(e,t,r,n){var i=[Bt,ye("worksheet",null,{xmlns:Vs[0],"xmlns:r":Gt.r})],a=r.SheetNames[e],s=0,o="",l=r.Sheets[a];l==null&&(l={});var c=l["!ref"]||"A1",u=yt(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Lt(u)}n||(n={}),l["!comments"]=[];var h=[];Z9(l,r,e,t,i),i[i.length]=ye("dimension",null,{ref:c}),i[i.length]=aU(l,t,e,r),t.sheetFormat&&(i[i.length]=ye("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=nU(l,l["!cols"])),i[s=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=oU(l,t),o.length>0&&(i[i.length]=o)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),l["!protect"]&&(i[i.length]=tU(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=iU(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=Q9(l["!merges"]));var m=-1,d,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(d={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=at(n,-1,st(p[1].Target).replace(/#.*$/,""),Qe.HLINK),d["r:id"]="rId"+g),(m=p[1].Target.indexOf("#"))>-1&&(d.location=st(p[1].Target.slice(m+1))),p[1].Tooltip&&(d.tooltip=st(p[1].Tooltip)),i[i.length]=ye("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=rU(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=tr("ignoredErrors",ye("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(g=at(n,-1,"../drawings/drawing"+(e+1)+".xml",Qe.DRAW),i[i.length]=ye("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=at(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Qe.VML),i[i.length]=ye("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function lU(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function cU(e,t,r){var n=ne(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;i.hpx?a=nu(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,m=-1,d=u<<10;d<u+1<<10;++d){c.c=d;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[ot(c)];g&&(h<0&&(h=d),m=d)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,m))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function uU(e,t,r,n){var i=cU(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&oe(e,0,i)}var fU=Ka,hU=Gs;function dU(){}function mU(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=TL(e),r}function pU(e,t,r){r==null&&(r=ne(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Jc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),hC(e,r),r.slice(0,r.l)}function gU(e){var t=un(e);return[t]}function xU(e,t,r){return r==null&&(r=ne(8)),Ga(t,r)}function vU(e){var t=Ya(e);return[t]}function yU(e,t,r){return r==null&&(r=ne(4)),Xa(t,r)}function wU(e){var t=un(e),r=e.read_shift(1);return[t,r,"b"]}function bU(e,t,r){return r==null&&(r=ne(9)),Ga(t,r),r.write_shift(1,e.v?1:0),r}function _U(e){var t=Ya(e),r=e.read_shift(1);return[t,r,"b"]}function SU(e,t,r){return r==null&&(r=ne(5)),Xa(t,r),r.write_shift(1,e.v?1:0),r}function TU(e){var t=un(e),r=e.read_shift(1);return[t,r,"e"]}function EU(e,t,r){return r==null&&(r=ne(9)),Ga(t,r),r.write_shift(1,e.v),r}function NU(e){var t=Ya(e),r=e.read_shift(1);return[t,r,"e"]}function AU(e,t,r){return r==null&&(r=ne(8)),Xa(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function CU(e){var t=un(e),r=e.read_shift(4);return[t,r,"s"]}function kU(e,t,r){return r==null&&(r=ne(12)),Ga(t,r),r.write_shift(4,t.v),r}function RU(e){var t=Ya(e),r=e.read_shift(4);return[t,r,"s"]}function OU(e,t,r){return r==null&&(r=ne(8)),Xa(t,r),r.write_shift(4,t.v),r}function FU(e){var t=un(e),r=Ys(e);return[t,r,"n"]}function IU(e,t,r){return r==null&&(r=ne(16)),Ga(t,r),Pa(e.v,r),r}function jU(e){var t=Ya(e),r=Ys(e);return[t,r,"n"]}function DU(e,t,r){return r==null&&(r=ne(12)),Xa(t,r),Pa(e.v,r),r}function PU(e){var t=un(e),r=dC(e);return[t,r,"n"]}function MU(e,t,r){return r==null&&(r=ne(12)),Ga(t,r),mC(e.v,r),r}function LU(e){var t=Ya(e),r=dC(e);return[t,r,"n"]}function BU(e,t,r){return r==null&&(r=ne(8)),Xa(t,r),mC(e.v,r),r}function UU(e){var t=un(e),r=vx(e);return[t,r,"is"]}function qU(e){var t=un(e),r=hr(e);return[t,r,"str"]}function zU(e,t,r){return r==null&&(r=ne(12+4*e.v.length)),Ga(t,r),Xt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function HU(e){var t=Ya(e),r=hr(e);return[t,r,"str"]}function $U(e,t,r){return r==null&&(r=ne(8+4*e.v.length)),Xa(t,r),Xt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function VU(e,t,r){var n=e.l+t,i=un(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"b"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);s[3]=Ps(o,null,i,r.supbooks,r)}else e.l=n;return s}function WU(e,t,r){var n=e.l+t,i=un(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"e"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);s[3]=Ps(o,null,i,r.supbooks,r)}else e.l=n;return s}function GU(e,t,r){var n=e.l+t,i=un(e);i.r=r["!row"];var a=Ys(e),s=[i,a,"n"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);s[3]=Ps(o,null,i,r.supbooks,r)}else e.l=n;return s}function YU(e,t,r){var n=e.l+t,i=un(e);i.r=r["!row"];var a=hr(e),s=[i,a,"str"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);s[3]=Ps(o,null,i,r.supbooks,r)}else e.l=n;return s}var XU=Ka,KU=Gs;function QU(e,t){return t==null&&(t=ne(4)),t.write_shift(4,e),t}function ZU(e,t){var r=e.l+t,n=Ka(e),i=yx(e),a=hr(e),s=hr(e),o=hr(e);e.l=r;var l={rfx:n,relId:i,loc:a,display:o};return s&&(l.Tooltip=s),l}function JU(e,t){var r=ne(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Gs({s:Yt(e[0]),e:Yt(e[0])},r),wx("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Xt(i||"",r),Xt(e[1].Tooltip||"",r),Xt("",r),r.slice(0,r.l)}function eq(){}function tq(e,t,r){var n=e.l+t,i=pC(e),a=e.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=H9(e,n-e.l,r);s[1]=o}else e.l=n;return s}function rq(e,t,r){var n=e.l+t,i=Ka(e),a=[i];if(r.cellFormula){var s=V9(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}function nq(e,t,r){r==null&&(r=ne(18));var n=$u(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var ZC=["left","right","top","bottom","header","footer"];function iq(e){var t={};return ZC.forEach(function(r){t[r]=Ys(e)}),t}function aq(e,t){return t==null&&(t=ne(48)),KC(e),ZC.forEach(function(r){Pa(e[r],t)}),t}function sq(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function oq(e,t,r){r==null&&(r=ne(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function lq(e){var t=ne(24);return t.write_shift(4,4),t.write_shift(4,1),Gs(e,t),t}function cq(e,t){return t==null&&(t=ne(66)),t.write_shift(2,e.password?IC(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function uq(){}function fq(){}function hq(e,t,r,n,i,a,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Rr(t),t.z=t.z||Rt[14],t.v=kr(Sr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=ia(i.cellXfs,t,i),t.l&&a["!links"].push([ot(l),t.l]),t.c&&a["!comments"].push([ot(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Nx(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,s?oe(e,18,OU(t,l)):oe(e,7,kU(t,l))):(l.t="str",s?oe(e,17,$U(t,l)):oe(e,6,zU(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?oe(e,13,BU(t,l)):oe(e,2,MU(t,l)):s?oe(e,16,DU(t,l)):oe(e,5,IU(t,l)),!0;case"b":return l.t="b",s?oe(e,15,SU(t,l)):oe(e,4,bU(t,l)),!0;case"e":return l.t="e",s?oe(e,14,AU(t,l)):oe(e,3,EU(t,l)),!0}return s?oe(e,12,yU(t,l)):oe(e,1,xU(t,l)),!0}function dq(e,t,r,n){var i=yt(t["!ref"]||"A1"),a,s="",o=[];oe(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){s=rr(u),uU(e,t,i,u);var h=!1;if(u<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){u===i.s.r&&(o[m]=fr(m)),a=o[m]+s;var d=l?(t[u]||[])[m]:t[a];if(!d){h=!1;continue}h=hq(e,d,u,m,n,t,h)}}oe(e,146)}function mq(e,t){!t||!t["!merges"]||(oe(e,177,QU(t["!merges"].length)),t["!merges"].forEach(function(r){oe(e,176,KU(r))}),oe(e,178))}function pq(e,t){!t||!t["!cols"]||(oe(e,390),t["!cols"].forEach(function(r,n){r&&oe(e,60,nq(n,r))}),oe(e,391))}function gq(e,t){!t||!t["!ref"]||(oe(e,648),oe(e,649,lq(yt(t["!ref"]))),oe(e,650))}function xq(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=at(r,-1,n[1].Target.replace(/#.*$/,""),Qe.HLINK);oe(e,494,JU(n,i))}}),delete t["!links"]}function vq(e,t,r,n){if(t["!comments"].length>0){var i=at(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Qe.VML);oe(e,551,wx("rId"+i)),t["!legacy"]=i}}function yq(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],a=typeof i.ref=="string"?i.ref:Lt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Gr(a);o.s.r==o.e.r&&(o.e.r=Gr(t["!ref"]).e.r,a=Lt(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),oe(e,161,Gs(yt(a))),oe(e,162)}}function wq(e,t,r){oe(e,133),oe(e,137,oq(t,r)),oe(e,138),oe(e,134)}function bq(e,t){t["!protect"]&&oe(e,535,cq(t["!protect"]))}function _q(e,t,r,n){var i=Nr(),a=r.SheetNames[e],s=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch(c){}var l=yt(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],oe(i,129),(r.vbaraw||s["!outline"])&&oe(i,147,pU(o,s["!outline"])),oe(i,148,hU(l)),wq(i,s,r.Workbook),pq(i,s),dq(i,s,e,t),bq(i,s),yq(i,s,r,e),mq(i,s),xq(i,s,n),s["!margins"]&&oe(i,476,aq(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&gq(i,s),vq(i,s,e,n),oe(i,130),i.end()}function Sq(e,t){e.l+=10;var r=hr(e);return{name:r}}var Tq=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Eq(e){return!e.Workbook||!e.Workbook.WBProps?"false":rL(e.Workbook.WBProps.date1904)?"true":"false"}var Nq="][*?/\\".split("");function JC(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Nq.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Aq(e,t,r){e.forEach(function(n,i){JC(n);for(var a=0;a<i;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[i]&&t[i].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function Cq(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Aq(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)K9(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function e4(e){var t=[Bt];t[t.length]=ye("workbook",null,{xmlns:Vs[0],"xmlns:r":Gt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Tq.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ye("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var s={name:st(e.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=ye("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=ye("definedName",st(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function kq(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=wp(e),r.name=hr(e),r}function Rq(e,t){return t||(t=ne(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),wx(e.strRelID,t),Xt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Oq(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?hr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Fq(e,t){t||(t=ne(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),hC(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Iq(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=EL(e),s=$9(e,0,r),o=yx(e);e.l=n;var l={Name:a,Ptg:s};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function jq(e,t){oe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};oe(e,156,Rq(i))}oe(e,144)}function Dq(e,t){t||(t=ne(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Xt("SheetJS",t),Xt(Wc.version,t),Xt(Wc.version,t),Xt("7262",t),t.length>t.l?t.slice(0,t.l):t}function Pq(e,t){t||(t=ne(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Mq(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&a==-1&&(a=n);a>i||(oe(e,135),oe(e,158,Pq(i)),oe(e,136))}}function Lq(e,t){var r=Nr();return oe(r,131),oe(r,128,Dq()),oe(r,153,Fq(e.Workbook&&e.Workbook.WBProps||null)),Mq(r,e),jq(r,e),oe(r,132),r.end()}function Bq(e,t,r){return(t.slice(-4)===".bin"?Lq:e4)(e)}function Uq(e,t,r,n,i){return(t.slice(-4)===".bin"?_q:QC)(e,r,n,i)}function qq(e,t,r){return(t.slice(-4)===".bin"?a7:PC)(e,r)}function zq(e,t,r){return(t.slice(-4)===".bin"?FB:FC)(e,r)}function Hq(e,t,r){return(t.slice(-4)===".bin"?b7:qC)(e)}function $q(e){return(e.slice(-4)===".bin"?d7:BC)()}function Vq(e,t){var r=[];return e.Props&&r.push(qL(e.Props,t)),e.Custprops&&r.push(zL(e.Props,e.Custprops)),r.join("")}function Wq(){return""}function Gq(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var a=[];a.push(ye("NumberFormat",null,{"ss:Format":st(Rt[n.numFmtId])}));var s={"ss:ID":"s"+(21+i)};r.push(ye("Style",a.join(""),s))}),ye("Styles",r.join(""))}function t4(e){return ye("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Tx(e.Ref,{r:0,c:0})})}function Yq(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(t4(i)))}return ye("Names",r.join(""))}function Xq(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(t4(o)))}return a.join("")}function Kq(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(ye("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(ye("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(ye("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ye("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(tr("ProtectContents","True")),e["!protect"].objects&&i.push(tr("ProtectObjects","True")),e["!protect"].scenarios&&i.push(tr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(tr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(tr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":ye("WorksheetOptions",i.join(""),{xmlns:qr.x})}function Qq(e){return e.map(function(t){var r=tL(t.t||""),n=ye("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ye("Comment",n,{"ss:Author":t.a})}).join("")}function Zq(e,t,r,n,i,a,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+st(Tx(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=Yt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=st(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=st(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=s.c||c[u].s.r!=s.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",m=String(e.v);break;case"b":h="Boolean",m=e.v?"1":"0";break;case"e":h="Error",m=Al[e.v];break;case"d":h="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Rt[14]);break;case"s":h="String",m=eL(e.v||"");break}var d=ia(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=s.c+1;var g=e.v!=null?m:"",p=e.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(e.c||[]).length>0&&(p+=Qq(e.c)),ye("Cell",p,o)}function Jq(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=DC(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function ez(e,t,r,n){if(!e["!ref"])return"";var i=yt(e["!ref"]),a=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(x,v){_x(x);var b=!!x.width,y=$u(v,x),w={"ss:Index":v+1};b&&(w["ss:Width"]=tu(y.width)),x.hidden&&(w["ss:Hidden"]="1"),o.push(ye("Column",null,w))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[Jq(c,(e["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var m=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>h)&&!(a[s].s.r>c)&&!(a[s].e.c<h)&&!(a[s].e.r<c)){(a[s].s.c!=h||a[s].s.r!=c)&&(m=!0);break}if(!m){var d={r:c,c:h},g=ot(d),p=l?(e[c]||[])[h]:e[g];u.push(Zq(p,g,e,t,r,n,d))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function tz(e,t,r){var n=[],i=r.SheetNames[e],a=r.Sheets[i],s=a?Xq(a,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=a?ez(a,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Kq(a,t,e,r)),n.join("")}function rz(e,t){t||(t={}),e.SSF||(e.SSF=Rr(Rt)),e.SSF&&(Bu(),Lu(e.SSF),t.revssf=Uu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ia(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Vq(e,t)),r.push(Wq()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ye("Worksheet",tz(n,t,e),{"ss:Name":st(e.SheetNames[n])}));return r[2]=Gq(e,t),r[3]=Yq(e),Bt+ye("Workbook",r.join(""),{xmlns:qr.ss,"xmlns:o":qr.o,"xmlns:x":qr.x,"xmlns:ss":qr.ss,"xmlns:dt":qr.dt,"xmlns:html":qr.html})}var fm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function nz(e,t){var r=[],n=[],i=[],a=0,s,o=Pb(Xb,"n"),l=Pb(Kb,"n");if(e.Props)for(s=nr(e.Props),a=0;a<s.length;++a)(Object.prototype.hasOwnProperty.call(o,s[a])?r:Object.prototype.hasOwnProperty.call(l,s[a])?n:i).push([s[a],e.Props[s[a]]]);if(e.Custprops)for(s=nr(e.Custprops),a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},s[a])||(Object.prototype.hasOwnProperty.call(o,s[a])?r:Object.prototype.hasOwnProperty.call(l,s[a])?n:i).push([s[a],e.Custprops[s[a]]]);var c=[];for(a=0;a<i.length;++a)EC.indexOf(i[a][0])>-1||_C.indexOf(i[a][0])>-1||i[a][1]!=null&&c.push(i[a]);n.length&&ct.utils.cfb_add(t,"/SummaryInformation",t_(n,fm.SI,l,Kb)),(r.length||c.length)&&ct.utils.cfb_add(t,"/DocumentSummaryInformation",t_(r,fm.DSI,o,Xb,c.length?c:null,fm.UDI))}function iz(e,t){var r=t||{},n=ct.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ct.utils.cfb_add(n,i,r4(e,r)),r.biff==8&&(e.Props||e.Custprops)&&nz(e,n),r.biff==8&&e.vbaraw&&_7(n,ct.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var az={0:{f:lU},1:{f:gU},2:{f:PU},3:{f:TU},4:{f:wU},5:{f:FU},6:{f:qU},7:{f:CU},8:{f:YU},9:{f:GU},10:{f:VU},11:{f:WU},12:{f:vU},13:{f:LU},14:{f:NU},15:{f:_U},16:{f:jU},17:{f:HU},18:{f:RU},19:{f:vx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Iq},40:{},42:{},43:{f:qB},44:{f:BB},45:{f:$B},46:{f:WB},47:{f:VB},48:{},49:{f:vL},50:{},51:{f:l7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:yB},62:{f:UU},63:{f:m7},64:{f:uq},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sq},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:mU},148:{f:fU,p:16},151:{f:eq},152:{},153:{f:Oq},154:{},155:{},156:{f:kq},157:{},158:{},159:{T:1,f:kB},160:{T:-1},161:{T:1,f:Ka},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:XU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:s7},336:{T:-1},337:{f:f7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:dB},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:tq},427:{f:rq},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:iq},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:dU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:ZU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:y7},633:{T:1},634:{T:-1},635:{T:1,f:x7},636:{T:-1},637:{f:_L},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Sq},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:fq},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function be(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&px(r)&&e.push(r)}}function sz(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return be(e,t,r,i);var a=t;if(!isNaN(a)){for(var s=r.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,a),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function kl(e,t,r){return e||(e=ne(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function oz(e,t,r,n){var i=ne(9);return kl(i,e,t),AC(r,n||"b",i),i}function lz(e,t,r){var n=ne(8+2*r.length);return kl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function cz(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?kr(Sr(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?be(e,2,SB(r,n,i)):be(e,3,_B(r,n,i));return;case"b":case"e":be(e,5,oz(r,n,t.v,t.t));return;case"s":case"str":be(e,4,lz(r,n,(t.v||"").slice(0,255)));return}be(e,1,kl(null,r,n))}function uz(e,t,r,n){var i=Array.isArray(t),a=yt(t["!ref"]||"A1"),s,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),s=Lt(a)}for(var c=a.s.r;c<=a.e.r;++c){o=rr(c);for(var u=a.s.c;u<=a.e.c;++u){c===a.s.r&&(l[u]=fr(u)),s=l[u]+o;var h=i?(t[c]||[])[u]:t[s];h&&cz(e,h,c,u)}}}function fz(e,t){for(var r=t||{},n=Nr(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return be(n,r.biff==4?1033:r.biff==3?521:9,bx(e,16,r)),uz(n,e.Sheets[e.SheetNames[i]],i,r),be(n,10),n.end()}function hz(e,t,r){be(e,49,aB({sz:12,name:"Arial"},r))}function dz(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&be(e,1054,lB(i,t[i],r))})}function mz(e,t){var r=ne(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),be(e,2151,r),r=ne(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),RC(yt(t["!ref"]||"A1"),r),r.write_shift(4,4),be(e,2152,r)}function pz(e,t){for(var r=0;r<16;++r)be(e,224,n_({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){be(e,224,n_(n,0,t))})}function gz(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];be(e,440,gB(n)),n[1].Tooltip&&be(e,2048,xB(n))}delete t["!links"]}function xz(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&be(e,125,wB($u(i,n),i))})}}function vz(e,t,r,n,i){var a=16+ia(i.cellXfs,t,i);if(t.v==null&&!t.bf){be(e,513,Ma(r,n,a));return}if(t.bf)be(e,6,z9(t,r,n,i,a));else switch(t.t){case"d":case"n":var s=t.t=="d"?kr(Sr(t.v)):t.v;be(e,515,hB(r,n,s,a));break;case"b":case"e":be(e,517,fB(r,n,t.v,a,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Nx(i.Strings,t.v,i.revStrings);be(e,253,sB(r,n,o,a))}else be(e,516,oB(r,n,(t.v||"").slice(0,255),a,i));break;default:be(e,513,Ma(r,n,a))}}function yz(e,t,r){var n=Nr(),i=r.SheetNames[e],a=r.Sheets[i]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(a),c=t.biff==8,u,h="",m=[],d=yt(a["!ref"]||"A1"),g=c?65536:16384;if(d.e.c>255||d.e.r>=g){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,g-1)}be(n,2057,bx(r,16,t)),be(n,13,tn(1)),be(n,12,tn(100)),be(n,15,yr(!0)),be(n,17,yr(!1)),be(n,16,Pa(.001)),be(n,95,yr(!0)),be(n,42,yr(!1)),be(n,43,yr(!1)),be(n,130,tn(1)),be(n,128,uB()),be(n,131,yr(!1)),be(n,132,yr(!1)),c&&xz(n,a["!cols"]),be(n,512,cB(d,t)),c&&(a["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){h=rr(p);for(var x=d.s.c;x<=d.e.c;++x){p===d.s.r&&(m[x]=fr(x)),u=m[x]+h;var v=l?(a[p]||[])[x]:a[u];v&&(vz(n,v,p,x,t),c&&v.l&&a["!links"].push([u,v.l]))}}var b=o.CodeName||o.name||i;return c&&be(n,574,iB((s.Views||[])[0])),c&&(a["!merges"]||[]).length&&be(n,229,pB(a["!merges"])),c&&gz(n,a),be(n,442,kC(b)),c&&mz(n,a),be(n,10),n.end()}function wz(e,t,r){var n=Nr(),i=(e||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(be(n,2057,bx(e,5,r)),r.bookType=="xla"&&be(n,135),be(n,225,o?tn(1200):null),be(n,193,VL(2)),l&&be(n,191),l&&be(n,192),be(n,226),be(n,92,eB("SheetJS",r)),be(n,66,tn(o?1200:1252)),o&&be(n,353,tn(0)),o&&be(n,448),be(n,317,bB(e.SheetNames.length)),o&&e.vbaraw&&be(n,211),o&&e.vbaraw){var c=s.CodeName||"ThisWorkbook";be(n,442,kC(c))}be(n,156,tn(17)),be(n,25,yr(!1)),be(n,18,yr(!1)),be(n,19,tn(0)),o&&be(n,431,yr(!1)),o&&be(n,444,tn(0)),be(n,61,nB()),be(n,64,yr(!1)),be(n,141,tn(0)),be(n,34,yr(Eq(e)=="true")),be(n,14,yr(!0)),o&&be(n,439,yr(!1)),be(n,218,tn(0)),hz(n,e,r),dz(n,e.SSF,r),pz(n,r),o&&be(n,352,yr(!1));var u=n.end(),h=Nr();o&&be(h,140,vB()),o&&r.Strings&&sz(h,252,rB(r.Strings)),be(h,10);var m=h.end(),d=Nr(),g=0,p=0;for(p=0;p<e.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var x=u.length+g+m.length;for(p=0;p<e.SheetNames.length;++p){var v=a[p]||{};be(d,133,tB({pos:x,hs:v.Hidden||0,dt:0,name:e.SheetNames[p]},r)),x+=t[p].length}var b=d.end();if(g!=b.length)throw new Error("BS8 "+g+" != "+b.length);var y=[];return u.length&&y.push(u),b.length&&y.push(b),m.length&&y.push(m),er(y)}function bz(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Rr(Rt)),e&&e.SSF&&(Bu(),Lu(e.SSF),r.revssf=Uu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ax(r),r.cellXfs=[],ia(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=yz(i,r,e);return n.unshift(wz(e,n,r)),er(n)}function r4(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Gr(n["!ref"]);i.e.c>255&&typeof console!="undefined"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return bz(e,t);case 4:case 3:case 2:return fz(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function _z(e,t,r,n){for(var i=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>s)&&!(i[c].e.r<r||i[c].e.c<s)){if(i[c].s.r<r||i[c].s.c<s){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=ot({r,c:s}),h=n.dense?(e[r]||[])[s]:e[u],m=h&&h.v!=null&&(h.h||J6(h.w||(xi(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),d.id=(n.id||"sjs")+"-"+u,a.push(ye("td",m,d))}}var g="<tr>";return g+a.join("")+"</tr>"}var Sz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Tz="</body></html>";function Ez(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function n4(e,t){var r=t||{},n=r.header!=null?r.header:Sz,i=r.footer!=null?r.footer:Tz,a=[n],s=Gr(e["!ref"]);r.dense=Array.isArray(e),a.push(Ez(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)a.push(_z(e,s,o,r));return a.push("</table>"+i),a.join("")}function i4(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?Yt(n.origin):n.origin;i=s.r,a=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var u=Gr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],m=0,d=e["!rows"]||(e["!rows"]=[]),g=0,p=0,x=0,v=0,b=0,y=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&p<l;++g){var w=o[g];if(u_(w)){if(n.display)continue;d[p]={hidden:!0}}var k=w.children;for(x=v=0;x<k.length;++x){var T=k[x];if(!(n.display&&u_(T))){var S=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):nL(T.innerHTML),E=T.getAttribute("data-z")||T.getAttribute("z");for(m=0;m<h.length;++m){var A=h[m];A.s.c==v+a&&A.s.r<p+i&&p+i<=A.e.r&&(v=A.e.c+1-a,m=-1)}y=+T.getAttribute("colspan")||1,((b=+T.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:p+i,c:v+a},e:{r:p+i+(b||1)-1,c:v+a+(y||1)-1}});var R={t:"s",v:S},C=T.getAttribute("data-t")||T.getAttribute("t")||"";S!=null&&(S.length==0?R.t=C||"z":n.raw||S.trim().length==0||C=="s"||(S==="TRUE"?R={t:"b",v:!0}:S==="FALSE"?R={t:"b",v:!1}:isNaN(ui(S))?isNaN(tl(S).getDate())||(R={t:"d",v:Sr(S)},n.cellDates||(R={t:"n",v:kr(R.v)}),R.z=n.dateNF||Rt[14]):R={t:"n",v:ui(S)})),R.z===void 0&&E!=null&&(R.z=E);var j="",z=T.getElementsByTagName("A");if(z&&z.length)for(var G=0;G<z.length&&!(z[G].hasAttribute("href")&&(j=z[G].getAttribute("href"),j.charAt(0)!="#"));++G);j&&j.charAt(0)!="#"&&(R.l={Target:j}),n.dense?(e[p+i]||(e[p+i]=[]),e[p+i][v+a]=R):e[ot({c:v+a,r:p+i})]=R,c.e.c<v+a&&(c.e.c=v+a),v+=y}}++p}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,p-1+i),e["!ref"]=Lt(c),p>=l&&(e["!fullref"]=Lt((c.e.r=o.length-g+p-1+i,c))),e}function a4(e,t){var r=t||{},n=r.dense?[]:{};return i4(n,e,t)}function Nz(e,t){return Wa(a4(e,t),t)}function u_(e){var t="",r=Az(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Az(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Cz=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+nl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Bt+t}})(),f_=(function(){var e=function(a){return st(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,s,o){var l=[];l.push('      <table:table table:name="'+st(s.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,h=Gr(a["!ref"]||"A1"),m=a["!merges"]||[],d=0,g=Array.isArray(a);if(a["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(a["!cols"][u]?' table:style-name="co'+a["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",x=a["!rows"]||[];for(c=0;c<h.s.r;++c)p=x[c]?' table:style-name="ro'+x[c].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;c<=h.e.r;++c){for(p=x[c]?' table:style-name="ro'+x[c].ods+'"':"",l.push("        <table:table-row"+p+`>
`),u=0;u<h.s.c;++u)l.push(t);for(;u<=h.e.c;++u){var v=!1,b={},y="";for(d=0;d!=m.length;++d)if(!(m[d].s.c>u)&&!(m[d].s.r>c)&&!(m[d].e.c<u)&&!(m[d].e.r<c)){(m[d].s.c!=u||m[d].s.r!=c)&&(v=!0),b["table:number-columns-spanned"]=m[d].e.c-m[d].s.c+1,b["table:number-rows-spanned"]=m[d].e.r-m[d].s.r+1;break}if(v){l.push(r);continue}var w=ot({r:c,c:u}),k=g?(a[c]||[])[u]:a[w];if(k&&k.f&&(b["table:formula"]=st(Y9(k.f)),k.F&&k.F.slice(0,w.length)==w)){var T=Gr(k.F);b["table:number-matrix-columns-spanned"]=T.e.c-T.s.c+1,b["table:number-matrix-rows-spanned"]=T.e.r-T.s.r+1}if(!k){l.push(t);continue}switch(k.t){case"b":y=k.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=k.v?"true":"false";break;case"n":y=k.w||String(k.v||0),b["office:value-type"]="float",b["office:value"]=k.v||0;break;case"s":case"str":y=k.v==null?"":k.v,b["office:value-type"]="string";break;case"d":y=k.w||Sr(k.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Sr(k.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(t);continue}var S=e(y);if(k.l&&k.l.Target){var E=k.l.Target;E=E.charAt(0)=="#"?"#"+X9(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),S=ye("text:a",S,{"xlink:href":E.replace(/&/g,"&amp;")})}l.push("          "+ye("table:table-cell",ye("text:p",S,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(a,s){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;_x(h),h.ods=o;var m=c["!cols"][u].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(s,o){var l=[Bt],c=nl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=nl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(wC().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=s.SheetNames.length;++h)l.push(n(s.Sheets[s.SheetNames[h]],s,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function s4(e,t){if(t.bookType=="fods")return f_(e,t);var r=fx(),n="",i=[],a=[];return n="mimetype",Ve(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ve(r,n,f_(e,t)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Ve(r,n,Cz(e,t)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Ve(r,n,Bt+wC()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Ve(r,n,UL(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ve(r,n,LL(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function iu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function kz(e){return typeof TextEncoder!="undefined"?new TextEncoder().encode(e):_n(rl(e))}function Rz(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Xi(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Oz(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)e[t+a]=i&255;e[t+15]|=r>=0?0:128}function il(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function it(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function _s(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function zt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=il(e,r),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=il(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:a};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function Zt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(it(n*8+i.type)),i.type==2&&t.push(it(i.data.length)),t.push(i.data))})}),Xi(t)}function mn(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=il(e,n),a=zt(e.slice(n[0],n[0]+i));n[0]+=i;var s={id:_s(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=zt(o.data),c=_s(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=a[3])!=null&&t[0]&&(s.merge=_s(a[3][0].data)>>>0>0),r.push(s)}return r}function rs(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:it(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:it(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:it(s.data.length)}],n[2].push({data:Zt(s.meta),type:2})});var a=Zt(n);t.push(it(a.length)),t.push(a),i.forEach(function(s){return t.push(s)})}),Xi(t)}function Fz(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=il(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}i.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Xi(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Xi(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function pn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Fz(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Xi(t)}function ns(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var a=it(n),s=a.length;t.push(a),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,r+=n}return Xi(t)}function hm(e,t){var r=new Uint8Array(32),n=iu(r),i=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,Oz(r,i,e.v),a|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,i)}function dm(e,t){var r=new Uint8Array(32),n=iu(r),i=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,i)}function Ni(e){var t=zt(e);return il(t[1][0].data)}function Iz(e,t,r){var n,i,a,s;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(a=e[8])==null?void 0:a[0])==null?void 0:s.data)&&_s(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=iu(e[7][0].data),u=0,h=[],m=iu(e[4][0].data),d=0,g=[],p=0;p<t.length;++p){if(t[p]==null){c.setUint16(p*2,65535,!0),m.setUint16(p*2,65535);continue}c.setUint16(p*2,u,!0),m.setUint16(p*2,d,!0);var x,v;switch(typeof t[p]){case"string":x=hm({t:"s",v:t[p]},r),v=dm({t:"s",v:t[p]},r);break;case"number":x=hm({t:"n",v:t[p]},r),v=dm({t:"n",v:t[p]},r);break;case"boolean":x=hm({t:"b",v:t[p]},r),v=dm({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}h.push(x),u+=x.length,g.push(v),d+=v.length,++l}for(e[2][0].data=it(l);p<e[7][0].data.length/2;++p)c.setUint16(p*2,65535,!0),m.setUint16(p*2,65535,!0);return e[6][0].data=Xi(h),e[3][0].data=Xi(g),l}function jz(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Gr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Lt(n)));var a=au(r,{range:n,header:1}),s=["~Sh33tJ5~"];a.forEach(function(_){return _.forEach(function(M){typeof M=="string"&&s.push(M)})});var o={},l=[],c=ct.read(t.numbers,{type:"base64"});c.FileIndex.map(function(_,M){return[_,c.FullPaths[M]]}).forEach(function(_){var M=_[0],U=_[1];if(M.type==2&&M.name.match(/\.iwa/)){var V=M.content,le=pn(V),de=mn(le);de.forEach(function(K){l.push(K.id),o[K.id]={deps:[],location:U,type:_s(K.messages[0].meta[1][0].data)}})}}),l.sort(function(_,M){return _-M});var u=l.filter(function(_){return _>1}).map(function(_){return[_,it(_)]});c.FileIndex.map(function(_,M){return[_,c.FullPaths[M]]}).forEach(function(_){var M=_[0];if(M.name.match(/\.iwa/)){var U=mn(pn(M.content));U.forEach(function(V){V.messages.forEach(function(le){u.forEach(function(de){V.messages.some(function(K){return _s(K.meta[1][0].data)!=11006&&Rz(K.data,de[1])})&&o[de[0]].deps.push(V.id)})})})}});for(var h=ct.find(c,o[1].location),m=mn(pn(h.content)),d,g=0;g<m.length;++g){var p=m[g];p.id==1&&(d=p)}var x=Ni(zt(d.messages[0].data)[1][0].data);for(h=ct.find(c,o[x].location),m=mn(pn(h.content)),g=0;g<m.length;++g)p=m[g],p.id==x&&(d=p);for(x=Ni(zt(d.messages[0].data)[2][0].data),h=ct.find(c,o[x].location),m=mn(pn(h.content)),g=0;g<m.length;++g)p=m[g],p.id==x&&(d=p);for(x=Ni(zt(d.messages[0].data)[2][0].data),h=ct.find(c,o[x].location),m=mn(pn(h.content)),g=0;g<m.length;++g)p=m[g],p.id==x&&(d=p);var v=zt(d.messages[0].data);{v[6][0].data=it(n.e.r+1),v[7][0].data=it(n.e.c+1);var b=Ni(v[46][0].data),y=ct.find(c,o[b].location),w=mn(pn(y.content));{for(var k=0;k<w.length&&w[k].id!=b;++k);if(w[k].id!=b)throw"Bad ColumnRowUIDMapArchive";var T=zt(w[k].messages[0].data);T[1]=[],T[2]=[],T[3]=[];for(var S=0;S<=n.e.c;++S){var E=[];E[1]=E[2]=[{type:0,data:it(S+420690)}],T[1].push({type:2,data:Zt(E)}),T[2].push({type:0,data:it(S)}),T[3].push({type:0,data:it(S)})}T[4]=[],T[5]=[],T[6]=[];for(var A=0;A<=n.e.r;++A)E=[],E[1]=E[2]=[{type:0,data:it(A+726270)}],T[4].push({type:2,data:Zt(E)}),T[5].push({type:0,data:it(A)}),T[6].push({type:0,data:it(A)});w[k].messages[0].data=Zt(T)}y.content=ns(rs(w)),y.size=y.content.length,delete v[46];var R=zt(v[4][0].data);{R[7][0].data=it(n.e.r+1);var C=zt(R[1][0].data),j=Ni(C[2][0].data);y=ct.find(c,o[j].location),w=mn(pn(y.content));{if(w[0].id!=j)throw"Bad HeaderStorageBucket";var z=zt(w[0].messages[0].data);for(A=0;A<a.length;++A){var G=zt(z[2][0].data);G[1][0].data=it(A),G[4][0].data=it(a[A].length),z[2][A]={type:z[2][0].type,data:Zt(G)}}w[0].messages[0].data=Zt(z)}y.content=ns(rs(w)),y.size=y.content.length;var W=Ni(R[2][0].data);y=ct.find(c,o[W].location),w=mn(pn(y.content));{if(w[0].id!=W)throw"Bad HeaderStorageBucket";for(z=zt(w[0].messages[0].data),S=0;S<=n.e.c;++S)G=zt(z[2][0].data),G[1][0].data=it(S),G[4][0].data=it(n.e.r+1),z[2][S]={type:z[2][0].type,data:Zt(G)};w[0].messages[0].data=Zt(z)}y.content=ns(rs(w)),y.size=y.content.length;var fe=Ni(R[4][0].data);(function(){for(var _=ct.find(c,o[fe].location),M=mn(pn(_.content)),U,V=0;V<M.length;++V){var le=M[V];le.id==fe&&(U=le)}var de=zt(U.messages[0].data);{de[3]=[];var K=[];s.forEach(function(te,$e){K[1]=[{type:0,data:it($e)}],K[2]=[{type:0,data:it(1)}],K[3]=[{type:2,data:kz(te)}],de[3].push({type:2,data:Zt(K)})})}U.messages[0].data=Zt(de);var J=rs(M),Se=ns(J);_.content=Se,_.size=_.content.length})();var he=zt(R[3][0].data);{var ee=he[1][0];delete he[2];var re=zt(ee.data);{var O=Ni(re[2][0].data);(function(){for(var _=ct.find(c,o[O].location),M=mn(pn(_.content)),U,V=0;V<M.length;++V){var le=M[V];le.id==O&&(U=le)}var de=zt(U.messages[0].data);{delete de[6],delete he[7];var K=new Uint8Array(de[5][0].data);de[5]=[];for(var J=0,Se=0;Se<=n.e.r;++Se){var te=zt(K);J+=Iz(te,a[Se],s),te[1][0].data=it(Se),de[5].push({data:Zt(te),type:2})}de[1]=[{type:0,data:it(n.e.c+1)}],de[2]=[{type:0,data:it(n.e.r+1)}],de[3]=[{type:0,data:it(J)}],de[4]=[{type:0,data:it(n.e.r+1)}]}U.messages[0].data=Zt(de);var $e=rs(M),Ne=ns($e);_.content=Ne,_.size=_.content.length})()}ee.data=Zt(re)}R[3][0].data=Zt(he)}v[4][0].data=Zt(R)}d.messages[0].data=Zt(v);var ge=rs(m),B=ns(ge);return h.content=B,h.size=h.content.length,c}function Dz(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Ax(e){Dz([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Pz(e,t){return t.bookType=="ods"?s4(e,t):t.bookType=="numbers"?jz(e,t):t.bookType=="xlsb"?Mz(e,t):Lz(e,t)}function Mz(e,t){fs=1024,e&&!e.SSF&&(e.SSF=Rr(Rt)),e&&e.SSF&&(Bu(),Lu(e.SSF),t.revssf=Uu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Fo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=zC.indexOf(t.bookType)>-1,i=xC();Ax(t=t||{});var a=fx(),s="",o=0;if(t.cellXfs=[],ia(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ve(a,s,bC(e.Props,t)),i.coreprops.push(s),at(t.rels,2,s,Qe.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Ve(a,s,SC(e.Props)),i.extprops.push(s),at(t.rels,3,s,Qe.EXT_PROPS),e.Custprops!==e.Props&&nr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ve(a,s,TC(e.Custprops)),i.custprops.push(s),at(t.rels,4,s,Qe.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ve(a,s,Uq(o-1,s,t,e,u)),i.sheets.push(s),at(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Qe.WS[0])}if(h){var d=h["!comments"],g=!1,p="";d&&d.length>0&&(p="xl/comments"+o+"."+r,Ve(a,p,Hq(d,p)),i.comments.push(p),at(u,-1,"../comments"+o+"."+r,Qe.CMNT),g=!0),h["!legacy"]&&g&&Ve(a,"xl/drawings/vmlDrawing"+o+".vml",UC(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Ve(a,yC(s),ws(u))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ve(a,s,zq(t.Strings,s,t)),i.strs.push(s),at(t.wbrels,-1,"sharedStrings."+r,Qe.SST)),s="xl/workbook."+r,Ve(a,s,Bq(e,s)),i.workbooks.push(s),at(t.rels,1,s,Qe.WB),s="xl/theme/theme1.xml",Ve(a,s,LC(e.Themes,t)),i.themes.push(s),at(t.wbrels,-1,"theme/theme1.xml",Qe.THEME),s="xl/styles."+r,Ve(a,s,qq(e,s,t)),i.styles.push(s),at(t.wbrels,-1,"styles."+r,Qe.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ve(a,s,e.vbaraw),i.vba.push(s),at(t.wbrels,-1,"vbaProject.bin",Qe.VBA)),s="xl/metadata."+r,Ve(a,s,$q(s)),i.metadata.push(s),at(t.wbrels,-1,"metadata."+r,Qe.XLMETA),Ve(a,"[Content_Types].xml",vC(i,t)),Ve(a,"_rels/.rels",ws(t.rels)),Ve(a,"xl/_rels/workbook."+r+".rels",ws(t.wbrels)),delete t.revssf,delete t.ssf,a}function Lz(e,t){fs=1024,e&&!e.SSF&&(e.SSF=Rr(Rt)),e&&e.SSF&&(Bu(),Lu(e.SSF),t.revssf=Uu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Fo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=zC.indexOf(t.bookType)>-1,i=xC();Ax(t=t||{});var a=fx(),s="",o=0;if(t.cellXfs=[],ia(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ve(a,s,bC(e.Props,t)),i.coreprops.push(s),at(t.rels,2,s,Qe.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Ve(a,s,SC(e.Props)),i.extprops.push(s),at(t.rels,3,s,Qe.EXT_PROPS),e.Custprops!==e.Props&&nr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ve(a,s,TC(e.Custprops)),i.custprops.push(s),at(t.rels,4,s,Qe.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],d=(m||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ve(a,s,QC(o-1,t,e,h)),i.sheets.push(s),at(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Qe.WS[0])}if(m){var g=m["!comments"],p=!1,x="";if(g&&g.length>0){var v=!1;g.forEach(function(b){b[1].forEach(function(y){y.T==!0&&(v=!0)})}),v&&(x="xl/threadedComments/threadedComment"+o+"."+r,Ve(a,x,p7(g,u,t)),i.threadedcomments.push(x),at(h,-1,"../threadedComments/threadedComment"+o+"."+r,Qe.TCMNT)),x="xl/comments"+o+"."+r,Ve(a,x,qC(g)),i.comments.push(x),at(h,-1,"../comments"+o+"."+r,Qe.CMNT),p=!0}m["!legacy"]&&p&&Ve(a,"xl/drawings/vmlDrawing"+o+".vml",UC(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}h["!id"].rId1&&Ve(a,yC(s),ws(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ve(a,s,FC(t.Strings,t)),i.strs.push(s),at(t.wbrels,-1,"sharedStrings."+r,Qe.SST)),s="xl/workbook."+r,Ve(a,s,e4(e)),i.workbooks.push(s),at(t.rels,1,s,Qe.WB),s="xl/theme/theme1.xml",Ve(a,s,LC(e.Themes,t)),i.themes.push(s),at(t.wbrels,-1,"theme/theme1.xml",Qe.THEME),s="xl/styles."+r,Ve(a,s,PC(e,t)),i.styles.push(s),at(t.wbrels,-1,"styles."+r,Qe.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ve(a,s,e.vbaraw),i.vba.push(s),at(t.wbrels,-1,"vbaProject.bin",Qe.VBA)),s="xl/metadata."+r,Ve(a,s,BC()),i.metadata.push(s),at(t.wbrels,-1,"metadata."+r,Qe.XLMETA),u.length>1&&(s="xl/persons/person.xml",Ve(a,s,g7(u)),i.people.push(s),at(t.wbrels,-1,"persons/person.xml",Qe.PEOPLE)),Ve(a,"[Content_Types].xml",vC(i,t)),Ve(a,"_rels/.rels",ws(t.rels)),Ve(a,"xl/_rels/workbook."+r+".rels",ws(t.wbrels)),delete t.revssf,delete t.ssf,a}function Bz(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=gi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function o4(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return El(t.file,ct.write(e,{type:et?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ct.write(e,t)}function Uz(e,t){var r=Rr(t||{}),n=Pz(e,r);return qz(n,r)}function qz(e,t){var r={},n=et?"nodebuffer":typeof Uint8Array!="undefined"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?ct.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno!="undefined"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Mu(i))}return t.password&&typeof encrypt_agile!="undefined"?o4(encrypt_agile(i,t.password),t):t.type==="file"?El(t.file,i):t.type=="string"?Co(i):i}function zz(e,t){var r=t||{},n=iz(e,r);return o4(n,r)}function jn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return el(rl(n));case"binary":return rl(n);case"string":return e;case"file":return El(t.file,n,"utf8");case"buffer":return et?Ti(n,"utf8"):typeof TextEncoder!="undefined"?new TextEncoder().encode(n):jn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Hz(e,t){switch(t.type){case"base64":return el(e);case"binary":return e;case"string":return e;case"file":return El(t.file,e,"binary");case"buffer":return et?Ti(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function lc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?el(r):t.type=="string"?Co(r):r;case"file":return El(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function l4(e,t){x6(),Cq(e);var r=Rr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=l4(e,r);return r.type="array",Mu(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return jn(rz(e,r),r);case"slk":case"sylk":return jn(EB.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return jn(n4(e.Sheets[e.SheetNames[i]],r),r);case"txt":return Hz(c4(e.Sheets[e.SheetNames[i]],r),r);case"csv":return jn(Cx(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return jn(NB.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return lc(TB.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return jn(AB.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return jn(jB.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return jn(OC.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return jn(s4(e,r),r);case"wk1":return lc(i_.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return lc(i_.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),lc(r4(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),zz(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Uz(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function $z(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Vz(e,t,r){var n={};return n.type="file",n.file=t,$z(n),l4(e,n)}function Wz(e,t,r,n,i,a,s,o){var l=rr(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch(x){m.__rowNum__=r}else m.__rowNum__=r;if(!s||e[r])for(var d=t.s.c;d<=t.e.c;++d){var g=s?e[r][d]:e[n[d]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;a[d]!=null&&(m[a[d]]=c);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[d]!=null){if(p==null)if(g.t=="e"&&p===null)m[a[d]]=null;else if(c!==void 0)m[a[d]]=c;else if(u&&p===null)m[a[d]]=null;else continue;else m[a[d]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:xi(g,p,o);p!=null&&(h=!1)}}return{row:m,isempty:h}}function au(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=yt(u);break;case"number":l=yt(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var h=rr(l.s.r),m=[],d=[],g=0,p=0,x=Array.isArray(e),v=l.s.r,b=0,y={};x&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],k=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(w[b]||{}).hidden)switch(m[b]=fr(b),r=x?e[v][b]:e[m[b]+h],n){case 1:a[b]=b-l.s.c;break;case 2:a[b]=m[b];break;case 3:a[b]=c.header[b-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=xi(r,null,c),p=y[s]||0,!p)y[s]=1;else{do o=s+"_"+p++;while(y[o]);y[s]=p,y[o]=1}a[b]=o}for(v=l.s.r+i;v<=l.e.r;++v)if(!(k[v]||{}).hidden){var T=Wz(e,l,v,m,n,a,x,c);(T.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[g++]=T.row)}return d.length=g,d}var h_=/"/g;function Gz(e,t,r,n,i,a,s,o){for(var l=!0,c=[],u="",h=rr(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var d=o.dense?(e[r]||[])[m]:e[n[m]+h];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:xi(d,null,o));for(var g=0,p=0;g!==u.length;++g)if((p=u.charCodeAt(g))===i||p===a||p===34||o.forceQuotes){u='"'+u.replace(h_,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(h_,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function Cx(e,t){var r=[],n=t==null?{}:t;if(e==null||e["!ref"]==null)return"";var i=yt(e["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(m[g]||{}).hidden||(h[g]=fr(g));for(var p=0,x=i.s.r;x<=i.e.r;++x)(d[x]||{}).hidden||(u=Gz(e,i,x,h,s,l,a,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((p++?o:"")+u)));return delete n.dense,r.join("")}function c4(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Cx(e,t);return r}function Yz(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=yt(e["!ref"]),a="",s=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)s[o]=fr(o);for(var u=i.s.r;u<=i.e.r;++u)for(a=rr(u),o=i.s.c;o<=i.e.c;++o)if(t=s[o]+a,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function u4(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Yt(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+t.length-1+i}};if(a["!ref"]){var h=yt(a["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),s==-1&&(s=h.e.r+1,u.e.r=s+t.length-1+i)}else s==-1&&(s=0,u.e.r=t.length-1+i);var m=n.header||[],d=0;t.forEach(function(p,x){nr(p).forEach(function(v){(d=m.indexOf(v))==-1&&(m[d=m.length]=v);var b=p[v],y="z",w="",k=ot({c:o+d,r:s+x+i});c=al(a,k),b&&typeof b=="object"&&!(b instanceof Date)?a[k]=b:(typeof b=="number"?y="n":typeof b=="boolean"?y="b":typeof b=="string"?y="s":b instanceof Date?(y="d",n.cellDates||(y="n",b=kr(b)),w=n.dateNF||Rt[14]):b===null&&n.nullError&&(y="e",b=0),c?(c.t=y,c.v=b,delete c.w,delete c.R,w&&(c.z=w)):a[k]=c={t:y,v:b},w&&(c.z=w))})}),u.e.c=Math.max(u.e.c,o+m.length-1);var g=rr(s);if(i)for(d=0;d<m.length;++d)a[fr(d+o)+g]={t:"s",v:m[d]};return a["!ref"]=Lt(u),a}function Xz(e,t){return u4(null,e,t)}function al(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Yt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?al(e,ot(t)):al(e,ot({r:t,c:r||0}))}function Kz(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Qz(){return{SheetNames:[],Sheets:{}}}function Zz(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=s+i)!=-1;++i);}if(JC(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Jz(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Kz(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function eH(e,t){return e.z=t,e}function f4(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function tH(e,t,r){return f4(e,"#"+t,r)}function rH(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function nH(e,t,r,n){for(var i=typeof t!="string"?t:yt(t),a=typeof t=="string"?t:Lt(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=al(e,s,o);l.t="n",l.F=a,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Bn={encode_col:fr,encode_row:rr,encode_cell:ot,encode_range:Lt,decode_col:xx,decode_row:gx,split_cell:xL,decode_cell:Yt,decode_range:Gr,format_cell:xi,sheet_add_aoa:fC,sheet_add_json:u4,sheet_add_dom:i4,aoa_to_sheet:Ws,json_to_sheet:Xz,table_to_sheet:a4,table_to_book:Nz,sheet_to_csv:Cx,sheet_to_txt:c4,sheet_to_json:au,sheet_to_html:n4,sheet_to_formulae:Yz,sheet_to_row_object_array:au,sheet_get_cell:al,book_new:Qz,book_append_sheet:Zz,book_set_sheet_visibility:Jz,cell_set_number_format:eH,cell_set_hyperlink:f4,cell_set_internal_link:tH,cell_add_comment:rH,sheet_set_array_formula:nH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function iH(e){const t=Bn.book_new();if(e.options.includeSummary){const i=aH(e);Bn.book_append_sheet(t,i,"Summary")}if(e.options.includeAllInspections){const i=_p(e.inspections);Bn.book_append_sheet(t,i,"All Inspections")}if(e.options.includeProblemAreas){const i=h4(e.inspections);Bn.book_append_sheet(t,i,"Problem Areas")}if(e.options.includeCustodialNotes){const i=d4(e.custodialNotes);Bn.book_append_sheet(t,i,"Custodial Notes")}const n=`Custodial_Command_Report_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;Vz(t,n)}function aH(e){const t=sx(e.inspections),r=ox(e.custodialNotes),n=[["CUSTODIAL COMMAND - EXECUTIVE SUMMARY"],["Generated:",new Date().toLocaleString()],[""],["KEY METRICS"],["Total Inspections:",e.inspections.length],["Critical Issues (Rating < 2.0):",t.critical.length],["Needs Attention (Rating 2.0-3.0):",t.needsAttention.length],["Urgent Custodial Notes:",r.length],["Affected Schools:",t.summary.affectedSchools.length],[""],["SCHOOL PERFORMANCE"],["Most Problematic School:",t.summary.mostProblematicSchool||"N/A"],["Affected Schools:",t.summary.affectedSchools.join(", ")],[""],["SEVERITY BREAKDOWN"],["Critical Issues:",t.critical.length],["Needs Attention:",t.needsAttention.length],["Acceptable Performance:",e.inspections.length-t.summary.totalProblems],[""],["AVERAGE RATINGS BY SCHOOL"]],i=e.inspections.reduce((a,s)=>{const o=Va(s);return o===null||(a[s.school]||(a[s.school]={total:0,count:0}),a[s.school].total+=o,a[s.school].count+=1),a},{});return Object.entries(i).forEach(([a,s])=>{const o=(s.total/s.count).toFixed(2),l=ax(s.total/s.count);n.push([a,o,l.toUpperCase()])}),Bn.aoa_to_sheet(n)}function _p(e){const t=["ID","Date","School","Type","Room Number","Building Name","Location","Inspector","Average Rating","Severity","Floors","Vertical/Horizontal Surfaces","Ceiling","Restrooms","Customer Satisfaction","Trash","Project Cleaning","Activity Support","Safety & Compliance","Equipment","Monitoring","Notes"],r=e.map(a=>{const s=Va(a),o=s?ax(s):"N/A";return[a.id,new Date(a.date).toLocaleDateString(),a.school,a.inspectionType==="single_room"?"Single Room":"Whole Building",a.roomNumber||"",a.buildingName||"",a.locationDescription||"",a.inspectorName||"",(s==null?void 0:s.toFixed(2))||"N/A",o.toUpperCase(),a.floors||"",a.verticalHorizontalSurfaces||"",a.ceiling||"",a.restrooms||"",a.customerSatisfaction||"",a.trash||"",a.projectCleaning||"",a.activitySupport||"",a.safetyCompliance||"",a.equipment||"",a.monitoring||"",a.notes||""]}),n=Bn.aoa_to_sheet([t,...r]),i=[{wch:8},{wch:12},{wch:20},{wch:15},{wch:12},{wch:20},{wch:25},{wch:15},{wch:12},{wch:12},{wch:8},{wch:25},{wch:10},{wch:12},{wch:20},{wch:8},{wch:15},{wch:15},{wch:18},{wch:12},{wch:12},{wch:30}];return n["!cols"]=i,n}function h4(e){const t=sx(e),r=["Severity","School","Location","Date","Rating","Inspector","Type","Floors","Vertical/Horizontal","Ceiling","Restrooms","Customer Satisfaction","Trash","Project Cleaning","Activity Support","Safety & Compliance","Equipment","Monitoring","Notes"],i=[...t.critical,...t.needsAttention].map(o=>{const l=o.inspection;return[o.severity.toUpperCase(),o.school,o.location,new Date(o.date).toLocaleDateString(),o.rating.toFixed(2),l.inspectorName||"",l.inspectionType==="single_room"?"Single Room":"Whole Building",l.floors||"",l.verticalHorizontalSurfaces||"",l.ceiling||"",l.restrooms||"",l.customerSatisfaction||"",l.trash||"",l.projectCleaning||"",l.activitySupport||"",l.safetyCompliance||"",l.equipment||"",l.monitoring||"",l.notes||""]}),a=Bn.aoa_to_sheet([r,...i]),s=[{wch:12},{wch:20},{wch:25},{wch:12},{wch:8},{wch:15},{wch:15},{wch:8},{wch:25},{wch:10},{wch:12},{wch:20},{wch:8},{wch:15},{wch:15},{wch:18},{wch:12},{wch:12},{wch:30}];return a["!cols"]=s,a}function d4(e){const t=ox(e),r=["Priority","School","Location","Date","Notes","Keywords","Inspector"],n=t.map(s=>{const o=s.note;return[s.severity.toUpperCase(),o.school,o.location,new Date(o.date).toLocaleDateString(),o.notes,s.keywords.join(", "),""]}),i=Bn.aoa_to_sheet([r,...n]),a=[{wch:12},{wch:20},{wch:25},{wch:12},{wch:50},{wch:30},{wch:15}];return i["!cols"]=a,i}function sH(e,t="inspections"){let r;switch(t){case"inspections":r=_p(e.inspections);break;case"problems":r=h4(e.inspections);break;case"notes":r=d4(e.custodialNotes);break;default:r=_p(e.inspections)}const n=Bn.sheet_to_csv(r),i=new Blob([n],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),s=URL.createObjectURL(i);a.setAttribute("href",s),a.setAttribute("download",`Custodial_Command_${t}_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}function sl(e){"@babel/helpers - typeof";return sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sl(e)}var kn=Uint8Array,$r=Uint16Array,kx=Int32Array,Rx=new kn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ox=new kn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d_=new kn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),m4=function(e,t){for(var r=new $r(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new kx(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},p4=m4(Rx,2),oH=p4.b,Sp=p4.r;oH[28]=258,Sp[258]=28;var lH=m4(Ox,0),m_=lH.r,Tp=new $r(32768);for(var vt=0;vt<32768;++vt){var Ai=(vt&43690)>>1|(vt&21845)<<1;Ai=(Ai&52428)>>2|(Ai&13107)<<2,Ai=(Ai&61680)>>4|(Ai&3855)<<4,Tp[vt]=((Ai&65280)>>8|(Ai&255)<<8)>>1}var Io=(function(e,t,r){for(var n=e.length,i=0,a=new $r(t);i<n;++i)e[i]&&++a[e[i]-1];var s=new $r(t);for(i=1;i<t;++i)s[i]=s[i-1]+a[i-1]<<1;var o;if(r){o=new $r(1<<t);var l=15-t;for(i=0;i<n;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],h=s[e[i]-1]++<<u,m=h|(1<<u)-1;h<=m;++h)o[Tp[h]>>l]=c}else for(o=new $r(n),i=0;i<n;++i)e[i]&&(o[i]=Tp[s[e[i]-1]++]>>15-e[i]);return o}),La=new kn(288);for(var vt=0;vt<144;++vt)La[vt]=8;for(var vt=144;vt<256;++vt)La[vt]=9;for(var vt=256;vt<280;++vt)La[vt]=7;for(var vt=280;vt<288;++vt)La[vt]=8;var su=new kn(32);for(var vt=0;vt<32;++vt)su[vt]=5;var cH=Io(La,9,0),uH=Io(su,5,0),g4=function(e){return(e+7)/8|0},fH=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new kn(e.subarray(t,r))},Jn=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},uo=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},mm=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,a=r.slice();if(!i)return{t:v4,l:0};if(i==1){var s=new kn(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(k,T){return k.f-T.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,u=1,h=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=i-1;)o=r[r[c].f<r[h].f?c++:h++],l=r[c!=u&&r[c].f<r[h].f?c++:h++],r[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var m=a[0].s,n=1;n<i;++n)a[n].s>m&&(m=a[n].s);var d=new $r(m+1),g=Ep(r[u-1],d,0);if(g>t){var n=0,p=0,x=g-t,v=1<<x;for(a.sort(function(T,S){return d[S.s]-d[T.s]||T.f-S.f});n<i;++n){var b=a[n].s;if(d[b]>t)p+=v-(1<<g-d[b]),d[b]=t;else break}for(p>>=x;p>0;){var y=a[n].s;d[y]<t?p-=1<<t-d[y]++-1:++n}for(;n>=0&&p;--n){var w=a[n].s;d[w]==t&&(--d[w],++p)}g=t}return{t:new kn(d),l:g}},Ep=function(e,t,r){return e.s==-1?Math.max(Ep(e.l,t,r+1),Ep(e.r,t,r+1)):t[e.s]=r},p_=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new $r(++t),n=0,i=e[0],a=1,s=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==i&&o!=t)++a;else{if(!i&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(i),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(i);a=1,i=e[o]}return{c:r.subarray(0,n),n:t}},fo=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},x4=function(e,t,r){var n=r.length,i=g4(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var a=0;a<n;++a)e[i+a+4]=r[a];return(i+4+n)*8},g_=function(e,t,r,n,i,a,s,o,l,c,u){Jn(t,u++,r),++i[256];for(var h=mm(i,15),m=h.t,d=h.l,g=mm(a,15),p=g.t,x=g.l,v=p_(m),b=v.c,y=v.n,w=p_(p),k=w.c,T=w.n,S=new $r(19),E=0;E<b.length;++E)++S[b[E]&31];for(var E=0;E<k.length;++E)++S[k[E]&31];for(var A=mm(S,7),R=A.t,C=A.l,j=19;j>4&&!R[d_[j-1]];--j);var z=c+5<<3,G=fo(i,La)+fo(a,su)+s,W=fo(i,m)+fo(a,p)+s+14+3*j+fo(S,R)+2*S[16]+3*S[17]+7*S[18];if(l>=0&&z<=G&&z<=W)return x4(t,u,e.subarray(l,l+c));var fe,he,ee,re;if(Jn(t,u,1+(W<G)),u+=2,W<G){fe=Io(m,d,0),he=m,ee=Io(p,x,0),re=p;var O=Io(R,C,0);Jn(t,u,y-257),Jn(t,u+5,T-1),Jn(t,u+10,j-4),u+=14;for(var E=0;E<j;++E)Jn(t,u+3*E,R[d_[E]]);u+=3*j;for(var ge=[b,k],B=0;B<2;++B)for(var _=ge[B],E=0;E<_.length;++E){var M=_[E]&31;Jn(t,u,O[M]),u+=R[M],M>15&&(Jn(t,u,_[E]>>5&127),u+=_[E]>>12)}}else fe=cH,he=La,ee=uH,re=su;for(var E=0;E<o;++E){var U=n[E];if(U>255){var M=U>>18&31;uo(t,u,fe[M+257]),u+=he[M+257],M>7&&(Jn(t,u,U>>23&31),u+=Rx[M]);var V=U&31;uo(t,u,ee[V]),u+=re[V],V>3&&(uo(t,u,U>>5&8191),u+=Ox[V])}else uo(t,u,fe[U]),u+=he[U]}return uo(t,u,fe[256]),u+he[256]},hH=new kx([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),v4=new kn(0),dH=function(e,t,r,n,i,a){var s=a.z||e.length,o=new kn(n+s+5*(1+Math.ceil(s/7e3))+i),l=o.subarray(n,o.length-i),c=a.l,u=(a.r||0)&7;if(t){u&&(l[0]=a.r>>3);for(var h=hH[t-1],m=h>>13,d=h&8191,g=(1<<r)-1,p=a.p||new $r(32768),x=a.h||new $r(g+1),v=Math.ceil(r/3),b=2*v,y=function(Ne){return(e[Ne]^e[Ne+1]<<v^e[Ne+2]<<b)&g},w=new kx(25e3),k=new $r(288),T=new $r(32),S=0,E=0,A=a.i||0,R=0,C=a.w||0,j=0;A+2<s;++A){var z=y(A),G=A&32767,W=x[z];if(p[G]=W,x[z]=G,C<=A){var fe=s-A;if((S>7e3||R>24576)&&(fe>423||!c)){u=g_(e,l,0,w,k,T,E,R,j,A-j,u),R=S=E=0,j=A;for(var he=0;he<286;++he)k[he]=0;for(var he=0;he<30;++he)T[he]=0}var ee=2,re=0,O=d,ge=G-W&32767;if(fe>2&&z==y(A-ge))for(var B=Math.min(m,fe)-1,_=Math.min(32767,A),M=Math.min(258,fe);ge<=_&&--O&&G!=W;){if(e[A+ee]==e[A+ee-ge]){for(var U=0;U<M&&e[A+U]==e[A+U-ge];++U);if(U>ee){if(ee=U,re=ge,U>B)break;for(var V=Math.min(ge,U-2),le=0,he=0;he<V;++he){var de=A-ge+he&32767,K=p[de],J=de-K&32767;J>le&&(le=J,W=de)}}}G=W,W=p[G],ge+=G-W&32767}if(re){w[R++]=268435456|Sp[ee]<<18|m_[re];var Se=Sp[ee]&31,te=m_[re]&31;E+=Rx[Se]+Ox[te],++k[257+Se],++T[te],C=A+ee,++S}else w[R++]=e[A],++k[e[A]]}}for(A=Math.max(A,C);A<s;++A)w[R++]=e[A],++k[e[A]];u=g_(e,l,c,w,k,T,E,R,j,A-j,u),c||(a.r=u&7|l[u/8|0]<<3,u-=7,a.h=x,a.p=p,a.i=A,a.w=C)}else{for(var A=a.w||0;A<s+c;A+=65535){var $e=A+65535;$e>=s&&(l[u/8|0]=c,$e=s),u=x4(l,u+1,e.subarray(A,$e))}a.i=s}return fH(o,0,n+g4(u)+i)},y4=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,a=r.length|0,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},mH=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),s=new kn(a.length+e.length);s.set(a),s.set(e,a.length),e=s,i.w=a.length}return dH(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},w4=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},pH=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=y4();i.p(t.dictionary),w4(e,2,i.d())}};function wJ(e,t){t||(t={});var r=y4();r.p(e);var n=mH(e,t,t.dictionary?6:2,4);return pH(n,t),w4(n,n.length-4,r.d()),n}var gH=typeof TextDecoder!="undefined"&&new TextDecoder,xH=0;try{gH.decode(v4,{stream:!0}),xH=1}catch(e){}function vH(e){if(Array.isArray(e))return e}function yH(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,s,o=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function x_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function wH(e,t){if(e){if(typeof e=="string")return x_(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x_(e,t):void 0}}function bH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bJ(e,t){return vH(e)||yH(e,t)||wH(e,t)||bH()}function v_(e,t="utf8"){return new TextDecoder(t).decode(e)}const _H=new TextEncoder;function SH(e){return _H.encode(e)}const TH=1024*8,EH=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),pm={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Fx{constructor(t=TH,r={}){Ge(this,"buffer");Ge(this,"byteLength");Ge(this,"byteOffset");Ge(this,"length");Ge(this,"offset");Ge(this,"lastWrittenByte");Ge(this,"littleEndian");Ge(this,"_data");Ge(this,"_mark");Ge(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const i=r.offset?r.offset>>>0:0,a=t.byteLength-i;let s=i;(ArrayBuffer.isView(t)||t instanceof Fx)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+i),t=t.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=t,this.length=a,this.byteLength=a,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,a),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=pm[r].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,a=this.buffer.slice(i,i+n);if(this.littleEndian===EH&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(i,i+n));o.reverse();const l=new pm[r](o.buffer);return this.offset+=n,l.reverse(),l}const s=new pm[r](a);return this.offset+=n,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return v_(this.readBytes(t))}decodeText(t=1,r="utf8"){return v_(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(SH(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Xs(e){let t=e.length;for(;--t>=0;)e[t]=0}const NH=3,AH=258,b4=29,CH=256,kH=CH+1+b4,_4=30,RH=512,OH=new Array((kH+2)*2);Xs(OH);const FH=new Array(_4*2);Xs(FH);const IH=new Array(RH);Xs(IH);const jH=new Array(AH-NH+1);Xs(jH);const DH=new Array(b4);Xs(DH);const PH=new Array(_4);Xs(PH);const MH=(e,t,r,n)=>{let i=e&65535|0,a=e>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do i=i+t[n++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16|0};var Np=MH;const LH=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},BH=new Uint32Array(LH()),UH=(e,t,r,n)=>{const i=BH,a=n+r;e^=-1;for(let s=n;s<a;s++)e=e>>>8^i[(e^t[s])&255];return e^-1};var Fn=UH,Ap={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},S4={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const qH=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var zH=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)qH(r,n)&&(e[n]=r[n])}}return e},HH=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,i=0,a=e.length;n<a;n++){let s=e[n];r.set(s,i),i+=s.length}return r},T4={assign:zH,flattenChunks:HH};let E4=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){E4=!1}const ol=new Uint8Array(256);for(let e=0;e<256;e++)ol[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;ol[254]=ol[254]=1;var $H=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,a,s=e.length,o=0;for(i=0;i<s;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),a=0,i=0;a<o;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|r&63):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|r&63):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|r&63);return t};const VH=(e,t)=>{if(t<65534&&e.subarray&&E4)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var WH=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i;const a=new Array(r*2);for(i=0,n=0;n<r;){let s=e[n++];if(s<128){a[i++]=s;continue}let o=ol[s];if(o>4){a[i++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<r;)s=s<<6|e[n++]&63,o--;if(o>1){a[i++]=65533;continue}s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|s&1023)}return VH(a,i)},GH=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+ol[e[r]]>t?r:t},Cp={string2buf:$H,buf2string:WH,utf8border:GH};function YH(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var XH=YH;const cc=16209,KH=16191;var QH=function(t,r){let n,i,a,s,o,l,c,u,h,m,d,g,p,x,v,b,y,w,k,T,S,E,A,R;const C=t.state;n=t.next_in,A=t.input,i=n+(t.avail_in-5),a=t.next_out,R=t.output,s=a-(r-t.avail_out),o=a+(t.avail_out-257),l=C.dmax,c=C.wsize,u=C.whave,h=C.wnext,m=C.window,d=C.hold,g=C.bits,p=C.lencode,x=C.distcode,v=(1<<C.lenbits)-1,b=(1<<C.distbits)-1;e:do{g<15&&(d+=A[n++]<<g,g+=8,d+=A[n++]<<g,g+=8),y=p[d&v];t:for(;;){if(w=y>>>24,d>>>=w,g-=w,w=y>>>16&255,w===0)R[a++]=y&65535;else if(w&16){k=y&65535,w&=15,w&&(g<w&&(d+=A[n++]<<g,g+=8),k+=d&(1<<w)-1,d>>>=w,g-=w),g<15&&(d+=A[n++]<<g,g+=8,d+=A[n++]<<g,g+=8),y=x[d&b];r:for(;;){if(w=y>>>24,d>>>=w,g-=w,w=y>>>16&255,w&16){if(T=y&65535,w&=15,g<w&&(d+=A[n++]<<g,g+=8,g<w&&(d+=A[n++]<<g,g+=8)),T+=d&(1<<w)-1,T>l){t.msg="invalid distance too far back",C.mode=cc;break e}if(d>>>=w,g-=w,w=a-s,T>w){if(w=T-w,w>u&&C.sane){t.msg="invalid distance too far back",C.mode=cc;break e}if(S=0,E=m,h===0){if(S+=c-w,w<k){k-=w;do R[a++]=m[S++];while(--w);S=a-T,E=R}}else if(h<w){if(S+=c+h-w,w-=h,w<k){k-=w;do R[a++]=m[S++];while(--w);if(S=0,h<k){w=h,k-=w;do R[a++]=m[S++];while(--w);S=a-T,E=R}}}else if(S+=h-w,w<k){k-=w;do R[a++]=m[S++];while(--w);S=a-T,E=R}for(;k>2;)R[a++]=E[S++],R[a++]=E[S++],R[a++]=E[S++],k-=3;k&&(R[a++]=E[S++],k>1&&(R[a++]=E[S++]))}else{S=a-T;do R[a++]=R[S++],R[a++]=R[S++],R[a++]=R[S++],k-=3;while(k>2);k&&(R[a++]=R[S++],k>1&&(R[a++]=R[S++]))}}else if((w&64)===0){y=x[(y&65535)+(d&(1<<w)-1)];continue r}else{t.msg="invalid distance code",C.mode=cc;break e}break}}else if((w&64)===0){y=p[(y&65535)+(d&(1<<w)-1)];continue t}else if(w&32){C.mode=KH;break e}else{t.msg="invalid literal/length code",C.mode=cc;break e}break}}while(n<i&&a<o);k=g>>3,n-=k,g-=k<<3,d&=(1<<g)-1,t.next_in=n,t.next_out=a,t.avail_in=n<i?5+(i-n):5-(n-i),t.avail_out=a<o?257+(o-a):257-(a-o),C.hold=d,C.bits=g};const is=15,y_=852,w_=592,b_=0,gm=1,__=2,ZH=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),JH=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),e$=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),t$=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),r$=(e,t,r,n,i,a,s,o)=>{const l=o.bits;let c=0,u=0,h=0,m=0,d=0,g=0,p=0,x=0,v=0,b=0,y,w,k,T,S,E=null,A;const R=new Uint16Array(is+1),C=new Uint16Array(is+1);let j=null,z,G,W;for(c=0;c<=is;c++)R[c]=0;for(u=0;u<n;u++)R[t[r+u]]++;for(d=l,m=is;m>=1&&R[m]===0;m--);if(d>m&&(d=m),m===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<m&&R[h]===0;h++);for(d<h&&(d=h),x=1,c=1;c<=is;c++)if(x<<=1,x-=R[c],x<0)return-1;if(x>0&&(e===b_||m!==1))return-1;for(C[1]=0,c=1;c<is;c++)C[c+1]=C[c]+R[c];for(u=0;u<n;u++)t[r+u]!==0&&(s[C[t[r+u]]++]=u);if(e===b_?(E=j=s,A=20):e===gm?(E=ZH,j=JH,A=257):(E=e$,j=t$,A=0),b=0,u=0,c=h,S=a,g=d,p=0,k=-1,v=1<<d,T=v-1,e===gm&&v>y_||e===__&&v>w_)return 1;for(;;){z=c-p,s[u]+1<A?(G=0,W=s[u]):s[u]>=A?(G=j[s[u]-A],W=E[s[u]-A]):(G=96,W=0),y=1<<c-p,w=1<<g,h=w;do w-=y,i[S+(b>>p)+w]=z<<24|G<<16|W|0;while(w!==0);for(y=1<<c-1;b&y;)y>>=1;if(y!==0?(b&=y-1,b+=y):b=0,u++,--R[c]===0){if(c===m)break;c=t[r+s[u]]}if(c>d&&(b&T)!==k){for(p===0&&(p=d),S+=h,g=c-p,x=1<<g;g+p<m&&(x-=R[g+p],!(x<=0));)g++,x<<=1;if(v+=1<<g,e===gm&&v>y_||e===__&&v>w_)return 1;k=b&T,i[k]=d<<24|g<<16|S-a|0}}return b!==0&&(i[S+b]=c-p<<24|64<<16|0),o.bits=d,0};var jo=r$;const n$=0,N4=1,A4=2,{Z_FINISH:S_,Z_BLOCK:i$,Z_TREES:uc,Z_OK:Ba,Z_STREAM_END:a$,Z_NEED_DICT:s$,Z_STREAM_ERROR:ln,Z_DATA_ERROR:C4,Z_MEM_ERROR:k4,Z_BUF_ERROR:o$,Z_DEFLATED:T_}=S4,Vu=16180,E_=16181,N_=16182,A_=16183,C_=16184,k_=16185,R_=16186,O_=16187,F_=16188,I_=16189,ou=16190,ei=16191,xm=16192,j_=16193,vm=16194,D_=16195,P_=16196,M_=16197,L_=16198,fc=16199,hc=16200,B_=16201,U_=16202,q_=16203,z_=16204,H_=16205,ym=16206,$_=16207,V_=16208,wt=16209,R4=16210,O4=16211,l$=852,c$=592,u$=15,f$=u$,W_=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function h$(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Qa=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Vu||t.mode>O4?1:0},F4=e=>{if(Qa(e))return ln;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Vu,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(l$),t.distcode=t.distdyn=new Int32Array(c$),t.sane=1,t.back=-1,Ba},I4=e=>{if(Qa(e))return ln;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,F4(e)},j4=(e,t)=>{let r;if(Qa(e))return ln;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?ln:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,I4(e))},D4=(e,t)=>{if(!e)return ln;const r=new h$;e.state=r,r.strm=e,r.window=null,r.mode=Vu;const n=j4(e,t);return n!==Ba&&(e.state=null),n},d$=e=>D4(e,f$);let G_=!0,wm,bm;const m$=e=>{if(G_){wm=new Int32Array(512),bm=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(jo(N4,e.lens,0,288,wm,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;jo(A4,e.lens,0,32,bm,0,e.work,{bits:5}),G_=!1}e.lencode=wm,e.lenbits=9,e.distcode=bm,e.distbits=5},P4=(e,t,r,n)=>{let i;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(t.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),a.window.set(t.subarray(r-n,r-n+i),a.wnext),n-=i,n?(a.window.set(t.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},p$=(e,t)=>{let r,n,i,a,s,o,l,c,u,h,m,d,g,p,x=0,v,b,y,w,k,T,S,E;const A=new Uint8Array(4);let R,C;const j=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Qa(e)||!e.output||!e.input&&e.avail_in!==0)return ln;r=e.state,r.mode===ei&&(r.mode=xm),s=e.next_out,i=e.output,l=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,c=r.hold,u=r.bits,h=o,m=l,E=Ba;e:for(;;)switch(r.mode){case Vu:if(r.wrap===0){r.mode=xm;break}for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(r.wrap&2&&c===35615){r.wbits===0&&(r.wbits=15),r.check=0,A[0]=c&255,A[1]=c>>>8&255,r.check=Fn(r.check,A,2,0),c=0,u=0,r.mode=E_;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=wt;break}if((c&15)!==T_){e.msg="unknown compression method",r.mode=wt;break}if(c>>>=4,u-=4,S=(c&15)+8,r.wbits===0&&(r.wbits=S),S>15||S>r.wbits){e.msg="invalid window size",r.mode=wt;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=c&512?I_:ei,c=0,u=0;break;case E_:for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(r.flags=c,(r.flags&255)!==T_){e.msg="unknown compression method",r.mode=wt;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=wt;break}r.head&&(r.head.text=c>>8&1),r.flags&512&&r.wrap&4&&(A[0]=c&255,A[1]=c>>>8&255,r.check=Fn(r.check,A,2,0)),c=0,u=0,r.mode=N_;case N_:for(;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.head&&(r.head.time=c),r.flags&512&&r.wrap&4&&(A[0]=c&255,A[1]=c>>>8&255,A[2]=c>>>16&255,A[3]=c>>>24&255,r.check=Fn(r.check,A,4,0)),c=0,u=0,r.mode=A_;case A_:for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.head&&(r.head.xflags=c&255,r.head.os=c>>8),r.flags&512&&r.wrap&4&&(A[0]=c&255,A[1]=c>>>8&255,r.check=Fn(r.check,A,2,0)),c=0,u=0,r.mode=C_;case C_:if(r.flags&1024){for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),r.flags&512&&r.wrap&4&&(A[0]=c&255,A[1]=c>>>8&255,r.check=Fn(r.check,A,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=k_;case k_:if(r.flags&1024&&(d=r.length,d>o&&(d=o),d&&(r.head&&(S=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+d),S)),r.flags&512&&r.wrap&4&&(r.check=Fn(r.check,n,d,a)),o-=d,a+=d,r.length-=d),r.length))break e;r.length=0,r.mode=R_;case R_:if(r.flags&2048){if(o===0)break e;d=0;do S=n[a+d++],r.head&&S&&r.length<65536&&(r.head.name+=String.fromCharCode(S));while(S&&d<o);if(r.flags&512&&r.wrap&4&&(r.check=Fn(r.check,n,d,a)),o-=d,a+=d,S)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=O_;case O_:if(r.flags&4096){if(o===0)break e;d=0;do S=n[a+d++],r.head&&S&&r.length<65536&&(r.head.comment+=String.fromCharCode(S));while(S&&d<o);if(r.flags&512&&r.wrap&4&&(r.check=Fn(r.check,n,d,a)),o-=d,a+=d,S)break e}else r.head&&(r.head.comment=null);r.mode=F_;case F_:if(r.flags&512){for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(r.wrap&4&&c!==(r.check&65535)){e.msg="header crc mismatch",r.mode=wt;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=ei;break;case I_:for(;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}e.adler=r.check=W_(c),c=0,u=0,r.mode=ou;case ou:if(r.havedict===0)return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=c,r.bits=u,s$;e.adler=r.check=1,r.mode=ei;case ei:if(t===i$||t===uc)break e;case xm:if(r.last){c>>>=u&7,u-=u&7,r.mode=ym;break}for(;u<3;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}switch(r.last=c&1,c>>>=1,u-=1,c&3){case 0:r.mode=j_;break;case 1:if(m$(r),r.mode=fc,t===uc){c>>>=2,u-=2;break e}break;case 2:r.mode=P_;break;case 3:e.msg="invalid block type",r.mode=wt}c>>>=2,u-=2;break;case j_:for(c>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=wt;break}if(r.length=c&65535,c=0,u=0,r.mode=vm,t===uc)break e;case vm:r.mode=D_;case D_:if(d=r.length,d){if(d>o&&(d=o),d>l&&(d=l),d===0)break e;i.set(n.subarray(a,a+d),s),o-=d,a+=d,l-=d,s+=d,r.length-=d;break}r.mode=ei;break;case P_:for(;u<14;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(r.nlen=(c&31)+257,c>>>=5,u-=5,r.ndist=(c&31)+1,c>>>=5,u-=5,r.ncode=(c&15)+4,c>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=wt;break}r.have=0,r.mode=M_;case M_:for(;r.have<r.ncode;){for(;u<3;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.lens[j[r.have++]]=c&7,c>>>=3,u-=3}for(;r.have<19;)r.lens[j[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,R={bits:r.lenbits},E=jo(n$,r.lens,0,19,r.lencode,0,r.work,R),r.lenbits=R.bits,E){e.msg="invalid code lengths set",r.mode=wt;break}r.have=0,r.mode=L_;case L_:for(;r.have<r.nlen+r.ndist;){for(;x=r.lencode[c&(1<<r.lenbits)-1],v=x>>>24,b=x>>>16&255,y=x&65535,!(v<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(y<16)c>>>=v,u-=v,r.lens[r.have++]=y;else{if(y===16){for(C=v+2;u<C;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(c>>>=v,u-=v,r.have===0){e.msg="invalid bit length repeat",r.mode=wt;break}S=r.lens[r.have-1],d=3+(c&3),c>>>=2,u-=2}else if(y===17){for(C=v+3;u<C;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=v,u-=v,S=0,d=3+(c&7),c>>>=3,u-=3}else{for(C=v+7;u<C;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=v,u-=v,S=0,d=11+(c&127),c>>>=7,u-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=wt;break}for(;d--;)r.lens[r.have++]=S}}if(r.mode===wt)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=wt;break}if(r.lenbits=9,R={bits:r.lenbits},E=jo(N4,r.lens,0,r.nlen,r.lencode,0,r.work,R),r.lenbits=R.bits,E){e.msg="invalid literal/lengths set",r.mode=wt;break}if(r.distbits=6,r.distcode=r.distdyn,R={bits:r.distbits},E=jo(A4,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,R),r.distbits=R.bits,E){e.msg="invalid distances set",r.mode=wt;break}if(r.mode=fc,t===uc)break e;case fc:r.mode=hc;case hc:if(o>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=c,r.bits=u,QH(e,m),s=e.next_out,i=e.output,l=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,c=r.hold,u=r.bits,r.mode===ei&&(r.back=-1);break}for(r.back=0;x=r.lencode[c&(1<<r.lenbits)-1],v=x>>>24,b=x>>>16&255,y=x&65535,!(v<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(b&&(b&240)===0){for(w=v,k=b,T=y;x=r.lencode[T+((c&(1<<w+k)-1)>>w)],v=x>>>24,b=x>>>16&255,y=x&65535,!(w+v<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=w,u-=w,r.back+=w}if(c>>>=v,u-=v,r.back+=v,r.length=y,b===0){r.mode=H_;break}if(b&32){r.back=-1,r.mode=ei;break}if(b&64){e.msg="invalid literal/length code",r.mode=wt;break}r.extra=b&15,r.mode=B_;case B_:if(r.extra){for(C=r.extra;u<C;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=U_;case U_:for(;x=r.distcode[c&(1<<r.distbits)-1],v=x>>>24,b=x>>>16&255,y=x&65535,!(v<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if((b&240)===0){for(w=v,k=b,T=y;x=r.distcode[T+((c&(1<<w+k)-1)>>w)],v=x>>>24,b=x>>>16&255,y=x&65535,!(w+v<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=w,u-=w,r.back+=w}if(c>>>=v,u-=v,r.back+=v,b&64){e.msg="invalid distance code",r.mode=wt;break}r.offset=y,r.extra=b&15,r.mode=q_;case q_:if(r.extra){for(C=r.extra;u<C;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=wt;break}r.mode=z_;case z_:if(l===0)break e;if(d=m-l,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=wt;break}d>r.wnext?(d-=r.wnext,g=r.wsize-d):g=r.wnext-d,d>r.length&&(d=r.length),p=r.window}else p=i,g=s-r.offset,d=r.length;d>l&&(d=l),l-=d,r.length-=d;do i[s++]=p[g++];while(--d);r.length===0&&(r.mode=hc);break;case H_:if(l===0)break e;i[s++]=r.length,l--,r.mode=hc;break;case ym:if(r.wrap){for(;u<32;){if(o===0)break e;o--,c|=n[a++]<<u,u+=8}if(m-=l,e.total_out+=m,r.total+=m,r.wrap&4&&m&&(e.adler=r.check=r.flags?Fn(r.check,i,m,s-m):Np(r.check,i,m,s-m)),m=l,r.wrap&4&&(r.flags?c:W_(c))!==r.check){e.msg="incorrect data check",r.mode=wt;break}c=0,u=0}r.mode=$_;case $_:if(r.wrap&&r.flags){for(;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(r.wrap&4&&c!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=wt;break}c=0,u=0}r.mode=V_;case V_:E=a$;break e;case wt:E=C4;break e;case R4:return k4;case O4:default:return ln}return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=c,r.bits=u,(r.wsize||m!==e.avail_out&&r.mode<wt&&(r.mode<ym||t!==S_))&&P4(e,e.output,e.next_out,m-e.avail_out),h-=e.avail_in,m-=e.avail_out,e.total_in+=h,e.total_out+=m,r.total+=m,r.wrap&4&&m&&(e.adler=r.check=r.flags?Fn(r.check,i,m,e.next_out-m):Np(r.check,i,m,e.next_out-m)),e.data_type=r.bits+(r.last?64:0)+(r.mode===ei?128:0)+(r.mode===fc||r.mode===vm?256:0),(h===0&&m===0||t===S_)&&E===Ba&&(E=o$),E},g$=e=>{if(Qa(e))return ln;let t=e.state;return t.window&&(t.window=null),e.state=null,Ba},x$=(e,t)=>{if(Qa(e))return ln;const r=e.state;return(r.wrap&2)===0?ln:(r.head=t,t.done=!1,Ba)},v$=(e,t)=>{const r=t.length;let n,i,a;return Qa(e)||(n=e.state,n.wrap!==0&&n.mode!==ou)?ln:n.mode===ou&&(i=1,i=Np(i,t,r,0),i!==n.check)?C4:(a=P4(e,t,r,r),a?(n.mode=R4,k4):(n.havedict=1,Ba))};var y$=I4,w$=j4,b$=F4,_$=d$,S$=D4,T$=p$,E$=g$,N$=x$,A$=v$,C$="pako inflate (from Nodeca project)",ii={inflateReset:y$,inflateReset2:w$,inflateResetKeep:b$,inflateInit:_$,inflateInit2:S$,inflate:T$,inflateEnd:E$,inflateGetHeader:N$,inflateSetDictionary:A$,inflateInfo:C$};function k$(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var R$=k$;const M4=Object.prototype.toString,{Z_NO_FLUSH:O$,Z_FINISH:F$,Z_OK:ll,Z_STREAM_END:_m,Z_NEED_DICT:Sm,Z_STREAM_ERROR:I$,Z_DATA_ERROR:Y_,Z_MEM_ERROR:j$}=S4;function Rl(e){this.options=T4.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new XH,this.strm.avail_out=0;let r=ii.inflateInit2(this.strm,t.windowBits);if(r!==ll)throw new Error(Ap[r]);if(this.header=new R$,ii.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Cp.string2buf(t.dictionary):M4.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=ii.inflateSetDictionary(this.strm,t.dictionary),r!==ll)))throw new Error(Ap[r])}Rl.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?F$:O$,M4.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=ii.inflate(r,s),a===Sm&&i&&(a=ii.inflateSetDictionary(r,i),a===ll?a=ii.inflate(r,s):a===Y_&&(a=Sm));r.avail_in>0&&a===_m&&r.state.wrap>0&&e[r.next_in]!==0;)ii.inflateReset(r),a=ii.inflate(r,s);switch(a){case I$:case Y_:case Sm:case j$:return this.onEnd(a),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||a===_m))if(this.options.to==="string"){let l=Cp.utf8border(r.output,r.next_out),c=r.next_out-l,u=Cp.buf2string(r.output,l);r.next_out=c,r.avail_out=n-c,c&&r.output.set(r.output.subarray(l,l+c),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===ll&&o===0)){if(a===_m)return a=ii.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Rl.prototype.onData=function(e){this.chunks.push(e)};Rl.prototype.onEnd=function(e){e===ll&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=T4.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function D$(e,t){const r=new Rl(t);if(r.push(e),r.err)throw r.msg||Ap[r.err];return r.result}var P$=Rl,M$=D$,L$={Inflate:P$,inflate:M$};const{Inflate:B$,inflate:U$}=L$;var X_=B$,q$=U$;const L4=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;L4[e]=t}const K_=4294967295;function z$(e,t,r){let n=e;for(let i=0;i<r;i++)n=L4[(n^t[i])&255]^n>>>8;return n}function H$(e,t){return(z$(K_,e,t)^K_)>>>0}function Q_(e,t,r){const n=e.readUint32(),i=H$(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function B4(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function U4(e,t,r,n){let i=0;for(;i<n;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+t[i-n]&255}function q4(e,t,r,n){let i=0;if(r.length===0)for(;i<n;i++)t[i]=e[i];else for(;i<n;i++)t[i]=e[i]+r[i]&255}function z4(e,t,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+(t[a-i]>>1)&255}else{for(;a<i;a++)t[a]=e[a]+(r[a]>>1)&255;for(;a<n;a++)t[a]=e[a]+(t[a-i]+r[a]>>1)&255}}function H4(e,t,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+t[a-i]&255}else{for(;a<i;a++)t[a]=e[a]+r[a]&255;for(;a<n;a++)t[a]=e[a]+$$(t[a-i],r[a],r[a-i])&255}}function $$(e,t,r){const n=e+t-r,i=Math.abs(n-e),a=Math.abs(n-t),s=Math.abs(n-r);return i<=a&&i<=s?e:a<=s?t:r}function V$(e,t,r,n,i,a){switch(e){case 0:B4(t,r,i);break;case 1:U4(t,r,i,a);break;case 2:q4(t,r,n,i);break;case 3:z4(t,r,n,i,a);break;case 4:H4(t,r,n,i,a);break;default:throw new Error(`Unsupported filter: ${e}`)}}const W$=new Uint16Array([255]),G$=new Uint8Array(W$.buffer),Y$=G$[0]===255;function X$(e){const{data:t,width:r,height:n,channels:i,depth:a}=e,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*i,l=new Uint8Array(n*r*o);let c=0;for(let u=0;u<7;u++){const h=s[u],m=Math.ceil((r-h.x)/h.xStep),d=Math.ceil((n-h.y)/h.yStep);if(m<=0||d<=0)continue;const g=m*o,p=new Uint8Array(g);for(let x=0;x<d;x++){const v=t[c++],b=t.subarray(c,c+g);c+=g;const y=new Uint8Array(g);V$(v,b,y,p,g,o),p.set(y);for(let w=0;w<m;w++){const k=h.x+w*h.xStep,T=h.y+x*h.yStep;if(!(k>=r||T>=n))for(let S=0;S<o;S++)l[(T*r+k)*o+S]=y[w*o+S]}}}if(a===16){const u=new Uint16Array(l.buffer);if(Y$)for(let h=0;h<u.length;h++)u[h]=K$(u[h]);return u}else return l}function K$(e){return(e&255)<<8|e>>8&255}const Q$=new Uint16Array([255]),Z$=new Uint8Array(Q$.buffer),J$=Z$[0]===255,eV=new Uint8Array(0);function Z_(e){const{data:t,width:r,height:n,channels:i,depth:a}=e,s=Math.ceil(a/8)*i,o=Math.ceil(a/8*i*r),l=new Uint8Array(n*o);let c=eV,u=0,h,m;for(let d=0;d<n;d++){switch(h=t.subarray(u+1,u+1+o),m=l.subarray(d*o,(d+1)*o),t[u]){case 0:B4(h,m,o);break;case 1:U4(h,m,o,s);break;case 2:q4(h,m,c,o);break;case 3:z4(h,m,c,o,s);break;case 4:H4(h,m,c,o,s);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}c=m,u+=o+1}if(a===16){const d=new Uint16Array(l.buffer);if(J$)for(let g=0;g<d.length;g++)d[g]=tV(d[g]);return d}else return l}function tV(e){return(e&255)<<8|e>>8&255}const Sc=Uint8Array.of(137,80,78,71,13,10,26,10);function J_(e){if(!rV(e.readBytes(Sc.length)))throw new Error("wrong PNG signature")}function rV(e){if(e.length<Sc.length)return!1;for(let t=0;t<Sc.length;t++)if(e[t]!==Sc[t])return!1;return!0}const nV="tEXt",iV=0,$4=new TextDecoder("latin1");function aV(e){if(oV(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const sV=/^[\u0000-\u00FF]*$/;function oV(e){if(!sV.test(e))throw new Error("invalid latin1 text")}function lV(e,t,r){const n=V4(t);e[n]=cV(t,r-n.length-1)}function V4(e){for(e.mark();e.readByte()!==iV;);const t=e.offset;e.reset();const r=$4.decode(e.readBytes(t-e.offset-1));return e.skip(1),aV(r),r}function cV(e,t){return $4.decode(e.readBytes(t))}const Dr={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Tm={UNKNOWN:-1,DEFLATE:0},eS={UNKNOWN:-1,ADAPTIVE:0},Em={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},dc={NONE:0,BACKGROUND:1,PREVIOUS:2},Nm={SOURCE:0,OVER:1};class uV extends Fx{constructor(r,n={}){super(r);Ge(this,"_checkCrc");Ge(this,"_inflator");Ge(this,"_png");Ge(this,"_apng");Ge(this,"_end");Ge(this,"_hasPalette");Ge(this,"_palette");Ge(this,"_hasTransparency");Ge(this,"_transparency");Ge(this,"_compressionMethod");Ge(this,"_filterMethod");Ge(this,"_interlaceMethod");Ge(this,"_colorType");Ge(this,"_isAnimated");Ge(this,"_numberOfFrames");Ge(this,"_numberOfPlays");Ge(this,"_frames");Ge(this,"_writingDataChunks");const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new X_,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Tm.UNKNOWN,this._filterMethod=eS.UNKNOWN,this._interlaceMethod=Em.UNKNOWN,this._colorType=Dr.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(J_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(J_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case nV:lV(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?Q_(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=i+r;break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?Q_(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=fV(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case Dr.GREYSCALE:i=1;break;case Dr.TRUECOLOUR:i=3;break;case Dr.INDEXED_COLOUR:i=1;break;case Dr.GREYSCALE_ALPHA:i=2;break;case Dr.TRUECOLOUR_ALPHA:i=4;break;case Dr.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==Tm.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const i=[];this._palette=i;for(let a=0;a<n;a++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Dr.GREYSCALE:case Dr.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Dr.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Dr.UNKNOWN:case Dr.GREYSCALE_ALPHA:case Dr.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=V4(this),i=this.readUint8();if(i!==Tm.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const a=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:q$(a)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:r,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(r);if(i){if(i.data=Z_({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const a=this._apng.frames.at(r-1);this.disposeFrame(i,a,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,i){switch(r.disposeOp){case dc.NONE:break;case dc.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let s=0;s<this._png.width;s++){const o=(a*r.width+s)*this._png.channels;for(let l=0;l<this._png.channels;l++)i.data[o+l]=0}break;case dc.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const i=1<<this._png.depth,a=(s,o)=>{const l=((s+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,c=(s*n.width+o)*this._png.channels;return{index:l,frameIndex:c}};switch(n.blendOp){case Nm.SOURCE:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:c}=a(s,o);for(let u=0;u<this._png.channels;u++)r.data[l+u]=n.data[c+u]}break;case Nm.OVER:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:c}=a(s,o);for(let u=0;u<this._png.channels;u++){const h=n.data[c+this._png.channels-1]/i,m=u%(this._png.channels-1)===0?1:n.data[c+u],d=Math.floor(h*m+(1-h)*r.data[l+u]);r.data[l+u]+=d}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==eS.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Em.NO_INTERLACE)this._png.data=Z_({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Em.ADAM7)this._png.data=X$({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:dc.NONE,blendOp:Nm.SOURCE,data:r}),this._inflator=new X_,this._writingDataChunks=!1}}function fV(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}function _J(e,t){return new uV(e,t).decode()}const Pt={left:20,right:20},ut={primary:"#000000",secondary:"#333333",border:"#CCCCCC",text:"#212121",tableBorder:"#CCCCCC",tableHeader:"#F0F0F0"},Et={title:16,heading:12,body:10,small:8};function hV(e,t){let r=0;if(r+=50,e.dataTypes.inspections){const n=t.inspections.length;r+=n*.8}if(e.dataTypes.custodialNotes){const n=t.custodialNotes.length;r+=n*.3}if(e.dataTypes.images){const n=t.inspections.reduce((i,a)=>{var s;return i+(((s=a.images)==null?void 0:s.length)||0)},0);r+=n*200}return e.includeCharts&&(r+=500),e.includeDetails&&(r*=1.5),r<1024?`${Math.round(r)} KB`:`${(r/1024).toFixed(1)} MB`}function dV(e,t){let r=1;if(e.dataTypes.inspections){const n=t.inspections.length,i=e.includeDetails?2:8;r+=Math.ceil(n/i)}if(e.dataTypes.custodialNotes){const n=t.custodialNotes.length;r+=Math.ceil(n/10)}return e.includeCharts&&(r+=2),Math.max(r,1)}function kp(e){const t=[];return!e.dataTypes.inspections&&!e.dataTypes.custodialNotes&&t.push("Please select at least one data type to export"),e.reportType||t.push("Please select a report type"),e.filters.dateRange.from&&e.filters.dateRange.to&&e.filters.dateRange.from>e.filters.dateRange.to&&t.push("Start date must be before end date"),(e.filters.ratingThreshold<1||e.filters.ratingThreshold>5)&&t.push("Rating threshold must be between 1 and 5"),{isValid:t.length===0,errors:t}}function Ks(e,t){let r=[...e.inspections],n=[...e.custodialNotes];if(t.filters.dateRange.from){const i=t.filters.dateRange.from.getTime();r=r.filter(a=>new Date(a.date).getTime()>=i),n=n.filter(a=>new Date(a.date).getTime()>=i)}if(t.filters.dateRange.to){const i=t.filters.dateRange.to.getTime();r=r.filter(a=>new Date(a.date).getTime()<=i),n=n.filter(a=>new Date(a.date).getTime()<=i)}return t.filters.schools.length>0&&(r=r.filter(i=>t.filters.schools.includes(i.school)),n=n.filter(i=>t.filters.schools.includes(i.school))),t.filters.categories.length>0&&(r=r.filter(i=>t.filters.categories.some(a=>typeof i[a]=="number"))),t.filters.ratingThreshold>0&&(r=r.filter(i=>{const s=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(l=>i[l]).filter(l=>typeof l=="number");return s.length===0?!1:s.reduce((l,c)=>l+c,0)/s.length<=t.filters.ratingThreshold})),t.filters.severityLevels.length>0&&(r=r.filter(i=>{const s=["floors","verticalHorizontalSurfaces","ceiling","restrooms"].map(l=>i[l]).filter(l=>typeof l=="number");if(s.length===0)return!1;const o=s.reduce((l,c)=>l+c,0)/s.length;return!!(t.filters.severityLevels.includes("critical")&&o<=2||t.filters.severityLevels.includes("needs-attention")&&o<=3||t.filters.severityLevels.includes("acceptable")&&o>3)})),{inspections:r,custodialNotes:n,totalRecords:r.length+n.length,dateRange:t.filters.dateRange,schools:t.filters.schools,categories:t.filters.categories}}function mV(e){var r,n;const t=[];if(e.filters.dateRange.from||e.filters.dateRange.to){const i=((r=e.filters.dateRange.from)==null?void 0:r.toLocaleDateString())||"Start",a=((n=e.filters.dateRange.to)==null?void 0:n.toLocaleDateString())||"End";t.push(`Date: ${i} - ${a}`)}return e.filters.schools.length>0&&t.push(`Schools: ${e.filters.schools.length} selected`),e.filters.categories.length>0&&t.push(`Categories: ${e.filters.categories.length} selected`),e.filters.severityLevels.length>0&&t.push(`Severity: ${e.filters.severityLevels.join(", ")}`),e.filters.ratingThreshold>0&&t.push(`Rating â‰¤ ${e.filters.ratingThreshold} stars`),t}function pV(e){const t=e.inspections.reduce((i,a)=>{var s;return i+(((s=a.images)==null?void 0:s.length)||0)},0),r=t*200,n=r<1024?`${r} KB`:`${(r/1024).toFixed(1)} MB`;return{inspections:e.inspections.length,custodialNotes:e.custodialNotes.length,images:t,totalSize:n}}function W4(e){const t=new dl("p","mm","letter");let r=20;const n=gV(e);return r=xV(t,e,r),r=vV(t,n,r),r=yV(t,n,r),wV(t),t.output("blob")}function gV(e){var i,a;const t=[],r=(i=e.startDate)==null?void 0:i.getTime(),n=(a=e.endDate)==null?void 0:a.getTime();return e.inspections.forEach(s=>{const o=new Date(s.date).getTime();if(r&&o<r||n&&o>n||e.schoolFilter&&s.school!==e.schoolFilter)return;const l=Va(s);if(l===null)return;let c="Info";if(l<2)c="Critical";else if(l<3)c="Needs Attention";else return;t.push({date:new Date(s.date).toLocaleDateString(),school:s.school,location:s.locationDescription||s.roomNumber||"N/A",priority:c,description:`Rating: ${l.toFixed(1)}/5.0${s.notes?` - ${s.notes}`:""}`,reportedBy:s.inspectorName||"N/A",category:"Inspection"})}),e.custodialNotes.forEach(s=>{const o=new Date(s.date).getTime();if(r&&o<r||n&&o>n||e.schoolFilter&&s.school!==e.schoolFilter)return;const c=["urgent","emergency","leak","unsafe","broken","immediate"].some(u=>s.notes.toLowerCase().includes(u));t.push({date:new Date(s.date).toLocaleDateString(),school:s.school,location:s.location,priority:c?"Critical":"Needs Attention",description:s.notes,reportedBy:"N/A",category:"Custodial Note"})}),t.sort((s,o)=>{if(s.priority!==o.priority){const l={Critical:0,"Needs Attention":1,Info:2};return l[s.priority]-l[o.priority]}return new Date(o.date).getTime()-new Date(s.date).getTime()}),t}function xV(e,t,r){e.setFontSize(Et.title),e.setTextColor(ut.primary),e.setFont("helvetica","bold"),e.text("Current Custodial Issues Report",Pt.left,r),r+=8,e.setFontSize(Et.body),e.setTextColor(ut.secondary),e.setFont("helvetica","normal");const n=t.startDate&&t.endDate?`${t.startDate.toLocaleDateString()} - ${t.endDate.toLocaleDateString()}`:"All Dates";return e.text(`Date Range: ${n}`,Pt.left,r),r+=5,t.schoolFilter&&(e.text(`School: ${t.schoolFilter}`,Pt.left,r),r+=5),t.activeFilters&&t.activeFilters.length>0&&(e.text(`Filters: ${t.activeFilters.join(", ")}`,Pt.left,r),r+=5),e.setFontSize(Et.small),e.setTextColor(ut.secondary),e.text(`Generated: ${new Date().toLocaleString()}`,Pt.left,r),r+=5,e.setDrawColor(ut.border),e.setLineWidth(.5),e.line(Pt.left,r,e.internal.pageSize.getWidth()-Pt.right,r),r+8}function vV(e,t,r){const n=t.filter(o=>o.priority==="Critical").length,i=t.filter(o=>o.priority==="Needs Attention").length,a=new Set(t.map(o=>o.school)).size;e.setFontSize(Et.heading),e.setTextColor(ut.primary),e.setFont("helvetica","bold"),e.text("Summary Statistics",Pt.left,r),r+=6;const s=[["Total Issues:",t.length.toString()],["Critical:",n.toString()],["Needs Attention:",i.toString()],["Schools Affected:",a.toString()]];return Fa(e,{startY:r,body:s,theme:"plain",styles:{fontSize:Et.body,textColor:ut.text,cellPadding:2,lineWidth:.5,lineColor:ut.tableBorder},columnStyles:{0:{fontStyle:"bold",cellWidth:40},1:{cellWidth:20}}}),e.lastAutoTable.finalY+10}function yV(e,t,r){if(t.length===0)return e.setFontSize(Et.body),e.setTextColor(ut.secondary),e.text("No issues found for the selected criteria.",Pt.left,r),r+10;e.setFontSize(Et.heading),e.setTextColor(ut.primary),e.setFont("helvetica","bold"),e.text("Issues Detail",Pt.left,r),r+=6;const n=t.map(i=>[i.date,i.school,i.location,i.priority,i.description,i.category]);return Fa(e,{startY:r,head:[["Date","School","Location","Priority","Description","Type"]],body:n,theme:"grid",headStyles:{fillColor:ut.tableHeader,textColor:ut.primary,fontStyle:"bold",fontSize:Et.small,lineWidth:.5,lineColor:ut.tableBorder},bodyStyles:{fontSize:Et.small,textColor:ut.text,lineWidth:.5,lineColor:ut.tableBorder},columnStyles:{0:{cellWidth:20},1:{cellWidth:20},2:{cellWidth:30},3:{cellWidth:25},4:{cellWidth:60},5:{cellWidth:25}},styles:{overflow:"linebreak",cellPadding:3}}),e.lastAutoTable.finalY}function wV(e){const t=e.getNumberOfPages();for(let r=1;r<=t;r++){e.setPage(r);const n=e.internal.pageSize.getHeight();e.setFontSize(Et.small),e.setTextColor(ut.secondary),e.text(`Page ${r} of ${t}`,e.internal.pageSize.getWidth()/2,n-10,{align:"center"}),e.text("Custodial Command System",Pt.left,n-10)}}function bV(e,t){var c,u;const r=Ks(e,t),n=new dl("p","mm","letter");let i=20;if(n.setFontSize(Et.title),n.setTextColor(ut.primary),n.setFont("helvetica","bold"),n.text("EXECUTIVE SUMMARY",Pt.left,i),i+=15,t.filters.dateRange.from||t.filters.dateRange.to){n.setFontSize(Et.body),n.setTextColor(ut.secondary);const h=((c=t.filters.dateRange.from)==null?void 0:c.toLocaleDateString())||"Start",m=((u=t.filters.dateRange.to)==null?void 0:u.toLocaleDateString())||"End";n.text(`Report Period: ${h} - ${m}`,Pt.left,i),i+=10}const a=r.inspections.length,s=r.custodialNotes.length,o=a>0?r.inspections.map(Va).filter(h=>h!==null).reduce((h,m)=>h+m,0)/a:0,l=[["Total Inspections",a.toString()],["Custodial Notes",s.toString()],["Average Rating",o.toFixed(1)+" stars"],["Schools Covered",r.schools.length.toString()]];return Fa(n,{startY:i,head:[["Metric","Value"]],body:l,theme:"grid",headStyles:{fillColor:ut.tableHeader},styles:{fontSize:Et.body}}),i=n.lastAutoTable.finalY+10,n.setFontSize(Et.body),n.setTextColor(ut.text),n.text("This executive summary provides a high-level overview of custodial performance",Pt.left,i),i+=6,n.text(`across ${r.schools.length} schools with ${a} inspections conducted.`,Pt.left,i),n.output("blob")}function _V(e,t){const r=Ks(e,t),n=new dl("p","mm","letter");let i=20;n.setFontSize(Et.title),n.setTextColor(ut.primary),n.setFont("helvetica","bold"),n.text("SCHOOL PERFORMANCE REPORT",Pt.left,i),i+=15;const a=r.inspections.reduce((o,l)=>{o[l.school]||(o[l.school]={school:l.school,inspections:0,ratings:[]}),o[l.school].inspections++;const c=Va(l);return c!==null&&o[l.school].ratings.push(c),o},{}),s=Object.values(a).map(o=>[o.school,o.inspections.toString(),o.ratings.length>0?(o.ratings.reduce((l,c)=>l+c,0)/o.ratings.length).toFixed(1):"N/A"]);return Fa(n,{startY:i,head:[["School","Inspections","Avg Rating"]],body:s,theme:"grid",headStyles:{fillColor:ut.tableHeader},styles:{fontSize:Et.body}}),n.output("blob")}function SV(e,t){const r=Ks(e,t),n=new dl("p","mm","letter");let i=20;n.setFontSize(Et.title),n.setTextColor(ut.primary),n.setFont("helvetica","bold"),n.text("CATEGORY ANALYSIS REPORT",Pt.left,i),i+=15;const s=[{key:"floors",label:"Floors"},{key:"verticalHorizontalSurfaces",label:"Vertical and Horizontal Surfaces"},{key:"ceiling",label:"Ceiling"},{key:"restrooms",label:"Restrooms"},{key:"customerSatisfaction",label:"Customer Satisfaction"}].map(o=>{const l=r.inspections.map(c=>c[o.key]).filter(c=>typeof c=="number");return[o.label,l.length.toString(),l.length>0?(l.reduce((c,u)=>c+u,0)/l.length).toFixed(1):"N/A"]});return Fa(n,{startY:i,head:[["Category","Inspections","Avg Rating"]],body:s,theme:"grid",headStyles:{fillColor:ut.tableHeader},styles:{fontSize:Et.body}}),n.output("blob")}function TV(e,t){const r=Ks(e,t),n=new dl("p","mm","letter");let i=20;if(n.setFontSize(Et.title),n.setTextColor(ut.primary),n.setFont("helvetica","bold"),n.text("CUSTOM REPORT",Pt.left,i),i+=15,t.dataTypes.inspections){n.setFontSize(Et.heading),n.setTextColor(ut.primary),n.text("INSPECTIONS",Pt.left,i),i+=10;const a=r.inspections.slice(0,10).map(s=>{var o;return[s.school,s.date,((o=Va(s))==null?void 0:o.toFixed(1))||"N/A"]});Fa(n,{startY:i,head:[["School","Date","Rating"]],body:a,theme:"grid",headStyles:{fillColor:ut.tableHeader},styles:{fontSize:Et.body}}),i=n.lastAutoTable.finalY+10}if(t.dataTypes.custodialNotes){n.setFontSize(Et.heading),n.setTextColor(ut.primary),n.text("CUSTODIAL NOTES",Pt.left,i),i+=10;const a=r.custodialNotes.slice(0,10).map(s=>[s.school,s.date,s.notes.substring(0,50)+(s.notes.length>50?"...":"")]);Fa(n,{startY:i,head:[["School","Date","Note"]],body:a,theme:"grid",headStyles:{fillColor:ut.tableHeader},styles:{fontSize:Et.body}})}return n.output("blob")}const EV=({inspections:e,custodialNotes:t,trigger:r,onExport:n})=>{const[i,a]=H.useState(!1),[s,o]=H.useState(!1),[l,c]=H.useState("excel"),[u,h]=H.useState("all"),[m,d]=H.useState({includeSummary:!0,includeAllInspections:!0,includeProblemAreas:!0,includeCustodialNotes:!0}),g=()=>lt(null,null,function*(){o(!0);try{const v={inspections:e,custodialNotes:t,options:m};switch(l){case"excel":iH(v);break;case"csv":sH(v,u==="problems"?"problems":"inspections");break;case"pdf":const y={inspections:e,custodialNotes:t,activeFilters:Object.entries(m).filter(([S,E])=>E).map(([S])=>S)},w=W4(y),k=URL.createObjectURL(w),T=document.createElement("a");T.href=k,T.download=`custodial-report-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(k);break}n==null||n(),a(!1)}catch(v){console.error("Export failed:",v),alert(`Export failed: ${v instanceof Error?v.message:"Unknown error"}. Please try again.`)}finally{o(!1)}}),p=()=>{const v=e.length*.5,b=l==="excel"?1.5:.3,y=Object.values(m).filter(Boolean).length,w=Math.round(v*b*y);return w<1024?`${w} KB`:`${(w/1024).toFixed(1)} MB`},x=()=>{switch(u){case"all":return e.length;case"filtered":return e.length;case"problems":return e.filter(v=>{const y=["floors","verticalHorizontalSurfaces","ceiling","restrooms"].map(k=>v[k]).filter(k=>k!==null);return(y.length>0?y.reduce((k,T)=>k+T,0)/y.length:5)<3}).length;case"custom":return e.length;default:return e.length}};return f.jsxs(_u,{open:i,onOpenChange:a,children:[f.jsx(HE,{asChild:!0,children:r||f.jsxs(Le,{children:[f.jsx(Oa,{className:"w-4 h-4 mr-2"}),"Export Data"]})}),f.jsx(pl,{className:"w-[95vw] sm:max-w-2xl max-h-[90vh] p-0 overflow-hidden",children:f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs(gl,{className:"p-6 pb-2",children:[f.jsx(xl,{children:"Export Data"}),f.jsx(vl,{children:"Choose format and options for exporting inspection data and reports"})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-6 pt-4 space-y-6 bg-background",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx(Ye,{className:"text-base font-medium",children:"Export Format"}),f.jsxs(OA,{value:l,onValueChange:v=>c(v),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(_c,{value:"excel",id:"excel"}),f.jsxs(Ye,{htmlFor:"excel",className:"flex items-center gap-2",children:[f.jsx(cR,{className:"w-4 h-4"}),"Excel (.xlsx) - Multiple sheets with formatting"]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(_c,{value:"csv",id:"csv"}),f.jsxs(Ye,{htmlFor:"csv",className:"flex items-center gap-2",children:[f.jsx(wi,{className:"w-4 h-4"}),"CSV (.csv) - Single sheet, compatible with all tools"]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(_c,{value:"pdf",id:"pdf"}),f.jsxs(Ye,{htmlFor:"pdf",className:"flex items-center gap-2",children:[f.jsx(uR,{className:"w-4 h-4"}),"PDF (.pdf) - Formatted issue reports with summaries"]})]})]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx(Ye,{className:"text-base font-medium",children:"Export Scope"}),f.jsxs(Eo,{value:u,onValueChange:v=>h(v),children:[f.jsx(gs,{children:f.jsx(No,{})}),f.jsxs(xs,{children:[f.jsxs(Sn,{value:"all",children:["All Data (",e.length," inspections)"]}),f.jsxs(Sn,{value:"filtered",children:["Filtered Data (",x()," inspections)"]}),f.jsxs(Sn,{value:"problems",children:["Problems Only (",x()," inspections)"]}),f.jsx(Sn,{value:"custom",children:"Custom Selection"})]})]})]}),l==="excel"&&f.jsxs("div",{className:"space-y-3",children:[f.jsx(Ye,{className:"text-base font-medium",children:"Include in Export"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:"summary",checked:m.includeSummary,onCheckedChange:v=>d(ce(q({},m),{includeSummary:!!v}))}),f.jsx(Ye,{htmlFor:"summary",children:"Executive Summary"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:"inspections",checked:m.includeAllInspections,onCheckedChange:v=>d(ce(q({},m),{includeAllInspections:!!v}))}),f.jsx(Ye,{htmlFor:"inspections",children:"All Inspections"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:"problems",checked:m.includeProblemAreas,onCheckedChange:v=>d(ce(q({},m),{includeProblemAreas:!!v}))}),f.jsx(Ye,{htmlFor:"problems",children:"Problem Areas"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:"notes",checked:m.includeCustodialNotes,onCheckedChange:v=>d(ce(q({},m),{includeCustodialNotes:!!v}))}),f.jsx(Ye,{htmlFor:"notes",children:"Custodial Notes"})]})]})]}),f.jsxs(Fe,{children:[f.jsx(ze,{children:f.jsx(He,{className:"text-sm",children:"Export Preview"})}),f.jsxs(je,{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Records:"}),f.jsxs("span",{children:[x()," inspections"]})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Format:"}),f.jsx("span",{children:l.toUpperCase()})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Estimated Size:"}),f.jsx("span",{children:p()})]}),l==="excel"&&f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Sheets:"}),f.jsxs("span",{children:[Object.values(m).filter(Boolean).length," sheets"]})]})]})]})]}),f.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t bg-background",children:[f.jsx(Le,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),f.jsx(Le,{onClick:g,disabled:s,className:"min-w-[120px]",children:s?f.jsxs(f.Fragment,{children:[f.jsx(Ac,{className:"w-4 h-4 mr-2 animate-spin"}),"Exporting..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Oa,{className:"w-4 h-4 mr-2"}),"Export Data"]})})]})]})})]})},SJ=({inspections:e,custodialNotes:t,onInspectionClick:r,onExportReport:n})=>{const i=H.useMemo(()=>{const o=sx(e),l=ox(t);return ce(q({},o),{urgentNotes:l,summary:ce(q({},o.summary),{urgentNotesCount:l.length})})},[e,t]),a=(o,l)=>{const c=d6(o.severity);return f.jsxs(Fe,{className:"hover:shadow-lg transition-shadow",children:[f.jsxs(ze,{className:"pb-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[o.severity==="critical"?f.jsx(nn,{className:"w-5 h-5 text-red-600"}):f.jsx(_r,{className:"w-5 h-5 text-orange-600"}),f.jsx(He,{className:"text-lg",children:o.school})]}),f.jsx(ht,ce(q({},c),{children:c.text}))]}),f.jsxs(nt,{className:"flex items-center gap-4 text-sm",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(an,{className:"w-4 h-4"}),o.location]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(cr,{className:"w-4 h-4"}),new Date(o.date).toLocaleDateString()]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(zi,{className:"w-4 h-4"}),o.rating,"/5"]})]})]}),f.jsx(je,{className:"pt-0",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"text-sm text-muted-foreground",children:o.severity==="critical"?"Immediate attention required":"Needs improvement"}),f.jsx("div",{className:"flex gap-2",children:f.jsxs(Le,{variant:"outline",size:"sm",onClick:()=>r==null?void 0:r(o.inspection),children:[f.jsx($T,{className:"w-4 h-4 mr-1"}),"View Details"]})})]})})]},`${o.inspection.id}-${l}`)},s=(o,l)=>{const c=m6(o.severity),u=o.note;return f.jsxs(Fe,{className:"border-l-4 border-l-red-500 hover:shadow-lg transition-shadow",children:[f.jsxs(ze,{className:"pb-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(nn,{className:"w-5 h-5 text-red-600 animate-pulse"}),f.jsx(He,{className:"text-lg",children:u.school})]}),f.jsx(ht,ce(q({},c),{children:c.text}))]}),f.jsxs(nt,{className:"flex items-center gap-4 text-sm",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(an,{className:"w-4 h-4"}),u.location]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(cr,{className:"w-4 h-4"}),new Date(u.date).toLocaleDateString()]})]})]}),f.jsx(je,{className:"pt-0",children:f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-sm text-foreground",children:u.notes}),o.keywords.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1",children:o.keywords.map((h,m)=>f.jsx(ht,{variant:"outline",className:"text-xs",children:h},m))})]})})]},`note-${u.id}-${l}`)};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[f.jsxs(Fe,{children:[f.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsx(He,{className:"text-sm font-medium",children:"Critical Issues"}),f.jsx(nn,{className:"h-4 w-4 text-red-600"})]}),f.jsxs(je,{children:[f.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.summary.criticalCount}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Rating < 2.0"})]})]}),f.jsxs(Fe,{children:[f.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsx(He,{className:"text-sm font-medium",children:"Needs Attention"}),f.jsx(_r,{className:"h-4 w-4 text-orange-600"})]}),f.jsxs(je,{children:[f.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.summary.needsAttentionCount}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Rating 2.0-3.0"})]})]}),f.jsxs(Fe,{children:[f.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsx(He,{className:"text-sm font-medium",children:"Urgent Notes"}),f.jsx(wi,{className:"h-4 w-4 text-red-600"})]}),f.jsxs(je,{children:[f.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.summary.urgentNotesCount}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"High priority reports"})]})]}),f.jsxs(Fe,{children:[f.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsx(He,{className:"text-sm font-medium",children:"Affected Schools"}),f.jsx(an,{className:"h-4 w-4 text-muted-foreground"})]}),f.jsxs(je,{children:[f.jsx("div",{className:"text-2xl font-bold",children:i.summary.affectedSchools.length}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Schools with issues"})]})]})]}),f.jsx("div",{className:"flex justify-end",children:f.jsx(EV,{inspections:e,custodialNotes:t,trigger:f.jsxs(Le,{className:"bg-primary hover:bg-primary/90",children:[f.jsx(Oa,{className:"w-4 h-4 mr-2"}),"Export Problem Areas Report"]})})}),i.urgentNotes.length>0&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(nn,{className:"w-6 h-6 text-red-600"}),f.jsx("h3",{className:"text-xl font-bold text-red-600",children:"ðŸš¨ URGENT FACILITY ISSUES"})]}),f.jsx("div",{className:"grid gap-4",children:i.urgentNotes.map((o,l)=>s(o,l))})]}),i.critical.length>0&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(nn,{className:"w-6 h-6 text-red-600"}),f.jsx("h3",{className:"text-xl font-bold text-red-600",children:"ðŸ”´ CRITICAL PERFORMANCE ISSUES"}),f.jsx(ht,{variant:"destructive",className:"ml-2",children:"Rating < 2.0"})]}),f.jsx("div",{className:"grid gap-4",children:i.critical.map((o,l)=>a(o,l))})]}),i.needsAttention.length>0&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(_r,{className:"w-6 h-6 text-orange-600"}),f.jsx("h3",{className:"text-xl font-bold text-orange-600",children:"ðŸŸ  NEEDS ATTENTION"}),f.jsx(ht,{variant:"secondary",className:"ml-2",children:"Rating 2.0-3.0"})]}),f.jsx("div",{className:"grid gap-4",children:i.needsAttention.map((o,l)=>a(o,l))})]}),i.critical.length===0&&i.needsAttention.length===0&&i.urgentNotes.length===0&&f.jsx(Fe,{className:"text-center py-8",children:f.jsx(je,{children:f.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:f.jsx(zi,{className:"w-8 h-8 text-green-600"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-green-600",children:"No Problem Areas Found"}),f.jsx("p",{className:"text-muted-foreground",children:"All inspections are performing at acceptable levels. Great job!"})]})]})})}),i.summary.totalProblems>0&&f.jsxs(Fe,{children:[f.jsx(ze,{children:f.jsx(He,{className:"text-lg",children:"Problem Areas Summary"})}),f.jsx(je,{children:f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Most Problematic School:"})," ",i.summary.mostProblematicSchool||"N/A"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Affected Schools:"})," ",i.summary.affectedSchools.join(", ")]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Total Issues:"})," ",i.summary.totalProblems," problems across ",i.summary.affectedSchools.length," schools"]})]})})]})]})},Ix=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsxs(VT,ce(q({ref:r,className:Ee("relative flex w-full touch-none select-none items-center",e)},t),{children:[f.jsx(fR,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:f.jsx(hR,{className:"absolute h-full bg-primary"})}),f.jsx(dR,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}))});Ix.displayName=VT.displayName;const Am=mR,Cm=pR,km=gR,ho={last7Days:{from:nf(new Date,7),to:new Date},last30Days:{from:nf(new Date,30),to:new Date},thisMonth:{from:m1(new Date),to:XR(new Date)},thisQuarter:{from:m1(nf(new Date,90)),to:new Date}},NV=[{key:"floors",label:"Floors"},{key:"verticalHorizontalSurfaces",label:"Vertical and Horizontal Surfaces"},{key:"ceiling",label:"Ceiling"},{key:"restrooms",label:"Restrooms"},{key:"customerSatisfaction",label:"Customer Satisfaction and Coordination"},{key:"trash",label:"Trash"},{key:"projectCleaning",label:"Project Cleaning"},{key:"activitySupport",label:"Activity Support"},{key:"safetyCompliance",label:"Safety and Compliance"},{key:"equipment",label:"Equipment"},{key:"monitoring",label:"Monitoring"}],TJ=({inspections:e,custodialNotes:t,filters:r,onFiltersChange:n,onClearFilters:i,isOpen:a,onToggle:s})=>{var w,k,T,S;const o=hs.useRef(null);hs.useEffect(()=>{a&&o.current&&o.current.scrollIntoView({behavior:"smooth",block:"start"})},[a]);const[l,c]=H.useState(r);hs.useEffect(()=>{c(r)},[r,a]);const u=Array.from(new Set(e.map(E=>E.school).filter(Boolean))).sort(),h=Array.from(new Set(e.map(E=>E.inspectorName).filter(Boolean))).sort(),m=(E,A)=>{c(R=>ce(q({},R),{[E]:A}))},d=E=>{const A=ho[E];m("dateRange",A)},g=(E,A)=>{const R=l[E]||[],C=R.includes(A)?R.filter(j=>j!==A):[...R,A];m(E,C)},p=()=>{let E=0;return l.search&&E++,(l.dateRange.from||l.dateRange.to)&&E++,l.schools.length>0&&E++,l.severityLevels.length>0&&E++,l.categories.length>0&&E++,l.inspectors.length>0&&E++,l.ratingThreshold>0&&E++,l.inspectionType!=="all"&&E++,l.showProblemsOnly&&E++,l.hasCustodialNotes&&E++,E},x=E=>E,v=p(),b=()=>{n(l),s()},y=()=>{i(),c({search:"",dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],inspectors:[],ratingThreshold:0,inspectionType:"all",showProblemsOnly:!1,hasCustodialNotes:!1})};return f.jsx(Fe,{className:"w-full",ref:o,children:f.jsxs(Am,{open:a,onOpenChange:s,children:[f.jsx(Cm,{asChild:!0,children:f.jsxs(ze,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(WT,{className:"w-5 h-5"}),f.jsx(He,{className:"text-lg",children:"Advanced Filters"}),v>0&&f.jsxs(ht,{variant:"secondary",className:"ml-2",children:[v," active"]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[v>0&&f.jsxs(Le,{type:"button",variant:"outline",size:"sm",onClick:E=>{E.stopPropagation(),i()},children:[f.jsx(qi,{className:"w-4 h-4 mr-1"}),"Clear All"]}),a?f.jsx(AT,{className:"w-5 h-5"}):f.jsx(Ea,{className:"w-5 h-5"})]})]}),f.jsx(nt,{children:"Filter inspections by date, school, rating, and more"})]})}),f.jsx(km,{children:f.jsxs(je,{className:"space-y-6",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ye,{htmlFor:"search",children:"Search"}),f.jsx(ms,{id:"search",placeholder:"Search by school, room, location, or notes...",value:l.search,onChange:E=>m("search",E.target.value)})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ye,{children:"Date Range"}),f.jsxs("div",{className:"flex gap-2 flex-wrap",children:[f.jsx(Le,{type:"button",variant:((w=l.dateRange.from)==null?void 0:w.getTime())===ho.last7Days.from.getTime()?"default":"outline",size:"sm",onClick:()=>d("last7Days"),children:"Last 7 Days"}),f.jsx(Le,{type:"button",variant:((k=l.dateRange.from)==null?void 0:k.getTime())===ho.last30Days.from.getTime()?"default":"outline",size:"sm",onClick:()=>d("last30Days"),children:"Last 30 Days"}),f.jsx(Le,{type:"button",variant:((T=l.dateRange.from)==null?void 0:T.getTime())===ho.thisMonth.from.getTime()?"default":"outline",size:"sm",onClick:()=>d("thisMonth"),children:"This Month"}),f.jsx(Le,{type:"button",variant:((S=l.dateRange.from)==null?void 0:S.getTime())===ho.thisQuarter.from.getTime()?"default":"outline",size:"sm",onClick:()=>d("thisQuarter"),children:"This Quarter"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{children:[f.jsx(Ye,{htmlFor:"dateFrom",children:"From"}),f.jsx(ms,{id:"dateFrom",type:"date",value:l.dateRange.from?Cc(l.dateRange.from,"yyyy-MM-dd"):"",onChange:E=>m("dateRange",ce(q({},l.dateRange),{from:E.target.value?new Date(E.target.value):null}))})]}),f.jsxs("div",{children:[f.jsx(Ye,{htmlFor:"dateTo",children:"To"}),f.jsx(ms,{id:"dateTo",type:"date",value:l.dateRange.to?Cc(l.dateRange.to,"yyyy-MM-dd"):"",onChange:E=>m("dateRange",ce(q({},l.dateRange),{to:E.target.value?new Date(E.target.value):null}))})]})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ye,{children:"Schools"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(E=>f.jsx(Le,{type:"button",variant:l.schools.includes(E)?"default":"outline",size:"sm",onClick:()=>g("schools",E),children:E},E))})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ye,{children:"Severity Levels"}),f.jsxs("div",{className:"flex gap-4",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:"critical",checked:l.severityLevels.includes("critical"),onCheckedChange:()=>g("severityLevels","critical")}),f.jsx(Ye,{htmlFor:"critical",className:"text-red-600",children:"Critical (< 2.0)"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:"needs-attention",checked:l.severityLevels.includes("needs-attention"),onCheckedChange:()=>g("severityLevels","needs-attention")}),f.jsx(Ye,{htmlFor:"needs-attention",className:"text-orange-600",children:"Needs Attention (2.0-3.0)"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:"acceptable",checked:l.severityLevels.includes("acceptable"),onCheckedChange:()=>g("severityLevels","acceptable")}),f.jsx(Ye,{htmlFor:"acceptable",className:"text-green-600",children:"Acceptable (> 3.0)"})]})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(Ye,{children:["Minimum Rating: ",l.ratingThreshold.toFixed(1)]}),f.jsx(Ix,{value:[l.ratingThreshold],onValueChange:([E])=>m("ratingThreshold",E),max:5,min:0,step:.1,className:"w-full"}),f.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[f.jsx("span",{children:"0.0"}),f.jsx("span",{children:"2.5"}),f.jsx("span",{children:"5.0"})]})]}),f.jsxs(Am,{children:[f.jsx(Cm,{asChild:!0,children:f.jsxs(Le,{type:"button",variant:"ghost",className:"w-full justify-between p-0 h-auto",children:[f.jsx(Ye,{className:"text-base font-medium",children:"Categories"}),f.jsx(Ea,{className:"w-4 h-4"})]})}),f.jsx(km,{className:"space-y-2 mt-2",children:f.jsx("div",{className:"grid grid-cols-2 gap-2",children:NV.map(E=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:E.key,checked:l.categories.includes(E.key),onCheckedChange:()=>g("categories",E.key)}),f.jsx(Ye,{htmlFor:E.key,className:"text-sm",children:E.label})]},E.key))})})]}),f.jsxs(Am,{children:[f.jsx(Cm,{asChild:!0,children:f.jsxs(Le,{type:"button",variant:"ghost",className:"w-full justify-between p-0 h-auto",children:[f.jsx(Ye,{className:"text-base font-medium",children:"Inspectors"}),f.jsx(Ea,{className:"w-4 h-4"})]})}),f.jsx(km,{className:"space-y-2 mt-2",children:f.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(E=>f.jsx(Le,{type:"button",variant:l.inspectors.includes(E)?"default":"outline",size:"sm",onClick:()=>g("inspectors",E),title:x(E),children:E},E))})})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ye,{children:"Inspection Type"}),f.jsxs(Eo,{value:l.inspectionType,onValueChange:E=>m("inspectionType",E),children:[f.jsx(gs,{children:f.jsx(No,{})}),f.jsxs(xs,{children:[f.jsx(Sn,{value:"all",children:"All Types"}),f.jsx(Sn,{value:"single_room",children:"Single Room"}),f.jsx(Sn,{value:"whole_building",children:"Whole Building"})]})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ye,{children:"Quick Filters"}),f.jsxs("div",{className:"flex gap-4",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:"problemsOnly",checked:l.showProblemsOnly,onCheckedChange:E=>m("showProblemsOnly",!!E)}),f.jsx(Ye,{htmlFor:"problemsOnly",children:"Problems Only"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:"hasNotes",checked:l.hasCustodialNotes,onCheckedChange:E=>m("hasCustodialNotes",!!E)}),f.jsx(Ye,{htmlFor:"hasNotes",children:"Has Custodial Notes"})]})]})]}),f.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[f.jsxs(Le,{type:"button",variant:"outline",onClick:y,className:"flex items-center gap-2",children:[f.jsx(qi,{className:"w-4 h-4"}),"Reset Filters"]}),f.jsx(Le,{type:"button",onClick:b,className:"flex items-center gap-2",children:"Apply Filters"})]})]})})]})})},ua=e=>e!=null?e:!1,tS=e=>ce(q({},e),{showProblemsOnly:!!e.showProblemsOnly,hasCustodialNotes:!!e.hasCustodialNotes}),EJ=({filters:e,onApplyPreset:t,schools:r})=>{const n=[{id:"critical-only",label:"Critical Only",description:"Show only critical issues (rating < 2.0)",icon:f.jsx(nn,{className:"w-4 h-4 text-red-600"}),applyFilter:s=>ce(q({},s),{severityLevels:["critical"],showProblemsOnly:!0,ratingThreshold:0}),isActive:s=>s.severityLevels.length===1&&s.severityLevels.includes("critical")&&ua(s.showProblemsOnly)},{id:"asa-issues",label:"ASA Issues",description:"Focus on ASA school problems",icon:f.jsx(rf,{className:"w-4 h-4 text-orange-600"}),applyFilter:s=>ce(q({},s),{schools:["ASA School"],severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.schools.length===1&&s.schools.includes("ASA School")&&ua(s.showProblemsOnly)},{id:"gwc-issues",label:"GWC Issues",description:"Focus on GWC school problems",icon:f.jsx(rf,{className:"w-4 h-4 text-orange-600"}),applyFilter:s=>ce(q({},s),{schools:["GWC School"],severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.schools.length===1&&s.schools.includes("GWC School")&&ua(s.showProblemsOnly)},{id:"recent-problems",label:"Recent Problems",description:"Problems from last 30 days",icon:f.jsx(cr,{className:"w-4 h-4 text-blue-600"}),applyFilter:s=>ce(q({},s),{dateRange:{from:new Date(Date.now()-2592e6),to:new Date},severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>tS(s).showProblemsOnly===!0&&s.severityLevels.includes("critical")&&s.severityLevels.includes("needs-attention")&&!!s.dateRange.from&&Math.abs(s.dateRange.from.getTime()-(Date.now()-2592e6))<864e5},{id:"urgent-notes",label:"Urgent Notes",description:"Show inspections with urgent custodial notes",icon:f.jsx(_r,{className:"w-4 h-4 text-red-600"}),applyFilter:s=>ce(q({},s),{hasCustodialNotes:!0,severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>ua(s.hasCustodialNotes)===!0&&ua(s.showProblemsOnly)===!0&&s.severityLevels.includes("critical")},{id:"low-performance",label:"Low Performance",description:"All ratings below 3.0",icon:f.jsx(og,{className:"w-4 h-4 text-orange-600"}),applyFilter:s=>ce(q({},s),{ratingThreshold:0,severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.ratingThreshold===0&&ua(s.showProblemsOnly)&&s.severityLevels.includes("critical")&&s.severityLevels.includes("needs-attention")},{id:"this-month",label:"This Month",description:"All inspections from current month",icon:f.jsx(cr,{className:"w-4 h-4 text-green-600"}),applyFilter:s=>ce(q({},s),{dateRange:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date},schools:[],severityLevels:[],showProblemsOnly:!1}),isActive:s=>{const o=tS(s);return!!s.dateRange.from&&s.dateRange.from.getMonth()===new Date().getMonth()&&s.dateRange.from.getFullYear()===new Date().getFullYear()&&o.showProblemsOnly===!1}},{id:"all-schools",label:"All Schools",description:"Show all schools with problems",icon:f.jsx(rf,{className:"w-4 h-4 text-purple-600"}),applyFilter:s=>ce(q({},s),{schools:r,severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.schools.length===r.length&&ua(s.showProblemsOnly)&&s.severityLevels.includes("critical")&&s.severityLevels.includes("needs-attention")}],i=s=>{const o=s.applyFilter(e);t(o)},a=(s,o)=>{o.stopPropagation(),t({search:"",dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],inspectors:[],ratingThreshold:0,inspectionType:"all",showProblemsOnly:!1,hasCustodialNotes:!1})};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Quick Filters"}),f.jsxs(ht,{variant:"outline",className:"text-xs",children:[n.filter(s=>s.isActive(e)).length," active"]})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:n.map(s=>{const o=s.isActive(e);return f.jsxs(Le,{type:"button",variant:o?"default":"outline",className:`h-auto p-4 flex flex-col items-start gap-2 text-left relative ${o?"bg-primary text-primary-foreground border-2 border-primary shadow-lg":"hover:bg-muted/50"} ${o?"outline outline-2 outline-primary":""}`,onClick:()=>i(s),children:[f.jsxs("div",{className:"flex items-center gap-2 w-full",children:[s.icon,f.jsx("span",{className:"font-medium text-sm",children:s.label}),o&&f.jsx("button",{type:"button",onClick:l=>a(s,l),className:"ml-auto p-1 rounded-full hover:bg-primary-foreground/20 transition-colors","aria-label":`Remove ${s.label} filter`,children:f.jsx(qi,{className:"w-3 h-3"})})]}),f.jsx("p",{className:"text-xs text-muted-foreground text-left",children:s.description})]},s.id)})})]})},rS=[{id:"executive",title:"Executive Summary",description:"High-level overview with KPIs, trends, and critical issues for leadership",icon:ng,badge:"Best for monthly reports",color:"bg-blue-50 border-blue-200 hover:bg-blue-100",selectedColor:"bg-blue-100 border-blue-300",iconColor:"text-blue-600"},{id:"school-performance",title:"School Performance",description:"Compare schools, identify trends, and track performance over time",icon:an,badge:"Best for comparisons",color:"bg-green-50 border-green-200 hover:bg-green-100",selectedColor:"bg-green-100 border-green-300",iconColor:"text-green-600"},{id:"category-analysis",title:"Category Analysis",description:"Deep dive into specific cleaning categories and problem areas",icon:UT,badge:"Best for detailed analysis",color:"bg-purple-50 border-purple-200 hover:bg-purple-100",selectedColor:"bg-purple-100 border-purple-300",iconColor:"text-purple-600"},{id:"issues",title:"Issues Report",description:"List of problems, critical issues, and items needing attention",icon:nn,badge:"Best for problem tracking",color:"bg-red-50 border-red-200 hover:bg-red-100",selectedColor:"bg-red-100 border-red-300",iconColor:"text-red-600"},{id:"custom",title:"Custom Report",description:"Build your own report with flexible sections and data combinations",icon:xR,badge:"Best for specific needs",color:"bg-gray-50 border-gray-200 hover:bg-gray-100",selectedColor:"bg-gray-100 border-gray-300",iconColor:"text-gray-600"}],AV=({selectedType:e,onTypeChange:t})=>{var r;return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"text-center space-y-2",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Choose Report Type"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Select the type of report that best fits your needs"})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:rS.map(n=>{const i=n.icon,a=e===n.id;return f.jsxs(Fe,{className:`cursor-pointer transition-all duration-200 ${a?`${n.selectedColor} ring-2 ring-primary/20`:`${n.color} hover:shadow-md`}`,onClick:()=>t(n.id),children:[f.jsx(ze,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${a?"bg-white":"bg-white/50"}`,children:f.jsx(i,{className:`w-5 h-5 ${n.iconColor}`})}),f.jsxs("div",{children:[f.jsx(He,{className:"text-base",children:n.title}),f.jsx(ht,{variant:"secondary",className:"text-xs mt-1",children:n.badge})]})]}),a&&f.jsx("div",{className:"w-5 h-5 rounded-full bg-primary flex items-center justify-center",children:f.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})})]})}),f.jsx(je,{className:"pt-0",children:f.jsx(nt,{className:"text-sm leading-relaxed",children:n.description})})]},n.id)})}),e&&f.jsx("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:f.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[f.jsx(wi,{className:"w-4 h-4"}),f.jsxs("span",{children:["Selected: ",f.jsx("strong",{children:(r=rS.find(n=>n.id===e))==null?void 0:r.title})]})]})})]})},CV=({config:e,onConfigChange:t,inspections:r,custodialNotes:n})=>{const i=pV({inspections:r,custodialNotes:n}),a=(o,l)=>{t(ce(q({},e),{dataTypes:ce(q({},e.dataTypes),{[o]:l})}))},s=(o,l)=>{t(ce(q({},e),{[o]:l}))};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"text-center space-y-2",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Select Data to Include"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose what data and content to include in your PDF report"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h4",{className:"text-sm font-medium text-foreground",children:"Data Types"}),f.jsx(Fe,{className:"hover:shadow-sm transition-shadow",children:f.jsx(ze,{className:"pb-3",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Ht,{id:"inspections",checked:e.dataTypes.inspections,onCheckedChange:o=>a("inspections",!!o)}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wi,{className:"w-4 h-4 text-blue-600"}),f.jsxs("div",{children:[f.jsx(He,{className:"text-sm",children:"Inspections"}),f.jsx(nt,{className:"text-xs",children:"Individual inspection records with ratings and details"})]})]})]}),f.jsxs(ht,{variant:"secondary",className:"text-xs",children:[i.inspections," records"]})]})})}),f.jsx(Fe,{className:"hover:shadow-sm transition-shadow",children:f.jsx(ze,{className:"pb-3",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Ht,{id:"custodialNotes",checked:e.dataTypes.custodialNotes,onCheckedChange:o=>a("custodialNotes",!!o)}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(vR,{className:"w-4 h-4 text-green-600"}),f.jsxs("div",{children:[f.jsx(He,{className:"text-sm",children:"Custodial Notes"}),f.jsx(nt,{className:"text-xs",children:"Notes and comments from custodial staff"})]})]})]}),f.jsxs(ht,{variant:"secondary",className:"text-xs",children:[i.custodialNotes," notes"]})]})})}),f.jsx(Fe,{className:"hover:shadow-sm transition-shadow",children:f.jsx(ze,{className:"pb-3",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Ht,{id:"images",checked:e.dataTypes.images,onCheckedChange:o=>a("images",!!o)}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(yR,{className:"w-4 h-4 text-purple-600"}),f.jsxs("div",{children:[f.jsx(He,{className:"text-sm",children:"Images"}),f.jsx(nt,{className:"text-xs",children:"Photos and visual documentation from inspections"})]})]})]}),f.jsxs(ht,{variant:"secondary",className:"text-xs",children:[i.images," images (",i.totalSize,")"]})]})})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h4",{className:"text-sm font-medium text-foreground",children:"Content Options"}),f.jsx(Fe,{className:"hover:shadow-sm transition-shadow",children:f.jsx(ze,{className:"pb-3",children:f.jsx("div",{className:"flex items-center justify-between",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Ht,{id:"includeCharts",checked:e.includeCharts,onCheckedChange:o=>s("includeCharts",!!o)}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(ng,{className:"w-4 h-4 text-orange-600"}),f.jsxs("div",{children:[f.jsx(He,{className:"text-sm",children:"Charts & Visualizations"}),f.jsx(nt,{className:"text-xs",children:"Include performance charts, trends, and data visualizations"})]})]})]})})})}),f.jsx(Fe,{className:"hover:shadow-sm transition-shadow",children:f.jsx(ze,{className:"pb-3",children:f.jsx("div",{className:"flex items-center justify-between",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Ht,{id:"includeDetails",checked:e.includeDetails,onCheckedChange:o=>s("includeDetails",!!o)}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wR,{className:"w-4 h-4 text-indigo-600"}),f.jsxs("div",{children:[f.jsx(He,{className:"text-sm",children:"Individual Details"}),f.jsx(nt,{className:"text-xs",children:"Include full inspection details instead of summary only"})]})]})]})})})})]}),f.jsxs("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(wo,{className:"w-4 h-4 text-muted-foreground"}),f.jsx("span",{className:"text-sm font-medium",children:"Selected Data Summary"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs text-muted-foreground",children:[f.jsxs("div",{children:[e.dataTypes.inspections&&f.jsxs("div",{children:["â€¢ ",i.inspections," inspections"]}),e.dataTypes.custodialNotes&&f.jsxs("div",{children:["â€¢ ",i.custodialNotes," notes"]}),e.dataTypes.images&&f.jsxs("div",{children:["â€¢ ",i.images," images"]})]}),f.jsxs("div",{children:[e.includeCharts&&f.jsx("div",{children:"â€¢ Charts included"}),e.includeDetails&&f.jsx("div",{children:"â€¢ Full details"})]})]})]})]})};function Rp(i){var a=i,{className:e,classNames:t,showOutsideDays:r=!0}=a,n=we(a,["className","classNames","showOutsideDays"]);return f.jsx(bR,q({showOutsideDays:r,className:Ee("p-3",e),classNames:q({months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Ee(Uo({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Ee(Uo({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible"},t),components:{IconLeft:l=>{var c=l,{className:s}=c,o=we(c,["className"]);return f.jsx(_R,q({className:Ee("h-4 w-4",s)},o))},IconRight:l=>{var c=l,{className:s}=c,o=we(c,["className"]);return f.jsx(du,q({className:Ee("h-4 w-4",s)},o))}}},n))}Rp.displayName="Calendar";const lu=SR,cu=TR,cl=H.forwardRef((a,i)=>{var s=a,{className:e,align:t="center",sideOffset:r=4}=s,n=we(s,["className","align","sideOffset"]);return f.jsx(ER,{children:f.jsx(GT,q({ref:i,align:t,sideOffset:r,className:Ee("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",e)},n))})});cl.displayName=GT.displayName;const kV=[{label:"Last 7 days",days:7},{label:"Last 30 days",days:30},{label:"Last 90 days",days:90},{label:"This year",days:365}],RV=[{id:"critical",label:"Critical",description:"Rating â‰¤ 2 stars"},{id:"needs-attention",label:"Needs Attention",description:"Rating â‰¤ 3 stars"},{id:"acceptable",label:"Acceptable",description:"Rating > 3 stars"}],OV=({config:e,onConfigChange:t,availableSchools:r,availableCategories:n})=>{const i=(u,h)=>{t(ce(q({},e),{filters:ce(q({},e.filters),{[u]:h})}))},a=u=>{const h=new Date,m=new Date;m.setDate(m.getDate()-u),i("dateRange",{from:m,to:h})},s=(u,h)=>{const m=e.filters[u],d=m.includes(h)?m.filter(g=>g!==h):[...m,h];i(u,d)},o=()=>{t(ce(q({},e),{filters:{dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],ratingThreshold:0}}))},c=(()=>{let u=0;return(e.filters.dateRange.from||e.filters.dateRange.to)&&u++,e.filters.schools.length>0&&u++,e.filters.severityLevels.length>0&&u++,e.filters.categories.length>0&&u++,e.filters.ratingThreshold>0&&u++,u})();return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"text-center space-y-2",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Apply Filters"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Narrow down the data to include in your report"}),c>0&&f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsxs(ht,{variant:"secondary",className:"text-xs",children:[c," filter",c!==1?"s":""," active"]}),f.jsxs(Le,{variant:"ghost",size:"sm",onClick:o,className:"text-xs h-6 px-2",children:[f.jsx(qi,{className:"w-3 h-3 mr-1"}),"Clear all"]})]})]}),f.jsxs(Fe,{children:[f.jsx(ze,{className:"pb-3",children:f.jsxs(He,{className:"text-sm flex items-center gap-2",children:[f.jsx(cr,{className:"w-4 h-4"}),"Date Range"]})}),f.jsxs(je,{className:"space-y-4",children:[f.jsx("div",{className:"grid grid-cols-2 gap-2",children:kV.map(u=>f.jsx(Le,{variant:"outline",size:"sm",onClick:()=>a(u.days),className:"text-xs",children:u.label},u.label))}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"From"}),f.jsxs(lu,{children:[f.jsx(cu,{asChild:!0,children:f.jsxs(Le,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[f.jsx(cr,{className:"mr-2 h-4 w-4"}),e.filters.dateRange.from?Cc(e.filters.dateRange.from,"MMM dd, yyyy"):f.jsx("span",{children:"Select date"})]})}),f.jsx(cl,{className:"w-auto p-0",children:f.jsx(Rp,{mode:"single",selected:e.filters.dateRange.from||void 0,onSelect:u=>i("dateRange",ce(q({},e.filters.dateRange),{from:u||null})),initialFocus:!0})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"To"}),f.jsxs(lu,{children:[f.jsx(cu,{asChild:!0,children:f.jsxs(Le,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[f.jsx(cr,{className:"mr-2 h-4 w-4"}),e.filters.dateRange.to?Cc(e.filters.dateRange.to,"MMM dd, yyyy"):f.jsx("span",{children:"Select date"})]})}),f.jsx(cl,{className:"w-auto p-0",children:f.jsx(Rp,{mode:"single",selected:e.filters.dateRange.to||void 0,onSelect:u=>i("dateRange",ce(q({},e.filters.dateRange),{to:u||null})),initialFocus:!0})})]})]})]})]})]}),f.jsxs(Fe,{children:[f.jsxs(ze,{className:"pb-3",children:[f.jsx(He,{className:"text-sm",children:"Schools"}),f.jsx(nt,{className:"text-xs",children:"Select specific schools to include"})]}),f.jsxs(je,{children:[f.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:r.map(u=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:`school-${u}`,checked:e.filters.schools.includes(u),onCheckedChange:()=>s("schools",u)}),f.jsx("label",{htmlFor:`school-${u}`,className:"text-sm",children:u})]},u))}),e.filters.schools.length>0&&f.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:e.filters.schools.map(u=>f.jsx(ht,{variant:"secondary",className:"text-xs",children:u},u))})]})]}),f.jsxs(Fe,{children:[f.jsxs(ze,{className:"pb-3",children:[f.jsx(He,{className:"text-sm",children:"Severity Levels"}),f.jsx(nt,{className:"text-xs",children:"Filter by problem severity"})]}),f.jsx(je,{children:f.jsx("div",{className:"space-y-2",children:RV.map(u=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:`severity-${u.id}`,checked:e.filters.severityLevels.includes(u.id),onCheckedChange:()=>s("severityLevels",u.id)}),f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{htmlFor:`severity-${u.id}`,className:"text-sm font-medium",children:u.label}),f.jsx("p",{className:"text-xs text-muted-foreground",children:u.description})]})]},u.id))})})]}),f.jsxs(Fe,{children:[f.jsxs(ze,{className:"pb-3",children:[f.jsx(He,{className:"text-sm",children:"Categories"}),f.jsx(nt,{className:"text-xs",children:"Select specific cleaning categories"})]}),f.jsx(je,{children:f.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:n.map(u=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ht,{id:`category-${u.key}`,checked:e.filters.categories.includes(u.key),onCheckedChange:()=>s("categories",u.key)}),f.jsx("label",{htmlFor:`category-${u.key}`,className:"text-sm",children:u.label})]},u.key))})})]}),f.jsxs(Fe,{children:[f.jsxs(ze,{className:"pb-3",children:[f.jsx(He,{className:"text-sm",children:"Rating Threshold"}),f.jsx(nt,{className:"text-xs",children:"Only include inspections with average rating at or below this threshold"})]}),f.jsx(je,{children:f.jsxs("div",{className:"space-y-3",children:[f.jsx(Ix,{value:[e.filters.ratingThreshold],onValueChange:([u])=>i("ratingThreshold",u),max:5,min:0,step:.5,className:"w-full"}),f.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[f.jsx("span",{children:"All ratings"}),f.jsx("span",{className:"font-medium",children:e.filters.ratingThreshold>0?`â‰¤ ${e.filters.ratingThreshold} stars`:"No filter"}),f.jsx("span",{children:"1 star only"})]})]})})]})]})},Do=H.forwardRef((i,n)=>{var a=i,{className:e,value:t}=a,r=we(a,["className","value"]);return f.jsx(YT,ce(q({ref:n,className:Ee("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e)},r),{children:f.jsx(NR,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}))});Do.displayName=YT.displayName;const FV=({config:e,inspections:t,custodialNotes:r,onExport:n,isExporting:i=!1,exportProgress:a=0})=>{const s=kp(e),o=Ks({inspections:t,custodialNotes:r},e),l=hV(e,{inspections:t,custodialNotes:r}),c=dV(e,{inspections:t,custodialNotes:r}),u=mV(e),m=(()=>{const d={executive:{name:"Executive Summary",icon:"ðŸ“Š",color:"bg-blue-100 text-blue-800"},"school-performance":{name:"School Performance",icon:"ðŸ«",color:"bg-green-100 text-green-800"},"category-analysis":{name:"Category Analysis",icon:"ðŸŽ¯",color:"bg-purple-100 text-purple-800"},issues:{name:"Issues Report",icon:"âš ï¸",color:"bg-red-100 text-red-800"},custom:{name:"Custom Report",icon:"âš™ï¸",color:"bg-gray-100 text-gray-800"}};return d[e.reportType]||d.custom})();return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"text-center space-y-2",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Review & Export"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Review your selections and generate the PDF report"})]}),i&&f.jsx(Fe,{className:"border-primary/20 bg-primary/5",children:f.jsx(je,{className:"pt-6",children:f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ac,{className:"w-4 h-4 animate-spin text-primary"}),f.jsx("span",{className:"text-sm font-medium",children:"Generating PDF..."})]}),f.jsx(Do,{value:a,className:"w-full"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"This may take a moment for large reports with images and charts"})]})})}),f.jsxs(Fe,{children:[f.jsx(ze,{className:"pb-3",children:f.jsxs(He,{className:"text-sm flex items-center gap-2",children:[f.jsx(wi,{className:"w-4 h-4"}),"Report Summary"]})}),f.jsxs(je,{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm font-medium",children:"Report Type"}),f.jsxs(ht,{className:m.color,children:[f.jsx("span",{className:"mr-1",children:m.icon}),m.name]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("span",{className:"text-sm font-medium",children:"Data Included"}),f.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.dataTypes.inspections&&f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wo,{className:"w-3 h-3 text-blue-600"}),f.jsxs("span",{children:[o.inspections.length," inspections"]})]}),e.dataTypes.custodialNotes&&f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wo,{className:"w-3 h-3 text-green-600"}),f.jsxs("span",{children:[o.custodialNotes.length," notes"]})]}),e.dataTypes.images&&f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wo,{className:"w-3 h-3 text-purple-600"}),f.jsx("span",{children:"Images included"})]}),e.includeCharts&&f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wo,{className:"w-3 h-3 text-orange-600"}),f.jsx("span",{children:"Charts included"})]})]})]}),u.length>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("span",{className:"text-sm font-medium flex items-center gap-2",children:[f.jsx(WT,{className:"w-3 h-3"}),"Active Filters"]}),f.jsx("div",{className:"flex flex-wrap gap-1",children:u.map((d,g)=>f.jsx(ht,{variant:"secondary",className:"text-xs",children:d},g))})]})]})]}),f.jsxs(Fe,{children:[f.jsx(ze,{className:"pb-3",children:f.jsx(He,{className:"text-sm",children:"Export Details"})}),f.jsx(je,{className:"space-y-3",children:f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-muted-foreground",children:"File Size"}),f.jsx("span",{className:"font-medium",children:l})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-muted-foreground",children:"Pages"}),f.jsx("span",{className:"font-medium",children:c})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-muted-foreground",children:"Records"}),f.jsx("span",{className:"font-medium",children:o.totalRecords})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-muted-foreground",children:"Schools"}),f.jsx("span",{className:"font-medium",children:o.schools.length>0?o.schools.length:"All"})]})]})})]}),!s.isValid&&f.jsx(Fe,{className:"border-red-200 bg-red-50",children:f.jsx(je,{className:"pt-6",children:f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx(_r,{className:"w-4 h-4 text-red-600 mt-0.5"}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("p",{className:"text-sm font-medium text-red-800",children:"Please fix the following issues:"}),f.jsx("ul",{className:"text-xs text-red-700 space-y-1",children:s.errors.map((d,g)=>f.jsxs("li",{children:["â€¢ ",d]},g))})]})]})})}),f.jsx("div",{className:"flex justify-center",children:f.jsx(Le,{onClick:n,disabled:!s.isValid||i,size:"lg",className:"min-w-[200px]",children:i?f.jsxs(f.Fragment,{children:[f.jsx(Ac,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Oa,{className:"w-4 h-4 mr-2"}),"Export PDF Report"]})})}),!i&&s.isValid&&f.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-green-700 bg-green-50 p-3 rounded-lg",children:[f.jsx(En,{className:"w-4 h-4"}),f.jsx("span",{children:"Ready to export! Click the button above to generate your PDF."})]})]})},NJ=({inspections:e,custodialNotes:t,availableSchools:r,availableCategories:n,trigger:i,onExportComplete:a})=>{var E;const{toast:s}=mu(),[o,l]=H.useState(!1),[c,u]=H.useState(1),[h,m]=H.useState(!1),[d,g]=H.useState(0),[p,x]=H.useState({reportType:"executive",dataTypes:{inspections:!0,custodialNotes:!1,images:!1},filters:{dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],ratingThreshold:0},includeCharts:!0,includeDetails:!1}),v=[{id:1,title:"Report Type",description:"Choose your report type",isComplete:!1},{id:2,title:"Data Selection",description:"Select data to include",isComplete:!1},{id:3,title:"Filters",description:"Apply filters and criteria",isComplete:!1},{id:4,title:"Export",description:"Review and generate PDF",isComplete:!1}],b=H.useCallback((A,R)=>{},[]),y=()=>{c<v.length&&u(c+1)},w=()=>{c>1&&u(c-1)},k=A=>{x(A),kp(A),c===1&&A.reportType?b(1,!0):c===2&&(A.dataTypes.inspections||A.dataTypes.custodialNotes)?b(2,!0):c===3&&b(3,!0)},T=()=>lt(null,null,function*(){try{m(!0),g(0);const A=kp(p);if(!A.isValid){s({title:"Export Error",description:A.errors.join(", "),variant:"destructive"});return}const R=setInterval(()=>{g(W=>W>=90?(clearInterval(R),W):W+Math.random()*20)},200),C=Ks({inspections:e,custodialNotes:t},p);let j;switch(p.reportType){case"issues":j=W4({inspections:C.inspections,custodialNotes:C.custodialNotes,startDate:p.filters.dateRange.from||void 0,endDate:p.filters.dateRange.to||void 0,schoolFilter:p.filters.schools.length===1?p.filters.schools[0]:void 0,activeFilters:[]});break;case"executive":j=bV({inspections:e,custodialNotes:t},p);break;case"school-performance":j=_V({inspections:e,custodialNotes:t},p);break;case"category-analysis":j=SV({inspections:e,custodialNotes:t},p);break;case"custom":j=TV({inspections:e,custodialNotes:t},p);break;default:throw new Error("Invalid report type")}clearInterval(R),g(100);const z=URL.createObjectURL(j),G=document.createElement("a");G.href=z,G.download=`custodial-report-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(G),G.click(),document.body.removeChild(G),URL.revokeObjectURL(z),s({title:"Export Successful",description:"Your PDF report has been generated and downloaded."}),l(!1),a==null||a()}catch(A){console.error("Export failed:",A),s({title:"Export Failed",description:"There was an error generating your PDF report. Please try again.",variant:"destructive"})}finally{m(!1),g(0)}}),S=()=>{switch(c){case 1:return f.jsx(AV,{selectedType:p.reportType,onTypeChange:A=>k(ce(q({},p),{reportType:A}))});case 2:return f.jsx(CV,{config:p,onConfigChange:k,inspections:e,custodialNotes:t});case 3:return f.jsx(OV,{config:p,onConfigChange:k,availableSchools:r,availableCategories:n});case 4:return f.jsx(FV,{config:p,inspections:e,custodialNotes:t,onExport:T,isExporting:h,exportProgress:d});default:return null}};return f.jsxs(_u,{open:o,onOpenChange:l,children:[i&&f.jsx("div",{onClick:A=>{A.preventDefault(),A.stopPropagation(),l(!0)},children:i}),f.jsxs(pl,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[f.jsxs(gl,{children:[f.jsxs(xl,{className:"flex items-center gap-2",children:[f.jsx(wi,{className:"w-5 h-5"}),"PDF Export Wizard"]}),f.jsxs(vl,{children:["Step ",c," of ",v.length,": ",(E=v[c-1])==null?void 0:E.description]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center justify-between",children:v.map((A,R)=>f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:`
                  flex items-center justify-center w-8 h-8 rounded-full border-2 transition-colors
                  ${c>A.id?"bg-primary border-primary text-primary-foreground":c===A.id?"border-primary text-primary":"border-muted-foreground text-muted-foreground"}
                `,children:c>A.id?f.jsx(En,{className:"w-4 h-4"}):f.jsx("span",{className:"text-sm font-medium",children:A.id})}),R<v.length-1&&f.jsx("div",{className:`
                    w-12 h-0.5 mx-2 transition-colors
                    ${c>A.id?"bg-primary":"bg-muted-foreground/30"}
                  `})]},A.id))}),f.jsx("div",{className:"flex justify-between text-xs text-muted-foreground",children:v.map(A=>f.jsx("div",{className:"text-center max-w-20",children:f.jsx("div",{className:"font-medium",children:A.title})},A.id))})]}),f.jsx("div",{className:"py-6",children:S()}),f.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs(Le,{variant:"outline",onClick:()=>l(!1),disabled:h,children:[f.jsx(qi,{className:"w-4 h-4 mr-2"}),"Cancel"]})}),f.jsxs("div",{className:"flex items-center gap-2",children:[c>1&&f.jsxs(Le,{variant:"outline",onClick:w,disabled:h,children:[f.jsx(AR,{className:"w-4 h-4 mr-2"}),"Back"]}),c<v.length&&f.jsxs(Le,{onClick:y,disabled:h,children:["Next",f.jsx(CR,{className:"w-4 h-4 ml-2"})]})]})]})]})]})},AJ=kR,CJ=RR,IV=OR,G4=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(eE,ce(q({className:Ee("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e)},t),{ref:r}))});G4.displayName=eE.displayName;const jV=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsxs(IV,{children:[f.jsx(G4,{}),f.jsx(XT,q({ref:r,className:Ee("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e)},t))]})});jV.displayName=XT.displayName;const DV=r=>{var n=r,{className:e}=n,t=we(n,["className"]);return f.jsx("div",q({className:Ee("flex flex-col space-y-2 text-center sm:text-left",e)},t))};DV.displayName="AlertDialogHeader";const PV=r=>{var n=r,{className:e}=n,t=we(n,["className"]);return f.jsx("div",q({className:Ee("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e)},t))};PV.displayName="AlertDialogFooter";const MV=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(KT,q({ref:r,className:Ee("text-lg font-semibold",e)},t))});MV.displayName=KT.displayName;const LV=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(QT,q({ref:r,className:Ee("text-sm text-muted-foreground",e)},t))});LV.displayName=QT.displayName;const BV=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(JT,q({ref:r,className:Ee(Uo(),e)},t))});BV.displayName=JT.displayName;const UV=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(ZT,q({ref:r,className:Ee(Uo({variant:"outline"}),"mt-2 sm:mt-0",e)},t))});UV.displayName=ZT.displayName;var nS=1,qV=.9,zV=.8,HV=.17,Rm=.1,Om=.999,$V=.9999,VV=.99,WV=/[\\\/_+.#"@\[\(\{&]/,GV=/[\\\/_+.#"@\[\(\{&]/g,YV=/[\s-]/,Y4=/[\s-]/g;function Op(e,t,r,n,i,a,s){if(a===t.length)return i===e.length?nS:VV;var o=`${i},${a}`;if(s[o]!==void 0)return s[o];for(var l=n.charAt(a),c=r.indexOf(l,i),u=0,h,m,d,g;c>=0;)h=Op(e,t,r,n,c+1,a+1,s),h>u&&(c===i?h*=nS:WV.test(e.charAt(c-1))?(h*=zV,d=e.slice(i,c-1).match(GV),d&&i>0&&(h*=Math.pow(Om,d.length))):YV.test(e.charAt(c-1))?(h*=qV,g=e.slice(i,c-1).match(Y4),g&&i>0&&(h*=Math.pow(Om,g.length))):(h*=HV,i>0&&(h*=Math.pow(Om,c-i))),e.charAt(c)!==t.charAt(a)&&(h*=$V)),(h<Rm&&r.charAt(c-1)===n.charAt(a+1)||n.charAt(a+1)===n.charAt(a)&&r.charAt(c-1)!==n.charAt(a))&&(m=Op(e,t,r,n,c+1,a+2,s),m*Rm>h&&(h=m*Rm)),h>u&&(u=h),c=r.indexOf(l,c+1);return s[o]=u,u}function iS(e){return e.toLowerCase().replace(Y4," ")}function XV(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,Op(e,t,iS(e),iS(t),0,0,{})}var mo='[cmdk-group=""]',Fm='[cmdk-group-items=""]',KV='[cmdk-group-heading=""]',X4='[cmdk-item=""]',aS=`${X4}:not([aria-disabled="true"])`,Fp="cmdk-item-select",ls="data-value",QV=(e,t,r)=>XV(e,t,r),K4=H.createContext(void 0),Ol=()=>H.useContext(K4),Q4=H.createContext(void 0),jx=()=>H.useContext(Q4),Z4=H.createContext(void 0),J4=H.forwardRef((e,t)=>{let r=cs(()=>{var _,M;return{search:"",value:(M=(_=e.value)!=null?_:e.defaultValue)!=null?M:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=cs(()=>new Set),i=cs(()=>new Map),a=cs(()=>new Map),s=cs(()=>new Set),o=ek(e),B=e,{label:l,children:c,value:u,onValueChange:h,filter:m,shouldFilter:d,loop:g,disablePointerSelection:p=!1,vimBindings:x=!0}=B,v=we(B,["label","children","value","onValueChange","filter","shouldFilter","loop","disablePointerSelection","vimBindings"]),b=ds(),y=ds(),w=ds(),k=H.useRef(null),T=lW();Ua(()=>{if(u!==void 0){let _=u.trim();r.current.value=_,S.emit()}},[u]),Ua(()=>{T(6,z)},[]);let S=H.useMemo(()=>({subscribe:_=>(s.current.add(_),()=>s.current.delete(_)),snapshot:()=>r.current,setState:(_,M,U)=>{var V,le,de,K;if(!Object.is(r.current[_],M)){if(r.current[_]=M,_==="search")j(),R(),T(1,C);else if(_==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let J=document.getElementById(w);J?J.focus():(V=document.getElementById(b))==null||V.focus()}if(T(7,()=>{var J;r.current.selectedItemId=(J=G())==null?void 0:J.id,S.emit()}),U||T(5,z),((le=o.current)==null?void 0:le.value)!==void 0){let J=M!=null?M:"";(K=(de=o.current).onValueChange)==null||K.call(de,J);return}}S.emit()}},emit:()=>{s.current.forEach(_=>_())}}),[]),E=H.useMemo(()=>({value:(_,M,U)=>{var V;M!==((V=a.current.get(_))==null?void 0:V.value)&&(a.current.set(_,{value:M,keywords:U}),r.current.filtered.items.set(_,A(M,U)),T(2,()=>{R(),S.emit()}))},item:(_,M)=>(n.current.add(_),M&&(i.current.has(M)?i.current.get(M).add(_):i.current.set(M,new Set([_]))),T(3,()=>{j(),R(),r.current.value||C(),S.emit()}),()=>{a.current.delete(_),n.current.delete(_),r.current.filtered.items.delete(_);let U=G();T(4,()=>{j(),(U==null?void 0:U.getAttribute("id"))===_&&C(),S.emit()})}),group:_=>(i.current.has(_)||i.current.set(_,new Set),()=>{a.current.delete(_),i.current.delete(_)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:b,inputId:w,labelId:y,listInnerRef:k}),[]);function A(_,M){var U,V;let le=(V=(U=o.current)==null?void 0:U.filter)!=null?V:QV;return _?le(_,r.current.search,M):0}function R(){if(!r.current.search||o.current.shouldFilter===!1)return;let _=r.current.filtered.items,M=[];r.current.filtered.groups.forEach(V=>{let le=i.current.get(V),de=0;le.forEach(K=>{let J=_.get(K);de=Math.max(J,de)}),M.push([V,de])});let U=k.current;W().sort((V,le)=>{var de,K;let J=V.getAttribute("id"),Se=le.getAttribute("id");return((de=_.get(Se))!=null?de:0)-((K=_.get(J))!=null?K:0)}).forEach(V=>{let le=V.closest(Fm);le?le.appendChild(V.parentElement===le?V:V.closest(`${Fm} > *`)):U.appendChild(V.parentElement===U?V:V.closest(`${Fm} > *`))}),M.sort((V,le)=>le[1]-V[1]).forEach(V=>{var le;let de=(le=k.current)==null?void 0:le.querySelector(`${mo}[${ls}="${encodeURIComponent(V[0])}"]`);de==null||de.parentElement.appendChild(de)})}function C(){let _=W().find(U=>U.getAttribute("aria-disabled")!=="true"),M=_==null?void 0:_.getAttribute(ls);S.setState("value",M||void 0)}function j(){var _,M,U,V;if(!r.current.search||o.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let le=0;for(let de of n.current){let K=(M=(_=a.current.get(de))==null?void 0:_.value)!=null?M:"",J=(V=(U=a.current.get(de))==null?void 0:U.keywords)!=null?V:[],Se=A(K,J);r.current.filtered.items.set(de,Se),Se>0&&le++}for(let[de,K]of i.current)for(let J of K)if(r.current.filtered.items.get(J)>0){r.current.filtered.groups.add(de);break}r.current.filtered.count=le}function z(){var _,M,U;let V=G();V&&(((_=V.parentElement)==null?void 0:_.firstChild)===V&&((U=(M=V.closest(mo))==null?void 0:M.querySelector(KV))==null||U.scrollIntoView({block:"nearest"})),V.scrollIntoView({block:"nearest"}))}function G(){var _;return(_=k.current)==null?void 0:_.querySelector(`${X4}[aria-selected="true"]`)}function W(){var _;return Array.from(((_=k.current)==null?void 0:_.querySelectorAll(aS))||[])}function fe(_){let M=W()[_];M&&S.setState("value",M.getAttribute(ls))}function he(_){var M;let U=G(),V=W(),le=V.findIndex(K=>K===U),de=V[le+_];(M=o.current)!=null&&M.loop&&(de=le+_<0?V[V.length-1]:le+_===V.length?V[0]:V[le+_]),de&&S.setState("value",de.getAttribute(ls))}function ee(_){let M=G(),U=M==null?void 0:M.closest(mo),V;for(;U&&!V;)U=_>0?sW(U,mo):oW(U,mo),V=U==null?void 0:U.querySelector(aS);V?S.setState("value",V.getAttribute(ls)):he(_)}let re=()=>fe(W().length-1),O=_=>{_.preventDefault(),_.metaKey?re():_.altKey?ee(1):he(1)},ge=_=>{_.preventDefault(),_.metaKey?fe(0):_.altKey?ee(-1):he(-1)};return H.createElement(Zi.div,ce(q({ref:t,tabIndex:-1},v),{"cmdk-root":"",onKeyDown:_=>{var M;(M=v.onKeyDown)==null||M.call(v,_);let U=_.nativeEvent.isComposing||_.keyCode===229;if(!(_.defaultPrevented||U))switch(_.key){case"n":case"j":{x&&_.ctrlKey&&O(_);break}case"ArrowDown":{O(_);break}case"p":case"k":{x&&_.ctrlKey&&ge(_);break}case"ArrowUp":{ge(_);break}case"Home":{_.preventDefault(),fe(0);break}case"End":{_.preventDefault(),re();break}case"Enter":{_.preventDefault();let V=G();if(V){let le=new Event(Fp);V.dispatchEvent(le)}}}}}),H.createElement("label",{"cmdk-label":"",htmlFor:E.inputId,id:E.labelId,style:uW},l),Wu(e,_=>H.createElement(Q4.Provider,{value:S},H.createElement(K4.Provider,{value:E},_))))}),ZV=H.forwardRef((e,t)=>{var r,n;let i=ds(),a=H.useRef(null),s=H.useContext(Z4),o=Ol(),l=ek(e),c=(n=(r=l.current)==null?void 0:r.forceMount)!=null?n:s==null?void 0:s.forceMount;Ua(()=>{if(!c)return o.item(i,s==null?void 0:s.id)},[c]);let u=tk(i,a,[e.value,e.children,a],e.keywords),h=jx(),m=Ki(S=>S.value&&S.value===u.current),d=Ki(S=>c||o.filter()===!1?!0:S.search?S.filtered.items.get(i)>0:!0);H.useEffect(()=>{let S=a.current;if(!(!S||e.disabled))return S.addEventListener(Fp,g),()=>S.removeEventListener(Fp,g)},[d,e.onSelect,e.disabled]);function g(){var S,E;p(),(E=(S=l.current).onSelect)==null||E.call(S,u.current)}function p(){h.setState("value",u.current,!0)}if(!d)return null;let T=e,{disabled:x,value:v,onSelect:b,forceMount:y,keywords:w}=T,k=we(T,["disabled","value","onSelect","forceMount","keywords"]);return H.createElement(Zi.div,ce(q({ref:Bo(a,t)},k),{id:i,"cmdk-item":"",role:"option","aria-disabled":!!x,"aria-selected":!!m,"data-disabled":!!x,"data-selected":!!m,onPointerMove:x||o.getDisablePointerSelection()?void 0:p,onClick:x?void 0:g}),e.children)}),JV=H.forwardRef((e,t)=>{let d=e,{heading:r,children:n,forceMount:i}=d,a=we(d,["heading","children","forceMount"]),s=ds(),o=H.useRef(null),l=H.useRef(null),c=ds(),u=Ol(),h=Ki(g=>i||u.filter()===!1?!0:g.search?g.filtered.groups.has(s):!0);Ua(()=>u.group(s),[]),tk(s,o,[e.value,e.heading,l]);let m=H.useMemo(()=>({id:s,forceMount:i}),[i]);return H.createElement(Zi.div,ce(q({ref:Bo(o,t)},a),{"cmdk-group":"",role:"presentation",hidden:h?void 0:!0}),r&&H.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},r),Wu(e,g=>H.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?c:void 0},H.createElement(Z4.Provider,{value:m},g))))}),eW=H.forwardRef((e,t)=>{let s=e,{alwaysRender:r}=s,n=we(s,["alwaysRender"]),i=H.useRef(null),a=Ki(o=>!o.search);return!r&&!a?null:H.createElement(Zi.div,ce(q({ref:Bo(i,t)},n),{"cmdk-separator":"",role:"separator"}))}),tW=H.forwardRef((e,t)=>{let c=e,{onValueChange:r}=c,n=we(c,["onValueChange"]),i=e.value!=null,a=jx(),s=Ki(u=>u.search),o=Ki(u=>u.selectedItemId),l=Ol();return H.useEffect(()=>{e.value!=null&&a.setState("search",e.value)},[e.value]),H.createElement(Zi.input,ce(q({ref:t},n),{"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:i?e.value:s,onChange:u=>{i||a.setState("search",u.target.value),r==null||r(u.target.value)}}))}),rW=H.forwardRef((e,t)=>{let c=e,{children:r,label:n="Suggestions"}=c,i=we(c,["children","label"]),a=H.useRef(null),s=H.useRef(null),o=Ki(u=>u.selectedItemId),l=Ol();return H.useEffect(()=>{if(s.current&&a.current){let u=s.current,h=a.current,m,d=new ResizeObserver(()=>{m=requestAnimationFrame(()=>{let g=u.offsetHeight;h.style.setProperty("--cmdk-list-height",g.toFixed(1)+"px")})});return d.observe(u),()=>{cancelAnimationFrame(m),d.unobserve(u)}}},[]),H.createElement(Zi.div,ce(q({ref:Bo(a,t)},i),{"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":n,id:l.listId}),Wu(e,u=>H.createElement("div",{ref:Bo(s,l.listInnerRef),"cmdk-list-sizer":""},u)))}),nW=H.forwardRef((e,t)=>{let l=e,{open:r,onOpenChange:n,overlayClassName:i,contentClassName:a,container:s}=l,o=we(l,["open","onOpenChange","overlayClassName","contentClassName","container"]);return H.createElement(OT,{open:r,onOpenChange:n},H.createElement(FT,{container:s},H.createElement(sg,{"cmdk-overlay":"",className:i}),H.createElement(ag,{"aria-label":e.label,"cmdk-dialog":"",className:a},H.createElement(J4,q({ref:t},o)))))}),iW=H.forwardRef((e,t)=>Ki(r=>r.filtered.count===0)?H.createElement(Zi.div,ce(q({ref:t},e),{"cmdk-empty":"",role:"presentation"})):null),aW=H.forwardRef((e,t)=>{let s=e,{progress:r,children:n,label:i="Loading..."}=s,a=we(s,["progress","children","label"]);return H.createElement(Zi.div,ce(q({ref:t},a),{"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i}),Wu(e,o=>H.createElement("div",{"aria-hidden":!0},o)))}),Fr=Object.assign(J4,{List:rW,Item:ZV,Input:tW,Group:JV,Separator:eW,Dialog:nW,Empty:iW,Loading:aW});function sW(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function oW(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function ek(e){let t=H.useRef(e);return Ua(()=>{t.current=e}),t}var Ua=typeof window=="undefined"?H.useEffect:H.useLayoutEffect;function cs(e){let t=H.useRef();return t.current===void 0&&(t.current=e()),t}function Ki(e){let t=jx(),r=()=>e(t.snapshot());return H.useSyncExternalStore(t.subscribe,r,r)}function tk(e,t,r,n=[]){let i=H.useRef(),a=Ol();return Ua(()=>{var s;let o=(()=>{var c;for(let u of r){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():i.current}})(),l=n.map(c=>c.trim());a.value(e,o,l),(s=t.current)==null||s.setAttribute(ls,o),i.current=o}),i}var lW=()=>{let[e,t]=H.useState(),r=cs(()=>new Map);return Ua(()=>{r.current.forEach(n=>n()),r.current=new Map},[e]),(n,i)=>{r.current.set(n,i),t({})}};function cW(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function Wu({asChild:e,children:t},r){return e&&H.isValidElement(t)?H.cloneElement(cW(t),{ref:t.ref},r(t.props.children)):r(t)}var uW={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const fW=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(Fr,q({ref:r,className:Ee("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e)},t))});fW.displayName=Fr.displayName;const hW=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[f.jsx(FR,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),f.jsx(Fr.Input,q({ref:r,className:Ee("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e)},t))]})});hW.displayName=Fr.Input.displayName;const dW=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(Fr.List,q({ref:r,className:Ee("max-h-[300px] overflow-y-auto overflow-x-hidden",e)},t))});dW.displayName=Fr.List.displayName;const mW=H.forwardRef((e,t)=>f.jsx(Fr.Empty,q({ref:t,className:"py-6 text-center text-sm"},e)));mW.displayName=Fr.Empty.displayName;const pW=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(Fr.Group,q({ref:r,className:Ee("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e)},t))});pW.displayName=Fr.Group.displayName;const gW=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(Fr.Separator,q({ref:r,className:Ee("-mx-1 h-px bg-border",e)},t))});gW.displayName=Fr.Separator.displayName;const xW=H.forwardRef((n,r)=>{var i=n,{className:e}=i,t=we(i,["className"]);return f.jsx(Fr.Item,q({ref:r,className:Ee("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e)},t))});xW.displayName=Fr.Item.displayName;class kJ extends hs.Component{constructor(r){super(r);Ge(this,"handleRetry",()=>{window.location.reload()});Ge(this,"handleClearData",()=>{try{localStorage.clear(),console.log("LocalStorage cleared successfully")}catch(r){console.error("Failed to clear localStorage:",r)}window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){console.error("LocalStorage Error Boundary caught an error:",r),console.error("Component Stack:",n.componentStack),this.setState({errorInfo:n})}render(){const{hasError:r}=this.state,{children:n,fallback:i}=this.props;return r?i||f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:f.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsx("div",{className:"rounded-full bg-red-100 p-3",children:f.jsx("svg",{className:"h-8 w-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:"Something Went Wrong"}),f.jsx("p",{className:"text-gray-600 text-center mb-6",children:"We encountered an issue saving your preferences. This might happen if your browser's storage is full or if you're using private browsing mode."}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("button",{onClick:this.handleRetry,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors",children:"Retry"}),f.jsx("button",{onClick:this.handleClearData,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-4 rounded-md transition-colors",children:"Clear Saved Data & Retry"})]}),!1]})}):n}}const sS={WARNING:80,CRITICAL:95};function RJ(e={}){const{onWarning:t,checkInterval:r=3e4,checkOnMount:n=!0}=e,i=H.useRef(new Set),a=()=>lt(null,null,function*(){try{const s=yield bt.getQuotaInfo();if(!s||s.percentage===0)return;const{percentage:o,usage:l,quota:c}=s,u=h=>{const m=h/1048576;return m<1?`${(h/1024).toFixed(1)} KB`:`${m.toFixed(1)} MB`};if(o>=sS.CRITICAL){const h=`critical-${Math.floor(o)}`;i.current.has(h)||(console.warn(`[Storage Quota Monitor] CRITICAL: Storage at ${o.toFixed(1)}% capacity`),t==null||t(`Your browser storage is nearly full (${o.toFixed(1)}% used). Using ${u(l)} of ${u(c)} available. Please clear old data or browser cache to continue using this feature.`,o,"critical"),i.current.add(h))}else if(o>=sS.WARNING){const h=`warning-${Math.floor(o/5)*5}`;i.current.has(h)||(console.warn(`[Storage Quota Monitor] WARNING: Storage at ${o.toFixed(1)}% capacity`),t==null||t(`Your browser storage is ${o.toFixed(1)}% full. Using ${u(l)} of ${u(c)} available. Consider clearing old data to ensure smooth operation.`,o,"warning"),i.current.add(h))}}catch(s){console.error("[Storage Quota Monitor] Failed to check quota:",s)}});return H.useEffect(()=>{n&&a();const s=setInterval(a,r);return()=>{clearInterval(s)}},[r,n,t]),{checkQuota:a}}const OJ=IR,FJ=jR,IJ=DR,vW=H.forwardRef((i,n)=>{var a=i,{className:e,sideOffset:t=4}=a,r=we(a,["className","sideOffset"]);return f.jsx(tE,q({ref:n,sideOffset:t,className:Ee("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e)},r))});vW.displayName=tE.displayName;function jJ({children:e,className:t="",title:r}){return f.jsxs("div",{className:`w-full max-w-full bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden mx-2 sm:mx-0 ${t}`,children:[r&&f.jsx("div",{className:"px-4 sm:px-6 py-4 bg-gradient-to-r from-amber-100 to-orange-100 border-b border-gray-200",children:f.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-amber-900 leading-tight",children:r})}),f.jsx("div",{className:"p-4 sm:p-6 space-y-4",children:e})]})}function DJ({categoryLabel:e,criteria:t}){return f.jsxs(lu,{children:[f.jsx(cu,{asChild:!0,children:f.jsxs(Le,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 ml-2 hover:bg-blue-100 rounded-full",type:"button",children:[f.jsx(rE,{className:"h-4 w-4 text-blue-600"}),f.jsxs("span",{className:"sr-only",children:["View criteria for ",e]})]})}),f.jsx(cl,{className:"w-96 max-h-96 overflow-y-auto",align:"start",children:f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"font-semibold text-sm border-b pb-2",children:[e," - Rating Criteria"]}),f.jsx("div",{className:"space-y-3",children:[5,4,3,2,1].map(r=>f.jsx(Fe,{className:"border-l-4",style:{borderLeftColor:r>=4?"#10B981":r>=3?"#F59E0B":"#EF4444"},children:f.jsxs(je,{className:"p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("div",{className:"flex",children:Array.from({length:5},(n,i)=>f.jsx(zi,{className:`w-3 h-3 ${i<r?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},i))}),f.jsxs(ht,{variant:"secondary",className:"text-xs",children:["Rating ",r]})]}),f.jsx("p",{className:"text-xs text-gray-700 leading-relaxed",children:t[r]})]})},r))})]})})]})}function PJ({categoryLabel:e,criteria:t}){return f.jsxs(lu,{children:[f.jsx(cu,{asChild:!0,children:f.jsxs(Le,{variant:"outline",size:"sm",className:"w-full mt-2 text-xs",type:"button",children:[f.jsx(rE,{className:"h-3 w-3 mr-2"}),"View Rating Guide"]})}),f.jsx(cl,{className:"w-80 max-h-80 overflow-y-auto",align:"center",children:f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"font-semibold text-sm border-b pb-2",children:[e," - Rating Criteria"]}),f.jsx("div",{className:"space-y-3",children:[5,4,3,2,1].map(r=>f.jsx(Fe,{className:"border-l-4",style:{borderLeftColor:r>=4?"#10B981":r>=3?"#F59E0B":"#EF4444"},children:f.jsxs(je,{className:"p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("div",{className:"flex",children:Array.from({length:5},(n,i)=>f.jsx(zi,{className:`w-3 h-3 ${i<r?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},i))}),f.jsxs(ht,{variant:"secondary",className:"text-xs",children:["Rating ",r]})]}),f.jsx("p",{className:"text-xs text-gray-700 leading-relaxed",children:t[r]})]})},r))})]})})]})}function yW({onBack:e}){const t=r=>f.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(n=>f.jsx(zi,{className:`w-5 h-5 ${n<=r?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},n))});return f.jsxs("div",{className:"container mx-auto p-6 max-w-6xl space-y-6",children:[f.jsxs("div",{className:"mb-6",children:[e&&f.jsx("div",{className:"flex justify-start mb-4",children:f.jsx(Le,{variant:"outline",onClick:e,className:"flex-shrink-0",children:"â† Back"})}),f.jsxs("div",{className:"text-center space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-center gap-3",children:[f.jsx(u1,{className:"w-8 h-8 text-primary"}),f.jsx("h1",{className:"text-3xl font-bold text-primary",children:"Rating Criteria Reference"})]}),f.jsx("p",{className:"text-lg text-muted-foreground max-w-3xl mx-auto",children:"Complete reference guide for custodial inspection ratings. Use this to understand what each star rating means and the specific criteria for each category."})]})]}),f.jsxs(Fe,{className:"border-2 border-primary/20",children:[f.jsxs(ze,{className:"bg-primary/5",children:[f.jsxs(He,{className:"flex items-center gap-2",children:[f.jsx(zi,{className:"w-6 h-6 text-primary"}),"General Rating Scale"]}),f.jsx(nt,{children:"This 5-star scale applies to all inspection categories"})]}),f.jsx(je,{className:"p-6",children:f.jsx("div",{className:"grid gap-4",children:$1.map((r,n)=>f.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-lg border border-gray-200 bg-gray-50",children:[f.jsx("div",{className:"flex-shrink-0",children:t(n+1)}),f.jsxs("div",{className:"flex-1",children:[f.jsx("div",{className:"font-semibold text-lg text-gray-900 mb-1",children:r.label}),f.jsx("div",{className:"text-gray-700",children:r.description})]})]},n))})})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("h2",{className:"text-2xl font-bold text-primary mb-2",children:"Category-Specific Criteria"}),f.jsx("p",{className:"text-muted-foreground",children:"Detailed criteria for each inspection category showing what qualifies for each star rating"})]}),f.jsx("div",{className:"grid gap-6",children:qI.map(r=>f.jsxs(Fe,{className:"border border-gray-200",children:[f.jsxs(ze,{className:"bg-accent/10",children:[f.jsx(He,{className:"text-xl text-primary",children:r.label}),f.jsxs(nt,{children:["Specific criteria for rating ",r.label.toLowerCase()," cleanliness and maintenance"]})]}),f.jsx(je,{className:"p-6",children:r.criteria?f.jsx("div",{className:"space-y-4",children:Object.entries(r.criteria).map(([n,i])=>{var a;return f.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t(parseInt(n)),f.jsxs(ht,{variant:"outline",className:"text-sm",children:[parseInt(n)," Star",parseInt(n)>1?"s":""]}),f.jsx("span",{className:"font-medium text-primary",children:(a=$1[parseInt(n)-1])==null?void 0:a.label})]}),f.jsx("div",{className:"text-gray-700 leading-relaxed",children:i})]},n)})}):f.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[f.jsx(u1,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),f.jsx("p",{children:"Detailed criteria for this category will be available soon."}),f.jsx("p",{className:"text-sm mt-1",children:"Use the general rating scale above for guidance."})]})})]},r.key))})]}),f.jsxs(Fe,{className:"border-2 border-blue-200 bg-blue-50",children:[f.jsx(ze,{children:f.jsx(He,{className:"text-blue-900",children:"How to Use This Reference"})}),f.jsxs(je,{className:"space-y-3 text-blue-800",children:[f.jsxs("div",{children:[f.jsx("strong",{children:"During Inspections:"})," Reference this page to ensure consistent and accurate ratings across all categories."]}),f.jsxs("div",{children:[f.jsx("strong",{children:"For Training:"})," Use this as a training guide for new inspectors to understand rating standards."]}),f.jsxs("div",{children:[f.jsx("strong",{children:"For Consistency:"})," When multiple inspectors are involved, this ensures everyone applies the same standards."]}),f.jsxs("div",{children:[f.jsx("strong",{children:"For Documentation:"})," Print or bookmark this page for offline reference during field inspections."]})]})]})]})}const wW=Object.freeze(Object.defineProperty({__proto__:null,default:yW},Symbol.toStringTag,{value:"Module"})),bW=({size:e="md",className:t,text:r="Loading..."})=>{const n={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};return f.jsxs("div",{className:Ee("flex flex-col items-center justify-center p-8",t),children:[f.jsx(Ac,{className:Ee("animate-spin text-primary",n[e])}),r&&f.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:r})]})},MJ=bW,_W=[{value:"ASA",label:"ASA"},{value:"LCA",label:"LCA"},{value:"GWC",label:"GWC"},{value:"OA",label:"OA"},{value:"CBR",label:"CBR"},{value:"WLC",label:"WLC"}],SW=["January","February","March","April","May","June","July","August","September","October","November","December"];function LJ({onUploadSuccess:e}){const{toast:t}=mu(),[r,n]=H.useState({school:"",month:"",year:new Date().getFullYear().toString(),notes:"",uploadedBy:""}),[i,a]=H.useState(null),[s,o]=H.useState(!1),[l,c]=H.useState({}),u=d=>{var p;const g=(p=d.target.files)==null?void 0:p[0];if(g){if(c(x=>ce(q({},x),{pdfFile:""})),g.type!=="application/pdf"){const x="Only PDF files are allowed. Please select a valid PDF file.";c(v=>ce(q({},v),{pdfFile:x})),t({variant:"destructive",title:"Invalid File Type",description:x}),d.target.value="",a(null);return}if(g.size>10*1024*1024){const x="PDF file must be less than 10MB. Please choose a smaller file.";c(v=>ce(q({},v),{pdfFile:x})),t({variant:"destructive",title:"File Too Large",description:x}),d.target.value="",a(null);return}a(g),t({title:"âœ… PDF Selected",description:`${g.name} (${(g.size/1024/1024).toFixed(2)} MB) - Ready to upload`})}},h=()=>{const d={};if(r.school||(d.school="School is required"),r.month||(d.month="Month is required"),!r.year)d.year="Year is required";else{const g=parseInt(r.year);(isNaN(g)||g<2020||g>2100)&&(d.year="Please enter a valid year between 2020 and 2100")}return i||(d.pdfFile="PDF file is required"),c(d),Object.keys(d).length===0},m=d=>lt(null,null,function*(){if(d.preventDefault(),!!h()){o(!0);try{const g=new FormData;g.append("school",r.school),g.append("month",r.month),g.append("year",r.year),i&&g.append("pdf",i),r.notes&&g.append("notes",r.notes),r.uploadedBy&&g.append("uploadedBy",r.uploadedBy);const p=yield fetch("/api/monthly-feedback",{method:"POST",body:g});if(p.ok){const x=yield p.json();t({title:"âœ… Upload Successful!",description:`Monthly feedback for ${r.month} ${r.year} has been uploaded.${x.hasExtractedText?" Text extracted successfully.":" (Text extraction unavailable)"}`,duration:5e3}),n({school:"",month:"",year:new Date().getFullYear().toString(),notes:"",uploadedBy:""}),a(null),c({});const v=document.getElementById("pdfFile");v&&(v.value=""),e()}else{const x=yield p.json().catch(()=>({message:"Unknown error"}));t({variant:"destructive",title:"Upload Failed",description:x.message||"Failed to upload monthly feedback."})}}catch(g){console.error("Error uploading feedback:",g),t({variant:"destructive",title:"Network Error",description:"Unable to connect to the server. Please check your connection."})}finally{o(!1)}}});return f.jsx("form",{onSubmit:m,children:f.jsxs(Fe,{children:[f.jsxs(ze,{children:[f.jsx(He,{children:"Upload Monthly Feedback"}),f.jsx(nt,{children:"Upload a monthly custodial feedback email PDF"})]}),f.jsxs(je,{className:"space-y-4",children:[f.jsx("div",{"aria-live":"polite",className:"sr-only"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsxs(Ye,{htmlFor:"school",children:["School ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs(Eo,{value:r.school,onValueChange:d=>n(g=>ce(q({},g),{school:d})),children:[f.jsx(gs,{className:l.school?"border-red-500":"",children:f.jsx(No,{placeholder:"Select school"})}),f.jsx(xs,{children:_W.map(d=>f.jsx(Sn,{value:d.value,children:d.label},d.value))})]}),l.school&&f.jsx("p",{className:"text-sm text-red-500",children:l.school})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(Ye,{htmlFor:"month",children:["Month ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs(Eo,{value:r.month,onValueChange:d=>n(g=>ce(q({},g),{month:d})),children:[f.jsx(gs,{className:l.month?"border-red-500":"",children:f.jsx(No,{placeholder:"Select month"})}),f.jsx(xs,{children:SW.map(d=>f.jsx(Sn,{value:d,children:d},d))})]}),l.month&&f.jsx("p",{className:"text-sm text-red-500",children:l.month})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(Ye,{htmlFor:"year",children:["Year ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs(Eo,{value:r.year,onValueChange:d=>n(g=>ce(q({},g),{year:d})),children:[f.jsx(gs,{className:l.year?"border-red-500":"",children:f.jsx(No,{placeholder:"Select year"})}),f.jsx(xs,{children:Array.from({length:10},(d,g)=>new Date().getFullYear()-5+g).map(d=>f.jsx(Sn,{value:d.toString(),children:d},d))})]}),l.year&&f.jsx("p",{className:"text-sm text-red-500",children:l.year})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(Ye,{htmlFor:"pdfFile",children:["PDF File ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx(ms,{id:"pdfFile",type:"file",accept:".pdf,application/pdf",onChange:u,className:l.pdfFile?"border-red-500":"",required:!0}),l.pdfFile&&f.jsx("p",{className:"text-sm text-red-500",children:l.pdfFile}),i&&f.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[f.jsx(En,{className:"w-4 h-4 text-green-500"}),i.name," (",(i.size/1024/1024).toFixed(2)," MB)"]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ye,{htmlFor:"uploadedBy",children:"Uploaded By (Optional)"}),f.jsx(ms,{id:"uploadedBy",value:r.uploadedBy,onChange:d=>n(g=>ce(q({},g),{uploadedBy:d.target.value})),placeholder:"Your name",maxLength:255})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ye,{htmlFor:"notes",children:"Notes (Optional)"}),f.jsx(mg,{id:"notes",value:r.notes,onChange:d=>n(g=>ce(q({},g),{notes:d.target.value})),placeholder:"Additional notes or context about this feedback...",rows:4,maxLength:5e3})]}),f.jsx(Le,{type:"submit",disabled:s,className:"w-full",children:s?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"animate-spin mr-2",children:"â³"}),"Uploading..."]}):f.jsxs(f.Fragment,{children:[f.jsx(wT,{className:"w-4 h-4 mr-2"}),"Upload Feedback"]})})]})]})})}function BJ({feedback:e,onView:t,onDownload:r}){const n=()=>{if(!e.extractedText)return"No text content available";const a=e.extractedText.trim();return a.length===0?"No text content available":a.length>200?a.substring(0,200)+"...":a},i=a=>a;return f.jsxs(Fe,{children:[f.jsxs(ze,{className:"pb-3",children:[f.jsxs(He,{className:"flex items-center justify-between leading-7",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wi,{className:"w-5 h-5"}),f.jsxs("span",{children:[e.month," ",e.year]})]}),f.jsx(ht,{title:i(e.school),children:e.school})]}),f.jsxs(nt,{className:"flex items-center gap-2 mt-2",children:[f.jsx(cr,{className:"w-4 h-4"}),new Date(e.createdAt).toLocaleDateString()]})]}),f.jsx(je,{className:"pt-0",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.uploadedBy&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(Mi,{className:"w-3 h-3"}),f.jsx("span",{children:e.uploadedBy})]}),e.fileSize&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(PR,{className:"w-3 h-3"}),f.jsxs("span",{children:[(e.fileSize/1024/1024).toFixed(2)," MB"]})]})]}),f.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:n()}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs(Le,{onClick:()=>t(e),size:"sm",variant:"default",children:[f.jsx($T,{className:"w-4 h-4 mr-2"}),"View Details"]}),f.jsxs(Le,{onClick:()=>r(e),size:"sm",variant:"outline","aria-label":`Download PDF for ${e.month} ${e.year} ${e.school}`,children:[f.jsx(Oa,{className:"w-4 h-4 mr-2"}),"Download PDF"]})]})]})})]})}function TW(e,t){const r={};return(e[e.length-1]===""?[...e,""]:e).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const EW=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,NW=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,AW={};function oS(e,t){return(AW.jsx?NW:EW).test(e)}const CW=/[ \t\n\f\r]/g;function kW(e){return typeof e=="object"?e.type==="text"?lS(e.value):!1:lS(e)}function lS(e){return e.replace(CW,"")===""}class Fl{constructor(t,r,n){this.normal=r,this.property=t,n&&(this.space=n)}}Fl.prototype.normal={};Fl.prototype.property={};Fl.prototype.space=void 0;function rk(e,t){const r={},n={};for(const i of e)Object.assign(r,i.property),Object.assign(n,i.normal);return new Fl(r,n,t)}function Ip(e){return e.toLowerCase()}class Ir{constructor(t,r){this.attribute=r,this.property=t}}Ir.prototype.attribute="";Ir.prototype.booleanish=!1;Ir.prototype.boolean=!1;Ir.prototype.commaOrSpaceSeparated=!1;Ir.prototype.commaSeparated=!1;Ir.prototype.defined=!1;Ir.prototype.mustUseProperty=!1;Ir.prototype.number=!1;Ir.prototype.overloadedBoolean=!1;Ir.prototype.property="";Ir.prototype.spaceSeparated=!1;Ir.prototype.space=void 0;let RW=0;const qe=Za(),Dt=Za(),jp=Za(),pe=Za(),mt=Za(),Ss=Za(),Pr=Za();function Za(){return Ul(2,++RW)}const Dp=Object.freeze(Object.defineProperty({__proto__:null,boolean:qe,booleanish:Dt,commaOrSpaceSeparated:Pr,commaSeparated:Ss,number:pe,overloadedBoolean:jp,spaceSeparated:mt},Symbol.toStringTag,{value:"Module"})),Im=Object.keys(Dp);class Dx extends Ir{constructor(t,r,n,i){let a=-1;if(super(t,r),cS(this,"space",i),typeof n=="number")for(;++a<Im.length;){const s=Im[a];cS(this,Im[a],(n&Dp[s])===Dp[s])}}}Dx.prototype.defined=!0;function cS(e,t,r){r&&(e[t]=r)}function Qs(e){const t={},r={};for(const[n,i]of Object.entries(e.properties)){const a=new Dx(n,e.transform(e.attributes||{},n),i,e.space);e.mustUseProperty&&e.mustUseProperty.includes(n)&&(a.mustUseProperty=!0),t[n]=a,r[Ip(n)]=n,r[Ip(a.attribute)]=n}return new Fl(t,r,e.space)}const nk=Qs({properties:{ariaActiveDescendant:null,ariaAtomic:Dt,ariaAutoComplete:null,ariaBusy:Dt,ariaChecked:Dt,ariaColCount:pe,ariaColIndex:pe,ariaColSpan:pe,ariaControls:mt,ariaCurrent:null,ariaDescribedBy:mt,ariaDetails:null,ariaDisabled:Dt,ariaDropEffect:mt,ariaErrorMessage:null,ariaExpanded:Dt,ariaFlowTo:mt,ariaGrabbed:Dt,ariaHasPopup:null,ariaHidden:Dt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:mt,ariaLevel:pe,ariaLive:null,ariaModal:Dt,ariaMultiLine:Dt,ariaMultiSelectable:Dt,ariaOrientation:null,ariaOwns:mt,ariaPlaceholder:null,ariaPosInSet:pe,ariaPressed:Dt,ariaReadOnly:Dt,ariaRelevant:null,ariaRequired:Dt,ariaRoleDescription:mt,ariaRowCount:pe,ariaRowIndex:pe,ariaRowSpan:pe,ariaSelected:Dt,ariaSetSize:pe,ariaSort:null,ariaValueMax:pe,ariaValueMin:pe,ariaValueNow:pe,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function ik(e,t){return t in e?e[t]:t}function ak(e,t){return ik(e,t.toLowerCase())}const OW=Qs({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Ss,acceptCharset:mt,accessKey:mt,action:null,allow:null,allowFullScreen:qe,allowPaymentRequest:qe,allowUserMedia:qe,alt:null,as:null,async:qe,autoCapitalize:null,autoComplete:mt,autoFocus:qe,autoPlay:qe,blocking:mt,capture:null,charSet:null,checked:qe,cite:null,className:mt,cols:pe,colSpan:null,content:null,contentEditable:Dt,controls:qe,controlsList:mt,coords:pe|Ss,crossOrigin:null,data:null,dateTime:null,decoding:null,default:qe,defer:qe,dir:null,dirName:null,disabled:qe,download:jp,draggable:Dt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:qe,formTarget:null,headers:mt,height:pe,hidden:jp,high:pe,href:null,hrefLang:null,htmlFor:mt,httpEquiv:mt,id:null,imageSizes:null,imageSrcSet:null,inert:qe,inputMode:null,integrity:null,is:null,isMap:qe,itemId:null,itemProp:mt,itemRef:mt,itemScope:qe,itemType:mt,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:qe,low:pe,manifest:null,max:null,maxLength:pe,media:null,method:null,min:null,minLength:pe,multiple:qe,muted:qe,name:null,nonce:null,noModule:qe,noValidate:qe,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:qe,optimum:pe,pattern:null,ping:mt,placeholder:null,playsInline:qe,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:qe,referrerPolicy:null,rel:mt,required:qe,reversed:qe,rows:pe,rowSpan:pe,sandbox:mt,scope:null,scoped:qe,seamless:qe,selected:qe,shadowRootClonable:qe,shadowRootDelegatesFocus:qe,shadowRootMode:null,shape:null,size:pe,sizes:null,slot:null,span:pe,spellCheck:Dt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:pe,step:null,style:null,tabIndex:pe,target:null,title:null,translate:null,type:null,typeMustMatch:qe,useMap:null,value:Dt,width:pe,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:mt,axis:null,background:null,bgColor:null,border:pe,borderColor:null,bottomMargin:pe,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:qe,declare:qe,event:null,face:null,frame:null,frameBorder:null,hSpace:pe,leftMargin:pe,link:null,longDesc:null,lowSrc:null,marginHeight:pe,marginWidth:pe,noResize:qe,noHref:qe,noShade:qe,noWrap:qe,object:null,profile:null,prompt:null,rev:null,rightMargin:pe,rules:null,scheme:null,scrolling:Dt,standby:null,summary:null,text:null,topMargin:pe,valueType:null,version:null,vAlign:null,vLink:null,vSpace:pe,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:qe,disableRemotePlayback:qe,prefix:null,property:null,results:pe,security:null,unselectable:null},space:"html",transform:ak}),FW=Qs({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Pr,accentHeight:pe,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:pe,amplitude:pe,arabicForm:null,ascent:pe,attributeName:null,attributeType:null,azimuth:pe,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:pe,by:null,calcMode:null,capHeight:pe,className:mt,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:pe,diffuseConstant:pe,direction:null,display:null,dur:null,divisor:pe,dominantBaseline:null,download:qe,dx:null,dy:null,edgeMode:null,editable:null,elevation:pe,enableBackground:null,end:null,event:null,exponent:pe,externalResourcesRequired:null,fill:null,fillOpacity:pe,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Ss,g2:Ss,glyphName:Ss,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:pe,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:pe,horizOriginX:pe,horizOriginY:pe,id:null,ideographic:pe,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:pe,k:pe,k1:pe,k2:pe,k3:pe,k4:pe,kernelMatrix:Pr,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:pe,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:pe,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:pe,overlineThickness:pe,paintOrder:null,panose1:null,path:null,pathLength:pe,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:mt,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:pe,pointsAtY:pe,pointsAtZ:pe,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Pr,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Pr,rev:Pr,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Pr,requiredFeatures:Pr,requiredFonts:Pr,requiredFormats:Pr,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:pe,specularExponent:pe,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:pe,strikethroughThickness:pe,string:null,stroke:null,strokeDashArray:Pr,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:pe,strokeOpacity:pe,strokeWidth:null,style:null,surfaceScale:pe,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Pr,tabIndex:pe,tableValues:null,target:null,targetX:pe,targetY:pe,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Pr,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:pe,underlineThickness:pe,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:pe,values:null,vAlphabetic:pe,vMathematical:pe,vectorEffect:null,vHanging:pe,vIdeographic:pe,version:null,vertAdvY:pe,vertOriginX:pe,vertOriginY:pe,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:pe,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:ik}),sk=Qs({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),ok=Qs({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:ak}),lk=Qs({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),IW=/[A-Z]/g,uS=/-[a-z]/g,jW=/^data[-\w.:]+$/i;function DW(e,t){const r=Ip(t);let n=t,i=Ir;if(r in e.normal)return e.property[e.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&jW.test(t)){if(t.charAt(4)==="-"){const a=t.slice(5).replace(uS,MW);n="data"+a.charAt(0).toUpperCase()+a.slice(1)}else{const a=t.slice(4);if(!uS.test(a)){let s=a.replace(IW,PW);s.charAt(0)!=="-"&&(s="-"+s),t="data"+s}}i=Dx}return new i(n,t)}function PW(e){return"-"+e.toLowerCase()}function MW(e){return e.charAt(1).toUpperCase()}const LW=rk([nk,OW,sk,ok,lk],"html"),Px=rk([nk,FW,sk,ok,lk],"svg");function BW(e){return e.join(" ").trim()}var as={},jm,fS;function UW(){if(fS)return jm;fS=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,t=/\n/g,r=/^\s*/,n=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,i=/^:\s*/,a=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,s=/^[;\s]*/,o=/^\s+|\s+$/g,l=`
`,c="/",u="*",h="",m="comment",d="declaration";jm=function(p,x){if(typeof p!="string")throw new TypeError("First argument must be a string");if(!p)return[];x=x||{};var v=1,b=1;function y(z){var G=z.match(t);G&&(v+=G.length);var W=z.lastIndexOf(l);b=~W?z.length-W:b+z.length}function w(){var z={line:v,column:b};return function(G){return G.position=new k(z),E(),G}}function k(z){this.start=z,this.end={line:v,column:b},this.source=x.source}k.prototype.content=p;function T(z){var G=new Error(x.source+":"+v+":"+b+": "+z);if(G.reason=z,G.filename=x.source,G.line=v,G.column=b,G.source=p,!x.silent)throw G}function S(z){var G=z.exec(p);if(G){var W=G[0];return y(W),p=p.slice(W.length),G}}function E(){S(r)}function A(z){var G;for(z=z||[];G=R();)G!==!1&&z.push(G);return z}function R(){var z=w();if(!(c!=p.charAt(0)||u!=p.charAt(1))){for(var G=2;h!=p.charAt(G)&&(u!=p.charAt(G)||c!=p.charAt(G+1));)++G;if(G+=2,h===p.charAt(G-1))return T("End of comment missing");var W=p.slice(2,G-2);return b+=2,y(W),p=p.slice(G),b+=2,z({type:m,comment:W})}}function C(){var z=w(),G=S(n);if(G){if(R(),!S(i))return T("property missing ':'");var W=S(a),fe=z({type:d,property:g(G[0].replace(e,h)),value:W?g(W[0].replace(e,h)):h});return S(s),fe}}function j(){var z=[];A(z);for(var G;G=C();)G!==!1&&(z.push(G),A(z));return z}return E(),j()};function g(p){return p?p.replace(o,h):h}return jm}var hS;function qW(){if(hS)return as;hS=1;var e=as&&as.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(as,"__esModule",{value:!0}),as.default=r;const t=e(UW());function r(n,i){let a=null;if(!n||typeof n!="string")return a;const s=(0,t.default)(n),o=typeof i=="function";return s.forEach(l=>{if(l.type!=="declaration")return;const{property:c,value:u}=l;o?i(c,u,l):u&&(a=a||{},a[c]=u)}),a}return as}var po={},dS;function zW(){if(dS)return po;dS=1,Object.defineProperty(po,"__esModule",{value:!0}),po.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,t=/-([a-z])/g,r=/^[^-]+$/,n=/^-(webkit|moz|ms|o|khtml)-/,i=/^-(ms)-/,a=function(c){return!c||r.test(c)||e.test(c)},s=function(c,u){return u.toUpperCase()},o=function(c,u){return"".concat(u,"-")},l=function(c,u){return u===void 0&&(u={}),a(c)?c:(c=c.toLowerCase(),u.reactCompat?c=c.replace(i,o):c=c.replace(n,o),c.replace(t,s))};return po.camelCase=l,po}var go,mS;function HW(){if(mS)return go;mS=1;var e=go&&go.__importDefault||function(i){return i&&i.__esModule?i:{default:i}},t=e(qW()),r=zW();function n(i,a){var s={};return!i||typeof i!="string"||(0,t.default)(i,function(o,l){o&&l&&(s[(0,r.camelCase)(o,a)]=l)}),s}return n.default=n,go=n,go}var $W=HW();const VW=Xe($W),ck=uk("end"),Mx=uk("start");function uk(e){return t;function t(r){const n=r&&r.position&&r.position[e]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function WW(e){const t=Mx(e),r=ck(e);if(t&&r)return{start:t,end:r}}function Po(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?pS(e.position):"start"in e||"end"in e?pS(e):"line"in e||"column"in e?Pp(e):""}function Pp(e){return gS(e&&e.line)+":"+gS(e&&e.column)}function pS(e){return Pp(e&&e.start)+"-"+Pp(e&&e.end)}function gS(e){return e&&typeof e=="number"?e:1}class dr extends Error{constructor(t,r,n){super(),typeof r=="string"&&(n=r,r=void 0);let i="",a={},s=!1;if(r&&("line"in r&&"column"in r?a={place:r}:"start"in r&&"end"in r?a={place:r}:"type"in r?a={ancestors:[r],place:r.position}:a=q({},r)),typeof t=="string"?i=t:!a.cause&&t&&(s=!0,i=t.message,a.cause=t),!a.ruleId&&!a.source&&typeof n=="string"){const l=n.indexOf(":");l===-1?a.ruleId=n:(a.source=n.slice(0,l),a.ruleId=n.slice(l+1))}if(!a.place&&a.ancestors&&a.ancestors){const l=a.ancestors[a.ancestors.length-1];l&&(a.place=l.position)}const o=a.place&&"start"in a.place?a.place.start:a.place;this.ancestors=a.ancestors||void 0,this.cause=a.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file="",this.message=i,this.line=o?o.line:void 0,this.name=Po(a.place)||"1:1",this.place=a.place||void 0,this.reason=this.message,this.ruleId=a.ruleId||void 0,this.source=a.source||void 0,this.stack=s&&a.cause&&typeof a.cause.stack=="string"?a.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}dr.prototype.file="";dr.prototype.name="";dr.prototype.reason="";dr.prototype.message="";dr.prototype.stack="";dr.prototype.column=void 0;dr.prototype.line=void 0;dr.prototype.ancestors=void 0;dr.prototype.cause=void 0;dr.prototype.fatal=void 0;dr.prototype.place=void 0;dr.prototype.ruleId=void 0;dr.prototype.source=void 0;const Lx={}.hasOwnProperty,GW=new Map,YW=/[A-Z]/g,XW=new Set(["table","tbody","thead","tfoot","tr"]),KW=new Set(["td","th"]),fk="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function UJ(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=t.filePath||void 0;let n;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=iG(r,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=nG(r,t.jsx,t.jsxs)}const i={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:n,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?Px:LW,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},a=hk(i,e,void 0);return a&&typeof a!="string"?a:i.create(e,i.Fragment,{children:a||void 0},void 0)}function hk(e,t,r){if(t.type==="element")return QW(e,t,r);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return ZW(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return eG(e,t,r);if(t.type==="mdxjsEsm")return JW(e,t);if(t.type==="root")return tG(e,t,r);if(t.type==="text")return rG(e,t)}function QW(e,t,r){const n=e.schema;let i=n;t.tagName.toLowerCase()==="svg"&&n.space==="html"&&(i=Px,e.schema=i),e.ancestors.push(t);const a=mk(e,t.tagName,!1),s=aG(e,t);let o=Ux(e,t);return XW.has(t.tagName)&&(o=o.filter(function(l){return typeof l=="string"?!kW(l):!0})),dk(e,s,a,t),Bx(s,o),e.ancestors.pop(),e.schema=n,e.create(t,a,s,r)}function ZW(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return e.evaluater.evaluateExpression(n.expression)}ul(e,t.position)}function JW(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);ul(e,t.position)}function eG(e,t,r){const n=e.schema;let i=n;t.name==="svg"&&n.space==="html"&&(i=Px,e.schema=i),e.ancestors.push(t);const a=t.name===null?e.Fragment:mk(e,t.name,!0),s=sG(e,t),o=Ux(e,t);return dk(e,s,a,t),Bx(s,o),e.ancestors.pop(),e.schema=n,e.create(t,a,s,r)}function tG(e,t,r){const n={};return Bx(n,Ux(e,t)),e.create(t,e.Fragment,n,r)}function rG(e,t){return t.value}function dk(e,t,r,n){typeof r!="string"&&r!==e.Fragment&&e.passNode&&(t.node=n)}function Bx(e,t){if(t.length>0){const r=t.length>1?t:t[0];r&&(e.children=r)}}function nG(e,t,r){return n;function n(i,a,s,o){const c=Array.isArray(s.children)?r:t;return o?c(a,s,o):c(a,s)}}function iG(e,t){return r;function r(n,i,a,s){const o=Array.isArray(a.children),l=Mx(n);return t(i,a,s,o,{columnNumber:l?l.column-1:void 0,fileName:e,lineNumber:l?l.line:void 0},void 0)}}function aG(e,t){const r={};let n,i;for(i in t.properties)if(i!=="children"&&Lx.call(t.properties,i)){const a=oG(e,i,t.properties[i]);if(a){const[s,o]=a;e.tableCellAlignToStyle&&s==="align"&&typeof o=="string"&&KW.has(t.tagName)?n=o:r[s]=o}}if(n){const a=r.style||(r.style={});a[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function sG(e,t){const r={};for(const n of t.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&e.evaluater){const o=n.data.estree.body[0].expression.properties[0];Object.assign(r,e.evaluater.evaluateExpression(o.argument))}else ul(e,t.position);else{const i=n.name;let a;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&e.evaluater){const o=n.value.data.estree.body[0];a=e.evaluater.evaluateExpression(o.expression)}else ul(e,t.position);else a=n.value===null?!0:n.value;r[i]=a}return r}function Ux(e,t){const r=[];let n=-1;const i=e.passKeys?new Map:GW;for(;++n<t.children.length;){const a=t.children[n];let s;if(e.passKeys){const l=a.type==="element"?a.tagName:a.type==="mdxJsxFlowElement"||a.type==="mdxJsxTextElement"?a.name:void 0;if(l){const c=i.get(l)||0;s=l+"-"+c,i.set(l,c+1)}}const o=hk(e,a,s);o!==void 0&&r.push(o)}return r}function oG(e,t,r){const n=DW(e.schema,t);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?TW(r):BW(r)),n.property==="style"){let i=typeof r=="object"?r:lG(e,String(r));return e.stylePropertyNameCase==="css"&&(i=cG(i)),["style",i]}return[e.elementAttributeNameCase==="react"&&n.space?MR[n.property]||n.property:n.attribute,r]}}function lG(e,t){try{return VW(t,{reactCompat:!0})}catch(r){if(e.ignoreInvalidStyle)return{};const n=r,i=new dr("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:n,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw i.file=e.filePath||void 0,i.url=fk+"#cannot-parse-style-attribute",i}}function mk(e,t,r){let n;if(!r)n={type:"Literal",value:t};else if(t.includes(".")){const i=t.split(".");let a=-1,s;for(;++a<i.length;){const o=oS(i[a])?{type:"Identifier",name:i[a]}:{type:"Literal",value:i[a]};s=s?{type:"MemberExpression",object:s,property:o,computed:!!(a&&o.type==="Literal"),optional:!1}:o}n=s}else n=oS(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(n.type==="Literal"){const i=n.value;return Lx.call(e.components,i)?e.components[i]:i}if(e.evaluater)return e.evaluater.evaluateExpression(n);ul(e)}function ul(e,t){const r=new dr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=fk+"#cannot-handle-mdx-estrees-without-createevaluater",r}function cG(e){const t={};let r;for(r in e)Lx.call(e,r)&&(t[uG(r)]=e[r]);return t}function uG(e){let t=e.replace(YW,fG);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function fG(e){return"-"+e.toLowerCase()}const qJ={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},hG={};function dG(e,t){const r=hG,n=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,i=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return pk(e,n,i)}function pk(e,t,r){if(mG(e)){if("value"in e)return e.type==="html"&&!r?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return xS(e.children,t,r)}return Array.isArray(e)?xS(e,t,r):""}function xS(e,t,r){const n=[];let i=-1;for(;++i<e.length;)n[i]=pk(e[i],t,r);return n.join("")}function mG(e){return!!(e&&typeof e=="object")}const vS=document.createElement("i");function qx(e){const t="&"+e+";";vS.innerHTML=t;const r=vS.textContent;return r.charCodeAt(r.length-1)===59&&e!=="semi"||r===t?!1:r}function Yn(e,t,r,n){const i=e.length;let a=0,s;if(t<0?t=-t>i?0:i+t:t=t>i?i:t,r=r>0?r:0,n.length<1e4)s=Array.from(n),s.unshift(t,r),e.splice(...s);else for(r&&e.splice(t,r);a<n.length;)s=n.slice(a,a+1e4),s.unshift(t,0),e.splice(...s),a+=1e4,t+=1e4}function rn(e,t){return e.length>0?(Yn(e,e.length,0,t),e):t}const yS={}.hasOwnProperty;function pG(e){const t={};let r=-1;for(;++r<e.length;)gG(t,e[r]);return t}function gG(e,t){let r;for(r in t){const i=(yS.call(e,r)?e[r]:void 0)||(e[r]={}),a=t[r];let s;if(a)for(s in a){yS.call(i,s)||(i[s]=[]);const o=a[s];xG(i[s],Array.isArray(o)?o:o?[o]:[])}}}function xG(e,t){let r=-1;const n=[];for(;++r<t.length;)(t[r].add==="after"?e:n).push(t[r]);Yn(e,0,0,n)}function gk(e,t){const r=Number.parseInt(e,t);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"ï¿½":String.fromCodePoint(r)}function Ts(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Un=aa(/[A-Za-z]/),Vr=aa(/[\dA-Za-z]/),vG=aa(/[#-'*+\--9=?A-Z^-~]/);function Mp(e){return e!==null&&(e<32||e===127)}const Lp=aa(/\d/),yG=aa(/[\dA-Fa-f]/),wG=aa(/[!-/:-@[-`{-~]/);function Ie(e){return e!==null&&e<-2}function Ar(e){return e!==null&&(e<0||e===32)}function tt(e){return e===-2||e===-1||e===32}const bG=aa(new RegExp("\\p{P}|\\p{S}","u")),_G=aa(/\s/);function aa(e){return t;function t(r){return r!==null&&r>-1&&e.test(String.fromCharCode(r))}}function Zs(e){const t=[];let r=-1,n=0,i=0;for(;++r<e.length;){const a=e.charCodeAt(r);let s="";if(a===37&&Vr(e.charCodeAt(r+1))&&Vr(e.charCodeAt(r+2)))i=2;else if(a<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(a))||(s=String.fromCharCode(a));else if(a>55295&&a<57344){const o=e.charCodeAt(r+1);a<56320&&o>56319&&o<57344?(s=String.fromCharCode(a,o),i=1):s="ï¿½"}else s=String.fromCharCode(a);s&&(t.push(e.slice(n,r),encodeURIComponent(s)),n=r+i+1,s=""),i&&(r+=i,i=0)}return t.join("")+e.slice(n)}function gt(e,t,r,n){const i=n?n-1:Number.POSITIVE_INFINITY;let a=0;return s;function s(l){return tt(l)?(e.enter(r),o(l)):t(l)}function o(l){return tt(l)&&a++<i?(e.consume(l),o):(e.exit(r),t(l))}}const SG={tokenize:TG};function TG(e){const t=e.attempt(this.parser.constructs.contentInitial,n,i);let r;return t;function n(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),gt(e,t,"linePrefix")}function i(o){return e.enter("paragraph"),a(o)}function a(o){const l=e.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=l),r=l,s(o)}function s(o){if(o===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(o);return}return Ie(o)?(e.consume(o),e.exit("chunkText"),a):(e.consume(o),s)}}const EG={tokenize:NG},wS={tokenize:AG};function NG(e){const t=this,r=[];let n=0,i,a,s;return o;function o(y){if(n<r.length){const w=r[n];return t.containerState=w[1],e.attempt(w[0].continuation,l,c)(y)}return c(y)}function l(y){if(n++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,i&&b();const w=t.events.length;let k=w,T;for(;k--;)if(t.events[k][0]==="exit"&&t.events[k][1].type==="chunkFlow"){T=t.events[k][1].end;break}v(n);let S=w;for(;S<t.events.length;)t.events[S][1].end=q({},T),S++;return Yn(t.events,k+1,0,t.events.slice(w)),t.events.length=S,c(y)}return o(y)}function c(y){if(n===r.length){if(!i)return m(y);if(i.currentConstruct&&i.currentConstruct.concrete)return g(y);t.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(wS,u,h)(y)}function u(y){return i&&b(),v(n),m(y)}function h(y){return t.parser.lazy[t.now().line]=n!==r.length,s=t.now().offset,g(y)}function m(y){return t.containerState={},e.attempt(wS,d,g)(y)}function d(y){return n++,r.push([t.currentConstruct,t.containerState]),m(y)}function g(y){if(y===null){i&&b(),v(0),e.consume(y);return}return i=i||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:a}),p(y)}function p(y){if(y===null){x(e.exit("chunkFlow"),!0),v(0),e.consume(y);return}return Ie(y)?(e.consume(y),x(e.exit("chunkFlow")),n=0,t.interrupt=void 0,o):(e.consume(y),p)}function x(y,w){const k=t.sliceStream(y);if(w&&k.push(null),y.previous=a,a&&(a.next=y),a=y,i.defineSkip(y.start),i.write(k),t.parser.lazy[y.start.line]){let T=i.events.length;for(;T--;)if(i.events[T][1].start.offset<s&&(!i.events[T][1].end||i.events[T][1].end.offset>s))return;const S=t.events.length;let E=S,A,R;for(;E--;)if(t.events[E][0]==="exit"&&t.events[E][1].type==="chunkFlow"){if(A){R=t.events[E][1].end;break}A=!0}for(v(n),T=S;T<t.events.length;)t.events[T][1].end=q({},R),T++;Yn(t.events,E+1,0,t.events.slice(S)),t.events.length=T}}function v(y){let w=r.length;for(;w-- >y;){const k=r[w];t.containerState=k[1],k[0].exit.call(t,e)}r.length=y}function b(){i.write([null]),a=void 0,i=void 0,t.containerState._closeFlow=void 0}}function AG(e,t,r){return gt(e,e.attempt(this.parser.constructs.document,t,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function bS(e){if(e===null||Ar(e)||_G(e))return 1;if(bG(e))return 2}function zx(e,t,r){const n=[];let i=-1;for(;++i<e.length;){const a=e[i].resolveAll;a&&!n.includes(a)&&(t=a(t,r),n.push(a))}return t}const Bp={name:"attention",resolveAll:CG,tokenize:kG};function CG(e,t){let r=-1,n,i,a,s,o,l,c,u;for(;++r<e.length;)if(e[r][0]==="enter"&&e[r][1].type==="attentionSequence"&&e[r][1]._close){for(n=r;n--;)if(e[n][0]==="exit"&&e[n][1].type==="attentionSequence"&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[r][1]).charCodeAt(0)){if((e[n][1]._close||e[r][1]._open)&&(e[r][1].end.offset-e[r][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[r][1].end.offset-e[r][1].start.offset)%3))continue;l=e[n][1].end.offset-e[n][1].start.offset>1&&e[r][1].end.offset-e[r][1].start.offset>1?2:1;const h=q({},e[n][1].end),m=q({},e[r][1].start);_S(h,-l),_S(m,l),s={type:l>1?"strongSequence":"emphasisSequence",start:h,end:q({},e[n][1].end)},o={type:l>1?"strongSequence":"emphasisSequence",start:q({},e[r][1].start),end:m},a={type:l>1?"strongText":"emphasisText",start:q({},e[n][1].end),end:q({},e[r][1].start)},i={type:l>1?"strong":"emphasis",start:q({},s.start),end:q({},o.end)},e[n][1].end=q({},s.start),e[r][1].start=q({},o.end),c=[],e[n][1].end.offset-e[n][1].start.offset&&(c=rn(c,[["enter",e[n][1],t],["exit",e[n][1],t]])),c=rn(c,[["enter",i,t],["enter",s,t],["exit",s,t],["enter",a,t]]),c=rn(c,zx(t.parser.constructs.insideSpan.null,e.slice(n+1,r),t)),c=rn(c,[["exit",a,t],["enter",o,t],["exit",o,t],["exit",i,t]]),e[r][1].end.offset-e[r][1].start.offset?(u=2,c=rn(c,[["enter",e[r][1],t],["exit",e[r][1],t]])):u=0,Yn(e,n-1,r-n+3,c),r=n+c.length-u-2;break}}for(r=-1;++r<e.length;)e[r][1].type==="attentionSequence"&&(e[r][1].type="data");return e}function kG(e,t){const r=this.parser.constructs.attentionMarkers.null,n=this.previous,i=bS(n);let a;return s;function s(l){return a=l,e.enter("attentionSequence"),o(l)}function o(l){if(l===a)return e.consume(l),o;const c=e.exit("attentionSequence"),u=bS(l),h=!u||u===2&&i||r.includes(l),m=!i||i===2&&u||r.includes(n);return c._open=!!(a===42?h:h&&(i||!m)),c._close=!!(a===42?m:m&&(u||!h)),t(l)}}function _S(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const RG={name:"autolink",tokenize:OG};function OG(e,t,r){let n=0;return i;function i(d){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),a}function a(d){return Un(d)?(e.consume(d),s):d===64?r(d):c(d)}function s(d){return d===43||d===45||d===46||Vr(d)?(n=1,o(d)):c(d)}function o(d){return d===58?(e.consume(d),n=0,l):(d===43||d===45||d===46||Vr(d))&&n++<32?(e.consume(d),o):(n=0,c(d))}function l(d){return d===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):d===null||d===32||d===60||Mp(d)?r(d):(e.consume(d),l)}function c(d){return d===64?(e.consume(d),u):vG(d)?(e.consume(d),c):r(d)}function u(d){return Vr(d)?h(d):r(d)}function h(d){return d===46?(e.consume(d),n=0,u):d===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):m(d)}function m(d){if((d===45||Vr(d))&&n++<63){const g=d===45?m:h;return e.consume(d),g}return r(d)}}const Gu={partial:!0,tokenize:FG};function FG(e,t,r){return n;function n(a){return tt(a)?gt(e,i,"linePrefix")(a):i(a)}function i(a){return a===null||Ie(a)?t(a):r(a)}}const xk={continuation:{tokenize:jG},exit:DG,name:"blockQuote",tokenize:IG};function IG(e,t,r){const n=this;return i;function i(s){if(s===62){const o=n.containerState;return o.open||(e.enter("blockQuote",{_container:!0}),o.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(s),e.exit("blockQuoteMarker"),a}return r(s)}function a(s){return tt(s)?(e.enter("blockQuotePrefixWhitespace"),e.consume(s),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(s))}}function jG(e,t,r){const n=this;return i;function i(s){return tt(s)?gt(e,a,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s):a(s)}function a(s){return e.attempt(xk,t,r)(s)}}function DG(e){e.exit("blockQuote")}const vk={name:"characterEscape",tokenize:PG};function PG(e,t,r){return n;function n(a){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(a),e.exit("escapeMarker"),i}function i(a){return wG(a)?(e.enter("characterEscapeValue"),e.consume(a),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):r(a)}}const yk={name:"characterReference",tokenize:MG};function MG(e,t,r){const n=this;let i=0,a,s;return o;function o(h){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),l}function l(h){return h===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(h),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),a=31,s=Vr,u(h))}function c(h){return h===88||h===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(h),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),a=6,s=yG,u):(e.enter("characterReferenceValue"),a=7,s=Lp,u(h))}function u(h){if(h===59&&i){const m=e.exit("characterReferenceValue");return s===Vr&&!qx(n.sliceSerialize(m))?r(h):(e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return s(h)&&i++<a?(e.consume(h),u):r(h)}}const SS={partial:!0,tokenize:BG},TS={concrete:!0,name:"codeFenced",tokenize:LG};function LG(e,t,r){const n=this,i={partial:!0,tokenize:k};let a=0,s=0,o;return l;function l(T){return c(T)}function c(T){const S=n.events[n.events.length-1];return a=S&&S[1].type==="linePrefix"?S[2].sliceSerialize(S[1],!0).length:0,o=T,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),u(T)}function u(T){return T===o?(s++,e.consume(T),u):s<3?r(T):(e.exit("codeFencedFenceSequence"),tt(T)?gt(e,h,"whitespace")(T):h(T))}function h(T){return T===null||Ie(T)?(e.exit("codeFencedFence"),n.interrupt?t(T):e.check(SS,p,w)(T)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),m(T))}function m(T){return T===null||Ie(T)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),h(T)):tt(T)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),gt(e,d,"whitespace")(T)):T===96&&T===o?r(T):(e.consume(T),m)}function d(T){return T===null||Ie(T)?h(T):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),g(T))}function g(T){return T===null||Ie(T)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),h(T)):T===96&&T===o?r(T):(e.consume(T),g)}function p(T){return e.attempt(i,w,x)(T)}function x(T){return e.enter("lineEnding"),e.consume(T),e.exit("lineEnding"),v}function v(T){return a>0&&tt(T)?gt(e,b,"linePrefix",a+1)(T):b(T)}function b(T){return T===null||Ie(T)?e.check(SS,p,w)(T):(e.enter("codeFlowValue"),y(T))}function y(T){return T===null||Ie(T)?(e.exit("codeFlowValue"),b(T)):(e.consume(T),y)}function w(T){return e.exit("codeFenced"),t(T)}function k(T,S,E){let A=0;return R;function R(W){return T.enter("lineEnding"),T.consume(W),T.exit("lineEnding"),C}function C(W){return T.enter("codeFencedFence"),tt(W)?gt(T,j,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(W):j(W)}function j(W){return W===o?(T.enter("codeFencedFenceSequence"),z(W)):E(W)}function z(W){return W===o?(A++,T.consume(W),z):A>=s?(T.exit("codeFencedFenceSequence"),tt(W)?gt(T,G,"whitespace")(W):G(W)):E(W)}function G(W){return W===null||Ie(W)?(T.exit("codeFencedFence"),S(W)):E(W)}}}function BG(e,t,r){const n=this;return i;function i(s){return s===null?r(s):(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),a)}function a(s){return n.parser.lazy[n.now().line]?r(s):t(s)}}const Dm={name:"codeIndented",tokenize:qG},UG={partial:!0,tokenize:zG};function qG(e,t,r){const n=this;return i;function i(c){return e.enter("codeIndented"),gt(e,a,"linePrefix",5)(c)}function a(c){const u=n.events[n.events.length-1];return u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?s(c):r(c)}function s(c){return c===null?l(c):Ie(c)?e.attempt(UG,s,l)(c):(e.enter("codeFlowValue"),o(c))}function o(c){return c===null||Ie(c)?(e.exit("codeFlowValue"),s(c)):(e.consume(c),o)}function l(c){return e.exit("codeIndented"),t(c)}}function zG(e,t,r){const n=this;return i;function i(s){return n.parser.lazy[n.now().line]?r(s):Ie(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),i):gt(e,a,"linePrefix",5)(s)}function a(s){const o=n.events[n.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(s):Ie(s)?i(s):r(s)}}const HG={name:"codeText",previous:VG,resolve:$G,tokenize:WG};function $G(e){let t=e.length-4,r=3,n,i;if((e[r][1].type==="lineEnding"||e[r][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(n=r;++n<t;)if(e[n][1].type==="codeTextData"){e[r][1].type="codeTextPadding",e[t][1].type="codeTextPadding",r+=2,t-=2;break}}for(n=r-1,t++;++n<=t;)i===void 0?n!==t&&e[n][1].type!=="lineEnding"&&(i=n):(n===t||e[n][1].type==="lineEnding")&&(e[i][1].type="codeTextData",n!==i+2&&(e[i][1].end=e[n-1][1].end,e.splice(i+2,n-i-2),t-=n-i-2,n=i+2),i=void 0);return e}function VG(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function WG(e,t,r){let n=0,i,a;return s;function s(h){return e.enter("codeText"),e.enter("codeTextSequence"),o(h)}function o(h){return h===96?(e.consume(h),n++,o):(e.exit("codeTextSequence"),l(h))}function l(h){return h===null?r(h):h===32?(e.enter("space"),e.consume(h),e.exit("space"),l):h===96?(a=e.enter("codeTextSequence"),i=0,u(h)):Ie(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),l):(e.enter("codeTextData"),c(h))}function c(h){return h===null||h===32||h===96||Ie(h)?(e.exit("codeTextData"),l(h)):(e.consume(h),c)}function u(h){return h===96?(e.consume(h),i++,u):i===n?(e.exit("codeTextSequence"),e.exit("codeText"),t(h)):(a.type="codeTextData",c(h))}}class GG{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,r){const n=r==null?Number.POSITIVE_INFINITY:r;return n<this.left.length?this.left.slice(t,n):t>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(t,r,n){const i=r||0;this.setCursor(Math.trunc(t));const a=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return n&&xo(this.left,n),a.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),xo(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),xo(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const r=this.left.splice(t,Number.POSITIVE_INFINITY);xo(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);xo(this.left,r.reverse())}}}function xo(e,t){let r=0;if(t.length<1e4)e.push(...t);else for(;r<t.length;)e.push(...t.slice(r,r+1e4)),r+=1e4}function wk(e){const t={};let r=-1,n,i,a,s,o,l,c;const u=new GG(e);for(;++r<u.length;){for(;r in t;)r=t[r];if(n=u.get(r),r&&n[1].type==="chunkFlow"&&u.get(r-1)[1].type==="listItemPrefix"&&(l=n[1]._tokenizer.events,a=0,a<l.length&&l[a][1].type==="lineEndingBlank"&&(a+=2),a<l.length&&l[a][1].type==="content"))for(;++a<l.length&&l[a][1].type!=="content";)l[a][1].type==="chunkText"&&(l[a][1]._isInFirstContentOfListItem=!0,a++);if(n[0]==="enter")n[1].contentType&&(Object.assign(t,YG(u,r)),r=t[r],c=!0);else if(n[1]._container){for(a=r,i=void 0;a--;)if(s=u.get(a),s[1].type==="lineEnding"||s[1].type==="lineEndingBlank")s[0]==="enter"&&(i&&(u.get(i)[1].type="lineEndingBlank"),s[1].type="lineEnding",i=a);else if(!(s[1].type==="linePrefix"||s[1].type==="listItemIndent"))break;i&&(n[1].end=q({},u.get(i)[1].start),o=u.slice(i,r),o.unshift(n),u.splice(i,r-i+1,o))}}return Yn(e,0,Number.POSITIVE_INFINITY,u.slice(0)),!c}function YG(e,t){const r=e.get(t)[1],n=e.get(t)[2];let i=t-1;const a=[];let s=r._tokenizer;s||(s=n.parser[r.contentType](r.start),r._contentTypeTextTrailing&&(s._contentTypeTextTrailing=!0));const o=s.events,l=[],c={};let u,h,m=-1,d=r,g=0,p=0;const x=[p];for(;d;){for(;e.get(++i)[1]!==d;);a.push(i),d._tokenizer||(u=n.sliceStream(d),d.next||u.push(null),h&&s.defineSkip(d.start),d._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(u),d._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),h=d,d=d.next}for(d=r;++m<o.length;)o[m][0]==="exit"&&o[m-1][0]==="enter"&&o[m][1].type===o[m-1][1].type&&o[m][1].start.line!==o[m][1].end.line&&(p=m+1,x.push(p),d._tokenizer=void 0,d.previous=void 0,d=d.next);for(s.events=[],d?(d._tokenizer=void 0,d.previous=void 0):x.pop(),m=x.length;m--;){const v=o.slice(x[m],x[m+1]),b=a.pop();l.push([b,b+v.length-1]),e.splice(b,2,v)}for(l.reverse(),m=-1;++m<l.length;)c[g+l[m][0]]=g+l[m][1],g+=l[m][1]-l[m][0]-1;return c}const XG={resolve:QG,tokenize:ZG},KG={partial:!0,tokenize:JG};function QG(e){return wk(e),e}function ZG(e,t){let r;return n;function n(o){return e.enter("content"),r=e.enter("chunkContent",{contentType:"content"}),i(o)}function i(o){return o===null?a(o):Ie(o)?e.check(KG,s,a)(o):(e.consume(o),i)}function a(o){return e.exit("chunkContent"),e.exit("content"),t(o)}function s(o){return e.consume(o),e.exit("chunkContent"),r.next=e.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,i}}function JG(e,t,r){const n=this;return i;function i(s){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),gt(e,a,"linePrefix")}function a(s){if(s===null||Ie(s))return r(s);const o=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(s):e.interrupt(n.parser.constructs.flow,r,t)(s)}}function bk(e,t,r,n,i,a,s,o,l){const c=l||Number.POSITIVE_INFINITY;let u=0;return h;function h(v){return v===60?(e.enter(n),e.enter(i),e.enter(a),e.consume(v),e.exit(a),m):v===null||v===32||v===41||Mp(v)?r(v):(e.enter(n),e.enter(s),e.enter(o),e.enter("chunkString",{contentType:"string"}),p(v))}function m(v){return v===62?(e.enter(a),e.consume(v),e.exit(a),e.exit(i),e.exit(n),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),d(v))}function d(v){return v===62?(e.exit("chunkString"),e.exit(o),m(v)):v===null||v===60||Ie(v)?r(v):(e.consume(v),v===92?g:d)}function g(v){return v===60||v===62||v===92?(e.consume(v),d):d(v)}function p(v){return!u&&(v===null||v===41||Ar(v))?(e.exit("chunkString"),e.exit(o),e.exit(s),e.exit(n),t(v)):u<c&&v===40?(e.consume(v),u++,p):v===41?(e.consume(v),u--,p):v===null||v===32||v===40||Mp(v)?r(v):(e.consume(v),v===92?x:p)}function x(v){return v===40||v===41||v===92?(e.consume(v),p):p(v)}}function _k(e,t,r,n,i,a){const s=this;let o=0,l;return c;function c(d){return e.enter(n),e.enter(i),e.consume(d),e.exit(i),e.enter(a),u}function u(d){return o>999||d===null||d===91||d===93&&!l||d===94&&!o&&"_hiddenFootnoteSupport"in s.parser.constructs?r(d):d===93?(e.exit(a),e.enter(i),e.consume(d),e.exit(i),e.exit(n),t):Ie(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),u):(e.enter("chunkString",{contentType:"string"}),h(d))}function h(d){return d===null||d===91||d===93||Ie(d)||o++>999?(e.exit("chunkString"),u(d)):(e.consume(d),l||(l=!tt(d)),d===92?m:h)}function m(d){return d===91||d===92||d===93?(e.consume(d),o++,h):h(d)}}function Sk(e,t,r,n,i,a){let s;return o;function o(m){return m===34||m===39||m===40?(e.enter(n),e.enter(i),e.consume(m),e.exit(i),s=m===40?41:m,l):r(m)}function l(m){return m===s?(e.enter(i),e.consume(m),e.exit(i),e.exit(n),t):(e.enter(a),c(m))}function c(m){return m===s?(e.exit(a),l(s)):m===null?r(m):Ie(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),gt(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),u(m))}function u(m){return m===s||m===null||Ie(m)?(e.exit("chunkString"),c(m)):(e.consume(m),m===92?h:u)}function h(m){return m===s||m===92?(e.consume(m),u):u(m)}}function Mo(e,t){let r;return n;function n(i){return Ie(i)?(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),r=!0,n):tt(i)?gt(e,n,r?"linePrefix":"lineSuffix")(i):t(i)}}const eY={name:"definition",tokenize:rY},tY={partial:!0,tokenize:nY};function rY(e,t,r){const n=this;let i;return a;function a(d){return e.enter("definition"),s(d)}function s(d){return _k.call(n,e,o,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(d)}function o(d){return i=Ts(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),d===58?(e.enter("definitionMarker"),e.consume(d),e.exit("definitionMarker"),l):r(d)}function l(d){return Ar(d)?Mo(e,c)(d):c(d)}function c(d){return bk(e,u,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(d)}function u(d){return e.attempt(tY,h,h)(d)}function h(d){return tt(d)?gt(e,m,"whitespace")(d):m(d)}function m(d){return d===null||Ie(d)?(e.exit("definition"),n.parser.defined.push(i),t(d)):r(d)}}function nY(e,t,r){return n;function n(o){return Ar(o)?Mo(e,i)(o):r(o)}function i(o){return Sk(e,a,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function a(o){return tt(o)?gt(e,s,"whitespace")(o):s(o)}function s(o){return o===null||Ie(o)?t(o):r(o)}}const iY={name:"hardBreakEscape",tokenize:aY};function aY(e,t,r){return n;function n(a){return e.enter("hardBreakEscape"),e.consume(a),i}function i(a){return Ie(a)?(e.exit("hardBreakEscape"),t(a)):r(a)}}const sY={name:"headingAtx",resolve:oY,tokenize:lY};function oY(e,t){let r=e.length-2,n=3,i,a;return e[n][1].type==="whitespace"&&(n+=2),r-2>n&&e[r][1].type==="whitespace"&&(r-=2),e[r][1].type==="atxHeadingSequence"&&(n===r-1||r-4>n&&e[r-2][1].type==="whitespace")&&(r-=n+1===r?2:4),r>n&&(i={type:"atxHeadingText",start:e[n][1].start,end:e[r][1].end},a={type:"chunkText",start:e[n][1].start,end:e[r][1].end,contentType:"text"},Yn(e,n,r-n+1,[["enter",i,t],["enter",a,t],["exit",a,t],["exit",i,t]])),e}function lY(e,t,r){let n=0;return i;function i(u){return e.enter("atxHeading"),a(u)}function a(u){return e.enter("atxHeadingSequence"),s(u)}function s(u){return u===35&&n++<6?(e.consume(u),s):u===null||Ar(u)?(e.exit("atxHeadingSequence"),o(u)):r(u)}function o(u){return u===35?(e.enter("atxHeadingSequence"),l(u)):u===null||Ie(u)?(e.exit("atxHeading"),t(u)):tt(u)?gt(e,o,"whitespace")(u):(e.enter("atxHeadingText"),c(u))}function l(u){return u===35?(e.consume(u),l):(e.exit("atxHeadingSequence"),o(u))}function c(u){return u===null||u===35||Ar(u)?(e.exit("atxHeadingText"),o(u)):(e.consume(u),c)}}const cY=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],ES=["pre","script","style","textarea"],uY={concrete:!0,name:"htmlFlow",resolveTo:dY,tokenize:mY},fY={partial:!0,tokenize:gY},hY={partial:!0,tokenize:pY};function dY(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function mY(e,t,r){const n=this;let i,a,s,o,l;return c;function c(_){return u(_)}function u(_){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(_),h}function h(_){return _===33?(e.consume(_),m):_===47?(e.consume(_),a=!0,p):_===63?(e.consume(_),i=3,n.interrupt?t:O):Un(_)?(e.consume(_),s=String.fromCharCode(_),x):r(_)}function m(_){return _===45?(e.consume(_),i=2,d):_===91?(e.consume(_),i=5,o=0,g):Un(_)?(e.consume(_),i=4,n.interrupt?t:O):r(_)}function d(_){return _===45?(e.consume(_),n.interrupt?t:O):r(_)}function g(_){const M="CDATA[";return _===M.charCodeAt(o++)?(e.consume(_),o===M.length?n.interrupt?t:j:g):r(_)}function p(_){return Un(_)?(e.consume(_),s=String.fromCharCode(_),x):r(_)}function x(_){if(_===null||_===47||_===62||Ar(_)){const M=_===47,U=s.toLowerCase();return!M&&!a&&ES.includes(U)?(i=1,n.interrupt?t(_):j(_)):cY.includes(s.toLowerCase())?(i=6,M?(e.consume(_),v):n.interrupt?t(_):j(_)):(i=7,n.interrupt&&!n.parser.lazy[n.now().line]?r(_):a?b(_):y(_))}return _===45||Vr(_)?(e.consume(_),s+=String.fromCharCode(_),x):r(_)}function v(_){return _===62?(e.consume(_),n.interrupt?t:j):r(_)}function b(_){return tt(_)?(e.consume(_),b):R(_)}function y(_){return _===47?(e.consume(_),R):_===58||_===95||Un(_)?(e.consume(_),w):tt(_)?(e.consume(_),y):R(_)}function w(_){return _===45||_===46||_===58||_===95||Vr(_)?(e.consume(_),w):k(_)}function k(_){return _===61?(e.consume(_),T):tt(_)?(e.consume(_),k):y(_)}function T(_){return _===null||_===60||_===61||_===62||_===96?r(_):_===34||_===39?(e.consume(_),l=_,S):tt(_)?(e.consume(_),T):E(_)}function S(_){return _===l?(e.consume(_),l=null,A):_===null||Ie(_)?r(_):(e.consume(_),S)}function E(_){return _===null||_===34||_===39||_===47||_===60||_===61||_===62||_===96||Ar(_)?k(_):(e.consume(_),E)}function A(_){return _===47||_===62||tt(_)?y(_):r(_)}function R(_){return _===62?(e.consume(_),C):r(_)}function C(_){return _===null||Ie(_)?j(_):tt(_)?(e.consume(_),C):r(_)}function j(_){return _===45&&i===2?(e.consume(_),fe):_===60&&i===1?(e.consume(_),he):_===62&&i===4?(e.consume(_),ge):_===63&&i===3?(e.consume(_),O):_===93&&i===5?(e.consume(_),re):Ie(_)&&(i===6||i===7)?(e.exit("htmlFlowData"),e.check(fY,B,z)(_)):_===null||Ie(_)?(e.exit("htmlFlowData"),z(_)):(e.consume(_),j)}function z(_){return e.check(hY,G,B)(_)}function G(_){return e.enter("lineEnding"),e.consume(_),e.exit("lineEnding"),W}function W(_){return _===null||Ie(_)?z(_):(e.enter("htmlFlowData"),j(_))}function fe(_){return _===45?(e.consume(_),O):j(_)}function he(_){return _===47?(e.consume(_),s="",ee):j(_)}function ee(_){if(_===62){const M=s.toLowerCase();return ES.includes(M)?(e.consume(_),ge):j(_)}return Un(_)&&s.length<8?(e.consume(_),s+=String.fromCharCode(_),ee):j(_)}function re(_){return _===93?(e.consume(_),O):j(_)}function O(_){return _===62?(e.consume(_),ge):_===45&&i===2?(e.consume(_),O):j(_)}function ge(_){return _===null||Ie(_)?(e.exit("htmlFlowData"),B(_)):(e.consume(_),ge)}function B(_){return e.exit("htmlFlow"),t(_)}}function pY(e,t,r){const n=this;return i;function i(s){return Ie(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),a):r(s)}function a(s){return n.parser.lazy[n.now().line]?r(s):t(s)}}function gY(e,t,r){return n;function n(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),e.attempt(Gu,t,r)}}const xY={name:"htmlText",tokenize:vY};function vY(e,t,r){const n=this;let i,a,s;return o;function o(O){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(O),l}function l(O){return O===33?(e.consume(O),c):O===47?(e.consume(O),k):O===63?(e.consume(O),y):Un(O)?(e.consume(O),E):r(O)}function c(O){return O===45?(e.consume(O),u):O===91?(e.consume(O),a=0,g):Un(O)?(e.consume(O),b):r(O)}function u(O){return O===45?(e.consume(O),d):r(O)}function h(O){return O===null?r(O):O===45?(e.consume(O),m):Ie(O)?(s=h,he(O)):(e.consume(O),h)}function m(O){return O===45?(e.consume(O),d):h(O)}function d(O){return O===62?fe(O):O===45?m(O):h(O)}function g(O){const ge="CDATA[";return O===ge.charCodeAt(a++)?(e.consume(O),a===ge.length?p:g):r(O)}function p(O){return O===null?r(O):O===93?(e.consume(O),x):Ie(O)?(s=p,he(O)):(e.consume(O),p)}function x(O){return O===93?(e.consume(O),v):p(O)}function v(O){return O===62?fe(O):O===93?(e.consume(O),v):p(O)}function b(O){return O===null||O===62?fe(O):Ie(O)?(s=b,he(O)):(e.consume(O),b)}function y(O){return O===null?r(O):O===63?(e.consume(O),w):Ie(O)?(s=y,he(O)):(e.consume(O),y)}function w(O){return O===62?fe(O):y(O)}function k(O){return Un(O)?(e.consume(O),T):r(O)}function T(O){return O===45||Vr(O)?(e.consume(O),T):S(O)}function S(O){return Ie(O)?(s=S,he(O)):tt(O)?(e.consume(O),S):fe(O)}function E(O){return O===45||Vr(O)?(e.consume(O),E):O===47||O===62||Ar(O)?A(O):r(O)}function A(O){return O===47?(e.consume(O),fe):O===58||O===95||Un(O)?(e.consume(O),R):Ie(O)?(s=A,he(O)):tt(O)?(e.consume(O),A):fe(O)}function R(O){return O===45||O===46||O===58||O===95||Vr(O)?(e.consume(O),R):C(O)}function C(O){return O===61?(e.consume(O),j):Ie(O)?(s=C,he(O)):tt(O)?(e.consume(O),C):A(O)}function j(O){return O===null||O===60||O===61||O===62||O===96?r(O):O===34||O===39?(e.consume(O),i=O,z):Ie(O)?(s=j,he(O)):tt(O)?(e.consume(O),j):(e.consume(O),G)}function z(O){return O===i?(e.consume(O),i=void 0,W):O===null?r(O):Ie(O)?(s=z,he(O)):(e.consume(O),z)}function G(O){return O===null||O===34||O===39||O===60||O===61||O===96?r(O):O===47||O===62||Ar(O)?A(O):(e.consume(O),G)}function W(O){return O===47||O===62||Ar(O)?A(O):r(O)}function fe(O){return O===62?(e.consume(O),e.exit("htmlTextData"),e.exit("htmlText"),t):r(O)}function he(O){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(O),e.exit("lineEnding"),ee}function ee(O){return tt(O)?gt(e,re,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(O):re(O)}function re(O){return e.enter("htmlTextData"),s(O)}}const Hx={name:"labelEnd",resolveAll:_Y,resolveTo:SY,tokenize:TY},yY={tokenize:EY},wY={tokenize:NY},bY={tokenize:AY};function _Y(e){let t=-1;const r=[];for(;++t<e.length;){const n=e[t][1];if(r.push(e[t]),n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd"){const i=n.type==="labelImage"?4:2;n.type="data",t+=i}}return e.length!==r.length&&Yn(e,0,e.length,r),e}function SY(e,t){let r=e.length,n=0,i,a,s,o;for(;r--;)if(i=e[r][1],a){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;e[r][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(s){if(e[r][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(a=r,i.type!=="labelLink")){n=2;break}}else i.type==="labelEnd"&&(s=r);const l={type:e[a][1].type==="labelLink"?"link":"image",start:q({},e[a][1].start),end:q({},e[e.length-1][1].end)},c={type:"label",start:q({},e[a][1].start),end:q({},e[s][1].end)},u={type:"labelText",start:q({},e[a+n+2][1].end),end:q({},e[s-2][1].start)};return o=[["enter",l,t],["enter",c,t]],o=rn(o,e.slice(a+1,a+n+3)),o=rn(o,[["enter",u,t]]),o=rn(o,zx(t.parser.constructs.insideSpan.null,e.slice(a+n+4,s-3),t)),o=rn(o,[["exit",u,t],e[s-2],e[s-1],["exit",c,t]]),o=rn(o,e.slice(s+1)),o=rn(o,[["exit",l,t]]),Yn(e,a,e.length,o),e}function TY(e,t,r){const n=this;let i=n.events.length,a,s;for(;i--;)if((n.events[i][1].type==="labelImage"||n.events[i][1].type==="labelLink")&&!n.events[i][1]._balanced){a=n.events[i][1];break}return o;function o(m){return a?a._inactive?h(m):(s=n.parser.defined.includes(Ts(n.sliceSerialize({start:a.end,end:n.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(m),e.exit("labelMarker"),e.exit("labelEnd"),l):r(m)}function l(m){return m===40?e.attempt(yY,u,s?u:h)(m):m===91?e.attempt(wY,u,s?c:h)(m):s?u(m):h(m)}function c(m){return e.attempt(bY,u,h)(m)}function u(m){return t(m)}function h(m){return a._balanced=!0,r(m)}}function EY(e,t,r){return n;function n(h){return e.enter("resource"),e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),i}function i(h){return Ar(h)?Mo(e,a)(h):a(h)}function a(h){return h===41?u(h):bk(e,s,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function s(h){return Ar(h)?Mo(e,l)(h):u(h)}function o(h){return r(h)}function l(h){return h===34||h===39||h===40?Sk(e,c,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):u(h)}function c(h){return Ar(h)?Mo(e,u)(h):u(h)}function u(h){return h===41?(e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),e.exit("resource"),t):r(h)}}function NY(e,t,r){const n=this;return i;function i(o){return _k.call(n,e,a,s,"reference","referenceMarker","referenceString")(o)}function a(o){return n.parser.defined.includes(Ts(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?t(o):r(o)}function s(o){return r(o)}}function AY(e,t,r){return n;function n(a){return e.enter("reference"),e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),i}function i(a){return a===93?(e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),e.exit("reference"),t):r(a)}}const CY={name:"labelStartImage",resolveAll:Hx.resolveAll,tokenize:kY};function kY(e,t,r){const n=this;return i;function i(o){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(o),e.exit("labelImageMarker"),a}function a(o){return o===91?(e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelImage"),s):r(o)}function s(o){return o===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(o):t(o)}}const RY={name:"labelStartLink",resolveAll:Hx.resolveAll,tokenize:OY};function OY(e,t,r){const n=this;return i;function i(s){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(s),e.exit("labelMarker"),e.exit("labelLink"),a}function a(s){return s===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(s):t(s)}}const Pm={name:"lineEnding",tokenize:FY};function FY(e,t){return r;function r(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),gt(e,t,"linePrefix")}}const Tc={name:"thematicBreak",tokenize:IY};function IY(e,t,r){let n=0,i;return a;function a(c){return e.enter("thematicBreak"),s(c)}function s(c){return i=c,o(c)}function o(c){return c===i?(e.enter("thematicBreakSequence"),l(c)):n>=3&&(c===null||Ie(c))?(e.exit("thematicBreak"),t(c)):r(c)}function l(c){return c===i?(e.consume(c),n++,l):(e.exit("thematicBreakSequence"),tt(c)?gt(e,o,"whitespace")(c):o(c))}}const Tr={continuation:{tokenize:MY},exit:BY,name:"list",tokenize:PY},jY={partial:!0,tokenize:UY},DY={partial:!0,tokenize:LY};function PY(e,t,r){const n=this,i=n.events[n.events.length-1];let a=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,s=0;return o;function o(d){const g=n.containerState.type||(d===42||d===43||d===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!n.containerState.marker||d===n.containerState.marker:Lp(d)){if(n.containerState.type||(n.containerState.type=g,e.enter(g,{_container:!0})),g==="listUnordered")return e.enter("listItemPrefix"),d===42||d===45?e.check(Tc,r,c)(d):c(d);if(!n.interrupt||d===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),l(d)}return r(d)}function l(d){return Lp(d)&&++s<10?(e.consume(d),l):(!n.interrupt||s<2)&&(n.containerState.marker?d===n.containerState.marker:d===41||d===46)?(e.exit("listItemValue"),c(d)):r(d)}function c(d){return e.enter("listItemMarker"),e.consume(d),e.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||d,e.check(Gu,n.interrupt?r:u,e.attempt(jY,m,h))}function u(d){return n.containerState.initialBlankLine=!0,a++,m(d)}function h(d){return tt(d)?(e.enter("listItemPrefixWhitespace"),e.consume(d),e.exit("listItemPrefixWhitespace"),m):r(d)}function m(d){return n.containerState.size=a+n.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(d)}}function MY(e,t,r){const n=this;return n.containerState._closeFlow=void 0,e.check(Gu,i,a);function i(o){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,gt(e,t,"listItemIndent",n.containerState.size+1)(o)}function a(o){return n.containerState.furtherBlankLines||!tt(o)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,s(o)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,e.attempt(DY,t,s)(o))}function s(o){return n.containerState._closeFlow=!0,n.interrupt=void 0,gt(e,e.attempt(Tr,t,r),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function LY(e,t,r){const n=this;return gt(e,i,"listItemIndent",n.containerState.size+1);function i(a){const s=n.events[n.events.length-1];return s&&s[1].type==="listItemIndent"&&s[2].sliceSerialize(s[1],!0).length===n.containerState.size?t(a):r(a)}}function BY(e){e.exit(this.containerState.type)}function UY(e,t,r){const n=this;return gt(e,i,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(a){const s=n.events[n.events.length-1];return!tt(a)&&s&&s[1].type==="listItemPrefixWhitespace"?t(a):r(a)}}const NS={name:"setextUnderline",resolveTo:qY,tokenize:zY};function qY(e,t){let r=e.length,n,i,a;for(;r--;)if(e[r][0]==="enter"){if(e[r][1].type==="content"){n=r;break}e[r][1].type==="paragraph"&&(i=r)}else e[r][1].type==="content"&&e.splice(r,1),!a&&e[r][1].type==="definition"&&(a=r);const s={type:"setextHeading",start:q({},e[n][1].start),end:q({},e[e.length-1][1].end)};return e[i][1].type="setextHeadingText",a?(e.splice(i,0,["enter",s,t]),e.splice(a+1,0,["exit",e[n][1],t]),e[n][1].end=q({},e[a][1].end)):e[n][1]=s,e.push(["exit",s,t]),e}function zY(e,t,r){const n=this;let i;return a;function a(c){let u=n.events.length,h;for(;u--;)if(n.events[u][1].type!=="lineEnding"&&n.events[u][1].type!=="linePrefix"&&n.events[u][1].type!=="content"){h=n.events[u][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||h)?(e.enter("setextHeadingLine"),i=c,s(c)):r(c)}function s(c){return e.enter("setextHeadingLineSequence"),o(c)}function o(c){return c===i?(e.consume(c),o):(e.exit("setextHeadingLineSequence"),tt(c)?gt(e,l,"lineSuffix")(c):l(c))}function l(c){return c===null||Ie(c)?(e.exit("setextHeadingLine"),t(c)):r(c)}}const HY={tokenize:$Y};function $Y(e){const t=this,r=e.attempt(Gu,n,e.attempt(this.parser.constructs.flowInitial,i,gt(e,e.attempt(this.parser.constructs.flow,i,e.attempt(XG,i)),"linePrefix")));return r;function n(a){if(a===null){e.consume(a);return}return e.enter("lineEndingBlank"),e.consume(a),e.exit("lineEndingBlank"),t.currentConstruct=void 0,r}function i(a){if(a===null){e.consume(a);return}return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t.currentConstruct=void 0,r}}const VY={resolveAll:Ek()},WY=Tk("string"),GY=Tk("text");function Tk(e){return{resolveAll:Ek(e==="text"?YY:void 0),tokenize:t};function t(r){const n=this,i=this.parser.constructs[e],a=r.attempt(i,s,o);return s;function s(u){return c(u)?a(u):o(u)}function o(u){if(u===null){r.consume(u);return}return r.enter("data"),r.consume(u),l}function l(u){return c(u)?(r.exit("data"),a(u)):(r.consume(u),l)}function c(u){if(u===null)return!0;const h=i[u];let m=-1;if(h)for(;++m<h.length;){const d=h[m];if(!d.previous||d.previous.call(n,n.previous))return!0}return!1}}}function Ek(e){return t;function t(r,n){let i=-1,a;for(;++i<=r.length;)a===void 0?r[i]&&r[i][1].type==="data"&&(a=i,i++):(!r[i]||r[i][1].type!=="data")&&(i!==a+2&&(r[a][1].end=r[i-1][1].end,r.splice(a+2,i-a-2),i=a+2),a=void 0);return e?e(r,n):r}}function YY(e,t){let r=0;for(;++r<=e.length;)if((r===e.length||e[r][1].type==="lineEnding")&&e[r-1][1].type==="data"){const n=e[r-1][1],i=t.sliceStream(n);let a=i.length,s=-1,o=0,l;for(;a--;){const c=i[a];if(typeof c=="string"){for(s=c.length;c.charCodeAt(s-1)===32;)o++,s--;if(s)break;s=-1}else if(c===-2)l=!0,o++;else if(c!==-1){a++;break}}if(t._contentTypeTextTrailing&&r===e.length&&(o=0),o){const c={type:r===e.length||l||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:a?s:n.start._bufferIndex+s,_index:n.start._index+a,line:n.end.line,column:n.end.column-o,offset:n.end.offset-o},end:q({},n.end)};n.end=q({},c.start),n.start.offset===n.end.offset?Object.assign(n,c):(e.splice(r,0,["enter",c,t],["exit",c,t]),r+=2)}r++}return e}const XY={42:Tr,43:Tr,45:Tr,48:Tr,49:Tr,50:Tr,51:Tr,52:Tr,53:Tr,54:Tr,55:Tr,56:Tr,57:Tr,62:xk},KY={91:eY},QY={[-2]:Dm,[-1]:Dm,32:Dm},ZY={35:sY,42:Tc,45:[NS,Tc],60:uY,61:NS,95:Tc,96:TS,126:TS},JY={38:yk,92:vk},eX={[-5]:Pm,[-4]:Pm,[-3]:Pm,33:CY,38:yk,42:Bp,60:[RG,xY],91:RY,92:[iY,vk],93:Hx,95:Bp,96:HG},tX={null:[Bp,VY]},rX={null:[42,95]},nX={null:[]},iX=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:rX,contentInitial:KY,disable:nX,document:XY,flow:ZY,flowInitial:QY,insideSpan:tX,string:JY,text:eX},Symbol.toStringTag,{value:"Module"}));function aX(e,t,r){let n={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const i={},a=[];let s=[],o=[];const l={attempt:S(k),check:S(T),consume:b,enter:y,exit:w,interrupt:S(T,{interrupt:!0})},c={code:null,containerState:{},defineSkip:p,events:[],now:g,parser:e,previous:null,sliceSerialize:m,sliceStream:d,write:h};let u=t.tokenize.call(c,l);return t.resolveAll&&a.push(t),c;function h(C){return s=rn(s,C),x(),s[s.length-1]!==null?[]:(E(t,0),c.events=zx(a,c.events,c),c.events)}function m(C,j){return oX(d(C),j)}function d(C){return sX(s,C)}function g(){const{_bufferIndex:C,_index:j,line:z,column:G,offset:W}=n;return{_bufferIndex:C,_index:j,line:z,column:G,offset:W}}function p(C){i[C.line]=C.column,R()}function x(){let C;for(;n._index<s.length;){const j=s[n._index];if(typeof j=="string")for(C=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===C&&n._bufferIndex<j.length;)v(j.charCodeAt(n._bufferIndex));else v(j)}}function v(C){u=u(C)}function b(C){Ie(C)?(n.line++,n.column=1,n.offset+=C===-3?2:1,R()):C!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===s[n._index].length&&(n._bufferIndex=-1,n._index++)),c.previous=C}function y(C,j){const z=j||{};return z.type=C,z.start=g(),c.events.push(["enter",z,c]),o.push(z),z}function w(C){const j=o.pop();return j.end=g(),c.events.push(["exit",j,c]),j}function k(C,j){E(C,j.from)}function T(C,j){j.restore()}function S(C,j){return z;function z(G,W,fe){let he,ee,re,O;return Array.isArray(G)?B(G):"tokenize"in G?B([G]):ge(G);function ge(V){return le;function le(de){const K=de!==null&&V[de],J=de!==null&&V.null,Se=[...Array.isArray(K)?K:K?[K]:[],...Array.isArray(J)?J:J?[J]:[]];return B(Se)(de)}}function B(V){return he=V,ee=0,V.length===0?fe:_(V[ee])}function _(V){return le;function le(de){return O=A(),re=V,V.partial||(c.currentConstruct=V),V.name&&c.parser.constructs.disable.null.includes(V.name)?U():V.tokenize.call(j?Object.assign(Object.create(c),j):c,l,M,U)(de)}}function M(V){return C(re,O),W}function U(V){return O.restore(),++ee<he.length?_(he[ee]):fe}}}function E(C,j){C.resolveAll&&!a.includes(C)&&a.push(C),C.resolve&&Yn(c.events,j,c.events.length-j,C.resolve(c.events.slice(j),c)),C.resolveTo&&(c.events=C.resolveTo(c.events,c))}function A(){const C=g(),j=c.previous,z=c.currentConstruct,G=c.events.length,W=Array.from(o);return{from:G,restore:fe};function fe(){n=C,c.previous=j,c.currentConstruct=z,c.events.length=G,o=W,R()}}function R(){n.line in i&&n.column<2&&(n.column=i[n.line],n.offset+=i[n.line]-1)}}function sX(e,t){const r=t.start._index,n=t.start._bufferIndex,i=t.end._index,a=t.end._bufferIndex;let s;if(r===i)s=[e[r].slice(n,a)];else{if(s=e.slice(r,i),n>-1){const o=s[0];typeof o=="string"?s[0]=o.slice(n):s.shift()}a>0&&s.push(e[i].slice(0,a))}return s}function oX(e,t){let r=-1;const n=[];let i;for(;++r<e.length;){const a=e[r];let s;if(typeof a=="string")s=a;else switch(a){case-5:{s="\r";break}case-4:{s=`
`;break}case-3:{s=`\r
`;break}case-2:{s=t?" ":"	";break}case-1:{if(!t&&i)continue;s=" ";break}default:s=String.fromCharCode(a)}i=a===-2,n.push(s)}return n.join("")}function lX(e){const n={constructs:pG([iX,...(e||{}).extensions||[]]),content:i(SG),defined:[],document:i(EG),flow:i(HY),lazy:{},string:i(WY),text:i(GY)};return n;function i(a){return s;function s(o){return aX(n,a,o)}}}function cX(e){for(;!wk(e););return e}const AS=/[\0\t\n\r]/g;function uX(){let e=1,t="",r=!0,n;return i;function i(a,s,o){const l=[];let c,u,h,m,d;for(a=t+(typeof a=="string"?a.toString():new TextDecoder(s||void 0).decode(a)),h=0,t="",r&&(a.charCodeAt(0)===65279&&h++,r=void 0);h<a.length;){if(AS.lastIndex=h,c=AS.exec(a),m=c&&c.index!==void 0?c.index:a.length,d=a.charCodeAt(m),!c){t=a.slice(h);break}if(d===10&&h===m&&n)l.push(-3),n=void 0;else switch(n&&(l.push(-5),n=void 0),h<m&&(l.push(a.slice(h,m)),e+=m-h),d){case 0:{l.push(65533),e++;break}case 9:{for(u=Math.ceil(e/4)*4,l.push(-2);e++<u;)l.push(-1);break}case 10:{l.push(-4),e=1;break}default:n=!0,e=1}h=m+1}return o&&(n&&l.push(-5),t&&l.push(t),l.push(null)),l}}const fX=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function hX(e){return e.replace(fX,dX)}function dX(e,t,r){if(t)return t;if(r.charCodeAt(0)===35){const i=r.charCodeAt(1),a=i===120||i===88;return gk(r.slice(a?2:1),a?16:10)}return qx(r)||e}const Nk={}.hasOwnProperty;function mX(e,t,r){return typeof t!="string"&&(r=t,t=void 0),pX(r)(cX(lX(r).document().write(uX()(e,t,!0))))}function pX(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:a(mr),autolinkProtocol:A,autolinkEmail:A,atxHeading:a(Je),blockQuote:a(J),characterEscape:A,characterReference:A,codeFenced:a(Se),codeFencedFenceInfo:s,codeFencedFenceMeta:s,codeIndented:a(Se,s),codeText:a(te,s),codeTextData:A,data:A,codeFlowValue:A,definition:a($e),definitionDestinationString:s,definitionLabelString:s,definitionTitleString:s,emphasis:a(Ne),hardBreakEscape:a(Be),hardBreakTrailing:a(Be),htmlFlow:a(Te,s),htmlFlowData:A,htmlText:a(Te,s),htmlTextData:A,image:a(Ot),label:s,link:a(mr),listItem:a(ir),listItemValue:m,listOrdered:a(Qt,h),listUnordered:a(Qt),paragraph:a(Yr),reference:_,referenceString:s,resourceDestinationString:s,resourceTitleString:s,setextHeading:a(Je),strong:a(jr),thematicBreak:a(On)},exit:{atxHeading:l(),atxHeadingSequence:k,autolink:l(),autolinkEmail:K,autolinkProtocol:de,blockQuote:l(),characterEscapeValue:R,characterReferenceMarkerHexadecimal:U,characterReferenceMarkerNumeric:U,characterReferenceValue:V,characterReference:le,codeFenced:l(x),codeFencedFence:p,codeFencedFenceInfo:d,codeFencedFenceMeta:g,codeFlowValue:R,codeIndented:l(v),codeText:l(W),codeTextData:R,data:R,definition:l(),definitionDestinationString:w,definitionLabelString:b,definitionTitleString:y,emphasis:l(),hardBreakEscape:l(j),hardBreakTrailing:l(j),htmlFlow:l(z),htmlFlowData:R,htmlText:l(G),htmlTextData:R,image:l(he),label:re,labelText:ee,lineEnding:C,link:l(fe),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:M,resourceDestinationString:O,resourceTitleString:ge,resource:B,setextHeading:l(E),setextHeadingLineSequence:S,setextHeadingText:T,strong:l(),thematicBreak:l()}};Ak(t,(e||{}).mdastExtensions||[]);const r={};return n;function n(ie){let xe={type:"root",children:[]};const Oe={stack:[xe],tokenStack:[],config:t,enter:o,exit:c,buffer:s,resume:u,data:r},Ue=[];let We=-1;for(;++We<ie.length;)if(ie[We][1].type==="listOrdered"||ie[We][1].type==="listUnordered")if(ie[We][0]==="enter")Ue.push(We);else{const Ut=Ue.pop();We=i(ie,Ut,We)}for(We=-1;++We<ie.length;){const Ut=t[ie[We][0]];Nk.call(Ut,ie[We][1].type)&&Ut[ie[We][1].type].call(Object.assign({sliceSerialize:ie[We][2].sliceSerialize},Oe),ie[We][1])}if(Oe.tokenStack.length>0){const Ut=Oe.tokenStack[Oe.tokenStack.length-1];(Ut[1]||CS).call(Oe,void 0,Ut[0])}for(xe.position={start:Ci(ie.length>0?ie[0][1].start:{line:1,column:1,offset:0}),end:Ci(ie.length>0?ie[ie.length-2][1].end:{line:1,column:1,offset:0})},We=-1;++We<t.transforms.length;)xe=t.transforms[We](xe)||xe;return xe}function i(ie,xe,Oe){let Ue=xe-1,We=-1,Ut=!1,pr,gr,hn,Xr;for(;++Ue<=Oe;){const qt=ie[Ue];switch(qt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{qt[0]==="enter"?We++:We--,Xr=void 0;break}case"lineEndingBlank":{qt[0]==="enter"&&(pr&&!Xr&&!We&&!hn&&(hn=Ue),Xr=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Xr=void 0}if(!We&&qt[0]==="enter"&&qt[1].type==="listItemPrefix"||We===-1&&qt[0]==="exit"&&(qt[1].type==="listUnordered"||qt[1].type==="listOrdered")){if(pr){let Kr=Ue;for(gr=void 0;Kr--;){const ar=ie[Kr];if(ar[1].type==="lineEnding"||ar[1].type==="lineEndingBlank"){if(ar[0]==="exit")continue;gr&&(ie[gr][1].type="lineEndingBlank",Ut=!0),ar[1].type="lineEnding",gr=Kr}else if(!(ar[1].type==="linePrefix"||ar[1].type==="blockQuotePrefix"||ar[1].type==="blockQuotePrefixWhitespace"||ar[1].type==="blockQuoteMarker"||ar[1].type==="listItemIndent"))break}hn&&(!gr||hn<gr)&&(pr._spread=!0),pr.end=Object.assign({},gr?ie[gr][1].start:qt[1].end),ie.splice(gr||Ue,0,["exit",pr,qt[2]]),Ue++,Oe++}if(qt[1].type==="listItemPrefix"){const Kr={type:"listItem",_spread:!1,start:Object.assign({},qt[1].start),end:void 0};pr=Kr,ie.splice(Ue,0,["enter",Kr,qt[2]]),Ue++,Oe++,hn=void 0,Xr=!0}}}return ie[xe][1]._spread=Ut,Oe}function a(ie,xe){return Oe;function Oe(Ue){o.call(this,ie(Ue),Ue),xe&&xe.call(this,Ue)}}function s(){this.stack.push({type:"fragment",children:[]})}function o(ie,xe,Oe){this.stack[this.stack.length-1].children.push(ie),this.stack.push(ie),this.tokenStack.push([xe,Oe||void 0]),ie.position={start:Ci(xe.start),end:void 0}}function l(ie){return xe;function xe(Oe){ie&&ie.call(this,Oe),c.call(this,Oe)}}function c(ie,xe){const Oe=this.stack.pop(),Ue=this.tokenStack.pop();if(Ue)Ue[0].type!==ie.type&&(xe?xe.call(this,ie,Ue[0]):(Ue[1]||CS).call(this,ie,Ue[0]));else throw new Error("Cannot close `"+ie.type+"` ("+Po({start:ie.start,end:ie.end})+"): itâ€™s not open");Oe.position.end=Ci(ie.end)}function u(){return dG(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function m(ie){if(this.data.expectingFirstListItemValue){const xe=this.stack[this.stack.length-2];xe.start=Number.parseInt(this.sliceSerialize(ie),10),this.data.expectingFirstListItemValue=void 0}}function d(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.lang=ie}function g(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.meta=ie}function p(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function x(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function v(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie.replace(/(\r?\n|\r)$/g,"")}function b(ie){const xe=this.resume(),Oe=this.stack[this.stack.length-1];Oe.label=xe,Oe.identifier=Ts(this.sliceSerialize(ie)).toLowerCase()}function y(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.title=ie}function w(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.url=ie}function k(ie){const xe=this.stack[this.stack.length-1];if(!xe.depth){const Oe=this.sliceSerialize(ie).length;xe.depth=Oe}}function T(){this.data.setextHeadingSlurpLineEnding=!0}function S(ie){const xe=this.stack[this.stack.length-1];xe.depth=this.sliceSerialize(ie).codePointAt(0)===61?1:2}function E(){this.data.setextHeadingSlurpLineEnding=void 0}function A(ie){const Oe=this.stack[this.stack.length-1].children;let Ue=Oe[Oe.length-1];(!Ue||Ue.type!=="text")&&(Ue=ft(),Ue.position={start:Ci(ie.start),end:void 0},Oe.push(Ue)),this.stack.push(Ue)}function R(ie){const xe=this.stack.pop();xe.value+=this.sliceSerialize(ie),xe.position.end=Ci(ie.end)}function C(ie){const xe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Oe=xe.children[xe.children.length-1];Oe.position.end=Ci(ie.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(xe.type)&&(A.call(this,ie),R.call(this,ie))}function j(){this.data.atHardBreak=!0}function z(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie}function G(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie}function W(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie}function fe(){const ie=this.stack[this.stack.length-1];if(this.data.inReference){const xe=this.data.referenceType||"shortcut";ie.type+="Reference",ie.referenceType=xe,delete ie.url,delete ie.title}else delete ie.identifier,delete ie.label;this.data.referenceType=void 0}function he(){const ie=this.stack[this.stack.length-1];if(this.data.inReference){const xe=this.data.referenceType||"shortcut";ie.type+="Reference",ie.referenceType=xe,delete ie.url,delete ie.title}else delete ie.identifier,delete ie.label;this.data.referenceType=void 0}function ee(ie){const xe=this.sliceSerialize(ie),Oe=this.stack[this.stack.length-2];Oe.label=hX(xe),Oe.identifier=Ts(xe).toLowerCase()}function re(){const ie=this.stack[this.stack.length-1],xe=this.resume(),Oe=this.stack[this.stack.length-1];if(this.data.inReference=!0,Oe.type==="link"){const Ue=ie.children;Oe.children=Ue}else Oe.alt=xe}function O(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.url=ie}function ge(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.title=ie}function B(){this.data.inReference=void 0}function _(){this.data.referenceType="collapsed"}function M(ie){const xe=this.resume(),Oe=this.stack[this.stack.length-1];Oe.label=xe,Oe.identifier=Ts(this.sliceSerialize(ie)).toLowerCase(),this.data.referenceType="full"}function U(ie){this.data.characterReferenceType=ie.type}function V(ie){const xe=this.sliceSerialize(ie),Oe=this.data.characterReferenceType;let Ue;Oe?(Ue=gk(xe,Oe==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Ue=qx(xe);const We=this.stack[this.stack.length-1];We.value+=Ue}function le(ie){const xe=this.stack.pop();xe.position.end=Ci(ie.end)}function de(ie){R.call(this,ie);const xe=this.stack[this.stack.length-1];xe.url=this.sliceSerialize(ie)}function K(ie){R.call(this,ie);const xe=this.stack[this.stack.length-1];xe.url="mailto:"+this.sliceSerialize(ie)}function J(){return{type:"blockquote",children:[]}}function Se(){return{type:"code",lang:null,meta:null,value:""}}function te(){return{type:"inlineCode",value:""}}function $e(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ne(){return{type:"emphasis",children:[]}}function Je(){return{type:"heading",depth:0,children:[]}}function Be(){return{type:"break"}}function Te(){return{type:"html",value:""}}function Ot(){return{type:"image",title:null,url:"",alt:null}}function mr(){return{type:"link",title:null,url:"",children:[]}}function Qt(ie){return{type:"list",ordered:ie.type==="listOrdered",start:null,spread:ie._spread,children:[]}}function ir(ie){return{type:"listItem",spread:ie._spread,checked:null,children:[]}}function Yr(){return{type:"paragraph",children:[]}}function jr(){return{type:"strong",children:[]}}function ft(){return{type:"text",value:""}}function On(){return{type:"thematicBreak"}}}function Ci(e){return{line:e.line,column:e.column,offset:e.offset}}function Ak(e,t){let r=-1;for(;++r<t.length;){const n=t[r];Array.isArray(n)?Ak(e,n):gX(e,n)}}function gX(e,t){let r;for(r in t)if(Nk.call(t,r))switch(r){case"canContainEols":{const n=t[r];n&&e[r].push(...n);break}case"transforms":{const n=t[r];n&&e[r].push(...n);break}case"enter":case"exit":{const n=t[r];n&&Object.assign(e[r],n);break}}}function CS(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Po({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Po({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Po({start:t.start,end:t.end})+") is still open")}function zJ(e){const t=this;t.parser=r;function r(n){return mX(n,ce(q(q({},t.data("settings")),e),{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}}function xX(e,t){const r={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,r),e.applyData(t,r)}function vX(e,t){const r={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,r),[e.applyData(t,r),{type:"text",value:`
`}]}function yX(e,t){const r=t.value?t.value+`
`:"",n={};t.lang&&(n.className=["language-"+t.lang]);let i={type:"element",tagName:"code",properties:n,children:[{type:"text",value:r}]};return t.meta&&(i.data={meta:t.meta}),e.patch(t,i),i=e.applyData(t,i),i={type:"element",tagName:"pre",properties:{},children:[i]},e.patch(t,i),i}function wX(e,t){const r={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function bX(e,t){const r={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function _X(e,t){const r=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=String(t.identifier).toUpperCase(),i=Zs(n.toLowerCase()),a=e.footnoteOrder.indexOf(n);let s,o=e.footnoteCounts.get(n);o===void 0?(o=0,e.footnoteOrder.push(n),s=e.footnoteOrder.length):s=a+1,o+=1,e.footnoteCounts.set(n,o);const l={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+i,id:r+"fnref-"+i+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(s)}]};e.patch(t,l);const c={type:"element",tagName:"sup",properties:{},children:[l]};return e.patch(t,c),e.applyData(t,c)}function SX(e,t){const r={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function TX(e,t){if(e.options.allowDangerousHtml){const r={type:"raw",value:t.value};return e.patch(t,r),e.applyData(t,r)}}function Ck(e,t){const r=t.referenceType;let n="]";if(r==="collapsed"?n+="[]":r==="full"&&(n+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+n}];const i=e.all(t),a=i[0];a&&a.type==="text"?a.value="["+a.value:i.unshift({type:"text",value:"["});const s=i[i.length-1];return s&&s.type==="text"?s.value+=n:i.push({type:"text",value:n}),i}function EX(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return Ck(e,t);const i={src:Zs(n.url||""),alt:t.alt};n.title!==null&&n.title!==void 0&&(i.title=n.title);const a={type:"element",tagName:"img",properties:i,children:[]};return e.patch(t,a),e.applyData(t,a)}function NX(e,t){const r={src:Zs(t.url)};t.alt!==null&&t.alt!==void 0&&(r.alt=t.alt),t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,n),e.applyData(t,n)}function AX(e,t){const r={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,r);const n={type:"element",tagName:"code",properties:{},children:[r]};return e.patch(t,n),e.applyData(t,n)}function CX(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return Ck(e,t);const i={href:Zs(n.url||"")};n.title!==null&&n.title!==void 0&&(i.title=n.title);const a={type:"element",tagName:"a",properties:i,children:e.all(t)};return e.patch(t,a),e.applyData(t,a)}function kX(e,t){const r={href:Zs(t.url)};t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function RX(e,t,r){const n=e.all(t),i=r?OX(r):kk(t),a={},s=[];if(typeof t.checked=="boolean"){const u=n[0];let h;u&&u.type==="element"&&u.tagName==="p"?h=u:(h={type:"element",tagName:"p",properties:{},children:[]},n.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),a.className=["task-list-item"]}let o=-1;for(;++o<n.length;){const u=n[o];(i||o!==0||u.type!=="element"||u.tagName!=="p")&&s.push({type:"text",value:`
`}),u.type==="element"&&u.tagName==="p"&&!i?s.push(...u.children):s.push(u)}const l=n[n.length-1];l&&(i||l.type!=="element"||l.tagName!=="p")&&s.push({type:"text",value:`
`});const c={type:"element",tagName:"li",properties:a,children:s};return e.patch(t,c),e.applyData(t,c)}function OX(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const r=e.children;let n=-1;for(;!t&&++n<r.length;)t=kk(r[n])}return t}function kk(e){const t=e.spread;return t==null?e.children.length>1:t}function FX(e,t){const r={},n=e.all(t);let i=-1;for(typeof t.start=="number"&&t.start!==1&&(r.start=t.start);++i<n.length;){const s=n[i];if(s.type==="element"&&s.tagName==="li"&&s.properties&&Array.isArray(s.properties.className)&&s.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const a={type:"element",tagName:t.ordered?"ol":"ul",properties:r,children:e.wrap(n,!0)};return e.patch(t,a),e.applyData(t,a)}function IX(e,t){const r={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function jX(e,t){const r={type:"root",children:e.wrap(e.all(t))};return e.patch(t,r),e.applyData(t,r)}function DX(e,t){const r={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function PX(e,t){const r=e.all(t),n=r.shift(),i=[];if(n){const s={type:"element",tagName:"thead",properties:{},children:e.wrap([n],!0)};e.patch(t.children[0],s),i.push(s)}if(r.length>0){const s={type:"element",tagName:"tbody",properties:{},children:e.wrap(r,!0)},o=Mx(t.children[1]),l=ck(t.children[t.children.length-1]);o&&l&&(s.position={start:o,end:l}),i.push(s)}const a={type:"element",tagName:"table",properties:{},children:e.wrap(i,!0)};return e.patch(t,a),e.applyData(t,a)}function MX(e,t,r){const n=r?r.children:void 0,a=(n?n.indexOf(t):1)===0?"th":"td",s=r&&r.type==="table"?r.align:void 0,o=s?s.length:t.children.length;let l=-1;const c=[];for(;++l<o;){const h=t.children[l],m={},d=s?s[l]:void 0;d&&(m.align=d);let g={type:"element",tagName:a,properties:m,children:[]};h&&(g.children=e.all(h),e.patch(h,g),g=e.applyData(h,g)),c.push(g)}const u={type:"element",tagName:"tr",properties:{},children:e.wrap(c,!0)};return e.patch(t,u),e.applyData(t,u)}function LX(e,t){const r={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}const kS=9,RS=32;function BX(e){const t=String(e),r=/\r?\n|\r/g;let n=r.exec(t),i=0;const a=[];for(;n;)a.push(OS(t.slice(i,n.index),i>0,!0),n[0]),i=n.index+n[0].length,n=r.exec(t);return a.push(OS(t.slice(i),i>0,!1)),a.join("")}function OS(e,t,r){let n=0,i=e.length;if(t){let a=e.codePointAt(n);for(;a===kS||a===RS;)n++,a=e.codePointAt(n)}if(r){let a=e.codePointAt(i-1);for(;a===kS||a===RS;)i--,a=e.codePointAt(i-1)}return i>n?e.slice(n,i):""}function UX(e,t){const r={type:"text",value:BX(String(t.value))};return e.patch(t,r),e.applyData(t,r)}function qX(e,t){const r={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,r),e.applyData(t,r)}const zX={blockquote:xX,break:vX,code:yX,delete:wX,emphasis:bX,footnoteReference:_X,heading:SX,html:TX,imageReference:EX,image:NX,inlineCode:AX,linkReference:CX,link:kX,listItem:RX,list:FX,paragraph:IX,root:jX,strong:DX,table:PX,tableCell:LX,tableRow:MX,text:UX,thematicBreak:qX,toml:mc,yaml:mc,definition:mc,footnoteDefinition:mc};function mc(){}const Rk=-1,Yu=0,Lo=1,uu=2,$x=3,Vx=4,Wx=5,Gx=6,Ok=7,Fk=8,FS=typeof self=="object"?self:globalThis,HX=(e,t)=>{const r=(i,a)=>(e.set(a,i),i),n=i=>{if(e.has(i))return e.get(i);const[a,s]=t[i];switch(a){case Yu:case Rk:return r(s,i);case Lo:{const o=r([],i);for(const l of s)o.push(n(l));return o}case uu:{const o=r({},i);for(const[l,c]of s)o[n(l)]=n(c);return o}case $x:return r(new Date(s),i);case Vx:{const{source:o,flags:l}=s;return r(new RegExp(o,l),i)}case Wx:{const o=r(new Map,i);for(const[l,c]of s)o.set(n(l),n(c));return o}case Gx:{const o=r(new Set,i);for(const l of s)o.add(n(l));return o}case Ok:{const{name:o,message:l}=s;return r(new FS[o](l),i)}case Fk:return r(BigInt(s),i);case"BigInt":return r(Object(BigInt(s)),i);case"ArrayBuffer":return r(new Uint8Array(s).buffer,s);case"DataView":{const{buffer:o}=new Uint8Array(s);return r(new DataView(o),s)}}return r(new FS[a](s),i)};return n},IS=e=>HX(new Map,e)(0),ss="",{toString:$X}={},{keys:VX}=Object,vo=e=>{const t=typeof e;if(t!=="object"||!e)return[Yu,t];const r=$X.call(e).slice(8,-1);switch(r){case"Array":return[Lo,ss];case"Object":return[uu,ss];case"Date":return[$x,ss];case"RegExp":return[Vx,ss];case"Map":return[Wx,ss];case"Set":return[Gx,ss];case"DataView":return[Lo,r]}return r.includes("Array")?[Lo,r]:r.includes("Error")?[Ok,r]:[uu,r]},pc=([e,t])=>e===Yu&&(t==="function"||t==="symbol"),WX=(e,t,r,n)=>{const i=(s,o)=>{const l=n.push(s)-1;return r.set(o,l),l},a=s=>{if(r.has(s))return r.get(s);let[o,l]=vo(s);switch(o){case Yu:{let u=s;switch(l){case"bigint":o=Fk,u=s.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+l);u=null;break;case"undefined":return i([Rk],s)}return i([o,u],s)}case Lo:{if(l){let m=s;return l==="DataView"?m=new Uint8Array(s.buffer):l==="ArrayBuffer"&&(m=new Uint8Array(s)),i([l,[...m]],s)}const u=[],h=i([o,u],s);for(const m of s)u.push(a(m));return h}case uu:{if(l)switch(l){case"BigInt":return i([l,s.toString()],s);case"Boolean":case"Number":case"String":return i([l,s.valueOf()],s)}if(t&&"toJSON"in s)return a(s.toJSON());const u=[],h=i([o,u],s);for(const m of VX(s))(e||!pc(vo(s[m])))&&u.push([a(m),a(s[m])]);return h}case $x:return i([o,s.toISOString()],s);case Vx:{const{source:u,flags:h}=s;return i([o,{source:u,flags:h}],s)}case Wx:{const u=[],h=i([o,u],s);for(const[m,d]of s)(e||!(pc(vo(m))||pc(vo(d))))&&u.push([a(m),a(d)]);return h}case Gx:{const u=[],h=i([o,u],s);for(const m of s)(e||!pc(vo(m)))&&u.push(a(m));return h}}const{message:c}=s;return i([o,{name:l,message:c}],s)};return a},jS=(e,{json:t,lossy:r}={})=>{const n=[];return WX(!(t||r),!!t,new Map,n)(e),n},fu=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?IS(jS(e,t)):structuredClone(e):(e,t)=>IS(jS(e,t));function GX(e,t){const r=[{type:"text",value:"â†©"}];return t>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),r}function YX(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function XX(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=e.options.footnoteBackContent||GX,n=e.options.footnoteBackLabel||YX,i=e.options.footnoteLabel||"Footnotes",a=e.options.footnoteLabelTagName||"h2",s=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let l=-1;for(;++l<e.footnoteOrder.length;){const c=e.footnoteById.get(e.footnoteOrder[l]);if(!c)continue;const u=e.all(c),h=String(c.identifier).toUpperCase(),m=Zs(h.toLowerCase());let d=0;const g=[],p=e.footnoteCounts.get(h);for(;p!==void 0&&++d<=p;){g.length>0&&g.push({type:"text",value:" "});let b=typeof r=="string"?r:r(l,d);typeof b=="string"&&(b={type:"text",value:b}),g.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+m+(d>1?"-"+d:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(l,d),className:["data-footnote-backref"]},children:Array.isArray(b)?b:[b]})}const x=u[u.length-1];if(x&&x.type==="element"&&x.tagName==="p"){const b=x.children[x.children.length-1];b&&b.type==="text"?b.value+=" ":x.children.push({type:"text",value:" "}),x.children.push(...g)}else u.push(...g);const v={type:"element",tagName:"li",properties:{id:t+"fn-"+m},children:e.wrap(u,!0)};e.patch(c,v),o.push(v)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:a,properties:ce(q({},fu(s)),{id:"footnote-label"}),children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const Ik=(function(e){if(e==null)return JX;if(typeof e=="function")return Xu(e);if(typeof e=="object")return Array.isArray(e)?KX(e):QX(e);if(typeof e=="string")return ZX(e);throw new Error("Expected function, string, or object as test")});function KX(e){const t=[];let r=-1;for(;++r<e.length;)t[r]=Ik(e[r]);return Xu(n);function n(...i){let a=-1;for(;++a<t.length;)if(t[a].apply(this,i))return!0;return!1}}function QX(e){const t=e;return Xu(r);function r(n){const i=n;let a;for(a in e)if(i[a]!==t[a])return!1;return!0}}function ZX(e){return Xu(t);function t(r){return r&&r.type===e}}function Xu(e){return t;function t(r,n,i){return!!(eK(r)&&e.call(this,r,typeof n=="number"?n:void 0,i||void 0))}}function JX(){return!0}function eK(e){return e!==null&&typeof e=="object"&&"type"in e}const jk=[],tK=!0,DS=!1,rK="skip";function nK(e,t,r,n){let i;typeof t=="function"&&typeof r!="function"?(n=r,r=t):i=t;const a=Ik(i),s=n?-1:1;o(e,void 0,[])();function o(l,c,u){const h=l&&typeof l=="object"?l:{};if(typeof h.type=="string"){const d=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(m,"name",{value:"node ("+(l.type+(d?"<"+d+">":""))+")"})}return m;function m(){let d=jk,g,p,x;if((!t||a(l,c,u[u.length-1]||void 0))&&(d=iK(r(l,u)),d[0]===DS))return d;if("children"in l&&l.children){const v=l;if(v.children&&d[0]!==rK)for(p=(n?v.children.length:-1)+s,x=u.concat(v);p>-1&&p<v.children.length;){const b=v.children[p];if(g=o(b,p,x)(),g[0]===DS)return g;p=typeof g[1]=="number"?g[1]:p+s}}return d}}}function iK(e){return Array.isArray(e)?e:typeof e=="number"?[tK,e]:e==null?jk:[e]}function aK(e,t,r,n){let i,a,s;typeof t=="function"&&typeof r!="function"?(a=void 0,s=t,i=r):(a=t,s=r,i=n),nK(e,a,o,i);function o(l,c){const u=c[c.length-1],h=u?u.children.indexOf(l):void 0;return s(l,h,u)}}const Up={}.hasOwnProperty,sK={};function oK(e,t){const r=t||sK,n=new Map,i=new Map,a=new Map,s=q(q({},zX),r.handlers),o={all:c,applyData:cK,definitionById:n,footnoteById:i,footnoteCounts:a,footnoteOrder:[],handlers:s,one:l,options:r,patch:lK,wrap:fK};return aK(e,function(u){if(u.type==="definition"||u.type==="footnoteDefinition"){const h=u.type==="definition"?n:i,m=String(u.identifier).toUpperCase();h.has(m)||h.set(m,u)}}),o;function l(u,h){const m=u.type,d=o.handlers[m];if(Up.call(o.handlers,m)&&d)return d(o,u,h);if(o.options.passThrough&&o.options.passThrough.includes(m)){if("children"in u){const p=u,{children:x}=p,v=we(p,["children"]),b=fu(v);return b.children=o.all(u),b}return fu(u)}return(o.options.unknownHandler||uK)(o,u,h)}function c(u){const h=[];if("children"in u){const m=u.children;let d=-1;for(;++d<m.length;){const g=o.one(m[d],u);if(g){if(d&&m[d-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=PS(g.value)),!Array.isArray(g)&&g.type==="element")){const p=g.children[0];p&&p.type==="text"&&(p.value=PS(p.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function lK(e,t){e.position&&(t.position=WW(e))}function cK(e,t){let r=t;if(e&&e.data){const n=e.data.hName,i=e.data.hChildren,a=e.data.hProperties;if(typeof n=="string")if(r.type==="element")r.tagName=n;else{const s="children"in r?r.children:[r];r={type:"element",tagName:n,properties:{},children:s}}r.type==="element"&&a&&Object.assign(r.properties,fu(a)),"children"in r&&r.children&&i!==null&&i!==void 0&&(r.children=i)}return r}function uK(e,t){const r=t.data||{},n="value"in t&&!(Up.call(r,"hProperties")||Up.call(r,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function fK(e,t){const r=[];let n=-1;for(t&&r.push({type:"text",value:`
`});++n<e.length;)n&&r.push({type:"text",value:`
`}),r.push(e[n]);return t&&e.length>0&&r.push({type:"text",value:`
`}),r}function PS(e){let t=0,r=e.charCodeAt(t);for(;r===9||r===32;)t++,r=e.charCodeAt(t);return e.slice(t)}function MS(e,t){const r=oK(e,t),n=r.one(e,void 0),i=XX(r),a=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return i&&a.children.push({type:"text",value:`
`},i),a}function HJ(e,t){return e&&"run"in e?function(r,n){return lt(this,null,function*(){const i=MS(r,q({file:n},t));yield e.run(i,n)})}:function(r,n){return MS(r,q({file:n},e||t))}}function LS(e){if(e)throw e}var Mm,BS;function hK(){if(BS)return Mm;BS=1;var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,r=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=function(c){return typeof Array.isArray=="function"?Array.isArray(c):t.call(c)==="[object Array]"},a=function(c){if(!c||t.call(c)!=="[object Object]")return!1;var u=e.call(c,"constructor"),h=c.constructor&&c.constructor.prototype&&e.call(c.constructor.prototype,"isPrototypeOf");if(c.constructor&&!u&&!h)return!1;var m;for(m in c);return typeof m=="undefined"||e.call(c,m)},s=function(c,u){r&&u.name==="__proto__"?r(c,u.name,{enumerable:!0,configurable:!0,value:u.newValue,writable:!0}):c[u.name]=u.newValue},o=function(c,u){if(u==="__proto__")if(e.call(c,u)){if(n)return n(c,u).value}else return;return c[u]};return Mm=function l(){var c,u,h,m,d,g,p=arguments[0],x=1,v=arguments.length,b=!1;for(typeof p=="boolean"&&(b=p,p=arguments[1]||{},x=2),(p==null||typeof p!="object"&&typeof p!="function")&&(p={});x<v;++x)if(c=arguments[x],c!=null)for(u in c)h=o(p,u),m=o(c,u),p!==m&&(b&&m&&(a(m)||(d=i(m)))?(d?(d=!1,g=h&&i(h)?h:[]):g=h&&a(h)?h:{},s(p,{name:u,newValue:l(b,g,m)})):typeof m!="undefined"&&s(p,{name:u,newValue:m}));return p},Mm}var dK=hK();const Lm=Xe(dK);function qp(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function mK(){const e=[],t={run:r,use:n};return t;function r(...i){let a=-1;const s=i.pop();if(typeof s!="function")throw new TypeError("Expected function as last argument, not "+s);o(null,...i);function o(l,...c){const u=e[++a];let h=-1;if(l){s(l);return}for(;++h<i.length;)(c[h]===null||c[h]===void 0)&&(c[h]=i[h]);i=c,u?pK(u,o)(...c):s(null,...c)}}function n(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return e.push(i),t}}function pK(e,t){let r;return n;function n(...s){const o=e.length>s.length;let l;o&&s.push(i);try{l=e.apply(this,s)}catch(c){const u=c;if(o&&r)throw u;return i(u)}o||(l&&l.then&&typeof l.then=="function"?l.then(a,i):l instanceof Error?i(l):a(l))}function i(s,...o){r||(r=!0,t(s,...o))}function a(s){i(null,s)}}const Dn={basename:gK,dirname:xK,extname:vK,join:yK,sep:"/"};function gK(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Il(e);let r=0,n=-1,i=e.length,a;if(t===void 0||t.length===0||t.length>e.length){for(;i--;)if(e.codePointAt(i)===47){if(a){r=i+1;break}}else n<0&&(a=!0,n=i+1);return n<0?"":e.slice(r,n)}if(t===e)return"";let s=-1,o=t.length-1;for(;i--;)if(e.codePointAt(i)===47){if(a){r=i+1;break}}else s<0&&(a=!0,s=i+1),o>-1&&(e.codePointAt(i)===t.codePointAt(o--)?o<0&&(n=i):(o=-1,n=s));return r===n?n=s:n<0&&(n=e.length),e.slice(r,n)}function xK(e){if(Il(e),e.length===0)return".";let t=-1,r=e.length,n;for(;--r;)if(e.codePointAt(r)===47){if(n){t=r;break}}else n||(n=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function vK(e){Il(e);let t=e.length,r=-1,n=0,i=-1,a=0,s;for(;t--;){const o=e.codePointAt(t);if(o===47){if(s){n=t+1;break}continue}r<0&&(s=!0,r=t+1),o===46?i<0?i=t:a!==1&&(a=1):i>-1&&(a=-1)}return i<0||r<0||a===0||a===1&&i===r-1&&i===n+1?"":e.slice(i,r)}function yK(...e){let t=-1,r;for(;++t<e.length;)Il(e[t]),e[t]&&(r=r===void 0?e[t]:r+"/"+e[t]);return r===void 0?".":wK(r)}function wK(e){Il(e);const t=e.codePointAt(0)===47;let r=bK(e,!t);return r.length===0&&!t&&(r="."),r.length>0&&e.codePointAt(e.length-1)===47&&(r+="/"),t?"/"+r:r}function bK(e,t){let r="",n=0,i=-1,a=0,s=-1,o,l;for(;++s<=e.length;){if(s<e.length)o=e.codePointAt(s);else{if(o===47)break;o=47}if(o===47){if(!(i===s-1||a===1))if(i!==s-1&&a===2){if(r.length<2||n!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(l=r.lastIndexOf("/"),l!==r.length-1){l<0?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),i=s,a=0;continue}}else if(r.length>0){r="",n=0,i=s,a=0;continue}}t&&(r=r.length>0?r+"/..":"..",n=2)}else r.length>0?r+="/"+e.slice(i+1,s):r=e.slice(i+1,s),n=s-i-1;i=s,a=0}else o===46&&a>-1?a++:a=-1}return r}function Il(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const _K={cwd:SK};function SK(){return"/"}function zp(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function TK(e){if(typeof e=="string")e=new URL(e);else if(!zp(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return EK(e)}function EK(e){if(e.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const t=e.pathname;let r=-1;for(;++r<t.length;)if(t.codePointAt(r)===37&&t.codePointAt(r+1)===50){const n=t.codePointAt(r+2);if(n===70||n===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(t)}const Bm=["history","path","basename","stem","extname","dirname"];class NK{constructor(t){let r;t?zp(t)?r={path:t}:typeof t=="string"||AK(t)?r={value:t}:r=t:r={},this.cwd="cwd"in r?"":_K.cwd(),this.data={},this.history=[],this.messages=[];let n=-1;for(;++n<Bm.length;){const a=Bm[n];a in r&&r[a]!==void 0&&r[a]!==null&&(this[a]=a==="history"?[...r[a]]:r[a])}let i;for(i in r)Bm.includes(i)||(this[i]=r[i])}get basename(){return typeof this.path=="string"?Dn.basename(this.path):void 0}set basename(t){qm(t,"basename"),Um(t,"basename"),this.path=Dn.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Dn.dirname(this.path):void 0}set dirname(t){US(this.basename,"dirname"),this.path=Dn.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Dn.extname(this.path):void 0}set extname(t){if(Um(t,"extname"),US(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Dn.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){zp(t)&&(t=TK(t)),qm(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Dn.basename(this.path,this.extname):void 0}set stem(t){qm(t,"stem"),Um(t,"stem"),this.path=Dn.join(this.dirname||"",t+(this.extname||""))}fail(t,r,n){const i=this.message(t,r,n);throw i.fatal=!0,i}info(t,r,n){const i=this.message(t,r,n);return i.fatal=void 0,i}message(t,r,n){const i=new dr(t,r,n);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function Um(e,t){if(e&&e.includes(Dn.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Dn.sep+"`")}function qm(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function US(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function AK(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const CK=(function(e){const n=this.constructor.prototype,i=n[e],a=function(){return i.apply(a,arguments)};return Object.setPrototypeOf(a,n),a}),kK={}.hasOwnProperty;class Yx extends CK{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=mK()}copy(){const t=new Yx;let r=-1;for(;++r<this.attachers.length;){const n=this.attachers[r];t.use(...n)}return t.data(Lm(!0,{},this.namespace)),t}data(t,r){return typeof t=="string"?arguments.length===2?($m("data",this.frozen),this.namespace[t]=r,this):kK.call(this.namespace,t)&&this.namespace[t]||void 0:t?($m("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const i=r.call(t,...n);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const r=gc(t),n=this.parser||this.Parser;return zm("parse",n),n(String(r),r)}process(t,r){const n=this;return this.freeze(),zm("process",this.parser||this.Parser),Hm("process",this.compiler||this.Compiler),r?i(void 0,r):new Promise(i);function i(a,s){const o=gc(t),l=n.parse(o);n.run(l,o,function(u,h,m){if(u||!h||!m)return c(u);const d=h,g=n.stringify(d,m);OK(g)?m.value=g:m.result=g,c(u,m)});function c(u,h){u||!h?s(u):a?a(h):r(void 0,h)}}}processSync(t){let r=!1,n;return this.freeze(),zm("processSync",this.parser||this.Parser),Hm("processSync",this.compiler||this.Compiler),this.process(t,i),zS("processSync","process",r),n;function i(a,s){r=!0,LS(a),n=s}}run(t,r,n){qS(t),this.freeze();const i=this.transformers;return!n&&typeof r=="function"&&(n=r,r=void 0),n?a(void 0,n):new Promise(a);function a(s,o){const l=gc(r);i.run(t,l,c);function c(u,h,m){const d=h||t;u?o(u):s?s(d):n(void 0,d,m)}}}runSync(t,r){let n=!1,i;return this.run(t,r,a),zS("runSync","run",n),i;function a(s,o){LS(s),i=o,n=!0}}stringify(t,r){this.freeze();const n=gc(r),i=this.compiler||this.Compiler;return Hm("stringify",i),qS(t),i(t,n)}use(t,...r){const n=this.attachers,i=this.namespace;if($m("use",this.frozen),t!=null)if(typeof t=="function")l(t,r);else if(typeof t=="object")Array.isArray(t)?o(t):s(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function a(c){if(typeof c=="function")l(c,[]);else if(typeof c=="object")if(Array.isArray(c)){const[u,...h]=c;l(u,h)}else s(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function s(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(c.plugins),c.settings&&(i.settings=Lm(!0,i.settings,c.settings))}function o(c){let u=-1;if(c!=null)if(Array.isArray(c))for(;++u<c.length;){const h=c[u];a(h)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function l(c,u){let h=-1,m=-1;for(;++h<n.length;)if(n[h][0]===c){m=h;break}if(m===-1)n.push([c,...u]);else if(u.length>0){let[d,...g]=u;const p=n[m][1];qp(p)&&qp(d)&&(d=Lm(!0,p,d)),n[m]=[c,d,...g]}}}}const $J=new Yx().freeze();function zm(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function Hm(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function $m(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function qS(e){if(!qp(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function zS(e,t,r){if(!r)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function gc(e){return RK(e)?e:new NK(e)}function RK(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function OK(e){return typeof e=="string"||FK(e)}function FK(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}function VJ({feedback:e,isOpen:t,onClose:r,onDelete:n,isAdmin:i=!1}){const{toast:a}=mu(),[s,o]=H.useState(""),[l,c]=H.useState(!1),[u,h]=H.useState(e),[m,d]=H.useState(!1),[g,p]=H.useState(null),[x,v]=H.useState(0),b=H.useRef(null);if(H.useEffect(()=>{if(h(e),p(null),!t||!(e!=null&&e.id))return;let E=!1;return lt(null,null,function*(){try{d(!0);const R=yield fetch(`/api/monthly-feedback/${e.id}`);if(!R.ok)throw R.status===404?new Error("This feedback report was not found. It may have been deleted."):R.status===500?new Error("Server error occurred while loading the report."):new Error(`Unable to load report (Error ${R.status})`);const C=yield R.json();E||h(C)}catch(R){console.error("Failed to load feedback details:",R),E||p(R instanceof Error?R.message:"We could not load this report right now.")}finally{E||d(!1)}}),()=>{E=!0}},[t,e==null?void 0:e.id,x]),!e)return null;const y=u!=null?u:e,w={id:y.id||0,school:y.school||"Unknown School",month:y.month||"Unknown Month",year:y.year||new Date().getFullYear(),pdfUrl:y.pdfUrl||"",pdfFileName:y.pdfFileName||"document.pdf",extractedText:y.extractedText||null,notes:y.notes||null,uploadedBy:y.uploadedBy||null,fileSize:y.fileSize||null,createdAt:y.createdAt||new Date().toISOString()};H.useEffect(()=>{var C;if(!t)return;const E=j=>{j.key==="Escape"&&r()},A=(C=b.current)==null?void 0:C.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),R=A==null?void 0:A[0];return R&&R.focus(),document.addEventListener("keydown",E),()=>document.removeEventListener("keydown",E)},[t,r]);const k=()=>{const E=document.createElement("a");E.href=w.pdfUrl,E.download=w.pdfFileName,document.body.appendChild(E),E.click(),document.body.removeChild(E),a({title:"Download Started",description:"PDF download has started."})},T=()=>lt(null,null,function*(){c(!0);try{if((yield fetch(`/api/monthly-feedback/${w.id}/notes`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:s})})).ok)a({title:"Notes Saved",description:"Your notes have been saved successfully."});else throw new Error("Failed to save notes")}catch(E){a({variant:"destructive",title:"Save Failed",description:"Failed to save notes. Please try again."})}finally{c(!1)}}),S=()=>{n&&confirm(`Are you sure you want to delete feedback for ${w.month} ${w.year}?`)&&n(w.id)};return f.jsx(_u,{open:t,onOpenChange:r,children:f.jsxs(pl,{ref:b,className:"w-[70vw] h-[70vh] max-w-6xl overflow-hidden flex flex-col",children:[f.jsxs(gl,{className:"flex-shrink-0",children:[f.jsxs(xl,{className:"flex items-center justify-between text-xl",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wi,{className:"w-5 h-5"}),w.month," ",w.year," - ",w.school]}),f.jsx(ht,{children:w.school})]}),f.jsx(vl,{children:f.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(cr,{className:"w-4 h-4"}),new Date(w.createdAt).toLocaleDateString()]}),w.uploadedBy&&f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Mi,{className:"w-4 h-4"}),w.uploadedBy]}),w.fileSize&&f.jsxs("span",{children:["Size: ",(w.fileSize/1024/1024).toFixed(2)," MB"]})]})})]}),f.jsx(WE,{}),f.jsxs("div",{className:"flex-1 overflow-hidden",children:[m&&f.jsx("div",{className:"p-6 text-sm text-muted-foreground",children:"Loading detailsâ€¦"}),!m&&g&&f.jsx("div",{className:"p-6",children:f.jsxs("div",{className:"border rounded-md p-4 bg-muted/50",children:[f.jsx("p",{className:"text-sm text-destructive",children:g}),f.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"You can try again or download the original PDF if available."}),f.jsxs("div",{className:"mt-4 flex gap-2",children:[f.jsx(Le,{onClick:()=>{p(null),v(E=>E+1)},variant:"outline",children:"Retry"}),f.jsx(Le,{onClick:r,variant:"outline",children:"Back to Feedback Reports"}),w.pdfUrl&&f.jsxs(Le,{onClick:k,children:[f.jsx(Oa,{className:"w-4 h-4 mr-2"}),"Download PDF"]})]})]})}),!m&&!g&&f.jsxs(zI,{defaultValue:"content",className:"w-full h-full flex flex-col",children:[f.jsxs(GE,{className:"grid w-full grid-cols-2 flex-shrink-0",children:[f.jsx(np,{value:"content",children:"Extracted Content"}),f.jsx(np,{value:"notes",children:"Notes"})]}),f.jsx(ip,{value:"content",className:"flex-1 overflow-y-auto space-y-4",children:f.jsx("div",{className:"border rounded-lg p-4 bg-muted/50",children:w.extractedText?f.jsx("div",{className:"prose prose-sm max-w-none",children:f.jsx(LR,{children:w.extractedText})}):f.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Text could not be extracted â€“ download the PDF to view."})})}),f.jsxs(ip,{value:"notes",className:"flex-1 overflow-y-auto space-y-4",children:[f.jsx(mg,{value:s||w.notes||"",onChange:E=>o(E.target.value),placeholder:"Add notes about this feedback...",rows:10,maxLength:5e3}),f.jsx(Le,{onClick:T,disabled:l,children:l?f.jsx(f.Fragment,{children:"Saving..."}):f.jsxs(f.Fragment,{children:[f.jsx(DT,{className:"w-4 h-4 mr-2"}),"Save Notes"]})})]})]})]}),f.jsxs(VE,{className:"flex justify-between",children:[f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsxs(Le,{onClick:k,variant:"outline",children:[f.jsx(Oa,{className:"w-4 h-4 mr-2"}),"Download PDF"]}),w.fileSize&&f.jsxs("p",{className:"text-xs text-muted-foreground",children:["Download original PDF â€“ ",(w.fileSize/1024/1024).toFixed(2)," MB"]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[i&&n&&f.jsxs(Le,{onClick:S,variant:"destructive",children:[f.jsx(BR,{className:"w-4 h-4 mr-2"}),"Delete"]}),f.jsx(Le,{onClick:r,children:"Close"})]})]})]})})}function WJ({school:e,score:t,complianceStatus:r,dateRange:n,compact:i=!1}){const a=t.overallScore/5*100,s=c=>c>=4?"text-green-700":c>=3?"text-green-600":c>=2?"text-yellow-600":"text-red-600",o=c=>c>=4?"bg-green-600":c>=3?"bg-green-500":c>=2?"bg-yellow-500":"bg-red-500",l=c=>{switch(c){case"green":return"default";case"yellow":return"secondary";case"red":return"destructive";default:return"outline"}};return i?f.jsxs(Fe,{className:"hover:shadow-md transition-shadow",children:[f.jsxs(ze,{className:"pb-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(He,{className:"text-lg",children:e}),f.jsxs(ht,{variant:l(r.color),children:[t.level2Compliant?f.jsx(En,{className:"w-3 h-3 mr-1"}):f.jsx(_r,{className:"w-3 h-3 mr-1"}),r.text]})]}),n&&f.jsxs(nt,{className:"text-xs",children:[n.start," to ",n.end]})]}),f.jsx(je,{children:f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-2xl font-bold",style:{color:s(t.overallScore)},children:t.overallScore.toFixed(2)}),f.jsx("span",{className:"text-sm text-muted-foreground",children:"/ 5.0"})]}),f.jsx(Do,{value:a,className:o(t.overallScore)}),f.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-muted-foreground",children:"Inspections"}),f.jsx("div",{className:"font-semibold",children:t.inspectionCount})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-muted-foreground",children:"Notes"}),f.jsx("div",{className:"font-semibold",children:t.notesCount})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-muted-foreground",children:"Avg Rating"}),f.jsx("div",{className:"font-semibold",children:t.inspectionScore.toFixed(1)})]})]})]})})]}):f.jsxs(Fe,{className:"hover:shadow-lg transition-shadow",children:[f.jsx(ze,{children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx(He,{className:"text-2xl",children:e}),n&&f.jsxs(nt,{children:["Period: ",n.start," to ",n.end]})]}),f.jsxs(ht,{variant:l(r.color),className:"text-sm px-3 py-1",children:[t.level2Compliant?f.jsx(En,{className:"w-4 h-4 mr-1"}):f.jsx(_r,{className:"w-4 h-4 mr-1"}),r.text]})]})}),f.jsxs(je,{className:"space-y-6",children:[f.jsxs("div",{className:"text-center space-y-2",children:[f.jsx("div",{className:"text-6xl font-bold",style:{color:s(t.overallScore)},children:t.overallScore.toFixed(2)}),f.jsx("div",{className:"text-sm text-muted-foreground",children:"Overall Building Score (out of 5.0)"}),f.jsx(Do,{value:a,className:`h-3 ${o(t.overallScore)}`})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Inspection Average"}),f.jsx("div",{className:"text-2xl font-bold",children:t.inspectionScore.toFixed(2)}),f.jsxs("div",{className:"text-xs text-muted-foreground",children:["75% weight â€¢ ",t.inspectionCount," inspections"]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Notes Impact"}),f.jsxs("div",{className:"text-2xl font-bold flex items-center gap-1",children:[t.notesModifier>0?f.jsx(Ms,{className:"w-5 h-5 text-green-600"}):t.notesModifier<0?f.jsx(og,{className:"w-5 h-5 text-red-600"}):null,t.notesModifier>0?"+":"",t.notesModifier.toFixed(2)]}),f.jsxs("div",{className:"text-xs text-muted-foreground",children:["25% weight â€¢ ",t.notesCount," notes"]})]})]}),t.categoryBreakdown&&t.categoryBreakdown.length>0&&f.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[f.jsx("div",{className:"text-sm font-medium",children:"Category Breakdown"}),f.jsx("div",{className:"space-y-2",children:t.categoryBreakdown.filter(c=>c.count>0).sort((c,u)=>u.averageRating-c.averageRating).slice(0,5).map(c=>f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm",children:c.category}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Do,{value:c.averageRating/5*100,className:"w-24 h-2"}),f.jsx("span",{className:"text-sm font-semibold w-12 text-right",children:c.averageRating.toFixed(1)})]})]},c.category))}),t.categoryBreakdown.filter(c=>c.count>0).length>5&&f.jsx("div",{className:"text-xs text-muted-foreground text-center",children:"Showing top 5 categories"})]}),f.jsx("div",{className:`p-3 rounded-lg border ${t.level2Compliant?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"}`,children:f.jsxs("div",{className:"flex items-center gap-2",children:[t.level2Compliant?f.jsx(En,{className:"w-5 h-5 text-green-600"}):f.jsx(_r,{className:"w-5 h-5 text-yellow-600"}),f.jsx("div",{className:"text-sm",children:t.level2Compliant?f.jsx("span",{className:"font-semibold text-green-800",children:"Meets Level 2 Standards (â‰¥3.0)"}):f.jsx("span",{className:"font-semibold text-yellow-800",children:"Below Level 2 Standards (target: â‰¥3.0)"})})]})})]})]})}function HS(e,t,r,n,i,a,s){try{var o=e[a](s),l=o.value}catch(c){return void r(c)}o.done?t(l):Promise.resolve(l).then(n,i)}function vi(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function s(l){HS(a,n,i,s,o,"next",l)}function o(l){HS(a,n,i,s,o,"throw",l)}s(void 0)})}}function IK(e,t){if(sl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(sl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jK(e){var t=IK(e,"string");return sl(t)=="symbol"?t:t+""}function Xx(e,t,r){return(t=jK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var yo={exports:{}},pa={exports:{}},DK=pa.exports,$S;function PK(){return $S||($S=1,(function(){var e,t,r,n,i,a;typeof performance!="undefined"&&performance!==null&&performance.now?pa.exports=function(){return performance.now()}:typeof process!="undefined"&&process!==null&&process.hrtime?(pa.exports=function(){return(e()-i)/1e6},t=process.hrtime,e=function(){var s;return s=t(),s[0]*1e9+s[1]},n=e(),a=process.uptime()*1e9,i=n-a):Date.now?(pa.exports=function(){return Date.now()-r},r=Date.now()):(pa.exports=function(){return new Date().getTime()-r},r=new Date().getTime())}).call(DK)),pa.exports}var VS;function MK(){if(VS)return yo.exports;VS=1;for(var e=PK(),t=typeof window=="undefined"?_o:window,r=["moz","webkit"],n="AnimationFrame",i=t["request"+n],a=t["cancel"+n]||t["cancelRequest"+n],s=0;!i&&s<r.length;s++)i=t[r[s]+"Request"+n],a=t[r[s]+"Cancel"+n]||t[r[s]+"CancelRequest"+n];if(!i||!a){var o=0,l=0,c=[],u=1e3/60;i=function(h){if(c.length===0){var m=e(),d=Math.max(0,u-(m-o));o=d+m,setTimeout(function(){var g=c.slice(0);c.length=0;for(var p=0;p<g.length;p++)if(!g[p].cancelled)try{g[p].callback(o)}catch(x){setTimeout(function(){throw x},0)}},Math.round(d))}return c.push({handle:++l,callback:h,cancelled:!1}),l},a=function(h){for(var m=0;m<c.length;m++)c[m].handle===h&&(c[m].cancelled=!0)}}return yo.exports=function(h){return i.call(t,h)},yo.exports.cancel=function(){a.apply(t,arguments)},yo.exports.polyfill=function(h){h||(h=t),h.requestAnimationFrame=i,h.cancelAnimationFrame=a},yo.exports}var LK=MK();const Vm=Xe(LK);var Wm,WS;function BK(){return WS||(WS=1,Wm=function(e){this.ok=!1,this.alpha=1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};e=t[e]||e;for(var r=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3]),parseFloat(l[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,s=i.exec(e);if(s){var o=a(s);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u},this.getHelpXML=function(){for(var l=new Array,c=0;c<r.length;c++)for(var u=r[c].example,h=0;h<u.length;h++)l[l.length]=u[h];for(var m in t)l[l.length]=m;var d=document.createElement("ul");d.setAttribute("id","rgbcolor-examples");for(var c=0;c<l.length;c++)try{var g=document.createElement("li"),p=new RGBColor(l[c]),x=document.createElement("div");x.style.cssText="margin: 3px; border: 1px solid black; background:"+p.toHex()+"; color:"+p.toHex(),x.appendChild(document.createTextNode("test"));var v=document.createTextNode(" "+l[c]+" -> "+p.toRGB()+" -> "+p.toHex());g.appendChild(x),g.appendChild(v),d.appendChild(g)}catch(y){}return d}}),Wm}var UK=BK();const Hp=Xe(UK);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Dk=function(e,t){return(Dk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])})(e,t)};function Pk(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Dk(e,t),e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function qK(e){var t="";Array.isArray(e)||(e=[e]);for(var r=0;r<e.length;r++){var n=e[r];if(n.type===ue.CLOSE_PATH)t+="z";else if(n.type===ue.HORIZ_LINE_TO)t+=(n.relative?"h":"H")+n.x;else if(n.type===ue.VERT_LINE_TO)t+=(n.relative?"v":"V")+n.y;else if(n.type===ue.MOVE_TO)t+=(n.relative?"m":"M")+n.x+" "+n.y;else if(n.type===ue.LINE_TO)t+=(n.relative?"l":"L")+n.x+" "+n.y;else if(n.type===ue.CURVE_TO)t+=(n.relative?"c":"C")+n.x1+" "+n.y1+" "+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===ue.SMOOTH_CURVE_TO)t+=(n.relative?"s":"S")+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===ue.QUAD_TO)t+=(n.relative?"q":"Q")+n.x1+" "+n.y1+" "+n.x+" "+n.y;else if(n.type===ue.SMOOTH_QUAD_TO)t+=(n.relative?"t":"T")+n.x+" "+n.y;else{if(n.type!==ue.ARC)throw new Error('Unexpected command type "'+n.type+'" at index '+r+".");t+=(n.relative?"a":"A")+n.rX+" "+n.rY+" "+n.xRot+" "+ +n.lArcFlag+" "+ +n.sweepFlag+" "+n.x+" "+n.y}}return t}function $p(e,t){var r=e[0],n=e[1];return[r*Math.cos(t)-n*Math.sin(t),r*Math.sin(t)+n*Math.cos(t)]}function xn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0;r<e.length;r++)if(typeof e[r]!="number")throw new Error("assertNumbers arguments["+r+"] is not a number. "+typeof e[r]+" == typeof "+e[r]);return!0}var Oi=Math.PI;function Gm(e,t,r){e.lArcFlag=e.lArcFlag===0?0:1,e.sweepFlag=e.sweepFlag===0?0:1;var n=e.rX,i=e.rY,a=e.x,s=e.y;n=Math.abs(e.rX),i=Math.abs(e.rY);var o=$p([(t-a)/2,(r-s)/2],-e.xRot/180*Oi),l=o[0],c=o[1],u=Math.pow(l,2)/Math.pow(n,2)+Math.pow(c,2)/Math.pow(i,2);1<u&&(n*=Math.sqrt(u),i*=Math.sqrt(u)),e.rX=n,e.rY=i;var h=Math.pow(n,2)*Math.pow(c,2)+Math.pow(i,2)*Math.pow(l,2),m=(e.lArcFlag!==e.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(n,2)*Math.pow(i,2)-h)/h)),d=n*c/i*m,g=-i*l/n*m,p=$p([d,g],e.xRot/180*Oi);e.cX=p[0]+(t+a)/2,e.cY=p[1]+(r+s)/2,e.phi1=Math.atan2((c-g)/i,(l-d)/n),e.phi2=Math.atan2((-c-g)/i,(-l-d)/n),e.sweepFlag===0&&e.phi2>e.phi1&&(e.phi2-=2*Oi),e.sweepFlag===1&&e.phi2<e.phi1&&(e.phi2+=2*Oi),e.phi1*=180/Oi,e.phi2*=180/Oi}function GS(e,t,r){xn(e,t,r);var n=e*e+t*t-r*r;if(0>n)return[];if(n===0)return[[e*r/(e*e+t*t),t*r/(e*e+t*t)]];var i=Math.sqrt(n);return[[(e*r+t*i)/(e*e+t*t),(t*r-e*i)/(e*e+t*t)],[(e*r-t*i)/(e*e+t*t),(t*r+e*i)/(e*e+t*t)]]}var jt,ti=Math.PI/180;function YS(e,t,r){return(1-r)*e+r*t}function XS(e,t,r,n){return e+Math.cos(n/180*Oi)*t+Math.sin(n/180*Oi)*r}function KS(e,t,r,n){var i=1e-6,a=t-e,s=r-t,o=3*a+3*(n-r)-6*s,l=6*(s-a),c=3*a;return Math.abs(o)<i?[-c/l]:(function(u,h,m){var d=u*u/4-h;if(d<-m)return[];if(d<=m)return[-u/2];var g=Math.sqrt(d);return[-u/2-g,-u/2+g]})(l/o,c/o,i)}function QS(e,t,r,n,i){var a=1-i;return e*(a*a*a)+t*(3*a*a*i)+r*(3*a*i*i)+n*(i*i*i)}(function(e){function t(){return i((function(o,l,c){return o.relative&&(o.x1!==void 0&&(o.x1+=l),o.y1!==void 0&&(o.y1+=c),o.x2!==void 0&&(o.x2+=l),o.y2!==void 0&&(o.y2+=c),o.x!==void 0&&(o.x+=l),o.y!==void 0&&(o.y+=c),o.relative=!1),o}))}function r(){var o=NaN,l=NaN,c=NaN,u=NaN;return i((function(h,m,d){return h.type&ue.SMOOTH_CURVE_TO&&(h.type=ue.CURVE_TO,o=isNaN(o)?m:o,l=isNaN(l)?d:l,h.x1=h.relative?m-o:2*m-o,h.y1=h.relative?d-l:2*d-l),h.type&ue.CURVE_TO?(o=h.relative?m+h.x2:h.x2,l=h.relative?d+h.y2:h.y2):(o=NaN,l=NaN),h.type&ue.SMOOTH_QUAD_TO&&(h.type=ue.QUAD_TO,c=isNaN(c)?m:c,u=isNaN(u)?d:u,h.x1=h.relative?m-c:2*m-c,h.y1=h.relative?d-u:2*d-u),h.type&ue.QUAD_TO?(c=h.relative?m+h.x1:h.x1,u=h.relative?d+h.y1:h.y1):(c=NaN,u=NaN),h}))}function n(){var o=NaN,l=NaN;return i((function(c,u,h){if(c.type&ue.SMOOTH_QUAD_TO&&(c.type=ue.QUAD_TO,o=isNaN(o)?u:o,l=isNaN(l)?h:l,c.x1=c.relative?u-o:2*u-o,c.y1=c.relative?h-l:2*h-l),c.type&ue.QUAD_TO){o=c.relative?u+c.x1:c.x1,l=c.relative?h+c.y1:c.y1;var m=c.x1,d=c.y1;c.type=ue.CURVE_TO,c.x1=((c.relative?0:u)+2*m)/3,c.y1=((c.relative?0:h)+2*d)/3,c.x2=(c.x+2*m)/3,c.y2=(c.y+2*d)/3}else o=NaN,l=NaN;return c}))}function i(o){var l=0,c=0,u=NaN,h=NaN;return function(m){if(isNaN(u)&&!(m.type&ue.MOVE_TO))throw new Error("path must start with moveto");var d=o(m,l,c,u,h);return m.type&ue.CLOSE_PATH&&(l=u,c=h),m.x!==void 0&&(l=m.relative?l+m.x:m.x),m.y!==void 0&&(c=m.relative?c+m.y:m.y),m.type&ue.MOVE_TO&&(u=l,h=c),d}}function a(o,l,c,u,h,m){return xn(o,l,c,u,h,m),i((function(d,g,p,x){var v=d.x1,b=d.x2,y=d.relative&&!isNaN(x),w=d.x!==void 0?d.x:y?0:g,k=d.y!==void 0?d.y:y?0:p;function T(B){return B*B}d.type&ue.HORIZ_LINE_TO&&l!==0&&(d.type=ue.LINE_TO,d.y=d.relative?0:p),d.type&ue.VERT_LINE_TO&&c!==0&&(d.type=ue.LINE_TO,d.x=d.relative?0:g),d.x!==void 0&&(d.x=d.x*o+k*c+(y?0:h)),d.y!==void 0&&(d.y=w*l+d.y*u+(y?0:m)),d.x1!==void 0&&(d.x1=d.x1*o+d.y1*c+(y?0:h)),d.y1!==void 0&&(d.y1=v*l+d.y1*u+(y?0:m)),d.x2!==void 0&&(d.x2=d.x2*o+d.y2*c+(y?0:h)),d.y2!==void 0&&(d.y2=b*l+d.y2*u+(y?0:m));var S=o*u-l*c;if(d.xRot!==void 0&&(o!==1||l!==0||c!==0||u!==1))if(S===0)delete d.rX,delete d.rY,delete d.xRot,delete d.lArcFlag,delete d.sweepFlag,d.type=ue.LINE_TO;else{var E=d.xRot*Math.PI/180,A=Math.sin(E),R=Math.cos(E),C=1/T(d.rX),j=1/T(d.rY),z=T(R)*C+T(A)*j,G=2*A*R*(C-j),W=T(A)*C+T(R)*j,fe=z*u*u-G*l*u+W*l*l,he=G*(o*u+l*c)-2*(z*c*u+W*o*l),ee=z*c*c-G*o*c+W*o*o,re=(Math.atan2(he,fe-ee)+Math.PI)%Math.PI/2,O=Math.sin(re),ge=Math.cos(re);d.rX=Math.abs(S)/Math.sqrt(fe*T(ge)+he*O*ge+ee*T(O)),d.rY=Math.abs(S)/Math.sqrt(fe*T(O)-he*O*ge+ee*T(ge)),d.xRot=180*re/Math.PI}return d.sweepFlag!==void 0&&0>S&&(d.sweepFlag=+!d.sweepFlag),d}))}function s(){return function(o){var l={};for(var c in o)l[c]=o[c];return l}}e.ROUND=function(o){function l(c){return Math.round(c*o)/o}return o===void 0&&(o=1e13),xn(o),function(c){return c.x1!==void 0&&(c.x1=l(c.x1)),c.y1!==void 0&&(c.y1=l(c.y1)),c.x2!==void 0&&(c.x2=l(c.x2)),c.y2!==void 0&&(c.y2=l(c.y2)),c.x!==void 0&&(c.x=l(c.x)),c.y!==void 0&&(c.y=l(c.y)),c.rX!==void 0&&(c.rX=l(c.rX)),c.rY!==void 0&&(c.rY=l(c.rY)),c}},e.TO_ABS=t,e.TO_REL=function(){return i((function(o,l,c){return o.relative||(o.x1!==void 0&&(o.x1-=l),o.y1!==void 0&&(o.y1-=c),o.x2!==void 0&&(o.x2-=l),o.y2!==void 0&&(o.y2-=c),o.x!==void 0&&(o.x-=l),o.y!==void 0&&(o.y-=c),o.relative=!0),o}))},e.NORMALIZE_HVZ=function(o,l,c){return o===void 0&&(o=!0),l===void 0&&(l=!0),c===void 0&&(c=!0),i((function(u,h,m,d,g){if(isNaN(d)&&!(u.type&ue.MOVE_TO))throw new Error("path must start with moveto");return l&&u.type&ue.HORIZ_LINE_TO&&(u.type=ue.LINE_TO,u.y=u.relative?0:m),c&&u.type&ue.VERT_LINE_TO&&(u.type=ue.LINE_TO,u.x=u.relative?0:h),o&&u.type&ue.CLOSE_PATH&&(u.type=ue.LINE_TO,u.x=u.relative?d-h:d,u.y=u.relative?g-m:g),u.type&ue.ARC&&(u.rX===0||u.rY===0)&&(u.type=ue.LINE_TO,delete u.rX,delete u.rY,delete u.xRot,delete u.lArcFlag,delete u.sweepFlag),u}))},e.NORMALIZE_ST=r,e.QT_TO_C=n,e.INFO=i,e.SANITIZE=function(o){o===void 0&&(o=0),xn(o);var l=NaN,c=NaN,u=NaN,h=NaN;return i((function(m,d,g,p,x){var v=Math.abs,b=!1,y=0,w=0;if(m.type&ue.SMOOTH_CURVE_TO&&(y=isNaN(l)?0:d-l,w=isNaN(c)?0:g-c),m.type&(ue.CURVE_TO|ue.SMOOTH_CURVE_TO)?(l=m.relative?d+m.x2:m.x2,c=m.relative?g+m.y2:m.y2):(l=NaN,c=NaN),m.type&ue.SMOOTH_QUAD_TO?(u=isNaN(u)?d:2*d-u,h=isNaN(h)?g:2*g-h):m.type&ue.QUAD_TO?(u=m.relative?d+m.x1:m.x1,h=m.relative?g+m.y1:m.y2):(u=NaN,h=NaN),m.type&ue.LINE_COMMANDS||m.type&ue.ARC&&(m.rX===0||m.rY===0||!m.lArcFlag)||m.type&ue.CURVE_TO||m.type&ue.SMOOTH_CURVE_TO||m.type&ue.QUAD_TO||m.type&ue.SMOOTH_QUAD_TO){var k=m.x===void 0?0:m.relative?m.x:m.x-d,T=m.y===void 0?0:m.relative?m.y:m.y-g;y=isNaN(u)?m.x1===void 0?y:m.relative?m.x:m.x1-d:u-d,w=isNaN(h)?m.y1===void 0?w:m.relative?m.y:m.y1-g:h-g;var S=m.x2===void 0?0:m.relative?m.x:m.x2-d,E=m.y2===void 0?0:m.relative?m.y:m.y2-g;v(k)<=o&&v(T)<=o&&v(y)<=o&&v(w)<=o&&v(S)<=o&&v(E)<=o&&(b=!0)}return m.type&ue.CLOSE_PATH&&v(d-p)<=o&&v(g-x)<=o&&(b=!0),b?[]:m}))},e.MATRIX=a,e.ROTATE=function(o,l,c){l===void 0&&(l=0),c===void 0&&(c=0),xn(o,l,c);var u=Math.sin(o),h=Math.cos(o);return a(h,u,-u,h,l-l*h+c*u,c-l*u-c*h)},e.TRANSLATE=function(o,l){return l===void 0&&(l=0),xn(o,l),a(1,0,0,1,o,l)},e.SCALE=function(o,l){return l===void 0&&(l=o),xn(o,l),a(o,0,0,l,0,0)},e.SKEW_X=function(o){return xn(o),a(1,0,Math.atan(o),1,0,0)},e.SKEW_Y=function(o){return xn(o),a(1,Math.atan(o),0,1,0,0)},e.X_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),xn(o),a(-1,0,0,1,o,0)},e.Y_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),xn(o),a(1,0,0,-1,0,o)},e.A_TO_C=function(){return i((function(o,l,c){return ue.ARC===o.type?(function(u,h,m){var d,g,p,x;u.cX||Gm(u,h,m);for(var v=Math.min(u.phi1,u.phi2),b=Math.max(u.phi1,u.phi2)-v,y=Math.ceil(b/90),w=new Array(y),k=h,T=m,S=0;S<y;S++){var E=YS(u.phi1,u.phi2,S/y),A=YS(u.phi1,u.phi2,(S+1)/y),R=A-E,C=4/3*Math.tan(R*ti/4),j=[Math.cos(E*ti)-C*Math.sin(E*ti),Math.sin(E*ti)+C*Math.cos(E*ti)],z=j[0],G=j[1],W=[Math.cos(A*ti),Math.sin(A*ti)],fe=W[0],he=W[1],ee=[fe+C*Math.sin(A*ti),he-C*Math.cos(A*ti)],re=ee[0],O=ee[1];w[S]={relative:u.relative,type:ue.CURVE_TO};var ge=function(B,_){var M=$p([B*u.rX,_*u.rY],u.xRot),U=M[0],V=M[1];return[u.cX+U,u.cY+V]};d=ge(z,G),w[S].x1=d[0],w[S].y1=d[1],g=ge(re,O),w[S].x2=g[0],w[S].y2=g[1],p=ge(fe,he),w[S].x=p[0],w[S].y=p[1],u.relative&&(w[S].x1-=k,w[S].y1-=T,w[S].x2-=k,w[S].y2-=T,w[S].x-=k,w[S].y-=T),k=(x=[w[S].x,w[S].y])[0],T=x[1]}return w})(o,o.relative?0:l,o.relative?0:c):o}))},e.ANNOTATE_ARCS=function(){return i((function(o,l,c){return o.relative&&(l=0,c=0),ue.ARC===o.type&&Gm(o,l,c),o}))},e.CLONE=s,e.CALCULATE_BOUNDS=function(){var o=function(m){var d={};for(var g in m)d[g]=m[g];return d},l=t(),c=n(),u=r(),h=i((function(m,d,g){var p=u(c(l(o(m))));function x(O){O>h.maxX&&(h.maxX=O),O<h.minX&&(h.minX=O)}function v(O){O>h.maxY&&(h.maxY=O),O<h.minY&&(h.minY=O)}if(p.type&ue.DRAWING_COMMANDS&&(x(d),v(g)),p.type&ue.HORIZ_LINE_TO&&x(p.x),p.type&ue.VERT_LINE_TO&&v(p.y),p.type&ue.LINE_TO&&(x(p.x),v(p.y)),p.type&ue.CURVE_TO){x(p.x),v(p.y);for(var b=0,y=KS(d,p.x1,p.x2,p.x);b<y.length;b++)0<(re=y[b])&&1>re&&x(QS(d,p.x1,p.x2,p.x,re));for(var w=0,k=KS(g,p.y1,p.y2,p.y);w<k.length;w++)0<(re=k[w])&&1>re&&v(QS(g,p.y1,p.y2,p.y,re))}if(p.type&ue.ARC){x(p.x),v(p.y),Gm(p,d,g);for(var T=p.xRot/180*Math.PI,S=Math.cos(T)*p.rX,E=Math.sin(T)*p.rX,A=-Math.sin(T)*p.rY,R=Math.cos(T)*p.rY,C=p.phi1<p.phi2?[p.phi1,p.phi2]:-180>p.phi2?[p.phi2+360,p.phi1+360]:[p.phi2,p.phi1],j=C[0],z=C[1],G=function(O){var ge=O[0],B=O[1],_=180*Math.atan2(B,ge)/Math.PI;return _<j?_+360:_},W=0,fe=GS(A,-S,0).map(G);W<fe.length;W++)(re=fe[W])>j&&re<z&&x(XS(p.cX,S,A,re));for(var he=0,ee=GS(R,-E,0).map(G);he<ee.length;he++){var re;(re=ee[he])>j&&re<z&&v(XS(p.cY,E,R,re))}}return m}));return h.minX=1/0,h.maxX=-1/0,h.minY=1/0,h.maxY=-1/0,h}})(jt||(jt={}));var gn,Mk=(function(){function e(){}return e.prototype.round=function(t){return this.transform(jt.ROUND(t))},e.prototype.toAbs=function(){return this.transform(jt.TO_ABS())},e.prototype.toRel=function(){return this.transform(jt.TO_REL())},e.prototype.normalizeHVZ=function(t,r,n){return this.transform(jt.NORMALIZE_HVZ(t,r,n))},e.prototype.normalizeST=function(){return this.transform(jt.NORMALIZE_ST())},e.prototype.qtToC=function(){return this.transform(jt.QT_TO_C())},e.prototype.aToC=function(){return this.transform(jt.A_TO_C())},e.prototype.sanitize=function(t){return this.transform(jt.SANITIZE(t))},e.prototype.translate=function(t,r){return this.transform(jt.TRANSLATE(t,r))},e.prototype.scale=function(t,r){return this.transform(jt.SCALE(t,r))},e.prototype.rotate=function(t,r,n){return this.transform(jt.ROTATE(t,r,n))},e.prototype.matrix=function(t,r,n,i,a,s){return this.transform(jt.MATRIX(t,r,n,i,a,s))},e.prototype.skewX=function(t){return this.transform(jt.SKEW_X(t))},e.prototype.skewY=function(t){return this.transform(jt.SKEW_Y(t))},e.prototype.xSymmetry=function(t){return this.transform(jt.X_AXIS_SYMMETRY(t))},e.prototype.ySymmetry=function(t){return this.transform(jt.Y_AXIS_SYMMETRY(t))},e.prototype.annotateArcs=function(){return this.transform(jt.ANNOTATE_ARCS())},e})(),zK=function(e){return e===" "||e==="	"||e==="\r"||e===`
`},ZS=function(e){return 48<=e.charCodeAt(0)&&e.charCodeAt(0)<=57},HK=(function(e){function t(){var r=e.call(this)||this;return r.curNumber="",r.curCommandType=-1,r.curCommandRelative=!1,r.canParseCommandOrComma=!0,r.curNumberHasExp=!1,r.curNumberHasExpDigits=!1,r.curNumberHasDecimal=!1,r.curArgs=[],r}return Pk(t,e),t.prototype.finish=function(r){if(r===void 0&&(r=[]),this.parse(" ",r),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return r},t.prototype.parse=function(r,n){var i=this;n===void 0&&(n=[]);for(var a=function(h){n.push(h),i.curArgs.length=0,i.canParseCommandOrComma=!0},s=0;s<r.length;s++){var o=r[s],l=!(this.curCommandType!==ue.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),c=ZS(o)&&(this.curNumber==="0"&&o==="0"||l);if(!ZS(o)||c)if(o!=="e"&&o!=="E")if(o!=="-"&&o!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(o!=="."||this.curNumberHasExp||this.curNumberHasDecimal||l){if(this.curNumber&&this.curCommandType!==-1){var u=Number(this.curNumber);if(isNaN(u))throw new SyntaxError("Invalid number ending at "+s);if(this.curCommandType===ue.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>u)throw new SyntaxError('Expected positive number, got "'+u+'" at index "'+s+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+s+'"')}this.curArgs.push(u),this.curArgs.length===$K[this.curCommandType]&&(ue.HORIZ_LINE_TO===this.curCommandType?a({type:ue.HORIZ_LINE_TO,relative:this.curCommandRelative,x:u}):ue.VERT_LINE_TO===this.curCommandType?a({type:ue.VERT_LINE_TO,relative:this.curCommandRelative,y:u}):this.curCommandType===ue.MOVE_TO||this.curCommandType===ue.LINE_TO||this.curCommandType===ue.SMOOTH_QUAD_TO?(a({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),ue.MOVE_TO===this.curCommandType&&(this.curCommandType=ue.LINE_TO)):this.curCommandType===ue.CURVE_TO?a({type:ue.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===ue.SMOOTH_CURVE_TO?a({type:ue.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===ue.QUAD_TO?a({type:ue.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===ue.ARC&&a({type:ue.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!zK(o))if(o===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(o!=="+"&&o!=="-"&&o!==".")if(c)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+s+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+s+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,o!=="z"&&o!=="Z")if(o==="h"||o==="H")this.curCommandType=ue.HORIZ_LINE_TO,this.curCommandRelative=o==="h";else if(o==="v"||o==="V")this.curCommandType=ue.VERT_LINE_TO,this.curCommandRelative=o==="v";else if(o==="m"||o==="M")this.curCommandType=ue.MOVE_TO,this.curCommandRelative=o==="m";else if(o==="l"||o==="L")this.curCommandType=ue.LINE_TO,this.curCommandRelative=o==="l";else if(o==="c"||o==="C")this.curCommandType=ue.CURVE_TO,this.curCommandRelative=o==="c";else if(o==="s"||o==="S")this.curCommandType=ue.SMOOTH_CURVE_TO,this.curCommandRelative=o==="s";else if(o==="q"||o==="Q")this.curCommandType=ue.QUAD_TO,this.curCommandRelative=o==="q";else if(o==="t"||o==="T")this.curCommandType=ue.SMOOTH_QUAD_TO,this.curCommandRelative=o==="t";else{if(o!=="a"&&o!=="A")throw new SyntaxError('Unexpected character "'+o+'" at index '+s+".");this.curCommandType=ue.ARC,this.curCommandRelative=o==="a"}else n.push({type:ue.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal=o==="."}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return n},t.prototype.transform=function(r){return Object.create(this,{parse:{value:function(n,i){i===void 0&&(i=[]);for(var a=0,s=Object.getPrototypeOf(this).parse.call(this,n);a<s.length;a++){var o=s[a],l=r(o);Array.isArray(l)?i.push.apply(i,l):i.push(l)}return i}}})},t})(Mk),ue=(function(e){function t(r){var n=e.call(this)||this;return n.commands=typeof r=="string"?t.parse(r):r,n}return Pk(t,e),t.prototype.encode=function(){return t.encode(this.commands)},t.prototype.getBounds=function(){var r=jt.CALCULATE_BOUNDS();return this.transform(r),r},t.prototype.transform=function(r){for(var n=[],i=0,a=this.commands;i<a.length;i++){var s=r(a[i]);Array.isArray(s)?n.push.apply(n,s):n.push(s)}return this.commands=n,this},t.encode=function(r){return qK(r)},t.parse=function(r){var n=new HK,i=[];return n.parse(r,i),n.finish(i),i},t.CLOSE_PATH=1,t.MOVE_TO=2,t.HORIZ_LINE_TO=4,t.VERT_LINE_TO=8,t.LINE_TO=16,t.CURVE_TO=32,t.SMOOTH_CURVE_TO=64,t.QUAD_TO=128,t.SMOOTH_QUAD_TO=256,t.ARC=512,t.LINE_COMMANDS=t.LINE_TO|t.HORIZ_LINE_TO|t.VERT_LINE_TO,t.DRAWING_COMMANDS=t.HORIZ_LINE_TO|t.VERT_LINE_TO|t.LINE_TO|t.CURVE_TO|t.SMOOTH_CURVE_TO|t.QUAD_TO|t.SMOOTH_QUAD_TO|t.ARC,t})(Mk),$K=((gn={})[ue.MOVE_TO]=2,gn[ue.LINE_TO]=2,gn[ue.HORIZ_LINE_TO]=1,gn[ue.VERT_LINE_TO]=1,gn[ue.CLOSE_PATH]=0,gn[ue.QUAD_TO]=4,gn[ue.SMOOTH_QUAD_TO]=2,gn[ue.CURVE_TO]=6,gn[ue.SMOOTH_CURVE_TO]=4,gn[ue.ARC]=7,gn);function Ec(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ec=function(t){return typeof t}:Ec=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ec(e)}function VK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var WK=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],GK=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function YK(e,t,r,n,i){if(typeof e=="string"&&(e=document.getElementById(e)),!e||Ec(e)!=="object"||!("getContext"in e))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var a=e.getContext("2d");try{return a.getImageData(t,r,n,i)}catch(s){throw new Error("unable to access image data: "+s)}}function XK(e,t,r,n,i,a){if(!(isNaN(a)||a<1)){a|=0;var s=YK(e,t,r,n,i);s=KK(s,t,r,n,i,a),e.getContext("2d").putImageData(s,t,r)}}function KK(e,t,r,n,i,a){for(var s=e.data,o=2*a+1,l=n-1,c=i-1,u=a+1,h=u*(u+1)/2,m=new JS,d=m,g,p=1;p<o;p++)d=d.next=new JS,p===u&&(g=d);d.next=m;for(var x=null,v=null,b=0,y=0,w=WK[a],k=GK[a],T=0;T<i;T++){d=m;for(var S=s[y],E=s[y+1],A=s[y+2],R=s[y+3],C=0;C<u;C++)d.r=S,d.g=E,d.b=A,d.a=R,d=d.next;for(var j=0,z=0,G=0,W=0,fe=u*S,he=u*E,ee=u*A,re=u*R,O=h*S,ge=h*E,B=h*A,_=h*R,M=1;M<u;M++){var U=y+((l<M?l:M)<<2),V=s[U],le=s[U+1],de=s[U+2],K=s[U+3],J=u-M;O+=(d.r=V)*J,ge+=(d.g=le)*J,B+=(d.b=de)*J,_+=(d.a=K)*J,j+=V,z+=le,G+=de,W+=K,d=d.next}x=m,v=g;for(var Se=0;Se<n;Se++){var te=_*w>>>k;if(s[y+3]=te,te!==0){var $e=255/te;s[y]=(O*w>>>k)*$e,s[y+1]=(ge*w>>>k)*$e,s[y+2]=(B*w>>>k)*$e}else s[y]=s[y+1]=s[y+2]=0;O-=fe,ge-=he,B-=ee,_-=re,fe-=x.r,he-=x.g,ee-=x.b,re-=x.a;var Ne=Se+a+1;Ne=b+(Ne<l?Ne:l)<<2,j+=x.r=s[Ne],z+=x.g=s[Ne+1],G+=x.b=s[Ne+2],W+=x.a=s[Ne+3],O+=j,ge+=z,B+=G,_+=W,x=x.next;var Je=v,Be=Je.r,Te=Je.g,Ot=Je.b,mr=Je.a;fe+=Be,he+=Te,ee+=Ot,re+=mr,j-=Be,z-=Te,G-=Ot,W-=mr,v=v.next,y+=4}b+=n}for(var Qt=0;Qt<n;Qt++){y=Qt<<2;var ir=s[y],Yr=s[y+1],jr=s[y+2],ft=s[y+3],On=u*ir,ie=u*Yr,xe=u*jr,Oe=u*ft,Ue=h*ir,We=h*Yr,Ut=h*jr,pr=h*ft;d=m;for(var gr=0;gr<u;gr++)d.r=ir,d.g=Yr,d.b=jr,d.a=ft,d=d.next;for(var hn=n,Xr=0,qt=0,Kr=0,ar=0,oa=1;oa<=a;oa++){y=hn+Qt<<2;var la=u-oa;Ue+=(d.r=ir=s[y])*la,We+=(d.g=Yr=s[y+1])*la,Ut+=(d.b=jr=s[y+2])*la,pr+=(d.a=ft=s[y+3])*la,ar+=ir,Xr+=Yr,qt+=jr,Kr+=ft,d=d.next,oa<c&&(hn+=n)}y=Qt,x=m,v=g;for(var eo=0;eo<i;eo++){var sr=y<<2;s[sr+3]=ft=pr*w>>>k,ft>0?(ft=255/ft,s[sr]=(Ue*w>>>k)*ft,s[sr+1]=(We*w>>>k)*ft,s[sr+2]=(Ut*w>>>k)*ft):s[sr]=s[sr+1]=s[sr+2]=0,Ue-=On,We-=ie,Ut-=xe,pr-=Oe,On-=x.r,ie-=x.g,xe-=x.b,Oe-=x.a,sr=Qt+((sr=eo+u)<c?sr:c)*n<<2,Ue+=ar+=x.r=s[sr],We+=Xr+=x.g=s[sr+1],Ut+=qt+=x.b=s[sr+2],pr+=Kr+=x.a=s[sr+3],x=x.next,On+=ir=v.r,ie+=Yr=v.g,xe+=jr=v.b,Oe+=ft=v.a,ar-=ir,Xr-=Yr,qt-=jr,Kr-=ft,v=v.next,y+=n}}return e}var JS=function e(){VK(this,e),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function QK(){var{DOMParser:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:e,createCanvas(r,n){return new OffscreenCanvas(r,n)},createImage(r){return vi(function*(){var n=yield fetch(r),i=yield n.blob(),a=yield createImageBitmap(i);return a})()}};return(typeof DOMParser!="undefined"||typeof e=="undefined")&&Reflect.deleteProperty(t,"DOMParser"),t}function ZK(e){var{DOMParser:t,canvas:r,fetch:n}=e;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:t,fetch:n,createCanvas:r.createCanvas,createImage:r.loadImage}}var JK=Object.freeze({__proto__:null,offscreen:QK,node:ZK});function Ja(e){return e.replace(/(?!\u3000)\s+/gm," ")}function Lk(e){return e.replace(/^[\n \t]+/,"")}function Bk(e){return e.replace(/[\n \t]+$/,"")}function Cr(e){var t=(e||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return t.map(parseFloat)}var eQ=/^[A-Z-]+$/;function Uk(e){return eQ.test(e)?e.toLowerCase():e}function Kx(e){var t=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(e)||[];return t[2]||t[3]||t[4]}function qk(e){if(!e.startsWith("rgb"))return e;var t=3,r=e.replace(/\d+(\.\d+)?/g,(n,i)=>t--&&i?String(Math.round(parseFloat(n))):n);return r}var tQ=/(\[[^\]]+\])/g,rQ=/(#[^\s+>~.[:]+)/g,nQ=/(\.[^\s+>~.[:]+)/g,iQ=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,aQ=/(:[\w-]+\([^)]*\))/gi,sQ=/(:[^\s+>~.[:]+)/g,oQ=/([^\s+>~.[:]+)/g;function fa(e,t){var r=t.exec(e);return r?[e.replace(t," "),r.length]:[e,0]}function zk(e){var t=[0,0,0],r=e.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),n=0;return[r,n]=fa(r,tQ),t[1]+=n,[r,n]=fa(r,rQ),t[0]+=n,[r,n]=fa(r,nQ),t[1]+=n,[r,n]=fa(r,iQ),t[2]+=n,[r,n]=fa(r,aQ),t[1]+=n,[r,n]=fa(r,sQ),t[1]+=n,r=r.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[r,n]=fa(r,oQ),t[2]+=n,t.join("")}var Ra=1e-8;function Vp(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))}function hu(e,t){return(e[0]*t[0]+e[1]*t[1])/(Vp(e)*Vp(t))}function Wp(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(hu(e,t))}function Gp(e){return e*e*e}function Yp(e){return 3*e*e*(1-e)}function Xp(e){return 3*e*(1-e)*(1-e)}function Kp(e){return(1-e)*(1-e)*(1-e)}function Qp(e){return e*e}function Zp(e){return 2*e*(1-e)}function Jp(e){return(1-e)*(1-e)}class Re{constructor(t,r,n){this.document=t,this.name=r,this.value=n,this.isNormalizedColor=!1}static empty(t){return new Re(t,"EMPTY","")}split(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ",{document:r,name:n}=this;return Ja(this.getString()).trim().split(t).map(i=>new Re(r,n,i))}hasValue(t){var{value:r}=this;return r!==null&&r!==""&&(t||r!==0)&&typeof r!="undefined"}isString(t){var{value:r}=this,n=typeof r=="string";return!n||!t?n:t.test(r)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return typeof t=="undefined"||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return typeof t=="undefined"?0:parseFloat(t);var{value:r}=this,n=parseFloat(r);return this.isString(/%$/)&&(n/=100),n}getString(t){return typeof t=="undefined"||this.hasValue()?typeof this.value=="undefined"?"":String(this.value):String(t)}getColor(t){var r=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,r=qk(r),this.value=r),r}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;var[n,i]=typeof t=="boolean"?[void 0,t]:[t],{viewPort:a}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(a.computeSize("x"),a.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(a.computeSize("x"),a.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*a.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*a.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&i):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*a.computeSize(n);default:{var s=this.getNumber();return r&&s<1?s*a.computeSize(n):s}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var t=this.getString(),r=/#([^)'"]+)/.exec(t);return r&&(r=r[1]),r||(r=t),this.document.definitions[r]}getFillStyleDefinition(t,r){var n=this.getDefinition();if(!n)return null;if(typeof n.createGradient=="function")return n.createGradient(this.document.ctx,t,r);if(typeof n.createPattern=="function"){if(n.getHrefAttribute().hasValue()){var i=n.getAttribute("patternTransform");n=n.getHrefAttribute().getDefinition(),i.hasValue()&&n.getAttribute("patternTransform",!0).setValue(i.value)}return n.createPattern(this.document.ctx,t,r)}return null}getTextBaseline(){return this.hasValue()?Re.textBaselineMapping[this.getString()]:null}addOpacity(t){for(var r=this.getColor(),n=r.length,i=0,a=0;a<n&&(r[a]===","&&i++,i!==3);a++);if(t.hasValue()&&this.isString()&&i!==3){var s=new Hp(r);s.ok&&(s.alpha=t.getNumber(),r=s.toRGBA())}return new Re(this.document,this.name,r)}}Re.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class Hk{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(t,r){this.viewPorts.push({width:t,height:r})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:t}=this;return t[t.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return typeof t=="number"?t:t==="x"?this.width:t==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}}class kt{constructor(t,r){this.x=t,this.y=r}static parse(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,[n=r,i=r]=Cr(t);return new kt(n,i)}static parseScale(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,[n=r,i=n]=Cr(t);return new kt(n,i)}static parsePath(t){for(var r=Cr(t),n=r.length,i=[],a=0;a<n;a+=2)i.push(new kt(r[a],r[a+1]));return i}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){var{x:r,y:n}=this,i=r*t[0]+n*t[2]+t[4],a=r*t[1]+n*t[3]+t[5];this.x=i,this.y=a}}class $k{constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:t,onClick:r,onMouseMove:n}=this,i=t.ctx.canvas;i.onclick=r,i.onmousemove=n,this.working=!0}}stop(){if(this.working){var t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:t,events:r,eventElements:n}=this,{style:i}=t.ctx.canvas;i&&(i.cursor=""),r.forEach((a,s)=>{for(var{run:o}=a,l=n[s];l;)o(l),l=l.parent}),this.events=[],this.eventElements=[]}}checkPath(t,r){if(!(!this.working||!r)){var{events:n,eventElements:i}=this;n.forEach((a,s)=>{var{x:o,y:l}=a;!i[s]&&r.isPointInPath&&r.isPointInPath(o,l)&&(i[s]=t)})}}checkBoundingBox(t,r){if(!(!this.working||!r)){var{events:n,eventElements:i}=this;n.forEach((a,s)=>{var{x:o,y:l}=a;!i[s]&&r.isPointInBox(o,l)&&(i[s]=t)})}}mapXY(t,r){for(var{window:n,ctx:i}=this.screen,a=new kt(t,r),s=i.canvas;s;)a.x-=s.offsetLeft,a.y-=s.offsetTop,s=s.offsetParent;return n.scrollX&&(a.x+=n.scrollX),n.scrollY&&(a.y+=n.scrollY),a}onClick(t){var{x:r,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:r,y:n,run(i){i.onClick&&i.onClick()}})}onMouseMove(t){var{x:r,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:r,y:n,run(i){i.onMouseMove&&i.onMouseMove()}})}}var Vk=typeof window!="undefined"?window:null,Wk=typeof fetch!="undefined"?fetch.bind(void 0):null;class jl{constructor(t){var{fetch:r=Wk,window:n=Vk}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.ctx=t,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new Hk,this.mouse=new $k(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=n,this.fetch=r}wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var t=this.waits.every(r=>r());return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){var{document:r,ctx:n,aspectRatio:i,width:a,desiredWidth:s,height:o,desiredHeight:l,minX:c=0,minY:u=0,refX:h,refY:m,clip:d=!1,clipX:g=0,clipY:p=0}=t,x=Ja(i).replace(/^defer\s/,""),[v,b]=x.split(" "),y=v||"xMidYMid",w=b||"meet",k=a/s,T=o/l,S=Math.min(k,T),E=Math.max(k,T),A=s,R=l;w==="meet"&&(A*=S,R*=S),w==="slice"&&(A*=E,R*=E);var C=new Re(r,"refX",h),j=new Re(r,"refY",m),z=C.hasValue()&&j.hasValue();if(z&&n.translate(-S*C.getPixels("x"),-S*j.getPixels("y")),d){var G=S*g,W=S*p;n.beginPath(),n.moveTo(G,W),n.lineTo(a,W),n.lineTo(a,o),n.lineTo(G,o),n.closePath(),n.clip()}if(!z){var fe=w==="meet"&&S===T,he=w==="slice"&&E===T,ee=w==="meet"&&S===k,re=w==="slice"&&E===k;y.startsWith("xMid")&&(fe||he)&&n.translate(a/2-A/2,0),y.endsWith("YMid")&&(ee||re)&&n.translate(0,o/2-R/2),y.startsWith("xMax")&&(fe||he)&&n.translate(a-A,0),y.endsWith("YMax")&&(ee||re)&&n.translate(0,o-R)}switch(!0){case y==="none":n.scale(k,T);break;case w==="meet":n.scale(S,S);break;case w==="slice":n.scale(E,E);break}n.translate(-c,-u)}start(t){var{enableRedraw:r=!1,ignoreMouse:n=!1,ignoreAnimation:i=!1,ignoreDimensions:a=!1,ignoreClear:s=!1,forceRedraw:o,scaleWidth:l,scaleHeight:c,offsetX:u,offsetY:h}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{FRAMERATE:m,mouse:d}=this,g=1e3/m;if(this.frameDuration=g,this.readyPromise=new Promise(y=>{this.resolveReady=y}),this.isReady()&&this.render(t,a,s,l,c,u,h),!!r){var p=Date.now(),x=p,v=0,b=()=>{p=Date.now(),v=p-x,v>=g&&(x=p-v%g,this.shouldUpdate(i,o)&&(this.render(t,a,s,l,c,u,h),d.runEvents())),this.intervalId=Vm(b)};n||d.start(),this.intervalId=Vm(b)}}stop(){this.intervalId&&(Vm.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,r){if(!t){var{frameDuration:n}=this,i=this.animations.reduce((a,s)=>s.update(n)||a,!1);if(i)return!0}return!!(typeof r=="function"&&r()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(t,r,n,i,a,s,o){var{CLIENT_WIDTH:l,CLIENT_HEIGHT:c,viewPort:u,ctx:h,isFirstRender:m}=this,d=h.canvas;u.clear(),d.width&&d.height?u.setCurrent(d.width,d.height):u.setCurrent(l,c);var g=t.getStyle("width"),p=t.getStyle("height");!r&&(m||typeof i!="number"&&typeof a!="number")&&(g.hasValue()&&(d.width=g.getPixels("x"),d.style&&(d.style.width="".concat(d.width,"px"))),p.hasValue()&&(d.height=p.getPixels("y"),d.style&&(d.style.height="".concat(d.height,"px"))));var x=d.clientWidth||d.width,v=d.clientHeight||d.height;if(r&&g.hasValue()&&p.hasValue()&&(x=g.getPixels("x"),v=p.getPixels("y")),u.setCurrent(x,v),typeof s=="number"&&t.getAttribute("x",!0).setValue(s),typeof o=="number"&&t.getAttribute("y",!0).setValue(o),typeof i=="number"||typeof a=="number"){var b=Cr(t.getAttribute("viewBox").getString()),y=0,w=0;if(typeof i=="number"){var k=t.getStyle("width");k.hasValue()?y=k.getPixels("x")/i:isNaN(b[2])||(y=b[2]/i)}if(typeof a=="number"){var T=t.getStyle("height");T.hasValue()?w=T.getPixels("y")/a:isNaN(b[3])||(w=b[3]/a)}y||(y=w),w||(w=y),t.getAttribute("width",!0).setValue(i),t.getAttribute("height",!0).setValue(a);var S=t.getStyle("transform",!0,!0);S.setValue("".concat(S.getString()," scale(").concat(1/y,", ").concat(1/w,")"))}n||h.clearRect(0,0,x,v),t.render(h),m&&(this.isFirstRender=!1)}}jl.defaultWindow=Vk;jl.defaultFetch=Wk;var{defaultFetch:lQ}=jl,cQ=typeof DOMParser!="undefined"?DOMParser:null;class Nc{constructor(){var{fetch:t=lQ,DOMParser:r=cQ}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fetch=t,this.DOMParser=r}parse(t){var r=this;return vi(function*(){return t.startsWith("<")?r.parseFromString(t):r.load(t)})()}parseFromString(t){var r=new this.DOMParser;try{return this.checkDocument(r.parseFromString(t,"image/svg+xml"))}catch(n){return this.checkDocument(r.parseFromString(t,"text/xml"))}}checkDocument(t){var r=t.getElementsByTagName("parsererror")[0];if(r)throw new Error(r.textContent);return t}load(t){var r=this;return vi(function*(){var n=yield r.fetch(t),i=yield n.text();return r.parseFromString(i)})()}}class Gk{constructor(t,r){this.type="translate",this.point=null,this.point=kt.parse(r)}apply(t){var{x:r,y:n}=this.point;t.translate(r||0,n||0)}unapply(t){var{x:r,y:n}=this.point;t.translate(-1*r||0,-1*n||0)}applyToPoint(t){var{x:r,y:n}=this.point;t.applyTransform([1,0,0,1,r||0,n||0])}}class Yk{constructor(t,r,n){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var i=Cr(r);this.angle=new Re(t,"angle",i[0]),this.originX=n[0],this.originY=n[1],this.cx=i[1]||0,this.cy=i[2]||0}apply(t){var{cx:r,cy:n,originX:i,originY:a,angle:s}=this,o=r+i.getPixels("x"),l=n+a.getPixels("y");t.translate(o,l),t.rotate(s.getRadians()),t.translate(-o,-l)}unapply(t){var{cx:r,cy:n,originX:i,originY:a,angle:s}=this,o=r+i.getPixels("x"),l=n+a.getPixels("y");t.translate(o,l),t.rotate(-1*s.getRadians()),t.translate(-o,-l)}applyToPoint(t){var{cx:r,cy:n,angle:i}=this,a=i.getRadians();t.applyTransform([1,0,0,1,r||0,n||0]),t.applyTransform([Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a),0,0]),t.applyTransform([1,0,0,1,-r||0,-n||0])}}class Xk{constructor(t,r,n){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var i=kt.parseScale(r);(i.x===0||i.y===0)&&(i.x=Ra,i.y=Ra),this.scale=i,this.originX=n[0],this.originY=n[1]}apply(t){var{scale:{x:r,y:n},originX:i,originY:a}=this,s=i.getPixels("x"),o=a.getPixels("y");t.translate(s,o),t.scale(r,n||r),t.translate(-s,-o)}unapply(t){var{scale:{x:r,y:n},originX:i,originY:a}=this,s=i.getPixels("x"),o=a.getPixels("y");t.translate(s,o),t.scale(1/r,1/n||r),t.translate(-s,-o)}applyToPoint(t){var{x:r,y:n}=this.scale;t.applyTransform([r||0,0,0,n||0,0,0])}}class Qx{constructor(t,r,n){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=Cr(r),this.originX=n[0],this.originY=n[1]}apply(t){var{originX:r,originY:n,matrix:i}=this,a=r.getPixels("x"),s=n.getPixels("y");t.translate(a,s),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.translate(-a,-s)}unapply(t){var{originX:r,originY:n,matrix:i}=this,a=i[0],s=i[2],o=i[4],l=i[1],c=i[3],u=i[5],h=0,m=0,d=1,g=1/(a*(c*d-u*m)-s*(l*d-u*h)+o*(l*m-c*h)),p=r.getPixels("x"),x=n.getPixels("y");t.translate(p,x),t.transform(g*(c*d-u*m),g*(u*h-l*d),g*(o*m-s*d),g*(a*d-o*h),g*(s*u-o*c),g*(o*l-a*u)),t.translate(-p,-x)}applyToPoint(t){t.applyTransform(this.matrix)}}class Zx extends Qx{constructor(t,r,n){super(t,r,n),this.type="skew",this.angle=null,this.angle=new Re(t,"angle",r)}}class Kk extends Zx{constructor(t,r,n){super(t,r,n),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}}class Qk extends Zx{constructor(t,r,n){super(t,r,n),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}function uQ(e){return Ja(e).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function fQ(e){var[t,r]=e.split("(");return[t.trim(),r.trim().replace(")","")]}class Qi{constructor(t,r,n){this.document=t,this.transforms=[];var i=uQ(r);i.forEach(a=>{if(a!=="none"){var[s,o]=fQ(a),l=Qi.transformTypes[s];typeof l!="undefined"&&this.transforms.push(new l(this.document,o,n))}})}static fromElement(t,r){var n=r.getStyle("transform",!1,!0),[i,a=i]=r.getStyle("transform-origin",!1,!0).split(),s=[i,a];return n.hasValue()?new Qi(t,n.getString(),s):null}apply(t){for(var{transforms:r}=this,n=r.length,i=0;i<n;i++)r[i].apply(t)}unapply(t){for(var{transforms:r}=this,n=r.length,i=n-1;i>=0;i--)r[i].unapply(t)}applyToPoint(t){for(var{transforms:r}=this,n=r.length,i=0;i<n;i++)r[i].applyToPoint(t)}}Qi.transformTypes={translate:Gk,rotate:Yk,scale:Xk,matrix:Qx,skewX:Kk,skewY:Qk};let Nt=class eg{constructor(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.document=t,this.node=r,this.captureTextNodes=n,this.attributes=Object.create(null),this.styles=Object.create(null),this.stylesSpecificity=Object.create(null),this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!(!r||r.nodeType!==1)){if(Array.from(r.attributes).forEach(o=>{var l=Uk(o.nodeName);this.attributes[l]=new Re(t,l,o.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var i=this.getAttribute("style").getString().split(";").map(o=>o.trim());i.forEach(o=>{if(o){var[l,c]=o.split(":").map(u=>u.trim());this.styles[l]=new Re(t,l,c)}})}var{definitions:a}=t,s=this.getAttribute("id");s.hasValue()&&(a[s.getString()]||(a[s.getString()]=this)),Array.from(r.childNodes).forEach(o=>{if(o.nodeType===1)this.addChild(o);else if(n&&(o.nodeType===3||o.nodeType===4)){var l=t.createTextNode(o);l.getText().length>0&&this.addChild(l)}})}}getAttribute(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.attributes[t];if(!n&&r){var i=new Re(this.document,t,"");return this.attributes[t]=i,i}return n||Re.empty(this.document)}getHrefAttribute(){for(var t in this.attributes)if(t==="href"||t.endsWith(":href"))return this.attributes[t];return Re.empty(this.document)}getStyle(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.styles[t];if(i)return i;var a=this.getAttribute(t);if(a!=null&&a.hasValue())return this.styles[t]=a,a;if(!n){var{parent:s}=this;if(s){var o=s.getStyle(t);if(o!=null&&o.hasValue())return o}}if(r){var l=new Re(this.document,t,"");return this.styles[t]=l,l}return i||Re.empty(this.document)}render(t){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(t.save(),this.getStyle("mask").hasValue()){var r=this.getStyle("mask").getDefinition();r&&(this.applyEffects(t),r.apply(t,this))}else if(this.getStyle("filter").getValue("none")!=="none"){var n=this.getStyle("filter").getDefinition();n&&(this.applyEffects(t),n.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){var r=Qi.fromElement(this.document,this);r&&r.apply(t);var n=this.getStyle("clip-path",!1,!0);if(n.hasValue()){var i=n.getDefinition();i&&i.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach(r=>{r.render(t)})}addChild(t){var r=t instanceof eg?t:this.document.createElement(t);r.parent=this,eg.ignoreChildTypes.includes(r.type)||this.children.push(r)}matchesSelector(t){var r,{node:n}=this;if(typeof n.matches=="function")return n.matches(t);var i=(r=n.getAttribute)===null||r===void 0?void 0:r.call(n,"class");return!i||i===""?!1:i.split(" ").some(a=>".".concat(a)===t)}addStylesFromStyleDefinition(){var{styles:t,stylesSpecificity:r}=this.document;for(var n in t)if(!n.startsWith("@")&&this.matchesSelector(n)){var i=t[n],a=r[n];if(i)for(var s in i){var o=this.stylesSpecificity[s];typeof o=="undefined"&&(o="000"),a>=o&&(this.styles[s]=i[s],this.stylesSpecificity[s]=a)}}}removeStyles(t,r){var n=r.reduce((i,a)=>{var s=t.getStyle(a);if(!s.hasValue())return i;var o=s.getString();return s.setValue(""),[...i,[a,o]]},[]);return n}restoreStyles(t,r){r.forEach(n=>{var[i,a]=n;t.getStyle(i,!0).setValue(a)})}isFirstChild(){var t;return((t=this.parent)===null||t===void 0?void 0:t.children.indexOf(this))===0}};Nt.ignoreChildTypes=["title"];class Zk extends Nt{constructor(t,r,n){super(t,r,n)}}function hQ(e){var t=e.trim();return/^('|")/.test(t)?t:'"'.concat(t,'"')}function dQ(e){return typeof process=="undefined"?e:e.trim().split(",").map(hQ).join(",")}function mQ(e){if(!e)return"";var t=e.trim().toLowerCase();switch(t){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return t;default:return/^oblique\s+(-|)\d+deg$/.test(t)?t:""}}function pQ(e){if(!e)return"";var t=e.trim().toLowerCase();switch(t){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return t;default:return/^[\d.]+$/.test(t)?t:""}}class ur{constructor(t,r,n,i,a,s){var o=s?typeof s=="string"?ur.parse(s):s:{};this.fontFamily=a||o.fontFamily,this.fontSize=i||o.fontSize,this.fontStyle=t||o.fontStyle,this.fontWeight=n||o.fontWeight,this.fontVariant=r||o.fontVariant}static parse(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0,n="",i="",a="",s="",o="",l=Ja(t).trim().split(" "),c={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return l.forEach(u=>{switch(!0){case(!c.fontStyle&&ur.styles.includes(u)):u!=="inherit"&&(n=u),c.fontStyle=!0;break;case(!c.fontVariant&&ur.variants.includes(u)):u!=="inherit"&&(i=u),c.fontStyle=!0,c.fontVariant=!0;break;case(!c.fontWeight&&ur.weights.includes(u)):u!=="inherit"&&(a=u),c.fontStyle=!0,c.fontVariant=!0,c.fontWeight=!0;break;case!c.fontSize:u!=="inherit"&&([s]=u.split("/")),c.fontStyle=!0,c.fontVariant=!0,c.fontWeight=!0,c.fontSize=!0;break;default:u!=="inherit"&&(o+=u)}}),new ur(n,i,a,s,o,r)}toString(){return[mQ(this.fontStyle),this.fontVariant,pQ(this.fontWeight),this.fontSize,dQ(this.fontFamily)].join(" ").trim()}}ur.styles="normal|italic|oblique|inherit";ur.variants="normal|small-caps|inherit";ur.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class fn{constructor(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.NaN,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.NaN,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Number.NaN,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Number.NaN;this.x1=t,this.y1=r,this.x2=n,this.y2=i,this.addPoint(t,r),this.addPoint(n,i)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,r){typeof t!="undefined"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),typeof r!="undefined"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=r,this.y2=r),r<this.y1&&(this.y1=r),r>this.y2&&(this.y2=r))}addX(t){this.addPoint(t,null)}addY(t){this.addPoint(null,t)}addBoundingBox(t){if(t){var{x1:r,y1:n,x2:i,y2:a}=t;this.addPoint(r,n),this.addPoint(i,a)}}sumCubic(t,r,n,i,a){return Math.pow(1-t,3)*r+3*Math.pow(1-t,2)*t*n+3*(1-t)*Math.pow(t,2)*i+Math.pow(t,3)*a}bezierCurveAdd(t,r,n,i,a){var s=6*r-12*n+6*i,o=-3*r+9*n-9*i+3*a,l=3*n-3*r;if(o===0){if(s===0)return;var c=-l/s;0<c&&c<1&&(t?this.addX(this.sumCubic(c,r,n,i,a)):this.addY(this.sumCubic(c,r,n,i,a)));return}var u=Math.pow(s,2)-4*l*o;if(!(u<0)){var h=(-s+Math.sqrt(u))/(2*o);0<h&&h<1&&(t?this.addX(this.sumCubic(h,r,n,i,a)):this.addY(this.sumCubic(h,r,n,i,a)));var m=(-s-Math.sqrt(u))/(2*o);0<m&&m<1&&(t?this.addX(this.sumCubic(m,r,n,i,a)):this.addY(this.sumCubic(m,r,n,i,a)))}}addBezierCurve(t,r,n,i,a,s,o,l){this.addPoint(t,r),this.addPoint(o,l),this.bezierCurveAdd(!0,t,n,a,o),this.bezierCurveAdd(!1,r,i,s,l)}addQuadraticCurve(t,r,n,i,a,s){var o=t+.6666666666666666*(n-t),l=r+2/3*(i-r),c=o+1/3*(a-t),u=l+1/3*(s-r);this.addBezierCurve(t,r,o,c,l,u,a,s)}isPointInBox(t,r){var{x1:n,y1:i,x2:a,y2:s}=this;return n<=t&&t<=a&&i<=r&&r<=s}}class Me extends ue{constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new kt(0,0),this.control=new kt(0,0),this.current=new kt(0,0),this.points=[],this.angles=[]}isEnd(){var{i:t,commands:r}=this;return t>=r.length-1}next(){var t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y",n=new kt(this.command[t],this.command[r]);return this.makeAbsolute(n)}getAsControlPoint(t,r){var n=this.getPoint(t,r);return this.control=n,n}getAsCurrentPoint(t,r){var n=this.getPoint(t,r);return this.current=n,n}getReflectedControlPoint(){var t=this.previousCommand.type;if(t!==ue.CURVE_TO&&t!==ue.SMOOTH_CURVE_TO&&t!==ue.QUAD_TO&&t!==ue.SMOOTH_QUAD_TO)return this.current;var{current:{x:r,y:n},control:{x:i,y:a}}=this,s=new kt(2*r-i,2*n-a);return s}makeAbsolute(t){if(this.command.relative){var{x:r,y:n}=this.current;t.x+=r,t.y+=n}return t}addMarker(t,r,n){var{points:i,angles:a}=this;n&&a.length>0&&!a[a.length-1]&&(a[a.length-1]=i[i.length-1].angleTo(n)),this.addMarkerAngle(t,r?r.angleTo(t):null)}addMarkerAngle(t,r){this.points.push(t),this.angles.push(r)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:t}=this,r=t.length,n=0;n<r;n++)if(!t[n]){for(var i=n+1;i<r;i++)if(t[i]){t[n]=t[i];break}}return t}}class sa extends Nt{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var t=1,r=this;r;){var n=r.getStyle("opacity",!1,!0);n.hasValue(!0)&&(t*=n.getNumber()),r=r.parent}return t}setContext(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r){var n=this.getStyle("fill"),i=this.getStyle("fill-opacity"),a=this.getStyle("stroke"),s=this.getStyle("stroke-opacity");if(n.isUrlDefinition()){var o=n.getFillStyleDefinition(this,i);o&&(t.fillStyle=o)}else if(n.hasValue()){n.getString()==="currentColor"&&n.setValue(this.getStyle("color").getColor());var l=n.getColor();l!=="inherit"&&(t.fillStyle=l==="none"?"rgba(0,0,0,0)":l)}if(i.hasValue()){var c=new Re(this.document,"fill",t.fillStyle).addOpacity(i).getColor();t.fillStyle=c}if(a.isUrlDefinition()){var u=a.getFillStyleDefinition(this,s);u&&(t.strokeStyle=u)}else if(a.hasValue()){a.getString()==="currentColor"&&a.setValue(this.getStyle("color").getColor());var h=a.getString();h!=="inherit"&&(t.strokeStyle=h==="none"?"rgba(0,0,0,0)":h)}if(s.hasValue()){var m=new Re(this.document,"stroke",t.strokeStyle).addOpacity(s).getString();t.strokeStyle=m}var d=this.getStyle("stroke-width");if(d.hasValue()){var g=d.getPixels();t.lineWidth=g||Ra}var p=this.getStyle("stroke-linecap"),x=this.getStyle("stroke-linejoin"),v=this.getStyle("stroke-miterlimit"),b=this.getStyle("stroke-dasharray"),y=this.getStyle("stroke-dashoffset");if(p.hasValue()&&(t.lineCap=p.getString()),x.hasValue()&&(t.lineJoin=x.getString()),v.hasValue()&&(t.miterLimit=v.getNumber()),b.hasValue()&&b.getString()!=="none"){var w=Cr(b.getString());typeof t.setLineDash!="undefined"?t.setLineDash(w):typeof t.webkitLineDash!="undefined"?t.webkitLineDash=w:typeof t.mozDash!="undefined"&&!(w.length===1&&w[0]===0)&&(t.mozDash=w);var k=y.getPixels();typeof t.lineDashOffset!="undefined"?t.lineDashOffset=k:typeof t.webkitLineDashOffset!="undefined"?t.webkitLineDashOffset=k:typeof t.mozDashOffset!="undefined"&&(t.mozDashOffset=k)}}if(this.modifiedEmSizeStack=!1,typeof t.font!="undefined"){var T=this.getStyle("font"),S=this.getStyle("font-style"),E=this.getStyle("font-variant"),A=this.getStyle("font-weight"),R=this.getStyle("font-size"),C=this.getStyle("font-family"),j=new ur(S.getString(),E.getString(),A.getString(),R.hasValue()?"".concat(R.getPixels(!0),"px"):"",C.getString(),ur.parse(T.getString(),t.font));S.setValue(j.fontStyle),E.setValue(j.fontVariant),A.setValue(j.fontWeight),R.setValue(j.fontSize),C.setValue(j.fontFamily),t.font=j.toString(),R.isPixels()&&(this.document.emSize=R.getPixels(),this.modifiedEmSizeStack=!0)}r||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}}class rt extends sa{constructor(t,r,n){super(t,r,n),this.type="path",this.pathParser=null,this.pathParser=new Me(this.getAttribute("d").getString())}path(t){var{pathParser:r}=this,n=new fn;for(r.reset(),t&&t.beginPath();!r.isEnd();)switch(r.next().type){case Me.MOVE_TO:this.pathM(t,n);break;case Me.LINE_TO:this.pathL(t,n);break;case Me.HORIZ_LINE_TO:this.pathH(t,n);break;case Me.VERT_LINE_TO:this.pathV(t,n);break;case Me.CURVE_TO:this.pathC(t,n);break;case Me.SMOOTH_CURVE_TO:this.pathS(t,n);break;case Me.QUAD_TO:this.pathQ(t,n);break;case Me.SMOOTH_QUAD_TO:this.pathT(t,n);break;case Me.ARC:this.pathA(t,n);break;case Me.CLOSE_PATH:this.pathZ(t,n);break}return n}getBoundingBox(t){return this.path()}getMarkers(){var{pathParser:t}=this,r=t.getMarkerPoints(),n=t.getMarkerAngles(),i=r.map((a,s)=>[a,n[s]]);return i}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);var r=this.getStyle("fill-rule");t.fillStyle!==""&&(r.getString("inherit")!=="inherit"?t.fill(r.getString()):t.fill()),t.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());var n=this.getMarkers();if(n){var i=n.length-1,a=this.getStyle("marker-start"),s=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(a.isUrlDefinition()){var l=a.getDefinition(),[c,u]=n[0];l.render(t,c,u)}if(s.isUrlDefinition())for(var h=s.getDefinition(),m=1;m<i;m++){var[d,g]=n[m];h.render(t,d,g)}if(o.isUrlDefinition()){var p=o.getDefinition(),[x,v]=n[i];p.render(t,x,v)}}}static pathM(t){var r=t.getAsCurrentPoint();return t.start=t.current,{point:r}}pathM(t,r){var{pathParser:n}=this,{point:i}=rt.pathM(n),{x:a,y:s}=i;n.addMarker(i),r.addPoint(a,s),t&&t.moveTo(a,s)}static pathL(t){var{current:r}=t,n=t.getAsCurrentPoint();return{current:r,point:n}}pathL(t,r){var{pathParser:n}=this,{current:i,point:a}=rt.pathL(n),{x:s,y:o}=a;n.addMarker(a,i),r.addPoint(s,o),t&&t.lineTo(s,o)}static pathH(t){var{current:r,command:n}=t,i=new kt((n.relative?r.x:0)+n.x,r.y);return t.current=i,{current:r,point:i}}pathH(t,r){var{pathParser:n}=this,{current:i,point:a}=rt.pathH(n),{x:s,y:o}=a;n.addMarker(a,i),r.addPoint(s,o),t&&t.lineTo(s,o)}static pathV(t){var{current:r,command:n}=t,i=new kt(r.x,(n.relative?r.y:0)+n.y);return t.current=i,{current:r,point:i}}pathV(t,r){var{pathParser:n}=this,{current:i,point:a}=rt.pathV(n),{x:s,y:o}=a;n.addMarker(a,i),r.addPoint(s,o),t&&t.lineTo(s,o)}static pathC(t){var{current:r}=t,n=t.getPoint("x1","y1"),i=t.getAsControlPoint("x2","y2"),a=t.getAsCurrentPoint();return{current:r,point:n,controlPoint:i,currentPoint:a}}pathC(t,r){var{pathParser:n}=this,{current:i,point:a,controlPoint:s,currentPoint:o}=rt.pathC(n);n.addMarker(o,s,a),r.addBezierCurve(i.x,i.y,a.x,a.y,s.x,s.y,o.x,o.y),t&&t.bezierCurveTo(a.x,a.y,s.x,s.y,o.x,o.y)}static pathS(t){var{current:r}=t,n=t.getReflectedControlPoint(),i=t.getAsControlPoint("x2","y2"),a=t.getAsCurrentPoint();return{current:r,point:n,controlPoint:i,currentPoint:a}}pathS(t,r){var{pathParser:n}=this,{current:i,point:a,controlPoint:s,currentPoint:o}=rt.pathS(n);n.addMarker(o,s,a),r.addBezierCurve(i.x,i.y,a.x,a.y,s.x,s.y,o.x,o.y),t&&t.bezierCurveTo(a.x,a.y,s.x,s.y,o.x,o.y)}static pathQ(t){var{current:r}=t,n=t.getAsControlPoint("x1","y1"),i=t.getAsCurrentPoint();return{current:r,controlPoint:n,currentPoint:i}}pathQ(t,r){var{pathParser:n}=this,{current:i,controlPoint:a,currentPoint:s}=rt.pathQ(n);n.addMarker(s,a,a),r.addQuadraticCurve(i.x,i.y,a.x,a.y,s.x,s.y),t&&t.quadraticCurveTo(a.x,a.y,s.x,s.y)}static pathT(t){var{current:r}=t,n=t.getReflectedControlPoint();t.control=n;var i=t.getAsCurrentPoint();return{current:r,controlPoint:n,currentPoint:i}}pathT(t,r){var{pathParser:n}=this,{current:i,controlPoint:a,currentPoint:s}=rt.pathT(n);n.addMarker(s,a,a),r.addQuadraticCurve(i.x,i.y,a.x,a.y,s.x,s.y),t&&t.quadraticCurveTo(a.x,a.y,s.x,s.y)}static pathA(t){var{current:r,command:n}=t,{rX:i,rY:a,xRot:s,lArcFlag:o,sweepFlag:l}=n,c=s*(Math.PI/180),u=t.getAsCurrentPoint(),h=new kt(Math.cos(c)*(r.x-u.x)/2+Math.sin(c)*(r.y-u.y)/2,-Math.sin(c)*(r.x-u.x)/2+Math.cos(c)*(r.y-u.y)/2),m=Math.pow(h.x,2)/Math.pow(i,2)+Math.pow(h.y,2)/Math.pow(a,2);m>1&&(i*=Math.sqrt(m),a*=Math.sqrt(m));var d=(o===l?-1:1)*Math.sqrt((Math.pow(i,2)*Math.pow(a,2)-Math.pow(i,2)*Math.pow(h.y,2)-Math.pow(a,2)*Math.pow(h.x,2))/(Math.pow(i,2)*Math.pow(h.y,2)+Math.pow(a,2)*Math.pow(h.x,2)));isNaN(d)&&(d=0);var g=new kt(d*i*h.y/a,d*-a*h.x/i),p=new kt((r.x+u.x)/2+Math.cos(c)*g.x-Math.sin(c)*g.y,(r.y+u.y)/2+Math.sin(c)*g.x+Math.cos(c)*g.y),x=Wp([1,0],[(h.x-g.x)/i,(h.y-g.y)/a]),v=[(h.x-g.x)/i,(h.y-g.y)/a],b=[(-h.x-g.x)/i,(-h.y-g.y)/a],y=Wp(v,b);return hu(v,b)<=-1&&(y=Math.PI),hu(v,b)>=1&&(y=0),{currentPoint:u,rX:i,rY:a,sweepFlag:l,xAxisRotation:c,centp:p,a1:x,ad:y}}pathA(t,r){var{pathParser:n}=this,{currentPoint:i,rX:a,rY:s,sweepFlag:o,xAxisRotation:l,centp:c,a1:u,ad:h}=rt.pathA(n),m=1-o?1:-1,d=u+m*(h/2),g=new kt(c.x+a*Math.cos(d),c.y+s*Math.sin(d));if(n.addMarkerAngle(g,d-m*Math.PI/2),n.addMarkerAngle(i,d-m*Math.PI),r.addPoint(i.x,i.y),t&&!isNaN(u)&&!isNaN(h)){var p=a>s?a:s,x=a>s?1:a/s,v=a>s?s/a:1;t.translate(c.x,c.y),t.rotate(l),t.scale(x,v),t.arc(0,0,p,u,u+h,!!(1-o)),t.scale(1/x,1/v),t.rotate(-l),t.translate(-c.x,-c.y)}}static pathZ(t){t.current=t.start}pathZ(t,r){rt.pathZ(this.pathParser),t&&r.x1!==r.x2&&r.y1!==r.y2&&t.closePath()}}class Jx extends rt{constructor(t,r,n){super(t,r,n),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class yi extends sa{constructor(t,r,n){super(t,r,new.target===yi?!0:n),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(t,r);var n=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();n&&(t.textBaseline=n)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(t){if(this.type!=="text")return this.getTElementBoundingBox(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t);var r=null;return this.children.forEach((n,i)=>{var a=this.getChildBoundingBox(t,this,this,i);r?r.addBoundingBox(a):r=a}),r}getFontSize(){var{document:t,parent:r}=this,n=ur.parse(t.ctx.font).fontSize,i=r.getStyle("font-size").getNumber(n);return i}getTElementBoundingBox(t){var r=this.getFontSize();return new fn(this.x,this.y-r,this.x+this.measureText(t),this.y)}getGlyph(t,r,n){var i=r[n],a=null;if(t.isArabic){var s=r.length,o=r[n-1],l=r[n+1],c="isolated";if((n===0||o===" ")&&n<s-1&&l!==" "&&(c="terminal"),n>0&&o!==" "&&n<s-1&&l!==" "&&(c="medial"),n>0&&o!==" "&&(n===s-1||l===" ")&&(c="initial"),typeof t.glyphs[i]!="undefined"){var u=t.glyphs[i];a=u instanceof Jx?u:u[c]}}else a=t.glyphs[i];return a||(a=t.missingGlyph),a}getText(){return""}getTextFromNode(t){var r=t||this.node,n=Array.from(r.parentNode.childNodes),i=n.indexOf(r),a=n.length-1,s=Ja(r.textContent||"");return i===0&&(s=Lk(s)),i===a&&(s=Bk(s)),s}renderChildren(t){if(this.type!=="text"){this.renderTElementChildren(t);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t),this.children.forEach((n,i)=>{this.renderChild(t,this,this,i)});var{mouse:r}=this.document.screen;r.isWorking()&&r.checkBoundingBox(this,this.getBoundingBox(t))}renderTElementChildren(t){var{document:r,parent:n}=this,i=this.getText(),a=n.getStyle("font-family").getDefinition();if(a){for(var{unitsPerEm:s}=a.fontFace,o=ur.parse(r.ctx.font),l=n.getStyle("font-size").getNumber(o.fontSize),c=n.getStyle("font-style").getString(o.fontStyle),u=l/s,h=a.isRTL?i.split("").reverse().join(""):i,m=Cr(n.getAttribute("dx").getString()),d=h.length,g=0;g<d;g++){var p=this.getGlyph(a,h,g);t.translate(this.x,this.y),t.scale(u,-u);var x=t.lineWidth;t.lineWidth=t.lineWidth*s/l,c==="italic"&&t.transform(1,0,.4,1,0,0),p.render(t),c==="italic"&&t.transform(1,0,-.4,1,0,0),t.lineWidth=x,t.scale(1/u,-1/u),t.translate(-this.x,-this.y),this.x+=l*(p.horizAdvX||a.horizAdvX)/s,typeof m[g]!="undefined"&&!isNaN(m[g])&&(this.x+=m[g])}return}var{x:v,y:b}=this;t.fillStyle&&t.fillText(i,v,b),t.strokeStyle&&t.strokeText(i,v,b)}applyAnchoring(){if(!(this.textChunkStart>=this.leafTexts.length)){var t=this.leafTexts[this.textChunkStart],r=t.getStyle("text-anchor").getString("start"),n=!1,i=0;r==="start"&&!n||r==="end"&&n?i=t.x-this.minX:r==="end"&&!n||r==="start"&&n?i=t.x-this.maxX:i=t.x-(this.minX+this.maxX)/2;for(var a=this.textChunkStart;a<this.leafTexts.length;a++)this.leafTexts[a].x+=i;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}}adjustChildCoordinatesRecursive(t){this.children.forEach((r,n)=>{this.adjustChildCoordinatesRecursiveCore(t,this,this,n)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(t,r,n,i){var a=n.children[i];a.children.length>0?a.children.forEach((s,o)=>{r.adjustChildCoordinatesRecursiveCore(t,r,a,o)}):this.adjustChildCoordinates(t,r,n,i)}adjustChildCoordinates(t,r,n,i){var a=n.children[i];if(typeof a.measureText!="function")return a;t.save(),a.setContext(t,!0);var s=a.getAttribute("x"),o=a.getAttribute("y"),l=a.getAttribute("dx"),c=a.getAttribute("dy"),u=a.getStyle("font-family").getDefinition(),h=!!u&&u.isRTL;i===0&&(s.hasValue()||s.setValue(a.getInheritedAttribute("x")),o.hasValue()||o.setValue(a.getInheritedAttribute("y")),l.hasValue()||l.setValue(a.getInheritedAttribute("dx")),c.hasValue()||c.setValue(a.getInheritedAttribute("dy")));var m=a.measureText(t);return h&&(r.x-=m),s.hasValue()?(r.applyAnchoring(),a.x=s.getPixels("x"),l.hasValue()&&(a.x+=l.getPixels("x"))):(l.hasValue()&&(r.x+=l.getPixels("x")),a.x=r.x),r.x=a.x,h||(r.x+=m),o.hasValue()?(a.y=o.getPixels("y"),c.hasValue()&&(a.y+=c.getPixels("y"))):(c.hasValue()&&(r.y+=c.getPixels("y")),a.y=r.y),r.y=a.y,r.leafTexts.push(a),r.minX=Math.min(r.minX,a.x,a.x+m),r.maxX=Math.max(r.maxX,a.x,a.x+m),a.clearContext(t),t.restore(),a}getChildBoundingBox(t,r,n,i){var a=n.children[i];if(typeof a.getBoundingBox!="function")return null;var s=a.getBoundingBox(t);return s?(a.children.forEach((o,l)=>{var c=r.getChildBoundingBox(t,r,a,l);s.addBoundingBox(c)}),s):null}renderChild(t,r,n,i){var a=n.children[i];a.render(t),a.children.forEach((s,o)=>{r.renderChild(t,r,a,o)})}measureText(t){var{measureCache:r}=this;if(~r)return r;var n=this.getText(),i=this.measureTargetText(t,n);return this.measureCache=i,i}measureTargetText(t,r){if(!r.length)return 0;var{parent:n}=this,i=n.getStyle("font-family").getDefinition();if(i){for(var a=this.getFontSize(),s=i.isRTL?r.split("").reverse().join(""):r,o=Cr(n.getAttribute("dx").getString()),l=s.length,c=0,u=0;u<l;u++){var h=this.getGlyph(i,s,u);c+=(h.horizAdvX||i.horizAdvX)*a/i.fontFace.unitsPerEm,typeof o[u]!="undefined"&&!isNaN(o[u])&&(c+=o[u])}return c}if(!t.measureText)return r.length*10;t.save(),this.setContext(t,!0);var{width:m}=t.measureText(r);return this.clearContext(t),t.restore(),m}getInheritedAttribute(t){for(var r=this;r instanceof yi&&r.isFirstChild();){var n=r.parent.getAttribute(t);if(n.hasValue(!0))return n.getValue("0");r=r.parent}return null}}class Dl extends yi{constructor(t,r,n){super(t,r,new.target===Dl?!0:n),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}}class gQ extends Dl{constructor(){super(...arguments),this.type="textNode"}}class Js extends sa{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(t){var r,{document:n}=this,{screen:i,window:a}=n,s=t.canvas;if(i.setDefaults(t),s.style&&typeof t.font!="undefined"&&a&&typeof a.getComputedStyle!="undefined"){t.font=a.getComputedStyle(s).getPropertyValue("font");var o=new Re(n,"fontSize",ur.parse(t.font).fontSize);o.hasValue()&&(n.rootEmSize=o.getPixels("y"),n.emSize=n.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:l,height:c}=i.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var u=this.getAttribute("refX"),h=this.getAttribute("refY"),m=this.getAttribute("viewBox"),d=m.hasValue()?Cr(m.getString()):null,g=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible",p=0,x=0,v=0,b=0;d&&(p=d[0],x=d[1]),this.root||(l=this.getStyle("width").getPixels("x"),c=this.getStyle("height").getPixels("y"),this.type==="marker"&&(v=p,b=x,p=0,x=0)),i.viewPort.setCurrent(l,c),this.node&&(!this.parent||((r=this.node.parentNode)===null||r===void 0?void 0:r.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),d&&(l=d[2],c=d[3]),n.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:i.viewPort.width,desiredWidth:l,height:i.viewPort.height,desiredHeight:c,minX:p,minY:x,refX:u.getValue(),refY:h.getValue(),clip:g,clipX:v,clipY:b}),d&&(i.viewPort.removeCurrent(),i.viewPort.setCurrent(l,c))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getAttribute("width",!0),a=this.getAttribute("height",!0),s=this.getAttribute("viewBox"),o=this.getAttribute("style"),l=i.getNumber(0),c=a.getNumber(0);if(n)if(typeof n=="string")this.getAttribute("preserveAspectRatio",!0).setValue(n);else{var u=this.getAttribute("preserveAspectRatio");u.hasValue()&&u.setValue(u.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(i.setValue(t),a.setValue(r),s.hasValue()||s.setValue("0 0 ".concat(l||t," ").concat(c||r)),o.hasValue()){var h=this.getStyle("width"),m=this.getStyle("height");h.hasValue()&&h.setValue("".concat(t,"px")),m.hasValue()&&m.setValue("".concat(r,"px"))}}}class e1 extends rt{constructor(){super(...arguments),this.type="rect"}path(t){var r=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),i=this.getStyle("width",!1,!0).getPixels("x"),a=this.getStyle("height",!1,!0).getPixels("y"),s=this.getAttribute("rx"),o=this.getAttribute("ry"),l=s.getPixels("x"),c=o.getPixels("y");if(s.hasValue()&&!o.hasValue()&&(c=l),o.hasValue()&&!s.hasValue()&&(l=c),l=Math.min(l,i/2),c=Math.min(c,a/2),t){var u=4*((Math.sqrt(2)-1)/3);t.beginPath(),a>0&&i>0&&(t.moveTo(r+l,n),t.lineTo(r+i-l,n),t.bezierCurveTo(r+i-l+u*l,n,r+i,n+c-u*c,r+i,n+c),t.lineTo(r+i,n+a-c),t.bezierCurveTo(r+i,n+a-c+u*c,r+i-l+u*l,n+a,r+i-l,n+a),t.lineTo(r+l,n+a),t.bezierCurveTo(r+l-u*l,n+a,r,n+a-c+u*c,r,n+a-c),t.lineTo(r,n+c),t.bezierCurveTo(r,n+c-u*c,r+l-u*l,n,r+l,n),t.closePath())}return new fn(r,n,r+i,n+a)}getMarkers(){return null}}class Jk extends rt{constructor(){super(...arguments),this.type="circle"}path(t){var r=this.getAttribute("cx").getPixels("x"),n=this.getAttribute("cy").getPixels("y"),i=this.getAttribute("r").getPixels();return t&&i>0&&(t.beginPath(),t.arc(r,n,i,0,Math.PI*2,!1),t.closePath()),new fn(r-i,n-i,r+i,n+i)}getMarkers(){return null}}class e3 extends rt{constructor(){super(...arguments),this.type="ellipse"}path(t){var r=4*((Math.sqrt(2)-1)/3),n=this.getAttribute("rx").getPixels("x"),i=this.getAttribute("ry").getPixels("y"),a=this.getAttribute("cx").getPixels("x"),s=this.getAttribute("cy").getPixels("y");return t&&n>0&&i>0&&(t.beginPath(),t.moveTo(a+n,s),t.bezierCurveTo(a+n,s+r*i,a+r*n,s+i,a,s+i),t.bezierCurveTo(a-r*n,s+i,a-n,s+r*i,a-n,s),t.bezierCurveTo(a-n,s-r*i,a-r*n,s-i,a,s-i),t.bezierCurveTo(a+r*n,s-i,a+n,s-r*i,a+n,s),t.closePath()),new fn(a-n,s-i,a+n,s+i)}getMarkers(){return null}}class t3 extends rt{constructor(){super(...arguments),this.type="line"}getPoints(){return[new kt(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new kt(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){var[{x:r,y:n},{x:i,y:a}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(r,n),t.lineTo(i,a)),new fn(r,n,i,a)}getMarkers(){var[t,r]=this.getPoints(),n=t.angleTo(r);return[[t,n],[r,n]]}}class t1 extends rt{constructor(t,r,n){super(t,r,n),this.type="polyline",this.points=[],this.points=kt.parsePath(this.getAttribute("points").getString())}path(t){var{points:r}=this,[{x:n,y:i}]=r,a=new fn(n,i);return t&&(t.beginPath(),t.moveTo(n,i)),r.forEach(s=>{var{x:o,y:l}=s;a.addPoint(o,l),t&&t.lineTo(o,l)}),a}getMarkers(){var{points:t}=this,r=t.length-1,n=[];return t.forEach((i,a)=>{a!==r&&n.push([i,i.angleTo(t[a+1])])}),n.length>0&&n.push([t[t.length-1],n[n.length-1][1]]),n}}class r3 extends t1{constructor(){super(...arguments),this.type="polygon"}path(t){var r=super.path(t),[{x:n,y:i}]=this.points;return t&&(t.lineTo(n,i),t.closePath()),r}}class n3 extends Nt{constructor(){super(...arguments),this.type="pattern"}createPattern(t,r,n){var i=this.getStyle("width").getPixels("x",!0),a=this.getStyle("height").getPixels("y",!0),s=new Js(this.document,null);s.attributes.viewBox=new Re(this.document,"viewBox",this.getAttribute("viewBox").getValue()),s.attributes.width=new Re(this.document,"width","".concat(i,"px")),s.attributes.height=new Re(this.document,"height","".concat(a,"px")),s.attributes.transform=new Re(this.document,"transform",this.getAttribute("patternTransform").getValue()),s.children=this.children;var o=this.document.createCanvas(i,a),l=o.getContext("2d"),c=this.getAttribute("x"),u=this.getAttribute("y");c.hasValue()&&u.hasValue()&&l.translate(c.getPixels("x",!0),u.getPixels("y",!0)),n.hasValue()?this.styles["fill-opacity"]=n:Reflect.deleteProperty(this.styles,"fill-opacity");for(var h=-1;h<=1;h++)for(var m=-1;m<=1;m++)l.save(),s.attributes.x=new Re(this.document,"x",h*o.width),s.attributes.y=new Re(this.document,"y",m*o.height),s.render(l),l.restore();var d=t.createPattern(o,"repeat");return d}}class i3 extends Nt{constructor(){super(...arguments),this.type="marker"}render(t,r,n){if(r){var{x:i,y:a}=r,s=this.getAttribute("orient").getString("auto"),o=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(i,a),s==="auto"&&t.rotate(n),o==="strokeWidth"&&t.scale(t.lineWidth,t.lineWidth),t.save();var l=new Js(this.document,null);l.type=this.type,l.attributes.viewBox=new Re(this.document,"viewBox",this.getAttribute("viewBox").getValue()),l.attributes.refX=new Re(this.document,"refX",this.getAttribute("refX").getValue()),l.attributes.refY=new Re(this.document,"refY",this.getAttribute("refY").getValue()),l.attributes.width=new Re(this.document,"width",this.getAttribute("markerWidth").getValue()),l.attributes.height=new Re(this.document,"height",this.getAttribute("markerHeight").getValue()),l.attributes.overflow=new Re(this.document,"overflow",this.getAttribute("overflow").getValue()),l.attributes.fill=new Re(this.document,"fill",this.getAttribute("fill").getColor("black")),l.attributes.stroke=new Re(this.document,"stroke",this.getAttribute("stroke").getValue("none")),l.children=this.children,l.render(t),t.restore(),o==="strokeWidth"&&t.scale(1/t.lineWidth,1/t.lineWidth),s==="auto"&&t.rotate(-n),t.translate(-i,-a)}}}class a3 extends Nt{constructor(){super(...arguments),this.type="defs"}render(){}}class Ku extends sa{constructor(){super(...arguments),this.type="g"}getBoundingBox(t){var r=new fn;return this.children.forEach(n=>{r.addBoundingBox(n.getBoundingBox(t))}),r}}class r1 extends Nt{constructor(t,r,n){super(t,r,n),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:i,children:a}=this;a.forEach(s=>{s.type==="stop"&&i.push(s)})}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,r,n){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(i));var{stops:a}=i,s=this.getGradient(t,r);if(!s)return this.addParentOpacity(n,a[a.length-1].color);if(a.forEach(x=>{s.addColorStop(x.offset,this.addParentOpacity(n,x.color))}),this.getAttribute("gradientTransform").hasValue()){var{document:o}=this,{MAX_VIRTUAL_PIXELS:l,viewPort:c}=o.screen,[u]=c.viewPorts,h=new e1(o,null);h.attributes.x=new Re(o,"x",-l/3),h.attributes.y=new Re(o,"y",-l/3),h.attributes.width=new Re(o,"width",l),h.attributes.height=new Re(o,"height",l);var m=new Ku(o,null);m.attributes.transform=new Re(o,"transform",this.getAttribute("gradientTransform").getValue()),m.children=[h];var d=new Js(o,null);d.attributes.x=new Re(o,"x",0),d.attributes.y=new Re(o,"y",0),d.attributes.width=new Re(o,"width",u.width),d.attributes.height=new Re(o,"height",u.height),d.children=[m];var g=o.createCanvas(u.width,u.height),p=g.getContext("2d");return p.fillStyle=s,d.render(p),p.createPattern(g,"no-repeat")}return s}inheritStopContainer(t){this.attributesToInherit.forEach(r=>{!this.getAttribute(r).hasValue()&&t.getAttribute(r).hasValue()&&this.getAttribute(r,!0).setValue(t.getAttribute(r).getValue())})}addParentOpacity(t,r){if(t.hasValue()){var n=new Re(this.document,"color",r);return n.addOpacity(t).getColor()}return r}}class s3 extends r1{constructor(t,r,n){super(t,r,n),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(t,r){var n=this.getGradientUnits()==="objectBoundingBox",i=n?r.getBoundingBox(t):null;if(n&&!i)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var a=n?i.x+i.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),s=n?i.y+i.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),o=n?i.x+i.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),l=n?i.y+i.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return a===o&&s===l?null:t.createLinearGradient(a,s,o,l)}}class o3 extends r1{constructor(t,r,n){super(t,r,n),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(t,r){var n=this.getGradientUnits()==="objectBoundingBox",i=r.getBoundingBox(t);if(n&&!i)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var a=n?i.x+i.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),s=n?i.y+i.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),o=a,l=s;this.getAttribute("fx").hasValue()&&(o=n?i.x+i.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(l=n?i.y+i.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var c=n?(i.width+i.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),u=this.getAttribute("fr").getPixels();return t.createRadialGradient(o,l,u,a,s,c)}}class l3 extends Nt{constructor(t,r,n){super(t,r,n),this.type="stop";var i=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),a=this.getStyle("stop-opacity"),s=this.getStyle("stop-color",!0);s.getString()===""&&s.setValue("#000"),a.hasValue()&&(s=s.addOpacity(a)),this.offset=i,this.color=s.getColor()}}class Qu extends Nt{constructor(t,r,n){super(t,r,n),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new Re(t,"values",null);var i=this.getAttribute("values");i.hasValue()&&this.values.setValue(i.getString().split(";"))}getProperty(){var t=this.getAttribute("attributeType").getString(),r=this.getAttribute("attributeName").getString();return t==="CSS"?this.parent.getStyle(r,!0):this.parent.getAttribute(r,!0)}calcValue(){var{initialUnits:t}=this,{progress:r,from:n,to:i}=this.getProgress(),a=n.getNumber()+(i.getNumber()-n.getNumber())*r;return t==="%"&&(a*=100),"".concat(a).concat(t)}update(t){var{parent:r}=this,n=this.getProperty();if(this.initialValue||(this.initialValue=n.getString(),this.initialUnits=n.getUnits()),this.duration>this.maxDuration){var i=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(i==="freeze"&&!this.frozen)this.frozen=!0,r.animationFrozen=!0,r.animationFrozenValue=n.getString();else if(i==="remove"&&!this.removed)return this.removed=!0,n.setValue(r.animationFrozen?r.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=t;var a=!1;if(this.begin<this.duration){var s=this.calcValue(),o=this.getAttribute("type");if(o.hasValue()){var l=o.getString();s="".concat(l,"(").concat(s,")")}n.setValue(s),a=!0}return a}getProgress(){var{document:t,values:r}=this,n={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(r.hasValue()){var i=n.progress*(r.getValue().length-1),a=Math.floor(i),s=Math.ceil(i);n.from=new Re(t,"from",parseFloat(r.getValue()[a])),n.to=new Re(t,"to",parseFloat(r.getValue()[s])),n.progress=(i-a)/(s-a)}else n.from=this.from,n.to=this.to;return n}}class c3 extends Qu{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:t,from:r,to:n}=this.getProgress(),i=new Hp(r.getColor()),a=new Hp(n.getColor());if(i.ok&&a.ok){var s=i.r+(a.r-i.r)*t,o=i.g+(a.g-i.g)*t,l=i.b+(a.b-i.b)*t;return"rgb(".concat(Math.floor(s),", ").concat(Math.floor(o),", ").concat(Math.floor(l),")")}return this.getAttribute("from").getColor()}}class u3 extends Qu{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:t,from:r,to:n}=this.getProgress(),i=Cr(r.getString()),a=Cr(n.getString()),s=i.map((o,l)=>{var c=a[l];return o+(c-o)*t}).join(" ");return s}}class f3 extends Nt{constructor(t,r,n){super(t,r,n),this.type="font",this.glyphs=Object.create(null),this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:i}=t,{children:a}=this;for(var s of a)switch(s.type){case"font-face":{this.fontFace=s;var o=s.getStyle("font-family");o.hasValue()&&(i[o.getString()]=this);break}case"missing-glyph":this.missingGlyph=s;break;case"glyph":{var l=s;l.arabicForm?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[l.unicode]=="undefined"&&(this.glyphs[l.unicode]=Object.create(null)),this.glyphs[l.unicode][l.arabicForm]=l):this.glyphs[l.unicode]=l;break}}}render(){}}class h3 extends Nt{constructor(t,r,n){super(t,r,n),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}}class d3 extends rt{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}}class m3 extends yi{constructor(){super(...arguments),this.type="tref"}getText(){var t=this.getHrefAttribute().getDefinition();if(t){var r=t.children[0];if(r)return r.getText()}return""}}class p3 extends yi{constructor(t,r,n){super(t,r,n),this.type="a";var{childNodes:i}=r,a=i[0],s=i.length>0&&Array.from(i).every(o=>o.nodeType===3);this.hasText=s,this.text=s?this.getTextFromNode(a):""}getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);var{document:r,x:n,y:i}=this,{mouse:a}=r.screen,s=new Re(r,"fontSize",ur.parse(r.ctx.font).fontSize);a.isWorking()&&a.checkBoundingBox(this,new fn(n,i-s.getPixels("y"),n+this.measureText(t),i))}else if(this.children.length>0){var o=new Ku(this.document,null);o.children=this.children,o.parent=this,o.render(t)}}onClick(){var{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){var t=this.document.ctx;t.canvas.style.cursor="pointer"}}function eT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eT(Object(r),!0).forEach(function(n){Xx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}class g3 extends yi{constructor(t,r,n){super(t,r,n),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var i=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(i)}getText(){return this.text}path(t){var{dataArray:r}=this;t&&t.beginPath(),r.forEach(n=>{var{type:i,points:a}=n;switch(i){case Me.LINE_TO:t&&t.lineTo(a[0],a[1]);break;case Me.MOVE_TO:t&&t.moveTo(a[0],a[1]);break;case Me.CURVE_TO:t&&t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case Me.QUAD_TO:t&&t.quadraticCurveTo(a[0],a[1],a[2],a[3]);break;case Me.ARC:{var[s,o,l,c,u,h,m,d]=a,g=l>c?l:c,p=l>c?1:l/c,x=l>c?c/l:1;t&&(t.translate(s,o),t.rotate(m),t.scale(p,x),t.arc(0,0,g,u,u+h,!!(1-d)),t.scale(1/p,1/x),t.rotate(-m),t.translate(-s,-o));break}case Me.CLOSE_PATH:t&&t.closePath();break}})}renderChildren(t){this.setTextData(t),t.save();var r=this.parent.getStyle("text-decoration").getString(),n=this.getFontSize(),{glyphInfo:i}=this,a=t.fillStyle;r==="underline"&&t.beginPath(),i.forEach((s,o)=>{var{p0:l,p1:c,rotation:u,text:h}=s;t.save(),t.translate(l.x,l.y),t.rotate(u),t.fillStyle&&t.fillText(h,0,0),t.strokeStyle&&t.strokeText(h,0,0),t.restore(),r==="underline"&&(o===0&&t.moveTo(l.x,l.y+n/8),t.lineTo(c.x,c.y+n/5))}),r==="underline"&&(t.lineWidth=n/20,t.strokeStyle=a,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,r,n,i,a,s,o,l,c){var u=s,h=this.measureText(t,l);l===" "&&r==="justify"&&n<i&&(h+=(i-n)/a),c>-1&&(u+=this.getLetterSpacingAt(c));var m=this.textHeight/20,d=this.getEquidistantPointOnPath(u,m,0),g=this.getEquidistantPointOnPath(u+h,m,0),p={p0:d,p1:g},x=d&&g?Math.atan2(g.y-d.y,g.x-d.x):0;if(o){var v=Math.cos(Math.PI/2+x)*o,b=Math.cos(-x)*o;p.p0=xc(xc({},d),{},{x:d.x+v,y:d.y+b}),p.p1=xc(xc({},g),{},{x:g.x+v,y:g.y+b})}return u+=h,{offset:u,segment:p,rotation:x}}measureText(t,r){var{measuresCache:n}=this,i=r||this.getText();if(n.has(i))return n.get(i);var a=this.measureTargetText(t,i);return n.set(i,a),a}setTextData(t){if(!this.glyphInfo){var r=this.getText(),n=r.split(""),i=r.split(" ").length-1,a=this.parent.getAttribute("dx").split().map(w=>w.getPixels("x")),s=this.parent.getAttribute("dy").getPixels("y"),o=this.parent.getStyle("text-anchor").getString("start"),l=this.getStyle("letter-spacing"),c=this.parent.getStyle("letter-spacing"),u=0;!l.hasValue()||l.getValue()==="inherit"?u=c.getPixels():l.hasValue()&&l.getValue()!=="initial"&&l.getValue()!=="unset"&&(u=l.getPixels());var h=[],m=r.length;this.letterSpacingCache=h;for(var d=0;d<m;d++)h.push(typeof a[d]!="undefined"?a[d]:u);var g=h.reduce((w,k,T)=>T===0?0:w+k||0,0),p=this.measureText(t),x=Math.max(p+g,0);this.textWidth=p,this.textHeight=this.getFontSize(),this.glyphInfo=[];var v=this.getPathLength(),b=this.getStyle("startOffset").getNumber(0)*v,y=0;(o==="middle"||o==="center")&&(y=-x/2),(o==="end"||o==="right")&&(y=-x),y+=b,n.forEach((w,k)=>{var{offset:T,segment:S,rotation:E}=this.findSegmentToFitChar(t,o,x,v,i,y,s,w,k);y=T,!(!S.p0||!S.p1)&&this.glyphInfo.push({text:n[k],p0:S.p0,p1:S.p1,rotation:E})})}}parsePathData(t){if(this.pathLength=-1,!t)return[];var r=[],{pathParser:n}=t;for(n.reset();!n.isEnd();){var{current:i}=n,a=i?i.x:0,s=i?i.y:0,o=n.next(),l=o.type,c=[];switch(o.type){case Me.MOVE_TO:this.pathM(n,c);break;case Me.LINE_TO:l=this.pathL(n,c);break;case Me.HORIZ_LINE_TO:l=this.pathH(n,c);break;case Me.VERT_LINE_TO:l=this.pathV(n,c);break;case Me.CURVE_TO:this.pathC(n,c);break;case Me.SMOOTH_CURVE_TO:l=this.pathS(n,c);break;case Me.QUAD_TO:this.pathQ(n,c);break;case Me.SMOOTH_QUAD_TO:l=this.pathT(n,c);break;case Me.ARC:c=this.pathA(n);break;case Me.CLOSE_PATH:rt.pathZ(n);break}o.type!==Me.CLOSE_PATH?r.push({type:l,points:c,start:{x:a,y:s},pathLength:this.calcLength(a,s,l,c)}):r.push({type:Me.CLOSE_PATH,points:[],pathLength:0})}return r}pathM(t,r){var{x:n,y:i}=rt.pathM(t).point;r.push(n,i)}pathL(t,r){var{x:n,y:i}=rt.pathL(t).point;return r.push(n,i),Me.LINE_TO}pathH(t,r){var{x:n,y:i}=rt.pathH(t).point;return r.push(n,i),Me.LINE_TO}pathV(t,r){var{x:n,y:i}=rt.pathV(t).point;return r.push(n,i),Me.LINE_TO}pathC(t,r){var{point:n,controlPoint:i,currentPoint:a}=rt.pathC(t);r.push(n.x,n.y,i.x,i.y,a.x,a.y)}pathS(t,r){var{point:n,controlPoint:i,currentPoint:a}=rt.pathS(t);return r.push(n.x,n.y,i.x,i.y,a.x,a.y),Me.CURVE_TO}pathQ(t,r){var{controlPoint:n,currentPoint:i}=rt.pathQ(t);r.push(n.x,n.y,i.x,i.y)}pathT(t,r){var{controlPoint:n,currentPoint:i}=rt.pathT(t);return r.push(n.x,n.y,i.x,i.y),Me.QUAD_TO}pathA(t){var{rX:r,rY:n,sweepFlag:i,xAxisRotation:a,centp:s,a1:o,ad:l}=rt.pathA(t);return i===0&&l>0&&(l-=2*Math.PI),i===1&&l<0&&(l+=2*Math.PI),[s.x,s.y,r,n,o,l,a,i]}calcLength(t,r,n,i){var a=0,s=null,o=null,l=0;switch(n){case Me.LINE_TO:return this.getLineLength(t,r,i[0],i[1]);case Me.CURVE_TO:for(a=0,s=this.getPointOnCubicBezier(0,t,r,i[0],i[1],i[2],i[3],i[4],i[5]),l=.01;l<=1;l+=.01)o=this.getPointOnCubicBezier(l,t,r,i[0],i[1],i[2],i[3],i[4],i[5]),a+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;return a;case Me.QUAD_TO:for(a=0,s=this.getPointOnQuadraticBezier(0,t,r,i[0],i[1],i[2],i[3]),l=.01;l<=1;l+=.01)o=this.getPointOnQuadraticBezier(l,t,r,i[0],i[1],i[2],i[3]),a+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;return a;case Me.ARC:{a=0;var c=i[4],u=i[5],h=i[4]+u,m=Math.PI/180;if(Math.abs(c-h)<m&&(m=Math.abs(c-h)),s=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),u<0)for(l=c-m;l>h;l-=m)o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],l,0),a+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;else for(l=c+m;l<h;l+=m)o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],l,0),a+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;return o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],h,0),a+=this.getLineLength(s.x,s.y,o.x,o.y),a}}return 0}getPointOnLine(t,r,n,i,a){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:r,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:n,l=(a-n)/(i-r+Ra),c=Math.sqrt(t*t/(1+l*l));i<r&&(c*=-1);var u=l*c,h=null;if(i===r)h={x:s,y:o+u};else if((o-n)/(s-r+Ra)===l)h={x:s+c,y:o+u};else{var m=0,d=0,g=this.getLineLength(r,n,i,a);if(g<Ra)return null;var p=(s-r)*(i-r)+(o-n)*(a-n);p/=g*g,m=r+p*(i-r),d=n+p*(a-n);var x=this.getLineLength(s,o,m,d),v=Math.sqrt(t*t-x*x);c=Math.sqrt(v*v/(1+l*l)),i<r&&(c*=-1),u=l*c,h={x:m+c,y:d+u}}return h}getPointOnPath(t){var r=this.getPathLength(),n=0,i=null;if(t<-5e-5||t-5e-5>r)return null;var{dataArray:a}=this;for(var s of a){if(s&&(s.pathLength<5e-5||n+s.pathLength+5e-5<t)){n+=s.pathLength;continue}var o=t-n,l=0;switch(s.type){case Me.LINE_TO:i=this.getPointOnLine(o,s.start.x,s.start.y,s.points[0],s.points[1],s.start.x,s.start.y);break;case Me.ARC:{var c=s.points[4],u=s.points[5],h=s.points[4]+u;if(l=c+o/s.pathLength*u,u<0&&l<h||u>=0&&l>h)break;i=this.getPointOnEllipticalArc(s.points[0],s.points[1],s.points[2],s.points[3],l,s.points[6]);break}case Me.CURVE_TO:l=o/s.pathLength,l>1&&(l=1),i=this.getPointOnCubicBezier(l,s.start.x,s.start.y,s.points[0],s.points[1],s.points[2],s.points[3],s.points[4],s.points[5]);break;case Me.QUAD_TO:l=o/s.pathLength,l>1&&(l=1),i=this.getPointOnQuadraticBezier(l,s.start.x,s.start.y,s.points[0],s.points[1],s.points[2],s.points[3]);break}if(i)return i;break}return null}getLineLength(t,r,n,i){return Math.sqrt((n-t)*(n-t)+(i-r)*(i-r))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((t,r)=>r.pathLength>0?t+r.pathLength:t,0)),this.pathLength}getPointOnCubicBezier(t,r,n,i,a,s,o,l,c){var u=l*Gp(t)+s*Yp(t)+i*Xp(t)+r*Kp(t),h=c*Gp(t)+o*Yp(t)+a*Xp(t)+n*Kp(t);return{x:u,y:h}}getPointOnQuadraticBezier(t,r,n,i,a,s,o){var l=s*Qp(t)+i*Zp(t)+r*Jp(t),c=o*Qp(t)+a*Zp(t)+n*Jp(t);return{x:l,y:c}}getPointOnEllipticalArc(t,r,n,i,a,s){var o=Math.cos(s),l=Math.sin(s),c={x:n*Math.cos(a),y:i*Math.sin(a)};return{x:t+(c.x*o-c.y*l),y:r+(c.x*l+c.y*o)}}buildEquidistantCache(t,r){var n=this.getPathLength(),i=r||.25,a=t||n/100;if(!this.equidistantCache||this.equidistantCache.step!==a||this.equidistantCache.precision!==i){this.equidistantCache={step:a,precision:i,points:[]};for(var s=0,o=0;o<=n;o+=i){var l=this.getPointOnPath(o),c=this.getPointOnPath(o+i);!l||!c||(s+=this.getLineLength(l.x,l.y,c.x,c.y),s>=a&&(this.equidistantCache.points.push({x:l.x,y:l.y,distance:o}),s-=a))}}}getEquidistantPointOnPath(t,r,n){if(this.buildEquidistantCache(r,n),t<0||t-this.getPathLength()>5e-5)return null;var i=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[i]||null}}var xQ=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class x3 extends sa{constructor(t,r,n){super(t,r,n),this.type="image",this.loaded=!1;var i=this.getHrefAttribute().getString();if(i){var a=i.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(i);t.images.push(this),a?this.loadSvg(i):this.loadImage(i),this.isSvg=a}}loadImage(t){var r=this;return vi(function*(){try{var n=yield r.document.createImage(t);r.image=n}catch(i){console.error('Error while loading image "'.concat(t,'":'),i)}r.loaded=!0})()}loadSvg(t){var r=this;return vi(function*(){var n=xQ.exec(t);if(n){var i=n[5];n[4]==="base64"?r.image=atob(i):r.image=decodeURIComponent(i)}else try{var a=yield r.document.fetch(t),s=yield a.text();r.image=s}catch(o){console.error('Error while loading image "'.concat(t,'":'),o)}r.loaded=!0})()}renderChildren(t){var{document:r,image:n,loaded:i}=this,a=this.getAttribute("x").getPixels("x"),s=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),l=this.getStyle("height").getPixels("y");if(!(!i||!n||!o||!l)){if(t.save(),t.translate(a,s),this.isSvg){var c=r.canvg.forkString(t,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:o,scaleHeight:l});c.document.documentElement.parent=this,c.render()}else{var u=this.image;r.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:o,desiredWidth:u.width,height:l,desiredHeight:u.height}),this.loaded&&(typeof u.complete=="undefined"||u.complete)&&t.drawImage(u,0,0)}t.restore()}}getBoundingBox(){var t=this.getAttribute("x").getPixels("x"),r=this.getAttribute("y").getPixels("y"),n=this.getStyle("width").getPixels("x"),i=this.getStyle("height").getPixels("y");return new fn(t,r,t+n,r+i)}}class v3 extends sa{constructor(){super(...arguments),this.type="symbol"}render(t){}}class y3{constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}load(t,r){var n=this;return vi(function*(){try{var{document:i}=n,a=yield i.canvg.parser.load(r),s=a.getElementsByTagName("font");Array.from(s).forEach(o=>{var l=i.createElement(o);i.definitions[t]=l})}catch(o){console.error('Error while loading font "'.concat(r,'":'),o)}n.loaded=!0})()}}class n1 extends Nt{constructor(t,r,n){super(t,r,n),this.type="style";var i=Ja(Array.from(r.childNodes).map(s=>s.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")),a=i.split("}");a.forEach(s=>{var o=s.trim();if(o){var l=o.split("{"),c=l[0].split(","),u=l[1].split(";");c.forEach(h=>{var m=h.trim();if(m){var d=t.styles[m]||{};if(u.forEach(x=>{var v=x.indexOf(":"),b=x.substr(0,v).trim(),y=x.substr(v+1,x.length-v).trim();b&&y&&(d[b]=new Re(t,b,y))}),t.styles[m]=d,t.stylesSpecificity[m]=zk(m),m==="@font-face"){var g=d["font-family"].getString().replace(/"|'/g,""),p=d.src.getString().split(",");p.forEach(x=>{if(x.indexOf('format("svg")')>0){var v=Kx(x);v&&new y3(t).load(g,v)}})}}})}})}}n1.parseExternalUrl=Kx;class w3 extends sa{constructor(){super(...arguments),this.type="use"}setContext(t){super.setContext(t);var r=this.getAttribute("x"),n=this.getAttribute("y");r.hasValue()&&t.translate(r.getPixels("x"),0),n.hasValue()&&t.translate(0,n.getPixels("y"))}path(t){var{element:r}=this;r&&r.path(t)}renderChildren(t){var{document:r,element:n}=this;if(n){var i=n;if(n.type==="symbol"&&(i=new Js(r,null),i.attributes.viewBox=new Re(r,"viewBox",n.getAttribute("viewBox").getString()),i.attributes.preserveAspectRatio=new Re(r,"preserveAspectRatio",n.getAttribute("preserveAspectRatio").getString()),i.attributes.overflow=new Re(r,"overflow",n.getAttribute("overflow").getString()),i.children=n.children,n.styles.opacity=new Re(r,"opacity",this.calculateOpacity())),i.type==="svg"){var a=this.getStyle("width",!1,!0),s=this.getStyle("height",!1,!0);a.hasValue()&&(i.attributes.width=new Re(r,"width",a.getString())),s.hasValue()&&(i.attributes.height=new Re(r,"height",s.getString()))}var o=i.parent;i.parent=this,i.render(t),i.parent=o}}getBoundingBox(t){var{element:r}=this;return r?r.getBoundingBox(t):null}elementTransform(){var{document:t,element:r}=this;return Qi.fromElement(t,r)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}}function vc(e,t,r,n,i,a){return e[r*n*4+t*4+a]}function yc(e,t,r,n,i,a,s){e[r*n*4+t*4+a]=s}function It(e,t,r){var n=e[t];return n*r}function ri(e,t,r,n){return t+Math.cos(e)*r+Math.sin(e)*n}class i1 extends Nt{constructor(t,r,n){super(t,r,n),this.type="feColorMatrix";var i=Cr(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{var a=i[0];i=[.213+.787*a,.715-.715*a,.072-.072*a,0,0,.213-.213*a,.715+.285*a,.072-.072*a,0,0,.213-.213*a,.715-.715*a,.072+.928*a,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{var s=i[0]*Math.PI/180;i=[ri(s,.213,.787,-.213),ri(s,.715,-.715,-.715),ri(s,.072,-.072,.928),0,0,ri(s,.213,-.213,.143),ri(s,.715,.285,.14),ri(s,.072,-.072,-.283),0,0,ri(s,.213,-.213,-.787),ri(s,.715,-.715,.715),ri(s,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=i,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(t,r,n,i,a){for(var{includeOpacity:s,matrix:o}=this,l=t.getImageData(0,0,i,a),c=0;c<a;c++)for(var u=0;u<i;u++){var h=vc(l.data,u,c,i,a,0),m=vc(l.data,u,c,i,a,1),d=vc(l.data,u,c,i,a,2),g=vc(l.data,u,c,i,a,3),p=It(o,0,h)+It(o,1,m)+It(o,2,d)+It(o,3,g)+It(o,4,1),x=It(o,5,h)+It(o,6,m)+It(o,7,d)+It(o,8,g)+It(o,9,1),v=It(o,10,h)+It(o,11,m)+It(o,12,d)+It(o,13,g)+It(o,14,1),b=It(o,15,h)+It(o,16,m)+It(o,17,d)+It(o,18,g)+It(o,19,1);s&&(p=0,x=0,v=0,b*=g/255),yc(l.data,u,c,i,a,0,p),yc(l.data,u,c,i,a,1,x),yc(l.data,u,c,i,a,2,v),yc(l.data,u,c,i,a,3,b)}t.clearRect(0,0,i,a),t.putImageData(l,0,0)}}class Pl extends Nt{constructor(){super(...arguments),this.type="mask"}apply(t,r){var{document:n}=this,i=this.getAttribute("x").getPixels("x"),a=this.getAttribute("y").getPixels("y"),s=this.getStyle("width").getPixels("x"),o=this.getStyle("height").getPixels("y");if(!s&&!o){var l=new fn;this.children.forEach(g=>{l.addBoundingBox(g.getBoundingBox(t))}),i=Math.floor(l.x1),a=Math.floor(l.y1),s=Math.floor(l.width),o=Math.floor(l.height)}var c=this.removeStyles(r,Pl.ignoreStyles),u=n.createCanvas(i+s,a+o),h=u.getContext("2d");n.screen.setDefaults(h),this.renderChildren(h),new i1(n,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(h,0,0,i+s,a+o);var m=n.createCanvas(i+s,a+o),d=m.getContext("2d");n.screen.setDefaults(d),r.render(d),d.globalCompositeOperation="destination-in",d.fillStyle=h.createPattern(u,"no-repeat"),d.fillRect(0,0,i+s,a+o),t.fillStyle=d.createPattern(m,"no-repeat"),t.fillRect(0,0,i+s,a+o),this.restoreStyles(r,c)}render(t){}}Pl.ignoreStyles=["mask","transform","clip-path"];var tT=()=>{};class b3 extends Nt{constructor(){super(...arguments),this.type="clipPath"}apply(t){var{document:r}=this,n=Reflect.getPrototypeOf(t),{beginPath:i,closePath:a}=t;n&&(n.beginPath=tT,n.closePath=tT),Reflect.apply(i,t,[]),this.children.forEach(s=>{if(typeof s.path!="undefined"){var o=typeof s.elementTransform!="undefined"?s.elementTransform():null;o||(o=Qi.fromElement(r,s)),o&&o.apply(t),s.path(t),n&&(n.closePath=a),o&&o.unapply(t)}}),Reflect.apply(a,t,[]),t.clip(),n&&(n.beginPath=i,n.closePath=a)}render(t){}}class Ml extends Nt{constructor(){super(...arguments),this.type="filter"}apply(t,r){var{document:n,children:i}=this,a=r.getBoundingBox(t);if(a){var s=0,o=0;i.forEach(v=>{var b=v.extraFilterDistance||0;s=Math.max(s,b),o=Math.max(o,b)});var l=Math.floor(a.width),c=Math.floor(a.height),u=l+2*s,h=c+2*o;if(!(u<1||h<1)){var m=Math.floor(a.x),d=Math.floor(a.y),g=this.removeStyles(r,Ml.ignoreStyles),p=n.createCanvas(u,h),x=p.getContext("2d");n.screen.setDefaults(x),x.translate(-m+s,-d+o),r.render(x),i.forEach(v=>{typeof v.apply=="function"&&v.apply(x,0,0,u,h)}),t.drawImage(p,0,0,u,h,m-s,d-o,u,h),this.restoreStyles(r,g)}}}render(t){}}Ml.ignoreStyles=["filter","transform","clip-path"];class _3 extends Nt{constructor(t,r,n){super(t,r,n),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(t,r,n,i,a){}}class S3 extends Nt{constructor(){super(...arguments),this.type="feMorphology"}apply(t,r,n,i,a){}}class T3 extends Nt{constructor(){super(...arguments),this.type="feComposite"}apply(t,r,n,i,a){}}class E3 extends Nt{constructor(t,r,n){super(t,r,n),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(t,r,n,i,a){var{document:s,blurRadius:o}=this,l=s.window?s.window.document.body:null,c=t.canvas;c.id=s.getUniqueId(),l&&(c.style.display="none",l.appendChild(c)),XK(c,r,n,i,a,o),l&&l.removeChild(c)}}class N3 extends Nt{constructor(){super(...arguments),this.type="title"}}class A3 extends Nt{constructor(){super(...arguments),this.type="desc"}}var vQ={svg:Js,rect:e1,circle:Jk,ellipse:e3,line:t3,polyline:t1,polygon:r3,path:rt,pattern:n3,marker:i3,defs:a3,linearGradient:s3,radialGradient:o3,stop:l3,animate:Qu,animateColor:c3,animateTransform:u3,font:f3,"font-face":h3,"missing-glyph":d3,glyph:Jx,text:yi,tspan:Dl,tref:m3,a:p3,textPath:g3,image:x3,g:Ku,symbol:v3,style:n1,use:w3,mask:Pl,clipPath:b3,filter:Ml,feDropShadow:_3,feMorphology:S3,feComposite:T3,feColorMatrix:i1,feGaussianBlur:E3,title:N3,desc:A3};function rT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function yQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rT(Object(r),!0).forEach(function(n){Xx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wQ(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r}function bQ(e){return tg.apply(this,arguments)}function tg(){return tg=vi(function*(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=document.createElement("img");return t&&(r.crossOrigin="Anonymous"),new Promise((n,i)=>{r.onload=()=>{n(r)},r.onerror=(a,s,o,l,c)=>{i(c)},r.src=e})}),tg.apply(this,arguments)}class hi{constructor(t){var{rootEmSize:r=12,emSize:n=12,createCanvas:i=hi.createCanvas,createImage:a=hi.createImage,anonymousCrossOrigin:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.canvg=t,this.definitions=Object.create(null),this.styles=Object.create(null),this.stylesSpecificity=Object.create(null),this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=r,this.emSize=n,this.createCanvas=i,this.createImage=this.bindCreateImage(a,s),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(t,r){return typeof r=="boolean"?(n,i)=>t(n,typeof i=="boolean"?i:r):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:t}=this;return t[t.length-1]}set emSize(t){var{emSizeStack:r}=this;r.push(t)}popEmSize(){var{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(t=>t.loaded)}isFontsLoaded(){return this.fonts.every(t=>t.loaded)}createDocumentElement(t){var r=this.createElement(t.documentElement);return r.root=!0,r.addStylesFromStyleDefinition(),this.documentElement=r,r}createElement(t){var r=t.nodeName.replace(/^[^:]+:/,""),n=hi.elementTypes[r];return typeof n!="undefined"?new n(this,t):new Zk(this,t)}createTextNode(t){return new gQ(this,t)}setViewBox(t){this.screen.setViewBox(yQ({document:this},t))}}hi.createCanvas=wQ;hi.createImage=bQ;hi.elementTypes=vQ;function nT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ha(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nT(Object(r),!0).forEach(function(n){Xx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}class ya{constructor(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.parser=new Nc(n),this.screen=new jl(t,n),this.options=n;var i=new hi(this,n),a=i.createDocumentElement(r);this.document=i,this.documentElement=a}static from(t,r){var n=arguments;return vi(function*(){var i=n.length>2&&n[2]!==void 0?n[2]:{},a=new Nc(i),s=yield a.parse(r);return new ya(t,s,i)})()}static fromString(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=new Nc(n),a=i.parseFromString(r);return new ya(t,a,n)}fork(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ya.from(t,r,ha(ha({},this.options),n))}forkString(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ya.fromString(t,r,ha(ha({},this.options),n))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var t=arguments,r=this;return vi(function*(){var n=t.length>0&&t[0]!==void 0?t[0]:{};r.start(ha({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},n)),yield r.ready(),r.stop()})()}start(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{documentElement:r,screen:n,options:i}=this;n.start(r,ha(ha({enableRedraw:!0},i),t))}stop(){this.screen.stop()}resize(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(t,r,n)}}const GJ=Object.freeze(Object.defineProperty({__proto__:null,AElement:p3,AnimateColorElement:c3,AnimateElement:Qu,AnimateTransformElement:u3,BoundingBox:fn,CB1:Gp,CB2:Yp,CB3:Xp,CB4:Kp,Canvg:ya,CircleElement:Jk,ClipPathElement:b3,DefsElement:a3,DescElement:A3,Document:hi,Element:Nt,EllipseElement:e3,FeColorMatrixElement:i1,FeCompositeElement:T3,FeDropShadowElement:_3,FeGaussianBlurElement:E3,FeMorphologyElement:S3,FilterElement:Ml,Font:ur,FontElement:f3,FontFaceElement:h3,GElement:Ku,GlyphElement:Jx,GradientElement:r1,ImageElement:x3,LineElement:t3,LinearGradientElement:s3,MarkerElement:i3,MaskElement:Pl,Matrix:Qx,MissingGlyphElement:d3,Mouse:$k,PSEUDO_ZERO:Ra,Parser:Nc,PathElement:rt,PathParser:Me,PatternElement:n3,Point:kt,PolygonElement:r3,PolylineElement:t1,Property:Re,QB1:Qp,QB2:Zp,QB3:Jp,RadialGradientElement:o3,RectElement:e1,RenderedElement:sa,Rotate:Yk,SVGElement:Js,SVGFontLoader:y3,Scale:Xk,Screen:jl,Skew:Zx,SkewX:Kk,SkewY:Qk,StopElement:l3,StyleElement:n1,SymbolElement:v3,TRefElement:m3,TSpanElement:Dl,TextElement:yi,TextPathElement:g3,TitleElement:N3,Transform:Qi,Translate:Gk,UnknownElement:Zk,UseElement:w3,ViewPort:Hk,compressSpaces:Ja,default:ya,getSelectorSpecificity:zk,normalizeAttributeName:Uk,normalizeColor:qk,parseExternalUrl:Kx,presets:JK,toNumbers:Cr,trimLeft:Lk,trimRight:Bk,vectorMagnitude:Vp,vectorsAngle:Wp,vectorsRatio:hu},Symbol.toStringTag,{value:"Module"}));export{PJ as $,AJ as A,Le as B,Fe as C,_u as D,PV as E,UV as F,BV as G,qI as H,ms as I,jQ as J,PQ as K,Ye as L,OQ as M,Hl as N,OJ as O,Am as P,Cm as Q,km as R,Eo as S,zI as T,WE as U,FJ as V,IJ as W,vW as X,Do as Y,jJ as Z,tZ as _,mu as a,cJ as a$,$1 as a0,DJ as a1,IQ as a2,fZ as a3,pZ as a4,mZ as a5,cZ as a6,uZ as a7,dZ as a8,hZ as a9,TP as aA,$Z as aB,QZ as aC,xZ as aD,Pj as aE,DZ as aF,PZ as aG,jZ as aH,IZ as aI,FZ as aJ,OZ as aK,aN as aL,RZ as aM,yZ as aN,vZ as aO,AZ as aP,kZ as aQ,CZ as aR,eJ as aS,tJ as aT,rJ as aU,nJ as aV,iJ as aW,aJ as aX,lJ as aY,oJ as aZ,uJ as a_,NZ as aa,gZ as ab,EZ as ac,TZ as ad,SZ as ae,_Z as af,bZ as ag,wZ as ah,Mj as ai,qZ as aj,zZ as ak,HZ as al,XZ as am,KZ as an,MZ as ao,ay as ap,UZ as aq,BZ as ar,Vo as as,LZ as at,GZ as au,WZ as av,VZ as aw,YZ as ax,Lg as ay,GN as az,ze as b,UQ as b$,sJ as b0,fJ as b1,rZ as b2,WJ as b3,lZ as b4,EJ as b5,TJ as b6,EV as b7,NJ as b8,pJ as b9,bt as bA,kJ as bB,lu as bC,cu as bD,cl as bE,fW as bF,hW as bG,mW as bH,pW as bI,xW as bJ,sZ as bK,aZ as bL,sl as bM,_J as bN,bJ as bO,wJ as bP,Ji as bQ,RQ as bR,Xe as bS,YQ as bT,qQ as bU,zQ as bV,HQ as bW,$Q as bX,VQ as bY,GQ as bZ,WQ as b_,SJ as ba,hJ as bb,dJ as bc,mJ as bd,gJ as be,xJ as bf,vJ as bg,yJ as bh,BJ as bi,LJ as bj,VJ as bk,FQ as bl,DQ as bm,DI as bn,PI as bo,MI as bp,LI as bq,UI as br,BI as bs,oZ as bt,LQ as bu,MQ as bv,BQ as bw,iZ as bx,nZ as by,RJ as bz,He as c,ZQ as c0,AI as c1,QQ as c2,Ic as c3,eZ as c4,KQ as c5,JQ as c6,XQ as c7,JZ as c8,ZZ as c9,$J as ca,zJ as cb,HJ as cc,NK as cd,aK as ce,UJ as cf,qJ as cg,GJ as ch,nt as d,je as e,MJ as f,GE as g,np as h,ip as i,ht as j,HE as k,pl as l,gl as m,xl as n,vl as o,gs as p,No as q,xs as r,Sn as s,mg as t,JR as u,CJ as v,jV as w,DV as x,MV as y,LV as z};
