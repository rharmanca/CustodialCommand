import{r as o,j as s,u as $,v as z,f as w,w as y,b as H}from"./vendor-1jRaonge-v6.js";import{a as q,u as G,b2 as J,B as g,C as m,b as l,c as i,d,e as t,L as R,I as T,b3 as p}from"./index-DUq3a8zQ-v6.js";import"./ui-BQCqNqg0-v6.js";import"./utils-DvvWCVwA-v6.js";import"./forms-qrEI1HMw-v6.js";import"./charts-core-Ci00SAtp-v6.js";import"./pdf-export-DLkp0oRl-v6.js";function es({onBack:v}){const{toast:L}=q(),{isMobile:A}=G(),[F,D]=o.useState(!0),[x,E]=o.useState(!1),[r,I]=o.useState([]),[n,f]=o.useState(""),[c,C]=o.useState(""),[K,k]=o.useState([]);o.useEffect(()=>{const e=new Date,a=new Date(e);a.setDate(e.getDate()-30),C(e.toISOString().split("T")[0]),f(a.toISOString().split("T")[0])},[]);const j=async(e,a)=>{try{D(!0);const N=new URLSearchParams;e&&N.append("startDate",e),a&&N.append("endDate",a);const V=await fetch(`/api/scores?${N.toString()}`);if(!V.ok)throw new Error("Failed to fetch scores");const S=await V.json();I(S.scores||[]),k(S.scores||[])}catch(N){console.error("Error fetching scores:",N),L({title:"Error",description:"Failed to load building scores. Please try again.",variant:"destructive"})}finally{D(!1),E(!1)}};o.useEffect(()=>{n&&c&&j(n,c)},[n,c]);const B=()=>{E(!0),j(n,c)},O=()=>{const e=new Date,a=new Date(e);a.setDate(e.getDate()-30),C(e.toISOString().split("T")[0]),f(a.toISOString().split("T")[0])},U=r.filter(e=>e.score.level2Compliant).length,b=r.length,P=b>0?U/b*100:0,M=r.length>0?r.reduce((e,a)=>e+a.score.overallScore,0)/r.length:0,u=r.length>0?r.reduce((e,a)=>a.score.overallScore>e.score.overallScore?a:e):null,h=r.filter(e=>e.score.overallScore<3);return F&&!x?s.jsxDEV(J,{message:"Loading building scores..."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:111,columnNumber:12},this):s.jsxDEV("div",{className:"container mx-auto p-6 max-w-7xl space-y-6",children:[s.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[s.jsxDEV("div",{children:[s.jsxDEV("h1",{className:"text-3xl font-bold",children:"Building Scores Dashboard"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:119,columnNumber:11},this),s.jsxDEV("p",{className:"text-muted-foreground mt-1",children:"Track custodial performance across all campuses"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:120,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:118,columnNumber:9},this),v&&s.jsxDEV(g,{variant:"outline",onClick:v,children:"← Back"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:125,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:117,columnNumber:7},this),s.jsxDEV(m,{children:[s.jsxDEV(l,{children:s.jsxDEV("div",{className:"flex items-center justify-between",children:[s.jsxDEV("div",{children:[s.jsxDEV(i,{className:"text-lg flex items-center gap-2",children:[s.jsxDEV($,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:137,columnNumber:17},this),"Filter by Date Range"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:136,columnNumber:15},this),s.jsxDEV(d,{children:"View scores for a specific time period"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:140,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:135,columnNumber:13},this),s.jsxDEV(g,{variant:"outline",size:"sm",onClick:B,disabled:x,children:[s.jsxDEV(z,{className:`w-4 h-4 mr-2 ${x?"animate-spin":""}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:148,columnNumber:15},this),"Refresh"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:142,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:134,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:133,columnNumber:9},this),s.jsxDEV(t,{children:s.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsxDEV("div",{className:"space-y-2",children:[s.jsxDEV(R,{htmlFor:"startDate",children:"Start Date"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:156,columnNumber:15},this),s.jsxDEV(T,{id:"startDate",type:"date",value:n,onChange:e=>f(e.target.value)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:157,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:155,columnNumber:13},this),s.jsxDEV("div",{className:"space-y-2",children:[s.jsxDEV(R,{htmlFor:"endDate",children:"End Date"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:165,columnNumber:15},this),s.jsxDEV(T,{id:"endDate",type:"date",value:c,onChange:e=>C(e.target.value)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:166,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:164,columnNumber:13},this),s.jsxDEV("div",{className:"space-y-2 flex items-end",children:s.jsxDEV(g,{variant:"secondary",onClick:O,className:"w-full",children:"Last 30 Days"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:174,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:173,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:154,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:153,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:132,columnNumber:7},this),s.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxDEV(m,{children:[s.jsxDEV(l,{className:"pb-3",children:[s.jsxDEV(d,{children:"Total Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:186,columnNumber:13},this),s.jsxDEV(i,{className:"text-3xl",children:b},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:187,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:185,columnNumber:11},this),s.jsxDEV(t,{children:s.jsxDEV("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsxDEV(w,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:191,columnNumber:15},this),s.jsxDEV("span",{children:"Monitored campuses"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:192,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:190,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:189,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:184,columnNumber:9},this),s.jsxDEV(m,{children:[s.jsxDEV(l,{className:"pb-3",children:[s.jsxDEV(d,{children:"Level 2 Compliance"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:199,columnNumber:13},this),s.jsxDEV(i,{className:"text-3xl text-green-600",children:[P.toFixed(0),"%"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:200,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:198,columnNumber:11},this),s.jsxDEV(t,{children:s.jsxDEV("div",{className:"text-sm text-muted-foreground",children:[U," of ",b," schools ≥3.0"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:205,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:204,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:197,columnNumber:9},this),s.jsxDEV(m,{children:[s.jsxDEV(l,{className:"pb-3",children:[s.jsxDEV(d,{children:"Network Average"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:213,columnNumber:13},this),s.jsxDEV(i,{className:"text-3xl",children:M.toFixed(2)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:214,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:212,columnNumber:11},this),s.jsxDEV(t,{children:s.jsxDEV("div",{className:"text-sm text-muted-foreground",children:"Across all schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:217,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:216,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:211,columnNumber:9},this),s.jsxDEV(m,{children:[s.jsxDEV(l,{className:"pb-3",children:[s.jsxDEV(d,{children:"Needs Attention"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:225,columnNumber:13},this),s.jsxDEV(i,{className:"text-3xl text-yellow-600",children:h.length},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:226,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:224,columnNumber:11},this),s.jsxDEV(t,{children:s.jsxDEV("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsxDEV(y,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:232,columnNumber:15},this),s.jsxDEV("span",{children:"Below Level 2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:233,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:231,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:230,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:223,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:183,columnNumber:7},this),u&&s.jsxDEV(m,{className:"bg-gradient-to-r from-green-50 to-blue-50 border-green-200",children:[s.jsxDEV(l,{children:s.jsxDEV("div",{className:"flex items-center gap-2",children:[s.jsxDEV(H,{className:"w-5 h-5 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:244,columnNumber:15},this),s.jsxDEV(i,{className:"text-lg",children:"Top Performer"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:245,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:243,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:242,columnNumber:11},this),s.jsxDEV(t,{children:s.jsxDEV(p,{school:u.school,score:u.score,complianceStatus:u.complianceStatus,dateRange:u.dateRange,compact:A},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:249,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:248,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:241,columnNumber:9},this),h.length>0&&s.jsxDEV(m,{className:"bg-yellow-50 border-yellow-200",children:[s.jsxDEV(l,{children:[s.jsxDEV("div",{className:"flex items-center gap-2",children:[s.jsxDEV(y,{className:"w-5 h-5 text-yellow-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:265,columnNumber:15},this),s.jsxDEV(i,{className:"text-lg",children:"Schools Needing Attention"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:266,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:264,columnNumber:13},this),s.jsxDEV(d,{children:[h.length," ",h.length===1?"school is":"schools are"," below Level 2 standards"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:268,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:263,columnNumber:11},this),s.jsxDEV(t,{children:s.jsxDEV("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:h.map(e=>s.jsxDEV(p,{school:e.school,score:e.score,complianceStatus:e.complianceStatus,dateRange:e.dateRange,compact:!0},e.school,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:275,columnNumber:17},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:273,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:272,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:262,columnNumber:9},this),s.jsxDEV(m,{children:[s.jsxDEV(l,{children:[s.jsxDEV(i,{children:"All School Scores"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:292,columnNumber:11},this),s.jsxDEV(d,{children:["Showing ",r.length," schools sorted by overall score"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:293,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:291,columnNumber:9},this),s.jsxDEV(t,{children:[s.jsxDEV("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:r.map(e=>s.jsxDEV(p,{school:e.school,score:e.score,complianceStatus:e.complianceStatus,dateRange:e.dateRange,compact:!0},e.school,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:300,columnNumber:15},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:298,columnNumber:11},this),r.length===0&&s.jsxDEV("div",{className:"text-center py-12 text-muted-foreground",children:[s.jsxDEV(w,{className:"w-12 h-12 mx-auto mb-4 opacity-50"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:312,columnNumber:15},this),s.jsxDEV("p",{children:"No scores available for the selected date range."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:313,columnNumber:15},this),s.jsxDEV("p",{className:"text-sm mt-2",children:"Try adjusting your date filters or refresh the page."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:314,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:311,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:297,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:290,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/scores-dashboard.tsx",lineNumber:115,columnNumber:5},this)}export{es as default};
