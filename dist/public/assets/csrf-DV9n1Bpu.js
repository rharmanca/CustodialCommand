let t=null,n=null;async function o(){try{const e=await fetch("/api/csrf-token",{method:"GET",credentials:"include"});if(!e.ok)throw new Error(`Failed to fetch CSRF token: ${e.status}`);const r=await e.json();return t=r.csrfToken,n=Date.now()+r.expiresIn-6e4,console.log("[CSRF] Token fetched successfully"),t}catch(e){throw console.error("[CSRF] Failed to fetch token:",e),e}}function s(){return t}function c(){return!t||!n?!0:Date.now()>=n}async function i(){if(c())try{return await o()}catch(e){return console.error("[CSRF] Failed to refresh token:",e),null}return t}async function a(){try{await o(),console.log("[CSRF] Initialized successfully")}catch(e){console.warn("[CSRF] Initialization failed (backend may not support CSRF yet):",e)}}export{o as fetchCsrfToken,s as getCsrfToken,a as initializeCsrf,c as isTokenExpired,i as refreshCsrfTokenIfNeeded};
