var ht=Object.defineProperty;var pt=(s,r,t)=>r in s?ht(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t;var Ie=(s,r,t)=>pt(s,typeof r!="symbol"?r+"":r,t);import{k as qe,r as n,P as Y,D as ve,j as e,c as ie,R as xt,E as q,b as ft,f as ee,d as Ee,g as Re,h as De,i as Le,e as Ae}from"./index-GKxhZO_L.js";import{u as gt,a as bt,t as vt,n as jt,c as yt,f as $e,b as wt}from"./custodialNotesSchema-BwymSw_A.js";import{L as te,I as ge}from"./label-CvlsU2fj.js";import{T as Nt}from"./textarea-lCue8RB5.js";import{A as St,a as kt,b as Ct,c as It,d as Et,e as Rt,f as Dt,g as Lt}from"./alert-dialog-C0DAypte.js";import{R as At,P as $t,O as Ft,C as Pt}from"./dialog-BX9W4XVJ.js";import{b as le,a as Mt,C as Ot}from"./Combination-r3vHoB5T.js";import{P as we,a as Ne,b as Se}from"./popover-BpYh7vta.js";import{L as Tt}from"./LoadingOverlay-CpMqlN_x.js";import{S as We}from"./save-BTBlV0wr.js";import{C as Fe}from"./circle-help-B9mNE7W7.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=qe("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=qe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=qe("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);var Be=1,zt=.9,Wt=.8,Bt=.17,Pe=.1,Me=.999,Ht=.9999,Kt=.99,Vt=/[\\\/_+.#"@\[\(\{&]/,Gt=/[\\\/_+.#"@\[\(\{&]/g,Yt=/[\s-]/,Ge=/[\s-]/g;function Te(s,r,t,p,o,d,u){if(d===r.length)return o===s.length?Be:Kt;var l=`${o},${d}`;if(u[l]!==void 0)return u[l];for(var S=p.charAt(d),m=t.indexOf(S,o),v=0,f,w,$,M;m>=0;)f=Te(s,r,t,p,m+1,d+1,u),f>v&&(m===o?f*=Be:Vt.test(s.charAt(m-1))?(f*=Wt,$=s.slice(o,m-1).match(Gt),$&&o>0&&(f*=Math.pow(Me,$.length))):Yt.test(s.charAt(m-1))?(f*=zt,M=s.slice(o,m-1).match(Ge),M&&o>0&&(f*=Math.pow(Me,M.length))):(f*=Bt,o>0&&(f*=Math.pow(Me,m-o))),s.charAt(m)!==r.charAt(d)&&(f*=Ht)),(f<Pe&&t.charAt(m-1)===p.charAt(d+1)||p.charAt(d+1)===p.charAt(d)&&t.charAt(m-1)!==p.charAt(d))&&(w=Te(s,r,t,p,m+1,d+2,u),w*Pe>f&&(f=w*Pe)),f>v&&(v=f),m=t.indexOf(S,m+1);return u[l]=v,v}function He(s){return s.toLowerCase().replace(Ge," ")}function Qt(s,r,t){return s=t&&t.length>0?`${s+" "+t.join(" ")}`:s,Te(s,r,He(s),He(r),0,0,{})}var be='[cmdk-group=""]',Oe='[cmdk-group-items=""]',_t='[cmdk-group-heading=""]',Ye='[cmdk-item=""]',Ke=`${Ye}:not([aria-disabled="true"])`,Ue="cmdk-item-select",ne="data-value",Jt=(s,r,t)=>Qt(s,r,t),Qe=n.createContext(void 0),je=()=>n.useContext(Qe),_e=n.createContext(void 0),ze=()=>n.useContext(_e),Je=n.createContext(void 0),Xe=n.forwardRef((s,r)=>{let t=oe(()=>{var a,h;return{search:"",value:(h=(a=s.value)!=null?a:s.defaultValue)!=null?h:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),p=oe(()=>new Set),o=oe(()=>new Map),d=oe(()=>new Map),u=oe(()=>new Set),l=Ze(s),{label:S,children:m,value:v,onValueChange:f,filter:w,shouldFilter:$,loop:M,disablePointerSelection:Q=!1,vimBindings:W=!0,...K}=s,D=le(),ce=le(),B=le(),U=n.useRef(null),C=is();se(()=>{if(v!==void 0){let a=v.trim();t.current.value=a,F.emit()}},[v]),se(()=>{C(6,ye)},[]);let F=n.useMemo(()=>({subscribe:a=>(u.current.add(a),()=>u.current.delete(a)),snapshot:()=>t.current,setState:(a,h,g)=>{var c,j,y,L;if(!Object.is(t.current[a],h)){if(t.current[a]=h,a==="search")ue(),T(),C(1,de);else if(a==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let A=document.getElementById(B);A?A.focus():(c=document.getElementById(D))==null||c.focus()}if(C(7,()=>{var A;t.current.selectedItemId=(A=V())==null?void 0:A.id,F.emit()}),g||C(5,ye),((j=l.current)==null?void 0:j.value)!==void 0){let A=h??"";(L=(y=l.current).onValueChange)==null||L.call(y,A);return}}F.emit()}},emit:()=>{u.current.forEach(a=>a())}}),[]),z=n.useMemo(()=>({value:(a,h,g)=>{var c;h!==((c=d.current.get(a))==null?void 0:c.value)&&(d.current.set(a,{value:h,keywords:g}),t.current.filtered.items.set(a,H(h,g)),C(2,()=>{T(),F.emit()}))},item:(a,h)=>(p.current.add(a),h&&(o.current.has(h)?o.current.get(h).add(a):o.current.set(h,new Set([a]))),C(3,()=>{ue(),T(),t.current.value||de(),F.emit()}),()=>{d.current.delete(a),p.current.delete(a),t.current.filtered.items.delete(a);let g=V();C(4,()=>{ue(),g?.getAttribute("id")===a&&de(),F.emit()})}),group:a=>(o.current.has(a)||o.current.set(a,new Set),()=>{d.current.delete(a),o.current.delete(a)}),filter:()=>l.current.shouldFilter,label:S||s["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:D,inputId:B,labelId:ce,listInnerRef:U}),[]);function H(a,h){var g,c;let j=(c=(g=l.current)==null?void 0:g.filter)!=null?c:Jt;return a?j(a,t.current.search,h):0}function T(){if(!t.current.search||l.current.shouldFilter===!1)return;let a=t.current.filtered.items,h=[];t.current.filtered.groups.forEach(c=>{let j=o.current.get(c),y=0;j.forEach(L=>{let A=a.get(L);y=Math.max(A,y)}),h.push([c,y])});let g=U.current;_().sort((c,j)=>{var y,L;let A=c.getAttribute("id"),J=j.getAttribute("id");return((y=a.get(J))!=null?y:0)-((L=a.get(A))!=null?L:0)}).forEach(c=>{let j=c.closest(Oe);j?j.appendChild(c.parentElement===j?c:c.closest(`${Oe} > *`)):g.appendChild(c.parentElement===g?c:c.closest(`${Oe} > *`))}),h.sort((c,j)=>j[1]-c[1]).forEach(c=>{var j;let y=(j=U.current)==null?void 0:j.querySelector(`${be}[${ne}="${encodeURIComponent(c[0])}"]`);y?.parentElement.appendChild(y)})}function de(){let a=_().find(g=>g.getAttribute("aria-disabled")!=="true"),h=a?.getAttribute(ne);F.setState("value",h||void 0)}function ue(){var a,h,g,c;if(!t.current.search||l.current.shouldFilter===!1){t.current.filtered.count=p.current.size;return}t.current.filtered.groups=new Set;let j=0;for(let y of p.current){let L=(h=(a=d.current.get(y))==null?void 0:a.value)!=null?h:"",A=(c=(g=d.current.get(y))==null?void 0:g.keywords)!=null?c:[],J=H(L,A);t.current.filtered.items.set(y,J),J>0&&j++}for(let[y,L]of o.current)for(let A of L)if(t.current.filtered.items.get(A)>0){t.current.filtered.groups.add(y);break}t.current.filtered.count=j}function ye(){var a,h,g;let c=V();c&&(((a=c.parentElement)==null?void 0:a.firstChild)===c&&((g=(h=c.closest(be))==null?void 0:h.querySelector(_t))==null||g.scrollIntoView({block:"nearest"})),c.scrollIntoView({block:"nearest"}))}function V(){var a;return(a=U.current)==null?void 0:a.querySelector(`${Ye}[aria-selected="true"]`)}function _(){var a;return Array.from(((a=U.current)==null?void 0:a.querySelectorAll(Ke))||[])}function me(a){let h=_()[a];h&&F.setState("value",h.getAttribute(ne))}function he(a){var h;let g=V(),c=_(),j=c.findIndex(L=>L===g),y=c[j+a];(h=l.current)!=null&&h.loop&&(y=j+a<0?c[c.length-1]:j+a===c.length?c[0]:c[j+a]),y&&F.setState("value",y.getAttribute(ne))}function pe(a){let h=V(),g=h?.closest(be),c;for(;g&&!c;)g=a>0?os(g,be):ls(g,be),c=g?.querySelector(Ke);c?F.setState("value",c.getAttribute(ne)):he(a)}let xe=()=>me(_().length-1),fe=a=>{a.preventDefault(),a.metaKey?xe():a.altKey?pe(1):he(1)},re=a=>{a.preventDefault(),a.metaKey?me(0):a.altKey?pe(-1):he(-1)};return n.createElement(Y.div,{ref:r,tabIndex:-1,...K,"cmdk-root":"",onKeyDown:a=>{var h;(h=K.onKeyDown)==null||h.call(K,a);let g=a.nativeEvent.isComposing||a.keyCode===229;if(!(a.defaultPrevented||g))switch(a.key){case"n":case"j":{W&&a.ctrlKey&&fe(a);break}case"ArrowDown":{fe(a);break}case"p":case"k":{W&&a.ctrlKey&&re(a);break}case"ArrowUp":{re(a);break}case"Home":{a.preventDefault(),me(0);break}case"End":{a.preventDefault(),xe();break}case"Enter":{a.preventDefault();let c=V();if(c){let j=new Event(Ue);c.dispatchEvent(j)}}}}},n.createElement("label",{"cmdk-label":"",htmlFor:z.inputId,id:z.labelId,style:ds},S),Ce(s,a=>n.createElement(_e.Provider,{value:F},n.createElement(Qe.Provider,{value:z},a))))}),Xt=n.forwardRef((s,r)=>{var t,p;let o=le(),d=n.useRef(null),u=n.useContext(Je),l=je(),S=Ze(s),m=(p=(t=S.current)==null?void 0:t.forceMount)!=null?p:u?.forceMount;se(()=>{if(!m)return l.item(o,u?.id)},[m]);let v=et(o,d,[s.value,s.children,d],s.keywords),f=ze(),w=G(C=>C.value&&C.value===v.current),$=G(C=>m||l.filter()===!1?!0:C.search?C.filtered.items.get(o)>0:!0);n.useEffect(()=>{let C=d.current;if(!(!C||s.disabled))return C.addEventListener(Ue,M),()=>C.removeEventListener(Ue,M)},[$,s.onSelect,s.disabled]);function M(){var C,F;Q(),(F=(C=S.current).onSelect)==null||F.call(C,v.current)}function Q(){f.setState("value",v.current,!0)}if(!$)return null;let{disabled:W,value:K,onSelect:D,forceMount:ce,keywords:B,...U}=s;return n.createElement(Y.div,{ref:ve(d,r),...U,id:o,"cmdk-item":"",role:"option","aria-disabled":!!W,"aria-selected":!!w,"data-disabled":!!W,"data-selected":!!w,onPointerMove:W||l.getDisablePointerSelection()?void 0:Q,onClick:W?void 0:M},s.children)}),Zt=n.forwardRef((s,r)=>{let{heading:t,children:p,forceMount:o,...d}=s,u=le(),l=n.useRef(null),S=n.useRef(null),m=le(),v=je(),f=G($=>o||v.filter()===!1?!0:$.search?$.filtered.groups.has(u):!0);se(()=>v.group(u),[]),et(u,l,[s.value,s.heading,S]);let w=n.useMemo(()=>({id:u,forceMount:o}),[o]);return n.createElement(Y.div,{ref:ve(l,r),...d,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},t&&n.createElement("div",{ref:S,"cmdk-group-heading":"","aria-hidden":!0,id:m},t),Ce(s,$=>n.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?m:void 0},n.createElement(Je.Provider,{value:w},$))))}),es=n.forwardRef((s,r)=>{let{alwaysRender:t,...p}=s,o=n.useRef(null),d=G(u=>!u.search);return!t&&!d?null:n.createElement(Y.div,{ref:ve(o,r),...p,"cmdk-separator":"",role:"separator"})}),ts=n.forwardRef((s,r)=>{let{onValueChange:t,...p}=s,o=s.value!=null,d=ze(),u=G(m=>m.search),l=G(m=>m.selectedItemId),S=je();return n.useEffect(()=>{s.value!=null&&d.setState("search",s.value)},[s.value]),n.createElement(Y.input,{ref:r,...p,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":S.listId,"aria-labelledby":S.labelId,"aria-activedescendant":l,id:S.inputId,type:"text",value:o?s.value:u,onChange:m=>{o||d.setState("search",m.target.value),t?.(m.target.value)}})}),ss=n.forwardRef((s,r)=>{let{children:t,label:p="Suggestions",...o}=s,d=n.useRef(null),u=n.useRef(null),l=G(m=>m.selectedItemId),S=je();return n.useEffect(()=>{if(u.current&&d.current){let m=u.current,v=d.current,f,w=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let $=m.offsetHeight;v.style.setProperty("--cmdk-list-height",$.toFixed(1)+"px")})});return w.observe(m),()=>{cancelAnimationFrame(f),w.unobserve(m)}}},[]),n.createElement(Y.div,{ref:ve(d,r),...o,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":p,id:S.listId},Ce(s,m=>n.createElement("div",{ref:ve(u,S.listInnerRef),"cmdk-list-sizer":""},m)))}),rs=n.forwardRef((s,r)=>{let{open:t,onOpenChange:p,overlayClassName:o,contentClassName:d,container:u,...l}=s;return n.createElement(At,{open:t,onOpenChange:p},n.createElement($t,{container:u},n.createElement(Ft,{"cmdk-overlay":"",className:o}),n.createElement(Pt,{"aria-label":s.label,"cmdk-dialog":"",className:d},n.createElement(Xe,{ref:r,...l}))))}),as=n.forwardRef((s,r)=>G(t=>t.filtered.count===0)?n.createElement(Y.div,{ref:r,...s,"cmdk-empty":"",role:"presentation"}):null),ns=n.forwardRef((s,r)=>{let{progress:t,children:p,label:o="Loading...",...d}=s;return n.createElement(Y.div,{ref:r,...d,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},Ce(s,u=>n.createElement("div",{"aria-hidden":!0},u)))}),O=Object.assign(Xe,{List:ss,Item:Xt,Input:ts,Group:Zt,Separator:es,Dialog:rs,Empty:as,Loading:ns});function os(s,r){let t=s.nextElementSibling;for(;t;){if(t.matches(r))return t;t=t.nextElementSibling}}function ls(s,r){let t=s.previousElementSibling;for(;t;){if(t.matches(r))return t;t=t.previousElementSibling}}function Ze(s){let r=n.useRef(s);return se(()=>{r.current=s}),r}var se=typeof window>"u"?n.useEffect:n.useLayoutEffect;function oe(s){let r=n.useRef();return r.current===void 0&&(r.current=s()),r}function G(s){let r=ze(),t=()=>s(r.snapshot());return n.useSyncExternalStore(r.subscribe,t,t)}function et(s,r,t,p=[]){let o=n.useRef(),d=je();return se(()=>{var u;let l=(()=>{var m;for(let v of t){if(typeof v=="string")return v.trim();if(typeof v=="object"&&"current"in v)return v.current?(m=v.current.textContent)==null?void 0:m.trim():o.current}})(),S=p.map(m=>m.trim());d.value(s,l,S),(u=r.current)==null||u.setAttribute(ne,l),o.current=l}),o}var is=()=>{let[s,r]=n.useState(),t=oe(()=>new Map);return se(()=>{t.current.forEach(p=>p()),t.current=new Map},[s]),(p,o)=>{t.current.set(p,o),r({})}};function cs(s){let r=s.type;return typeof r=="function"?r(s.props):"render"in r?r.render(s.props):s}function Ce({asChild:s,children:r},t){return s&&n.isValidElement(r)?n.cloneElement(cs(r),{ref:r.ref},t(r.props.children)):t(r)}var ds={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const tt=n.forwardRef(({className:s,...r},t)=>e.jsx(O,{ref:t,className:ie("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...r}));tt.displayName=O.displayName;const st=n.forwardRef(({className:s,...r},t)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(qt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(O.Input,{ref:t,className:ie("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...r})]}));st.displayName=O.Input.displayName;const us=n.forwardRef(({className:s,...r},t)=>e.jsx(O.List,{ref:t,className:ie("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...r}));us.displayName=O.List.displayName;const rt=n.forwardRef((s,r)=>e.jsx(O.Empty,{ref:r,className:"py-6 text-center text-sm",...s}));rt.displayName=O.Empty.displayName;const at=n.forwardRef(({className:s,...r},t)=>e.jsx(O.Group,{ref:t,className:ie("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...r}));at.displayName=O.Group.displayName;const ms=n.forwardRef(({className:s,...r},t)=>e.jsx(O.Separator,{ref:t,className:ie("-mx-1 h-px bg-border",s),...r}));ms.displayName=O.Separator.displayName;const nt=n.forwardRef(({className:s,...r},t)=>e.jsx(O.Item,{ref:t,className:ie("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s),...r}));nt.displayName=O.Item.displayName;class hs extends xt.Component{constructor(t){super(t);Ie(this,"handleRetry",()=>{window.location.reload()});Ie(this,"handleClearData",()=>{try{localStorage.clear(),console.log("LocalStorage cleared successfully")}catch(t){console.error("Failed to clear localStorage:",t)}window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,p){console.error("LocalStorage Error Boundary caught an error:",t),console.error("Component Stack:",p.componentStack),this.setState({errorInfo:p})}render(){const{hasError:t,error:p,errorInfo:o}=this.state,{children:d,fallback:u}=this.props;return t?u||e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"rounded-full bg-red-100 p-3",children:e.jsx("svg",{className:"h-8 w-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:"Something Went Wrong"}),e.jsx("p",{className:"text-gray-600 text-center mb-6",children:"We encountered an issue saving your preferences. This might happen if your browser's storage is full or if you're using private browsing mode."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:this.handleRetry,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors",children:"Retry"}),e.jsx("button",{onClick:this.handleClearData,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-4 rounded-md transition-colors",children:"Clear Saved Data & Retry"})]}),!1]})}):d}}const Ve={WARNING:80,CRITICAL:95};function ps(s={}){const{onWarning:r,checkInterval:t=3e4,checkOnMount:p=!0}=s,o=n.useRef(new Set),d=async()=>{try{const u=await q.getQuotaInfo();if(!u||u.percentage===0)return;const{percentage:l,usage:S,quota:m}=u,v=f=>{const w=f/1048576;return w<1?`${(f/1024).toFixed(1)} KB`:`${w.toFixed(1)} MB`};if(l>=Ve.CRITICAL){const f=`critical-${Math.floor(l)}`;o.current.has(f)||(console.warn(`[Storage Quota Monitor] CRITICAL: Storage at ${l.toFixed(1)}% capacity`),r?.(`Your browser storage is nearly full (${l.toFixed(1)}% used). Using ${v(S)} of ${v(m)} available. Please clear old data or browser cache to continue using this feature.`,l,"critical"),o.current.add(f))}else if(l>=Ve.WARNING){const f=`warning-${Math.floor(l/5)*5}`;o.current.has(f)||(console.warn(`[Storage Quota Monitor] WARNING: Storage at ${l.toFixed(1)}% capacity`),r?.(`Your browser storage is ${l.toFixed(1)}% full. Using ${v(S)} of ${v(m)} available. Consider clearing old data to ensure smooth operation.`,l,"warning"),o.current.add(f))}}catch(u){console.error("[Storage Quota Monitor] Failed to check quota:",u)}};return n.useEffect(()=>{p&&d();const u=setInterval(d,t);return()=>{clearInterval(u)}},[t,p,r]),{checkQuota:d}}const xs=["ASA","CBR","GWC","LCA","OA","WLC"],fs=`
  @keyframes progress {
    from {
      width: 0%;
    }
    to {
      width: 100%;
    }
  }
`;function Rs({onBack:s}){const{toast:r}=ft();ps({onWarning:(i,x,b)=>{r({variant:b==="critical"?"destructive":"default",title:b==="critical"?"‚ö†Ô∏è Storage Almost Full":"‚ö° Storage Warning",description:i,duration:7e3})},checkInterval:3e4,checkOnMount:!0});const{register:t,handleSubmit:p,formState:{errors:o,isSubmitting:d},reset:u,setValue:l,getValues:S,watch:m,clearErrors:v}=gt({resolver:vt(wt),defaultValues:bt}),f=m(),[w,$]=n.useState([]),[M,Q]=n.useState([]),[W,K]=n.useState(!1),[D,ce]=n.useState(null),[B,U]=n.useState(!1),[C,F]=n.useState(!1),[z,H]=n.useState(""),[T,de]=n.useState(null),[ue,ye]=n.useState(!0),[V,_]=n.useState(!1),[me,he]=n.useState(!0),[pe,xe]=n.useState([]),[fe,re]=n.useState(null),[a,h]=n.useState(!1),[g,c]=n.useState(!1),[j,y]=n.useState(!1),[L,A]=n.useState(null);n.useEffect(()=>{const i=()=>{const x=document.querySelectorAll(".form-section"),b=window.scrollY+window.innerHeight/2;x.forEach((I,E)=>{const N=I.getBoundingClientRect(),k=N.top+window.scrollY,P=k+N.height;b>=k&&b<P&&de(E+1)}),window.scrollY>100&&ye(!1)};return window.addEventListener("scroll",i),i(),()=>window.removeEventListener("scroll",i)},[]),n.useEffect(()=>{const i=()=>{const x=window.innerWidth<=768,b=window.innerHeight<500;_(x&&b)};return i(),window.addEventListener("resize",i),window.addEventListener("orientationchange",i),()=>{window.removeEventListener("resize",i),window.removeEventListener("orientationchange",i)}},[]),n.useEffect(()=>{if(Object.values(f).some(x=>x&&x!=="")&&!B){const x=setTimeout(()=>{h(!0);const b={...f,selectedSchool:z,savedAt:new Date().toISOString()};q.setItem("custodialNotesDraft",JSON.stringify(b)),re(new Date),h(!1)},2e3);return()=>clearTimeout(x)}},[f,z,B]),n.useEffect(()=>{try{const i=q.getItem("custodialNotesDraft");let x=!1;if(i){const I=JSON.parse(i),E=new Date(I.savedAt);(Date.now()-E.getTime())/(1e3*60*60)<24?(x=!0,Object.keys(I).forEach(k=>{k!=="savedAt"&&k!=="selectedSchool"&&l(k,I[k])}),I.selectedSchool&&(H(I.selectedSchool),l("school",I.selectedSchool)),re(E),r({title:"Draft Restored",description:`Your work from ${E.toLocaleString()} was restored.`,duration:5e3})):q.removeItem("custodialNotesDraft")}if(!x){const I=q.getItem("custodialInspectorName");I&&l("inspectorName",I);const E=q.getItem("custodialLastSchool");E&&(H(E),l("school",E))}const b=q.getItem("custodialRecentLocations");if(b){const I=JSON.parse(b);xe(Array.isArray(I)?I:[])}}catch(i){console.error("Error loading saved data:",i)}},[l,H,r]);const J=async i=>{const x=i.target.files;if(x&&x.length>0){const b=Array.from(x),E=5-w.length,N=b.slice(0,E);N.length<b.length&&r({title:"Maximum Images Reached",description:`Only ${N.length} images were added. Maximum of 5 images allowed.`});const k=[];let P=0,ae=0;for(const R of N)if(P+=R.size,jt(R,500))try{const Z=await yt(R,{maxSizeKB:500});k.push(Z.compressedFile),ae+=Z.compressedSize,console.log(`Compressed ${R.name}: ${$e(R.size)} ‚Üí ${$e(Z.compressedSize)}`)}catch(Z){console.error("Failed to compress image:",Z),k.push(R),ae+=R.size}else k.push(R),ae+=R.size;$(R=>[...R,...k]);const X=k.map(R=>URL.createObjectURL(R));if(Q(R=>[...R,...X]),k.length>0){const R=P-ae,Z=R>0?(R/P*100).toFixed(1):"0";r({title:"üì∏ Photos Uploaded Successfully!",description:`Successfully added ${k.length} photo${k.length>1?"s":""} to your custodial note documentation.${R>0?` Saved ${$e(R)} (${Z}% compression).`:""}`,duration:3e3})}}i.target.value=""},ot=()=>{if(w.length>=5){r({variant:"destructive",title:"Maximum Images Reached",description:"Maximum of 5 images allowed. Please remove some images first."});return}const i=document.createElement("input");i.type="file",i.accept="image/*",i.capture="environment",i.onchange=x=>{const b=x;b.target.files&&b.target.files.length>0&&r({title:"üì∑ Photo Captured Successfully!",description:"Camera photo is being processed and added to your documentation.",duration:2e3}),J(b)},i.click()},lt=i=>{const x=w.filter((I,E)=>E!==i),b=M.filter((I,E)=>E!==i);URL.revokeObjectURL(M[i]),$(x),Q(b)},it=i=>{i.trim()&&xe(x=>{const b=x.filter(E=>E!==i),I=[i,...b].slice(0,5);try{q.setItem("custodialRecentLocations",JSON.stringify(I))}catch(E){console.error("Error saving recent locations:",E)}return I})},ct=()=>{L&&(l("inspectorName",L.inspectorName),l("school",L.school),l("date",L.date),l("location",L.location),l("locationDescription",L.locationDescription||""),H(L.school),l("notes",""),l("images",[]),y(!1),A(null),window.scrollTo({top:0,behavior:"smooth"}),r({title:"Form Pre-filled",description:"Inspector, school, date, and location have been filled in. Just add new notes and photos!",duration:4e3}))},dt=()=>{y(!1),A(null),s&&s()},ut=async i=>{ce(i),K(!0)},mt=async()=>{if(D){U(!0),K(!1);try{const i=new FormData;Object.entries(D).forEach(([N,k])=>{N!=="images"&&i.append(N,k?.toString()||"")}),w.forEach(N=>{i.append("images",N)});const x={method:"POST",body:i,headers:{}},b=new AbortController,I=setTimeout(()=>b.abort(),3e4);x.signal=b.signal;const E=await fetch("/api/custodial-notes",x);if(clearTimeout(I),E.ok){c(!0),q.removeItem("custodialNotesDraft");try{q.setItem("custodialInspectorName",D.inspectorName),q.setItem("custodialLastSchool",z),it(D.location)}catch(P){console.error("Error saving user preferences:",P)}A(D),r({title:"‚úÖ Custodial Note Submitted Successfully!",description:"Your custodial concern has been recorded and will be reviewed.",variant:"default",duration:5e3});const N=D.inspectorName,k=z;u(),l("inspectorName",N),l("school",k),H(k),$([]),M.forEach(P=>URL.revokeObjectURL(P)),Q([]),ce(null),re(null),U(!1),setTimeout(()=>{c(!1),y(!0)},3e3)}else{const N=await E.json().catch(()=>({success:!1,message:"Unknown error occurred",details:"Unable to parse server response"}));let k=N.message||"Unable to submit custodial note. Please try again.",P="";N.success===!1&&N.details&&(Array.isArray(N.details)?P=`Please check: ${N.details.map(X=>`${X.field}: ${X.message}`).join(", ")}`:typeof N.details=="object"?P=`Required: ${Object.entries(N.details).filter(([X,R])=>R==="‚úó required").map(([X])=>X.replace(/([A-Z])/g," $1").trim()).join(", ")}`:P=N.details),(N.technical==="FormData parsing failed"||N.message?.includes("form data is malformed"))&&(k="Form submission error",P="Please refresh the page and try submitting again. If the problem persists, contact support."),r({variant:"destructive",title:"‚ùå Submission Failed",description:`${k}${P?`

${P}`:""}`,duration:8e3}),U(!1)}}catch(i){console.error("Error submitting custodial note:",i);let x="Network Error",b="Unable to connect to the server. Please check your connection and try again.";i instanceof Error&&i.name==="AbortError"?(x="Request Timeout",b=`The request took too long to complete. This might be due to:
‚Ä¢ Slow internet connection
‚Ä¢ Large file uploads
‚Ä¢ Server being busy

Please try again.`):i instanceof TypeError&&(i.message.includes("Failed to fetch")?(x="Connection Failed",b=`Unable to reach the server. Please check:
‚Ä¢ Internet connection
‚Ä¢ Server is running
‚Ä¢ No firewall blocking the request`):i.message.includes("NetworkError")&&(x="Network Error",b="A network error occurred. Please try again.")),r({variant:"destructive",title:`‚ùå ${x}`,description:b,duration:8e3}),U(!1)}}};return e.jsxs(hs,{children:[e.jsx("style",{children:fs}),e.jsxs("div",{className:"max-w-3xl mx-auto p-6 space-y-8",children:[s&&e.jsx(ee,{onClick:s,variant:"outline",className:"mb-4 back-button min-h-[48px] px-6",children:"‚Üê Back to Custodial"}),V&&me&&e.jsx("div",{className:"bg-orange-50 border-2 border-orange-400 rounded-lg p-4 shadow-lg",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("span",{className:"text-2xl flex-shrink-0",children:"üì±"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-orange-900 text-lg mb-1",children:"Landscape Mode Detected"}),e.jsxs("p",{className:"text-orange-800 text-sm",children:["For the best experience filling out this form, please"," ",e.jsx("strong",{children:"rotate your device to portrait mode"})," ","(vertical orientation)."]})]})]}),e.jsx(ee,{variant:"ghost",size:"sm",onClick:()=>he(!1),className:"text-orange-900 hover:bg-orange-100 flex-shrink-0",children:"‚úï"})]})}),fe&&e.jsx("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-500",children:a?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-4 w-4 animate-pulse"}),e.jsx("span",{children:"Saving draft..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:["Draft saved at ",fe.toLocaleTimeString()]})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-blue-800 mb-2",children:"Submit Custodial Note"}),e.jsx("p",{className:"text-gray-600",children:"Report maintenance issues, concerns, or general observations"})]}),e.jsx("div",{className:"sticky top-0 z-10 bg-white/95 backdrop-blur-sm border-b-2 border-blue-200 py-3 -mx-6 px-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Form Progress:"}),T&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-bold bg-blue-100 text-blue-800 border-2 border-blue-300",children:["Section ",T," of 3"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:`w-16 h-2 rounded-full transition-colors ${T===1?"bg-blue-600":T&&T>1?"bg-blue-400":"bg-gray-200"}`}),e.jsx("div",{className:`w-16 h-2 rounded-full transition-colors ${T===2?"bg-blue-600":T&&T>2?"bg-blue-400":"bg-gray-200"}`}),e.jsx("div",{className:`w-16 h-2 rounded-full transition-colors ${T===3?"bg-blue-600":"bg-gray-200"}`})]})]})}),ue&&e.jsxs("div",{className:"animate-bounce text-center text-gray-500 text-sm",children:[e.jsx(Mt,{className:"inline-block"}),e.jsx("p",{children:"Scroll down to continue"})]}),e.jsx("div",{className:"bg-amber-50 border-2 border-amber-400 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl flex-shrink-0",children:"‚≠ê"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-amber-900 text-lg mb-1",children:"New Requirement: Inspector Name"}),e.jsxs("p",{className:"text-amber-800 text-sm",children:["Please enter your name in the ",e.jsx("strong",{children:"Inspector Name"})," ","field. This is now required for all custodial notes to ensure proper accountability and follow-up."]})]})]})}),e.jsxs("form",{onSubmit:p(ut),className:"space-y-8",children:[e.jsxs(Ee,{className:"form-section",children:[e.jsxs(Re,{children:[e.jsx(De,{children:"Basic Information"}),e.jsx(Le,{children:"Enter the basic details for this custodial note"})]}),e.jsxs(Ae,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(te,{htmlFor:"inspectorName",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"Inspector Name"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"}),e.jsxs(we,{children:[e.jsx(Ne,{asChild:!0,children:e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Fe,{className:"h-4 w-4"})})}),e.jsxs(Se,{className:"w-80 text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Why is this required?"}),e.jsx("p",{className:"text-gray-600",children:"Your name ensures accountability and allows for proper follow-up on reported issues. This helps maintain quality standards across all facilities."})]})]})]}),e.jsx(ge,{id:"inspectorName",...t("inspectorName"),placeholder:"Enter your name",className:"border-2 min-h-[48px]"}),o.inspectorName&&e.jsx("p",{className:"text-sm text-red-500",children:o.inspectorName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(te,{htmlFor:"school",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"School"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"})]}),e.jsxs(we,{open:C,onOpenChange:F,children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(ee,{variant:"outline",role:"combobox","aria-expanded":C,className:"w-full justify-between border-2 min-h-[48px] text-left font-normal",children:[z||"Select school...",e.jsx(Ut,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Se,{className:"w-full p-0",align:"start",children:e.jsxs(tt,{children:[e.jsx(st,{placeholder:"Search schools..."}),e.jsx(rt,{children:"No school found."}),e.jsx(at,{children:xs.map(i=>e.jsxs(nt,{value:i,onSelect:x=>{const b=x.toUpperCase();H(b),l("school",b),F(!1)},className:"min-h-[48px] cursor-pointer",children:[e.jsx(Ot,{className:`mr-2 h-4 w-4 ${z===i?"opacity-100":"opacity-0"}`}),i]},i))})]})})]}),o.school&&e.jsx("p",{className:"text-sm text-red-500",children:o.school.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(te,{htmlFor:"date",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"Date"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"date",type:"date",...t("date"),className:"border-2 min-h-[48px] pr-10"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})})]}),o.date&&e.jsx("p",{className:"text-sm text-red-500",children:o.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(te,{htmlFor:"location",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"Location"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"}),e.jsxs(we,{children:[e.jsx(Ne,{asChild:!0,children:e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Fe,{className:"h-4 w-4"})})}),e.jsxs(Se,{className:"w-80 text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Location Examples"}),e.jsxs("ul",{className:"text-gray-600 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:'Room numbers: "Room 105", "Classroom 202"'}),e.jsx("li",{children:'Common areas: "Gymnasium", "Cafeteria", "Library"'}),e.jsx("li",{children:'Outdoor: "Playground", "Parking Lot", "Field"'}),e.jsx("li",{children:'Facilities: "Restroom 1st Floor", "Main Office"'})]})]})]})]}),pe.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1.5",children:"Recent locations:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:pe.map((i,x)=>e.jsx("button",{type:"button",onClick:()=>{l("location",i),o.location&&v("location")},className:"inline-flex items-center px-3 py-1.5 rounded-md text-sm bg-blue-50 text-blue-700 border border-blue-200 hover:bg-blue-100 hover:border-blue-300 transition-colors",children:i},x))})]}),e.jsx(ge,{id:"location",...t("location"),placeholder:"e.g., Room 105, Gymnasium, Cafeteria",className:"border-2 min-h-[48px]"}),o.location&&e.jsx("p",{className:"text-sm text-red-500",children:o.location.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"locationDescription",children:"Location Description"}),e.jsx(ge,{id:"locationDescription",...t("locationDescription"),placeholder:"e.g., Main Building, East Wing, 2nd Floor",className:"min-h-[48px]"}),o.locationDescription&&e.jsx("p",{className:"text-sm text-red-500",children:o.locationDescription.message})]})]})]}),e.jsxs(Ee,{className:"form-section",children:[e.jsxs(Re,{children:[e.jsxs(De,{className:"flex items-center gap-2",children:["Issue Description & Notes",e.jsxs(we,{children:[e.jsx(Ne,{asChild:!0,children:e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Fe,{className:"h-4 w-4"})})}),e.jsxs(Se,{className:"w-80 text-sm",children:[e.jsx("p",{className:"font-semibold mb-2",children:"What to Include"}),e.jsxs("ul",{className:"text-gray-600 space-y-1 list-disc list-inside",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"What:"})," Describe the issue clearly"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Where:"})," Specific location details"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"When:"})," When you noticed it"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Severity:"})," Is it urgent or can it wait?"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Impact:"})," How does it affect operations?"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Action:"})," What needs to be done?"]})]})]})]})]}),e.jsx(Le,{children:"Provide detailed information about the custodial issue or observation"})]}),e.jsxs(Ae,{children:[e.jsx(Nt,{...t("notes"),placeholder:`Describe the issue, maintenance need, or observation...

Examples:
‚Ä¢ Broken equipment or fixtures
‚Ä¢ Cleaning supply needs
‚Ä¢ Safety concerns
‚Ä¢ Maintenance requests
‚Ä¢ General observations
‚Ä¢ Follow-up needed`,rows:10,className:"min-h-[250px]"}),o.notes&&e.jsx("p",{className:"text-sm text-red-500 mt-2",children:o.notes.message})]})]}),e.jsxs(Ee,{className:"form-section",children:[e.jsxs(Re,{children:[e.jsx(De,{children:"Photos & Documentation"}),e.jsx(Le,{children:"Upload images or capture photos to document the issue"})]}),e.jsxs(Ae,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(te,{htmlFor:"imageUpload",className:"block mb-2",children:"Upload Images (Optional)"}),e.jsx(ge,{id:"imageUpload",type:"file",accept:"image/*",multiple:!0,onChange:J,className:"hidden"}),e.jsx(ee,{type:"button",onClick:()=>document.getElementById("imageUpload")?.click(),variant:"outline",className:"w-full h-12 border-2 border-dashed hover:border-blue-500 hover:bg-blue-50 transition-colors",children:e.jsxs("span",{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"text-2xl",children:"üìÅ"}),e.jsxs("span",{className:"font-medium",children:["Tap to Select Photos"," ",w.length>0&&`(${w.length} selected)`]})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum 5 images ‚Ä¢ Images auto-compressed"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(ee,{type:"button",onClick:ot,variant:"outline",className:"w-full sm:w-auto h-12 border-2",children:e.jsxs("span",{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"text-xl",children:"üì∑"}),e.jsx("span",{children:"Capture Photo"})]})})})]}),M.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs(te,{className:"block mb-2",children:["Uploaded Images (",w.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:M.map((i,x)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:i,alt:`Upload ${x+1}`,className:"w-full h-24 object-cover rounded-lg border"}),e.jsx(ee,{type:"button",onClick:()=>lt(x),variant:"destructive",size:"sm",className:"absolute top-1 right-1 w-6 h-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:"√ó"})]},x))})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(ee,{type:"submit",size:"lg",disabled:d||B,className:"w-full md:w-auto disabled:bg-gray-400 disabled:cursor-not-allowed min-h-[56px] text-lg font-semibold transition-all duration-300 relative overflow-hidden",children:d||B?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-5 h-5 border-3 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-5 h-5 border-3 border-white/30 rounded-full"})]}),e.jsx("span",{className:"animate-pulse",children:"Submitting your report..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5"}),e.jsx("span",{children:"Submit Custodial Note"})]})})})]}),e.jsx(St,{open:W,onOpenChange:K,children:e.jsxs(kt,{className:"max-w-lg",children:[e.jsxs(Ct,{children:[e.jsx(It,{className:"text-blue-800 text-xl",children:"‚úÖ Confirm Submission"}),e.jsx(Et,{className:"text-left",children:"Please review your custodial note before submitting:"})]}),D&&e.jsx("div",{className:"space-y-3 py-4",children:e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Inspector:"}),e.jsx("p",{className:"text-gray-900",children:D.inspectorName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"School:"}),e.jsx("p",{className:"text-gray-900",children:D.school})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Date:"}),e.jsx("p",{className:"text-gray-900",children:D.date})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Location:"}),e.jsx("p",{className:"text-gray-900",children:D.location})]})]}),D.locationDescription&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Location Details:"}),e.jsx("p",{className:"text-gray-900 text-sm",children:D.locationDescription})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Notes:"}),e.jsx("p",{className:"text-gray-900 text-sm max-h-24 overflow-y-auto",children:D.notes&&D.notes.length>200?`${D.notes.substring(0,200)}...`:D.notes||"No notes provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Photos:"}),e.jsxs("p",{className:"text-gray-900",children:[w.length," image",w.length!==1?"s":""," ","attached"]})]})]})}),e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Review/Edit"}),e.jsx(Lt,{onClick:mt,className:"bg-blue-600 hover:bg-blue-700",children:"Confirm & Submit"})]})]})}),B&&e.jsx(Tt,{message:"Submitting report..."}),g&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsx("div",{className:"bg-white rounded-2xl p-8 max-w-md mx-4 shadow-2xl animate-in zoom-in duration-500",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center animate-bounce",children:e.jsx("div",{className:"w-20 h-20 bg-green-500 rounded-full flex items-center justify-center animate-pulse",children:e.jsx("svg",{className:"w-12 h-12 text-white animate-in zoom-in duration-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})}),e.jsx(ke,{className:"absolute -top-2 -right-2 h-8 w-8 text-yellow-400 animate-pulse"}),e.jsx(ke,{className:"absolute -bottom-2 -left-2 h-6 w-6 text-yellow-400 animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx(ke,{className:"absolute -top-2 -left-2 h-5 w-5 text-blue-400 animate-pulse",style:{animationDelay:"0.4s"}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-700",children:"üéâ Success!"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Your custodial note has been submitted successfully!"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting you back to the home page..."})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-400 to-blue-500 rounded-full animate-[progress_3s_ease-in-out]",style:{animation:"progress 3s ease-in-out forwards"}})})]})})}),j&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsx("div",{className:"bg-white rounded-2xl p-8 max-w-md mx-4 shadow-2xl animate-in zoom-in duration-500",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Report Another Issue?"}),e.jsx("p",{className:"text-gray-600",children:"Found another issue at the same location?"}),e.jsx("p",{className:"text-sm text-gray-500",children:"We can pre-fill your inspector name, school, date, and location to save you time!"})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:ct,className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors shadow-md hover:shadow-lg min-h-[48px]",children:"üìù Report Another Issue Here"}),e.jsx("button",{onClick:dt,className:"w-full px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold rounded-lg transition-colors min-h-[48px]",children:"üè† Return to Home"})]})]})})})]})]})}export{Rs as default};
