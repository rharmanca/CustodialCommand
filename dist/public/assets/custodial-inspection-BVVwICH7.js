import{r as c,j as e,c as A,S as ke,C as ue,a as Te,u as Ae,b as Fe,B as z,d as C,e as $,f as w,H as Ee,g as R,h as U,i as M,U as Le,X as Be}from"./index-4DckXIaq.js";import{u as Pe,C as te,n as _e,c as ze,f as W,i as Re,t as Ue,s as Me}from"./custodialNotesSchema-BFYL3grL.js";import{refreshCsrfTokenIfNeeded as qe,getCsrfToken as He}from"./csrf-DV9n1Bpu.js";import{m as Oe,g as Ge,l as Ve,S as J,p as We,s as Je,C as re,a as Ke,c as Ye}from"./collapsible-section-nogldR-M.js";import{L as j,I as k}from"./label-BE0WgpM2.js";import{T as Xe}from"./textarea-8-nmm-aC.js";import{S as oe,a as ie,b as le,c as ne,d as ce}from"./select-PluCiKET.js";import{D as Qe,a as Ze,b as es,c as ss,d as as}from"./dialog-Df1PYfXV.js";import{C as ts}from"./chevron-right-CFDGvT-W.js";import{r as q,i as de}from"./custodial-criteria-aPNJLI_7.js";import{L as rs}from"./LoadingOverlay-C8p87-47.js";import{C as os}from"./Combination-_DVhngsD.js";import{S as K}from"./save-BUw8ak8E.js";import{S as me}from"./star-BltVc4Fy.js";import{C as is}from"./calendar-BxX4VFjJ.js";const pe=c.forwardRef(({...d},l)=>e.jsx("nav",{ref:l,"aria-label":"breadcrumb",...d}));pe.displayName="Breadcrumb";const xe=c.forwardRef(({className:d,...l},m)=>e.jsx("ol",{ref:m,className:A("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",d),...l}));xe.displayName="BreadcrumbList";const Y=c.forwardRef(({className:d,...l},m)=>e.jsx("li",{ref:m,className:A("inline-flex items-center gap-1.5",d),...l}));Y.displayName="BreadcrumbItem";const he=c.forwardRef(({asChild:d,className:l,...m},b)=>{const I=d?ke:"a";return e.jsx(I,{ref:b,className:A("transition-colors hover:text-foreground",l),...m})});he.displayName="BreadcrumbLink";const ge=c.forwardRef(({className:d,...l},m)=>e.jsx("span",{ref:m,role:"link","aria-disabled":"true","aria-current":"page",className:A("font-normal text-foreground",d),...l}));ge.displayName="BreadcrumbPage";const fe=({children:d,className:l,...m})=>e.jsx("li",{role:"presentation","aria-hidden":"true",className:A("[&>svg]:w-3.5 [&>svg]:h-3.5",l),...m,children:d??e.jsx(ts,{})});fe.displayName="BreadcrumbSeparator";function ls({status:d,lastSaved:l,errorMessage:m,className:b=""}){const[I,o]=c.useState("");c.useEffect(()=>{if(!l){o("");return}const E=()=>{const p=new Date().getTime()-l.getTime(),D=Math.floor(p/1e3),v=Math.floor(D/60);D<10?o("just now"):D<60?o(`${D}s ago`):v<60?o(`${v}m ago`):o(l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))};E();const X=setInterval(E,1e4);return()=>clearInterval(X)},[l]);const N=(()=>{switch(d){case"saving":return{icon:K,text:"Saving...",bgColor:"bg-blue-100 border-blue-300",textColor:"text-blue-800",iconColor:"text-blue-600",animate:!0};case"saved":return{icon:os,text:I?`Saved ${I}`:"Saved",bgColor:"bg-green-100 border-green-300",textColor:"text-green-800",iconColor:"text-green-600",animate:!1};case"error":return{icon:Te,text:m||"Save failed",bgColor:"bg-red-100 border-red-300",textColor:"text-red-800",iconColor:"text-red-600",animate:!1};default:return{icon:ue,text:"Not saved",bgColor:"bg-gray-100 border-gray-300",textColor:"text-gray-700",iconColor:"text-gray-500",animate:!1}}})(),r=N.icon;return e.jsxs("div",{className:`fixed bottom-4 right-4 z-50 flex items-center gap-2 px-4 py-2 rounded-lg border-2 shadow-lg transition-all duration-200 ${N.bgColor} ${b}`,role:"status","aria-live":"polite",children:[e.jsx(r,{className:`h-4 w-4 ${N.iconColor} ${N.animate?"animate-pulse":""}`}),e.jsx("span",{className:`text-sm font-medium ${N.textColor}`,children:N.text})]})}function Ss({onBack:d}){const{isMobile:l}=Ae(),{toast:m}=Fe(),{register:b,handleSubmit:I,formState:{errors:o,isSubmitting:F},reset:N,setValue:r,watch:E,getValues:X,control:H}=Pe({resolver:Ue(Me),defaultValues:Re}),p=E(),[D,v]=c.useState(!1),[be,O]=c.useState([]),[y,T]=c.useState(null),[L,B]=c.useState(null),[G,Q]=c.useState(!1),[je,V]=c.useState("idle"),Ne=[{value:"ASA",label:"ASA"},{value:"LCA",label:"LCA"},{value:"GWC",label:"GWC"},{value:"OA",label:"OA"},{value:"CBR",label:"CBR"},{value:"WLC",label:"WLC"}],Z=[{value:"exterior",label:"Exterior"},{value:"gym_bleachers",label:"Gym and Bleachers"},{value:"classroom",label:"Classroom"},{value:"cafeteria",label:"Cafeteria"},{value:"utility_storage",label:"Utility Or Storage"},{value:"admin_office",label:"Admin or Office Area"},{value:"hallway",label:"Hallway"},{value:"stairwell",label:"Stairwell"},{value:"restroom",label:"Restroom"},{value:"staff_single_restroom",label:"Staff or Single Restroom"}],[g,P]=c.useState([]);c.useEffect(()=>{Oe(),ve();const s=Ge();console.log("Storage stats:",s)},[]),c.useEffect(()=>{if(y){const s=setTimeout(()=>{ee()},2e3);return()=>clearTimeout(s)}},[p,g,y]);const ve=()=>{try{const s=Ve(J.DRAFT_INSPECTION);s&&(O([s]),v(!0));const a=localStorage.getItem("custodial_inspection_drafts");if(a&&!s){const n=JSON.parse(a).filter(u=>{const h=new Date(u.lastModified),i=new Date;return i.setDate(i.getDate()-7),h>i});n.length>0&&(O(n),v(!0))}}catch(s){console.error("Error loading draft inspections:",s)}},ye=()=>`draft_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,ee=async()=>{if(!(!p.school||!p.date)){Q(!0),V("saving");try{const s=y||ye();y||T(s);const a=[];for(const n of g)try{const u=await We(n);a.push(u)}catch(u){console.error("Failed to process image:",u)}const t={id:s,...p,selectedImages:a,lastModified:new Date().toISOString(),title:`${p.school} - ${p.roomNumber||"Room"} - ${p.locationCategory||"Inspection"}`};Je(J.DRAFT_INSPECTION,t),B(new Date),V("saved")}catch(s){console.error("Error saving draft:",s),V("error")}finally{Q(!1)}}},Se=s=>{if(r("inspectorName",s.inspectorName||""),r("school",s.school||""),r("date",s.date||""),r("inspectionType",s.inspectionType||"single_room"),r("locationDescription",s.locationDescription||""),r("roomNumber",s.roomNumber||""),r("locationCategory",s.locationCategory||""),r("floors",s.floors||0),r("verticalHorizontalSurfaces",s.verticalHorizontalSurfaces||0),r("ceiling",s.ceiling||0),r("restrooms",s.restrooms||0),r("customerSatisfaction",s.customerSatisfaction||0),r("trash",s.trash||0),r("projectCleaning",s.projectCleaning||0),r("activitySupport",s.activitySupport||0),r("safetyCompliance",s.safetyCompliance||0),r("equipment",s.equipment||0),r("monitoring",s.monitoring||0),r("notes",s.notes||""),s.selectedImages&&s.selectedImages.length>0){const a=s.selectedImages.map((t,n)=>{const u=atob(t.split(",")[1]),h=new Array(u.length);for(let f=0;f<u.length;f++)h[f]=u.charCodeAt(f);const i=new Uint8Array(h);return new File([i],`image_${n}.jpg`,{type:"image/jpeg"})});P(a)}T(s.id),v(!1)},se=s=>{Ye(J.DRAFT_INSPECTION);const a=JSON.parse(localStorage.getItem("custodial_inspection_drafts")||"[]"),t=a.filter(n=>n.id!==s);t.length!==a.length&&localStorage.setItem("custodial_inspection_drafts",JSON.stringify(t)),O([]),y===s&&(T(null),B(null))},Ce=()=>{v(!1),T(null),B(null)},ae=async s=>{const a=s.target.files;if(a&&a.length>0){const t=Array.from(a),u=5-g.length,h=t.slice(0,u),i=[];let f=0,_=0;for(const x of h)if(f+=x.size,_e(x,500))try{const S=await ze(x,{maxSizeKB:500});i.push(S.compressedFile),_+=S.compressedSize,console.log(`Compressed ${x.name}: ${W(x.size)} ‚Üí ${W(S.compressedSize)}`)}catch(S){console.error("Failed to compress image:",S),i.push(x),_+=x.size}else i.push(x),_+=x.size;if(P(x=>[...x,...i]),i.length>0){const x=f-_,S=(x/f*100).toFixed(1);m({title:"üì∏ Photos Uploaded Successfully!",description:`Added ${i.length} photo${i.length>1?"s":""} to inspection documentation.${x>0?` Saved ${W(x)} (${S}% compression).`:""}`,duration:3e3})}h.length<t.length&&m({variant:"destructive",title:"Upload Limit Reached",description:`Only ${h.length} photos were added. Maximum of 5 images allowed per inspection.`,duration:5e3}),console.log("Files selected:",i.length,"files")}},we=s=>{P(a=>a.filter((t,n)=>n!==s))},Ie=async s=>{try{const a=new FormData;Object.entries(s).forEach(([i,f])=>{i!=="images"&&a.append(i,f?.toString()||"")}),g.forEach(i=>{a.append("images",i)});const t=new AbortController,n=setTimeout(()=>t.abort(),3e4);await qe();const u=He(),h=await fetch("/api/inspections",{method:"POST",body:a,signal:t.signal,credentials:"include",headers:u?{"x-csrf-token":u}:{}});if(clearTimeout(n),h.ok)m({title:"‚úÖ Inspection Submitted Successfully!",description:`Single area inspection for ${s.school} has been submitted and saved.`,variant:"default",duration:5e3}),y&&se(y),N(),P([]),T(null),B(null),setTimeout(()=>{d&&d()},6e3);else{const i=await h.json().catch(()=>({message:"Unknown error"}));m({variant:"destructive",title:"Submission Failed",description:`Error: ${i.message||"Unable to submit inspection. Please try again."}`,duration:7e3})}}catch(a){console.error("Error submitting inspection:",a);let t="Submission Failed",n="Unable to submit inspection. Please try again.";a instanceof Error&&(a.name==="AbortError"?(t="Request Timeout",n="The request took too long to complete. This might be due to slow internet connection or large file uploads. Please try again."):a.message.includes("NetworkError")||a.message.includes("fetch")?(t="Network Error",n="Unable to connect to the server. Please check your connection and try again."):(a.message.includes("validation")||a.message.includes("Invalid"))&&(t="Invalid Data",n="Please check all required fields and try again.")),m({variant:"destructive",title:t,description:n,duration:7e3})}},De=c.useCallback((s,a)=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-3 text-center",children:"Rate this category:"}),e.jsx("div",{className:"flex justify-center gap-2 mb-4",children:[1,2,3,4,5].map(t=>e.jsx("button",{type:"button",className:"p-3 min-w-[48px] min-h-[48px] rounded-md hover:bg-yellow-50 transition-colors touch-manipulation flex items-center justify-center",onClick:()=>r(s.key,t),"aria-label":`Rate ${t} star${t>1?"s":""} for ${s.label}`,children:e.jsx(me,{className:`w-7 h-7 ${t<=a&&a>0?"fill-yellow-400 text-yellow-400":"text-gray-300 hover:text-yellow-300"}`})},t))}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",className:`px-6 py-3 min-h-[48px] rounded-md border text-sm font-medium transition-colors touch-manipulation ${a===0?"bg-gray-100 border-gray-300 text-gray-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,onClick:()=>r(s.key,0),"aria-label":`Clear rating for ${s.label}`,children:"Not Rated"})})]}),e.jsx("div",{className:"text-center",children:a>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{variant:"secondary",className:"text-sm px-3 py-1",children:q[a-1]?.label}),e.jsx("div",{className:"text-xs text-muted-foreground",children:q[a-1]?.description})]}):e.jsx(z,{variant:"outline",className:"text-sm px-3 py-1",children:"No rating selected"})}),a>0&&s.criteria&&s.criteria[a]&&e.jsx(C,{className:"bg-blue-50 border-blue-200",children:e.jsx($,{className:"p-3",children:e.jsxs("div",{className:"text-xs text-blue-800",children:[e.jsxs("strong",{className:"text-sm",children:["Rating ",a," Criteria:"]}),e.jsx("p",{className:"mt-1 leading-relaxed",children:s.criteria[a]})]})})})]}),[r]),$e=c.useCallback((s,a)=>e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[e.jsx(w,{type:"button",variant:a===0?"default":"outline",size:"sm",className:"px-4 py-3 text-xs min-h-[48px]",onClick:()=>r(s.key,0),"aria-label":`Clear rating for ${s.label}`,children:"Not Rated"}),[1,2,3,4,5].map(t=>e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"min-w-[48px] min-h-[48px]",onClick:()=>r(s.key,t),"aria-label":`Rate ${t} star${t>1?"s":""} for ${s.label}`,children:e.jsx(me,{className:`w-7 h-7 ${t<=a&&a>0?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},t))]}),e.jsx("div",{className:"text-center px-3",children:a>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{variant:"secondary",className:"text-sm px-3 py-1",children:q[a-1]?.label}),e.jsx("div",{className:"text-xs text-gray-600 leading-relaxed",children:q[a-1]?.description})]}):e.jsx(z,{variant:"outline",className:"text-sm px-3 py-1",children:"No rating selected"})}),a>0&&s.criteria&&s.criteria[a]&&e.jsx(C,{className:"bg-accent/10 border-accent/30",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"text-xs text-accent-foreground",children:[e.jsxs("strong",{className:"text-sm",children:["Rating ",a," Criteria:"]}),e.jsx("p",{className:"mt-1 leading-relaxed",children:s.criteria[a]})]})})})]}),[r]);return e.jsxs(e.Fragment,{children:[e.jsx(Qe,{open:D,onOpenChange:v,children:e.jsxs(Ze,{className:"max-w-2xl",children:[e.jsxs(es,{children:[e.jsx(ss,{children:"Resume Previous Inspection?"}),e.jsx(as,{children:"You have unfinished inspection drafts. Would you like to continue one of them or start a new inspection?"})]}),e.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[be.map(s=>e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last modified: ",new Date(s.lastModified).toLocaleString()]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["School: ",s.school," ‚Ä¢ Date: ",s.date,s.roomNumber&&` ‚Ä¢ Room: ${s.roomNumber}`]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(w,{size:"sm",onClick:()=>Se(s),children:"Resume"}),e.jsx(w,{size:"sm",variant:"outline",onClick:()=>se(s.id),children:"Delete"})]})]})},s.id)),e.jsx("div",{className:"flex justify-center space-x-4 pt-4",children:e.jsx(w,{onClick:Ce,variant:"outline",children:"Start New Inspection"})})]})]})}),e.jsxs("div",{className:"container mx-auto p-6 max-w-4xl",children:[e.jsx(pe,{className:"mb-4",children:e.jsxs(xe,{children:[e.jsx(Y,{children:e.jsxs(he,{onClick:d,className:"flex items-center gap-1 cursor-pointer",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Home"})]})}),e.jsx(fe,{}),e.jsx(Y,{children:e.jsx(ge,{children:"Single Area Inspection"})})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Submit Inspection"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Use this form to inspect a single room or location. Example: Cafeteria. If performing a whole building inspection please select that from the previous screen."}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800 leading-relaxed",children:[e.jsx("strong",{children:"üìã Important:"})," This form is for inspecting a single room or area using the same rating criteria as the Whole Building Inspection. However, single area inspections are recorded separately and do not automatically count toward a building-wide inspection or monthly metrics. If you're conducting these inspections as part of a comprehensive building review or to meet monthly inspection requirements, you'll need to manually track your progress across all required areas."]})}),(L||G)&&e.jsx("div",{className:"mt-2 flex items-center space-x-2 text-sm text-muted-foreground",children:G?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Saving..."})]}):L?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsxs("span",{children:["Last saved: ",L.toLocaleTimeString()]})]}):null}),y&&e.jsxs(w,{type:"button",variant:"outline",onClick:ee,disabled:G,className:"mt-4",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Save Draft"]})]}),e.jsxs("form",{onSubmit:I(Ie),className:"space-y-6",children:[e.jsxs(C,{children:[e.jsxs(R,{children:[e.jsx(U,{children:"Basic Information"}),e.jsx(M,{children:"Enter the basic details for this inspection"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[e.jsx(j,{htmlFor:"inspectorName",children:"Inspector Name *"}),e.jsx(k,{id:"inspectorName",...b("inspectorName"),placeholder:"Enter your name","aria-required":"true","aria-describedby":o.inspectorName?"inspectorName-error":void 0,"aria-invalid":o.inspectorName?"true":void 0,className:"border-2 min-h-[48px]"}),o.inspectorName&&e.jsx("p",{id:"inspectorName-error",className:"text-sm text-red-500 mt-1",role:"alert",children:o.inspectorName.message})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"school",id:"school-label",children:"School *"}),e.jsx(te,{name:"school",control:H,render:({field:s})=>e.jsxs(oe,{value:s.value,onValueChange:s.onChange,children:[e.jsx(ie,{"aria-required":"true","aria-labelledby":"school-label","aria-describedby":o.school?"school-error":void 0,"aria-invalid":o.school?"true":void 0,children:e.jsx(le,{placeholder:"Select school"})}),e.jsx(ne,{children:Ne.map(a=>e.jsx(ce,{value:a.value,children:a.label},a.value))})]})}),o.school&&e.jsx("p",{id:"school-error",className:"text-sm text-red-500 mt-1",role:"alert",children:o.school.message})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"date",children:"Inspection Date *"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{id:"date",type:"date",...b("date"),"aria-required":"true","aria-describedby":o.date?"date-error date-help":"date-help","aria-invalid":o.date?"true":void 0,className:"pr-10"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground","aria-hidden":"true",children:e.jsx(is,{className:"w-4 h-4"})})]}),o.date&&e.jsx("p",{id:"date-error",className:"text-sm text-red-500 mt-1",role:"alert",children:o.date.message}),e.jsx("p",{id:"date-help",className:"text-sm text-muted-foreground mt-1",children:"Click the field or calendar icon to select a date"})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"locationCategory",children:"Location Category"}),e.jsx(te,{name:"locationCategory",control:H,render:({field:s})=>e.jsxs(oe,{value:s.value,onValueChange:s.onChange,children:[e.jsx(ie,{children:e.jsx(le,{placeholder:"Select location category"})}),e.jsx(ne,{children:Z.map(a=>e.jsx(ce,{value:a.value,children:a.label},a.value))})]})}),o.locationCategory&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:o.locationCategory.message})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"roomNumber",children:"Room Number"}),e.jsx(k,{id:"roomNumber",...b("roomNumber"),placeholder:"e.g., 101, Main Hall"}),o.roomNumber&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:o.roomNumber.message})]})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"locationDescription",children:"Location Description"}),e.jsx(k,{id:"locationDescription",...b("locationDescription"),placeholder:"e.g., Main Building, Second Floor, Near Library"}),o.locationDescription&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:o.locationDescription.message})]})]})]}),e.jsxs(C,{children:[e.jsxs(R,{children:[e.jsx(U,{children:"Inspection Categories"}),e.jsx(M,{children:l?"Expand each category to rate it. Detailed criteria will appear when you select a rating.":"Expand each category to rate it based on the criteria (1-5 stars). Detailed criteria will appear when you select a rating."})]}),e.jsx($,{className:"space-y-4",children:l?de.map(s=>e.jsx(re,{title:s.label,defaultCollapsed:!0,className:"border border-gray-200",titleClassName:"text-left font-medium",contentClassName:"space-y-3",children:De(s,p[s.key])},s.key)):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:de.map(s=>e.jsx(re,{title:s.label,defaultCollapsed:!0,className:"border border-gray-200",titleClassName:"text-left font-medium",contentClassName:"space-y-3",children:$e(s,p[s.key])},s.key))})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(C,{children:[e.jsxs(R,{children:[e.jsx(U,{children:"Additional Notes & Observations"}),e.jsx(M,{children:"Detailed observations, specific issues, recommendations, or additional context"})]}),e.jsxs($,{children:[e.jsx(Xe,{...b("notes"),placeholder:`Enter detailed notes about this inspection...

Examples:
‚Ä¢ Specific areas that need attention
‚Ä¢ Safety concerns observed
‚Ä¢ Maintenance recommendations
‚Ä¢ Follow-up actions required
‚Ä¢ Staff performance observations
‚Ä¢ Equipment issues noted`,rows:8,className:"min-h-[200px]","aria-describedby":"notes-help"}),o.notes&&e.jsx("p",{className:"text-sm text-red-500 mt-2",children:o.notes.message}),e.jsx("p",{id:"notes-help",className:"text-sm text-muted-foreground mt-2",children:"Provide detailed observations, specific issues, recommendations, or additional context for this inspection"})]})]}),e.jsxs(C,{children:[e.jsxs(R,{children:[e.jsx(U,{children:"Photo Documentation"}),e.jsx(M,{children:"Upload images or take photos to document inspection findings (up to 5 images)"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(j,{htmlFor:"image-upload",className:"cursor-pointer flex-1",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 px-4 py-3 sm:py-2 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors min-h-[48px]",children:[e.jsx(Le,{className:"w-5 h-5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"font-medium",children:"Upload Images"})]}),e.jsx(k,{id:"image-upload",type:"file",multiple:!0,accept:"image/*",onChange:ae,className:"hidden",disabled:g.length>=5})]}),e.jsxs(j,{htmlFor:"camera-capture",className:"cursor-pointer flex-1",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 px-4 py-3 sm:py-2 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors min-h-[48px]",children:[e.jsx(Ke,{className:"w-5 h-5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"font-medium",children:"Take Photo"})]}),e.jsx(k,{id:"camera-capture",type:"file",accept:"image/*",capture:"environment",onChange:ae,className:"hidden",disabled:g.length>=5})]})]}),g.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-2 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[g.length," of 5 images selected"]}),g.length>=5&&e.jsx("span",{className:"text-xs text-blue-700 bg-blue-100 px-2 py-1 rounded",children:"Maximum reached"})]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"üì∏ Select multiple images or take photos ‚Ä¢ Up to 5 images ‚Ä¢ JPG, PNG, GIF supported"}),g.length>0&&e.jsxs("div",{className:"space-y-2",role:"region","aria-label":"Uploaded inspection photos",children:[e.jsx(j,{className:"text-sm font-semibold",id:"image-previews-label",children:"Image Previews"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 sm:gap-4",role:"list","aria-labelledby":"image-previews-label",children:g.map((s,a)=>{const t=p.locationCategory?Z.find(h=>h.value===p.locationCategory)?.label:"inspection area",n=p.roomNumber?` in ${p.roomNumber}`:"",u=`Inspection photo ${a+1} of ${g.length} for ${t}${n}. File: ${s.name}`;return e.jsxs("div",{className:"relative group",role:"listitem",children:[e.jsx("img",{src:URL.createObjectURL(s),alt:u,className:"w-full h-32 sm:h-24 object-cover rounded-lg border-2 border-gray-200",loading:"lazy"}),e.jsx("button",{type:"button",onClick:()=>we(a),className:"absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white rounded-full p-2 opacity-90 md:opacity-0 md:group-hover:opacity-100 transition-opacity shadow-lg","aria-label":`Remove photo ${a+1}: ${s.name}`,children:e.jsx(Be,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1 py-0.5 rounded","aria-hidden":"true",children:s.name.length>12?s.name.substring(0,12)+"...":s.name})]},a)})})]})]})]})]}),e.jsx("div",{className:"flex justify-end gap-4",children:e.jsx(w,{type:"submit",size:"lg",disabled:F,className:`bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed ${l?"w-full h-14 text-lg":""}`,children:F?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"‚è≥"}),"Submitting..."]}):"Submit Inspection"})})]})]}),F&&e.jsx(rs,{message:"Submitting inspection..."}),e.jsx(ls,{status:je,lastSaved:L})]})}export{Ss as default};
