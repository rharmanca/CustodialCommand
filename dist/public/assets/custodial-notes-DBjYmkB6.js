var xt=Object.defineProperty;var ft=(s,r,t)=>r in s?xt(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t;var Ee=(s,r,t)=>ft(s,typeof r!="symbol"?r+"":r,t);import{k as ze,r as n,P as Y,D as ge,j as e,c as ie,R as gt,E as z,b as bt,f as Z,d as Re,g as De,h as Le,i as Ae,e as $e}from"./index-BevRPiCH.js";import{u as vt,a as jt,t as yt,n as wt,c as Nt,f as Fe,b as St}from"./custodialNotesSchema-BsGpYhLK.js";import{L as ee,I as xe}from"./label-ajbr-TW9.js";import{T as kt}from"./textarea-DqRvqOfb.js";import{A as Ct,a as It,b as Et,c as Rt,d as Dt,e as Lt,f as At,g as $t}from"./alert-dialog-B-Q3SGVk.js";import{R as Ft,P as Pt,O as Mt,C as Ot}from"./dialog-C60uz-x3.js";import{b as le,a as Tt,C as Ut}from"./Combination-D94_BxWu.js";import{P as we,a as Ne,b as Se}from"./popover-Oi_8yNeW.js";import{L as qt}from"./LoadingOverlay-efHe_1Bd.js";import{S as He}from"./save-B-eNEcmZ.js";import{C as Pe}from"./circle-help-4kZZJ-3Y.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=ze("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=ze("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=ze("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);var Ke=1,Bt=.9,Ht=.8,Kt=.17,Me=.1,Oe=.999,Vt=.9999,Gt=.99,Yt=/[\\\/_+.#"@\[\(\{&]/,Qt=/[\\\/_+.#"@\[\(\{&]/g,_t=/[\s-]/,Qe=/[\s-]/g;function Ue(s,r,t,p,o,d,u){if(d===r.length)return o===s.length?Ke:Gt;var l=`${o},${d}`;if(u[l]!==void 0)return u[l];for(var S=p.charAt(d),m=t.indexOf(S,o),v=0,f,$,F,A;m>=0;)f=Ue(s,r,t,p,m+1,d+1,u),f>v&&(m===o?f*=Ke:Yt.test(s.charAt(m-1))?(f*=Ht,F=s.slice(o,m-1).match(Qt),F&&o>0&&(f*=Math.pow(Oe,F.length))):_t.test(s.charAt(m-1))?(f*=Bt,A=s.slice(o,m-1).match(Qe),A&&o>0&&(f*=Math.pow(Oe,A.length))):(f*=Kt,o>0&&(f*=Math.pow(Oe,m-o))),s.charAt(m)!==r.charAt(d)&&(f*=Vt)),(f<Me&&t.charAt(m-1)===p.charAt(d+1)||p.charAt(d+1)===p.charAt(d)&&t.charAt(m-1)!==p.charAt(d))&&($=Ue(s,r,t,p,m+1,d+2,u),$*Me>f&&(f=$*Me)),f>v&&(v=f),m=t.indexOf(S,m+1);return u[l]=v,v}function Ve(s){return s.toLowerCase().replace(Qe," ")}function Jt(s,r,t){return s=t&&t.length>0?`${s+" "+t.join(" ")}`:s,Ue(s,r,Ve(s),Ve(r),0,0,{})}var fe='[cmdk-group=""]',Te='[cmdk-group-items=""]',Xt='[cmdk-group-heading=""]',_e='[cmdk-item=""]',Ge=`${_e}:not([aria-disabled="true"])`,qe="cmdk-item-select",ne="data-value",Zt=(s,r,t)=>Jt(s,r,t),Je=n.createContext(void 0),be=()=>n.useContext(Je),Xe=n.createContext(void 0),We=()=>n.useContext(Xe),Ze=n.createContext(void 0),et=n.forwardRef((s,r)=>{let t=oe(()=>{var a,h;return{search:"",value:(h=(a=s.value)!=null?a:s.defaultValue)!=null?h:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),p=oe(()=>new Set),o=oe(()=>new Map),d=oe(()=>new Map),u=oe(()=>new Set),l=tt(s),{label:S,children:m,value:v,onValueChange:f,filter:$,shouldFilter:F,loop:A,disablePointerSelection:Q=!1,vimBindings:T=!0,...K}=s,ce=le(),se=le(),R=le(),W=n.useRef(null),y=ds();te(()=>{if(v!==void 0){let a=v.trim();t.current.value=a,D.emit()}},[v]),te(()=>{y(6,ve)},[]);let D=n.useMemo(()=>({subscribe:a=>(u.current.add(a),()=>u.current.delete(a)),snapshot:()=>t.current,setState:(a,h,g)=>{var c,j,w,M;if(!Object.is(t.current[a],h)){if(t.current[a]=h,a==="search")U(),B(),y(1,H);else if(a==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let L=document.getElementById(R);L?L.focus():(c=document.getElementById(ce))==null||c.focus()}if(y(7,()=>{var L;t.current.selectedItemId=(L=V())==null?void 0:L.id,D.emit()}),g||y(5,ve),((j=l.current)==null?void 0:j.value)!==void 0){let L=h??"";(M=(w=l.current).onValueChange)==null||M.call(w,L);return}}D.emit()}},emit:()=>{u.current.forEach(a=>a())}}),[]),re=n.useMemo(()=>({value:(a,h,g)=>{var c;h!==((c=d.current.get(a))==null?void 0:c.value)&&(d.current.set(a,{value:h,keywords:g}),t.current.filtered.items.set(a,de(h,g)),y(2,()=>{B(),D.emit()}))},item:(a,h)=>(p.current.add(a),h&&(o.current.has(h)?o.current.get(h).add(a):o.current.set(h,new Set([a]))),y(3,()=>{U(),B(),t.current.value||H(),D.emit()}),()=>{d.current.delete(a),p.current.delete(a),t.current.filtered.items.delete(a);let g=V();y(4,()=>{U(),g?.getAttribute("id")===a&&H(),D.emit()})}),group:a=>(o.current.has(a)||o.current.set(a,new Set),()=>{d.current.delete(a),o.current.delete(a)}),filter:()=>l.current.shouldFilter,label:S||s["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:ce,inputId:R,labelId:se,listInnerRef:W}),[]);function de(a,h){var g,c;let j=(c=(g=l.current)==null?void 0:g.filter)!=null?c:Zt;return a?j(a,t.current.search,h):0}function B(){if(!t.current.search||l.current.shouldFilter===!1)return;let a=t.current.filtered.items,h=[];t.current.filtered.groups.forEach(c=>{let j=o.current.get(c),w=0;j.forEach(M=>{let L=a.get(M);w=Math.max(L,w)}),h.push([c,w])});let g=W.current;_().sort((c,j)=>{var w,M;let L=c.getAttribute("id"),q=j.getAttribute("id");return((w=a.get(q))!=null?w:0)-((M=a.get(L))!=null?M:0)}).forEach(c=>{let j=c.closest(Te);j?j.appendChild(c.parentElement===j?c:c.closest(`${Te} > *`)):g.appendChild(c.parentElement===g?c:c.closest(`${Te} > *`))}),h.sort((c,j)=>j[1]-c[1]).forEach(c=>{var j;let w=(j=W.current)==null?void 0:j.querySelector(`${fe}[${ne}="${encodeURIComponent(c[0])}"]`);w?.parentElement.appendChild(w)})}function H(){let a=_().find(g=>g.getAttribute("aria-disabled")!=="true"),h=a?.getAttribute(ne);D.setState("value",h||void 0)}function U(){var a,h,g,c;if(!t.current.search||l.current.shouldFilter===!1){t.current.filtered.count=p.current.size;return}t.current.filtered.groups=new Set;let j=0;for(let w of p.current){let M=(h=(a=d.current.get(w))==null?void 0:a.value)!=null?h:"",L=(c=(g=d.current.get(w))==null?void 0:g.keywords)!=null?c:[],q=de(M,L);t.current.filtered.items.set(w,q),q>0&&j++}for(let[w,M]of o.current)for(let L of M)if(t.current.filtered.items.get(L)>0){t.current.filtered.groups.add(w);break}t.current.filtered.count=j}function ve(){var a,h,g;let c=V();c&&(((a=c.parentElement)==null?void 0:a.firstChild)===c&&((g=(h=c.closest(fe))==null?void 0:h.querySelector(Xt))==null||g.scrollIntoView({block:"nearest"})),c.scrollIntoView({block:"nearest"}))}function V(){var a;return(a=W.current)==null?void 0:a.querySelector(`${_e}[aria-selected="true"]`)}function _(){var a;return Array.from(((a=W.current)==null?void 0:a.querySelectorAll(Ge))||[])}function ue(a){let h=_()[a];h&&D.setState("value",h.getAttribute(ne))}function me(a){var h;let g=V(),c=_(),j=c.findIndex(M=>M===g),w=c[j+a];(h=l.current)!=null&&h.loop&&(w=j+a<0?c[c.length-1]:j+a===c.length?c[0]:c[j+a]),w&&D.setState("value",w.getAttribute(ne))}function je(a){let h=V(),g=h?.closest(fe),c;for(;g&&!c;)g=a>0?is(g,fe):cs(g,fe),c=g?.querySelector(Ge);c?D.setState("value",c.getAttribute(ne)):me(a)}let ye=()=>ue(_().length-1),he=a=>{a.preventDefault(),a.metaKey?ye():a.altKey?je(1):me(1)},pe=a=>{a.preventDefault(),a.metaKey?ue(0):a.altKey?je(-1):me(-1)};return n.createElement(Y.div,{ref:r,tabIndex:-1,...K,"cmdk-root":"",onKeyDown:a=>{var h;(h=K.onKeyDown)==null||h.call(K,a);let g=a.nativeEvent.isComposing||a.keyCode===229;if(!(a.defaultPrevented||g))switch(a.key){case"n":case"j":{T&&a.ctrlKey&&he(a);break}case"ArrowDown":{he(a);break}case"p":case"k":{T&&a.ctrlKey&&pe(a);break}case"ArrowUp":{pe(a);break}case"Home":{a.preventDefault(),ue(0);break}case"End":{a.preventDefault(),ye();break}case"Enter":{a.preventDefault();let c=V();if(c){let j=new Event(qe);c.dispatchEvent(j)}}}}},n.createElement("label",{"cmdk-label":"",htmlFor:re.inputId,id:re.labelId,style:ms},S),Ce(s,a=>n.createElement(Xe.Provider,{value:D},n.createElement(Je.Provider,{value:re},a))))}),es=n.forwardRef((s,r)=>{var t,p;let o=le(),d=n.useRef(null),u=n.useContext(Ze),l=be(),S=tt(s),m=(p=(t=S.current)==null?void 0:t.forceMount)!=null?p:u?.forceMount;te(()=>{if(!m)return l.item(o,u?.id)},[m]);let v=st(o,d,[s.value,s.children,d],s.keywords),f=We(),$=G(y=>y.value&&y.value===v.current),F=G(y=>m||l.filter()===!1?!0:y.search?y.filtered.items.get(o)>0:!0);n.useEffect(()=>{let y=d.current;if(!(!y||s.disabled))return y.addEventListener(qe,A),()=>y.removeEventListener(qe,A)},[F,s.onSelect,s.disabled]);function A(){var y,D;Q(),(D=(y=S.current).onSelect)==null||D.call(y,v.current)}function Q(){f.setState("value",v.current,!0)}if(!F)return null;let{disabled:T,value:K,onSelect:ce,forceMount:se,keywords:R,...W}=s;return n.createElement(Y.div,{ref:ge(d,r),...W,id:o,"cmdk-item":"",role:"option","aria-disabled":!!T,"aria-selected":!!$,"data-disabled":!!T,"data-selected":!!$,onPointerMove:T||l.getDisablePointerSelection()?void 0:Q,onClick:T?void 0:A},s.children)}),ts=n.forwardRef((s,r)=>{let{heading:t,children:p,forceMount:o,...d}=s,u=le(),l=n.useRef(null),S=n.useRef(null),m=le(),v=be(),f=G(F=>o||v.filter()===!1?!0:F.search?F.filtered.groups.has(u):!0);te(()=>v.group(u),[]),st(u,l,[s.value,s.heading,S]);let $=n.useMemo(()=>({id:u,forceMount:o}),[o]);return n.createElement(Y.div,{ref:ge(l,r),...d,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},t&&n.createElement("div",{ref:S,"cmdk-group-heading":"","aria-hidden":!0,id:m},t),Ce(s,F=>n.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?m:void 0},n.createElement(Ze.Provider,{value:$},F))))}),ss=n.forwardRef((s,r)=>{let{alwaysRender:t,...p}=s,o=n.useRef(null),d=G(u=>!u.search);return!t&&!d?null:n.createElement(Y.div,{ref:ge(o,r),...p,"cmdk-separator":"",role:"separator"})}),rs=n.forwardRef((s,r)=>{let{onValueChange:t,...p}=s,o=s.value!=null,d=We(),u=G(m=>m.search),l=G(m=>m.selectedItemId),S=be();return n.useEffect(()=>{s.value!=null&&d.setState("search",s.value)},[s.value]),n.createElement(Y.input,{ref:r,...p,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":S.listId,"aria-labelledby":S.labelId,"aria-activedescendant":l,id:S.inputId,type:"text",value:o?s.value:u,onChange:m=>{o||d.setState("search",m.target.value),t?.(m.target.value)}})}),as=n.forwardRef((s,r)=>{let{children:t,label:p="Suggestions",...o}=s,d=n.useRef(null),u=n.useRef(null),l=G(m=>m.selectedItemId),S=be();return n.useEffect(()=>{if(u.current&&d.current){let m=u.current,v=d.current,f,$=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let F=m.offsetHeight;v.style.setProperty("--cmdk-list-height",F.toFixed(1)+"px")})});return $.observe(m),()=>{cancelAnimationFrame(f),$.unobserve(m)}}},[]),n.createElement(Y.div,{ref:ge(d,r),...o,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":p,id:S.listId},Ce(s,m=>n.createElement("div",{ref:ge(u,S.listInnerRef),"cmdk-list-sizer":""},m)))}),ns=n.forwardRef((s,r)=>{let{open:t,onOpenChange:p,overlayClassName:o,contentClassName:d,container:u,...l}=s;return n.createElement(Ft,{open:t,onOpenChange:p},n.createElement(Pt,{container:u},n.createElement(Mt,{"cmdk-overlay":"",className:o}),n.createElement(Ot,{"aria-label":s.label,"cmdk-dialog":"",className:d},n.createElement(et,{ref:r,...l}))))}),os=n.forwardRef((s,r)=>G(t=>t.filtered.count===0)?n.createElement(Y.div,{ref:r,...s,"cmdk-empty":"",role:"presentation"}):null),ls=n.forwardRef((s,r)=>{let{progress:t,children:p,label:o="Loading...",...d}=s;return n.createElement(Y.div,{ref:r,...d,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},Ce(s,u=>n.createElement("div",{"aria-hidden":!0},u)))}),O=Object.assign(et,{List:as,Item:es,Input:rs,Group:ts,Separator:ss,Dialog:ns,Empty:os,Loading:ls});function is(s,r){let t=s.nextElementSibling;for(;t;){if(t.matches(r))return t;t=t.nextElementSibling}}function cs(s,r){let t=s.previousElementSibling;for(;t;){if(t.matches(r))return t;t=t.previousElementSibling}}function tt(s){let r=n.useRef(s);return te(()=>{r.current=s}),r}var te=typeof window>"u"?n.useEffect:n.useLayoutEffect;function oe(s){let r=n.useRef();return r.current===void 0&&(r.current=s()),r}function G(s){let r=We(),t=()=>s(r.snapshot());return n.useSyncExternalStore(r.subscribe,t,t)}function st(s,r,t,p=[]){let o=n.useRef(),d=be();return te(()=>{var u;let l=(()=>{var m;for(let v of t){if(typeof v=="string")return v.trim();if(typeof v=="object"&&"current"in v)return v.current?(m=v.current.textContent)==null?void 0:m.trim():o.current}})(),S=p.map(m=>m.trim());d.value(s,l,S),(u=r.current)==null||u.setAttribute(ne,l),o.current=l}),o}var ds=()=>{let[s,r]=n.useState(),t=oe(()=>new Map);return te(()=>{t.current.forEach(p=>p()),t.current=new Map},[s]),(p,o)=>{t.current.set(p,o),r({})}};function us(s){let r=s.type;return typeof r=="function"?r(s.props):"render"in r?r.render(s.props):s}function Ce({asChild:s,children:r},t){return s&&n.isValidElement(r)?n.cloneElement(us(r),{ref:r.ref},t(r.props.children)):t(r)}var ms={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const rt=n.forwardRef(({className:s,...r},t)=>e.jsx(O,{ref:t,className:ie("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...r}));rt.displayName=O.displayName;const at=n.forwardRef(({className:s,...r},t)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Wt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(O.Input,{ref:t,className:ie("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...r})]}));at.displayName=O.Input.displayName;const hs=n.forwardRef(({className:s,...r},t)=>e.jsx(O.List,{ref:t,className:ie("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...r}));hs.displayName=O.List.displayName;const nt=n.forwardRef((s,r)=>e.jsx(O.Empty,{ref:r,className:"py-6 text-center text-sm",...s}));nt.displayName=O.Empty.displayName;const ot=n.forwardRef(({className:s,...r},t)=>e.jsx(O.Group,{ref:t,className:ie("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...r}));ot.displayName=O.Group.displayName;const ps=n.forwardRef(({className:s,...r},t)=>e.jsx(O.Separator,{ref:t,className:ie("-mx-1 h-px bg-border",s),...r}));ps.displayName=O.Separator.displayName;const lt=n.forwardRef(({className:s,...r},t)=>e.jsx(O.Item,{ref:t,className:ie("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s),...r}));lt.displayName=O.Item.displayName;class xs extends gt.Component{constructor(t){super(t);Ee(this,"handleRetry",()=>{window.location.reload()});Ee(this,"handleClearData",()=>{try{localStorage.clear(),console.log("LocalStorage cleared successfully")}catch(t){console.error("Failed to clear localStorage:",t)}window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,p){console.error("LocalStorage Error Boundary caught an error:",t),console.error("Component Stack:",p.componentStack),this.setState({errorInfo:p})}render(){const{hasError:t,error:p,errorInfo:o}=this.state,{children:d,fallback:u}=this.props;return t?u||e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"rounded-full bg-red-100 p-3",children:e.jsx("svg",{className:"h-8 w-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:"Something Went Wrong"}),e.jsx("p",{className:"text-gray-600 text-center mb-6",children:"We encountered an issue saving your preferences. This might happen if your browser's storage is full or if you're using private browsing mode."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:this.handleRetry,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors",children:"Retry"}),e.jsx("button",{onClick:this.handleClearData,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-4 rounded-md transition-colors",children:"Clear Saved Data & Retry"})]}),!1]})}):d}}const Ye={WARNING:80,CRITICAL:95};function fs(s={}){const{onWarning:r,checkInterval:t=3e4,checkOnMount:p=!0}=s,o=n.useRef(new Set),d=async()=>{try{const u=await z.getQuotaInfo();if(!u||u.percentage===0)return;const{percentage:l,usage:S,quota:m}=u,v=f=>{const $=f/1048576;return $<1?`${(f/1024).toFixed(1)} KB`:`${$.toFixed(1)} MB`};if(l>=Ye.CRITICAL){const f=`critical-${Math.floor(l)}`;o.current.has(f)||(console.warn(`[Storage Quota Monitor] CRITICAL: Storage at ${l.toFixed(1)}% capacity`),r?.(`Your browser storage is nearly full (${l.toFixed(1)}% used). Using ${v(S)} of ${v(m)} available. Please clear old data or browser cache to continue using this feature.`,l,"critical"),o.current.add(f))}else if(l>=Ye.WARNING){const f=`warning-${Math.floor(l/5)*5}`;o.current.has(f)||(console.warn(`[Storage Quota Monitor] WARNING: Storage at ${l.toFixed(1)}% capacity`),r?.(`Your browser storage is ${l.toFixed(1)}% full. Using ${v(S)} of ${v(m)} available. Consider clearing old data to ensure smooth operation.`,l,"warning"),o.current.add(f))}}catch(u){console.error("[Storage Quota Monitor] Failed to check quota:",u)}};return n.useEffect(()=>{p&&d();const u=setInterval(d,t);return()=>{clearInterval(u)}},[t,p,r]),{checkQuota:d}}const gs=["ASA","CBR","GWC","LCA","OA","WLC"],bs=`
  @keyframes progress {
    from {
      width: 0%;
    }
    to {
      width: 100%;
    }
  }
`;function Ls({onBack:s}){const{toast:r}=bt();fs({onWarning:(i,x,b)=>{r({variant:b==="critical"?"destructive":"default",title:b==="critical"?"‚ö†Ô∏è Storage Almost Full":"‚ö° Storage Warning",description:i,duration:7e3})},checkInterval:3e4,checkOnMount:!0});const{register:t,handleSubmit:p,formState:{errors:o,isSubmitting:d},reset:u,setValue:l,getValues:S,watch:m,clearErrors:v}=vt({resolver:yt(St),defaultValues:jt}),f=m(),[$,F]=n.useState(!1);n.useEffect(()=>{F(!0)},[]);const[A,Q]=n.useState([]),[T,K]=n.useState([]),[ce,se]=n.useState(!1),[R,W]=n.useState(null),[y,D]=n.useState(!1),[re,de]=n.useState(!1),[B,H]=n.useState(""),[U,ve]=n.useState(null),[V,_]=n.useState(!0),[ue,me]=n.useState(!1),[je,ye]=n.useState(!0),[he,pe]=n.useState([]),[a,h]=n.useState(null),[g,c]=n.useState(!1),[j,w]=n.useState(!1),[M,L]=n.useState(!1),[q,Ie]=n.useState(null);n.useEffect(()=>{const i=()=>{const x=document.querySelectorAll(".form-section"),b=window.scrollY+window.innerHeight/2;x.forEach((C,I)=>{const N=C.getBoundingClientRect(),k=N.top+window.scrollY,P=k+N.height;b>=k&&b<P&&ve(I+1)}),window.scrollY>100&&_(!1)};return window.addEventListener("scroll",i),i(),()=>window.removeEventListener("scroll",i)},[]),n.useEffect(()=>{const i=()=>{const x=window.innerWidth<=768,b=window.innerHeight<500;me(x&&b)};return i(),window.addEventListener("resize",i),window.addEventListener("orientationchange",i),()=>{window.removeEventListener("resize",i),window.removeEventListener("orientationchange",i)}},[]),n.useEffect(()=>{if(Object.values(f).some(x=>x&&x!=="")&&!y){const x=setTimeout(()=>{c(!0);const b={...f,selectedSchool:B,savedAt:new Date().toISOString()};z.setItem("custodialNotesDraft",JSON.stringify(b)),h(new Date),c(!1)},2e3);return()=>clearTimeout(x)}},[f,B,y]),n.useEffect(()=>{try{const i=z.getItem("custodialNotesDraft");let x=!1;if(i){const C=JSON.parse(i),I=new Date(C.savedAt);(Date.now()-I.getTime())/(1e3*60*60)<24?(x=!0,Object.keys(C).forEach(k=>{k!=="savedAt"&&k!=="selectedSchool"&&l(k,C[k])}),C.selectedSchool&&(H(C.selectedSchool),l("school",C.selectedSchool)),h(I),r({title:"Draft Restored",description:`Your work from ${I.toLocaleString()} was restored.`,duration:5e3})):z.removeItem("custodialNotesDraft")}if(!x){const C=z.getItem("custodialInspectorName");C&&l("inspectorName",C);const I=z.getItem("custodialLastSchool");I&&(H(I),l("school",I))}const b=z.getItem("custodialRecentLocations");if(b){const C=JSON.parse(b);pe(Array.isArray(C)?C:[])}}catch(i){console.error("Error loading saved data:",i)}},[l,H,r]);const Be=async i=>{const x=i.target.files;if(x&&x.length>0){const b=Array.from(x),I=5-A.length,N=b.slice(0,I);N.length<b.length&&r({title:"Maximum Images Reached",description:`Only ${N.length} images were added. Maximum of 5 images allowed.`});const k=[];let P=0,ae=0;for(const E of N)if(P+=E.size,wt(E,500))try{const X=await Nt(E,{maxSizeKB:500});k.push(X.compressedFile),ae+=X.compressedSize,console.log(`Compressed ${E.name}: ${Fe(E.size)} ‚Üí ${Fe(X.compressedSize)}`)}catch(X){console.error("Failed to compress image:",X),k.push(E),ae+=E.size}else k.push(E),ae+=E.size;Q(E=>[...E,...k]);const J=k.map(E=>URL.createObjectURL(E));if(K(E=>[...E,...J]),k.length>0){const E=P-ae,X=E>0?(E/P*100).toFixed(1):"0";r({title:"üì∏ Photos Uploaded Successfully!",description:`Successfully added ${k.length} photo${k.length>1?"s":""} to your custodial note documentation.${E>0?` Saved ${Fe(E)} (${X}% compression).`:""}`,duration:3e3})}}i.target.value=""},it=()=>{if(A.length>=5){r({variant:"destructive",title:"Maximum Images Reached",description:"Maximum of 5 images allowed. Please remove some images first."});return}const i=document.createElement("input");i.type="file",i.accept="image/*",i.capture="environment",i.onchange=x=>{const b=x;b.target.files&&b.target.files.length>0&&r({title:"üì∑ Photo Captured Successfully!",description:"Camera photo is being processed and added to your documentation.",duration:2e3}),Be(b)},i.click()},ct=i=>{const x=A.filter((C,I)=>I!==i),b=T.filter((C,I)=>I!==i);URL.revokeObjectURL(T[i]),Q(x),K(b)},dt=i=>{i.trim()&&pe(x=>{const b=x.filter(I=>I!==i),C=[i,...b].slice(0,5);try{z.setItem("custodialRecentLocations",JSON.stringify(C))}catch(I){console.error("Error saving recent locations:",I)}return C})},ut=()=>{q&&(l("inspectorName",q.inspectorName),l("school",q.school),l("date",q.date),l("location",q.location),l("locationDescription",q.locationDescription||""),H(q.school),l("notes",""),l("images",[]),L(!1),Ie(null),window.scrollTo({top:0,behavior:"smooth"}),r({title:"Form Pre-filled",description:"Inspector, school, date, and location have been filled in. Just add new notes and photos!",duration:4e3}))},mt=()=>{L(!1),Ie(null),s&&s()},ht=async i=>{W(i),se(!0)},pt=async()=>{if(R){D(!0),se(!1);try{const i=new FormData;Object.entries(R).forEach(([N,k])=>{N!=="images"&&i.append(N,k?.toString()||"")}),A.forEach(N=>{i.append("images",N)});const x={method:"POST",body:i,headers:{}},b=new AbortController,C=setTimeout(()=>b.abort(),3e4);x.signal=b.signal;const I=await fetch("/api/custodial-notes",x);if(clearTimeout(C),I.ok){w(!0),z.removeItem("custodialNotesDraft");try{z.setItem("custodialInspectorName",R.inspectorName),z.setItem("custodialLastSchool",B),dt(R.location)}catch(P){console.error("Error saving user preferences:",P)}Ie(R),r({title:"‚úÖ Custodial Note Submitted Successfully!",description:"Your custodial concern has been recorded and will be reviewed.",variant:"default",duration:5e3});const N=R.inspectorName,k=B;u(),l("inspectorName",N),l("school",k),H(k),Q([]),T.forEach(P=>URL.revokeObjectURL(P)),K([]),W(null),h(null),D(!1),setTimeout(()=>{w(!1),L(!0)},3e3)}else{const N=await I.json().catch(()=>({success:!1,message:"Unknown error occurred",details:"Unable to parse server response"}));let k=N.message||"Unable to submit custodial note. Please try again.",P="";N.success===!1&&N.details&&(Array.isArray(N.details)?P=`Please check: ${N.details.map(J=>`${J.field}: ${J.message}`).join(", ")}`:typeof N.details=="object"?P=`Required: ${Object.entries(N.details).filter(([J,E])=>E==="‚úó required").map(([J])=>J.replace(/([A-Z])/g," $1").trim()).join(", ")}`:P=N.details),(N.technical==="FormData parsing failed"||N.message?.includes("form data is malformed"))&&(k="Form submission error",P="Please refresh the page and try submitting again. If the problem persists, contact support."),r({variant:"destructive",title:"‚ùå Submission Failed",description:`${k}${P?`

${P}`:""}`,duration:8e3}),D(!1)}}catch(i){console.error("Error submitting custodial note:",i);let x="Network Error",b="Unable to connect to the server. Please check your connection and try again.";i instanceof Error&&i.name==="AbortError"?(x="Request Timeout",b=`The request took too long to complete. This might be due to:
‚Ä¢ Slow internet connection
‚Ä¢ Large file uploads
‚Ä¢ Server being busy

Please try again.`):i instanceof TypeError&&(i.message.includes("Failed to fetch")?(x="Connection Failed",b=`Unable to reach the server. Please check:
‚Ä¢ Internet connection
‚Ä¢ Server is running
‚Ä¢ No firewall blocking the request`):i.message.includes("NetworkError")&&(x="Network Error",b="A network error occurred. Please try again.")),r({variant:"destructive",title:`‚ùå ${x}`,description:b,duration:8e3}),D(!1)}}};return e.jsxs(xs,{children:[e.jsx("style",{children:bs}),e.jsxs("div",{className:"max-w-3xl mx-auto p-6 space-y-8","data-loaded":$?"true":void 0,children:[s&&e.jsx(Z,{onClick:s,variant:"outline",className:"mb-4 back-button min-h-[48px] px-6",children:"‚Üê Back to Custodial"}),ue&&je&&e.jsx("div",{className:"bg-orange-50 border-2 border-orange-400 rounded-lg p-4 shadow-lg",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("span",{className:"text-2xl flex-shrink-0",children:"üì±"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-orange-900 text-lg mb-1",children:"Landscape Mode Detected"}),e.jsxs("p",{className:"text-orange-800 text-sm",children:["For the best experience filling out this form, please"," ",e.jsx("strong",{children:"rotate your device to portrait mode"})," ","(vertical orientation)."]})]})]}),e.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>ye(!1),className:"text-orange-900 hover:bg-orange-100 flex-shrink-0",children:"‚úï"})]})}),a&&e.jsx("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-500",children:g?e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"h-4 w-4 animate-pulse"}),e.jsx("span",{children:"Saving draft..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:["Draft saved at ",a.toLocaleTimeString()]})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-blue-800 mb-2",children:"Submit Custodial Note"}),e.jsx("p",{className:"text-gray-600",children:"Report maintenance issues, concerns, or general observations"})]}),e.jsx("div",{className:"sticky top-0 z-10 bg-white/95 backdrop-blur-sm border-b-2 border-blue-200 py-3 -mx-6 px-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Form Progress:"}),U&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-bold bg-blue-100 text-blue-800 border-2 border-blue-300",children:["Section ",U," of 3"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:`w-16 h-2 rounded-full transition-colors ${U===1?"bg-blue-600":U&&U>1?"bg-blue-400":"bg-gray-200"}`}),e.jsx("div",{className:`w-16 h-2 rounded-full transition-colors ${U===2?"bg-blue-600":U&&U>2?"bg-blue-400":"bg-gray-200"}`}),e.jsx("div",{className:`w-16 h-2 rounded-full transition-colors ${U===3?"bg-blue-600":"bg-gray-200"}`})]})]})}),V&&e.jsxs("div",{className:"animate-bounce text-center text-gray-500 text-sm",children:[e.jsx(Tt,{className:"inline-block"}),e.jsx("p",{children:"Scroll down to continue"})]}),e.jsx("div",{className:"bg-amber-50 border-2 border-amber-400 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl flex-shrink-0",children:"‚≠ê"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-amber-900 text-lg mb-1",children:"New Requirement: Inspector Name"}),e.jsxs("p",{className:"text-amber-800 text-sm",children:["Please enter your name in the ",e.jsx("strong",{children:"Inspector Name"})," ","field. This is now required for all custodial notes to ensure proper accountability and follow-up."]})]})]})}),e.jsxs("form",{onSubmit:p(ht),className:"space-y-8",children:[e.jsxs(Re,{className:"form-section",children:[e.jsxs(De,{children:[e.jsx(Le,{children:"Basic Information"}),e.jsx(Ae,{children:"Enter the basic details for this custodial note"})]}),e.jsxs($e,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{htmlFor:"inspectorName",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"Inspector Name"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"}),e.jsxs(we,{children:[e.jsx(Ne,{asChild:!0,children:e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Pe,{className:"h-4 w-4"})})}),e.jsxs(Se,{className:"w-80 text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Why is this required?"}),e.jsx("p",{className:"text-gray-600",children:"Your name ensures accountability and allows for proper follow-up on reported issues. This helps maintain quality standards across all facilities."})]})]})]}),e.jsx(xe,{id:"inspectorName",...t("inspectorName"),placeholder:"Enter your name",className:"border-2 min-h-[48px]"}),o.inspectorName&&e.jsx("p",{className:"text-sm text-red-500",children:o.inspectorName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{htmlFor:"school",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"School"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"})]}),e.jsxs(we,{open:re,onOpenChange:de,children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(Z,{variant:"outline",role:"combobox","aria-expanded":re,className:"w-full justify-between border-2 min-h-[48px] text-left font-normal",children:[B||"Select school...",e.jsx(zt,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Se,{className:"w-full p-0",align:"start",children:e.jsxs(rt,{children:[e.jsx(at,{placeholder:"Search schools..."}),e.jsx(nt,{children:"No school found."}),e.jsx(ot,{children:gs.map(i=>e.jsxs(lt,{value:i,onSelect:x=>{const b=x.toUpperCase();H(b),l("school",b),de(!1)},className:"min-h-[48px] cursor-pointer",children:[e.jsx(Ut,{className:`mr-2 h-4 w-4 ${B===i?"opacity-100":"opacity-0"}`}),i]},i))})]})})]}),o.school&&e.jsx("p",{className:"text-sm text-red-500",children:o.school.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{htmlFor:"date",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"Date"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{id:"date",type:"date",...t("date"),className:"border-2 min-h-[48px] pr-10"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})})]}),o.date&&e.jsx("p",{className:"text-sm text-red-500",children:o.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{htmlFor:"location",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"Location"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"}),e.jsxs(we,{children:[e.jsx(Ne,{asChild:!0,children:e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Pe,{className:"h-4 w-4"})})}),e.jsxs(Se,{className:"w-80 text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Location Examples"}),e.jsxs("ul",{className:"text-gray-600 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:'Room numbers: "Room 105", "Classroom 202"'}),e.jsx("li",{children:'Common areas: "Gymnasium", "Cafeteria", "Library"'}),e.jsx("li",{children:'Outdoor: "Playground", "Parking Lot", "Field"'}),e.jsx("li",{children:'Facilities: "Restroom 1st Floor", "Main Office"'})]})]})]})]}),he.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1.5",children:"Recent locations:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:he.map((i,x)=>e.jsx("button",{type:"button",onClick:()=>{l("location",i),o.location&&v("location")},className:"inline-flex items-center px-3 py-1.5 rounded-md text-sm bg-blue-50 text-blue-700 border border-blue-200 hover:bg-blue-100 hover:border-blue-300 transition-colors",children:i},x))})]}),e.jsx(xe,{id:"location",...t("location"),placeholder:"e.g., Room 105, Gymnasium, Cafeteria",className:"border-2 min-h-[48px]"}),o.location&&e.jsx("p",{className:"text-sm text-red-500",children:o.location.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ee,{htmlFor:"locationDescription",children:"Location Description"}),e.jsx(xe,{id:"locationDescription",...t("locationDescription"),placeholder:"e.g., Main Building, East Wing, 2nd Floor",className:"min-h-[48px]"}),o.locationDescription&&e.jsx("p",{className:"text-sm text-red-500",children:o.locationDescription.message})]})]})]}),e.jsxs(Re,{className:"form-section",children:[e.jsxs(De,{children:[e.jsxs(Le,{className:"flex items-center gap-2",children:["Issue Description & Notes",e.jsxs(we,{children:[e.jsx(Ne,{asChild:!0,children:e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Pe,{className:"h-4 w-4"})})}),e.jsxs(Se,{className:"w-80 text-sm",children:[e.jsx("p",{className:"font-semibold mb-2",children:"What to Include"}),e.jsxs("ul",{className:"text-gray-600 space-y-1 list-disc list-inside",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"What:"})," Describe the issue clearly"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Where:"})," Specific location details"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"When:"})," When you noticed it"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Severity:"})," Is it urgent or can it wait?"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Impact:"})," How does it affect operations?"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Action:"})," What needs to be done?"]})]})]})]})]}),e.jsx(Ae,{children:"Provide detailed information about the custodial issue or observation"})]}),e.jsxs($e,{children:[e.jsx(kt,{...t("notes"),"data-testid":"custodial-notes-description",placeholder:`Describe the issue, maintenance need, or observation...

Examples:
‚Ä¢ Broken equipment or fixtures
‚Ä¢ Cleaning supply needs
‚Ä¢ Safety concerns
‚Ä¢ Maintenance requests
‚Ä¢ General observations
‚Ä¢ Follow-up needed`,rows:10,className:"min-h-[250px]"}),o.notes&&e.jsx("p",{className:"text-sm text-red-500 mt-2",children:o.notes.message})]})]}),e.jsxs(Re,{className:"form-section",children:[e.jsxs(De,{children:[e.jsx(Le,{children:"Photos & Documentation"}),e.jsx(Ae,{children:"Upload images or capture photos to document the issue"})]}),e.jsxs($e,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(ee,{htmlFor:"imageUpload",className:"block mb-2",children:"Upload Images (Optional)"}),e.jsx(xe,{id:"imageUpload",type:"file",accept:"image/*",multiple:!0,onChange:Be,className:"hidden"}),e.jsx(Z,{type:"button",onClick:()=>document.getElementById("imageUpload")?.click(),variant:"outline",className:"w-full h-12 border-2 border-dashed hover:border-blue-500 hover:bg-blue-50 transition-colors",children:e.jsxs("span",{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"text-2xl",children:"üìÅ"}),e.jsxs("span",{className:"font-medium",children:["Tap to Select Photos"," ",A.length>0&&`(${A.length} selected)`]})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum 5 images ‚Ä¢ Images auto-compressed"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(Z,{type:"button",onClick:it,variant:"outline",className:"w-full sm:w-auto h-12 border-2",children:e.jsxs("span",{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"text-xl",children:"üì∑"}),e.jsx("span",{children:"Capture Photo"})]})})})]}),T.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs(ee,{className:"block mb-2",children:["Uploaded Images (",A.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:T.map((i,x)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:i,alt:`Upload ${x+1}`,className:"w-full h-24 object-cover rounded-lg border"}),e.jsx(Z,{type:"button",onClick:()=>ct(x),variant:"destructive",size:"sm",className:"absolute top-1 right-1 w-6 h-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:"√ó"})]},x))})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Z,{type:"submit",size:"lg",disabled:d||y,className:"w-full md:w-auto disabled:bg-gray-400 disabled:cursor-not-allowed min-h-[56px] text-lg font-semibold transition-all duration-300 relative overflow-hidden",children:d||y?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-5 h-5 border-3 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-5 h-5 border-3 border-white/30 rounded-full"})]}),e.jsx("span",{className:"animate-pulse",children:"Submitting your report..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5"}),e.jsx("span",{children:"Submit Custodial Note"})]})})})]}),e.jsx(Ct,{open:ce,onOpenChange:se,children:e.jsxs(It,{className:"max-w-lg",children:[e.jsxs(Et,{children:[e.jsx(Rt,{className:"text-blue-800 text-xl",children:"‚úÖ Confirm Submission"}),e.jsx(Dt,{className:"text-left",children:"Please review your custodial note before submitting:"})]}),R&&e.jsx("div",{className:"space-y-3 py-4",children:e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Inspector:"}),e.jsx("p",{className:"text-gray-900",children:R.inspectorName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"School:"}),e.jsx("p",{className:"text-gray-900",children:R.school})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Date:"}),e.jsx("p",{className:"text-gray-900",children:R.date})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Location:"}),e.jsx("p",{className:"text-gray-900",children:R.location})]})]}),R.locationDescription&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Location Details:"}),e.jsx("p",{className:"text-gray-900 text-sm",children:R.locationDescription})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Notes:"}),e.jsx("p",{className:"text-gray-900 text-sm max-h-24 overflow-y-auto",children:R.notes&&R.notes.length>200?`${R.notes.substring(0,200)}...`:R.notes||"No notes provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Photos:"}),e.jsxs("p",{className:"text-gray-900",children:[A.length," image",A.length!==1?"s":""," ","attached"]})]})]})}),e.jsxs(Lt,{children:[e.jsx(At,{children:"Review/Edit"}),e.jsx($t,{onClick:pt,className:"bg-blue-600 hover:bg-blue-700",children:"Confirm & Submit"})]})]})}),y&&e.jsx(qt,{message:"Submitting report..."}),j&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsx("div",{className:"bg-white rounded-2xl p-8 max-w-md mx-4 shadow-2xl animate-in zoom-in duration-500",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center animate-bounce",children:e.jsx("div",{className:"w-20 h-20 bg-green-500 rounded-full flex items-center justify-center animate-pulse",children:e.jsx("svg",{className:"w-12 h-12 text-white animate-in zoom-in duration-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})}),e.jsx(ke,{className:"absolute -top-2 -right-2 h-8 w-8 text-yellow-400 animate-pulse"}),e.jsx(ke,{className:"absolute -bottom-2 -left-2 h-6 w-6 text-yellow-400 animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx(ke,{className:"absolute -top-2 -left-2 h-5 w-5 text-blue-400 animate-pulse",style:{animationDelay:"0.4s"}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-700",children:"üéâ Success!"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Your custodial note has been submitted successfully!"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting you back to the home page..."})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-400 to-blue-500 rounded-full animate-[progress_3s_ease-in-out]",style:{animation:"progress 3s ease-in-out forwards"}})})]})})}),M&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsx("div",{className:"bg-white rounded-2xl p-8 max-w-md mx-4 shadow-2xl animate-in zoom-in duration-500",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Report Another Issue?"}),e.jsx("p",{className:"text-gray-600",children:"Found another issue at the same location?"}),e.jsx("p",{className:"text-sm text-gray-500",children:"We can pre-fill your inspector name, school, date, and location to save you time!"})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:ut,className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors shadow-md hover:shadow-lg min-h-[48px]",children:"üìù Report Another Issue Here"}),e.jsx("button",{onClick:mt,className:"w-full px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold rounded-lg transition-colors min-h-[48px]",children:"üè† Return to Home"})]})]})})})]})]})}export{Ls as default};
