var xt=Object.defineProperty;var ft=(s,r,t)=>r in s?xt(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t;var Ee=(s,r,t)=>ft(s,typeof r!="symbol"?r+"":r,t);import{k as ze,r as n,P as _,D as fe,j as e,c as le,R as gt,E as z,b as bt,f as Z,d as Re,g as De,h as Le,i as Ae,e as $e}from"./index-Dj6S0Vds.js";import{refreshCsrfTokenIfNeeded as vt,getCsrfToken as jt}from"./csrf-DV9n1Bpu.js";import{u as yt,a as wt,t as Nt,n as St,c as kt,f as Fe,b as Ct}from"./custodialNotesSchema-D7gKrHqc.js";import{L as ee,I as pe}from"./label-DPKhZwfT.js";import{T as It}from"./textarea-DP_IwbRP.js";import{A as Et,a as Rt,b as Dt,c as Lt,d as At,e as $t,f as Ft,g as Pt}from"./alert-dialog-CGcyORMn.js";import{R as Mt,P as Tt,O as Ot,C as Ut}from"./dialog-C1qKDHrA.js";import{b as oe,a as qt,C as zt}from"./Combination-FhtnMJpQ.js";import{P as ye,a as we,b as Ne}from"./popover-Bm6fPu5U.js";import{L as Wt}from"./LoadingOverlay-WhG99yva.js";import{S as He}from"./save-FgjQvX-c.js";import{C as Pe}from"./circle-help-DBE5ENyc.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=ze("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=ze("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=ze("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);var Ke=1,Kt=.9,Vt=.8,Gt=.17,Me=.1,Te=.999,Yt=.9999,Qt=.99,_t=/[\\\/_+.#"@\[\(\{&]/,Jt=/[\\\/_+.#"@\[\(\{&]/g,Xt=/[\s-]/,Qe=/[\s-]/g;function Ue(s,r,t,p,o,d,u){if(d===r.length)return o===s.length?Ke:Qt;var l=`${o},${d}`;if(u[l]!==void 0)return u[l];for(var k=p.charAt(d),m=t.indexOf(k,o),j=0,f,A,$,L;m>=0;)f=Ue(s,r,t,p,m+1,d+1,u),f>j&&(m===o?f*=Ke:_t.test(s.charAt(m-1))?(f*=Vt,$=s.slice(o,m-1).match(Jt),$&&o>0&&(f*=Math.pow(Te,$.length))):Xt.test(s.charAt(m-1))?(f*=Kt,L=s.slice(o,m-1).match(Qe),L&&o>0&&(f*=Math.pow(Te,L.length))):(f*=Gt,o>0&&(f*=Math.pow(Te,m-o))),s.charAt(m)!==r.charAt(d)&&(f*=Yt)),(f<Me&&t.charAt(m-1)===p.charAt(d+1)||p.charAt(d+1)===p.charAt(d)&&t.charAt(m-1)!==p.charAt(d))&&(A=Ue(s,r,t,p,m+1,d+2,u),A*Me>f&&(f=A*Me)),f>j&&(j=f),m=t.indexOf(k,m+1);return u[l]=j,j}function Ve(s){return s.toLowerCase().replace(Qe," ")}function Zt(s,r,t){return s=t&&t.length>0?`${s+" "+t.join(" ")}`:s,Ue(s,r,Ve(s),Ve(r),0,0,{})}var xe='[cmdk-group=""]',Oe='[cmdk-group-items=""]',es='[cmdk-group-heading=""]',_e='[cmdk-item=""]',Ge=`${_e}:not([aria-disabled="true"])`,qe="cmdk-item-select",ae="data-value",ts=(s,r,t)=>Zt(s,r,t),Je=n.createContext(void 0),ge=()=>n.useContext(Je),Xe=n.createContext(void 0),We=()=>n.useContext(Xe),Ze=n.createContext(void 0),et=n.forwardRef((s,r)=>{let t=ne(()=>{var a,h;return{search:"",value:(h=(a=s.value)!=null?a:s.defaultValue)!=null?h:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),p=ne(()=>new Set),o=ne(()=>new Map),d=ne(()=>new Map),u=ne(()=>new Set),l=tt(s),{label:k,children:m,value:j,onValueChange:f,filter:A,shouldFilter:$,loop:L,disablePointerSelection:J=!1,vimBindings:T=!0,...G}=s,ie=oe(),se=oe(),I=oe(),W=n.useRef(null),w=ms();te(()=>{if(j!==void 0){let a=j.trim();t.current.value=a,R.emit()}},[j]),te(()=>{w(6,be)},[]);let R=n.useMemo(()=>({subscribe:a=>(u.current.add(a),()=>u.current.delete(a)),snapshot:()=>t.current,setState:(a,h,g)=>{var c,y,N,F;if(!Object.is(t.current[a],h)){if(t.current[a]=h,a==="search")O(),B(),w(1,H);else if(a==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let D=document.getElementById(I);D?D.focus():(c=document.getElementById(ie))==null||c.focus()}if(w(7,()=>{var D;t.current.selectedItemId=(D=Y())==null?void 0:D.id,R.emit()}),g||w(5,be),((y=l.current)==null?void 0:y.value)!==void 0){let D=h??"";(F=(N=l.current).onValueChange)==null||F.call(N,D);return}}R.emit()}},emit:()=>{u.current.forEach(a=>a())}}),[]),re=n.useMemo(()=>({value:(a,h,g)=>{var c;h!==((c=d.current.get(a))==null?void 0:c.value)&&(d.current.set(a,{value:h,keywords:g}),t.current.filtered.items.set(a,ce(h,g)),w(2,()=>{B(),R.emit()}))},item:(a,h)=>(p.current.add(a),h&&(o.current.has(h)?o.current.get(h).add(a):o.current.set(h,new Set([a]))),w(3,()=>{O(),B(),t.current.value||H(),R.emit()}),()=>{d.current.delete(a),p.current.delete(a),t.current.filtered.items.delete(a);let g=Y();w(4,()=>{O(),g?.getAttribute("id")===a&&H(),R.emit()})}),group:a=>(o.current.has(a)||o.current.set(a,new Set),()=>{d.current.delete(a),o.current.delete(a)}),filter:()=>l.current.shouldFilter,label:k||s["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:ie,inputId:I,labelId:se,listInnerRef:W}),[]);function ce(a,h){var g,c;let y=(c=(g=l.current)==null?void 0:g.filter)!=null?c:ts;return a?y(a,t.current.search,h):0}function B(){if(!t.current.search||l.current.shouldFilter===!1)return;let a=t.current.filtered.items,h=[];t.current.filtered.groups.forEach(c=>{let y=o.current.get(c),N=0;y.forEach(F=>{let D=a.get(F);N=Math.max(D,N)}),h.push([c,N])});let g=W.current;X().sort((c,y)=>{var N,F;let D=c.getAttribute("id"),q=y.getAttribute("id");return((N=a.get(q))!=null?N:0)-((F=a.get(D))!=null?F:0)}).forEach(c=>{let y=c.closest(Oe);y?y.appendChild(c.parentElement===y?c:c.closest(`${Oe} > *`)):g.appendChild(c.parentElement===g?c:c.closest(`${Oe} > *`))}),h.sort((c,y)=>y[1]-c[1]).forEach(c=>{var y;let N=(y=W.current)==null?void 0:y.querySelector(`${xe}[${ae}="${encodeURIComponent(c[0])}"]`);N?.parentElement.appendChild(N)})}function H(){let a=X().find(g=>g.getAttribute("aria-disabled")!=="true"),h=a?.getAttribute(ae);R.setState("value",h||void 0)}function O(){var a,h,g,c;if(!t.current.search||l.current.shouldFilter===!1){t.current.filtered.count=p.current.size;return}t.current.filtered.groups=new Set;let y=0;for(let N of p.current){let F=(h=(a=d.current.get(N))==null?void 0:a.value)!=null?h:"",D=(c=(g=d.current.get(N))==null?void 0:g.keywords)!=null?c:[],q=ce(F,D);t.current.filtered.items.set(N,q),q>0&&y++}for(let[N,F]of o.current)for(let D of F)if(t.current.filtered.items.get(D)>0){t.current.filtered.groups.add(N);break}t.current.filtered.count=y}function be(){var a,h,g;let c=Y();c&&(((a=c.parentElement)==null?void 0:a.firstChild)===c&&((g=(h=c.closest(xe))==null?void 0:h.querySelector(es))==null||g.scrollIntoView({block:"nearest"})),c.scrollIntoView({block:"nearest"}))}function Y(){var a;return(a=W.current)==null?void 0:a.querySelector(`${_e}[aria-selected="true"]`)}function X(){var a;return Array.from(((a=W.current)==null?void 0:a.querySelectorAll(Ge))||[])}function de(a){let h=X()[a];h&&R.setState("value",h.getAttribute(ae))}function ue(a){var h;let g=Y(),c=X(),y=c.findIndex(F=>F===g),N=c[y+a];(h=l.current)!=null&&h.loop&&(N=y+a<0?c[c.length-1]:y+a===c.length?c[0]:c[y+a]),N&&R.setState("value",N.getAttribute(ae))}function ve(a){let h=Y(),g=h?.closest(xe),c;for(;g&&!c;)g=a>0?ds(g,xe):us(g,xe),c=g?.querySelector(Ge);c?R.setState("value",c.getAttribute(ae)):ue(a)}let je=()=>de(X().length-1),me=a=>{a.preventDefault(),a.metaKey?je():a.altKey?ve(1):ue(1)},he=a=>{a.preventDefault(),a.metaKey?de(0):a.altKey?ve(-1):ue(-1)};return n.createElement(_.div,{ref:r,tabIndex:-1,...G,"cmdk-root":"",onKeyDown:a=>{var h;(h=G.onKeyDown)==null||h.call(G,a);let g=a.nativeEvent.isComposing||a.keyCode===229;if(!(a.defaultPrevented||g))switch(a.key){case"n":case"j":{T&&a.ctrlKey&&me(a);break}case"ArrowDown":{me(a);break}case"p":case"k":{T&&a.ctrlKey&&he(a);break}case"ArrowUp":{he(a);break}case"Home":{a.preventDefault(),de(0);break}case"End":{a.preventDefault(),je();break}case"Enter":{a.preventDefault();let c=Y();if(c){let y=new Event(qe);c.dispatchEvent(y)}}}}},n.createElement("label",{"cmdk-label":"",htmlFor:re.inputId,id:re.labelId,style:ps},k),ke(s,a=>n.createElement(Xe.Provider,{value:R},n.createElement(Je.Provider,{value:re},a))))}),ss=n.forwardRef((s,r)=>{var t,p;let o=oe(),d=n.useRef(null),u=n.useContext(Ze),l=ge(),k=tt(s),m=(p=(t=k.current)==null?void 0:t.forceMount)!=null?p:u?.forceMount;te(()=>{if(!m)return l.item(o,u?.id)},[m]);let j=st(o,d,[s.value,s.children,d],s.keywords),f=We(),A=Q(w=>w.value&&w.value===j.current),$=Q(w=>m||l.filter()===!1?!0:w.search?w.filtered.items.get(o)>0:!0);n.useEffect(()=>{let w=d.current;if(!(!w||s.disabled))return w.addEventListener(qe,L),()=>w.removeEventListener(qe,L)},[$,s.onSelect,s.disabled]);function L(){var w,R;J(),(R=(w=k.current).onSelect)==null||R.call(w,j.current)}function J(){f.setState("value",j.current,!0)}if(!$)return null;let{disabled:T,value:G,onSelect:ie,forceMount:se,keywords:I,...W}=s;return n.createElement(_.div,{ref:fe(d,r),...W,id:o,"cmdk-item":"",role:"option","aria-disabled":!!T,"aria-selected":!!A,"data-disabled":!!T,"data-selected":!!A,onPointerMove:T||l.getDisablePointerSelection()?void 0:J,onClick:T?void 0:L},s.children)}),rs=n.forwardRef((s,r)=>{let{heading:t,children:p,forceMount:o,...d}=s,u=oe(),l=n.useRef(null),k=n.useRef(null),m=oe(),j=ge(),f=Q($=>o||j.filter()===!1?!0:$.search?$.filtered.groups.has(u):!0);te(()=>j.group(u),[]),st(u,l,[s.value,s.heading,k]);let A=n.useMemo(()=>({id:u,forceMount:o}),[o]);return n.createElement(_.div,{ref:fe(l,r),...d,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},t&&n.createElement("div",{ref:k,"cmdk-group-heading":"","aria-hidden":!0,id:m},t),ke(s,$=>n.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?m:void 0},n.createElement(Ze.Provider,{value:A},$))))}),as=n.forwardRef((s,r)=>{let{alwaysRender:t,...p}=s,o=n.useRef(null),d=Q(u=>!u.search);return!t&&!d?null:n.createElement(_.div,{ref:fe(o,r),...p,"cmdk-separator":"",role:"separator"})}),ns=n.forwardRef((s,r)=>{let{onValueChange:t,...p}=s,o=s.value!=null,d=We(),u=Q(m=>m.search),l=Q(m=>m.selectedItemId),k=ge();return n.useEffect(()=>{s.value!=null&&d.setState("search",s.value)},[s.value]),n.createElement(_.input,{ref:r,...p,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":k.listId,"aria-labelledby":k.labelId,"aria-activedescendant":l,id:k.inputId,type:"text",value:o?s.value:u,onChange:m=>{o||d.setState("search",m.target.value),t?.(m.target.value)}})}),os=n.forwardRef((s,r)=>{let{children:t,label:p="Suggestions",...o}=s,d=n.useRef(null),u=n.useRef(null),l=Q(m=>m.selectedItemId),k=ge();return n.useEffect(()=>{if(u.current&&d.current){let m=u.current,j=d.current,f,A=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let $=m.offsetHeight;j.style.setProperty("--cmdk-list-height",$.toFixed(1)+"px")})});return A.observe(m),()=>{cancelAnimationFrame(f),A.unobserve(m)}}},[]),n.createElement(_.div,{ref:fe(d,r),...o,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":p,id:k.listId},ke(s,m=>n.createElement("div",{ref:fe(u,k.listInnerRef),"cmdk-list-sizer":""},m)))}),ls=n.forwardRef((s,r)=>{let{open:t,onOpenChange:p,overlayClassName:o,contentClassName:d,container:u,...l}=s;return n.createElement(Mt,{open:t,onOpenChange:p},n.createElement(Tt,{container:u},n.createElement(Ot,{"cmdk-overlay":"",className:o}),n.createElement(Ut,{"aria-label":s.label,"cmdk-dialog":"",className:d},n.createElement(et,{ref:r,...l}))))}),is=n.forwardRef((s,r)=>Q(t=>t.filtered.count===0)?n.createElement(_.div,{ref:r,...s,"cmdk-empty":"",role:"presentation"}):null),cs=n.forwardRef((s,r)=>{let{progress:t,children:p,label:o="Loading...",...d}=s;return n.createElement(_.div,{ref:r,...d,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},ke(s,u=>n.createElement("div",{"aria-hidden":!0},u)))}),M=Object.assign(et,{List:os,Item:ss,Input:ns,Group:rs,Separator:as,Dialog:ls,Empty:is,Loading:cs});function ds(s,r){let t=s.nextElementSibling;for(;t;){if(t.matches(r))return t;t=t.nextElementSibling}}function us(s,r){let t=s.previousElementSibling;for(;t;){if(t.matches(r))return t;t=t.previousElementSibling}}function tt(s){let r=n.useRef(s);return te(()=>{r.current=s}),r}var te=typeof window>"u"?n.useEffect:n.useLayoutEffect;function ne(s){let r=n.useRef();return r.current===void 0&&(r.current=s()),r}function Q(s){let r=We(),t=()=>s(r.snapshot());return n.useSyncExternalStore(r.subscribe,t,t)}function st(s,r,t,p=[]){let o=n.useRef(),d=ge();return te(()=>{var u;let l=(()=>{var m;for(let j of t){if(typeof j=="string")return j.trim();if(typeof j=="object"&&"current"in j)return j.current?(m=j.current.textContent)==null?void 0:m.trim():o.current}})(),k=p.map(m=>m.trim());d.value(s,l,k),(u=r.current)==null||u.setAttribute(ae,l),o.current=l}),o}var ms=()=>{let[s,r]=n.useState(),t=ne(()=>new Map);return te(()=>{t.current.forEach(p=>p()),t.current=new Map},[s]),(p,o)=>{t.current.set(p,o),r({})}};function hs(s){let r=s.type;return typeof r=="function"?r(s.props):"render"in r?r.render(s.props):s}function ke({asChild:s,children:r},t){return s&&n.isValidElement(r)?n.cloneElement(hs(r),{ref:r.ref},t(r.props.children)):t(r)}var ps={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const rt=n.forwardRef(({className:s,...r},t)=>e.jsx(M,{ref:t,className:le("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...r}));rt.displayName=M.displayName;const at=n.forwardRef(({className:s,...r},t)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Ht,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(M.Input,{ref:t,className:le("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...r})]}));at.displayName=M.Input.displayName;const xs=n.forwardRef(({className:s,...r},t)=>e.jsx(M.List,{ref:t,className:le("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...r}));xs.displayName=M.List.displayName;const nt=n.forwardRef((s,r)=>e.jsx(M.Empty,{ref:r,className:"py-6 text-center text-sm",...s}));nt.displayName=M.Empty.displayName;const ot=n.forwardRef(({className:s,...r},t)=>e.jsx(M.Group,{ref:t,className:le("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...r}));ot.displayName=M.Group.displayName;const fs=n.forwardRef(({className:s,...r},t)=>e.jsx(M.Separator,{ref:t,className:le("-mx-1 h-px bg-border",s),...r}));fs.displayName=M.Separator.displayName;const lt=n.forwardRef(({className:s,...r},t)=>e.jsx(M.Item,{ref:t,className:le("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s),...r}));lt.displayName=M.Item.displayName;class gs extends gt.Component{constructor(t){super(t);Ee(this,"handleRetry",()=>{window.location.reload()});Ee(this,"handleClearData",()=>{try{localStorage.clear(),console.log("LocalStorage cleared successfully")}catch(t){console.error("Failed to clear localStorage:",t)}window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,p){console.error("LocalStorage Error Boundary caught an error:",t),console.error("Component Stack:",p.componentStack),this.setState({errorInfo:p})}render(){const{hasError:t,error:p,errorInfo:o}=this.state,{children:d,fallback:u}=this.props;return t?u||e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"rounded-full bg-red-100 p-3",children:e.jsx("svg",{className:"h-8 w-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:"Something Went Wrong"}),e.jsx("p",{className:"text-gray-600 text-center mb-6",children:"We encountered an issue saving your preferences. This might happen if your browser's storage is full or if you're using private browsing mode."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:this.handleRetry,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors",children:"Retry"}),e.jsx("button",{onClick:this.handleClearData,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-4 rounded-md transition-colors",children:"Clear Saved Data & Retry"})]}),!1]})}):d}}const Ye={WARNING:80,CRITICAL:95};function bs(s={}){const{onWarning:r,checkInterval:t=3e4,checkOnMount:p=!0}=s,o=n.useRef(new Set),d=async()=>{try{const u=await z.getQuotaInfo();if(!u||u.percentage===0)return;const{percentage:l,usage:k,quota:m}=u,j=f=>{const A=f/1048576;return A<1?`${(f/1024).toFixed(1)} KB`:`${A.toFixed(1)} MB`};if(l>=Ye.CRITICAL){const f=`critical-${Math.floor(l)}`;o.current.has(f)||(console.warn(`[Storage Quota Monitor] CRITICAL: Storage at ${l.toFixed(1)}% capacity`),r?.(`Your browser storage is nearly full (${l.toFixed(1)}% used). Using ${j(k)} of ${j(m)} available. Please clear old data or browser cache to continue using this feature.`,l,"critical"),o.current.add(f))}else if(l>=Ye.WARNING){const f=`warning-${Math.floor(l/5)*5}`;o.current.has(f)||(console.warn(`[Storage Quota Monitor] WARNING: Storage at ${l.toFixed(1)}% capacity`),r?.(`Your browser storage is ${l.toFixed(1)}% full. Using ${j(k)} of ${j(m)} available. Consider clearing old data to ensure smooth operation.`,l,"warning"),o.current.add(f))}}catch(u){console.error("[Storage Quota Monitor] Failed to check quota:",u)}};return n.useEffect(()=>{p&&d();const u=setInterval(d,t);return()=>{clearInterval(u)}},[t,p,r]),{checkQuota:d}}const vs=["ASA","CBR","GWC","LCA","OA","WLC"],js=`
  @keyframes progress {
    from {
      width: 0%;
    }
    to {
      width: 100%;
    }
  }
`;function Fs({onBack:s}){const{toast:r}=bt();bs({onWarning:(i,x,b)=>{r({variant:b==="critical"?"destructive":"default",title:b==="critical"?"‚ö†Ô∏è Storage Almost Full":"‚ö° Storage Warning",description:i,duration:7e3})},checkInterval:3e4,checkOnMount:!0});const{register:t,handleSubmit:p,formState:{errors:o,isSubmitting:d},reset:u,setValue:l,getValues:k,watch:m,clearErrors:j}=yt({resolver:Nt(Ct),defaultValues:wt}),f=m(),[A,$]=n.useState(!1);n.useEffect(()=>{$(!0)},[]);const[L,J]=n.useState([]),[T,G]=n.useState([]),[ie,se]=n.useState(!1),[I,W]=n.useState(null),[w,R]=n.useState(!1),[re,ce]=n.useState(!1),[B,H]=n.useState(""),[O,be]=n.useState(null),[Y,X]=n.useState(!0),[de,ue]=n.useState(!1),[ve,je]=n.useState(!0),[me,he]=n.useState([]),[a,h]=n.useState(null),[g,c]=n.useState(!1),[y,N]=n.useState(!1),[F,D]=n.useState(!1),[q,Ce]=n.useState(null);n.useEffect(()=>{const i=()=>{const x=document.querySelectorAll(".form-section"),b=window.scrollY+window.innerHeight/2;x.forEach((C,E)=>{const K=C.getBoundingClientRect(),v=K.top+window.scrollY,U=v+K.height;b>=v&&b<U&&be(E+1)}),window.scrollY>100&&X(!1)};return window.addEventListener("scroll",i),i(),()=>window.removeEventListener("scroll",i)},[]),n.useEffect(()=>{const i=()=>{const x=window.innerWidth<=768,b=window.innerHeight<500;ue(x&&b)};return i(),window.addEventListener("resize",i),window.addEventListener("orientationchange",i),()=>{window.removeEventListener("resize",i),window.removeEventListener("orientationchange",i)}},[]),n.useEffect(()=>{if(Object.values(f).some(x=>x&&x!=="")&&!w){const x=setTimeout(()=>{c(!0);const b={...f,selectedSchool:B,savedAt:new Date().toISOString()};z.setItem("custodialNotesDraft",JSON.stringify(b)),h(new Date),c(!1)},2e3);return()=>clearTimeout(x)}},[f,B,w]),n.useEffect(()=>{try{const i=z.getItem("custodialNotesDraft");let x=!1;if(i){const C=JSON.parse(i),E=new Date(C.savedAt);(Date.now()-E.getTime())/(1e3*60*60)<24?(x=!0,Object.keys(C).forEach(v=>{v!=="savedAt"&&v!=="selectedSchool"&&l(v,C[v])}),C.selectedSchool&&(H(C.selectedSchool),l("school",C.selectedSchool)),h(E),r({title:"Draft Restored",description:`Your work from ${E.toLocaleString()} was restored.`,duration:5e3})):z.removeItem("custodialNotesDraft")}if(!x){const C=z.getItem("custodialInspectorName");C&&l("inspectorName",C);const E=z.getItem("custodialLastSchool");E&&(H(E),l("school",E))}const b=z.getItem("custodialRecentLocations");if(b){const C=JSON.parse(b);he(Array.isArray(C)?C:[])}}catch(i){console.error("Error loading saved data:",i)}},[l,H,r]);const Be=async i=>{const x=i.target.files;if(x&&x.length>0){const b=Array.from(x),E=5-L.length,K=b.slice(0,E);K.length<b.length&&r({title:"Maximum Images Reached",description:`Only ${K.length} images were added. Maximum of 5 images allowed.`});const v=[];let U=0,P=0;for(const S of K)if(U+=S.size,St(S,500))try{const V=await kt(S,{maxSizeKB:500});v.push(V.compressedFile),P+=V.compressedSize,console.log(`Compressed ${S.name}: ${Fe(S.size)} ‚Üí ${Fe(V.compressedSize)}`)}catch(V){console.error("Failed to compress image:",V),v.push(S),P+=S.size}else v.push(S),P+=S.size;J(S=>[...S,...v]);const Ie=v.map(S=>URL.createObjectURL(S));if(G(S=>[...S,...Ie]),v.length>0){const S=U-P,V=S>0?(S/U*100).toFixed(1):"0";r({title:"üì∏ Photos Uploaded Successfully!",description:`Successfully added ${v.length} photo${v.length>1?"s":""} to your custodial note documentation.${S>0?` Saved ${Fe(S)} (${V}% compression).`:""}`,duration:3e3})}}i.target.value=""},it=()=>{if(L.length>=5){r({variant:"destructive",title:"Maximum Images Reached",description:"Maximum of 5 images allowed. Please remove some images first."});return}const i=document.createElement("input");i.type="file",i.accept="image/*",i.capture="environment",i.onchange=x=>{const b=x;b.target.files&&b.target.files.length>0&&r({title:"üì∑ Photo Captured Successfully!",description:"Camera photo is being processed and added to your documentation.",duration:2e3}),Be(b)},i.click()},ct=i=>{const x=L.filter((C,E)=>E!==i),b=T.filter((C,E)=>E!==i);URL.revokeObjectURL(T[i]),J(x),G(b)},dt=i=>{i.trim()&&he(x=>{const b=x.filter(E=>E!==i),C=[i,...b].slice(0,5);try{z.setItem("custodialRecentLocations",JSON.stringify(C))}catch(E){console.error("Error saving recent locations:",E)}return C})},ut=()=>{q&&(l("inspectorName",q.inspectorName),l("school",q.school),l("date",q.date),l("location",q.location),l("locationDescription",q.locationDescription||""),H(q.school),l("notes",""),l("images",[]),D(!1),Ce(null),window.scrollTo({top:0,behavior:"smooth"}),r({title:"Form Pre-filled",description:"Inspector, school, date, and location have been filled in. Just add new notes and photos!",duration:4e3}))},mt=()=>{D(!1),Ce(null),s&&s()},ht=async i=>{W(i),se(!0)},pt=async()=>{if(I){R(!0),se(!1);try{const i=new FormData;Object.entries(I).forEach(([v,U])=>{v!=="images"&&i.append(v,U?.toString()||"")}),L.forEach(v=>{i.append("images",v)}),await vt();const x=jt(),b={method:"POST",body:i,credentials:"include",headers:x?{"x-csrf-token":x}:{}},C=new AbortController,E=setTimeout(()=>C.abort(),3e4);b.signal=C.signal;const K=await fetch("/api/custodial-notes",b);if(clearTimeout(E),K.ok){N(!0),z.removeItem("custodialNotesDraft");try{z.setItem("custodialInspectorName",I.inspectorName),z.setItem("custodialLastSchool",B),dt(I.location)}catch(P){console.error("Error saving user preferences:",P)}Ce(I),r({title:"‚úÖ Custodial Note Submitted Successfully!",description:"Your custodial concern has been recorded and will be reviewed.",variant:"default",duration:5e3});const v=I.inspectorName,U=B;u(),l("inspectorName",v),l("school",U),H(U),J([]),T.forEach(P=>URL.revokeObjectURL(P)),G([]),W(null),h(null),R(!1),setTimeout(()=>{N(!1),D(!0)},3e3)}else{const v=await K.json().catch(()=>({success:!1,message:"Unknown error occurred",details:"Unable to parse server response"}));let U=v.message||"Unable to submit custodial note. Please try again.",P="";v.success===!1&&v.details&&(Array.isArray(v.details)?P=`Please check: ${v.details.map(S=>`${S.field}: ${S.message}`).join(", ")}`:typeof v.details=="object"?P=`Required: ${Object.entries(v.details).filter(([S,V])=>V==="‚úó required").map(([S])=>S.replace(/([A-Z])/g," $1").trim()).join(", ")}`:P=v.details),(v.technical==="FormData parsing failed"||v.message?.includes("form data is malformed"))&&(U="Form submission error",P="Please refresh the page and try submitting again. If the problem persists, contact support."),r({variant:"destructive",title:"‚ùå Submission Failed",description:`${U}${P?`

${P}`:""}`,duration:8e3}),R(!1)}}catch(i){console.error("Error submitting custodial note:",i);let x="Network Error",b="Unable to connect to the server. Please check your connection and try again.";i instanceof Error&&i.name==="AbortError"?(x="Request Timeout",b=`The request took too long to complete. This might be due to:
‚Ä¢ Slow internet connection
‚Ä¢ Large file uploads
‚Ä¢ Server being busy

Please try again.`):i instanceof TypeError&&(i.message.includes("Failed to fetch")?(x="Connection Failed",b=`Unable to reach the server. Please check:
‚Ä¢ Internet connection
‚Ä¢ Server is running
‚Ä¢ No firewall blocking the request`):i.message.includes("NetworkError")&&(x="Network Error",b="A network error occurred. Please try again.")),r({variant:"destructive",title:`‚ùå ${x}`,description:b,duration:8e3}),R(!1)}}};return e.jsxs(gs,{children:[e.jsx("style",{children:js}),e.jsxs("div",{className:"max-w-3xl mx-auto p-6 space-y-8","data-loaded":A?"true":void 0,children:[s&&e.jsx(Z,{onClick:s,variant:"outline",className:"mb-4 back-button min-h-[48px] px-6",children:"‚Üê Back to Custodial"}),de&&ve&&e.jsx("div",{className:"bg-orange-50 border-2 border-orange-400 rounded-lg p-4 shadow-lg",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("span",{className:"text-2xl flex-shrink-0",children:"üì±"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-orange-900 text-lg mb-1",children:"Landscape Mode Detected"}),e.jsxs("p",{className:"text-orange-800 text-sm",children:["For the best experience filling out this form, please"," ",e.jsx("strong",{children:"rotate your device to portrait mode"})," ","(vertical orientation)."]})]})]}),e.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>je(!1),className:"text-orange-900 hover:bg-orange-100 flex-shrink-0",children:"‚úï"})]})}),a&&e.jsx("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-500",children:g?e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"h-4 w-4 animate-pulse"}),e.jsx("span",{children:"Saving draft..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:["Draft saved at ",a.toLocaleTimeString()]})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-blue-800 mb-2",children:"Submit Custodial Note"}),e.jsx("p",{className:"text-gray-600",children:"Report maintenance issues, concerns, or general observations"})]}),e.jsx("div",{className:"sticky top-0 z-10 bg-white/95 backdrop-blur-sm border-b-2 border-blue-200 py-3 -mx-6 px-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Form Progress:"}),O&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-bold bg-blue-100 text-blue-800 border-2 border-blue-300",children:["Section ",O," of 3"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:`w-16 h-2 rounded-full transition-colors ${O===1?"bg-blue-600":O&&O>1?"bg-blue-400":"bg-gray-200"}`}),e.jsx("div",{className:`w-16 h-2 rounded-full transition-colors ${O===2?"bg-blue-600":O&&O>2?"bg-blue-400":"bg-gray-200"}`}),e.jsx("div",{className:`w-16 h-2 rounded-full transition-colors ${O===3?"bg-blue-600":"bg-gray-200"}`})]})]})}),Y&&e.jsxs("div",{className:"animate-bounce text-center text-gray-500 text-sm",children:[e.jsx(qt,{className:"inline-block"}),e.jsx("p",{children:"Scroll down to continue"})]}),e.jsx("div",{className:"bg-amber-50 border-2 border-amber-400 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl flex-shrink-0",children:"‚≠ê"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-amber-900 text-lg mb-1",children:"New Requirement: Inspector Name"}),e.jsxs("p",{className:"text-amber-800 text-sm",children:["Please enter your name in the ",e.jsx("strong",{children:"Inspector Name"})," ","field. This is now required for all custodial notes to ensure proper accountability and follow-up."]})]})]})}),e.jsxs("form",{onSubmit:p(ht),className:"space-y-8",children:[e.jsxs(Re,{className:"form-section",children:[e.jsxs(De,{children:[e.jsx(Le,{children:"Basic Information"}),e.jsx(Ae,{children:"Enter the basic details for this custodial note"})]}),e.jsxs($e,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{htmlFor:"inspectorName",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"Inspector Name"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"}),e.jsxs(ye,{children:[e.jsx(we,{asChild:!0,children:e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Pe,{className:"h-4 w-4"})})}),e.jsxs(Ne,{className:"w-80 text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Why is this required?"}),e.jsx("p",{className:"text-gray-600",children:"Your name ensures accountability and allows for proper follow-up on reported issues. This helps maintain quality standards across all facilities."})]})]})]}),e.jsx(pe,{id:"inspectorName",...t("inspectorName"),placeholder:"Enter your name",className:"border-2 min-h-[48px]"}),o.inspectorName&&e.jsx("p",{className:"text-sm text-red-500",children:o.inspectorName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{htmlFor:"school",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"School"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"})]}),e.jsxs(ye,{open:re,onOpenChange:ce,children:[e.jsx(we,{asChild:!0,children:e.jsxs(Z,{variant:"outline",role:"combobox","aria-expanded":re,className:"w-full justify-between border-2 min-h-[48px] text-left font-normal",children:[B||"Select school...",e.jsx(Bt,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Ne,{className:"w-full p-0",align:"start",children:e.jsxs(rt,{children:[e.jsx(at,{placeholder:"Search schools..."}),e.jsx(nt,{children:"No school found."}),e.jsx(ot,{children:vs.map(i=>e.jsxs(lt,{value:i,onSelect:x=>{const b=x.toUpperCase();H(b),l("school",b),ce(!1)},className:"min-h-[48px] cursor-pointer",children:[e.jsx(zt,{className:`mr-2 h-4 w-4 ${B===i?"opacity-100":"opacity-0"}`}),i]},i))})]})})]}),o.school&&e.jsx("p",{className:"text-sm text-red-500",children:o.school.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{htmlFor:"date",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"Date"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(pe,{id:"date",type:"date",...t("date"),className:"border-2 min-h-[48px] pr-10"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})})]}),o.date&&e.jsx("p",{className:"text-sm text-red-500",children:o.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{htmlFor:"location",className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"Location"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:"Required"}),e.jsxs(ye,{children:[e.jsx(we,{asChild:!0,children:e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Pe,{className:"h-4 w-4"})})}),e.jsxs(Ne,{className:"w-80 text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Location Examples"}),e.jsxs("ul",{className:"text-gray-600 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:'Room numbers: "Room 105", "Classroom 202"'}),e.jsx("li",{children:'Common areas: "Gymnasium", "Cafeteria", "Library"'}),e.jsx("li",{children:'Outdoor: "Playground", "Parking Lot", "Field"'}),e.jsx("li",{children:'Facilities: "Restroom 1st Floor", "Main Office"'})]})]})]})]}),me.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1.5",children:"Recent locations:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:me.map((i,x)=>e.jsx("button",{type:"button",onClick:()=>{l("location",i),o.location&&j("location")},className:"inline-flex items-center px-3 py-1.5 rounded-md text-sm bg-blue-50 text-blue-700 border border-blue-200 hover:bg-blue-100 hover:border-blue-300 transition-colors",children:i},x))})]}),e.jsx(pe,{id:"location",...t("location"),placeholder:"e.g., Room 105, Gymnasium, Cafeteria",className:"border-2 min-h-[48px]"}),o.location&&e.jsx("p",{className:"text-sm text-red-500",children:o.location.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ee,{htmlFor:"locationDescription",children:"Location Description"}),e.jsx(pe,{id:"locationDescription",...t("locationDescription"),placeholder:"e.g., Main Building, East Wing, 2nd Floor",className:"min-h-[48px]"}),o.locationDescription&&e.jsx("p",{className:"text-sm text-red-500",children:o.locationDescription.message})]})]})]}),e.jsxs(Re,{className:"form-section",children:[e.jsxs(De,{children:[e.jsxs(Le,{className:"flex items-center gap-2",children:["Issue Description & Notes",e.jsxs(ye,{children:[e.jsx(we,{asChild:!0,children:e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Pe,{className:"h-4 w-4"})})}),e.jsxs(Ne,{className:"w-80 text-sm",children:[e.jsx("p",{className:"font-semibold mb-2",children:"What to Include"}),e.jsxs("ul",{className:"text-gray-600 space-y-1 list-disc list-inside",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"What:"})," Describe the issue clearly"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Where:"})," Specific location details"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"When:"})," When you noticed it"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Severity:"})," Is it urgent or can it wait?"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Impact:"})," How does it affect operations?"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Action:"})," What needs to be done?"]})]})]})]})]}),e.jsx(Ae,{children:"Provide detailed information about the custodial issue or observation"})]}),e.jsxs($e,{children:[e.jsx(It,{...t("notes"),"data-testid":"custodial-notes-description",placeholder:`Describe the issue, maintenance need, or observation...

Examples:
‚Ä¢ Broken equipment or fixtures
‚Ä¢ Cleaning supply needs
‚Ä¢ Safety concerns
‚Ä¢ Maintenance requests
‚Ä¢ General observations
‚Ä¢ Follow-up needed`,rows:10,className:"min-h-[250px]"}),o.notes&&e.jsx("p",{className:"text-sm text-red-500 mt-2",children:o.notes.message})]})]}),e.jsxs(Re,{className:"form-section",children:[e.jsxs(De,{children:[e.jsx(Le,{children:"Photos & Documentation"}),e.jsx(Ae,{children:"Upload images or capture photos to document the issue"})]}),e.jsxs($e,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(ee,{htmlFor:"imageUpload",className:"block mb-2",children:"Upload Images (Optional)"}),e.jsx(pe,{id:"imageUpload",type:"file",accept:"image/*",multiple:!0,onChange:Be,className:"hidden"}),e.jsx(Z,{type:"button",onClick:()=>document.getElementById("imageUpload")?.click(),variant:"outline",className:"w-full h-12 border-2 border-dashed hover:border-blue-500 hover:bg-blue-50 transition-colors",children:e.jsxs("span",{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"text-2xl",children:"üìÅ"}),e.jsxs("span",{className:"font-medium",children:["Tap to Select Photos"," ",L.length>0&&`(${L.length} selected)`]})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum 5 images ‚Ä¢ Images auto-compressed"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(Z,{type:"button",onClick:it,variant:"outline",className:"w-full sm:w-auto h-12 border-2",children:e.jsxs("span",{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"text-xl",children:"üì∑"}),e.jsx("span",{children:"Capture Photo"})]})})})]}),T.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs(ee,{className:"block mb-2",children:["Uploaded Images (",L.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:T.map((i,x)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:i,alt:`Upload ${x+1}`,className:"w-full h-24 object-cover rounded-lg border"}),e.jsx(Z,{type:"button",onClick:()=>ct(x),variant:"destructive",size:"sm",className:"absolute top-1 right-1 w-6 h-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:"√ó"})]},x))})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Z,{type:"submit",size:"lg",disabled:d||w,className:"w-full md:w-auto disabled:bg-gray-400 disabled:cursor-not-allowed min-h-[56px] text-lg font-semibold transition-all duration-300 relative overflow-hidden",children:d||w?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-5 h-5 border-3 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-5 h-5 border-3 border-white/30 rounded-full"})]}),e.jsx("span",{className:"animate-pulse",children:"Submitting your report..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5"}),e.jsx("span",{children:"Submit Custodial Note"})]})})})]}),e.jsx(Et,{open:ie,onOpenChange:se,children:e.jsxs(Rt,{className:"max-w-lg",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-blue-800 text-xl",children:"‚úÖ Confirm Submission"}),e.jsx(At,{className:"text-left",children:"Please review your custodial note before submitting:"})]}),I&&e.jsx("div",{className:"space-y-3 py-4",children:e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Inspector:"}),e.jsx("p",{className:"text-gray-900",children:I.inspectorName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"School:"}),e.jsx("p",{className:"text-gray-900",children:I.school})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Date:"}),e.jsx("p",{className:"text-gray-900",children:I.date})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Location:"}),e.jsx("p",{className:"text-gray-900",children:I.location})]})]}),I.locationDescription&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Location Details:"}),e.jsx("p",{className:"text-gray-900 text-sm",children:I.locationDescription})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Notes:"}),e.jsx("p",{className:"text-gray-900 text-sm max-h-24 overflow-y-auto",children:I.notes&&I.notes.length>200?`${I.notes.substring(0,200)}...`:I.notes||"No notes provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-gray-700",children:"Photos:"}),e.jsxs("p",{className:"text-gray-900",children:[L.length," image",L.length!==1?"s":""," ","attached"]})]})]})}),e.jsxs($t,{children:[e.jsx(Ft,{children:"Review/Edit"}),e.jsx(Pt,{onClick:pt,className:"bg-blue-600 hover:bg-blue-700",children:"Confirm & Submit"})]})]})}),w&&e.jsx(Wt,{message:"Submitting report..."}),y&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsx("div",{className:"bg-white rounded-2xl p-8 max-w-md mx-4 shadow-2xl animate-in zoom-in duration-500",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center animate-bounce",children:e.jsx("div",{className:"w-20 h-20 bg-green-500 rounded-full flex items-center justify-center animate-pulse",children:e.jsx("svg",{className:"w-12 h-12 text-white animate-in zoom-in duration-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})}),e.jsx(Se,{className:"absolute -top-2 -right-2 h-8 w-8 text-yellow-400 animate-pulse"}),e.jsx(Se,{className:"absolute -bottom-2 -left-2 h-6 w-6 text-yellow-400 animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx(Se,{className:"absolute -top-2 -left-2 h-5 w-5 text-blue-400 animate-pulse",style:{animationDelay:"0.4s"}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-700",children:"üéâ Success!"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Your custodial note has been submitted successfully!"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting you back to the home page..."})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-400 to-blue-500 rounded-full animate-[progress_3s_ease-in-out]",style:{animation:"progress 3s ease-in-out forwards"}})})]})})}),F&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsx("div",{className:"bg-white rounded-2xl p-8 max-w-md mx-4 shadow-2xl animate-in zoom-in duration-500",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Report Another Issue?"}),e.jsx("p",{className:"text-gray-600",children:"Found another issue at the same location?"}),e.jsx("p",{className:"text-sm text-gray-500",children:"We can pre-fill your inspector name, school, date, and location to save you time!"})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:ut,className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors shadow-md hover:shadow-lg min-h-[48px]",children:"üìù Report Another Issue Here"}),e.jsx("button",{onClick:mt,className:"w-full px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold rounded-lg transition-colors min-h-[48px]",children:"üè† Return to Home"})]})]})})})]})]})}export{Fs as default};
