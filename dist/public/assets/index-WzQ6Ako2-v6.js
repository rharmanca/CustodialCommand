const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/inspection-pages-DEsUsoKz-v6.js","assets/vendor-DRCB0pYT-v6.js","assets/ui-BA32w1ww-v6.js","assets/utils-Cj9wHvoQ-v6.js","assets/forms-D1o2udeL-v6.js","assets/charts-core-CvcZUgxY-v6.js","assets/pdf-export-BQts-O96-v6.js","assets/data-pages-Du91enDM-v6.js","assets/notes-pages-E1oNcr49-v6.js","assets/building-inspection-eni4S2t--v6.js","assets/admin-pages-tVePfbD9-v6.js","assets/feedback-pages-B3z_JzKU-v6.js","assets/dashboard-pages-DxTeAhYF-v6.js"])))=>i.map(i=>d[i]);
var uk=Object.defineProperty,ck=Object.defineProperties;var mk=Object.getOwnPropertyDescriptors;var $l=Object.getOwnPropertySymbols;var v1=Object.prototype.hasOwnProperty,b1=Object.prototype.propertyIsEnumerable;var N1=e=>{throw TypeError(e)},Wl=Math.pow,lm=(e,t,r)=>t in e?uk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,H=(e,t)=>{for(var r in t||(t={}))v1.call(t,r)&&lm(e,r,t[r]);if($l)for(var r of $l(t))b1.call(t,r)&&lm(e,r,t[r]);return e},he=(e,t)=>ck(e,mk(t));var Ee=(e,t)=>{var r={};for(var n in e)v1.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&$l)for(var n of $l(e))t.indexOf(n)<0&&b1.call(e,n)&&(r[n]=e[n]);return r};var et=(e,t,r)=>lm(e,typeof t!="symbol"?t+"":t,r),um=(e,t,r)=>t.has(e)||N1("Cannot "+r);var me=(e,t,r)=>(um(e,t,"read from private field"),r?r.call(e):t.get(e)),it=(e,t,r)=>t.has(e)?N1("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),We=(e,t,r,n)=>(um(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Nr=(e,t,r)=>(um(e,t,"access private method"),r);var Gl=(e,t,r,n)=>({set _(a){We(e,t,a,r)},get _(){return me(e,t,n)}});var bt=(e,t,r)=>new Promise((n,a)=>{var i=l=>{try{o(r.next(l))}catch(u){a(u)}},s=l=>{try{o(r.throw(l))}catch(u){a(u)}},o=l=>l.done?n(l.value):Promise.resolve(l.value).then(i,s);o((r=r.apply(e,t)).next())});import{r as W,O as dk,j as d,Q as UE,V as RE,W as OE,Y as VE,X as Ga,Z as PE,_ as IE,$ as ME,z as Fr,i as xx,E as Fn,a0 as jE,a1 as y1,l as LE,a2 as fk,a3 as BE,H as hk,a4 as pk,x as dn,a5 as gx,U as za,a6 as xk,R as vs,a7 as gk,a8 as qE,a9 as vk,aa as bk,ab as zE,ac as Nk,ad as Fi,ae as yk,af as HE,ag as Ck,ah as $E,ai as wk,g as vx,aj as Ek,ak as WE,al as GE,am as YE,an as XE,ao as KE,ap as QE,aq as _k,ar as ZE,as as bx,at as Sk,au as JE,av as e_,aw as Nx,h as yc,k as t_,ax as r_,ay as Tk,az as n_,aA as a_,aB as i_,aC as s_,b as zs,aD as o_,w as mn,aE as yx,aF as Dk,aG as op,p as Ya,u as yr,F as Sa,aH as Ak,aI as C1,aJ as l_,aK as u_,aL as kk,aM as Fk,aN as c_,aO as Uk,y as Ii,aP as Rk,aQ as Ok,n as Ou,aR as m_,aS as d_,aT as Vk,aU as Pk,aV as Ik,aW as Mk,aX as jk,aY as Lk,G as f_,aZ as cm,a as Bk,a_ as qk,a$ as zk,b0 as Hk,b1 as So,b2 as $k,b3 as Wk,b4 as Gk,b5 as Yk,b6 as Xk,b7 as h_,b8 as p_,b9 as Kk,ba as Qk,A as Zk,bb as Jk,bc as eF,bd as tF,be as x_,bf as g_,bg as v_,bh as b_,bi as N_,bj as y_,bk as bs,bl as ai,bm as $o,bn as rF,bo as nF,bp as aF,bq as iF,br as C_,C as w_,e as w1,bs as sF,bt as oF,bu as lF,T as uF}from"./vendor-DRCB0pYT-v6.js";import{o as E_,a as __,s as Gr,n as bn,l as To,i as cF}from"./forms-D1o2udeL-v6.js";import{R as Cx,L as mF,C as S_,X as T_,Y as D_,T as A_,a as k_,b as E1,B as dF,c as _1,d as S1,e as fF,P as hF,f as pF,g as xF,h as gF}from"./charts-core-CvcZUgxY-v6.js";import{c as F_,t as vF,s as mm,a as T1,f as Vu,e as bF}from"./utils-Cj9wHvoQ-v6.js";import{E as bl,a as Mi}from"./pdf-export-BQts-O96-v6.js";import"./ui-BA32w1ww-v6.js";import"./index-WzQ6Ako2-v6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Do=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function at(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var dm={exports:{}},fm={},D1;function NF(){return D1||(D1=1,(function(e){/**
 * @license React
 * scheduler.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var t=!1,r=5;function n(xe,Oe){var Be=xe.length;xe.push(Oe),s(xe,Oe,Be)}function a(xe){return xe.length===0?null:xe[0]}function i(xe){if(xe.length===0)return null;var Oe=xe[0],Be=xe.pop();return Be!==Oe&&(xe[0]=Be,o(xe,Be,0)),Oe}function s(xe,Oe,Be){for(var Je=Be;Je>0;){var mt=Je-1>>>1,kt=xe[mt];if(l(kt,Oe)>0)xe[mt]=Oe,xe[Je]=kt,Je=mt;else return}}function o(xe,Oe,Be){for(var Je=Be,mt=xe.length,kt=mt>>>1;Je<kt;){var rt=(Je+1)*2-1,Jt=xe[rt],ut=rt+1,nn=xe[ut];if(l(Jt,Oe)<0)ut<mt&&l(nn,Jt)<0?(xe[Je]=nn,xe[ut]=Oe,Je=ut):(xe[Je]=Jt,xe[rt]=Oe,Je=rt);else if(ut<mt&&l(nn,Oe)<0)xe[Je]=nn,xe[ut]=Oe,Je=ut;else return}}function l(xe,Oe){var Be=xe.sortIndex-Oe.sortIndex;return Be!==0?Be:xe.id-Oe.id}var u=1,c=2,m=3,h=4,f=5;function x(xe,Oe){}var p=typeof performance=="object"&&typeof performance.now=="function";if(p){var g=performance;if(typeof e!=="undefined"){e.unstable_now=function(){return g.now()}}}}else{var v=Date,C=v.now();e.unstable_now=function(){return v.now()-C}}var b=1073741823,N=-1,F=250,E=5e3,w=1e4,S=b,_=[],U=[],R=1,q=null,M=m,Y=!1,K=!1,de=!1,pe=typeof setTimeout=="function"?setTimeout:null,Ae=typeof clearTimeout=="function"?clearTimeout:null,Ne=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(xe){for(var Oe=a(U);Oe!==null;){if(Oe.callback===null)i(U);else if(Oe.startTime<=xe)i(U),Oe.sortIndex=Oe.expirationTime,n(_,Oe);else return;Oe=a(U)}}function le(xe){if(de=!1,k(xe),!K)if(a(_)!==null)K=!0,Rr(j);else{var Oe=a(U);Oe!==null&&se(le,Oe.startTime-xe)}}function j(xe,Oe){K=!1,de&&(de=!1,oe()),Y=!0;var Be=M;try{var Je;if(!t)return y(xe,Oe)}finally{q=null,M=Be,Y=!1}}function y(xe,Oe){var Be=Oe;for(k(Be),q=a(_);q!==null&&!(q.expirationTime>Be&&(!xe||Ot()));){var Je=q.callback;if(typeof Je=="function"){q.callback=null,M=q.priorityLevel;var mt=q.expirationTime<=Be,kt=Je(mt);Be=e.unstable_now(),typeof kt=="function"?q.callback=kt:q===a(_)&&i(_),k(Be)}else i(_);q=a(_)}if(q!==null)return!0;var rt=a(U);return rt!==null&&se(le,rt.startTime-Be),!1}function V(xe,Oe){switch(xe){case u:case c:case m:case h:case f:break;default:xe=m}var Be=M;M=xe;try{return Oe()}finally{M=Be}}function I(xe){var Oe;switch(M){case u:case c:case m:Oe=m;break;default:Oe=M;break}var Be=M;M=Oe;try{return xe()}finally{M=Be}}function G(xe){var Oe=M;return function(){var Be=M;M=Oe;try{return xe.apply(this,arguments)}finally{M=Be}}}function ie(xe,Oe,Be){var Je=e.unstable_now(),mt;if(typeof Be=="object"&&Be!==null){var kt=Be.delay;typeof kt=="number"&&kt>0?mt=Je+kt:mt=Je}else mt=Je;var rt;switch(xe){case u:rt=N;break;case c:rt=F;break;case f:rt=S;break;case h:rt=w;break;case m:default:rt=E;break}var Jt=mt+rt,ut={id:R++,callback:Oe,priorityLevel:xe,startTime:mt,expirationTime:Jt,sortIndex:-1};return mt>Je?(ut.sortIndex=mt,n(U,ut),a(_)===null&&ut===a(U)&&(de?oe():de=!0,se(le,mt-Je))):(ut.sortIndex=Jt,n(_,ut),!K&&!Y&&(K=!0,Rr(j))),ut}function ae(){}function Q(){!K&&!Y&&(K=!0,Rr(j))}function Z(){return a(_)}function ve(xe){xe.callback=null}function J(){return M}var je=!1,ke=null,tt=-1,ze=r,Se=-1;function Ot(){var xe=e.unstable_now()-Se;return!(xe<ze)}function cr(){}function Zt(xe){if(xe<0||xe>125){console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported");return}xe>0?ze=Math.floor(1e3/xe):ze=r}var zt=function(){if(ke!==null){var xe=e.unstable_now();Se=xe;var Oe=!0,Be=!0;try{Be=ke(Oe,xe)}finally{Be?nr():(je=!1,ke=null)}}else je=!1},nr;if(typeof Ne=="function")nr=function(){Ne(zt)};else if(typeof MessageChannel!="undefined"){var gr=new MessageChannel,ht=gr.port2;gr.port1.onmessage=zt,nr=function(){ht.postMessage(null)}}else nr=function(){pe(zt,0)};function Rr(xe){ke=xe,je||(je=!0,nr())}function se(xe,Oe){tt=pe(function(){xe(e.unstable_now())},Oe)}function oe(){Ae(tt),tt=-1}var Te=cr,qe=null;e.unstable_IdlePriority=f,e.unstable_ImmediatePriority=u,e.unstable_LowPriority=h,e.unstable_NormalPriority=m,e.unstable_Profiling=qe,e.unstable_UserBlockingPriority=c,e.unstable_cancelCallback=ve,e.unstable_continueExecution=Q,e.unstable_forceFrameRate=Zt,e.unstable_getCurrentPriorityLevel=J,e.unstable_getFirstCallbackNode=Z,e.unstable_next=I,e.unstable_pauseExecution=ae,e.unstable_requestPaint=Te,e.unstable_runWithPriority=V,e.unstable_scheduleCallback=ie,e.unstable_shouldYield=Ot,e.unstable_wrapCallback=G,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)})()})(fm)),fm}var A1;function iZ(){return A1||(A1=1,dm.exports=NF()),dm.exports}const yF="modulepreload",CF=function(e){return"/"+e},k1={},ii=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let s=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=s(r.map(u=>{if(u=CF(u),u in k1)return;k1[u]=!0;const c=u.endsWith(".css"),m=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":yF,c||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),c)return new Promise((f,x)=>{h.addEventListener("load",f),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},F1=768;function wF(){const[e,t]=W.useState(void 0),[r,n]=W.useState(!1),[a,i]=W.useState("portrait");return W.useEffect(()=>{const s=window.matchMedia(`(max-width: ${F1-1}px)`),o=window.matchMedia("(orientation: portrait)"),l=()=>{t(window.innerWidth<F1),i(o.matches?"portrait":"landscape")},u=()=>{n("ontouchstart"in window||navigator.maxTouchPoints>0)};return s.addEventListener("change",l),o.addEventListener("change",l),l(),u(),()=>{s.removeEventListener("change",l),o.removeEventListener("change",l)}},[]),{isMobile:!!e,isTouch:r,orientation:a}}function EF(){const[e,t]=W.useState([]),r=W.useCallback(u=>{const c=Math.random().toString(36).substr(2,9),m=u.type==="error"?7e3:5e3,h=he(H({},u),{id:c,duration:u.duration||m});return t(f=>[...f,h]),h.duration!==0&&setTimeout(()=>{n(c)},h.duration),c},[]),n=W.useCallback(u=>{t(c=>c.filter(m=>m.id!==u))},[]),a=W.useCallback(()=>{t([])},[]),i=W.useCallback((u,c,m)=>r({type:"success",message:u,title:c||"Success",duration:m}),[r]),s=W.useCallback((u,c,m)=>r({type:"error",message:u,title:c||"Error",duration:m}),[r]),o=W.useCallback((u,c,m)=>r({type:"info",message:u,title:c||"Info",duration:m}),[r]),l=W.useCallback((u,c,m)=>r({type:"warning",message:u,title:c||"Warning",duration:m}),[r]);return{notifications:e,addNotification:r,removeNotification:n,clearAllNotifications:a,showSuccess:i,showError:s,showInfo:o,showWarning:l}}const wi=class wi{constructor(){et(this,"storage",new Map);et(this,"useLocalStorage");et(this,"warnings",new Set);this.useLocalStorage=this.checkLocalStorageAvailability(),this.useLocalStorage||console.warn("SafeLocalStorage: localStorage is unavailable. Using in-memory fallback storage. Data will not persist across page reloads.")}static getInstance(){return wi.instance||(wi.instance=new wi),wi.instance}checkLocalStorageAvailability(){try{if(typeof window=="undefined"||!("localStorage"in window))return!1;const t=window.localStorage,r="__safe_storage_test__",n="test";t.setItem(r,n);const a=t.getItem(r);return t.removeItem(r),a===n}catch(t){return!1}}setItem(t,r){if(this.useLocalStorage)try{localStorage.setItem(t,r);return}catch(n){this.handleStorageError(n,"setItem")}this.storage.set(t,r)}getItem(t){if(this.useLocalStorage)try{return localStorage.getItem(t)}catch(r){this.handleStorageError(r,"getItem")}return this.storage.get(t)||null}removeItem(t){if(this.useLocalStorage)try{localStorage.removeItem(t);return}catch(r){this.handleStorageError(r,"removeItem")}this.storage.delete(t)}clear(){if(this.useLocalStorage)try{localStorage.clear();return}catch(t){this.handleStorageError(t,"clear")}this.storage.clear()}keys(){if(this.useLocalStorage)try{return Object.keys(localStorage)}catch(t){this.handleStorageError(t,"keys")}return Array.from(this.storage.keys())}get length(){if(this.useLocalStorage)try{return localStorage.length}catch(t){this.handleStorageError(t,"length")}return this.storage.size}isUsingLocalStorage(){return this.useLocalStorage}getQuotaInfo(){return bt(this,null,function*(){if("storage"in navigator&&"estimate"in navigator.storage)try{const t=yield navigator.storage.estimate(),r=t.usage||0,n=t.quota||0,a=n>0?r/n*100:0;return{usage:r,quota:n,percentage:Math.round(a*100)/100}}catch(t){console.warn("SafeLocalStorage: Unable to get quota info",t)}return null})}handleStorageError(t,r){const n=`${r}:${t.name}`;this.warnings.has(n)||(console.warn(`SafeLocalStorage: ${r} failed with ${t.name}. Switching to in-memory fallback storage.`,t),this.warnings.add(n)),(t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&console.error("SafeLocalStorage: Storage quota exceeded. Consider clearing old data or increasing storage allocation."),this.useLocalStorage&&(this.useLocalStorage=!1,console.warn("SafeLocalStorage: Permanently switched to in-memory fallback mode for this session."))}};et(wi,"instance");let lp=wi;const Ut=lp.getInstance(),_F=1,SF=1e6;let hm=0;function TF(){return hm=(hm+1)%Number.MAX_SAFE_INTEGER,hm.toString()}const pm=new Map,U1=e=>{if(pm.has(e))return;const t=setTimeout(()=>{pm.delete(e),ko({type:"REMOVE_TOAST",toastId:e})},SF);pm.set(e,t)},DF=(e,t)=>{switch(t.type){case"ADD_TOAST":return he(H({},e),{toasts:[t.toast,...e.toasts].slice(0,_F)});case"UPDATE_TOAST":return he(H({},e),{toasts:e.toasts.map(r=>r.id===t.toast.id?H(H({},r),t.toast):r)});case"DISMISS_TOAST":{const{toastId:r}=t;return r?U1(r):e.toasts.forEach(n=>{U1(n.id)}),he(H({},e),{toasts:e.toasts.map(n=>n.id===r||r===void 0?he(H({},n),{open:!1}):n)})}case"REMOVE_TOAST":return t.toastId===void 0?he(H({},e),{toasts:[]}):he(H({},e),{toasts:e.toasts.filter(r=>r.id!==t.toastId)})}},Tu=[];let Du={toasts:[]};function ko(e){Du=DF(Du,e),Tu.forEach(t=>{t(Du)})}function AF(t){var e=Ee(t,[]);const r=TF(),n=i=>ko({type:"UPDATE_TOAST",toast:he(H({},i),{id:r})}),a=()=>ko({type:"DISMISS_TOAST",toastId:r});return ko({type:"ADD_TOAST",toast:he(H({},e),{id:r,open:!0,onOpenChange:i=>{i||a()}})}),{id:r,dismiss:a,update:n}}function Cc(){const[e,t]=W.useState(Du);return W.useEffect(()=>(Tu.push(t),()=>{const r=Tu.indexOf(t);r>-1&&Tu.splice(r,1)}),[e]),he(H({},e),{toast:AF,dismiss:r=>ko({type:"DISMISS_TOAST",toastId:r})})}const R1=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,O1=F_,wc=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return O1(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,s=Object.keys(a).map(u=>{const c=r==null?void 0:r[u],m=i==null?void 0:i[u];if(c===null)return null;const h=R1(c)||R1(m);return a[u][h]}),o=r&&Object.entries(r).reduce((u,c)=>{let[m,h]=c;return h===void 0||(u[m]=h),u},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,c)=>{let x=c,{class:m,className:h}=x,f=Ee(x,["class","className"]);return Object.entries(f).every(p=>{let[g,v]=p;return Array.isArray(v)?v.includes(H(H({},i),o)[g]):H(H({},i),o)[g]===v})?[...u,m,h]:u},[]);return O1(e,s,l,r==null?void 0:r.class,r==null?void 0:r.className)};function Fe(...e){return vF(F_(e))}const kF=dk,U_=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(PE,H({ref:r,className:Fe("fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-[999999] flex max-h-screen w-auto flex-col items-center justify-center p-4 pointer-events-none",e),style:{maxWidth:"500px"}},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:14,columnNumber:3},void 0)});U_.displayName=PE.displayName;const FF=wc("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-lg border-2 p-6 pr-8 shadow-xl transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-top-full data-[state=open]:slide-in-from-top-full backdrop-blur-sm",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),R_=W.forwardRef((a,n)=>{var i=a,{className:e,variant:t}=i,r=Ee(i,["className","variant"]);return d.jsxDEV(UE,H({ref:n,className:Fe(FF({variant:t}),e)},r),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:50,columnNumber:5},void 0)});R_.displayName=UE.displayName;const UF=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(IE,H({ref:r,className:Fe("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:63,columnNumber:3},void 0)});UF.displayName=IE.displayName;const O_=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(VE,he(H({ref:r,className:Fe("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":""},t),{children:d.jsxDEV(Ga,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:87,columnNumber:5},void 0)}),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:78,columnNumber:3},void 0)});O_.displayName=VE.displayName;const V_=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(RE,H({ref:r,className:Fe("text-sm font-semibold",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:96,columnNumber:3},void 0)});V_.displayName=RE.displayName;const P_=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(OE,H({ref:r,className:Fe("text-sm opacity-90",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toast.tsx",lineNumber:108,columnNumber:3},void 0)});P_.displayName=OE.displayName;function RF(){const{toasts:e}=Cc();return d.jsxDEV(kF,{children:[e.map(function(s){var o=s,{id:t,title:r,description:n,action:a}=o,i=Ee(o,["id","title","description","action"]);return d.jsxDEV(R_,he(H({},i),{children:[d.jsxDEV("div",{className:"grid gap-1",children:[r&&d.jsxDEV(V_,{children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:20,columnNumber:25},this),n&&d.jsxDEV(P_,{children:n},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:22,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:19,columnNumber:13},this),a,d.jsxDEV(O_,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:26,columnNumber:13},this)]}),t,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:18,columnNumber:11},this)}),d.jsxDEV(U_,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:30,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/toaster.tsx",lineNumber:15,columnNumber:5},this)}const Wo=wc("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-semibold ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 shadow-md hover:shadow-lg active:scale-95 min-h-[48px] touch-manipulation",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 border-3 border-primary/30 hover:border-primary/40 shadow-lg hover:shadow-xl",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 border-3 border-destructive/30 hover:border-destructive/40 shadow-lg hover:shadow-xl",outline:"border-3 border-input bg-background hover:bg-accent hover:text-accent-foreground hover:border-accent/50 shadow-md hover:shadow-lg",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 border-3 border-secondary/30 hover:border-secondary/40 shadow-md hover:shadow-lg",ghost:"hover:bg-accent hover:text-accent-foreground border-3 border-transparent hover:border-accent/20",link:"text-primary underline-offset-4 hover:underline border-3 border-transparent"},size:{default:"h-12 px-6 py-3 font-semibold min-h-[48px]",sm:"h-10 rounded-md px-4 font-medium min-h-[44px]",lg:"h-14 rounded-md px-8 font-semibold text-base min-h-[56px]",icon:"h-12 w-12 min-h-[48px] min-w-[48px]"}},defaultVariants:{variant:"default",size:"default"}}),Ye=W.forwardRef((s,i)=>{var o=s,{className:e,variant:t,size:r,asChild:n=!1}=o,a=Ee(o,["className","variant","size","asChild"]);const l=n?ME:"button";return d.jsxDEV(l,H({className:Fe(Wo({variant:t,size:r,className:e})),ref:i},a),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/button.tsx",lineNumber:47,columnNumber:7},void 0)});Ye.displayName="Button";function OF({notifications:e,onRemove:t}){return e.length?d.jsxDEV("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(r=>d.jsxDEV("div",{className:`
            p-4 rounded-lg shadow-lg max-w-sm cursor-pointer transform transition-all
            ${r.type==="success"?"bg-green-50 border border-green-200 text-green-800":""}
            ${r.type==="error"?"bg-red-50 border border-red-200 text-red-800":""}
            ${r.type==="warning"?"bg-yellow-50 border border-yellow-200 text-yellow-800":""}
            ${r.type==="info"?"bg-blue-50 border border-blue-200 text-blue-800":""}
          `,onClick:()=>t(r.id),children:d.jsxDEV("div",{className:"flex justify-between items-start",children:[d.jsxDEV("div",{className:"flex-1",children:[d.jsxDEV("h4",{className:"font-medium",children:r.title},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:107,columnNumber:15},this),d.jsxDEV("p",{className:"text-sm mt-1",children:r.message},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:108,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:106,columnNumber:13},this),d.jsxDEV("button",{onClick:n=>{n.stopPropagation(),t(r.id)},className:"ml-2 text-gray-400 hover:text-gray-600",children:"Ã—"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:110,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:105,columnNumber:11},this)},r.id,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:94,columnNumber:9},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/custom-notification.tsx",lineNumber:92,columnNumber:5},this):null}const VF=wc("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ct(n){var a=n,{className:e,variant:t}=a,r=Ee(a,["className","variant"]);return d.jsxDEV("div",H({className:Fe(VF({variant:t}),e)},r),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/badge.tsx",lineNumber:34,columnNumber:5},this)}const Le=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV("div",H({ref:r,className:Fe("rounded-lg border-2 bg-card text-card-foreground shadow-md transition-all duration-300","[@media(hover:hover)_and_(pointer:fine)]:hover:-translate-y-1 [@media(hover:hover)_and_(pointer:fine)]:hover:shadow-xl",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:8,columnNumber:3},void 0)});Le.displayName="Card";const Ke=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV("div",H({ref:r,className:Fe("flex flex-col space-y-1.5 p-6 bg-gradient-to-r from-primary/5 to-accent/5 border-b border-border/50",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:24,columnNumber:3},void 0)});Ke.displayName="CardHeader";const Qe=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV("h3",H({ref:r,className:Fe("text-2xl font-bold leading-none tracking-tight text-foreground",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:36,columnNumber:3},void 0)});Qe.displayName="CardTitle";const ft=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV("p",H({ref:r,className:Fe("text-sm text-muted-foreground",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:51,columnNumber:3},void 0)});ft.displayName="CardDescription";const He=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV("div",H({ref:r,className:Fe("p-6 pt-0",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:63,columnNumber:3},void 0)});He.displayName="CardContent";const PF=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV("div",H({ref:r,className:Fe("flex items-center p-6 pt-0",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/card.tsx",lineNumber:71,columnNumber:3},void 0)});PF.displayName="CardFooter";function IF({className:e}){const[t,r]=W.useState(navigator.onLine),[n,a]=W.useState([]),[i,s]=W.useState(!1);W.useEffect(()=>{const m=()=>r(!0),h=()=>r(!1);return window.addEventListener("online",m),window.addEventListener("offline",h),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",f=>{f.data.type==="FORM_SYNC_SUCCESS"&&a(x=>x.filter(p=>p.id!==f.data.formId))}),o(),()=>{window.removeEventListener("online",m),window.removeEventListener("offline",h)}},[]);const o=()=>bt(null,null,function*(){if("serviceWorker"in navigator&&navigator.serviceWorker.controller){const m=new MessageChannel;m.port1.onmessage=h=>{if(h.data.type==="OFFLINE_FORMS_RESPONSE"){const f=Object.values(h.data.forms);a(f)}},navigator.serviceWorker.controller.postMessage({type:"GET_OFFLINE_FORMS"},[m.port2])}}),l=()=>t?n.length>0?d.jsxDEV(xx,{className:"w-4 h-4 text-yellow-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:72,columnNumber:9},this):d.jsxDEV(Fn,{className:"w-4 h-4 text-green-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:74,columnNumber:9},this):d.jsxDEV(jE,{className:"w-4 h-4 text-red-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:77,columnNumber:12},this),u=()=>t?n.length>0?`${n.length} form${n.length>1?"s":""} pending sync`:"Online":"Offline",c=()=>t?n.length>0?"secondary":"default":"destructive";return t&&n.length===0?null:d.jsxDEV("div",{className:e,children:d.jsxDEV(Le,{className:"border-l-4 border-l-blue-500",children:d.jsxDEV(He,{className:"p-3",children:[d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("div",{className:"flex items-center space-x-2",children:[l(),d.jsxDEV("span",{className:"text-sm font-medium",children:u()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:107,columnNumber:15},this),n.length>0&&d.jsxDEV(Ct,{variant:c(),className:"text-xs",children:n.length},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:109,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:105,columnNumber:13},this),n.length>0&&d.jsxDEV(Ye,{variant:"ghost",size:"sm",onClick:()=>s(!i),className:"text-xs",children:i?"Hide":"Details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:116,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:104,columnNumber:11},this),i&&n.length>0&&d.jsxDEV("div",{className:"mt-3 space-y-2",children:[d.jsxDEV("div",{className:"text-xs text-muted-foreground",children:"Forms saved offline will be submitted when connection is restored:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:129,columnNumber:15},this),n.map(m=>d.jsxDEV("div",{className:"flex items-center justify-between p-2 bg-muted rounded text-xs",children:[d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(Fr,{className:"w-3 h-3 text-yellow-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:135,columnNumber:21},this),d.jsxDEV("span",{children:[m.data.school," - ",new Date(m.timestamp).toLocaleTimeString()]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:136,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:134,columnNumber:19},this),d.jsxDEV(Ct,{variant:"outline",className:"text-xs",children:m.retryCount>0?`Retry ${m.retryCount}`:"Pending"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:140,columnNumber:19},this)]},m.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:133,columnNumber:17},this))]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:128,columnNumber:13},this),!t&&d.jsxDEV("div",{className:"mt-2 text-xs text-muted-foreground",children:"Your forms are being saved locally and will sync when you're back online."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:149,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:103,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:102,columnNumber:7},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/offline-status.tsx",lineNumber:101,columnNumber:5},this)}function MF({notifications:e,onRemove:t,maxNotifications:r=5}){const[n,a]=W.useState([]);W.useEffect(()=>{const l=[...e].sort((u,c)=>c.timestamp.getTime()-u.timestamp.getTime()).slice(0,r);a(l),l.forEach(u=>{if(!u.persistent&&u.duration!==0){const c=u.duration||5e3;setTimeout(()=>{t(u.id)},c)}})},[e,t,r]);const i=l=>{switch(l){case"success":return d.jsxDEV(Fn,{className:"w-5 h-5 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:58,columnNumber:16},this);case"error":return d.jsxDEV(Fr,{className:"w-5 h-5 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:60,columnNumber:16},this);case"warning":return d.jsxDEV(Fr,{className:"w-5 h-5 text-yellow-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:62,columnNumber:16},this);case"info":return d.jsxDEV(y1,{className:"w-5 h-5 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:64,columnNumber:16},this);case"offline":return d.jsxDEV(jE,{className:"w-5 h-5 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:66,columnNumber:16},this);case"sync":return d.jsxDEV(LE,{className:"w-5 h-5 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:68,columnNumber:16},this);default:return d.jsxDEV(y1,{className:"w-5 h-5 text-gray-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:70,columnNumber:16},this)}},s=l=>{switch(l){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-yellow-50 border-yellow-200";case"info":return"bg-blue-50 border-blue-200";case"offline":return"bg-orange-50 border-orange-200";case"sync":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}},o=l=>{switch(l){case"success":return"text-green-900";case"error":return"text-red-900";case"warning":return"text-yellow-900";case"info":return"text-blue-900";case"offline":return"text-orange-900";case"sync":return"text-blue-900";default:return"text-gray-900"}};return n.length===0?null:d.jsxDEV("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm w-full",children:n.map(l=>d.jsxDEV("div",{className:`relative p-4 rounded-lg border shadow-lg transition-all duration-300 transform animate-in slide-in-from-right-full ${s(l.type)}`,children:d.jsxDEV("div",{className:"flex items-start space-x-3",children:[d.jsxDEV("div",{className:"flex-shrink-0",children:i(l.type)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:124,columnNumber:13},this),d.jsxDEV("div",{className:"flex-1 min-w-0",children:[d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("h4",{className:`text-sm font-semibold ${o(l.type)}`,children:l.title},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:130,columnNumber:17},this),d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV("span",{className:"text-xs text-muted-foreground",children:l.timestamp.toLocaleTimeString()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:134,columnNumber:19},this),d.jsxDEV(Ye,{variant:"ghost",size:"sm",onClick:()=>t(l.id),className:"h-6 w-6 p-0 hover:bg-black/10",children:d.jsxDEV(Ga,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:143,columnNumber:21},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:137,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:133,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:129,columnNumber:15},this),d.jsxDEV("p",{className:`text-sm mt-1 ${o(l.type)} opacity-90`,children:l.message},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:148,columnNumber:15},this),l.actions&&l.actions.length>0&&d.jsxDEV("div",{className:"flex space-x-2 mt-3",children:l.actions.map((u,c)=>d.jsxDEV(Ye,{variant:u.variant||"outline",size:"sm",onClick:u.action,className:"text-xs h-7",children:u.label},c,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:155,columnNumber:21},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:153,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:128,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:123,columnNumber:11},this)},l.id,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:119,columnNumber:9},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/enhanced-notifications.tsx",lineNumber:117,columnNumber:5},this)}function jF(){const[e,t]=W.useState([]),r=m=>{const h=he(H({},m),{id:`notification_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date});return t(f=>[...f,h]),h.id};return{notifications:e,addNotification:r,removeNotification:m=>{t(h=>h.filter(f=>f.id!==m))},clearAllNotifications:()=>{t([])},showSuccess:(m,h,f)=>r(H({type:"success",title:m,message:h},f)),showError:(m,h,f)=>r(H({type:"error",title:m,message:h,persistent:!0},f)),showWarning:(m,h,f)=>r(H({type:"warning",title:m,message:h},f)),showInfo:(m,h,f)=>r(H({type:"info",title:m,message:h},f)),showOffline:(m,h,f)=>r(H({type:"offline",title:m,message:h,persistent:!0},f)),showSync:(m,h,f)=>r(H({type:"sync",title:m,message:h},f))}}var Ec=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},_c=typeof window=="undefined"||"Deno"in globalThis;function En(){}function LF(e,t){return typeof e=="function"?e(t):e}function BF(e){return typeof e=="number"&&e>=0&&e!==1/0}function qF(e,t){return Math.max(e+(t||0)-Date.now(),0)}function up(e,t){return typeof e=="function"?e(t):e}function zF(e,t){return typeof e=="function"?e(t):e}function V1(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:i,queryKey:s,stale:o}=e;if(s){if(n){if(t.queryHash!==wx(s,t.options))return!1}else if(!Yo(t.queryKey,s))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||a&&a!==t.state.fetchStatus||i&&!i(t))}function P1(e,t){const{exact:r,status:n,predicate:a,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Go(t.options.mutationKey)!==Go(i))return!1}else if(!Yo(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function wx(e,t){return((t==null?void 0:t.queryKeyHashFn)||Go)(e)}function Go(e){return JSON.stringify(e,(t,r)=>mp(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function Yo(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Yo(e[r],t[r])):!1}function cp(e,t){if(e===t)return e;const r=I1(e)&&I1(t);if(r||mp(e)&&mp(t)){const n=r?e:Object.keys(e),a=n.length,i=r?t:Object.keys(t),s=i.length,o=r?[]:{},l=new Set(n);let u=0;for(let c=0;c<s;c++){const m=r?c:i[c];(!r&&l.has(m)||r)&&e[m]===void 0&&t[m]===void 0?(o[m]=void 0,u++):(o[m]=cp(e[m],t[m]),o[m]===e[m]&&e[m]!==void 0&&u++)}return a===s&&u===a?e:o}return t}function I1(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function mp(e){if(!M1(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!M1(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function M1(e){return Object.prototype.toString.call(e)==="[object Object]"}function HF(e){return new Promise(t=>{setTimeout(t,e)})}function $F(e,t,r){if(typeof r.structuralSharing=="function")return r.structuralSharing(e,t);if(r.structuralSharing!==!1){try{return cp(e,t)}catch(n){throw console.error(`Structural sharing requires data to be JSON serializable. To fix this, turn off structuralSharing or return JSON-serializable data from your queryFn. [${r.queryHash}]: ${n}`),n}return cp(e,t)}return t}function WF(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function GF(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var Pu=Symbol();function I_(e,t){return e.queryFn===Pu&&console.error(`Attempted to invoke queryFn when set to skipToken. This is likely a configuration error. Query hash: '${e.queryHash}'`),!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Pu?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Si,Ma,Fs,EE,YF=(EE=class extends Ec{constructor(){super();it(this,Si);it(this,Ma);it(this,Fs);We(this,Fs,t=>{if(!_c&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){me(this,Ma)||this.setEventListener(me(this,Fs))}onUnsubscribe(){var t;this.hasListeners()||((t=me(this,Ma))==null||t.call(this),We(this,Ma,void 0))}setEventListener(t){var r;We(this,Fs,t),(r=me(this,Ma))==null||r.call(this),We(this,Ma,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){me(this,Si)!==t&&(We(this,Si,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof me(this,Si)=="boolean"?me(this,Si):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Si=new WeakMap,Ma=new WeakMap,Fs=new WeakMap,EE),M_=new YF,Us,ja,Rs,_E,XF=(_E=class extends Ec{constructor(){super();it(this,Us,!0);it(this,ja);it(this,Rs);We(this,Rs,t=>{if(!_c&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){me(this,ja)||this.setEventListener(me(this,Rs))}onUnsubscribe(){var t;this.hasListeners()||((t=me(this,ja))==null||t.call(this),We(this,ja,void 0))}setEventListener(t){var r;We(this,Rs,t),(r=me(this,ja))==null||r.call(this),We(this,ja,t(this.setOnline.bind(this)))}setOnline(t){me(this,Us)!==t&&(We(this,Us,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return me(this,Us)}},Us=new WeakMap,ja=new WeakMap,Rs=new WeakMap,_E),Iu=new XF;function KF(){let e,t;const r=new Promise((a,i)=>{e=a,t=i});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}function QF(e){return Math.min(1e3*Wl(2,e),3e4)}function j_(e){return(e!=null?e:"online")==="online"?Iu.isOnline():!0}var L_=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function B_(e){let t=!1,r=0,n;const a=KF(),i=()=>a.status!=="pending",s=p=>{var g;i()||(h(new L_(p)),(g=e.abort)==null||g.call(e))},o=()=>{t=!0},l=()=>{t=!1},u=()=>M_.isFocused()&&(e.networkMode==="always"||Iu.isOnline())&&e.canRun(),c=()=>j_(e.networkMode)&&e.canRun(),m=p=>{i()||(n==null||n(),a.resolve(p))},h=p=>{i()||(n==null||n(),a.reject(p))},f=()=>new Promise(p=>{var g;n=v=>{(i()||u())&&p(v)},(g=e.onPause)==null||g.call(e)}).then(()=>{var p;n=void 0,i()||(p=e.onContinue)==null||p.call(e)}),x=()=>{if(i())return;let p;const g=r===0?e.initialPromise:void 0;try{p=g!=null?g:e.fn()}catch(v){p=Promise.reject(v)}Promise.resolve(p).then(m).catch(v=>{var E,w,S;if(i())return;const C=(E=e.retry)!=null?E:_c?0:3,b=(w=e.retryDelay)!=null?w:QF,N=typeof b=="function"?b(r,v):b,F=C===!0||typeof C=="number"&&r<C||typeof C=="function"&&C(r,v);if(t||!F){h(v);return}r++,(S=e.onFail)==null||S.call(e,r,v),HF(N).then(()=>u()?void 0:f()).then(()=>{t?h(v):x()})})};return{promise:a,status:()=>a.status,cancel:s,continue:()=>(n==null||n(),a),cancelRetry:o,continueRetry:l,canStart:c,start:()=>(c()?x():f().then(x),a)}}var ZF=e=>setTimeout(e,0);function JF(){let e=[],t=0,r=o=>{o()},n=o=>{o()},a=ZF;const i=o=>{t?e.push(o):a(()=>{r(o)})},s=()=>{const o=e;e=[],o.length&&a(()=>{n(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||s()}return l},batchCalls:o=>(...l)=>{i(()=>{o(...l)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var Ar=JF(),Ti,SE,q_=(SE=class{constructor(){it(this,Ti)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),BF(this.gcTime)&&We(this,Ti,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e!=null?e:_c?1/0:300*1e3)}clearGcTimeout(){me(this,Ti)&&(clearTimeout(me(this,Ti)),We(this,Ti,void 0))}},Ti=new WeakMap,SE),Os,Vs,ln,Di,ar,gl,Ai,_n,ua,TE,e5=(TE=class extends q_{constructor(t){var r;super();it(this,_n);it(this,Os);it(this,Vs);it(this,ln);it(this,Di);it(this,ar);it(this,gl);it(this,Ai);We(this,Ai,!1),We(this,gl,t.defaultOptions),this.setOptions(t.options),this.observers=[],We(this,Di,t.client),We(this,ln,me(this,Di).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,We(this,Os,r5(this.options)),this.state=(r=t.state)!=null?r:me(this,Os),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=me(this,ar))==null?void 0:t.promise}setOptions(t){this.options=H(H({},me(this,gl)),t),this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&me(this,ln).remove(this)}setData(t,r){const n=$F(this.state.data,t,this.options);return Nr(this,_n,ua).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Nr(this,_n,ua).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=me(this,ar))==null?void 0:n.promise;return(a=me(this,ar))==null||a.cancel(t),r?r.then(En).catch(En):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(me(this,Os))}isActive(){return this.observers.some(t=>zF(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Pu||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>up(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!qF(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=me(this,ar))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=me(this,ar))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),me(this,ln).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(me(this,ar)&&(me(this,Ai)?me(this,ar).cancel({revert:!0}):me(this,ar).cancelRetry()),this.scheduleGc()),me(this,ln).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Nr(this,_n,ua).call(this,{type:"invalidate"})}fetch(t,r){return bt(this,null,function*(){var l,u,c,m,h,f,x,p,g,v,C,b;if(this.state.fetchStatus!=="idle"&&((l=me(this,ar))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(me(this,ar))return me(this,ar).continueRetry(),me(this,ar).promise}if(t&&this.setOptions(t),!this.options.queryFn){const N=this.observers.find(F=>F.options.queryFn);N&&this.setOptions(N.options)}Array.isArray(this.options.queryKey)||console.error("As of v4, queryKey needs to be an Array. If you are using a string like 'repoData', please change it to an Array, e.g. ['repoData']");const n=new AbortController,a=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(We(this,Ai,!0),n.signal)})},i=()=>{const N=I_(this.options,r),E=(()=>{const w={client:me(this,Di),queryKey:this.queryKey,meta:this.meta};return a(w),w})();return We(this,Ai,!1),this.options.persister?this.options.persister(N,E,this):N(E)},o=(()=>{const N={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:me(this,Di),state:this.state,fetchFn:i};return a(N),N})();(u=this.options.behavior)==null||u.onFetch(o,this),We(this,Vs,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=o.fetchOptions)==null?void 0:c.meta))&&Nr(this,_n,ua).call(this,{type:"fetch",meta:(m=o.fetchOptions)==null?void 0:m.meta}),We(this,ar,B_({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,abort:n.abort.bind(n),onFail:(N,F)=>{Nr(this,_n,ua).call(this,{type:"failed",failureCount:N,error:F})},onPause:()=>{Nr(this,_n,ua).call(this,{type:"pause"})},onContinue:()=>{Nr(this,_n,ua).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const N=yield me(this,ar).start();if(N===void 0)throw console.error(`Query data cannot be undefined. Please make sure to return a value other than undefined from your query function. Affected query key: ${this.queryHash}`),new Error(`${this.queryHash} data is undefined`);return this.setData(N),(f=(h=me(this,ln).config).onSuccess)==null||f.call(h,N,this),(p=(x=me(this,ln).config).onSettled)==null||p.call(x,N,this.state.error,this),N}catch(N){if(N instanceof L_){if(N.silent)return me(this,ar).promise;if(N.revert){if(this.setState(he(H({},me(this,Vs)),{fetchStatus:"idle"})),this.state.data===void 0)throw N;return this.state.data}}throw Nr(this,_n,ua).call(this,{type:"error",error:N}),(v=(g=me(this,ln).config).onError)==null||v.call(g,N,this),(b=(C=me(this,ln).config).onSettled)==null||b.call(C,this.state.data,N,this),N}finally{this.scheduleGc()}})}},Os=new WeakMap,Vs=new WeakMap,ln=new WeakMap,Di=new WeakMap,ar=new WeakMap,gl=new WeakMap,Ai=new WeakMap,_n=new WeakSet,ua=function(t){const r=n=>{var a,i;switch(t.type){case"failed":return he(H({},n),{fetchFailureCount:t.failureCount,fetchFailureReason:t.error});case"pause":return he(H({},n),{fetchStatus:"paused"});case"continue":return he(H({},n),{fetchStatus:"fetching"});case"fetch":return he(H(H({},n),t5(n.data,this.options)),{fetchMeta:(a=t.meta)!=null?a:null});case"success":const s=H(he(H({},n),{data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:(i=t.dataUpdatedAt)!=null?i:Date.now(),error:null,isInvalidated:!1,status:"success"}),!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null});return We(this,Vs,t.manual?s:void 0),s;case"error":const o=t.error;return he(H({},n),{error:o,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"});case"invalidate":return he(H({},n),{isInvalidated:!0});case"setState":return H(H({},n),t.state)}};this.state=r(this.state),Ar.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),me(this,ln).notify({query:this,type:"updated",action:t})})},TE);function t5(e,t){return H({fetchFailureCount:0,fetchFailureReason:null,fetchStatus:j_(t.networkMode)?"fetching":"paused"},e===void 0&&{error:null,status:"pending"})}function r5(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n!=null?n:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var qn,DE,n5=(DE=class extends Ec{constructor(t={}){super();it(this,qn);this.config=t,We(this,qn,new Map)}build(t,r,n){var o;const a=r.queryKey,i=(o=r.queryHash)!=null?o:wx(a,r);let s=this.get(i);return s||(s=new e5({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(s)),s}add(t){me(this,qn).has(t.queryHash)||(me(this,qn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=me(this,qn).get(t.queryHash);r&&(t.destroy(),r===t&&me(this,qn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ar.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return me(this,qn).get(t)}getAll(){return[...me(this,qn).values()]}find(t){const r=H({exact:!0},t);return this.getAll().find(n=>V1(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>V1(t,n)):r}notify(t){Ar.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Ar.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ar.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},qn=new WeakMap,DE),zn,Sr,ki,Hn,Va,AE,a5=(AE=class extends q_{constructor(t){super();it(this,Hn);it(this,zn);it(this,Sr);it(this,ki);this.mutationId=t.mutationId,We(this,Sr,t.mutationCache),We(this,zn,[]),this.state=t.state||i5(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){me(this,zn).includes(t)||(me(this,zn).push(t),this.clearGcTimeout(),me(this,Sr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){We(this,zn,me(this,zn).filter(r=>r!==t)),this.scheduleGc(),me(this,Sr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){me(this,zn).length||(this.state.status==="pending"?this.scheduleGc():me(this,Sr).remove(this))}continue(){var t,r;return(r=(t=me(this,ki))==null?void 0:t.continue())!=null?r:this.execute(this.state.variables)}execute(t){return bt(this,null,function*(){var i,s,o,l,u,c,m,h,f,x,p,g,v,C,b,N,F,E,w,S,_;const r=()=>{Nr(this,Hn,Va).call(this,{type:"continue"})};We(this,ki,B_({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(U,R)=>{Nr(this,Hn,Va).call(this,{type:"failed",failureCount:U,error:R})},onPause:()=>{Nr(this,Hn,Va).call(this,{type:"pause"})},onContinue:r,retry:(i=this.options.retry)!=null?i:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>me(this,Sr).canRun(this)}));const n=this.state.status==="pending",a=!me(this,ki).canStart();try{if(n)r();else{Nr(this,Hn,Va).call(this,{type:"pending",variables:t,isPaused:a}),yield(o=(s=me(this,Sr).config).onMutate)==null?void 0:o.call(s,t,this);const R=yield(u=(l=this.options).onMutate)==null?void 0:u.call(l,t);R!==this.state.context&&Nr(this,Hn,Va).call(this,{type:"pending",context:R,variables:t,isPaused:a})}const U=yield me(this,ki).start();return yield(m=(c=me(this,Sr).config).onSuccess)==null?void 0:m.call(c,U,t,this.state.context,this),yield(f=(h=this.options).onSuccess)==null?void 0:f.call(h,U,t,this.state.context),yield(p=(x=me(this,Sr).config).onSettled)==null?void 0:p.call(x,U,null,this.state.variables,this.state.context,this),yield(v=(g=this.options).onSettled)==null?void 0:v.call(g,U,null,t,this.state.context),Nr(this,Hn,Va).call(this,{type:"success",data:U}),U}catch(U){try{throw yield(b=(C=me(this,Sr).config).onError)==null?void 0:b.call(C,U,t,this.state.context,this),yield(F=(N=this.options).onError)==null?void 0:F.call(N,U,t,this.state.context),yield(w=(E=me(this,Sr).config).onSettled)==null?void 0:w.call(E,void 0,U,this.state.variables,this.state.context,this),yield(_=(S=this.options).onSettled)==null?void 0:_.call(S,void 0,U,t,this.state.context),U}finally{Nr(this,Hn,Va).call(this,{type:"error",error:U})}}finally{me(this,Sr).runNext(this)}})}},zn=new WeakMap,Sr=new WeakMap,ki=new WeakMap,Hn=new WeakSet,Va=function(t){const r=n=>{switch(t.type){case"failed":return he(H({},n),{failureCount:t.failureCount,failureReason:t.error});case"pause":return he(H({},n),{isPaused:!0});case"continue":return he(H({},n),{isPaused:!1});case"pending":return he(H({},n),{context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()});case"success":return he(H({},n),{data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1});case"error":return he(H({},n),{data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"})}};this.state=r(this.state),Ar.batch(()=>{me(this,zn).forEach(n=>{n.onMutationUpdate(t)}),me(this,Sr).notify({mutation:this,type:"updated",action:t})})},AE);function i5(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ma,Sn,vl,kE,s5=(kE=class extends Ec{constructor(t={}){super();it(this,ma);it(this,Sn);it(this,vl);this.config=t,We(this,ma,new Set),We(this,Sn,new Map),We(this,vl,0)}build(t,r,n){const a=new a5({mutationCache:this,mutationId:++Gl(this,vl)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){me(this,ma).add(t);const r=Yl(t);if(typeof r=="string"){const n=me(this,Sn).get(r);n?n.push(t):me(this,Sn).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(me(this,ma).delete(t)){const r=Yl(t);if(typeof r=="string"){const n=me(this,Sn).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&me(this,Sn).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Yl(t);if(typeof r=="string"){const n=me(this,Sn).get(r),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n,a;const r=Yl(t);if(typeof r=="string"){const i=(n=me(this,Sn).get(r))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(a=i==null?void 0:i.continue())!=null?a:Promise.resolve()}else return Promise.resolve()}clear(){Ar.batch(()=>{me(this,ma).forEach(t=>{this.notify({type:"removed",mutation:t})}),me(this,ma).clear(),me(this,Sn).clear()})}getAll(){return Array.from(me(this,ma))}find(t){const r=H({exact:!0},t);return this.getAll().find(n=>P1(r,n))}findAll(t={}){return this.getAll().filter(r=>P1(t,r))}notify(t){Ar.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Ar.batch(()=>Promise.all(t.map(r=>r.continue().catch(En))))}},ma=new WeakMap,Sn=new WeakMap,vl=new WeakMap,kE);function Yl(e){var t;return(t=e.options.scope)==null?void 0:t.id}function j1(e){return{onFetch:(t,r)=>{var c,m,h,f,x;const n=t.options,a=(h=(m=(c=t.fetchOptions)==null?void 0:c.meta)==null?void 0:m.fetchMore)==null?void 0:h.direction,i=((f=t.state.data)==null?void 0:f.pages)||[],s=((x=t.state.data)==null?void 0:x.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const u=()=>bt(null,null,function*(){var b;let p=!1;const g=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(t.signal.aborted?p=!0:t.signal.addEventListener("abort",()=>{p=!0}),t.signal)})},v=I_(t.options,t.fetchOptions),C=(N,F,E)=>bt(null,null,function*(){if(p)return Promise.reject();if(F==null&&N.pages.length)return Promise.resolve(N);const S=(()=>{const q={client:t.client,queryKey:t.queryKey,pageParam:F,direction:E?"backward":"forward",meta:t.options.meta};return g(q),q})(),_=yield v(S),{maxPages:U}=t.options,R=E?GF:WF;return{pages:R(N.pages,_,U),pageParams:R(N.pageParams,F,U)}});if(a&&i.length){const N=a==="backward",F=N?o5:L1,E={pages:i,pageParams:s},w=F(n,E);o=yield C(E,w,N)}else{const N=e!=null?e:i.length;do{const F=l===0?(b=s[0])!=null?b:n.initialPageParam:L1(n,o);if(l>0&&F==null)break;o=yield C(o,F),l++}while(l<N)}return o});t.options.persister?t.fetchFn=()=>{var p,g;return(g=(p=t.options).persister)==null?void 0:g.call(p,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function L1(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function o5(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var jt,La,Ba,Ps,Is,qa,Ms,js,FE,l5=(FE=class{constructor(e={}){it(this,jt);it(this,La);it(this,Ba);it(this,Ps);it(this,Is);it(this,qa);it(this,Ms);it(this,js);We(this,jt,e.queryCache||new n5),We(this,La,e.mutationCache||new s5),We(this,Ba,e.defaultOptions||{}),We(this,Ps,new Map),We(this,Is,new Map),We(this,qa,0)}mount(){Gl(this,qa)._++,me(this,qa)===1&&(We(this,Ms,M_.subscribe(e=>bt(this,null,function*(){e&&(yield this.resumePausedMutations(),me(this,jt).onFocus())}))),We(this,js,Iu.subscribe(e=>bt(this,null,function*(){e&&(yield this.resumePausedMutations(),me(this,jt).onOnline())}))))}unmount(){var e,t;Gl(this,qa)._--,me(this,qa)===0&&((e=me(this,Ms))==null||e.call(this),We(this,Ms,void 0),(t=me(this,js))==null||t.call(this),We(this,js,void 0))}isFetching(e){return me(this,jt).findAll(he(H({},e),{fetchStatus:"fetching"})).length}isMutating(e){return me(this,La).findAll(he(H({},e),{status:"pending"})).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=me(this,jt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=me(this,jt).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(up(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return me(this,jt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=me(this,jt).get(n.queryHash),i=a==null?void 0:a.state.data,s=LF(t,i);if(s!==void 0)return me(this,jt).build(this,n).setData(s,he(H({},r),{manual:!0}))}setQueriesData(e,t,r){return Ar.batch(()=>me(this,jt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=me(this,jt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=me(this,jt);Ar.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=me(this,jt);return Ar.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries(H({type:"active"},e),t)))}cancelQueries(e,t={}){const r=H({revert:!0},t),n=Ar.batch(()=>me(this,jt).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(En).catch(En)}invalidateQueries(e,t={}){return Ar.batch(()=>{var r,n;return me(this,jt).findAll(e).forEach(a=>{a.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries(he(H({},e),{type:(n=(r=e==null?void 0:e.refetchType)!=null?r:e==null?void 0:e.type)!=null?n:"active"}),t)})}refetchQueries(e,t={}){var a;const r=he(H({},t),{cancelRefetch:(a=t.cancelRefetch)!=null?a:!0}),n=Ar.batch(()=>me(this,jt).findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,r);return r.throwOnError||(s=s.catch(En)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(En)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=me(this,jt).build(this,t);return r.isStaleByTime(up(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(En).catch(En)}fetchInfiniteQuery(e){return e.behavior=j1(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(En).catch(En)}ensureInfiniteQueryData(e){return e.behavior=j1(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Iu.isOnline()?me(this,La).resumePausedMutations():Promise.resolve()}getQueryCache(){return me(this,jt)}getMutationCache(){return me(this,La)}getDefaultOptions(){return me(this,Ba)}setDefaultOptions(e){We(this,Ba,e)}setQueryDefaults(e,t){me(this,Ps).set(Go(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...me(this,Ps).values()],r={};return t.forEach(n=>{Yo(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){me(this,Is).set(Go(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...me(this,Is).values()],r={};return t.forEach(n=>{Yo(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t=he(H(H(H({},me(this,Ba).queries),this.getQueryDefaults(e.queryKey)),e),{_defaulted:!0});return t.queryHash||(t.queryHash=wx(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Pu&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:he(H(H(H({},me(this,Ba).mutations),(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey)),e),{_defaulted:!0})}clear(){me(this,jt).clear(),me(this,La).clear()}},jt=new WeakMap,La=new WeakMap,Ba=new WeakMap,Ps=new WeakMap,Is=new WeakMap,qa=new WeakMap,Ms=new WeakMap,js=new WeakMap,FE);function u5(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var r,n,a,i,s=[],o="",l=e.split("/");for(l[0]||l.shift();a=l.shift();)r=a[0],r==="*"?(s.push(r),o+=a[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(n=a.indexOf("?",1),i=a.indexOf(".",1),s.push(a.substring(1,~n?n:~i?i:a.length)),o+=~n&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(o+=(~n?"?":"")+"\\"+a.substring(i))):o+="/"+a;return{keys:s,pattern:new RegExp("^"+o+(t?"(?=$|/)":"/?$"),"i")}}var xm={exports:{}},gm={},B1;function c5(){if(B1)return gm;B1=1;/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return(function(){function e(f,x){return f===x&&(f!==0||1/f===1/x)||f!==f&&x!==x}function t(f,x){c||a.startTransition===void 0||(c=!0,console.error("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var p=x();if(!m){var g=x();i(p,g)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),m=!0)}g=s({inst:{value:p,getSnapshot:x}});var v=g[0].inst,C=g[1];return l(function(){v.value=p,v.getSnapshot=x,r(v)&&C({inst:v})},[f,p,x]),o(function(){return r(v)&&C({inst:v}),f(function(){r(v)&&C({inst:v})})},[f]),u(p),p}function r(f){var x=f.getSnapshot;f=f.value;try{var p=x();return!i(f,p)}catch(g){return!0}}function n(f,x){return x()}typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var a=fk(),i=typeof Object.is=="function"?Object.is:e,s=a.useState,o=a.useEffect,l=a.useLayoutEffect,u=a.useDebugValue,c=!1,m=!1,h=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?n:t;gm.useSyncExternalStore=a.useSyncExternalStore!==void 0?a.useSyncExternalStore:h,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())})(),gm}var q1;function m5(){return q1||(q1=1,xm.exports=c5()),xm.exports}var d5=m5();const f5="popstate",Ex="pushState",_x="replaceState",h5="hashchange",z1=[f5,Ex,_x,h5],p5=e=>{for(const t of z1)addEventListener(t,e);return()=>{for(const t of z1)removeEventListener(t,e)}},z_=(e,t)=>d5.useSyncExternalStore(p5,e,t),x5=()=>location.search,g5=({ssrSearch:e=""}={})=>z_(x5,()=>e),H1=()=>location.pathname,v5=({ssrPath:e}={})=>z_(H1,e?()=>e:H1),b5=(e,{replace:t=!1,state:r=null}={})=>history[t?_x:Ex](r,"",e),N5=(e={})=>[v5(e),b5],$1=Symbol.for("wouter_v3");if(typeof history!="undefined"&&typeof window[$1]=="undefined"){for(const e of[Ex,_x]){const t=history[e];history[e]=function(){const r=t.apply(this,arguments),n=new Event(e);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,$1,{value:!0})}const y5=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",H_=(e="")=>e==="/"?"":e,C5=(e,t)=>e[0]==="~"?e.slice(1):H_(t)+e,w5=(e="",t)=>y5(W1(H_(e)),W1(t)),W1=e=>{try{return decodeURI(e)}catch(t){return e}},$_={hook:N5,searchHook:g5,parser:u5,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},W_=W.createContext($_),Sx=()=>W.useContext(W_),E5={};W.createContext(E5);const G_=e=>{const[t,r]=e.hook(e);return[w5(e.base,t),BE((n,a)=>r(C5(n,e.base),a))]},_5=()=>G_(Sx()),S5=r=>{var n=r,{children:e}=n,t=Ee(n,["children"]);var h,f,x,p;const a=Sx(),i=t.hook?$_:a;let s=i;const[o,l]=(f=(h=t.ssrPath)==null?void 0:h.split("?"))!=null?f:[];l&&(t.ssrSearch=l,t.ssrPath=o),t.hrefs=(p=t.hrefs)!=null?p:(x=t.hook)==null?void 0:x.hrefs;let u=W.useRef({}),c=u.current,m=c;for(let g in i){const v=g==="base"?i[g]+(t[g]||""):t[g]||i[g];c===m&&v!==m[g]&&(u.current=m=H({},m)),m[g]=v,(v!==i[g]||v!==s[g])&&(s=m)}return W.createElement(W_.Provider,{value:s,children:e})};W.forwardRef((e,t)=>{const r=Sx(),[n,a]=G_(r),g=e,{to:i="",href:s=i,onClick:o,asChild:l,children:u,className:c,replace:m,state:h}=g,f=Ee(g,["to","href","onClick","asChild","children","className","replace","state"]),x=BE(v=>{v.ctrlKey||v.metaKey||v.altKey||v.shiftKey||v.button!==0||(o==null||o(v),v.defaultPrevented||(v.preventDefault(),a(s,e)))}),p=r.hrefs(s[0]==="~"?s.slice(1):r.base+s,r);return l&&W.isValidElement(u)?W.cloneElement(u,{onClick:x,href:p}):W.createElement("a",he(H({},f),{onClick:x,href:p,className:c!=null&&c.call?c(n===s):c,children:u,ref:t}))});function T5(){if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw new Error("XMLHttpRequest not supported")}}function D5(e,t={}){return new Promise(function(r,n){var a=T5(),i=t.method||"GET";if(a.open(i,e,!0),a.withCredentials=t.credentials==="include",t.headers)for(var s in t.headers)t.headers.hasOwnProperty(s)&&a.setRequestHeader(s,t.headers[s]);a.onreadystatechange=function(){if(a.readyState===4){var o={ok:a.status>=200&&a.status<300,status:a.status,statusText:a.statusText,text:function(){return Promise.resolve(a.responseText)},json:function(){try{return Promise.resolve(JSON.parse(a.responseText))}catch(l){return Promise.reject(l)}}};o.ok?r(o):n(new Error(a.status+": "+a.statusText))}},a.onerror=function(){n(new Error("Network error"))},a.send(t.body||null)})}var A5=typeof fetch!="undefined"?fetch:D5;function k5(e){return new Promise(function(t,r){e.ok?t(e):e.text().then(function(n){r(new Error(e.status+": "+(n||e.statusText)))})})}const F5=({on401:e})=>function({queryKey:t}){return new Promise(function(r,n){A5(t.join("/"),{credentials:"include"}).then(function(a){return k5(a).then(function(){return a.json()})}).then(r).catch(n)})},U5=new l5({defaultOptions:{queries:{queryFn:F5({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),R5=({className:e})=>{const[t]=_5(),r=[{id:"home",label:"Home",icon:hk,href:"/",active:t==="/"},{id:"inspection",label:"Inspect",icon:pk,href:"/custodial-inspection",active:t==="/custodial-inspection"},{id:"building",label:"Building",icon:dn,href:"/whole-building-inspection",active:t==="/whole-building-inspection"},{id:"data",label:"Data",icon:gx,href:"/inspection-data",active:t==="/inspection-data"},{id:"admin",label:"Admin",icon:za,href:"/admin-inspections",active:t==="/admin-inspections"}];return d.jsxDEV("div",{className:Fe("fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50 md:hidden",e),children:[d.jsxDEV("div",{className:"grid grid-cols-5 py-2",children:r.map(n=>{const a=n.icon;return d.jsxDEV("a",{href:n.href,className:Fe("flex flex-col items-center justify-center py-2 px-1 text-xs transition-colors duration-200 touch-manipulation",n.active?"text-blue-600":"text-gray-600 hover:text-gray-900 active:scale-95"),children:[d.jsxDEV("div",{className:"relative",children:[d.jsxDEV(a,{className:Fe("h-6 w-6 transition-transform duration-200",n.active&&"scale-110")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:71,columnNumber:17},void 0),n.active&&d.jsxDEV("div",{className:"absolute -top-1 -right-1 h-2 w-2 bg-blue-600 rounded-full animate-pulse"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:78,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:70,columnNumber:15},void 0),d.jsxDEV("span",{className:Fe("mt-1 font-medium text-[10px] leading-tight",n.active&&"font-semibold"),children:n.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:81,columnNumber:15},void 0)]},n.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:60,columnNumber:13},void 0)})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:56,columnNumber:7},void 0),d.jsxDEV("div",{className:"h-safe-area-inset-bottom bg-white"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:93,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/MobileBottomNav.tsx",lineNumber:52,columnNumber:5},void 0)},vm=({href:e,children:t,className:r})=>d.jsxDEV("a",{href:e,className:Fe("sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-blue-600 text-white px-4 py-2 rounded-md z-50 transition-all duration-200 hover:bg-blue-700",r),children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/AccessibilityEnhancements.tsx",lineNumber:13,columnNumber:5},void 0),O5=()=>({announce:(t,r="polite")=>{const n=document.createElement("div");n.setAttribute("aria-live",r),n.setAttribute("aria-atomic","true"),n.className="sr-only",n.textContent=t,document.body.appendChild(n),setTimeout(()=>{document.body.removeChild(n)},1e3)}}),V5=()=>{W.useEffect(()=>{const e=t=>{if(t.key==="Escape"){const r=document.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');r.length>0&&r[0].focus()}if(t.key==="Tab"&&t.shiftKey){const r=document.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(r.length>0){const n=r[r.length-1];document.activeElement===n&&(t.preventDefault(),r.length>1&&r[0].focus())}}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[])},P5=()=>{const e=W.useCallback(()=>{const r=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),n=[];let a=0;return r.forEach((i,s)=>{var l;const o=parseInt(i.tagName.charAt(1));s>0&&o>a+1&&n.push(`Skipped heading level: h${a} to h${o} at "${i.textContent}"`),(l=i.textContent)!=null&&l.trim()||n.push(`Empty ${i.tagName} found`),a=o}),n},[]),t=W.useCallback(()=>{const r=document.querySelectorAll("h1, h2, h3, h4, h5, h6");return Array.from(r).map(n=>{var a;return{level:parseInt(n.tagName.charAt(1)),text:((a=n.textContent)==null?void 0:a.trim())||"",id:n.id||""}})},[]);return{validateHeadingStructure:e,getHeadingOutline:t}},I5=()=>({validateImages:W.useCallback(()=>{const t=document.querySelectorAll("img"),r=[];return t.forEach((n,a)=>{const i=n.getAttribute("alt");i===null&&r.push(`Image ${a+1}: Missing alt attribute`),i===""&&!n.getAttribute("role")&&r.push(`Image ${a+1}: Decorative image should have role="presentation" or alt=""`),i&&i.length>125&&r.push(`Image ${a+1}: Alt text too long (${i.length} chars), consider using longdesc`)}),r},[])}),M5=()=>({validateLinks:W.useCallback(()=>{const t=document.querySelectorAll("a[href]"),r=[],n=new Set;return t.forEach((a,i)=>{var l,u;const s=((l=a.textContent)==null?void 0:l.trim())||"";a.getAttribute("href"),!s&&!a.querySelector("img")&&r.push(`Link ${i+1}: Empty link text`),["click here","read more","learn more","here","more"].includes(s.toLowerCase())&&r.push(`Link ${i+1}: Generic link text "${s}" - be more descriptive`),n.has(s)?r.push(`Link ${i+1}: Duplicate link text "${s}" - ensure context or make unique`):n.add(s),a.getAttribute("target")==="_blank"&&!((u=a.getAttribute("aria-label"))!=null&&u.includes("opens"))&&r.push(`Link ${i+1}: Opens new window without accessibility warning`)}),r},[])}),j5=()=>({validateForms:W.useCallback(()=>{const t=document.querySelectorAll("form"),r=[];return t.forEach((n,a)=>{n.querySelectorAll("input, select, textarea").forEach((s,o)=>{var f;const l=s.tagName.toLowerCase(),u=s.id,c=u?document.querySelector(`label[for="${u}"]`):!1,m=s.getAttribute("aria-label"),h=s.getAttribute("aria-labelledby");if(!c&&!m&&!h&&r.push(`Form ${a+1}, ${l} ${o+1}: Missing label or aria-label`),s.hasAttribute("required")){const x=s.getAttribute("aria-required")==="true",p=c&&((f=c==null?void 0:c.textContent)==null?void 0:f.includes("*"));!x&&!p&&r.push(`Form ${a+1}, ${l} ${o+1}: Required field not clearly indicated`)}if(s.classList.contains("error")||s.getAttribute("aria-invalid")==="true"){const x=s.getAttribute("aria-describedby");x&&document.getElementById(x)||r.push(`Form ${a+1}, ${l} ${o+1}: Invalid field has no error message`)}})}),r},[])}),L5=()=>{const[e,t]=W.useState(!1);return W.useEffect(()=>{const r=navigator.userAgent.toLowerCase(),n=r.includes("nvda")||r.includes(" jaws")||r.includes("dragon")||window.speechSynthesis!==void 0,a=window.matchMedia("(prefers-reduced-motion: reduce)").matches,i=window.matchMedia("(prefers-contrast: high)").matches;t(n||a||i)},[]),e},B5=()=>({runQuickAudit:W.useCallback(()=>{const t=[],{validateHeadingStructure:r}=P5();t.push(...r());const{validateImages:n}=I5();t.push(...n());const{validateLinks:a}=M5();t.push(...a());const{validateForms:i}=j5();return t.push(...i()),document.documentElement.getAttribute("lang")||t.push("Missing lang attribute on html element"),(!document.title||document.title.length===0)&&t.push("Missing or empty page title"),{violations:t,score:Math.max(0,100-t.length*5),total:t.length}},[])}),q5=()=>{const[e,t]=W.useState("medium"),r=W.useCallback(()=>{t(i=>i==="small"?"medium":"large")},[]),n=W.useCallback(()=>{t(i=>i==="large"?"medium":"small")},[]),a=W.useCallback(()=>{t("medium")},[]);return{textSize:e,increaseTextSize:r,decreaseTextSize:n,resetTextSize:a}},z5=()=>{W.useEffect(()=>{const e=t=>{if(t.ctrlKey||t.metaKey)switch(t.key){case"+":case"=":t.preventDefault(),document.body.style.fontSize="larger";break;case"-":t.preventDefault(),document.body.style.fontSize="smaller";break;case"0":t.preventDefault(),document.body.style.fontSize="";break}if(t.altKey)switch(t.key){case"m":t.preventDefault();const r=document.querySelector('main, [role="main"]');r&&(r.focus(),r.scrollIntoView());break;case"n":t.preventDefault();const n=document.querySelector('nav, [role="navigation"]');n&&(n.focus(),n.scrollIntoView());break;case"h":t.preventDefault();const a=document.querySelector("h1");a&&(a.focus(),a.scrollIntoView());break}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[])},H5=W.lazy(()=>ii(()=>import("./inspection-pages-DEsUsoKz-v6.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),$5=W.lazy(()=>ii(()=>import("./data-pages-Du91enDM-v6.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),W5=W.lazy(()=>ii(()=>import("./notes-pages-E1oNcr49-v6.js"),__vite__mapDeps([8,1,2,3,4,5,6]))),G5=W.lazy(()=>ii(()=>import("./building-inspection-eni4S2t--v6.js"),__vite__mapDeps([9,1,2,3,4,5,6]))),Y5=W.lazy(()=>ii(()=>Promise.resolve().then(()=>HW),void 0)),X5=W.lazy(()=>ii(()=>import("./admin-pages-tVePfbD9-v6.js"),__vite__mapDeps([10,1,2,3,4,5,6]))),K5=W.lazy(()=>ii(()=>import("./feedback-pages-B3z_JzKU-v6.js"),__vite__mapDeps([11,1,2,3,4,5,6]))),Q5=W.lazy(()=>ii(()=>import("./dashboard-pages-DxTeAhYF-v6.js"),__vite__mapDeps([12,1,2,3,4,5,6]))),Fa=()=>d.jsxDEV("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:d.jsxDEV("div",{className:"text-center max-w-md mx-auto",children:[d.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:43,columnNumber:7},void 0),d.jsxDEV("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Loading..."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:44,columnNumber:7},void 0),d.jsxDEV("p",{className:"text-muted-foreground",children:"Please wait while we load the page."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:45,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:42,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:41,columnNumber:3},void 0);class Z5 extends vs.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}render(){return this.state.hasError?d.jsxDEV("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:d.jsxDEV("div",{className:"text-center max-w-md mx-auto",children:[d.jsxDEV("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:68,columnNumber:13},this),d.jsxDEV("p",{className:"text-gray-600 mb-4",children:"Please refresh the page to try again."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:71,columnNumber:13},this),d.jsxDEV("button",{onClick:()=>window.location.reload(),className:"modern-button bg-primary hover:bg-primary/90 border-primary text-primary-foreground",children:"Refresh Page"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:74,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:67,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:66,columnNumber:9},this):this.props.children}}function J5(){const[e,t]=W.useState("Custodial"),[r,n]=W.useState(!1),[a,i]=W.useState(!1),[s,o]=W.useState(!1);wF();const{announce:l}=O5();V5(),z5();const{runQuickAudit:u}=B5(),{textSize:c,increaseTextSize:m,decreaseTextSize:h}=q5(),f=L5();W.useEffect(()=>{{const E=setInterval(()=>{const w=u();w.total>0&&(console.group("ðŸ” Accessibility Audit Results"),console.log(`Score: ${w.score}/100 (${w.total} violations)`),w.violations.forEach((S,_)=>{console.warn(`${_+1}. ${S}`)}),console.groupEnd())},1e4);return()=>clearInterval(E)}},[u]);const{notifications:x,removeNotification:p}=EF(),{notifications:g,removeNotification:v,showSuccess:C,showInfo:b}=jF();W.useEffect(()=>{e!=="Custodial"&&l(`Navigated to ${{"Custodial Inspection":"Single Area Inspection Form","Custodial Notes":"Custodial Concern Reporting Form","Inspection Data":"Inspection Data and Reports","Whole Building Inspection":"Whole Building Inspection Form","Rating Criteria":"Rating Criteria Reference Guide","admin-inspections":"Admin Inspections Panel","Monthly Feedback":"Monthly Feedback Reports","Scores Dashboard":"Building Scores Dashboard"}[e]||e}`)},[e,l]),W.useEffect(()=>{const E=()=>{document.querySelectorAll("form").forEach(_=>{_.noValidate=!0,_.querySelectorAll("input[pattern]").forEach(U=>{const R=U;R.setAttribute("data-pattern",R.getAttribute("pattern")||""),R.removeAttribute("pattern")}),_.addEventListener("invalid",U=>{U.preventDefault()},!0)})};E();const w=new MutationObserver(E);return w.observe(document.documentElement,{childList:!0,subtree:!0}),()=>w.disconnect()},[]),W.useEffect(()=>{const E=()=>{const U=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");i(U),U&&!Ut.getItem("pwa-install-shown")&&(o(!0),Ut.setItem("pwa-install-shown","true"),setTimeout(()=>o(!1),5e3),C("App Installed Successfully!","You can now access Custodial Command directly from your home screen.",{duration:5e3}))};E(),(()=>{const R=Ut.getItem("app-version");if(R&&R!=="v6"){console.log("App version updated, clearing cache..."),"caches"in window&&caches.keys().then(K=>{K.forEach(de=>{caches.delete(de)})});const q=["app-version","pwa-install-shown"];Ut.keys().filter(K=>!q.includes(K)).forEach(K=>Ut.removeItem(K)),Ut.setItem("app-version","v6"),b("App Updated","ðŸ”„ App updated! Reloading with latest version..."),setTimeout(()=>window.location.reload(),2e3);return}Ut.setItem("app-version","v6")})();const S=()=>{i(!0),o(!0),Ut.setItem("pwa-install-shown","true"),setTimeout(()=>o(!1),5e3),C("App Installed Successfully!","You can now access Custodial Command directly from your home screen.",{duration:5e3})};window.addEventListener("appinstalled",S);const _=window.matchMedia("(display-mode: standalone)");return _.addEventListener("change",E),()=>{window.removeEventListener("appinstalled",S),_.removeEventListener("change",E)}},[]);const N=[{name:"Home",path:"Custodial"}],F=()=>{try{switch(e){case"Custodial":return d.jsxDEV("div",{className:"p-8 text-center",children:[d.jsxDEV("div",{className:"mb-8 max-w-2xl mx-auto",children:[s&&d.jsxDEV("div",{className:"mb-4 p-4 bg-accent/20 border-2 border-accent/50 rounded-lg shadow-md",children:[d.jsxDEV("div",{className:"flex items-center justify-center space-x-2",children:[d.jsxDEV("span",{className:"text-2xl",children:"âœ…"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:300,columnNumber:23},this),d.jsxDEV("span",{className:"text-lg font-bold text-accent-foreground",children:"App Successfully Installed!"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:301,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:299,columnNumber:21},this),d.jsxDEV("p",{className:"text-center text-accent-foreground mt-2",children:"You can now access Custodial Command directly from your home screen."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:305,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:298,columnNumber:19},this),a?d.jsxDEV("div",{className:"mb-4 p-4 bg-accent/20 border-2 border-accent/50 rounded-lg shadow-md",children:[d.jsxDEV("div",{className:"flex items-center justify-center space-x-2",children:[d.jsxDEV("span",{className:"text-xl",children:"ðŸ“±"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:316,columnNumber:23},this),d.jsxDEV("span",{className:"text-lg font-bold text-accent-foreground",children:"Running as Installed App"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:317,columnNumber:23},this),d.jsxDEV("span",{className:"text-xl",children:"âœ…"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:320,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:315,columnNumber:21},this),d.jsxDEV("p",{className:"text-center text-accent-foreground mt-1 text-sm",children:"App is installed and working offline-ready"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:322,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:314,columnNumber:19},this):d.jsxDEV("button",{onClick:()=>n(!r),className:"w-full p-4 bg-amber-100 border-2 border-amber-300 rounded-lg shadow-md hover:bg-amber-150 transition-colors flex items-center justify-between",children:[d.jsxDEV("span",{className:"text-lg font-bold text-amber-900",children:"ðŸ“± Install on Your Mobile Device"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:333,columnNumber:21},this),d.jsxDEV("span",{className:"text-amber-900 text-xl",children:r?"âˆ’":"+"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:336,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:327,columnNumber:19},this),!a&&r&&d.jsxDEV("div",{className:"mt-4 p-6 bg-amber-50 border-2 border-amber-300 rounded-lg shadow-md",children:d.jsxDEV("div",{className:"text-amber-800 space-y-3",children:[d.jsxDEV("div",{className:"bg-white p-3 rounded border border-amber-200",children:[d.jsxDEV("p",{className:"font-semibold text-amber-900 mb-1",children:"iPhone/iPad:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:346,columnNumber:25},this),d.jsxDEV("p",{className:"text-sm",children:"1. Tap the Share button (â–¡â†—) in Safari"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:349,columnNumber:25},this),d.jsxDEV("p",{className:"text-sm",children:'2. Scroll down and tap "Add to Home Screen"'},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:352,columnNumber:25},this),d.jsxDEV("p",{className:"text-sm",children:'3. Tap "Add" to install the app'},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:355,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:345,columnNumber:23},this),d.jsxDEV("div",{className:"bg-white p-3 rounded border border-amber-200",children:[d.jsxDEV("p",{className:"font-semibold text-amber-900 mb-1",children:"Android:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:360,columnNumber:25},this),d.jsxDEV("p",{className:"text-sm",children:"1. Tap the menu (â‹®) in Chrome or your browser"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:363,columnNumber:25},this),d.jsxDEV("p",{className:"text-sm",children:'2. Select "Add to Home screen" or "Install app"'},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:366,columnNumber:25},this),d.jsxDEV("p",{className:"text-sm",children:'3. Tap "Add" or "Install" to confirm'},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:369,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:359,columnNumber:23},this),d.jsxDEV("p",{className:"text-center text-sm font-medium text-amber-700 mt-3",children:"Once installed, access the app directly from your home screen like any other app!"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:373,columnNumber:23},this),d.jsxDEV("div",{className:"mt-4 p-3 bg-accent/10 border border-accent/30 rounded",children:d.jsxDEV("p",{className:"text-center text-sm font-medium text-accent-foreground",children:"âœ“ Works offline after installation - previously viewed pages remain accessible"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:378,columnNumber:25},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:377,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:344,columnNumber:21},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:343,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:295,columnNumber:15},this),d.jsxDEV("div",{className:"space-y-6 mb-6",children:[d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide px-2",children:"Submit Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:391,columnNumber:19},this),d.jsxDEV("div",{className:"responsive-grid",children:[d.jsxDEV("button",{onClick:()=>t("Custodial Notes"),className:"modern-button bg-blue-600 hover:bg-blue-700 border-blue-600 text-white shadow-md hover:shadow-lg transition-shadow",children:d.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“ Report A Custodial Concern"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:399,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:395,columnNumber:21},this),d.jsxDEV("button",{onClick:()=>t("Custodial Inspection"),className:"modern-button bg-blue-600 hover:bg-blue-700 border-blue-600 text-white shadow-md hover:shadow-lg transition-shadow",children:d.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ” Single Area Inspection"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:407,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:403,columnNumber:21},this),d.jsxDEV("button",{onClick:()=>t("Whole Building Inspection"),className:"modern-button bg-blue-600 hover:bg-blue-700 border-blue-600 text-white shadow-md hover:shadow-lg transition-shadow",children:d.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ¢ Building Inspection"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:415,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:411,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:394,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:390,columnNumber:17},this),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide px-2",children:"View & Reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:423,columnNumber:19},this),d.jsxDEV("div",{className:"responsive-grid",children:[d.jsxDEV("button",{onClick:()=>t("Scores Dashboard"),className:"modern-button bg-emerald-600 hover:bg-emerald-700 border-emerald-600 text-white shadow-md hover:shadow-lg transition-shadow",children:d.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“ˆ Building Scores Dashboard"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:431,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:427,columnNumber:21},this),d.jsxDEV("button",{onClick:()=>t("Inspection Data"),className:"modern-button bg-green-600 hover:bg-green-700 border-green-600 text-white shadow-md hover:shadow-lg transition-shadow",children:d.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“Š View Data & Reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:439,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:435,columnNumber:21},this),d.jsxDEV("button",{onClick:()=>t("Monthly Feedback"),className:"modern-button bg-purple-600 hover:bg-purple-700 border-purple-600 text-white shadow-md hover:shadow-lg transition-shadow",children:d.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"ðŸ“„ Monthly Feedback Reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:447,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:443,columnNumber:21},this),d.jsxDEV("button",{onClick:()=>t("Rating Criteria"),className:"modern-button bg-gray-600 hover:bg-gray-700 border-gray-600 text-white shadow-sm hover:shadow-md transition-shadow",children:d.jsxDEV("span",{className:"flex items-center justify-center gap-2",children:"â„¹ï¸ Rating Criteria Guide"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:455,columnNumber:23},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:451,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:426,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:422,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:389,columnNumber:15},this),d.jsxDEV("p",{className:"text-lg text-muted-foreground text-center",children:"Cleanliness is a duty for all."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:463,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:293,columnNumber:13},this);case"Custodial Inspection":return d.jsxDEV(W.Suspense,{fallback:d.jsxDEV(Fa,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:470,columnNumber:33},this),children:d.jsxDEV(H5,{onBack:()=>t("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:471,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:470,columnNumber:13},this);case"Inspection Data":return d.jsxDEV(W.Suspense,{fallback:d.jsxDEV(Fa,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:478,columnNumber:33},this),children:d.jsxDEV($5,{onBack:()=>t("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:479,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:478,columnNumber:13},this);case"Custodial Notes":return d.jsxDEV(W.Suspense,{fallback:d.jsxDEV(Fa,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:484,columnNumber:33},this),children:d.jsxDEV(W5,{onBack:()=>t("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:485,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:484,columnNumber:13},this);case"Whole Building Inspection":return d.jsxDEV(W.Suspense,{fallback:d.jsxDEV(Fa,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:490,columnNumber:33},this),children:d.jsxDEV(G5,{onBack:()=>t("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:491,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:490,columnNumber:13},this);case"Rating Criteria":return d.jsxDEV(W.Suspense,{fallback:d.jsxDEV(Fa,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:498,columnNumber:33},this),children:d.jsxDEV(Y5,{onBack:()=>t("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:499,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:498,columnNumber:13},this);case"admin-inspections":return d.jsxDEV(W.Suspense,{fallback:d.jsxDEV(Fa,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:504,columnNumber:33},this),children:d.jsxDEV(X5,{onBack:()=>t("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:505,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:504,columnNumber:13},this);case"Monthly Feedback":return d.jsxDEV(W.Suspense,{fallback:d.jsxDEV(Fa,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:510,columnNumber:33},this),children:d.jsxDEV(K5,{onBack:()=>t("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:511,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:510,columnNumber:13},this);case"Scores Dashboard":return d.jsxDEV(W.Suspense,{fallback:d.jsxDEV(Fa,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:516,columnNumber:33},this),children:d.jsxDEV(Q5,{onBack:()=>t("Custodial")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:517,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:516,columnNumber:13},this);default:return d.jsxDEV("div",{className:"p-8 text-center",children:[d.jsxDEV("h1",{className:"text-2xl font-bold",children:"Page Not Found"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:523,columnNumber:15},this),d.jsxDEV("button",{onClick:()=>t("Custodial"),className:"mt-4 modern-button bg-primary hover:bg-primary/90 border-primary text-primary-foreground",children:"Return Home"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:524,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:522,columnNumber:13},this)}}catch(E){return console.error("Error rendering page:",E),d.jsxDEV("div",{className:"p-8 text-center",children:[d.jsxDEV("h1",{className:"text-2xl font-bold text-red-600",children:"Error Loading Page"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:537,columnNumber:11},this),d.jsxDEV("p",{className:"mt-2 text-gray-600",children:"Something went wrong. Please try again."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:540,columnNumber:11},this),d.jsxDEV("button",{onClick:()=>t("Custodial"),className:"mt-4 modern-button bg-primary hover:bg-primary/90 border-primary text-primary-foreground",children:"Return Home"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:543,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:536,columnNumber:9},this)}};return d.jsxDEV(Z5,{children:d.jsxDEV(xk,{client:U5,children:d.jsxDEV(S5,{children:d.jsxDEV("div",{className:"bg-background text-foreground min-h-screen pb-16 lg:pb-0","data-testid":"app-container",lang:"en",children:[d.jsxDEV("div",{className:"sr-only",role:"navigation","aria-label":"Skip links",children:[d.jsxDEV(vm,{href:"#main-content",children:"Skip to main content"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:566,columnNumber:15},this),d.jsxDEV(vm,{href:"#navigation",children:"Skip to navigation"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:567,columnNumber:15},this),d.jsxDEV(vm,{href:"#footer",children:"Skip to footer"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:568,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:565,columnNumber:13},this),d.jsxDEV("div",{className:"main-container",children:[d.jsxDEV("header",{className:"w-full header-container rounded-xl shadow-sm",role:"banner",children:[d.jsxDEV("h1",{className:"font-bold modern-header tracking-tight",id:"app-title",children:"CA Custodial Command"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:577,columnNumber:17},this),d.jsxDEV("div",{className:"sr-only","aria-live":"polite",children:f&&"Screen reader mode detected"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:580,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:573,columnNumber:15},this),d.jsxDEV("nav",{className:"w-full nav-container rounded-xl shadow-sm",role:"navigation","aria-labelledby":"app-title",id:"navigation",children:d.jsxDEV("div",{className:"button-container",role:"menubar",children:[N.map(E=>d.jsxDEV("button",{onClick:()=>t(E.path),className:`modern-button ${e===E.path?"bg-primary/80":""}`,role:"menuitem","aria-current":e===E.path?"page":void 0,"aria-label":`${E.name} page${e===E.path?", current page":""}`,children:E.name},E.name,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:594,columnNumber:21},this)),d.jsxDEV("button",{onClick:()=>t("admin-inspections"),className:"modern-button bg-red-600 hover:bg-red-700 border-red-600 text-white",role:"menuitem","aria-label":"Admin inspections panel","aria-current":e==="admin-inspections"?"page":void 0,children:"Admin"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:607,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:592,columnNumber:17},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:586,columnNumber:15},this),d.jsxDEV("div",{className:"w-full nav-container rounded-xl shadow-sm mb-4",role:"toolbar","aria-label":"Text size controls",children:d.jsxDEV("div",{className:"button-container",children:[d.jsxDEV("button",{onClick:h,className:"modern-button bg-secondary hover:bg-secondary/80","aria-label":"Decrease text size",disabled:c==="small",children:[d.jsxDEV("span",{"aria-hidden":"true",children:"A-"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:632,columnNumber:21},this),d.jsxDEV("span",{className:"sr-only",children:"Decrease text size"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:633,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:626,columnNumber:19},this),d.jsxDEV("span",{className:"text-sm text-muted-foreground px-2","aria-live":"polite","aria-label":`Current text size: ${c}`,children:["Text Size: ",c.charAt(0).toUpperCase()+c.slice(1)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:635,columnNumber:19},this),d.jsxDEV("button",{onClick:m,className:"modern-button bg-secondary hover:bg-secondary/80","aria-label":"Increase text size",disabled:c==="large",children:[d.jsxDEV("span",{"aria-hidden":"true",children:"A+"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:648,columnNumber:21},this),d.jsxDEV("span",{className:"sr-only",children:"Increase text size"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:649,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:642,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:625,columnNumber:17},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:620,columnNumber:15},this),d.jsxDEV(IF,{className:"mb-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:655,columnNumber:15},this),d.jsxDEV("main",{id:"main-content",className:"w-full content-area rounded-xl shadow-sm",role:"main","aria-label":"Main content",tabIndex:-1,children:F()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:658,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:571,columnNumber:13},this),d.jsxDEV("footer",{className:"w-full mt-6 text-center text-muted-foreground text-sm",role:"contentinfo",id:"footer",children:[d.jsxDEV("p",{children:"Â© 2025 Shared Service Command. All rights reserved. For the People!"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:675,columnNumber:15},this),d.jsxDEV("div",{className:"mt-2 text-xs",children:d.jsxDEV("span",{"aria-label":"Accessibility information",children:"WCAG 2.2 AA Compliant | Screen reader friendly"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:680,columnNumber:17},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:679,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:670,columnNumber:13},this),d.jsxDEV(R5,{className:"lg:hidden"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:687,columnNumber:13},this),d.jsxDEV("div",{"aria-live":"polite","aria-label":"Application notifications",role:"region",children:[d.jsxDEV(RF,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:695,columnNumber:15},this),d.jsxDEV(OF,{notifications:x,onRemove:p},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:696,columnNumber:15},this),d.jsxDEV(MF,{notifications:g,onRemove:v},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:700,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:690,columnNumber:13},this),d.jsxDEV("div",{className:"sr-only","aria-live":"assertive","aria-atomic":"true",id:"screen-reader-announcements"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:707,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:559,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:558,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:557,columnNumber:7},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/App.tsx",lineNumber:555,columnNumber:5},this)}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("Service Worker registered successfully:",e.scope),setInterval(()=>{e.update()},300*1e3)}).catch(e=>{console.error("Service Worker registration failed:",e)})});const Y_=document.getElementById("root");if(!Y_)throw new Error("Could not find root element");const eU=gk.createRoot(Y_);eU.render(d.jsxDEV(J5,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/main.tsx",lineNumber:32,columnNumber:13},void 0));console.log("App initializing...");const Xl={DRAFT_INSPECTION:"custodial-draft-inspection",DRAFT_BUILDING_INSPECTION:"custodial-draft-building-inspection",DRAFT_CUSTODIAL_NOTE:"custodial-draft-custodial-note",USER_PREFERENCES:"custodial-user-preferences",LEGACY_INSPECTION_DRAFTS:"custodial_inspection_drafts",LEGACY_BUILDING_DRAFTS:"building_form_drafts"},Ui={MAX_DRAFT_SIZE:5*1024*1024,MAX_TOTAL_STORAGE:8*1024*1024,MAX_DRAFTS_PER_TYPE:10,IMAGE_QUALITY:.7,MAX_IMAGE_DIMENSIONS:{width:1200,height:1200}},dp=()=>{let e=0;const t=Ut.keys();for(const r of t){const n=Ut.getItem(r);n&&(e+=n.length+r.length)}return e},tU=e=>new Promise((t,r)=>{const n=document.createElement("canvas"),a=n.getContext("2d"),i=new Image;i.onload=()=>{const{width:s,height:o}=Ui.MAX_IMAGE_DIMENSIONS;let{width:l,height:u}=i;if(l>s||u>o){const m=Math.min(s/l,o/u);l*=m,u*=m}n.width=l,n.height=u,a==null||a.drawImage(i,0,0,l,u);const c=n.toDataURL("image/jpeg",Ui.IMAGE_QUALITY);t(c)},i.onerror=r,i.src=URL.createObjectURL(e)}),sZ=(e,t)=>{try{const r={data:t,timestamp:Date.now()},n=JSON.stringify(r);if(n.length>Ui.MAX_DRAFT_SIZE){console.warn(`Draft too large (${Math.round(n.length/1024)}KB). Skipping save.`);return}if(dp()+n.length>Ui.MAX_TOTAL_STORAGE&&(fp(),dp()+n.length>Ui.MAX_TOTAL_STORAGE)){console.warn("Storage limit reached. Cannot save draft.");return}Ut.setItem(e,n)}catch(r){if(console.error("Failed to save draft to localStorage:",r),r instanceof Error&&r.name==="QuotaExceededError"){fp();try{Ut.setItem(e,JSON.stringify({data:t,timestamp:Date.now()}))}catch(n){console.error("Failed to save draft even after cleanup:",n)}}}},oZ=e=>{try{const t=Ut.getItem(e);if(!t)return null;const r=JSON.parse(t);return Date.now()-r.timestamp>10080*60*1e3?(Ut.removeItem(e),null):r.data}catch(t){return console.error("Failed to load draft from localStorage:",t),null}},lZ=e=>{try{Ut.removeItem(e)}catch(t){console.error("Failed to clear draft from localStorage:",t)}},fp=()=>{try{const e=Date.now()-6048e5,t=[],r=Ut.keys();for(const n of r)if(n.startsWith("custodial-"))try{const a=Ut.getItem(n);if(a){const i=JSON.parse(a);i.timestamp&&i.timestamp<e&&t.push(n)}}catch(a){t.push(n)}t.forEach(n=>Ut.removeItem(n)),console.log(`Cleaned up ${t.length} old drafts`)}catch(e){console.error("Failed to cleanup old drafts:",e)}},uZ=()=>{try{Ut.getItem(Xl.LEGACY_INSPECTION_DRAFTS)&&(console.log("Migrating legacy inspection drafts..."),Ut.removeItem(Xl.LEGACY_INSPECTION_DRAFTS)),Ut.getItem(Xl.LEGACY_BUILDING_DRAFTS)&&(console.log("Migrating legacy building inspection drafts..."),Ut.removeItem(Xl.LEGACY_BUILDING_DRAFTS)),fp()}catch(e){console.error("Failed to migrate legacy drafts:",e)}},cZ=e=>bt(null,null,function*(){try{return e.size<500*1024?new Promise((t,r)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)}):yield tU(e)}catch(t){throw console.error("Failed to process image for storage:",t),t}}),mZ=()=>{const e=dp(),t=Ut.keys().filter(r=>r.startsWith("custodial-")).length;return{totalSizeKB:Math.round(e/1024),totalSizeMB:Math.round(e/(1024*1024)*100)/100,draftCount:t,limitMB:Math.round(Ui.MAX_TOTAL_STORAGE/(1024*1024)),usagePercent:Math.round(e/Ui.MAX_TOTAL_STORAGE*100)}};function dZ(r){return bt(this,arguments,function*(e,t={}){const{maxWidth:n=1920,maxHeight:a=1080,quality:i=.8,maxSizeKB:s=500}=t;return new Promise((o,l)=>{const u=document.createElement("canvas"),c=u.getContext("2d"),m=new Image;m.onload=()=>{let{width:h,height:f}=m;if(h>n||f>a){const g=Math.min(n/h,a/f);h=h*g,f=f*g}u.width=h,u.height=f,c==null||c.drawImage(m,0,0,h,f);let x=i;const p=()=>{u.toBlob(g=>{if(!g){l(new Error("Failed to compress image"));return}if(g.size/1024>s&&x>.1)x-=.1,p();else{const C=new File([g],e.name,{type:"image/jpeg",lastModified:Date.now()});o({compressedFile:C,originalSize:e.size,compressedSize:g.size,compressionRatio:(e.size-g.size)/e.size})}},"image/jpeg",x)};p()},m.onerror=()=>l(new Error("Failed to load image")),m.src=URL.createObjectURL(e)})})}function fZ(e,t=500){return e.size/1024>t}function hZ(e){if(e===0)return"0 Bytes";const t=1024,r=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,n)).toFixed(2))+" "+r[n]}const Ns=W.forwardRef((a,n)=>{var i=a,{className:e,type:t}=i,r=Ee(i,["className","type"]);return d.jsxDEV("input",H({type:t,className:Fe("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground","transition-all duration-200 ease-out","border-3 border-[hsl(var(--border))] bg-[hsl(var(--card))] text-[hsl(var(--card-foreground))]","focus:outline-none focus:ring-0 focus:border-[hsl(var(--primary))] focus:shadow-[0_0_0_4px_hsl(var(--primary)_/_0.2)] focus:bg-[hsl(var(--background))]","hover:border-[hsl(var(--primary)_/_0.8)] hover:shadow-[0_0_0_2px_hsl(var(--primary)_/_0.1)]","disabled:cursor-not-allowed disabled:opacity-50","transform-gpu will-change-auto",e),ref:n},r),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/input.tsx",lineNumber:10,columnNumber:7},void 0)});Ns.displayName="Input";const rU=wc("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),nt=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(qE,H({ref:r,className:Fe(rU(),e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/label.tsx",lineNumber:15,columnNumber:3},void 0)});nt.displayName=qE.displayName;const Tx=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV("textarea",H({className:Fe("flex min-h-[80px] w-full rounded-md bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground","transition-all duration-200 ease-out","border-3 border-[hsl(var(--border))] bg-[hsl(var(--card))] text-[hsl(var(--card-foreground))]","focus:outline-none focus:ring-0 focus:border-[hsl(var(--primary))] focus:shadow-[0_0_0_4px_hsl(var(--primary)_/_0.2)] focus:bg-[hsl(var(--background))]","hover:border-[hsl(var(--primary)_/_0.8)] hover:shadow-[0_0_0_2px_hsl(var(--primary)_/_0.1)]","disabled:cursor-not-allowed disabled:opacity-50","transform-gpu will-change-auto",e),ref:r},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/textarea.tsx",lineNumber:10,columnNumber:7},void 0)});Tx.displayName="Textarea";const nU=["top","right","bottom","left"],Xa=Math.min,Xr=Math.max,Mu=Math.round,Kl=Math.floor,Xn=e=>({x:e,y:e}),aU={left:"right",right:"left",bottom:"top",top:"bottom"},iU={start:"end",end:"start"};function hp(e,t,r){return Xr(e,Xa(t,r))}function ba(e,t){return typeof e=="function"?e(t):e}function Na(e){return e.split("-")[0]}function Hs(e){return e.split("-")[1]}function Dx(e){return e==="x"?"y":"x"}function Ax(e){return e==="y"?"height":"width"}const sU=new Set(["top","bottom"]);function Gn(e){return sU.has(Na(e))?"y":"x"}function kx(e){return Dx(Gn(e))}function oU(e,t,r){r===void 0&&(r=!1);const n=Hs(e),a=kx(e),i=Ax(a);let s=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(s=ju(s)),[s,ju(s)]}function lU(e){const t=ju(e);return[pp(e),t,pp(t)]}function pp(e){return e.replace(/start|end/g,t=>iU[t])}const G1=["left","right"],Y1=["right","left"],uU=["top","bottom"],cU=["bottom","top"];function mU(e,t,r){switch(e){case"top":case"bottom":return r?t?Y1:G1:t?G1:Y1;case"left":case"right":return t?uU:cU;default:return[]}}function dU(e,t,r,n){const a=Hs(e);let i=mU(Na(e),r==="start",n);return a&&(i=i.map(s=>s+"-"+a),t&&(i=i.concat(i.map(pp)))),i}function ju(e){return e.replace(/left|right|bottom|top/g,t=>aU[t])}function fU(e){return H({top:0,right:0,bottom:0,left:0},e)}function X_(e){return typeof e!="number"?fU(e):{top:e,right:e,bottom:e,left:e}}function Lu(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function X1(e,t,r){let{reference:n,floating:a}=e;const i=Gn(t),s=kx(t),o=Ax(s),l=Na(t),u=i==="y",c=n.x+n.width/2-a.width/2,m=n.y+n.height/2-a.height/2,h=n[o]/2-a[o]/2;let f;switch(l){case"top":f={x:c,y:n.y-a.height};break;case"bottom":f={x:c,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:m};break;case"left":f={x:n.x-a.width,y:m};break;default:f={x:n.x,y:n.y}}switch(Hs(t)){case"start":f[s]-=h*(r&&u?-1:1);break;case"end":f[s]+=h*(r&&u?-1:1);break}return f}const hU=(e,t,r)=>bt(null,null,function*(){const{placement:n="bottom",strategy:a="absolute",middleware:i=[],platform:s}=r,o=i.filter(Boolean),l=yield s.isRTL==null?void 0:s.isRTL(t);let u=yield s.getElementRects({reference:e,floating:t,strategy:a}),{x:c,y:m}=X1(u,n,l),h=n,f={},x=0;for(let p=0;p<o.length;p++){const{name:g,fn:v}=o[p],{x:C,y:b,data:N,reset:F}=yield v({x:c,y:m,initialPlacement:n,placement:h,strategy:a,middlewareData:f,rects:u,platform:s,elements:{reference:e,floating:t}});c=C!=null?C:c,m=b!=null?b:m,f=he(H({},f),{[g]:H(H({},f[g]),N)}),F&&x<=50&&(x++,typeof F=="object"&&(F.placement&&(h=F.placement),F.rects&&(u=F.rects===!0?yield s.getElementRects({reference:e,floating:t,strategy:a}):F.rects),{x:c,y:m}=X1(u,h,l)),p=-1)}return{x:c,y:m,placement:h,strategy:a,middlewareData:f}});function Xo(e,t){return bt(this,null,function*(){var r;t===void 0&&(t={});const{x:n,y:a,platform:i,rects:s,elements:o,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:m="floating",altBoundary:h=!1,padding:f=0}=ba(t,e),x=X_(f),g=o[h?m==="floating"?"reference":"floating":m],v=Lu(yield i.getClippingRect({element:(r=yield i.isElement==null?void 0:i.isElement(g))==null||r?g:g.contextElement||(yield i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:u,rootBoundary:c,strategy:l})),C=m==="floating"?{x:n,y:a,width:s.floating.width,height:s.floating.height}:s.reference,b=yield i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating),N=(yield i.isElement==null?void 0:i.isElement(b))?(yield i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},F=Lu(i.convertOffsetParentRelativeRectToViewportRelativeRect?yield i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:C,offsetParent:b,strategy:l}):C);return{top:(v.top-F.top+x.top)/N.y,bottom:(F.bottom-v.bottom+x.bottom)/N.y,left:(v.left-F.left+x.left)/N.x,right:(F.right-v.right+x.right)/N.x}})}const pU=e=>({name:"arrow",options:e,fn(r){return bt(this,null,function*(){const{x:n,y:a,placement:i,rects:s,platform:o,elements:l,middlewareData:u}=r,{element:c,padding:m=0}=ba(e,r)||{};if(c==null)return{};const h=X_(m),f={x:n,y:a},x=kx(i),p=Ax(x),g=yield o.getDimensions(c),v=x==="y",C=v?"top":"left",b=v?"bottom":"right",N=v?"clientHeight":"clientWidth",F=s.reference[p]+s.reference[x]-f[x]-s.floating[p],E=f[x]-s.reference[x],w=yield o.getOffsetParent==null?void 0:o.getOffsetParent(c);let S=w?w[N]:0;(!S||!(yield o.isElement==null?void 0:o.isElement(w)))&&(S=l.floating[N]||s.floating[p]);const _=F/2-E/2,U=S/2-g[p]/2-1,R=Xa(h[C],U),q=Xa(h[b],U),M=R,Y=S-g[p]-q,K=S/2-g[p]/2+_,de=hp(M,K,Y),pe=!u.arrow&&Hs(i)!=null&&K!==de&&s.reference[p]/2-(K<M?R:q)-g[p]/2<0,Ae=pe?K<M?K-M:K-Y:0;return{[x]:f[x]+Ae,data:H({[x]:de,centerOffset:K-de-Ae},pe&&{alignmentOffset:Ae}),reset:pe}})}}),xU=function(e){return e===void 0&&(e={}),{name:"flip",options:e,fn(r){return bt(this,null,function*(){var n,a;const{placement:i,middlewareData:s,rects:o,initialPlacement:l,platform:u,elements:c}=r,K=ba(e,r),{mainAxis:m=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:x="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0}=K,v=Ee(K,["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"]);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const C=Na(i),b=Gn(l),N=Na(l)===l,F=yield u.isRTL==null?void 0:u.isRTL(c.floating),E=f||(N||!g?[ju(l)]:lU(l)),w=p!=="none";!f&&w&&E.push(...dU(l,g,p,F));const S=[l,...E],_=yield Xo(r,v),U=[];let R=((a=s.flip)==null?void 0:a.overflows)||[];if(m&&U.push(_[C]),h){const de=oU(i,o,F);U.push(_[de[0]],_[de[1]])}if(R=[...R,{placement:i,overflows:U}],!U.every(de=>de<=0)){var q,M;const de=(((q=s.flip)==null?void 0:q.index)||0)+1,pe=S[de];if(pe&&(!(h==="alignment"?b!==Gn(pe):!1)||R.every(k=>Gn(k.placement)===b?k.overflows[0]>0:!0)))return{data:{index:de,overflows:R},reset:{placement:pe}};let Ae=(M=R.filter(Ne=>Ne.overflows[0]<=0).sort((Ne,k)=>Ne.overflows[1]-k.overflows[1])[0])==null?void 0:M.placement;if(!Ae)switch(x){case"bestFit":{var Y;const Ne=(Y=R.filter(k=>{if(w){const le=Gn(k.placement);return le===b||le==="y"}return!0}).map(k=>[k.placement,k.overflows.filter(le=>le>0).reduce((le,j)=>le+j,0)]).sort((k,le)=>k[1]-le[1])[0])==null?void 0:Y[0];Ne&&(Ae=Ne);break}case"initialPlacement":Ae=l;break}if(i!==Ae)return{reset:{placement:Ae}}}return{}})}}};function K1(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Q1(e){return nU.some(t=>e[t]>=0)}const gU=function(e){return e===void 0&&(e={}),{name:"hide",options:e,fn(r){return bt(this,null,function*(){const{rects:n}=r,s=ba(e,r),{strategy:a="referenceHidden"}=s,i=Ee(s,["strategy"]);switch(a){case"referenceHidden":{const o=yield Xo(r,he(H({},i),{elementContext:"reference"})),l=K1(o,n.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:Q1(l)}}}case"escaped":{const o=yield Xo(r,he(H({},i),{altBoundary:!0})),l=K1(o,n.floating);return{data:{escapedOffsets:l,escaped:Q1(l)}}}default:return{}}})}}},K_=new Set(["left","top"]);function vU(e,t){return bt(this,null,function*(){const{placement:r,platform:n,elements:a}=e,i=yield n.isRTL==null?void 0:n.isRTL(a.floating),s=Na(r),o=Hs(r),l=Gn(r)==="y",u=K_.has(s)?-1:1,c=i&&l?-1:1,m=ba(t,e);let{mainAxis:h,crossAxis:f,alignmentAxis:x}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return o&&typeof x=="number"&&(f=o==="end"?x*-1:x),l?{x:f*c,y:h*u}:{x:h*u,y:f*c}})}const bU=function(e){return e===void 0&&(e=0),{name:"offset",options:e,fn(r){return bt(this,null,function*(){var n,a;const{x:i,y:s,placement:o,middlewareData:l}=r,u=yield vU(r,e);return o===((n=l.offset)==null?void 0:n.placement)&&(a=l.arrow)!=null&&a.alignmentOffset?{}:{x:i+u.x,y:s+u.y,data:he(H({},u),{placement:o})}})}}},NU=function(e){return e===void 0&&(e={}),{name:"shift",options:e,fn(r){return bt(this,null,function*(){const{x:n,y:a,placement:i}=r,v=ba(e,r),{mainAxis:s=!0,crossAxis:o=!1,limiter:l={fn:C=>{let{x:b,y:N}=C;return{x:b,y:N}}}}=v,u=Ee(v,["mainAxis","crossAxis","limiter"]),c={x:n,y:a},m=yield Xo(r,u),h=Gn(Na(i)),f=Dx(h);let x=c[f],p=c[h];if(s){const C=f==="y"?"top":"left",b=f==="y"?"bottom":"right",N=x+m[C],F=x-m[b];x=hp(N,x,F)}if(o){const C=h==="y"?"top":"left",b=h==="y"?"bottom":"right",N=p+m[C],F=p-m[b];p=hp(N,p,F)}const g=l.fn(he(H({},r),{[f]:x,[h]:p}));return he(H({},g),{data:{x:g.x-n,y:g.y-a,enabled:{[f]:s,[h]:o}}})})}}},yU=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:i,middlewareData:s}=t,{offset:o=0,mainAxis:l=!0,crossAxis:u=!0}=ba(e,t),c={x:r,y:n},m=Gn(a),h=Dx(m);let f=c[h],x=c[m];const p=ba(o,t),g=typeof p=="number"?{mainAxis:p,crossAxis:0}:H({mainAxis:0,crossAxis:0},p);if(l){const b=h==="y"?"height":"width",N=i.reference[h]-i.floating[b]+g.mainAxis,F=i.reference[h]+i.reference[b]-g.mainAxis;f<N?f=N:f>F&&(f=F)}if(u){var v,C;const b=h==="y"?"width":"height",N=K_.has(Na(a)),F=i.reference[m]-i.floating[b]+(N&&((v=s.offset)==null?void 0:v[m])||0)+(N?0:g.crossAxis),E=i.reference[m]+i.reference[b]+(N?0:((C=s.offset)==null?void 0:C[m])||0)-(N?g.crossAxis:0);x<F?x=F:x>E&&(x=E)}return{[h]:f,[m]:x}}}},CU=function(e){return e===void 0&&(e={}),{name:"size",options:e,fn(r){return bt(this,null,function*(){var n,a;const{placement:i,rects:s,platform:o,elements:l}=r,R=ba(e,r),{apply:u=()=>{}}=R,c=Ee(R,["apply"]),m=yield Xo(r,c),h=Na(i),f=Hs(i),x=Gn(i)==="y",{width:p,height:g}=s.floating;let v,C;h==="top"||h==="bottom"?(v=h,C=f===((yield o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(C=h,v=f==="end"?"top":"bottom");const b=g-m.top-m.bottom,N=p-m.left-m.right,F=Xa(g-m[v],b),E=Xa(p-m[C],N),w=!r.middlewareData.shift;let S=F,_=E;if((n=r.middlewareData.shift)!=null&&n.enabled.x&&(_=N),(a=r.middlewareData.shift)!=null&&a.enabled.y&&(S=b),w&&!f){const q=Xr(m.left,0),M=Xr(m.right,0),Y=Xr(m.top,0),K=Xr(m.bottom,0);x?_=p-2*(q!==0||M!==0?q+M:Xr(m.left,m.right)):S=g-2*(Y!==0||K!==0?Y+K:Xr(m.top,m.bottom))}yield u(he(H({},r),{availableWidth:_,availableHeight:S}));const U=yield o.getDimensions(l.floating);return p!==U.width||g!==U.height?{reset:{rects:!0}}:{}})}}};function Sc(){return typeof window!="undefined"}function $s(e){return Q_(e)?(e.nodeName||"").toLowerCase():"#document"}function tn(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function ta(e){var t;return(t=(Q_(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Q_(e){return Sc()?e instanceof Node||e instanceof tn(e).Node:!1}function Rn(e){return Sc()?e instanceof Element||e instanceof tn(e).Element:!1}function Qn(e){return Sc()?e instanceof HTMLElement||e instanceof tn(e).HTMLElement:!1}function Z1(e){return!Sc()||typeof ShadowRoot=="undefined"?!1:e instanceof ShadowRoot||e instanceof tn(e).ShadowRoot}const wU=new Set(["inline","contents"]);function Nl(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=On(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!wU.has(a)}const EU=new Set(["table","td","th"]);function _U(e){return EU.has($s(e))}const SU=[":popover-open",":modal"];function Tc(e){return SU.some(t=>{try{return e.matches(t)}catch(r){return!1}})}const TU=["transform","translate","scale","rotate","perspective"],DU=["transform","translate","scale","rotate","perspective","filter"],AU=["paint","layout","strict","content"];function Fx(e){const t=Ux(),r=Rn(e)?On(e):e;return TU.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||DU.some(n=>(r.willChange||"").includes(n))||AU.some(n=>(r.contain||"").includes(n))}function kU(e){let t=Ka(e);for(;Qn(t)&&!Ls(t);){if(Fx(t))return t;if(Tc(t))return null;t=Ka(t)}return null}function Ux(){return typeof CSS=="undefined"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const FU=new Set(["html","body","#document"]);function Ls(e){return FU.has($s(e))}function On(e){return tn(e).getComputedStyle(e)}function Dc(e){return Rn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ka(e){if($s(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Z1(e)&&e.host||ta(e);return Z1(t)?t.host:t}function Z_(e){const t=Ka(e);return Ls(t)?e.ownerDocument?e.ownerDocument.body:e.body:Qn(t)&&Nl(t)?t:Z_(t)}function Ko(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=Z_(e),i=a===((n=e.ownerDocument)==null?void 0:n.body),s=tn(a);if(i){const o=xp(s);return t.concat(s,s.visualViewport||[],Nl(a)?a:[],o&&r?Ko(o):[])}return t.concat(a,Ko(a,[],r))}function xp(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function J_(e){const t=On(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Qn(e),i=a?e.offsetWidth:r,s=a?e.offsetHeight:n,o=Mu(r)!==i||Mu(n)!==s;return o&&(r=i,n=s),{width:r,height:n,$:o}}function Rx(e){return Rn(e)?e:e.contextElement}function ys(e){const t=Rx(e);if(!Qn(t))return Xn(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:i}=J_(t);let s=(i?Mu(r.width):r.width)/n,o=(i?Mu(r.height):r.height)/a;return(!s||!Number.isFinite(s))&&(s=1),(!o||!Number.isFinite(o))&&(o=1),{x:s,y:o}}const UU=Xn(0);function eS(e){const t=tn(e);return!Ux()||!t.visualViewport?UU:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function RU(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==tn(e)?!1:t}function ji(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),i=Rx(e);let s=Xn(1);t&&(n?Rn(n)&&(s=ys(n)):s=ys(e));const o=RU(i,r,n)?eS(i):Xn(0);let l=(a.left+o.x)/s.x,u=(a.top+o.y)/s.y,c=a.width/s.x,m=a.height/s.y;if(i){const h=tn(i),f=n&&Rn(n)?tn(n):n;let x=h,p=xp(x);for(;p&&n&&f!==x;){const g=ys(p),v=p.getBoundingClientRect(),C=On(p),b=v.left+(p.clientLeft+parseFloat(C.paddingLeft))*g.x,N=v.top+(p.clientTop+parseFloat(C.paddingTop))*g.y;l*=g.x,u*=g.y,c*=g.x,m*=g.y,l+=b,u+=N,x=tn(p),p=xp(x)}}return Lu({width:c,height:m,x:l,y:u})}function Ac(e,t){const r=Dc(e).scrollLeft;return t?t.left+r:ji(ta(e)).left+r}function tS(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-Ac(e,r),a=r.top+t.scrollTop;return{x:n,y:a}}function OU(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const i=a==="fixed",s=ta(n),o=t?Tc(t.floating):!1;if(n===s||o&&i)return r;let l={scrollLeft:0,scrollTop:0},u=Xn(1);const c=Xn(0),m=Qn(n);if((m||!m&&!i)&&(($s(n)!=="body"||Nl(s))&&(l=Dc(n)),Qn(n))){const f=ji(n);u=ys(n),c.x=f.x+n.clientLeft,c.y=f.y+n.clientTop}const h=s&&!m&&!i?tS(s,l):Xn(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-l.scrollLeft*u.x+c.x+h.x,y:r.y*u.y-l.scrollTop*u.y+c.y+h.y}}function VU(e){return Array.from(e.getClientRects())}function PU(e){const t=ta(e),r=Dc(e),n=e.ownerDocument.body,a=Xr(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=Xr(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let s=-r.scrollLeft+Ac(e);const o=-r.scrollTop;return On(n).direction==="rtl"&&(s+=Xr(t.clientWidth,n.clientWidth)-a),{width:a,height:i,x:s,y:o}}const J1=25;function IU(e,t){const r=tn(e),n=ta(e),a=r.visualViewport;let i=n.clientWidth,s=n.clientHeight,o=0,l=0;if(a){i=a.width,s=a.height;const c=Ux();(!c||c&&t==="fixed")&&(o=a.offsetLeft,l=a.offsetTop)}const u=Ac(n);if(u<=0){const c=n.ownerDocument,m=c.body,h=getComputedStyle(m),f=c.compatMode==="CSS1Compat"&&parseFloat(h.marginLeft)+parseFloat(h.marginRight)||0,x=Math.abs(n.clientWidth-m.clientWidth-f);x<=J1&&(i-=x)}else u<=J1&&(i+=u);return{width:i,height:s,x:o,y:l}}const MU=new Set(["absolute","fixed"]);function jU(e,t){const r=ji(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,i=Qn(e)?ys(e):Xn(1),s=e.clientWidth*i.x,o=e.clientHeight*i.y,l=a*i.x,u=n*i.y;return{width:s,height:o,x:l,y:u}}function ev(e,t,r){let n;if(t==="viewport")n=IU(e,r);else if(t==="document")n=PU(ta(e));else if(Rn(t))n=jU(t,r);else{const a=eS(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return Lu(n)}function rS(e,t){const r=Ka(e);return r===t||!Rn(r)||Ls(r)?!1:On(r).position==="fixed"||rS(r,t)}function LU(e,t){const r=t.get(e);if(r)return r;let n=Ko(e,[],!1).filter(o=>Rn(o)&&$s(o)!=="body"),a=null;const i=On(e).position==="fixed";let s=i?Ka(e):e;for(;Rn(s)&&!Ls(s);){const o=On(s),l=Fx(s);!l&&o.position==="fixed"&&(a=null),(i?!l&&!a:!l&&o.position==="static"&&!!a&&MU.has(a.position)||Nl(s)&&!l&&rS(e,s))?n=n.filter(c=>c!==s):a=o,s=Ka(s)}return t.set(e,n),n}function BU(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const s=[...r==="clippingAncestors"?Tc(t)?[]:LU(t,this._c):[].concat(r),n],o=s[0],l=s.reduce((u,c)=>{const m=ev(t,c,a);return u.top=Xr(m.top,u.top),u.right=Xa(m.right,u.right),u.bottom=Xa(m.bottom,u.bottom),u.left=Xr(m.left,u.left),u},ev(t,o,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function qU(e){const{width:t,height:r}=J_(e);return{width:t,height:r}}function zU(e,t,r){const n=Qn(t),a=ta(t),i=r==="fixed",s=ji(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=Xn(0);function u(){l.x=Ac(a)}if(n||!n&&!i)if(($s(t)!=="body"||Nl(a))&&(o=Dc(t)),n){const f=ji(t,!0,i,t);l.x=f.x+t.clientLeft,l.y=f.y+t.clientTop}else a&&u();i&&!n&&a&&u();const c=a&&!n&&!i?tS(a,o):Xn(0),m=s.left+o.scrollLeft-l.x-c.x,h=s.top+o.scrollTop-l.y-c.y;return{x:m,y:h,width:s.width,height:s.height}}function bm(e){return On(e).position==="static"}function tv(e,t){if(!Qn(e)||On(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return ta(e)===r&&(r=r.ownerDocument.body),r}function nS(e,t){const r=tn(e);if(Tc(e))return r;if(!Qn(e)){let a=Ka(e);for(;a&&!Ls(a);){if(Rn(a)&&!bm(a))return a;a=Ka(a)}return r}let n=tv(e,t);for(;n&&_U(n)&&bm(n);)n=tv(n,t);return n&&Ls(n)&&bm(n)&&!Fx(n)?r:n||kU(e)||r}const HU=function(e){return bt(this,null,function*(){const t=this.getOffsetParent||nS,r=this.getDimensions,n=yield r(e.floating);return{reference:zU(e.reference,yield t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}})};function $U(e){return On(e).direction==="rtl"}const WU={convertOffsetParentRelativeRectToViewportRelativeRect:OU,getDocumentElement:ta,getClippingRect:BU,getOffsetParent:nS,getElementRects:HU,getClientRects:VU,getDimensions:qU,getScale:ys,isElement:Rn,isRTL:$U};function aS(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function GU(e,t){let r=null,n;const a=ta(e);function i(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function s(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const u=e.getBoundingClientRect(),{left:c,top:m,width:h,height:f}=u;if(o||t(),!h||!f)return;const x=Kl(m),p=Kl(a.clientWidth-(c+h)),g=Kl(a.clientHeight-(m+f)),v=Kl(c),b={rootMargin:-x+"px "+-p+"px "+-g+"px "+-v+"px",threshold:Xr(0,Xa(1,l))||1};let N=!0;function F(E){const w=E[0].intersectionRatio;if(w!==l){if(!N)return s();w?s(!1,w):n=setTimeout(()=>{s(!1,1e-7)},1e3)}w===1&&!aS(u,e.getBoundingClientRect())&&s(),N=!1}try{r=new IntersectionObserver(F,he(H({},b),{root:a.ownerDocument}))}catch(E){r=new IntersectionObserver(F,b)}r.observe(e)}return s(!0),i}function pZ(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,u=Rx(e),c=a||i?[...u?Ko(u):[],...Ko(t)]:[];c.forEach(v=>{a&&v.addEventListener("scroll",r,{passive:!0}),i&&v.addEventListener("resize",r)});const m=u&&o?GU(u,r):null;let h=-1,f=null;s&&(f=new ResizeObserver(v=>{let[C]=v;C&&C.target===u&&f&&(f.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(t)})),r()}),u&&!l&&f.observe(u),f.observe(t));let x,p=l?ji(e):null;l&&g();function g(){const v=ji(e);p&&!aS(p,v)&&r(),p=v,x=requestAnimationFrame(g)}return r(),()=>{var v;c.forEach(C=>{a&&C.removeEventListener("scroll",r),i&&C.removeEventListener("resize",r)}),m==null||m(),(v=f)==null||v.disconnect(),f=null,l&&cancelAnimationFrame(x)}}const xZ=bU,gZ=NU,vZ=xU,bZ=CU,NZ=gU,yZ=pU,CZ=yU,wZ=(e,t,r)=>{const n=new Map,a=H({platform:WU},r),i=he(H({},a.platform),{_c:n});return hU(e,t,he(H({},a),{platform:i}))};var YU=function(e){if(typeof document=="undefined")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ss=new WeakMap,Ql=new WeakMap,Zl={},Nm=0,iS=function(e){return e&&(e.host||iS(e.parentNode))},XU=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=iS(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},KU=function(e,t,r,n){var a=XU(t,Array.isArray(e)?e:[e]);Zl[r]||(Zl[r]=new WeakMap);var i=Zl[r],s=[],o=new Set,l=new Set(a),u=function(m){!m||o.has(m)||(o.add(m),u(m.parentNode))};a.forEach(u);var c=function(m){!m||l.has(m)||Array.prototype.forEach.call(m.children,function(h){if(o.has(h))c(h);else try{var f=h.getAttribute(n),x=f!==null&&f!=="false",p=(ss.get(h)||0)+1,g=(i.get(h)||0)+1;ss.set(h,p),i.set(h,g),s.push(h),p===1&&x&&Ql.set(h,!0),g===1&&h.setAttribute(r,"true"),x||h.setAttribute(n,"true")}catch(v){console.error("aria-hidden: cannot operate on ",h,v)}})};return c(t),o.clear(),Nm++,function(){s.forEach(function(m){var h=ss.get(m)-1,f=i.get(m)-1;ss.set(m,h),i.set(m,f),h||(Ql.has(m)||m.removeAttribute(n),Ql.delete(m)),f||m.removeAttribute(r)}),Nm--,Nm||(ss=new WeakMap,ss=new WeakMap,Ql=new WeakMap,Zl={})}},EZ=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=YU(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),KU(n,a,r,"aria-hidden")):function(){return null}},Bu=function(){return Bu=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Bu.apply(this,arguments)};function QU(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function _Z(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function ym(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function ZU(e,t){var r=W.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var JU=typeof window!="undefined"?W.useLayoutEffect:W.useEffect,rv=new WeakMap;function SZ(e,t){var r=ZU(null,function(n){return e.forEach(function(a){return ym(a,n)})});return JU(function(){var n=rv.get(r);if(n){var a=new Set(n),i=new Set(e),s=r.current;a.forEach(function(o){i.has(o)||ym(o,null)}),i.forEach(function(o){a.has(o)||ym(o,s)})}rv.set(r,e)},[e]),r}function eR(e){return e}function tR(e,t){t===void 0&&(t=eR);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var s=t(i,n);return r.push(s),function(){r=r.filter(function(o){return o!==s})}},assignSyncMedium:function(i){for(n=!0;r.length;){var s=r;r=[],s.forEach(i)}r={push:function(o){return i(o)},filter:function(){return r}}},assignMedium:function(i){n=!0;var s=[];if(r.length){var o=r;r=[],o.forEach(i),s=r}var l=function(){var c=s;s=[],c.forEach(i)},u=function(){return Promise.resolve().then(l)};u(),r={push:function(c){s.push(c),u()},filter:function(c){return s=s.filter(c),r}}}};return a}function TZ(e){e===void 0&&(e={});var t=tR(null);return t.options=Bu({async:!0,ssr:!1},e),t}var sS=function(e){var t=e.sideCar,r=QU(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return W.createElement(n,Bu({},r))};sS.isSideCarExport=!0;function DZ(e,t){return e.useMedium(t),sS}var AZ=function(){if(typeof __webpack_nonce__!="undefined")return __webpack_nonce__};const Fo=vk,Uo=bk,Cs=W.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=Ee(i,["className","children"]);return d.jsxDEV(zE,he(H({ref:n,className:Fe("flex h-10 w-full items-center justify-between rounded-md bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground","transition-all duration-200 ease-out","border-3 border-[hsl(var(--border))] bg-[hsl(var(--card))] text-[hsl(var(--card-foreground))]","focus:outline-none focus:ring-0 focus:border-[hsl(var(--primary))] focus:shadow-[0_0_0_4px_hsl(var(--primary)_/_0.2)] focus:bg-[hsl(var(--background))]","hover:border-[hsl(var(--primary)_/_0.8)] hover:shadow-[0_0_0_2px_hsl(var(--primary)_/_0.1)]","disabled:cursor-not-allowed disabled:opacity-50","transform-gpu will-change-auto","[&>span]:line-clamp-1",e)},r),{children:[t,d.jsxDEV(Nk,{asChild:!0,children:d.jsxDEV(Fi,{className:"h-4 w-4 opacity-50"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:39,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:38,columnNumber:5},void 0)]}),void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:16,columnNumber:3},void 0)});Cs.displayName=zE.displayName;const oS=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(WE,he(H({ref:r,className:Fe("flex cursor-default items-center justify-center py-1",e)},t),{children:d.jsxDEV(GE,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:57,columnNumber:5},void 0)}),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:49,columnNumber:3},void 0)});oS.displayName=WE.displayName;const lS=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(YE,he(H({ref:r,className:Fe("flex cursor-default items-center justify-center py-1",e)},t),{children:d.jsxDEV(Fi,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:74,columnNumber:5},void 0)}),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:66,columnNumber:3},void 0)});lS.displayName=YE.displayName;const ws=W.forwardRef((i,a)=>{var s=i,{className:e,children:t,position:r="popper"}=s,n=Ee(s,["className","children","position"]);return d.jsxDEV(yk,{children:d.jsxDEV(HE,he(H({ref:a,className:Fe("relative z-[9999] max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-white text-gray-900 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r},n),{children:[d.jsxDEV(oS,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:96,columnNumber:7},void 0),d.jsxDEV(Ck,{className:Fe("p-1 bg-white",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:97,columnNumber:7},void 0),d.jsxDEV(lS,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:106,columnNumber:7},void 0)]}),void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:85,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:84,columnNumber:3},void 0)});ws.displayName=HE.displayName;const rR=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(XE,H({ref:r,className:Fe("py-1.5 pl-8 pr-2 text-sm font-semibold",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:116,columnNumber:3},void 0)});rR.displayName=XE.displayName;const An=W.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=Ee(i,["className","children"]);return d.jsxDEV($E,he(H({ref:n,className:Fe("relative flex w-full cursor-pointer select-none items-center rounded-sm py-2 pl-8 pr-4 text-sm bg-white text-gray-900 outline-none hover:bg-gray-100 focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e)},r),{children:[d.jsxDEV("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:d.jsxDEV(wk,{children:d.jsxDEV(vx,{className:"h-4 w-4 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:138,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:137,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:136,columnNumber:5},void 0),d.jsxDEV(Ek,{className:"truncate",children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:142,columnNumber:5},void 0)]}),void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:128,columnNumber:3},void 0)});An.displayName=$E.displayName;const nR=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(KE,H({ref:r,className:Fe("-mx-1 my-1 h-px bg-muted",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/select.tsx",lineNumber:151,columnNumber:3},void 0)});nR.displayName=KE.displayName;const kc=QE,uS=_k,aR=ZE,cS=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(Nx,H({ref:r,className:Fe("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:21,columnNumber:3},void 0)});cS.displayName=Nx.displayName;const yl=W.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=Ee(i,["className","children"]);return d.jsxDEV(aR,{children:[d.jsxDEV(cS,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:37,columnNumber:5},void 0),d.jsxDEV(bx,he(H({ref:n,className:Fe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e)},r),{children:[t,d.jsxDEV(Sk,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[d.jsxDEV(Ga,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:48,columnNumber:9},void 0),d.jsxDEV("span",{className:"sr-only",children:"Close"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:49,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:47,columnNumber:7},void 0)]}),void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:38,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:36,columnNumber:3},void 0)});yl.displayName=bx.displayName;const Cl=r=>{var n=r,{className:e}=n,t=Ee(n,["className"]);return d.jsxDEV("div",H({className:Fe("flex flex-col space-y-1.5 text-center sm:text-left",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:60,columnNumber:3},void 0)};Cl.displayName="DialogHeader";const mS=r=>{var n=r,{className:e}=n,t=Ee(n,["className"]);return d.jsxDEV("div",H({className:Fe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:74,columnNumber:3},void 0)};mS.displayName="DialogFooter";const wl=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(JE,H({ref:r,className:Fe("text-lg font-semibold leading-none tracking-tight",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:88,columnNumber:3},void 0)});wl.displayName=JE.displayName;const El=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(e_,H({ref:r,className:Fe("text-sm text-muted-foreground",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/dialog.tsx",lineNumber:103,columnNumber:3},void 0)});El.displayName=e_.displayName;function Jl(...e){return e.filter(Boolean).join(" ")}function kZ({title:e,children:t,defaultCollapsed:r=!0,className:n,titleClassName:a,contentClassName:i,disabled:s=!1}){const[o,l]=W.useState(r),u=()=>{s||l(!o)};return d.jsxDEV("div",{className:Jl("border border-gray-200 rounded-lg overflow-hidden",n||""),children:[d.jsxDEV("button",{type:"button",onClick:u,disabled:s,className:Jl("w-full justify-between p-4 h-auto font-medium text-left hover:bg-gray-50 border-none rounded-none flex items-center bg-transparent cursor-pointer",s?"cursor-not-allowed opacity-50":"",a||""),children:[d.jsxDEV("span",{className:"text-base",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:47,columnNumber:9},this),o?d.jsxDEV(yc,{className:"w-5 h-5 transition-transform duration-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:49,columnNumber:11},this):d.jsxDEV(Fi,{className:"w-5 h-5 transition-transform duration-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:51,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:37,columnNumber:7},this),d.jsxDEV("div",{className:Jl("transition-all duration-300 ease-in-out overflow-hidden",o?"max-h-0":"max-h-[2000px]"),children:d.jsxDEV("div",{className:Jl("p-4 pt-0",i||""),children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:61,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:55,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/collapsible-section.tsx",lineNumber:36,columnNumber:5},this)}const iR=W.forwardRef((r,t)=>{var e=Ee(r,[]);return d.jsxDEV("nav",H({ref:t,"aria-label":"breadcrumb"},e),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:12,columnNumber:26},void 0)});iR.displayName="Breadcrumb";const sR=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV("ol",H({ref:r,className:Fe("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:19,columnNumber:3},void 0)});sR.displayName="BreadcrumbList";const oR=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV("li",H({ref:r,className:Fe("inline-flex items-center gap-1.5",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:34,columnNumber:3},void 0)});oR.displayName="BreadcrumbItem";const lR=W.forwardRef((a,n)=>{var i=a,{asChild:e,className:t}=i,r=Ee(i,["asChild","className"]);const s=e?ME:"a";return d.jsxDEV(s,H({ref:n,className:Fe("transition-colors hover:text-foreground",t)},r),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:51,columnNumber:5},void 0)});lR.displayName="BreadcrumbLink";const uR=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV("span",H({ref:r,role:"link","aria-disabled":"true","aria-current":"page",className:Fe("font-normal text-foreground",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:64,columnNumber:3},void 0)});uR.displayName="BreadcrumbPage";const cR=n=>{var a=n,{children:e,className:t}=a,r=Ee(a,["children","className"]);return d.jsxDEV("li",he(H({role:"presentation","aria-hidden":"true",className:Fe("[&>svg]:w-3.5 [&>svg]:h-3.5",t)},r),{children:e!=null?e:d.jsxDEV(yc,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:86,columnNumber:18},void 0)}),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/breadcrumb.tsx",lineNumber:80,columnNumber:3},void 0)};cR.displayName="BreadcrumbSeparator";const nv=[{stars:1,label:"Unkempt Neglect",description:"Crisis"},{stars:2,label:"Moderate Dinginess",description:"Reactive"},{stars:3,label:"Casual Inattention",description:"Managed Care"},{stars:4,label:"Ordinary Tidiness",description:"Comprehensive Care"},{stars:5,label:"Orderly Spotlessness",description:"Showpiece Facility"}],mR=[{key:"floors",label:"Floors",criteria:{5:"Floors and base moldings shine and/or are bright and clean; colors are fresh. No dirt buildup in corners or along walls.",4:"Floors and base moldings shine and/or are bright and clean. There is no buildup in corners along walls, but there can be up to two days' worth of dust, dirt, stains, or streaks.",3:"Floors are swept or vacuumed clean, but upon close observation there can be stains. A buildup of dirt and/or floor finish in corners and along walls can be seen. There are dull spots and/or matted carpet in walking lanes. Base molding is dull and dingy with streaks or splashes.",2:"Floors are swept or vacuumed clean, but are dull, dingy, and stained. There is an obvious buildup of dirt and/or floor finish in corners and along walls. There is a dull path and/or obviously matted carpet in the walking lanes. Base molding is dull and dingy with streaks or splashes.",1:"Floors and carpet are dull, dirty, dingy, scuffed, and/or matted. There is a conspicuous buildup of old dirt and/or floor finish in corners and along walls. Base molding is dirty, stained, and streaked. Gum, stains, dirt, dust balls, and trash are broadcast."}},{key:"verticalHorizontalSurfaces",label:"Vertical and Horizontal Surfaces",criteria:{5:"All vertical and horizontal surfaces have a freshly cleaned or polished appearance and have no accumulation of dust, dirt, marks, streaks, smudges, or fingerprints. Windows, glass, sills, frames, and related surfaces are free of dust, smudges, fingerprints etc.",4:"All vertical and horizontal surfaces are clean, but marks, dust, smudges, and fingerprints are noticeable upon close observation. Windows appear clean, but on close inspection marks, dust, cobwebs may be found. Sills and frames may have visible dust, dirt, or cobwebs on them.",3:"All vertical and horizontal surfaces have obvious dust, dirt, marks, smudges, and fingerprints. Windows frames are dusty and dirty, window glass is acceptable but it is obvious they have not been cleaned.",2:"All vertical and horizontal surfaces have conspicuous dust, dirt, smudges, fingerprints, and marks. At a quick glance windows are visibly dirty.",1:"All vertical and horizontal surfaces have major accumulations of dust, dirt, smudges, and fingerprints, all of which will be difficult to remove. Lack of attention is obvious. Window glass has obvious smudges, dirt, and marks. Frames are visibly dirty, dusty, and cobwebs are appearing."}},{key:"ceiling",label:"Ceiling",criteria:{5:"Ceilings and air vents are clean and free of dust/debris including cobwebs. No deficiencies.",4:"Ceilings and air vents are clean but dust/debris/cobwebs are noticeable upon close inspection.",3:"Ceilings and air vents have obvious dust/debris/cobwebs.",2:"Ceilings and air vents have conspicuous dust/debris/cobwebs.",1:"Ceilings and air vents have major accumulation of dust/debris/cobwebs."}},{key:"restrooms",label:"Restrooms",criteria:{5:"Consistent Monitoring: Restrooms must be regularly checked for use and cleanliness. Stocked and Maintained: Supplies (soap, paper products, etc.) must be fully stocked at all times. Spotless and Polished: Surfaces must be free of dirt, smudges, and water stains, with polished fixtures and mirrors. Graffiti-Free: No graffiti or defacement is present. Pleasant Odor: Restrooms must have a fresh, pleasant scent with no unpleasant odors.",4:"Routine Monitoring: Restrooms are checked regularly but may have minor lapses between inspections. Adequately Stocked: Supplies are generally available, though occasional low stock may occur. Clean but Lived-In: Surfaces are mostly clean, but minor smudges, water spots, or streaks may be present. Graffiti-Free: No significant graffiti, though faint markings or minor blemishes may be visible. Neutral Odor: The restroom has no strong odorsâ€”neither noticeably fresh nor unpleasant.",3:"Infrequent Monitoring: Restrooms are checked sporadically, leading to noticeable gaps in maintenance. Partially Stocked: Supplies are inconsistentâ€”some items may be low or temporarily unavailable. Visible Wear: Surfaces show clear signs of use, including smudges, water spots, and minor grime. Minor Graffiti: Small or faint graffiti, scratches, or markings are present but not overwhelming. Slight Odor: A faint but noticeable stale or musty odor may be present, though not overpowering.",2:"Inconsistent Monitoring: Restrooms are rarely checked, leading to noticeable lapses in cleanliness and maintenance. Low Stock: Many supplies are missing, and those that remain are often running low. Dirty Surfaces: Surfaces show significant grime, stains, and streaks. Cleaning is overdue, and the overall appearance is visibly unkempt. Graffiti and Damage: Obvious graffiti, markings, or damage is present in several areas. Unpleasant Odor: A strong, unpleasant odor may be present, creating a noticeable discomfort for users.",1:"Rare or No Monitoring: Restrooms are infrequently checked or completely overlooked, leading to prolonged periods of neglect. No Stock: Essential supplies are completely absent or inadequate, with no immediate plans to restock. Filthy Surfaces: Surfaces are visibly dirty, with heavy stains, grime, and possibly mold or mildew. The overall environment is unsanitary. Extensive Graffiti and Damage: Graffiti, damage, or vandalism is widespread and has not been addressed. Strong, Offensive Odor: The restroom emits a strong, unpleasant odor, often foul, making the space uncomfortable and potentially unsanitary."}},{key:"customerSatisfaction",label:"Customer Satisfaction and Coordination",criteria:{5:"Proud of facilities, have a high level of trust for the custodial organization.",4:"Satisfied with custodial-related services, usually complimentary of custodial staff.",3:"Accustomed to basic level of custodial care. Generally able to perform mission duties. Lack of pride in physical environment.",2:"Generally critical of cost, responsiveness, and quality of custodial services.",1:"Consistent customer ridicule, mistrust of custodial services."}},{key:"trash",label:"Trash",criteria:{5:"Interior trash cans only hold daily waste, and are clean and free from odor. Dumpster area is free from litter, dumpsters are closed and if applicable after hours locked. Exterior grounds are free from litter, and exterior trash cans are well placed and maintained.",4:"Most interior trash cans only hold daily waste, and are largely clean and free from odor. Dumpster area is free from litter, dumpsters are closed and if applicable after hours locked. Exterior grounds have some litter but appear to be regularly tended to. Exterior trash cans are present, maintenance is frequency of emptying is unclear but acceptable.",3:"Interior trash is regularly cleared, some cans are ill maintained and have odor. Litter is present near dumpsters. Some litter is blowing around exterior and does not appear to be addressed on a regular basis.",2:"Trash containers smell, are stained and are frequently at capacity with old trash. Litter is present at dumpster area, dumpsters are poorly secured and contributing to exterior litter issues. Exterior litter is present and obvious.",1:"Trash containers smell, are stained and are overflowing with old trash. Dumpster areas are overflowing, litter is present near dumpsters and does not appear regularly cleaned. Exterior litter is present, and affecting the overall appearance of school."}},{key:"projectCleaning",label:"Project Cleaning",criteria:{5:"Break work scope is completed on time and regarded well by school based staff. Items are organized, prioritized, and presented by custodial team. Work exceeds expectations.",4:"Break work scope is mostly completed, however not on time and some work is shifted throughout year. Custodial team organizes most items. Work meets expectations.",3:"Priority break work items are completed, some are pushed to a later date. Items have been organized, prioritized, and presented by school and network. Most of the work meets expectations.",2:"Break work items must be requested and organized by school or network. Some items are not able to be completed. Completed work does not meet expectations.",1:"There are insufficient funds and staffing for project cleaning."}},{key:"activitySupport",label:"Activity Support",criteria:{5:"Activity (athletics, events, afterschool activities) support happens, and is planned along with the weekly routine. All comments are complimentary. Activity support compliments and does not impede regular work.",4:"Activity support happens, and is planned along with the weekly routine. Most comments are complimentary.",3:"Activity support happens, and is planned along with the weekly routine. Work at times do not meet customer expectations. Comments are generally complimentary. Activity support is at the expense of some other duties.",2:"Activity support happens, but staffing is not allocated. Support is done by redirecting staff away from normal custodial duties on a routine basis.",1:"Activity support happens ad hoc and often leads to duties not being completed."}},{key:"safetyCompliance",label:"Safety and Compliance",criteria:{5:"All chemicals are properly labeled, secured, and used in accordance with manufacturer instructions. Gas, propane, and highly combustible items are stored off site. Closets are organized and compliant with DHH regulations.",4:"Most chemicals are properly labeled, secured, and used in accordance with manufacturer instructions. Gas, propane, and highly combustible items are stored off site. Some disorganization and lack of tidiness in closets.",3:"Some chemicals are properly labeled, secured. Proper use of chemicals is not clear, visible misuse of chemicals such as buildup or material damage is present. Gas, propane, and highly combustible items are usually stored off site, though often after use left on campus. Closets are dirty, though organizational and safety systems appear to be present.",2:"Many chemicals not labeled. Proper use of chemicals is not clear, visible misuse of chemicals such as buildup or material damage is present. Gas, propane, and highly combustible items can be found on site. Closets are dirty, no apparent regular organization or safety assessment.",1:"Improper use and knowledge of chemicals is widespread. Closets are consistently disorganized, dirty, and lacking safety precautions. Combustible materials prohibited may be present. It is unclear if there are any organizational or safety systems in place."}},{key:"equipment",label:"Equipment",criteria:{5:"There is sufficient equipment, located within reasonable proximity to the responsible areas. Equipment is kept in good repair and is replaced as needed. Equipment is evaluated and optimized for the tasks at hand. Equipment is being used in facility with regularity.",4:"There is sufficient equipment, located within reasonable proximity to the responsible areas. Equipment is kept in good repair and is replaced as needed. Equipment is evaluated and optimized for the tasks at hand.",3:"There is sufficient equipment, located within reasonable proximity to the responsible areas. Equipment is replaced as needed, but may not be the optimal equipment for the tasks at hand.",2:"Equipment is frequently shared and transported and occasionally in disrepair, but there is a basic inventory of equipment on hand.",1:"There is no or minimal capital investment for custodial operations. Equipment is limited and in disrepair. Staff do not use available equipment and or not trained on operation."}},{key:"monitoring",label:"Monitoring",criteria:{5:"Real-Time Monitoring: A system is in place to track performance and cleanliness frequently, with some elements monitored in real time. Contract Alignment: Performance standards are fully aligned with the specifications outlined in the contract. Responsive Feedback: Feedback from schools is actively sought, quickly addressed, and incorporated into service improvements.",4:"Regular Monitoring: A system is in place to track performance and cleanliness at scheduled intervals, though not in real time. Contract Compliance: Performance generally aligns with contractual standards, with only occasional minor deviations. Feedback Incorporated: Feedback from schools is generally addressed in a timely manner and used to improve services.",3:"Periodic Monitoring: Performance is monitored intermittently, leading to some inconsistencies in cleanliness and efficiency. Partial Contract Compliance: Standards are mostly followed, but occasional oversights or delays occur. Reactive Feedback Response: Feedback from schools is addressed, but often with some delay.",2:"Infrequent Monitoring: Performance is rarely tracked, leading to noticeable inconsistencies. Contract Deviations: Several standards outlined in the contract are not being consistently met. Delayed Feedback Response: Feedback from schools is often ignored or addressed with significant delay.",1:"No Monitoring: Performance is rarely or never tracked, resulting in significant inefficiencies. Contract Non-Compliance: Most contractual standards are not being met. Disregarded Feedback: Feedback from schools is ignored or dismissed."}}];function FZ({message:e="Loading..."}){return d.jsxDEV("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",role:"status","aria-live":"polite","aria-label":e,children:d.jsxDEV("div",{className:"bg-card p-6 rounded-lg shadow-xl max-w-sm w-full mx-4",children:[d.jsxDEV("div",{className:"flex justify-center mb-4",children:d.jsxDEV("div",{className:"animate-spin h-12 w-12 border-4 border-primary border-t-transparent rounded-full","aria-hidden":"true"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:16,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:15,columnNumber:9},this),d.jsxDEV("p",{className:"text-center text-foreground font-medium text-lg",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:23,columnNumber:9},this),d.jsxDEV("span",{className:"sr-only",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:28,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:13,columnNumber:7},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/shared/LoadingOverlay.tsx",lineNumber:7,columnNumber:5},this)}const UZ=E_({school:Gr().min(1,"School is required").max(100,"School name too long"),date:Gr().min(1,"Date is required").refine(e=>!isNaN(Date.parse(e)),"Invalid date format"),inspectionType:To("single_room").default("single_room"),locationDescription:Gr().min(3,"Please describe the location (minimum 3 characters)").max(500,"Location description too long"),roomNumber:Gr().max(50,"Room number too long").optional().or(To("")),locationCategory:Gr().max(100,"Location category too long").optional().or(To("")),floors:bn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),verticalHorizontalSurfaces:bn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),ceiling:bn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),restrooms:bn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),customerSatisfaction:bn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),trash:bn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),projectCleaning:bn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),activitySupport:bn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),safetyCompliance:bn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),equipment:bn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),monitoring:bn().min(0,"Rating must be 0-5").max(5,"Rating must be 0-5").default(0),notes:Gr().max(5e3,"Notes too long").optional().or(To("")),images:__(Gr()).max(5,"Maximum 5 images allowed").default([])}),RZ={school:"",date:"",inspectionType:"single_room",locationDescription:"",roomNumber:"",locationCategory:"",floors:0,verticalHorizontalSurfaces:0,ceiling:0,restrooms:0,customerSatisfaction:0,trash:0,projectCleaning:0,activitySupport:0,safetyCompliance:0,equipment:0,monitoring:0,notes:"",images:[]},OZ=E_({inspectorName:Gr().min(1,"Inspector name is required").max(100,"Inspector name too long"),school:Gr().min(1,"School is required").max(100,"School name too long"),date:Gr().min(1,"Date is required").refine(e=>!isNaN(Date.parse(e)),"Invalid date format"),location:Gr().min(1,"Location is required").max(200,"Location too long"),locationDescription:Gr().max(500,"Location description too long").optional().or(To("")),notes:Gr().min(10,"Please provide a detailed description (minimum 10 characters)").max(5e3,"Notes too long"),images:__(cF(File)).max(5,"Maximum 5 images allowed").optional().default([])}),VZ={inspectorName:"",school:"",date:new Date().toISOString().split("T")[0],location:"",locationDescription:"",notes:"",images:[]};function PZ({status:e,lastSaved:t,errorMessage:r,className:n=""}){const[a,i]=W.useState("");W.useEffect(()=>{if(!t){i("");return}const u=()=>{const h=new Date().getTime()-t.getTime(),f=Math.floor(h/1e3),x=Math.floor(f/60);f<10?i("just now"):f<60?i(`${f}s ago`):x<60?i(`${x}m ago`):i(t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))};u();const c=setInterval(u,1e4);return()=>clearInterval(c)},[t]);const o=(()=>{switch(e){case"saving":return{icon:t_,text:"Saving...",bgColor:"bg-blue-100 border-blue-300",textColor:"text-blue-800",iconColor:"text-blue-600",animate:!0};case"saved":return{icon:vx,text:a?`Saved ${a}`:"Saved",bgColor:"bg-green-100 border-green-300",textColor:"text-green-800",iconColor:"text-green-600",animate:!1};case"error":return{icon:Fr,text:r||"Save failed",bgColor:"bg-red-100 border-red-300",textColor:"text-red-800",iconColor:"text-red-600",animate:!1};default:return{icon:xx,text:"Not saved",bgColor:"bg-gray-100 border-gray-300",textColor:"text-gray-700",iconColor:"text-gray-500",animate:!1}}})(),l=o.icon;return d.jsxDEV("div",{className:`fixed bottom-4 right-4 z-50 flex items-center gap-2 px-4 py-2 rounded-lg border-2 shadow-lg transition-all duration-200 ${o.bgColor} ${n}`,role:"status","aria-live":"polite",children:[d.jsxDEV(l,{className:`h-4 w-4 ${o.iconColor} ${o.animate?"animate-pulse":""}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/auto-save-indicator.tsx",lineNumber:102,columnNumber:7},this),d.jsxDEV("span",{className:`text-sm font-medium ${o.textColor}`,children:o.text},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/auto-save-indicator.tsx",lineNumber:105,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/auto-save-indicator.tsx",lineNumber:97,columnNumber:5},this)}const dS=W.forwardRef((i,a)=>{var s=i,{className:e,orientation:t="horizontal",decorative:r=!0}=s,n=Ee(s,["className","orientation","decorative"]);return d.jsxDEV(r_,H({ref:a,decorative:r,orientation:t,className:Fe("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e)},n),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/separator.tsx",lineNumber:13,columnNumber:5},void 0)});dS.displayName=r_.displayName;const dR=Tk,fS=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(n_,H({ref:r,className:Fe("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/tabs.tsx",lineNumber:12,columnNumber:3},void 0)});fS.displayName=n_.displayName;const gp=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(a_,H({ref:r,className:Fe("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/tabs.tsx",lineNumber:27,columnNumber:3},void 0)});gp.displayName=a_.displayName;const vp=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(i_,H({ref:r,className:Fe("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/tabs.tsx",lineNumber:42,columnNumber:3},void 0)});vp.displayName=i_.displayName;function IZ(r){var n=r,{className:e}=n,t=Ee(n,["className"]);return d.jsxDEV("div",H({className:Fe("animate-pulse rounded-md bg-muted",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/skeleton.tsx",lineNumber:8,columnNumber:5},this)}var Cm,av;function Br(){if(av)return Cm;av=1;var e=Array.isArray;return Cm=e,Cm}var wm,iv;function hS(){if(iv)return wm;iv=1;var e=typeof Do=="object"&&Do&&Do.Object===Object&&Do;return wm=e,wm}var Em,sv;function ra(){if(sv)return Em;sv=1;var e=hS(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return Em=r,Em}var _m,ov;function _l(){if(ov)return _m;ov=1;var e=ra(),t=e.Symbol;return _m=t,_m}var Sm,lv;function fR(){if(lv)return Sm;lv=1;var e=_l(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,a=e?e.toStringTag:void 0;function i(s){var o=r.call(s,a),l=s[a];try{s[a]=void 0;var u=!0}catch(m){}var c=n.call(s);return u&&(o?s[a]=l:delete s[a]),c}return Sm=i,Sm}var Tm,uv;function hR(){if(uv)return Tm;uv=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Tm=r,Tm}var Dm,cv;function Ta(){if(cv)return Dm;cv=1;var e=_l(),t=fR(),r=hR(),n="[object Null]",a="[object Undefined]",i=e?e.toStringTag:void 0;function s(o){return o==null?o===void 0?a:n:i&&i in Object(o)?t(o):r(o)}return Dm=s,Dm}var Am,mv;function Da(){if(mv)return Am;mv=1;function e(t){return t!=null&&typeof t=="object"}return Am=e,Am}var km,dv;function Ws(){if(dv)return km;dv=1;var e=Ta(),t=Da(),r="[object Symbol]";function n(a){return typeof a=="symbol"||t(a)&&e(a)==r}return km=n,km}var Fm,fv;function Ox(){if(fv)return Fm;fv=1;var e=Br(),t=Ws(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){if(e(i))return!1;var o=typeof i;return o=="number"||o=="symbol"||o=="boolean"||i==null||t(i)?!0:n.test(i)||!r.test(i)||s!=null&&i in Object(s)}return Fm=a,Fm}var Um,hv;function si(){if(hv)return Um;hv=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Um=e,Um}var Rm,pv;function Vx(){if(pv)return Rm;pv=1;var e=Ta(),t=si(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",i="[object Proxy]";function s(o){if(!t(o))return!1;var l=e(o);return l==n||l==a||l==r||l==i}return Rm=s,Rm}var Om,xv;function pR(){if(xv)return Om;xv=1;var e=ra(),t=e["__core-js_shared__"];return Om=t,Om}var Vm,gv;function xR(){if(gv)return Vm;gv=1;var e=pR(),t=(function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!t&&t in n}return Vm=r,Vm}var Pm,vv;function pS(){if(vv)return Pm;vv=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch(a){}try{return n+""}catch(a){}}return""}return Pm=r,Pm}var Im,bv;function gR(){if(bv)return Im;bv=1;var e=Vx(),t=xR(),r=si(),n=pS(),a=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,l=s.toString,u=o.hasOwnProperty,c=RegExp("^"+l.call(u).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function m(h){if(!r(h)||t(h))return!1;var f=e(h)?c:i;return f.test(n(h))}return Im=m,Im}var Mm,Nv;function vR(){if(Nv)return Mm;Nv=1;function e(t,r){return t==null?void 0:t[r]}return Mm=e,Mm}var jm,yv;function Gi(){if(yv)return jm;yv=1;var e=gR(),t=vR();function r(n,a){var i=t(n,a);return e(i)?i:void 0}return jm=r,jm}var Lm,Cv;function Fc(){if(Cv)return Lm;Cv=1;var e=Gi(),t=e(Object,"create");return Lm=t,Lm}var Bm,wv;function bR(){if(wv)return Bm;wv=1;var e=Fc();function t(){this.__data__=e?e(null):{},this.size=0}return Bm=t,Bm}var qm,Ev;function NR(){if(Ev)return qm;Ev=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return qm=e,qm}var zm,_v;function yR(){if(_v)return zm;_v=1;var e=Fc(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(i){var s=this.__data__;if(e){var o=s[i];return o===t?void 0:o}return n.call(s,i)?s[i]:void 0}return zm=a,zm}var Hm,Sv;function CR(){if(Sv)return Hm;Sv=1;var e=Fc(),t=Object.prototype,r=t.hasOwnProperty;function n(a){var i=this.__data__;return e?i[a]!==void 0:r.call(i,a)}return Hm=n,Hm}var $m,Tv;function wR(){if(Tv)return $m;Tv=1;var e=Fc(),t="__lodash_hash_undefined__";function r(n,a){var i=this.__data__;return this.size+=this.has(n)?0:1,i[n]=e&&a===void 0?t:a,this}return $m=r,$m}var Wm,Dv;function ER(){if(Dv)return Wm;Dv=1;var e=bR(),t=NR(),r=yR(),n=CR(),a=wR();function i(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,Wm=i,Wm}var Gm,Av;function _R(){if(Av)return Gm;Av=1;function e(){this.__data__=[],this.size=0}return Gm=e,Gm}var Ym,kv;function Px(){if(kv)return Ym;kv=1;function e(t,r){return t===r||t!==t&&r!==r}return Ym=e,Ym}var Xm,Fv;function Uc(){if(Fv)return Xm;Fv=1;var e=Px();function t(r,n){for(var a=r.length;a--;)if(e(r[a][0],n))return a;return-1}return Xm=t,Xm}var Km,Uv;function SR(){if(Uv)return Km;Uv=1;var e=Uc(),t=Array.prototype,r=t.splice;function n(a){var i=this.__data__,s=e(i,a);if(s<0)return!1;var o=i.length-1;return s==o?i.pop():r.call(i,s,1),--this.size,!0}return Km=n,Km}var Qm,Rv;function TR(){if(Rv)return Qm;Rv=1;var e=Uc();function t(r){var n=this.__data__,a=e(n,r);return a<0?void 0:n[a][1]}return Qm=t,Qm}var Zm,Ov;function DR(){if(Ov)return Zm;Ov=1;var e=Uc();function t(r){return e(this.__data__,r)>-1}return Zm=t,Zm}var Jm,Vv;function AR(){if(Vv)return Jm;Vv=1;var e=Uc();function t(r,n){var a=this.__data__,i=e(a,r);return i<0?(++this.size,a.push([r,n])):a[i][1]=n,this}return Jm=t,Jm}var ed,Pv;function Rc(){if(Pv)return ed;Pv=1;var e=_R(),t=SR(),r=TR(),n=DR(),a=AR();function i(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,ed=i,ed}var td,Iv;function Ix(){if(Iv)return td;Iv=1;var e=Gi(),t=ra(),r=e(t,"Map");return td=r,td}var rd,Mv;function kR(){if(Mv)return rd;Mv=1;var e=ER(),t=Rc(),r=Ix();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return rd=n,rd}var nd,jv;function FR(){if(jv)return nd;jv=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return nd=e,nd}var ad,Lv;function Oc(){if(Lv)return ad;Lv=1;var e=FR();function t(r,n){var a=r.__data__;return e(n)?a[typeof n=="string"?"string":"hash"]:a.map}return ad=t,ad}var id,Bv;function UR(){if(Bv)return id;Bv=1;var e=Oc();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return id=t,id}var sd,qv;function RR(){if(qv)return sd;qv=1;var e=Oc();function t(r){return e(this,r).get(r)}return sd=t,sd}var od,zv;function OR(){if(zv)return od;zv=1;var e=Oc();function t(r){return e(this,r).has(r)}return od=t,od}var ld,Hv;function VR(){if(Hv)return ld;Hv=1;var e=Oc();function t(r,n){var a=e(this,r),i=a.size;return a.set(r,n),this.size+=a.size==i?0:1,this}return ld=t,ld}var ud,$v;function Mx(){if($v)return ud;$v=1;var e=kR(),t=UR(),r=RR(),n=OR(),a=VR();function i(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,ud=i,ud}var cd,Wv;function xS(){if(Wv)return cd;Wv=1;var e=Mx(),t="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var i=function(){var s=arguments,o=a?a.apply(this,s):s[0],l=i.cache;if(l.has(o))return l.get(o);var u=n.apply(this,s);return i.cache=l.set(o,u)||l,u};return i.cache=new(r.Cache||e),i}return r.Cache=e,cd=r,cd}var md,Gv;function PR(){if(Gv)return md;Gv=1;var e=xS(),t=500;function r(n){var a=e(n,function(s){return i.size===t&&i.clear(),s}),i=a.cache;return a}return md=r,md}var dd,Yv;function IR(){if(Yv)return dd;Yv=1;var e=PR(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(a){var i=[];return a.charCodeAt(0)===46&&i.push(""),a.replace(t,function(s,o,l,u){i.push(l?u.replace(r,"$1"):o||s)}),i});return dd=n,dd}var fd,Xv;function jx(){if(Xv)return fd;Xv=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,i=Array(a);++n<a;)i[n]=r(t[n],n,t);return i}return fd=e,fd}var hd,Kv;function MR(){if(Kv)return hd;Kv=1;var e=_l(),t=jx(),r=Br(),n=Ws(),a=e?e.prototype:void 0,i=a?a.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return t(o,s)+"";if(n(o))return i?i.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return hd=s,hd}var pd,Qv;function gS(){if(Qv)return pd;Qv=1;var e=MR();function t(r){return r==null?"":e(r)}return pd=t,pd}var xd,Zv;function vS(){if(Zv)return xd;Zv=1;var e=Br(),t=Ox(),r=IR(),n=gS();function a(i,s){return e(i)?i:t(i,s)?[i]:r(n(i))}return xd=a,xd}var gd,Jv;function Vc(){if(Jv)return gd;Jv=1;var e=Ws();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return gd=t,gd}var vd,eb;function Lx(){if(eb)return vd;eb=1;var e=vS(),t=Vc();function r(n,a){a=e(a,n);for(var i=0,s=a.length;n!=null&&i<s;)n=n[t(a[i++])];return i&&i==s?n:void 0}return vd=r,vd}var bd,tb;function bS(){if(tb)return bd;tb=1;var e=Lx();function t(r,n,a){var i=r==null?void 0:e(r,n);return i===void 0?a:i}return bd=t,bd}var jR=bS();const MZ=at(jR);var Nd,rb;function LR(){if(rb)return Nd;rb=1;function e(t){return t==null}return Nd=e,Nd}var BR=LR();const jZ=at(BR);var yd,nb;function qR(){if(nb)return yd;nb=1;var e=Ta(),t=Br(),r=Da(),n="[object String]";function a(i){return typeof i=="string"||!t(i)&&r(i)&&e(i)==n}return yd=a,yd}var zR=qR();const LZ=at(zR);var HR=Vx();const BZ=at(HR);var $R=si();const qZ=at($R);var Cd,ab;function NS(){if(ab)return Cd;ab=1;var e=Ta(),t=Da(),r="[object Number]";function n(a){return typeof a=="number"||t(a)&&e(a)==r}return Cd=n,Cd}var wd,ib;function WR(){if(ib)return wd;ib=1;var e=NS();function t(r){return e(r)&&r!=+r}return wd=t,wd}var GR=WR();const zZ=at(GR);var YR=NS();const HZ=at(YR);var Ed,sb;function XR(){if(sb)return Ed;sb=1;function e(t,r,n){var a=-1,i=t.length;r<0&&(r=-r>i?0:i+r),n=n>i?i:n,n<0&&(n+=i),i=r>n?0:n-r>>>0,r>>>=0;for(var s=Array(i);++a<i;)s[a]=t[a+r];return s}return Ed=e,Ed}var _d,ob;function KR(){if(ob)return _d;ob=1;var e=XR();function t(r,n,a){var i=r.length;return a=a===void 0?i:a,!n&&a>=i?r:e(r,n,a)}return _d=t,_d}var Sd,lb;function yS(){if(lb)return Sd;lb=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,i="\\ufe0e\\ufe0f",s="\\u200d",o=RegExp("["+s+e+a+i+"]");function l(u){return o.test(u)}return Sd=l,Sd}var Td,ub;function QR(){if(ub)return Td;ub=1;function e(t){return t.split("")}return Td=e,Td}var Dd,cb;function ZR(){if(cb)return Dd;cb=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,i="\\ufe0e\\ufe0f",s="["+e+"]",o="["+a+"]",l="\\ud83c[\\udffb-\\udfff]",u="(?:"+o+"|"+l+")",c="[^"+e+"]",m="(?:\\ud83c[\\udde6-\\uddff]){2}",h="[\\ud800-\\udbff][\\udc00-\\udfff]",f="\\u200d",x=u+"?",p="["+i+"]?",g="(?:"+f+"(?:"+[c,m,h].join("|")+")"+p+x+")*",v=p+x+g,C="(?:"+[c+o+"?",o,m,h,s].join("|")+")",b=RegExp(l+"(?="+l+")|"+C+v,"g");function N(F){return F.match(b)||[]}return Dd=N,Dd}var Ad,mb;function JR(){if(mb)return Ad;mb=1;var e=QR(),t=yS(),r=ZR();function n(a){return t(a)?r(a):e(a)}return Ad=n,Ad}var kd,db;function eO(){if(db)return kd;db=1;var e=KR(),t=yS(),r=JR(),n=gS();function a(i){return function(s){s=n(s);var o=t(s)?r(s):void 0,l=o?o[0]:s.charAt(0),u=o?e(o,1).join(""):s.slice(1);return l[i]()+u}}return kd=a,kd}var Fd,fb;function tO(){if(fb)return Fd;fb=1;var e=eO(),t=e("toUpperCase");return Fd=t,Fd}var rO=tO();const $Z=at(rO);function _t(e){return function(){return e}}const CS=Math.cos,qu=Math.sin,Pn=Math.sqrt,zu=Math.PI,Pc=2*zu,bp=Math.PI,Np=2*bp,bi=1e-6,nO=Np-bi;function wS(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function aO(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return wS;const r=Wl(10,t);return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class iO{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?wS:aO(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,l=n-t,u=a-r,c=s-t,m=o-r,h=c*c+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>bi)if(!(Math.abs(m*l-u*c)>bi)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let f=n-s,x=a-o,p=l*l+u*u,g=f*f+x*x,v=Math.sqrt(p),C=Math.sqrt(h),b=i*Math.tan((bp-Math.acos((p+h-g)/(2*v*C)))/2),N=b/C,F=b/v;Math.abs(N-1)>bi&&this._append`L${t+N*c},${r+N*m}`,this._append`A${i},${i},0,0,${+(m*f>c*x)},${this._x1=t+F*l},${this._y1=r+F*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),l=n*Math.sin(a),u=t+o,c=r+l,m=1^s,h=s?a-i:i-a;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>bi||Math.abs(this._y1-c)>bi)&&this._append`L${u},${c}`,n&&(h<0&&(h=h%Np+Np),h>nO?this._append`A${n},${n},0,1,${m},${t-o},${r-l}A${n},${n},0,1,${m},${this._x1=u},${this._y1=c}`:h>bi&&this._append`A${n},${n},0,${+(h>=bp)},${m},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Bx(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new iO(t)}function qx(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ES(e){this._context=e}ES.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function _S(e){return new ES(e)}function SS(e){return e[0]}function TS(e){return e[1]}function sO(e,t){var r=_t(!0),n=null,a=_S,i=null,s=Bx(o);e=typeof e=="function"?e:e===void 0?SS:_t(e),t=typeof t=="function"?t:t===void 0?TS:_t(t);function o(l){var u,c=(l=qx(l)).length,m,h=!1,f;for(n==null&&(i=a(f=s())),u=0;u<=c;++u)!(u<c&&r(m=l[u],u,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(m,u,l),+t(m,u,l));if(f)return i=null,f+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:_t(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:_t(+l),o):t},o.defined=function(l){return arguments.length?(r=typeof l=="function"?l:_t(!!l),o):r},o.curve=function(l){return arguments.length?(a=l,n!=null&&(i=a(n)),o):a},o.context=function(l){return arguments.length?(l==null?n=i=null:i=a(n=l),o):n},o}function WZ(e,t,r){var n=null,a=_t(!0),i=null,s=_S,o=null,l=Bx(u);e=typeof e=="function"?e:e===void 0?SS:_t(+e),t=typeof t=="function"?t:_t(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?TS:_t(+r);function u(m){var h,f,x,p=(m=qx(m)).length,g,v=!1,C,b=new Array(p),N=new Array(p);for(i==null&&(o=s(C=l())),h=0;h<=p;++h){if(!(h<p&&a(g=m[h],h,m))===v)if(v=!v)f=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),x=h-1;x>=f;--x)o.point(b[x],N[x]);o.lineEnd(),o.areaEnd()}v&&(b[h]=+e(g,h,m),N[h]=+t(g,h,m),o.point(n?+n(g,h,m):b[h],r?+r(g,h,m):N[h]))}if(C)return o=null,C+""||null}function c(){return sO().defined(a).curve(s).context(i)}return u.x=function(m){return arguments.length?(e=typeof m=="function"?m:_t(+m),n=null,u):e},u.x0=function(m){return arguments.length?(e=typeof m=="function"?m:_t(+m),u):e},u.x1=function(m){return arguments.length?(n=m==null?null:typeof m=="function"?m:_t(+m),u):n},u.y=function(m){return arguments.length?(t=typeof m=="function"?m:_t(+m),r=null,u):t},u.y0=function(m){return arguments.length?(t=typeof m=="function"?m:_t(+m),u):t},u.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:_t(+m),u):r},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(r)},u.lineX1=function(){return c().x(n).y(t)},u.defined=function(m){return arguments.length?(a=typeof m=="function"?m:_t(!!m),u):a},u.curve=function(m){return arguments.length?(s=m,i!=null&&(o=s(i)),u):s},u.context=function(m){return arguments.length?(m==null?i=o=null:o=s(i=m),u):i},u}class DS{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function GZ(e){return new DS(e,!0)}function YZ(e){return new DS(e,!1)}const oO={draw(e,t){const r=Pn(t/zu);e.moveTo(r,0),e.arc(0,0,r,0,Pc)}},XZ={draw(e,t){const r=Pn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},AS=Pn(1/3),lO=AS*2,KZ={draw(e,t){const r=Pn(t/lO),n=r*AS;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},QZ={draw(e,t){const r=Pn(t),n=-r/2;e.rect(n,n,r,r)}},uO=.8908130915292852,kS=qu(zu/10)/qu(7*zu/10),cO=qu(Pc/10)*kS,mO=-CS(Pc/10)*kS,ZZ={draw(e,t){const r=Pn(t*uO),n=cO*r,a=mO*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=Pc*i/5,o=CS(s),l=qu(s);e.lineTo(l*r,-o*r),e.lineTo(o*n-l*a,l*n+o*a)}e.closePath()}},Ud=Pn(3),JZ={draw(e,t){const r=-Pn(t/(Ud*3));e.moveTo(0,r*2),e.lineTo(-Ud*r,-r),e.lineTo(Ud*r,-r),e.closePath()}},an=-.5,sn=Pn(3)/2,yp=1/Pn(12),dO=(yp/2+1)*3,eJ={draw(e,t){const r=Pn(t/dO),n=r/2,a=r*yp,i=n,s=r*yp+r,o=-i,l=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(o,l),e.lineTo(an*n-sn*a,sn*n+an*a),e.lineTo(an*i-sn*s,sn*i+an*s),e.lineTo(an*o-sn*l,sn*o+an*l),e.lineTo(an*n+sn*a,an*a-sn*n),e.lineTo(an*i+sn*s,an*s-sn*i),e.lineTo(an*o+sn*l,an*l-sn*o),e.closePath()}};function tJ(e,t){let r=null,n=Bx(a);e=typeof e=="function"?e:_t(e||oO),t=typeof t=="function"?t:_t(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:_t(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:_t(+i),a):t},a.context=function(i){return arguments.length?(r=i==null?null:i,a):r},a}function Hu(){}function $u(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function FS(e){this._context=e}FS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$u(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$u(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rJ(e){return new FS(e)}function US(e){this._context=e}US.prototype={areaStart:Hu,areaEnd:Hu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:$u(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function nJ(e){return new US(e)}function RS(e){this._context=e}RS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:$u(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function aJ(e){return new RS(e)}function OS(e){this._context=e}OS.prototype={areaStart:Hu,areaEnd:Hu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function iJ(e){return new OS(e)}function hb(e){return e<0?-1:1}function pb(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(hb(i)+hb(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function xb(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Rd(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-n)/3;e._context.bezierCurveTo(n+o,a+o*t,i-o,s-o*r,i,s)}function Wu(e){this._context=e}Wu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Rd(this,this._t0,xb(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Rd(this,xb(this,r=pb(this,e,t)),r);break;default:Rd(this,this._t0,r=pb(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function VS(e){this._context=new PS(e)}(VS.prototype=Object.create(Wu.prototype)).point=function(e,t){Wu.prototype.point.call(this,t,e)};function PS(e){this._context=e}PS.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function sJ(e){return new Wu(e)}function oJ(e){return new VS(e)}function IS(e){this._context=e}IS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=gb(e),a=gb(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function gb(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function lJ(e){return new IS(e)}function Ic(e,t){this._context=e,this._t=t}Ic.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function uJ(e){return new Ic(e,.5)}function cJ(e){return new Ic(e,0)}function mJ(e){return new Ic(e,1)}function Qo(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,o=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function vb(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function fO(e,t){return e[t]}function hO(e){const t=[];return t.key=e,t}function dJ(){var e=_t([]),t=vb,r=Qo,n=fO;function a(i){var s=Array.from(e.apply(this,arguments),hO),o,l=s.length,u=-1,c;for(const m of i)for(o=0,++u;o<l;++o)(s[o][u]=[0,+n(m,s[o].key,u,i)]).data=m;for(o=0,c=qx(t(s));o<l;++o)s[c[o]].index=o;return r(s,c),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:_t(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:_t(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?vb:typeof i=="function"?i:_t(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i==null?Qo:i,a):r},a}function fJ(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}Qo(e,t)}}function hJ(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Qo(e,t)}}function pJ(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,l=0,u=0;o<s;++o){for(var c=e[t[o]],m=c[n][1]||0,h=c[n-1][1]||0,f=(m-h)/2,x=0;x<o;++x){var p=e[t[x]],g=p[n][1]||0,v=p[n-1][1]||0;f+=g-v}l+=m,u+=f*m}a[n-1][1]+=a[n-1][0]=r,l&&(r-=u/l)}a[n-1][1]+=a[n-1][0]=r,Qo(e,t)}}var Od,bb;function pO(){if(bb)return Od;bb=1;var e=Rc();function t(){this.__data__=new e,this.size=0}return Od=t,Od}var Vd,Nb;function xO(){if(Nb)return Vd;Nb=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return Vd=e,Vd}var Pd,yb;function gO(){if(yb)return Pd;yb=1;function e(t){return this.__data__.get(t)}return Pd=e,Pd}var Id,Cb;function vO(){if(Cb)return Id;Cb=1;function e(t){return this.__data__.has(t)}return Id=e,Id}var Md,wb;function bO(){if(wb)return Md;wb=1;var e=Rc(),t=Ix(),r=Mx(),n=200;function a(i,s){var o=this.__data__;if(o instanceof e){var l=o.__data__;if(!t||l.length<n-1)return l.push([i,s]),this.size=++o.size,this;o=this.__data__=new r(l)}return o.set(i,s),this.size=o.size,this}return Md=a,Md}var jd,Eb;function MS(){if(Eb)return jd;Eb=1;var e=Rc(),t=pO(),r=xO(),n=gO(),a=vO(),i=bO();function s(o){var l=this.__data__=new e(o);this.size=l.size}return s.prototype.clear=t,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=a,s.prototype.set=i,jd=s,jd}var Ld,_b;function NO(){if(_b)return Ld;_b=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return Ld=t,Ld}var Bd,Sb;function yO(){if(Sb)return Bd;Sb=1;function e(t){return this.__data__.has(t)}return Bd=e,Bd}var qd,Tb;function jS(){if(Tb)return qd;Tb=1;var e=Mx(),t=NO(),r=yO();function n(a){var i=-1,s=a==null?0:a.length;for(this.__data__=new e;++i<s;)this.add(a[i])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,qd=n,qd}var zd,Db;function LS(){if(Db)return zd;Db=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(r(t[n],n,t))return!0;return!1}return zd=e,zd}var Hd,Ab;function BS(){if(Ab)return Hd;Ab=1;function e(t,r){return t.has(r)}return Hd=e,Hd}var $d,kb;function qS(){if(kb)return $d;kb=1;var e=jS(),t=LS(),r=BS(),n=1,a=2;function i(s,o,l,u,c,m){var h=l&n,f=s.length,x=o.length;if(f!=x&&!(h&&x>f))return!1;var p=m.get(s),g=m.get(o);if(p&&g)return p==o&&g==s;var v=-1,C=!0,b=l&a?new e:void 0;for(m.set(s,o),m.set(o,s);++v<f;){var N=s[v],F=o[v];if(u)var E=h?u(F,N,v,o,s,m):u(N,F,v,s,o,m);if(E!==void 0){if(E)continue;C=!1;break}if(b){if(!t(o,function(w,S){if(!r(b,S)&&(N===w||c(N,w,l,u,m)))return b.push(S)})){C=!1;break}}else if(!(N===F||c(N,F,l,u,m))){C=!1;break}}return m.delete(s),m.delete(o),C}return $d=i,$d}var Wd,Fb;function CO(){if(Fb)return Wd;Fb=1;var e=ra(),t=e.Uint8Array;return Wd=t,Wd}var Gd,Ub;function wO(){if(Ub)return Gd;Ub=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a,i){n[++r]=[i,a]}),n}return Gd=e,Gd}var Yd,Rb;function zx(){if(Rb)return Yd;Rb=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a){n[++r]=a}),n}return Yd=e,Yd}var Xd,Ob;function EO(){if(Ob)return Xd;Ob=1;var e=_l(),t=CO(),r=Px(),n=qS(),a=wO(),i=zx(),s=1,o=2,l="[object Boolean]",u="[object Date]",c="[object Error]",m="[object Map]",h="[object Number]",f="[object RegExp]",x="[object Set]",p="[object String]",g="[object Symbol]",v="[object ArrayBuffer]",C="[object DataView]",b=e?e.prototype:void 0,N=b?b.valueOf:void 0;function F(E,w,S,_,U,R,q){switch(S){case C:if(E.byteLength!=w.byteLength||E.byteOffset!=w.byteOffset)return!1;E=E.buffer,w=w.buffer;case v:return!(E.byteLength!=w.byteLength||!R(new t(E),new t(w)));case l:case u:case h:return r(+E,+w);case c:return E.name==w.name&&E.message==w.message;case f:case p:return E==w+"";case m:var M=a;case x:var Y=_&s;if(M||(M=i),E.size!=w.size&&!Y)return!1;var K=q.get(E);if(K)return K==w;_|=o,q.set(E,w);var de=n(M(E),M(w),_,U,R,q);return q.delete(E),de;case g:if(N)return N.call(E)==N.call(w)}return!1}return Xd=F,Xd}var Kd,Vb;function zS(){if(Vb)return Kd;Vb=1;function e(t,r){for(var n=-1,a=r.length,i=t.length;++n<a;)t[i+n]=r[n];return t}return Kd=e,Kd}var Qd,Pb;function _O(){if(Pb)return Qd;Pb=1;var e=zS(),t=Br();function r(n,a,i){var s=a(n);return t(n)?s:e(s,i(n))}return Qd=r,Qd}var Zd,Ib;function SO(){if(Ib)return Zd;Ib=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,i=0,s=[];++n<a;){var o=t[n];r(o,n,t)&&(s[i++]=o)}return s}return Zd=e,Zd}var Jd,Mb;function TO(){if(Mb)return Jd;Mb=1;function e(){return[]}return Jd=e,Jd}var ef,jb;function DO(){if(jb)return ef;jb=1;var e=SO(),t=TO(),r=Object.prototype,n=r.propertyIsEnumerable,a=Object.getOwnPropertySymbols,i=a?function(s){return s==null?[]:(s=Object(s),e(a(s),function(o){return n.call(s,o)}))}:t;return ef=i,ef}var tf,Lb;function AO(){if(Lb)return tf;Lb=1;function e(t,r){for(var n=-1,a=Array(t);++n<t;)a[n]=r(n);return a}return tf=e,tf}var rf,Bb;function kO(){if(Bb)return rf;Bb=1;var e=Ta(),t=Da(),r="[object Arguments]";function n(a){return t(a)&&e(a)==r}return rf=n,rf}var nf,qb;function Hx(){if(qb)return nf;qb=1;var e=kO(),t=Da(),r=Object.prototype,n=r.hasOwnProperty,a=r.propertyIsEnumerable,i=e((function(){return arguments})())?e:function(s){return t(s)&&n.call(s,"callee")&&!a.call(s,"callee")};return nf=i,nf}var eu={exports:{}},af,zb;function FO(){if(zb)return af;zb=1;function e(){return!1}return af=e,af}var Hb;function HS(){return Hb||(Hb=1,(function(e,t){var r=ra(),n=FO(),a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,o=s?r.Buffer:void 0,l=o?o.isBuffer:void 0,u=l||n;e.exports=u})(eu,eu.exports)),eu.exports}var sf,$b;function $x(){if($b)return sf;$b=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,a){var i=typeof n;return a=a==null?e:a,!!a&&(i=="number"||i!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<a}return sf=r,sf}var of,Wb;function Wx(){if(Wb)return of;Wb=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return of=t,of}var lf,Gb;function UO(){if(Gb)return lf;Gb=1;var e=Ta(),t=Wx(),r=Da(),n="[object Arguments]",a="[object Array]",i="[object Boolean]",s="[object Date]",o="[object Error]",l="[object Function]",u="[object Map]",c="[object Number]",m="[object Object]",h="[object RegExp]",f="[object Set]",x="[object String]",p="[object WeakMap]",g="[object ArrayBuffer]",v="[object DataView]",C="[object Float32Array]",b="[object Float64Array]",N="[object Int8Array]",F="[object Int16Array]",E="[object Int32Array]",w="[object Uint8Array]",S="[object Uint8ClampedArray]",_="[object Uint16Array]",U="[object Uint32Array]",R={};R[C]=R[b]=R[N]=R[F]=R[E]=R[w]=R[S]=R[_]=R[U]=!0,R[n]=R[a]=R[g]=R[i]=R[v]=R[s]=R[o]=R[l]=R[u]=R[c]=R[m]=R[h]=R[f]=R[x]=R[p]=!1;function q(M){return r(M)&&t(M.length)&&!!R[e(M)]}return lf=q,lf}var uf,Yb;function $S(){if(Yb)return uf;Yb=1;function e(t){return function(r){return t(r)}}return uf=e,uf}var tu={exports:{}},Xb;function RO(){return Xb||(Xb=1,(function(e,t){var r=hS(),n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&r.process,o=(function(){try{var l=a&&a.require&&a.require("util").types;return l||s&&s.binding&&s.binding("util")}catch(u){}})();e.exports=o})(tu,tu.exports)),tu.exports}var cf,Kb;function WS(){if(Kb)return cf;Kb=1;var e=UO(),t=$S(),r=RO(),n=r&&r.isTypedArray,a=n?t(n):e;return cf=a,cf}var mf,Qb;function OO(){if(Qb)return mf;Qb=1;var e=AO(),t=Hx(),r=Br(),n=HS(),a=$x(),i=WS(),s=Object.prototype,o=s.hasOwnProperty;function l(u,c){var m=r(u),h=!m&&t(u),f=!m&&!h&&n(u),x=!m&&!h&&!f&&i(u),p=m||h||f||x,g=p?e(u.length,String):[],v=g.length;for(var C in u)(c||o.call(u,C))&&!(p&&(C=="length"||f&&(C=="offset"||C=="parent")||x&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||a(C,v)))&&g.push(C);return g}return mf=l,mf}var df,Zb;function VO(){if(Zb)return df;Zb=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||e;return r===a}return df=t,df}var ff,Jb;function GS(){if(Jb)return ff;Jb=1;function e(t,r){return function(n){return t(r(n))}}return ff=e,ff}var hf,eN;function PO(){if(eN)return hf;eN=1;var e=GS(),t=e(Object.keys,Object);return hf=t,hf}var pf,tN;function IO(){if(tN)return pf;tN=1;var e=VO(),t=PO(),r=Object.prototype,n=r.hasOwnProperty;function a(i){if(!e(i))return t(i);var s=[];for(var o in Object(i))n.call(i,o)&&o!="constructor"&&s.push(o);return s}return pf=a,pf}var xf,rN;function Sl(){if(rN)return xf;rN=1;var e=Vx(),t=Wx();function r(n){return n!=null&&t(n.length)&&!e(n)}return xf=r,xf}var gf,nN;function Mc(){if(nN)return gf;nN=1;var e=OO(),t=IO(),r=Sl();function n(a){return r(a)?e(a):t(a)}return gf=n,gf}var vf,aN;function MO(){if(aN)return vf;aN=1;var e=_O(),t=DO(),r=Mc();function n(a){return e(a,r,t)}return vf=n,vf}var bf,iN;function jO(){if(iN)return bf;iN=1;var e=MO(),t=1,r=Object.prototype,n=r.hasOwnProperty;function a(i,s,o,l,u,c){var m=o&t,h=e(i),f=h.length,x=e(s),p=x.length;if(f!=p&&!m)return!1;for(var g=f;g--;){var v=h[g];if(!(m?v in s:n.call(s,v)))return!1}var C=c.get(i),b=c.get(s);if(C&&b)return C==s&&b==i;var N=!0;c.set(i,s),c.set(s,i);for(var F=m;++g<f;){v=h[g];var E=i[v],w=s[v];if(l)var S=m?l(w,E,v,s,i,c):l(E,w,v,i,s,c);if(!(S===void 0?E===w||u(E,w,o,l,c):S)){N=!1;break}F||(F=v=="constructor")}if(N&&!F){var _=i.constructor,U=s.constructor;_!=U&&"constructor"in i&&"constructor"in s&&!(typeof _=="function"&&_ instanceof _&&typeof U=="function"&&U instanceof U)&&(N=!1)}return c.delete(i),c.delete(s),N}return bf=a,bf}var Nf,sN;function LO(){if(sN)return Nf;sN=1;var e=Gi(),t=ra(),r=e(t,"DataView");return Nf=r,Nf}var yf,oN;function BO(){if(oN)return yf;oN=1;var e=Gi(),t=ra(),r=e(t,"Promise");return yf=r,yf}var Cf,lN;function YS(){if(lN)return Cf;lN=1;var e=Gi(),t=ra(),r=e(t,"Set");return Cf=r,Cf}var wf,uN;function qO(){if(uN)return wf;uN=1;var e=Gi(),t=ra(),r=e(t,"WeakMap");return wf=r,wf}var Ef,cN;function zO(){if(cN)return Ef;cN=1;var e=LO(),t=Ix(),r=BO(),n=YS(),a=qO(),i=Ta(),s=pS(),o="[object Map]",l="[object Object]",u="[object Promise]",c="[object Set]",m="[object WeakMap]",h="[object DataView]",f=s(e),x=s(t),p=s(r),g=s(n),v=s(a),C=i;return(e&&C(new e(new ArrayBuffer(1)))!=h||t&&C(new t)!=o||r&&C(r.resolve())!=u||n&&C(new n)!=c||a&&C(new a)!=m)&&(C=function(b){var N=i(b),F=N==l?b.constructor:void 0,E=F?s(F):"";if(E)switch(E){case f:return h;case x:return o;case p:return u;case g:return c;case v:return m}return N}),Ef=C,Ef}var _f,mN;function HO(){if(mN)return _f;mN=1;var e=MS(),t=qS(),r=EO(),n=jO(),a=zO(),i=Br(),s=HS(),o=WS(),l=1,u="[object Arguments]",c="[object Array]",m="[object Object]",h=Object.prototype,f=h.hasOwnProperty;function x(p,g,v,C,b,N){var F=i(p),E=i(g),w=F?c:a(p),S=E?c:a(g);w=w==u?m:w,S=S==u?m:S;var _=w==m,U=S==m,R=w==S;if(R&&s(p)){if(!s(g))return!1;F=!0,_=!1}if(R&&!_)return N||(N=new e),F||o(p)?t(p,g,v,C,b,N):r(p,g,w,v,C,b,N);if(!(v&l)){var q=_&&f.call(p,"__wrapped__"),M=U&&f.call(g,"__wrapped__");if(q||M){var Y=q?p.value():p,K=M?g.value():g;return N||(N=new e),b(Y,K,v,C,N)}}return R?(N||(N=new e),n(p,g,v,C,b,N)):!1}return _f=x,_f}var Sf,dN;function Gx(){if(dN)return Sf;dN=1;var e=HO(),t=Da();function r(n,a,i,s,o){return n===a?!0:n==null||a==null||!t(n)&&!t(a)?n!==n&&a!==a:e(n,a,i,s,r,o)}return Sf=r,Sf}var Tf,fN;function $O(){if(fN)return Tf;fN=1;var e=MS(),t=Gx(),r=1,n=2;function a(i,s,o,l){var u=o.length,c=u,m=!l;if(i==null)return!c;for(i=Object(i);u--;){var h=o[u];if(m&&h[2]?h[1]!==i[h[0]]:!(h[0]in i))return!1}for(;++u<c;){h=o[u];var f=h[0],x=i[f],p=h[1];if(m&&h[2]){if(x===void 0&&!(f in i))return!1}else{var g=new e;if(l)var v=l(x,p,f,i,s,g);if(!(v===void 0?t(p,x,r|n,l,g):v))return!1}}return!0}return Tf=a,Tf}var Df,hN;function XS(){if(hN)return Df;hN=1;var e=si();function t(r){return r===r&&!e(r)}return Df=t,Df}var Af,pN;function WO(){if(pN)return Af;pN=1;var e=XS(),t=Mc();function r(n){for(var a=t(n),i=a.length;i--;){var s=a[i],o=n[s];a[i]=[s,o,e(o)]}return a}return Af=r,Af}var kf,xN;function KS(){if(xN)return kf;xN=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return kf=e,kf}var Ff,gN;function GO(){if(gN)return Ff;gN=1;var e=$O(),t=WO(),r=KS();function n(a){var i=t(a);return i.length==1&&i[0][2]?r(i[0][0],i[0][1]):function(s){return s===a||e(s,a,i)}}return Ff=n,Ff}var Uf,vN;function YO(){if(vN)return Uf;vN=1;function e(t,r){return t!=null&&r in Object(t)}return Uf=e,Uf}var Rf,bN;function XO(){if(bN)return Rf;bN=1;var e=vS(),t=Hx(),r=Br(),n=$x(),a=Wx(),i=Vc();function s(o,l,u){l=e(l,o);for(var c=-1,m=l.length,h=!1;++c<m;){var f=i(l[c]);if(!(h=o!=null&&u(o,f)))break;o=o[f]}return h||++c!=m?h:(m=o==null?0:o.length,!!m&&a(m)&&n(f,m)&&(r(o)||t(o)))}return Rf=s,Rf}var Of,NN;function KO(){if(NN)return Of;NN=1;var e=YO(),t=XO();function r(n,a){return n!=null&&t(n,a,e)}return Of=r,Of}var Vf,yN;function QO(){if(yN)return Vf;yN=1;var e=Gx(),t=bS(),r=KO(),n=Ox(),a=XS(),i=KS(),s=Vc(),o=1,l=2;function u(c,m){return n(c)&&a(m)?i(s(c),m):function(h){var f=t(h,c);return f===void 0&&f===m?r(h,c):e(m,f,o|l)}}return Vf=u,Vf}var Pf,CN;function Gs(){if(CN)return Pf;CN=1;function e(t){return t}return Pf=e,Pf}var If,wN;function ZO(){if(wN)return If;wN=1;function e(t){return function(r){return r==null?void 0:r[t]}}return If=e,If}var Mf,EN;function JO(){if(EN)return Mf;EN=1;var e=Lx();function t(r){return function(n){return e(n,r)}}return Mf=t,Mf}var jf,_N;function eV(){if(_N)return jf;_N=1;var e=ZO(),t=JO(),r=Ox(),n=Vc();function a(i){return r(i)?e(n(i)):t(i)}return jf=a,jf}var Lf,SN;function na(){if(SN)return Lf;SN=1;var e=GO(),t=QO(),r=Gs(),n=Br(),a=eV();function i(s){return typeof s=="function"?s:s==null?r:typeof s=="object"?n(s)?t(s[0],s[1]):e(s):a(s)}return Lf=i,Lf}var Bf,TN;function QS(){if(TN)return Bf;TN=1;function e(t,r,n,a){for(var i=t.length,s=n+(a?1:-1);a?s--:++s<i;)if(r(t[s],s,t))return s;return-1}return Bf=e,Bf}var qf,DN;function tV(){if(DN)return qf;DN=1;function e(t){return t!==t}return qf=e,qf}var zf,AN;function rV(){if(AN)return zf;AN=1;function e(t,r,n){for(var a=n-1,i=t.length;++a<i;)if(t[a]===r)return a;return-1}return zf=e,zf}var Hf,kN;function nV(){if(kN)return Hf;kN=1;var e=QS(),t=tV(),r=rV();function n(a,i,s){return i===i?r(a,i,s):e(a,t,s)}return Hf=n,Hf}var $f,FN;function aV(){if(FN)return $f;FN=1;var e=nV();function t(r,n){var a=r==null?0:r.length;return!!a&&e(r,n,0)>-1}return $f=t,$f}var Wf,UN;function iV(){if(UN)return Wf;UN=1;function e(t,r,n){for(var a=-1,i=t==null?0:t.length;++a<i;)if(n(r,t[a]))return!0;return!1}return Wf=e,Wf}var Gf,RN;function sV(){if(RN)return Gf;RN=1;function e(){}return Gf=e,Gf}var Yf,ON;function oV(){if(ON)return Yf;ON=1;var e=YS(),t=sV(),r=zx(),n=1/0,a=e&&1/r(new e([,-0]))[1]==n?function(i){return new e(i)}:t;return Yf=a,Yf}var Xf,VN;function lV(){if(VN)return Xf;VN=1;var e=jS(),t=aV(),r=iV(),n=BS(),a=oV(),i=zx(),s=200;function o(l,u,c){var m=-1,h=t,f=l.length,x=!0,p=[],g=p;if(c)x=!1,h=r;else if(f>=s){var v=u?null:a(l);if(v)return i(v);x=!1,h=n,g=new e}else g=u?[]:p;e:for(;++m<f;){var C=l[m],b=u?u(C):C;if(C=c||C!==0?C:0,x&&b===b){for(var N=g.length;N--;)if(g[N]===b)continue e;u&&g.push(b),p.push(C)}else h(g,b,c)||(g!==p&&g.push(b),p.push(C))}return p}return Xf=o,Xf}var Kf,PN;function uV(){if(PN)return Kf;PN=1;var e=na(),t=lV();function r(n,a){return n&&n.length?t(n,e(a,2)):[]}return Kf=r,Kf}var cV=uV();const xJ=at(cV);var Qf,IN;function mV(){if(IN)return Qf;IN=1;var e=_l(),t=Hx(),r=Br(),n=e?e.isConcatSpreadable:void 0;function a(i){return r(i)||t(i)||!!(n&&i&&i[n])}return Qf=a,Qf}var Zf,MN;function ZS(){if(MN)return Zf;MN=1;var e=zS(),t=mV();function r(n,a,i,s,o){var l=-1,u=n.length;for(i||(i=t),o||(o=[]);++l<u;){var c=n[l];a>0&&i(c)?a>1?r(c,a-1,i,s,o):e(o,c):s||(o[o.length]=c)}return o}return Zf=r,Zf}var Jf,jN;function dV(){if(jN)return Jf;jN=1;function e(t){return function(r,n,a){for(var i=-1,s=Object(r),o=a(r),l=o.length;l--;){var u=o[t?l:++i];if(n(s[u],u,s)===!1)break}return r}}return Jf=e,Jf}var eh,LN;function fV(){if(LN)return eh;LN=1;var e=dV(),t=e();return eh=t,eh}var th,BN;function JS(){if(BN)return th;BN=1;var e=fV(),t=Mc();function r(n,a){return n&&e(n,a,t)}return th=r,th}var rh,qN;function hV(){if(qN)return rh;qN=1;var e=Sl();function t(r,n){return function(a,i){if(a==null)return a;if(!e(a))return r(a,i);for(var s=a.length,o=n?s:-1,l=Object(a);(n?o--:++o<s)&&i(l[o],o,l)!==!1;);return a}}return rh=t,rh}var nh,zN;function Yx(){if(zN)return nh;zN=1;var e=JS(),t=hV(),r=t(e);return nh=r,nh}var ah,HN;function eT(){if(HN)return ah;HN=1;var e=Yx(),t=Sl();function r(n,a){var i=-1,s=t(n)?Array(n.length):[];return e(n,function(o,l,u){s[++i]=a(o,l,u)}),s}return ah=r,ah}var ih,$N;function pV(){if($N)return ih;$N=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return ih=e,ih}var sh,WN;function xV(){if(WN)return sh;WN=1;var e=Ws();function t(r,n){if(r!==n){var a=r!==void 0,i=r===null,s=r===r,o=e(r),l=n!==void 0,u=n===null,c=n===n,m=e(n);if(!u&&!m&&!o&&r>n||o&&l&&c&&!u&&!m||i&&l&&c||!a&&c||!s)return 1;if(!i&&!o&&!m&&r<n||m&&a&&s&&!i&&!o||u&&a&&s||!l&&s||!c)return-1}return 0}return sh=t,sh}var oh,GN;function gV(){if(GN)return oh;GN=1;var e=xV();function t(r,n,a){for(var i=-1,s=r.criteria,o=n.criteria,l=s.length,u=a.length;++i<l;){var c=e(s[i],o[i]);if(c){if(i>=u)return c;var m=a[i];return c*(m=="desc"?-1:1)}}return r.index-n.index}return oh=t,oh}var lh,YN;function vV(){if(YN)return lh;YN=1;var e=jx(),t=Lx(),r=na(),n=eT(),a=pV(),i=$S(),s=gV(),o=Gs(),l=Br();function u(c,m,h){m.length?m=e(m,function(p){return l(p)?function(g){return t(g,p.length===1?p[0]:p)}:p}):m=[o];var f=-1;m=e(m,i(r));var x=n(c,function(p,g,v){var C=e(m,function(b){return b(p)});return{criteria:C,index:++f,value:p}});return a(x,function(p,g){return s(p,g,h)})}return lh=u,lh}var uh,XN;function bV(){if(XN)return uh;XN=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return uh=e,uh}var ch,KN;function NV(){if(KN)return ch;KN=1;var e=bV(),t=Math.max;function r(n,a,i){return a=t(a===void 0?n.length-1:a,0),function(){for(var s=arguments,o=-1,l=t(s.length-a,0),u=Array(l);++o<l;)u[o]=s[a+o];o=-1;for(var c=Array(a+1);++o<a;)c[o]=s[o];return c[a]=i(u),e(n,this,c)}}return ch=r,ch}var mh,QN;function yV(){if(QN)return mh;QN=1;function e(t){return function(){return t}}return mh=e,mh}var dh,ZN;function tT(){if(ZN)return dh;ZN=1;var e=Gi(),t=(function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch(n){}})();return dh=t,dh}var fh,JN;function CV(){if(JN)return fh;JN=1;var e=yV(),t=tT(),r=Gs(),n=t?function(a,i){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(i),writable:!0})}:r;return fh=n,fh}var hh,ey;function wV(){if(ey)return hh;ey=1;var e=800,t=16,r=Date.now;function n(a){var i=0,s=0;return function(){var o=r(),l=t-(o-s);if(s=o,l>0){if(++i>=e)return arguments[0]}else i=0;return a.apply(void 0,arguments)}}return hh=n,hh}var ph,ty;function EV(){if(ty)return ph;ty=1;var e=CV(),t=wV(),r=t(e);return ph=r,ph}var xh,ry;function _V(){if(ry)return xh;ry=1;var e=Gs(),t=NV(),r=EV();function n(a,i){return r(t(a,i,e),a+"")}return xh=n,xh}var gh,ny;function jc(){if(ny)return gh;ny=1;var e=Px(),t=Sl(),r=$x(),n=si();function a(i,s,o){if(!n(o))return!1;var l=typeof s;return(l=="number"?t(o)&&r(s,o.length):l=="string"&&s in o)?e(o[s],i):!1}return gh=a,gh}var vh,ay;function SV(){if(ay)return vh;ay=1;var e=ZS(),t=vV(),r=_V(),n=jc(),a=r(function(i,s){if(i==null)return[];var o=s.length;return o>1&&n(i,s[0],s[1])?s=[]:o>2&&n(s[0],s[1],s[2])&&(s=[s[0]]),t(i,e(s,1),[])});return vh=a,vh}var TV=SV();const gJ=at(TV);var bh,iy;function DV(){if(iy)return bh;iy=1;var e=ra(),t=function(){return e.Date.now()};return bh=t,bh}var Nh,sy;function AV(){if(sy)return Nh;sy=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return Nh=t,Nh}var yh,oy;function kV(){if(oy)return yh;oy=1;var e=AV(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return yh=r,yh}var Ch,ly;function rT(){if(ly)return Ch;ly=1;var e=kV(),t=si(),r=Ws(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function l(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var c=typeof u.valueOf=="function"?u.valueOf():u;u=t(c)?c+"":c}if(typeof u!="string")return u===0?u:+u;u=e(u);var m=i.test(u);return m||s.test(u)?o(u.slice(2),m?2:8):a.test(u)?n:+u}return Ch=l,Ch}var wh,uy;function FV(){if(uy)return wh;uy=1;var e=si(),t=DV(),r=rT(),n="Expected a function",a=Math.max,i=Math.min;function s(o,l,u){var c,m,h,f,x,p,g=0,v=!1,C=!1,b=!0;if(typeof o!="function")throw new TypeError(n);l=r(l)||0,e(u)&&(v=!!u.leading,C="maxWait"in u,h=C?a(r(u.maxWait)||0,l):h,b="trailing"in u?!!u.trailing:b);function N(M){var Y=c,K=m;return c=m=void 0,g=M,f=o.apply(K,Y),f}function F(M){return g=M,x=setTimeout(S,l),v?N(M):f}function E(M){var Y=M-p,K=M-g,de=l-Y;return C?i(de,h-K):de}function w(M){var Y=M-p,K=M-g;return p===void 0||Y>=l||Y<0||C&&K>=h}function S(){var M=t();if(w(M))return _(M);x=setTimeout(S,E(M))}function _(M){return x=void 0,b&&c?N(M):(c=m=void 0,f)}function U(){x!==void 0&&clearTimeout(x),g=0,c=p=m=x=void 0}function R(){return x===void 0?f:_(t())}function q(){var M=t(),Y=w(M);if(c=arguments,m=this,p=M,Y){if(x===void 0)return F(p);if(C)return clearTimeout(x),x=setTimeout(S,l),N(p)}return x===void 0&&(x=setTimeout(S,l)),f}return q.cancel=U,q.flush=R,q}return wh=s,wh}var Eh,cy;function UV(){if(cy)return Eh;cy=1;var e=FV(),t=si(),r="Expected a function";function n(a,i,s){var o=!0,l=!0;if(typeof a!="function")throw new TypeError(r);return t(s)&&(o="leading"in s?!!s.leading:o,l="trailing"in s?!!s.trailing:l),e(a,i,{leading:o,maxWait:i,trailing:l})}return Eh=n,Eh}var RV=UV();const vJ=at(RV);function Wa(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function OV(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Xx(e){let t,r,n;e.length!==2?(t=Wa,r=(o,l)=>Wa(e(o),l),n=(o,l)=>e(o)-l):(t=e===Wa||e===OV?e:VV,r=e,n=e);function a(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const m=u+c>>>1;r(o[m],l)<0?u=m+1:c=m}while(u<c)}return u}function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const m=u+c>>>1;r(o[m],l)<=0?u=m+1:c=m}while(u<c)}return u}function s(o,l,u=0,c=o.length){const m=a(o,l,u,c-1);return m>u&&n(o[m-1],l)>-n(o[m],l)?m-1:m}return{left:a,center:s,right:i}}function VV(){return 0}function nT(e){return e===null?NaN:+e}function*PV(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const IV=Xx(Wa),Tl=IV.right;Xx(nT).center;class my extends Map{constructor(t,r=LV){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(dy(this,t))}has(t){return super.has(dy(this,t))}set(t,r){return super.set(MV(this,t),r)}delete(t){return super.delete(jV(this,t))}}function dy({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function MV({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function jV({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function LV(e){return e!==null&&typeof e=="object"?e.valueOf():e}function BV(e=Wa){if(e===Wa)return aT;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function aT(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const qV=Math.sqrt(50),zV=Math.sqrt(10),HV=Math.sqrt(2);function Gu(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=qV?10:i>=zV?5:i>=HV?2:1;let o,l,u;return a<0?(u=Math.pow(10,-a)/s,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,a)*s,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=r&&r<2?Gu(e,t,r*2):[o,l,u]}function Cp(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?Gu(t,e,r):Gu(e,t,r);if(!(i>=a))return[];const o=i-a+1,l=new Array(o);if(n)if(s<0)for(let u=0;u<o;++u)l[u]=(i-u)/-s;else for(let u=0;u<o;++u)l[u]=(i-u)*s;else if(s<0)for(let u=0;u<o;++u)l[u]=(a+u)/-s;else for(let u=0;u<o;++u)l[u]=(a+u)*s;return l}function wp(e,t,r){return t=+t,e=+e,r=+r,Gu(e,t,r)[2]}function Ep(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?wp(t,e,r):wp(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function fy(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function hy(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function iT(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?aT:BV(a);n>r;){if(n-r>600){const l=n-r+1,u=t-r+1,c=Math.log(l),m=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*m*(l-m)/l)*(u-l/2<0?-1:1),f=Math.max(r,Math.floor(t-u*m/l+h)),x=Math.min(n,Math.floor(t+(l-u)*m/l+h));iT(e,t,f,x,a)}const i=e[t];let s=r,o=n;for(co(e,r,t),a(e[n],i)>0&&co(e,r,n);s<o;){for(co(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}a(e[r],i)===0?co(e,r,o):(++o,co(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function co(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function $V(e,t,r){if(e=Float64Array.from(PV(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return hy(e);if(t>=1)return fy(e);var n,a=(n-1)*t,i=Math.floor(a),s=fy(iT(e,i).subarray(0,i+1)),o=hy(e.subarray(i+1));return s+(o-s)*(a-i)}}function WV(e,t,r=nT){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return s+(o-s)*(a-i)}}function GV(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function xn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Aa(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const _p=Symbol("implicit");function Kx(){var e=new my,t=[],r=[],n=_p;function a(i){let s=e.get(i);if(s===void 0){if(n!==_p)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new my;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Kx(t,r).unknown(n)},xn.apply(a,arguments),a}function Qx(){var e=Kx().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,o=!1,l=0,u=0,c=.5;delete e.unknown;function m(){var h=t().length,f=a<n,x=f?a:n,p=f?n:a;i=(p-x)/Math.max(1,h-l+u*2),o&&(i=Math.floor(i)),x+=(p-x-i*(h-l))*c,s=i*(1-l),o&&(x=Math.round(x),s=Math.round(s));var g=GV(h).map(function(v){return x+i*v});return r(f?g.reverse():g)}return e.domain=function(h){return arguments.length?(t(h),m()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,m()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,o=!0,m()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(h){return arguments.length?(o=!!h,m()):o},e.padding=function(h){return arguments.length?(l=Math.min(1,u=+h),m()):l},e.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),m()):l},e.paddingOuter=function(h){return arguments.length?(u=+h,m()):u},e.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),m()):c},e.copy=function(){return Qx(t(),[n,a]).round(o).paddingInner(l).paddingOuter(u).align(c)},xn.apply(m(),arguments)}function sT(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return sT(t())},e}function YV(){return sT(Qx.apply(null,arguments).paddingInner(1))}function Zx(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function oT(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Dl(){}var Zo=.7,Yu=1/Zo,Es="\\s*([+-]?\\d+)\\s*",Jo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Kn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",XV=/^#([0-9a-f]{3,8})$/,KV=new RegExp(`^rgb\\(${Es},${Es},${Es}\\)$`),QV=new RegExp(`^rgb\\(${Kn},${Kn},${Kn}\\)$`),ZV=new RegExp(`^rgba\\(${Es},${Es},${Es},${Jo}\\)$`),JV=new RegExp(`^rgba\\(${Kn},${Kn},${Kn},${Jo}\\)$`),eP=new RegExp(`^hsl\\(${Jo},${Kn},${Kn}\\)$`),tP=new RegExp(`^hsla\\(${Jo},${Kn},${Kn},${Jo}\\)$`),py={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Zx(Dl,el,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:xy,formatHex:xy,formatHex8:rP,formatHsl:nP,formatRgb:gy,toString:gy});function xy(){return this.rgb().formatHex()}function rP(){return this.rgb().formatHex8()}function nP(){return lT(this).formatHsl()}function gy(){return this.rgb().formatRgb()}function el(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=XV.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?vy(t):r===3?new Vr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?ru(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?ru(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=KV.exec(e))?new Vr(t[1],t[2],t[3],1):(t=QV.exec(e))?new Vr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ZV.exec(e))?ru(t[1],t[2],t[3],t[4]):(t=JV.exec(e))?ru(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=eP.exec(e))?yy(t[1],t[2]/100,t[3]/100,1):(t=tP.exec(e))?yy(t[1],t[2]/100,t[3]/100,t[4]):py.hasOwnProperty(e)?vy(py[e]):e==="transparent"?new Vr(NaN,NaN,NaN,0):null}function vy(e){return new Vr(e>>16&255,e>>8&255,e&255,1)}function ru(e,t,r,n){return n<=0&&(e=t=r=NaN),new Vr(e,t,r,n)}function aP(e){return e instanceof Dl||(e=el(e)),e?(e=e.rgb(),new Vr(e.r,e.g,e.b,e.opacity)):new Vr}function Sp(e,t,r,n){return arguments.length===1?aP(e):new Vr(e,t,r,n==null?1:n)}function Vr(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Zx(Vr,Sp,oT(Dl,{brighter(e){return e=e==null?Yu:Math.pow(Yu,e),new Vr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Zo:Math.pow(Zo,e),new Vr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Vr(Ri(this.r),Ri(this.g),Ri(this.b),Xu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:by,formatHex:by,formatHex8:iP,formatRgb:Ny,toString:Ny}));function by(){return`#${Ei(this.r)}${Ei(this.g)}${Ei(this.b)}`}function iP(){return`#${Ei(this.r)}${Ei(this.g)}${Ei(this.b)}${Ei((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ny(){const e=Xu(this.opacity);return`${e===1?"rgb(":"rgba("}${Ri(this.r)}, ${Ri(this.g)}, ${Ri(this.b)}${e===1?")":`, ${e})`}`}function Xu(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ri(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ei(e){return e=Ri(e),(e<16?"0":"")+e.toString(16)}function yy(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Tn(e,t,r,n)}function lT(e){if(e instanceof Tn)return new Tn(e.h,e.s,e.l,e.opacity);if(e instanceof Dl||(e=el(e)),!e)return new Tn;if(e instanceof Tn)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,o=i-a,l=(i+a)/2;return o?(t===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-t)/o+2:s=(t-r)/o+4,o/=l<.5?i+a:2-i-a,s*=60):o=l>0&&l<1?0:s,new Tn(s,o,l,e.opacity)}function sP(e,t,r,n){return arguments.length===1?lT(e):new Tn(e,t,r,n==null?1:n)}function Tn(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Zx(Tn,sP,oT(Dl,{brighter(e){return e=e==null?Yu:Math.pow(Yu,e),new Tn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zo:Math.pow(Zo,e),new Tn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Vr(_h(e>=240?e-240:e+120,a,n),_h(e,a,n),_h(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Tn(Cy(this.h),nu(this.s),nu(this.l),Xu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Xu(this.opacity);return`${e===1?"hsl(":"hsla("}${Cy(this.h)}, ${nu(this.s)*100}%, ${nu(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Cy(e){return e=(e||0)%360,e<0?e+360:e}function nu(e){return Math.max(0,Math.min(1,e||0))}function _h(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Jx=e=>()=>e;function oP(e,t){return function(r){return e+r*t}}function lP(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function uP(e){return(e=+e)==1?uT:function(t,r){return r-t?lP(t,r,e):Jx(isNaN(t)?r:t)}}function uT(e,t){var r=t-e;return r?oP(e,r):Jx(isNaN(e)?t:e)}const wy=(function e(t){var r=uP(t);function n(a,i){var s=r((a=Sp(a)).r,(i=Sp(i)).r),o=r(a.g,i.g),l=r(a.b,i.b),u=uT(a.opacity,i.opacity);return function(c){return a.r=s(c),a.g=o(c),a.b=l(c),a.opacity=u(c),a+""}}return n.gamma=e,n})(1);function cP(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function mP(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function dP(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=Ys(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function fP(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Ku(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function hP(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Ys(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Tp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Sh=new RegExp(Tp.source,"g");function pP(e){return function(){return e}}function xP(e){return function(t){return e(t)+""}}function gP(e,t){var r=Tp.lastIndex=Sh.lastIndex=0,n,a,i,s=-1,o=[],l=[];for(e=e+"",t=t+"";(n=Tp.exec(e))&&(a=Sh.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,l.push({i:s,x:Ku(n,a)})),r=Sh.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?l[0]?xP(l[0].x):pP(t):(t=l.length,function(u){for(var c=0,m;c<t;++c)o[(m=l[c]).i]=m.x(u);return o.join("")})}function Ys(e,t){var r=typeof t,n;return t==null||r==="boolean"?Jx(t):(r==="number"?Ku:r==="string"?(n=el(t))?(t=n,wy):gP:t instanceof el?wy:t instanceof Date?fP:mP(t)?cP:Array.isArray(t)?dP:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?hP:Ku)(e,t)}function eg(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function vP(e,t){t===void 0&&(t=e,e=Ys);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function bP(e){return function(){return e}}function Qu(e){return+e}var Ey=[0,1];function kr(e){return e}function Dp(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:bP(isNaN(t)?NaN:.5)}function NP(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function yP(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=Dp(a,n),i=r(s,i)):(n=Dp(n,a),i=r(i,s)),function(o){return i(n(o))}}function CP(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=Dp(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(o){var l=Tl(e,o,1,n)-1;return i[l](a[l](o))}}function Al(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Lc(){var e=Ey,t=Ey,r=Ys,n,a,i,s=kr,o,l,u;function c(){var h=Math.min(e.length,t.length);return s!==kr&&(s=NP(e[0],e[h-1])),o=h>2?CP:yP,l=u=null,m}function m(h){return h==null||isNaN(h=+h)?i:(l||(l=o(e.map(n),t,r)))(n(s(h)))}return m.invert=function(h){return s(a((u||(u=o(t,e.map(n),Ku)))(h)))},m.domain=function(h){return arguments.length?(e=Array.from(h,Qu),c()):e.slice()},m.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},m.rangeRound=function(h){return t=Array.from(h),r=eg,c()},m.clamp=function(h){return arguments.length?(s=h?!0:kr,c()):s!==kr},m.interpolate=function(h){return arguments.length?(r=h,c()):r},m.unknown=function(h){return arguments.length?(i=h,m):i},function(h,f){return n=h,a=f,c()}}function tg(){return Lc()(kr,kr)}function wP(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Zu(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Bs(e){return e=Zu(Math.abs(e)),e?e[1]:NaN}function EP(e,t){return function(r,n){for(var a=r.length,i=[],s=0,o=e[0],l=0;a>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),i.push(r.substring(a-=o,a+o)),!((l+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(t)}}function _P(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var SP=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tl(e){if(!(t=SP.exec(e)))throw new Error("invalid format: "+e);var t;return new rg({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}tl.prototype=rg.prototype;function rg(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}rg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function TP(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var cT;function DP(e,t){var r=Zu(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(cT=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Zu(e,Math.max(0,t+i-1))[0]}function _y(e,t){var r=Zu(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const Sy={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:wP,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>_y(e*100,t),r:_y,s:DP,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Ty(e){return e}var Dy=Array.prototype.map,Ay=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function AP(e){var t=e.grouping===void 0||e.thousands===void 0?Ty:EP(Dy.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?Ty:_P(Dy.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"âˆ’":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(m){m=tl(m);var h=m.fill,f=m.align,x=m.sign,p=m.symbol,g=m.zero,v=m.width,C=m.comma,b=m.precision,N=m.trim,F=m.type;F==="n"?(C=!0,F="g"):Sy[F]||(b===void 0&&(b=12),N=!0,F="g"),(g||h==="0"&&f==="=")&&(g=!0,h="0",f="=");var E=p==="$"?r:p==="#"&&/[boxX]/.test(F)?"0"+F.toLowerCase():"",w=p==="$"?n:/[%p]/.test(F)?s:"",S=Sy[F],_=/[defgprs%]/.test(F);b=b===void 0?6:/[gprs]/.test(F)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function U(R){var q=E,M=w,Y,K,de;if(F==="c")M=S(R)+M,R="";else{R=+R;var pe=R<0||1/R<0;if(R=isNaN(R)?l:S(Math.abs(R),b),N&&(R=TP(R)),pe&&+R==0&&x!=="+"&&(pe=!1),q=(pe?x==="("?x:o:x==="-"||x==="("?"":x)+q,M=(F==="s"?Ay[8+cT/3]:"")+M+(pe&&x==="("?")":""),_){for(Y=-1,K=R.length;++Y<K;)if(de=R.charCodeAt(Y),48>de||de>57){M=(de===46?a+R.slice(Y+1):R.slice(Y))+M,R=R.slice(0,Y);break}}}C&&!g&&(R=t(R,1/0));var Ae=q.length+R.length+M.length,Ne=Ae<v?new Array(v-Ae+1).join(h):"";switch(C&&g&&(R=t(Ne+R,Ne.length?v-M.length:1/0),Ne=""),f){case"<":R=q+R+M+Ne;break;case"=":R=q+Ne+R+M;break;case"^":R=Ne.slice(0,Ae=Ne.length>>1)+q+R+M+Ne.slice(Ae);break;default:R=Ne+q+R+M;break}return i(R)}return U.toString=function(){return m+""},U}function c(m,h){var f=u((m=tl(m),m.type="f",m)),x=Math.max(-8,Math.min(8,Math.floor(Bs(h)/3)))*3,p=Math.pow(10,-x),g=Ay[8+x/3];return function(v){return f(p*v)+g}}return{format:u,formatPrefix:c}}var au,ng,mT;kP({thousands:",",grouping:[3],currency:["$",""]});function kP(e){return au=AP(e),ng=au.format,mT=au.formatPrefix,au}function FP(e){return Math.max(0,-Bs(Math.abs(e)))}function UP(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bs(t)/3)))*3-Bs(Math.abs(e)))}function RP(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Bs(t)-Bs(e))+1}function dT(e,t,r,n){var a=Ep(e,t,r),i;switch(n=tl(n==null?",f":n),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=UP(a,s))&&(n.precision=i),mT(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=RP(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=FP(a))&&(n.precision=i-(n.type==="%")*2);break}}return ng(n)}function oi(e){var t=e.domain;return e.ticks=function(r){var n=t();return Cp(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var a=t();return dT(a[0],a[a.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],o=n[i],l,u,c=10;for(o<s&&(u=s,s=o,o=u,u=a,a=i,i=u);c-- >0;){if(u=wp(s,o,r),u===l)return n[a]=s,n[i]=o,t(n);if(u>0)s=Math.floor(s/u)*u,o=Math.ceil(o/u)*u;else if(u<0)s=Math.ceil(s*u)/u,o=Math.floor(o*u)/u;else break;l=u}return e},e}function fT(){var e=tg();return e.copy=function(){return Al(e,fT())},xn.apply(e,arguments),oi(e)}function hT(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Qu),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return hT(e).unknown(t)},e=arguments.length?Array.from(e,Qu):[0,1],oi(r)}function pT(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function ky(e){return Math.log(e)}function Fy(e){return Math.exp(e)}function OP(e){return-Math.log(-e)}function VP(e){return-Math.exp(-e)}function PP(e){return isFinite(e)?+("1e"+e):e<0?0:e}function IP(e){return e===10?PP:e===Math.E?Math.exp:t=>Math.pow(e,t)}function MP(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Uy(e){return(t,r)=>-e(-t,r)}function ag(e){const t=e(ky,Fy),r=t.domain;let n=10,a,i;function s(){return a=MP(n),i=IP(n),r()[0]<0?(a=Uy(a),i=Uy(i),e(OP,VP)):e(ky,Fy),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const l=r();let u=l[0],c=l[l.length-1];const m=c<u;m&&([u,c]=[c,u]);let h=a(u),f=a(c),x,p;const g=o==null?10:+o;let v=[];if(!(n%1)&&f-h<g){if(h=Math.floor(h),f=Math.ceil(f),u>0){for(;h<=f;++h)for(x=1;x<n;++x)if(p=h<0?x/i(-h):x*i(h),!(p<u)){if(p>c)break;v.push(p)}}else for(;h<=f;++h)for(x=n-1;x>=1;--x)if(p=h>0?x/i(-h):x*i(h),!(p<u)){if(p>c)break;v.push(p)}v.length*2<g&&(v=Cp(u,c,g))}else v=Cp(h,f,Math.min(f-h,g)).map(i);return m?v.reverse():v},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=tl(l)).precision==null&&(l.trim=!0),l=ng(l)),o===1/0)return l;const u=Math.max(1,n*o/t.ticks().length);return c=>{let m=c/i(Math.round(a(c)));return m*n<n-.5&&(m*=n),m<=u?l(c):""}},t.nice=()=>r(pT(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),t}function xT(){const e=ag(Lc()).domain([1,10]);return e.copy=()=>Al(e,xT()).base(e.base()),xn.apply(e,arguments),e}function Ry(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Oy(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function ig(e){var t=1,r=e(Ry(t),Oy(t));return r.constant=function(n){return arguments.length?e(Ry(t=+n),Oy(t)):t},oi(r)}function gT(){var e=ig(Lc());return e.copy=function(){return Al(e,gT()).constant(e.constant())},xn.apply(e,arguments)}function Vy(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function jP(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function LP(e){return e<0?-e*e:e*e}function sg(e){var t=e(kr,kr),r=1;function n(){return r===1?e(kr,kr):r===.5?e(jP,LP):e(Vy(r),Vy(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},oi(t)}function og(){var e=sg(Lc());return e.copy=function(){return Al(e,og()).exponent(e.exponent())},xn.apply(e,arguments),e}function BP(){return og.apply(null,arguments).exponent(.5)}function Py(e){return Math.sign(e)*e*e}function qP(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function vT(){var e=tg(),t=[0,1],r=!1,n;function a(i){var s=qP(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(Py(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Qu)).map(Py)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return vT(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},xn.apply(a,arguments),oi(a)}function bT(){var e=[],t=[],r=[],n;function a(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=WV(e,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:t[Tl(r,s)]}return i.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Wa),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return bT().domain(e).range(t).unknown(n)},xn.apply(i,arguments)}function NT(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(l){return l!=null&&l<=l?a[Tl(n,l,0,r)]:i}function o(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return s}return s.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},s.range=function(l){return arguments.length?(r=(a=Array.from(l)).length-1,o()):a.slice()},s.invertExtent=function(l){var u=a.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(l){return arguments.length&&(i=l),s},s.thresholds=function(){return n.slice()},s.copy=function(){return NT().domain([e,t]).range(a).unknown(i)},xn.apply(oi(s),arguments)}function yT(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Tl(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return yT().domain(e).range(t).unknown(r)},xn.apply(a,arguments)}const Th=new Date,Dh=new Date;function rr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const l=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return l;let u;do l.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<s);return l},a.filter=i=>rr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!i(s););else for(;--o>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Th.setTime(+i),Dh.setTime(+s),e(Th),e(Dh),Math.floor(r(Th,Dh))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const Ap=rr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Ap.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?rr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Ap);const da=1e3,fn=da*60,fa=fn*60,ya=fa*24,lg=ya*7,Iy=ya*30,Ah=ya*365,xs=rr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*da)},(e,t)=>(t-e)/da,e=>e.getUTCSeconds()),CT=rr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*da)},(e,t)=>{e.setTime(+e+t*fn)},(e,t)=>(t-e)/fn,e=>e.getMinutes()),wT=rr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*fn)},(e,t)=>(t-e)/fn,e=>e.getUTCMinutes()),ET=rr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*da-e.getMinutes()*fn)},(e,t)=>{e.setTime(+e+t*fa)},(e,t)=>(t-e)/fa,e=>e.getHours()),_T=rr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*fa)},(e,t)=>(t-e)/fa,e=>e.getUTCHours()),Bc=rr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*fn)/ya,e=>e.getDate()-1),ug=rr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ya,e=>e.getUTCDate()-1),zP=rr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ya,e=>Math.floor(e/ya));function Yi(e){return rr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*fn)/lg)}const cg=Yi(0),kp=Yi(1);Yi(2);Yi(3);const rl=Yi(4);Yi(5);Yi(6);function Xi(e){return rr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/lg)}const mg=Xi(0),Fp=Xi(1);Xi(2);Xi(3);const nl=Xi(4);Xi(5);Xi(6);const ST=rr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),TT=rr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),Qa=rr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Qa.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:rr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});const Za=rr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Za.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:rr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});function DT(e,t,r,n,a,i){const s=[[xs,1,da],[xs,5,5*da],[xs,15,15*da],[xs,30,30*da],[i,1,fn],[i,5,5*fn],[i,15,15*fn],[i,30,30*fn],[a,1,fa],[a,3,3*fa],[a,6,6*fa],[a,12,12*fa],[n,1,ya],[n,2,2*ya],[r,1,lg],[t,1,Iy],[t,3,3*Iy],[e,1,Ah]];function o(u,c,m){const h=c<u;h&&([u,c]=[c,u]);const f=m&&typeof m.range=="function"?m:l(u,c,m),x=f?f.range(u,+c+1):[];return h?x.reverse():x}function l(u,c,m){const h=Math.abs(c-u)/m,f=Xx(([,,g])=>g).right(s,h);if(f===s.length)return e.every(Ep(u/Ah,c/Ah,m));if(f===0)return Ap.every(Math.max(Ep(u,c,m),1));const[x,p]=s[h/s[f-1][2]<s[f][2]/h?f-1:f];return x.every(p)}return[o,l]}const[HP,$P]=DT(Za,TT,mg,zP,_T,wT),[WP,GP]=DT(Qa,ST,cg,Bc,ET,CT);function kh(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Fh(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function mo(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function YP(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,l=e.shortMonths,u=fo(a),c=ho(a),m=fo(i),h=ho(i),f=fo(s),x=ho(s),p=fo(o),g=ho(o),v=fo(l),C=ho(l),b={a:pe,A:Ae,b:Ne,B:k,c:null,d:zy,e:zy,f:gI,g:TI,G:AI,H:hI,I:pI,j:xI,L:AT,m:vI,M:bI,p:le,q:j,Q:Wy,s:Gy,S:NI,u:yI,U:CI,V:wI,w:EI,W:_I,x:null,X:null,y:SI,Y:DI,Z:kI,"%":$y},N={a:y,A:V,b:I,B:G,c:null,d:Hy,e:Hy,f:OI,g:HI,G:WI,H:FI,I:UI,j:RI,L:FT,m:VI,M:PI,p:ie,q:ae,Q:Wy,s:Gy,S:II,u:MI,U:jI,V:LI,w:BI,W:qI,x:null,X:null,y:zI,Y:$I,Z:GI,"%":$y},F={a:U,A:R,b:q,B:M,c:Y,d:By,e:By,f:cI,g:Ly,G:jy,H:qy,I:qy,j:sI,L:uI,m:iI,M:oI,p:_,q:aI,Q:dI,s:fI,S:lI,u:JP,U:eI,V:tI,w:ZP,W:rI,x:K,X:de,y:Ly,Y:jy,Z:nI,"%":mI};b.x=E(r,b),b.X=E(n,b),b.c=E(t,b),N.x=E(r,N),N.X=E(n,N),N.c=E(t,N);function E(Q,Z){return function(ve){var J=[],je=-1,ke=0,tt=Q.length,ze,Se,Ot;for(ve instanceof Date||(ve=new Date(+ve));++je<tt;)Q.charCodeAt(je)===37&&(J.push(Q.slice(ke,je)),(Se=My[ze=Q.charAt(++je)])!=null?ze=Q.charAt(++je):Se=ze==="e"?" ":"0",(Ot=Z[ze])&&(ze=Ot(ve,Se)),J.push(ze),ke=je+1);return J.push(Q.slice(ke,je)),J.join("")}}function w(Q,Z){return function(ve){var J=mo(1900,void 0,1),je=S(J,Q,ve+="",0),ke,tt;if(je!=ve.length)return null;if("Q"in J)return new Date(J.Q);if("s"in J)return new Date(J.s*1e3+("L"in J?J.L:0));if(Z&&!("Z"in J)&&(J.Z=0),"p"in J&&(J.H=J.H%12+J.p*12),J.m===void 0&&(J.m="q"in J?J.q:0),"V"in J){if(J.V<1||J.V>53)return null;"w"in J||(J.w=1),"Z"in J?(ke=Fh(mo(J.y,0,1)),tt=ke.getUTCDay(),ke=tt>4||tt===0?Fp.ceil(ke):Fp(ke),ke=ug.offset(ke,(J.V-1)*7),J.y=ke.getUTCFullYear(),J.m=ke.getUTCMonth(),J.d=ke.getUTCDate()+(J.w+6)%7):(ke=kh(mo(J.y,0,1)),tt=ke.getDay(),ke=tt>4||tt===0?kp.ceil(ke):kp(ke),ke=Bc.offset(ke,(J.V-1)*7),J.y=ke.getFullYear(),J.m=ke.getMonth(),J.d=ke.getDate()+(J.w+6)%7)}else("W"in J||"U"in J)&&("w"in J||(J.w="u"in J?J.u%7:"W"in J?1:0),tt="Z"in J?Fh(mo(J.y,0,1)).getUTCDay():kh(mo(J.y,0,1)).getDay(),J.m=0,J.d="W"in J?(J.w+6)%7+J.W*7-(tt+5)%7:J.w+J.U*7-(tt+6)%7);return"Z"in J?(J.H+=J.Z/100|0,J.M+=J.Z%100,Fh(J)):kh(J)}}function S(Q,Z,ve,J){for(var je=0,ke=Z.length,tt=ve.length,ze,Se;je<ke;){if(J>=tt)return-1;if(ze=Z.charCodeAt(je++),ze===37){if(ze=Z.charAt(je++),Se=F[ze in My?Z.charAt(je++):ze],!Se||(J=Se(Q,ve,J))<0)return-1}else if(ze!=ve.charCodeAt(J++))return-1}return J}function _(Q,Z,ve){var J=u.exec(Z.slice(ve));return J?(Q.p=c.get(J[0].toLowerCase()),ve+J[0].length):-1}function U(Q,Z,ve){var J=f.exec(Z.slice(ve));return J?(Q.w=x.get(J[0].toLowerCase()),ve+J[0].length):-1}function R(Q,Z,ve){var J=m.exec(Z.slice(ve));return J?(Q.w=h.get(J[0].toLowerCase()),ve+J[0].length):-1}function q(Q,Z,ve){var J=v.exec(Z.slice(ve));return J?(Q.m=C.get(J[0].toLowerCase()),ve+J[0].length):-1}function M(Q,Z,ve){var J=p.exec(Z.slice(ve));return J?(Q.m=g.get(J[0].toLowerCase()),ve+J[0].length):-1}function Y(Q,Z,ve){return S(Q,t,Z,ve)}function K(Q,Z,ve){return S(Q,r,Z,ve)}function de(Q,Z,ve){return S(Q,n,Z,ve)}function pe(Q){return s[Q.getDay()]}function Ae(Q){return i[Q.getDay()]}function Ne(Q){return l[Q.getMonth()]}function k(Q){return o[Q.getMonth()]}function le(Q){return a[+(Q.getHours()>=12)]}function j(Q){return 1+~~(Q.getMonth()/3)}function y(Q){return s[Q.getUTCDay()]}function V(Q){return i[Q.getUTCDay()]}function I(Q){return l[Q.getUTCMonth()]}function G(Q){return o[Q.getUTCMonth()]}function ie(Q){return a[+(Q.getUTCHours()>=12)]}function ae(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var Z=E(Q+="",b);return Z.toString=function(){return Q},Z},parse:function(Q){var Z=w(Q+="",!1);return Z.toString=function(){return Q},Z},utcFormat:function(Q){var Z=E(Q+="",N);return Z.toString=function(){return Q},Z},utcParse:function(Q){var Z=w(Q+="",!0);return Z.toString=function(){return Q},Z}}}var My={"-":"",_:" ",0:"0"},ur=/^\s*\d+/,XP=/^%/,KP=/[\\^$*+?|[\]().{}]/g;function lt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function QP(e){return e.replace(KP,"\\$&")}function fo(e){return new RegExp("^(?:"+e.map(QP).join("|")+")","i")}function ho(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function ZP(e,t,r){var n=ur.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function JP(e,t,r){var n=ur.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function eI(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function tI(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function rI(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function jy(e,t,r){var n=ur.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function Ly(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function nI(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function aI(e,t,r){var n=ur.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function iI(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function By(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function sI(e,t,r){var n=ur.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function qy(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function oI(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function lI(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function uI(e,t,r){var n=ur.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function cI(e,t,r){var n=ur.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function mI(e,t,r){var n=XP.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function dI(e,t,r){var n=ur.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function fI(e,t,r){var n=ur.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function zy(e,t){return lt(e.getDate(),t,2)}function hI(e,t){return lt(e.getHours(),t,2)}function pI(e,t){return lt(e.getHours()%12||12,t,2)}function xI(e,t){return lt(1+Bc.count(Qa(e),e),t,3)}function AT(e,t){return lt(e.getMilliseconds(),t,3)}function gI(e,t){return AT(e,t)+"000"}function vI(e,t){return lt(e.getMonth()+1,t,2)}function bI(e,t){return lt(e.getMinutes(),t,2)}function NI(e,t){return lt(e.getSeconds(),t,2)}function yI(e){var t=e.getDay();return t===0?7:t}function CI(e,t){return lt(cg.count(Qa(e)-1,e),t,2)}function kT(e){var t=e.getDay();return t>=4||t===0?rl(e):rl.ceil(e)}function wI(e,t){return e=kT(e),lt(rl.count(Qa(e),e)+(Qa(e).getDay()===4),t,2)}function EI(e){return e.getDay()}function _I(e,t){return lt(kp.count(Qa(e)-1,e),t,2)}function SI(e,t){return lt(e.getFullYear()%100,t,2)}function TI(e,t){return e=kT(e),lt(e.getFullYear()%100,t,2)}function DI(e,t){return lt(e.getFullYear()%1e4,t,4)}function AI(e,t){var r=e.getDay();return e=r>=4||r===0?rl(e):rl.ceil(e),lt(e.getFullYear()%1e4,t,4)}function kI(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+lt(t/60|0,"0",2)+lt(t%60,"0",2)}function Hy(e,t){return lt(e.getUTCDate(),t,2)}function FI(e,t){return lt(e.getUTCHours(),t,2)}function UI(e,t){return lt(e.getUTCHours()%12||12,t,2)}function RI(e,t){return lt(1+ug.count(Za(e),e),t,3)}function FT(e,t){return lt(e.getUTCMilliseconds(),t,3)}function OI(e,t){return FT(e,t)+"000"}function VI(e,t){return lt(e.getUTCMonth()+1,t,2)}function PI(e,t){return lt(e.getUTCMinutes(),t,2)}function II(e,t){return lt(e.getUTCSeconds(),t,2)}function MI(e){var t=e.getUTCDay();return t===0?7:t}function jI(e,t){return lt(mg.count(Za(e)-1,e),t,2)}function UT(e){var t=e.getUTCDay();return t>=4||t===0?nl(e):nl.ceil(e)}function LI(e,t){return e=UT(e),lt(nl.count(Za(e),e)+(Za(e).getUTCDay()===4),t,2)}function BI(e){return e.getUTCDay()}function qI(e,t){return lt(Fp.count(Za(e)-1,e),t,2)}function zI(e,t){return lt(e.getUTCFullYear()%100,t,2)}function HI(e,t){return e=UT(e),lt(e.getUTCFullYear()%100,t,2)}function $I(e,t){return lt(e.getUTCFullYear()%1e4,t,4)}function WI(e,t){var r=e.getUTCDay();return e=r>=4||r===0?nl(e):nl.ceil(e),lt(e.getUTCFullYear()%1e4,t,4)}function GI(){return"+0000"}function $y(){return"%"}function Wy(e){return+e}function Gy(e){return Math.floor(+e/1e3)}var iu,RT,OT;YI({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function YI(e){return iu=YP(e),RT=iu.format,OT=iu.utcFormat,iu}function XI(e){return new Date(e)}function KI(e){return e instanceof Date?+e:+new Date(+e)}function dg(e,t,r,n,a,i,s,o,l,u){var c=tg(),m=c.invert,h=c.domain,f=u(".%L"),x=u(":%S"),p=u("%I:%M"),g=u("%I %p"),v=u("%a %d"),C=u("%b %d"),b=u("%B"),N=u("%Y");function F(E){return(l(E)<E?f:o(E)<E?x:s(E)<E?p:i(E)<E?g:n(E)<E?a(E)<E?v:C:r(E)<E?b:N)(E)}return c.invert=function(E){return new Date(m(E))},c.domain=function(E){return arguments.length?h(Array.from(E,KI)):h().map(XI)},c.ticks=function(E){var w=h();return e(w[0],w[w.length-1],E==null?10:E)},c.tickFormat=function(E,w){return w==null?F:u(w)},c.nice=function(E){var w=h();return(!E||typeof E.range!="function")&&(E=t(w[0],w[w.length-1],E==null?10:E)),E?h(pT(w,E)):c},c.copy=function(){return Al(c,dg(e,t,r,n,a,i,s,o,l,u))},c}function QI(){return xn.apply(dg(WP,GP,Qa,ST,cg,Bc,ET,CT,xs,RT).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ZI(){return xn.apply(dg(HP,$P,Za,TT,mg,ug,_T,wT,xs,OT).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function qc(){var e=0,t=1,r,n,a,i,s=kr,o=!1,l;function u(m){return m==null||isNaN(m=+m)?l:s(a===0?.5:(m=(i(m)-r)*a,o?Math.max(0,Math.min(1,m)):m))}u.domain=function(m){return arguments.length?([e,t]=m,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(m){return arguments.length?(o=!!m,u):o},u.interpolator=function(m){return arguments.length?(s=m,u):s};function c(m){return function(h){var f,x;return arguments.length?([f,x]=h,s=m(f,x),u):[s(0),s(1)]}}return u.range=c(Ys),u.rangeRound=c(eg),u.unknown=function(m){return arguments.length?(l=m,u):l},function(m){return i=m,r=m(e),n=m(t),a=r===n?0:1/(n-r),u}}function li(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function VT(){var e=oi(qc()(kr));return e.copy=function(){return li(e,VT())},Aa.apply(e,arguments)}function PT(){var e=ag(qc()).domain([1,10]);return e.copy=function(){return li(e,PT()).base(e.base())},Aa.apply(e,arguments)}function IT(){var e=ig(qc());return e.copy=function(){return li(e,IT()).constant(e.constant())},Aa.apply(e,arguments)}function fg(){var e=sg(qc());return e.copy=function(){return li(e,fg()).exponent(e.exponent())},Aa.apply(e,arguments)}function JI(){return fg.apply(null,arguments).exponent(.5)}function MT(){var e=[],t=kr;function r(n){if(n!=null&&!isNaN(n=+n))return t((Tl(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Wa),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>$V(e,i/n))},r.copy=function(){return MT(t).domain(e)},Aa.apply(r,arguments)}function zc(){var e=0,t=.5,r=1,n=1,a,i,s,o,l,u=kr,c,m=!1,h;function f(p){return isNaN(p=+p)?h:(p=.5+((p=+c(p))-i)*(n*p<n*i?o:l),u(m?Math.max(0,Math.min(1,p)):p))}f.domain=function(p){return arguments.length?([e,t,r]=p,a=c(e=+e),i=c(t=+t),s=c(r=+r),o=a===i?0:.5/(i-a),l=i===s?0:.5/(s-i),n=i<a?-1:1,f):[e,t,r]},f.clamp=function(p){return arguments.length?(m=!!p,f):m},f.interpolator=function(p){return arguments.length?(u=p,f):u};function x(p){return function(g){var v,C,b;return arguments.length?([v,C,b]=g,u=vP(p,[v,C,b]),f):[u(0),u(.5),u(1)]}}return f.range=x(Ys),f.rangeRound=x(eg),f.unknown=function(p){return arguments.length?(h=p,f):h},function(p){return c=p,a=p(e),i=p(t),s=p(r),o=a===i?0:.5/(i-a),l=i===s?0:.5/(s-i),n=i<a?-1:1,f}}function jT(){var e=oi(zc()(kr));return e.copy=function(){return li(e,jT())},Aa.apply(e,arguments)}function LT(){var e=ag(zc()).domain([.1,1,10]);return e.copy=function(){return li(e,LT()).base(e.base())},Aa.apply(e,arguments)}function BT(){var e=ig(zc());return e.copy=function(){return li(e,BT()).constant(e.constant())},Aa.apply(e,arguments)}function hg(){var e=sg(zc());return e.copy=function(){return li(e,hg()).exponent(e.exponent())},Aa.apply(e,arguments)}function eM(){return hg.apply(null,arguments).exponent(.5)}const bJ=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Qx,scaleDiverging:jT,scaleDivergingLog:LT,scaleDivergingPow:hg,scaleDivergingSqrt:eM,scaleDivergingSymlog:BT,scaleIdentity:hT,scaleImplicit:_p,scaleLinear:fT,scaleLog:xT,scaleOrdinal:Kx,scalePoint:YV,scalePow:og,scaleQuantile:bT,scaleQuantize:NT,scaleRadial:vT,scaleSequential:VT,scaleSequentialLog:PT,scaleSequentialPow:fg,scaleSequentialQuantile:MT,scaleSequentialSqrt:JI,scaleSequentialSymlog:IT,scaleSqrt:BP,scaleSymlog:gT,scaleThreshold:yT,scaleTime:QI,scaleUtc:ZI,tickFormat:dT},Symbol.toStringTag,{value:"Module"}));var Uh,Yy;function Hc(){if(Yy)return Uh;Yy=1;var e=Ws();function t(r,n,a){for(var i=-1,s=r.length;++i<s;){var o=r[i],l=n(o);if(l!=null&&(u===void 0?l===l&&!e(l):a(l,u)))var u=l,c=o}return c}return Uh=t,Uh}var Rh,Xy;function qT(){if(Xy)return Rh;Xy=1;function e(t,r){return t>r}return Rh=e,Rh}var Oh,Ky;function tM(){if(Ky)return Oh;Ky=1;var e=Hc(),t=qT(),r=Gs();function n(a){return a&&a.length?e(a,r,t):void 0}return Oh=n,Oh}var rM=tM();const NJ=at(rM);var Vh,Qy;function zT(){if(Qy)return Vh;Qy=1;function e(t,r){return t<r}return Vh=e,Vh}var Ph,Zy;function nM(){if(Zy)return Ph;Zy=1;var e=Hc(),t=zT(),r=Gs();function n(a){return a&&a.length?e(a,r,t):void 0}return Ph=n,Ph}var aM=nM();const yJ=at(aM);var Ih,Jy;function iM(){if(Jy)return Ih;Jy=1;var e=jx(),t=na(),r=eT(),n=Br();function a(i,s){var o=n(i)?e:r;return o(i,t(s,3))}return Ih=a,Ih}var Mh,eC;function sM(){if(eC)return Mh;eC=1;var e=ZS(),t=iM();function r(n,a){return e(t(n,a),1)}return Mh=r,Mh}var oM=sM();const CJ=at(oM);var jh,tC;function lM(){if(tC)return jh;tC=1;var e=Gx();function t(r,n){return e(r,n)}return jh=t,jh}var uM=lM();const wJ=at(uM);var Xs=1e9,cM={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},xg,Rt=!0,hn="[DecimalError] ",Oi=hn+"Invalid argument: ",pg=hn+"Exponent out of range: ",Ks=Math.floor,Ni=Math.pow,mM=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Zr,ir=1e7,Tt=7,HT=9007199254740991,Ju=Ks(HT/Tt),Pe={};Pe.absoluteValue=Pe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Pe.comparedTo=Pe.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Pe.decimalPlaces=Pe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Tt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Pe.dividedBy=Pe.div=function(e){return ha(this,new this.constructor(e))};Pe.dividedToIntegerBy=Pe.idiv=function(e){var t=this,r=t.constructor;return wt(ha(t,new r(e),0,1),r.precision)};Pe.equals=Pe.eq=function(e){return!this.cmp(e)};Pe.exponent=function(){return Xt(this)};Pe.greaterThan=Pe.gt=function(e){return this.cmp(e)>0};Pe.greaterThanOrEqualTo=Pe.gte=function(e){return this.cmp(e)>=0};Pe.isInteger=Pe.isint=function(){return this.e>this.d.length-2};Pe.isNegative=Pe.isneg=function(){return this.s<0};Pe.isPositive=Pe.ispos=function(){return this.s>0};Pe.isZero=function(){return this.s===0};Pe.lessThan=Pe.lt=function(e){return this.cmp(e)<0};Pe.lessThanOrEqualTo=Pe.lte=function(e){return this.cmp(e)<1};Pe.logarithm=Pe.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Zr))throw Error(hn+"NaN");if(r.s<1)throw Error(hn+(r.s?"NaN":"-Infinity"));return r.eq(Zr)?new n(0):(Rt=!1,t=ha(al(r,i),al(e,i),i),Rt=!0,wt(t,a))};Pe.minus=Pe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?GT(t,e):$T(t,(e.s=-e.s,e))};Pe.modulo=Pe.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(hn+"NaN");return r.s?(Rt=!1,t=ha(r,e,0,1).times(e),Rt=!0,r.minus(t)):wt(new n(r),a)};Pe.naturalExponential=Pe.exp=function(){return WT(this)};Pe.naturalLogarithm=Pe.ln=function(){return al(this)};Pe.negated=Pe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Pe.plus=Pe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?$T(t,e):GT(t,(e.s=-e.s,e))};Pe.precision=Pe.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Oi+e);if(t=Xt(a)+1,n=a.d.length-1,r=n*Tt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Pe.squareRoot=Pe.sqrt=function(){var e,t,r,n,a,i,s,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(hn+"NaN")}for(e=Xt(o),Rt=!1,a=Math.sqrt(+o),a==0||a==1/0?(t=Yn(o.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Ks((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new l(t)):n=new l(a.toString()),r=l.precision,a=s=r+3;;)if(i=n,n=i.plus(ha(o,i,s+2)).times(.5),Yn(i.d).slice(0,s)===(t=Yn(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(wt(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(t!="9999")break;s+=4}return Rt=!0,wt(n,r)};Pe.times=Pe.mul=function(e){var t,r,n,a,i,s,o,l,u,c=this,m=c.constructor,h=c.d,f=(e=new m(e)).d;if(!c.s||!e.s)return new m(0);for(e.s*=c.s,r=c.e+e.e,l=h.length,u=f.length,l<u&&(i=h,h=f,f=i,s=l,l=u,u=s),i=[],s=l+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=l+n;a>n;)o=i[a]+f[n]*h[a-n-1]+t,i[a--]=o%ir|0,t=o/ir|0;i[a]=(i[a]+t)%ir|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Rt?wt(e,m.precision):e};Pe.toDecimalPlaces=Pe.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Zn(e,0,Xs),t===void 0?t=n.rounding:Zn(t,0,8),wt(r,e+Xt(r)+1,t))};Pe.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Li(n,!0):(Zn(e,0,Xs),t===void 0?t=a.rounding:Zn(t,0,8),n=wt(new a(n),e+1,t),r=Li(n,!0,e+1)),r};Pe.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Li(a):(Zn(e,0,Xs),t===void 0?t=i.rounding:Zn(t,0,8),n=wt(new i(a),e+Xt(a)+1,t),r=Li(n.abs(),!1,e+Xt(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Pe.toInteger=Pe.toint=function(){var e=this,t=e.constructor;return wt(new t(e),Xt(e)+1,t.rounding)};Pe.toNumber=function(){return+this};Pe.toPower=Pe.pow=function(e){var t,r,n,a,i,s,o=this,l=o.constructor,u=12,c=+(e=new l(e));if(!e.s)return new l(Zr);if(o=new l(o),!o.s){if(e.s<1)throw Error(hn+"Infinity");return o}if(o.eq(Zr))return o;if(n=l.precision,e.eq(Zr))return wt(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=o.s,s){if((r=c<0?-c:c)<=HT){for(a=new l(Zr),t=Math.ceil(n/Tt+4),Rt=!1;r%2&&(a=a.times(o),nC(a.d,t)),r=Ks(r/2),r!==0;)o=o.times(o),nC(o.d,t);return Rt=!0,e.s<0?new l(Zr).div(a):wt(a,n)}}else if(i<0)throw Error(hn+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,Rt=!1,a=e.times(al(o,n+u)),Rt=!0,a=WT(a),a.s=i,a};Pe.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Xt(a),n=Li(a,r<=i.toExpNeg||r>=i.toExpPos)):(Zn(e,1,Xs),t===void 0?t=i.rounding:Zn(t,0,8),a=wt(new i(a),e,t),r=Xt(a),n=Li(a,e<=r||r<=i.toExpNeg,e)),n};Pe.toSignificantDigits=Pe.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Zn(e,1,Xs),t===void 0?t=n.rounding:Zn(t,0,8)),wt(new n(r),e,t)};Pe.toString=Pe.valueOf=Pe.val=Pe.toJSON=Pe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Xt(e),r=e.constructor;return Li(e,t<=r.toExpNeg||t>=r.toExpPos)};function $T(e,t){var r,n,a,i,s,o,l,u,c=e.constructor,m=c.precision;if(!e.s||!t.s)return t.s||(t=new c(e)),Rt?wt(t,m):t;if(l=e.d,u=t.d,s=e.e,a=t.e,l=l.slice(),i=s-a,i){for(i<0?(n=l,i=-i,o=u.length):(n=u,a=s,o=l.length),s=Math.ceil(m/Tt),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=l.length,i=u.length,o-i<0&&(i=o,n=u,u=l,l=n),r=0;i;)r=(l[--i]=l[i]+u[i]+r)/ir|0,l[i]%=ir;for(r&&(l.unshift(r),++a),o=l.length;l[--o]==0;)l.pop();return t.d=l,t.e=a,Rt?wt(t,m):t}function Zn(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Oi+e)}function Yn(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Tt-n.length,r&&(i+=Pa(r)),i+=n;s=e[t],n=s+"",r=Tt-n.length,r&&(i+=Pa(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var ha=(function(){function e(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%ir|0,s=i/ir|0;return s&&n.unshift(s),n}function t(n,a,i,s){var o,l;if(i!=s)l=i>s?1:-1;else for(o=l=0;o<i;o++)if(n[o]!=a[o]){l=n[o]>a[o]?1:-1;break}return l}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*ir+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,l,u,c,m,h,f,x,p,g,v,C,b,N,F,E,w,S,_=n.constructor,U=n.s==a.s?1:-1,R=n.d,q=a.d;if(!n.s)return new _(n);if(!a.s)throw Error(hn+"Division by zero");for(l=n.e-a.e,w=q.length,F=R.length,f=new _(U),x=f.d=[],u=0;q[u]==(R[u]||0);)++u;if(q[u]>(R[u]||0)&&--l,i==null?C=i=_.precision:s?C=i+(Xt(n)-Xt(a))+1:C=i,C<0)return new _(0);if(C=C/Tt+2|0,u=0,w==1)for(c=0,q=q[0],C++;(u<F||c)&&C--;u++)b=c*ir+(R[u]||0),x[u]=b/q|0,c=b%q|0;else{for(c=ir/(q[0]+1)|0,c>1&&(q=e(q,c),R=e(R,c),w=q.length,F=R.length),N=w,p=R.slice(0,w),g=p.length;g<w;)p[g++]=0;S=q.slice(),S.unshift(0),E=q[0],q[1]>=ir/2&&++E;do c=0,o=t(q,p,w,g),o<0?(v=p[0],w!=g&&(v=v*ir+(p[1]||0)),c=v/E|0,c>1?(c>=ir&&(c=ir-1),m=e(q,c),h=m.length,g=p.length,o=t(m,p,h,g),o==1&&(c--,r(m,w<h?S:q,h))):(c==0&&(o=c=1),m=q.slice()),h=m.length,h<g&&m.unshift(0),r(p,m,g),o==-1&&(g=p.length,o=t(q,p,w,g),o<1&&(c++,r(p,w<g?S:q,g))),g=p.length):o===0&&(c++,p=[0]),x[u++]=c,o&&p[0]?p[g++]=R[N]||0:(p=[R[N]],g=1);while((N++<F||p[0]!==void 0)&&C--)}return x[0]||x.shift(),f.e=l,wt(f,s?i+Xt(f)+1:i)}})();function WT(e,t){var r,n,a,i,s,o,l=0,u=0,c=e.constructor,m=c.precision;if(Xt(e)>16)throw Error(pg+Xt(e));if(!e.s)return new c(Zr);for(Rt=!1,o=m,s=new c(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log(Ni(2,u))/Math.LN10*2+5|0,o+=n,r=a=i=new c(Zr),c.precision=o;;){if(a=wt(a.times(e),o),r=r.times(++l),s=i.plus(ha(a,r,o)),Yn(s.d).slice(0,o)===Yn(i.d).slice(0,o)){for(;u--;)i=wt(i.times(i),o);return c.precision=m,t==null?(Rt=!0,wt(i,m)):i}i=s}}function Xt(e){for(var t=e.e*Tt,r=e.d[0];r>=10;r/=10)t++;return t}function Lh(e,t,r){if(t>e.LN10.sd())throw Rt=!0,r&&(e.precision=r),Error(hn+"LN10 precision limit exceeded");return wt(new e(e.LN10),t)}function Pa(e){for(var t="";e--;)t+="0";return t}function al(e,t){var r,n,a,i,s,o,l,u,c,m=1,h=10,f=e,x=f.d,p=f.constructor,g=p.precision;if(f.s<1)throw Error(hn+(f.s?"NaN":"-Infinity"));if(f.eq(Zr))return new p(0);if(t==null?(Rt=!1,u=g):u=t,f.eq(10))return t==null&&(Rt=!0),Lh(p,u);if(u+=h,p.precision=u,r=Yn(x),n=r.charAt(0),i=Xt(f),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)f=f.times(e),r=Yn(f.d),n=r.charAt(0),m++;i=Xt(f),n>1?(f=new p("0."+r),i++):f=new p(n+"."+r.slice(1))}else return l=Lh(p,u+2,g).times(i+""),f=al(new p(n+"."+r.slice(1)),u-h).plus(l),p.precision=g,t==null?(Rt=!0,wt(f,g)):f;for(o=s=f=ha(f.minus(Zr),f.plus(Zr),u),c=wt(f.times(f),u),a=3;;){if(s=wt(s.times(c),u),l=o.plus(ha(s,new p(a),u)),Yn(l.d).slice(0,u)===Yn(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(Lh(p,u+2,g).times(i+""))),o=ha(o,new p(m),u),p.precision=g,t==null?(Rt=!0,wt(o,g)):o;o=l,a+=2}}function rC(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Ks(r/Tt),e.d=[],n=(r+1)%Tt,r<0&&(n+=Tt),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Tt;n<a;)e.d.push(+t.slice(n,n+=Tt));t=t.slice(n),n=Tt-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Rt&&(e.e>Ju||e.e<-Ju))throw Error(pg+r)}else e.s=0,e.e=0,e.d=[0];return e}function wt(e,t,r){var n,a,i,s,o,l,u,c,m=e.d;for(s=1,i=m[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Tt,a=t,u=m[c=0];else{if(c=Math.ceil((n+1)/Tt),i=m.length,c>=i)return e;for(u=i=m[c],s=1;i>=10;i/=10)s++;n%=Tt,a=n-Tt+s}if(r!==void 0&&(i=Ni(10,s-a-1),o=u/i%10|0,l=t<0||m[c+1]!==void 0||u%i,l=r<4?(o||l)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||l||r==6&&(n>0?a>0?u/Ni(10,s-a):0:m[c-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return l?(i=Xt(e),m.length=1,t=t-i-1,m[0]=Ni(10,(Tt-t%Tt)%Tt),e.e=Ks(-t/Tt)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(n==0?(m.length=c,i=1,c--):(m.length=c+1,i=Ni(10,Tt-n),m[c]=a>0?(u/Ni(10,s-a)%Ni(10,a)|0)*i:0),l)for(;;)if(c==0){(m[0]+=i)==ir&&(m[0]=1,++e.e);break}else{if(m[c]+=i,m[c]!=ir)break;m[c--]=0,i=1}for(n=m.length;m[--n]===0;)m.pop();if(Rt&&(e.e>Ju||e.e<-Ju))throw Error(pg+Xt(e));return e}function GT(e,t){var r,n,a,i,s,o,l,u,c,m,h=e.constructor,f=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),Rt?wt(t,f):t;if(l=e.d,m=t.d,n=t.e,u=e.e,l=l.slice(),s=u-n,s){for(c=s<0,c?(r=l,s=-s,o=m.length):(r=m,n=u,o=l.length),a=Math.max(Math.ceil(f/Tt),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=l.length,o=m.length,c=a<o,c&&(o=a),a=0;a<o;a++)if(l[a]!=m[a]){c=l[a]<m[a];break}s=0}for(c&&(r=l,l=m,m=r,t.s=-t.s),o=l.length,a=m.length-o;a>0;--a)l[o++]=0;for(a=m.length;a>s;){if(l[--a]<m[a]){for(i=a;i&&l[--i]===0;)l[i]=ir-1;--l[i],l[a]+=ir}l[a]-=m[a]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(t.d=l,t.e=n,Rt?wt(t,f):t):new h(0)}function Li(e,t,r){var n,a=Xt(e),i=Yn(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Pa(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Pa(-a-1)+i,r&&(n=r-s)>0&&(i+=Pa(n))):a>=s?(i+=Pa(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Pa(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Pa(n))),e.s<0?"-"+i:i}function nC(e,t){if(e.length>t)return e.length=t,!0}function YT(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Oi+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return rC(s,i.toString())}else if(typeof i!="string")throw Error(Oi+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,mM.test(i))rC(s,i);else throw Error(Oi+i)}if(a.prototype=Pe,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=YT,a.config=a.set=dM,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function dM(e){if(!e||typeof e!="object")throw Error(hn+"Object expected");var t,r,n,a=["precision",1,Xs,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Ks(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Oi+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Oi+r+": "+n);return this}var xg=YT(cM);Zr=new xg(1);const EJ=xg;var aC="Invariant failed";function _J(e,t){var r=typeof t=="function"?t():t,n=r?"".concat(aC,": ").concat(r):aC;throw new Error(n)}var Bh,iC;function fM(){if(iC)return Bh;iC=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return Bh=e,Bh}var hM=fM();const SJ=at(hM);var qh={exports:{}};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var zh,sC;function pM(){if(sC)return zh;sC=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function n(i){if(i==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(i)}function a(){try{if(!Object.assign)return!1;var i=new String("abc");if(i[5]="de",Object.getOwnPropertyNames(i)[0]==="5")return!1;for(var s={},o=0;o<10;o++)s["_"+String.fromCharCode(o)]=o;var l=Object.getOwnPropertyNames(s).map(function(c){return s[c]});if(l.join("")!=="0123456789")return!1;var u={};return"abcdefghijklmnopqrst".split("").forEach(function(c){u[c]=c}),Object.keys(Object.assign({},u)).join("")==="abcdefghijklmnopqrst"}catch(c){return!1}}return zh=a()?Object.assign:function(i,s){for(var o,l=n(i),u,c=1;c<arguments.length;c++){o=Object(arguments[c]);for(var m in o)t.call(o,m)&&(l[m]=o[m]);if(e){u=e(o);for(var h=0;h<u.length;h++)r.call(o,u[h])&&(l[u[h]]=o[u[h]])}}return l},zh}var Hh,oC;function XT(){if(oC)return Hh;oC=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Hh=e,Hh}var $h,lC;function KT(){return lC||(lC=1,$h=Function.call.bind(Object.prototype.hasOwnProperty)),$h}var Wh,uC;function xM(){if(uC)return Wh;uC=1;var e=function(){};{var t=XT(),r={},n=KT();e=function(i){var s="Warning: "+i;typeof console!="undefined"&&console.error(s);try{throw new Error(s)}catch(o){}}}function a(i,s,o,l,u){for(var c in i)if(n(i,c)){var m;try{if(typeof i[c]!="function"){var h=Error((l||"React class")+": "+o+" type `"+c+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof i[c]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw h.name="Invariant Violation",h}m=i[c](s,c,l,o,null,t)}catch(x){m=x}if(m&&!(m instanceof Error)&&e((l||"React class")+": type specification of "+o+" `"+c+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof m+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),m instanceof Error&&!(m.message in r)){r[m.message]=!0;var f=u?u():"";e("Failed "+o+" type: "+m.message+(f!=null?f:""))}}}return a.resetWarningCache=function(){r={}},Wh=a,Wh}var Gh,cC;function gM(){if(cC)return Gh;cC=1;var e=s_(),t=pM(),r=XT(),n=KT(),a=xM(),i=function(){};i=function(o){var l="Warning: "+o;typeof console!="undefined"&&console.error(l);try{throw new Error(l)}catch(u){}};function s(){return null}return Gh=function(o,l){var u=typeof Symbol=="function"&&Symbol.iterator,c="@@iterator";function m(k){var le=k&&(u&&k[u]||k[c]);if(typeof le=="function")return le}var h="<<anonymous>>",f={array:v("array"),bigint:v("bigint"),bool:v("boolean"),func:v("function"),number:v("number"),object:v("object"),string:v("string"),symbol:v("symbol"),any:C(),arrayOf:b,element:N(),elementType:F(),instanceOf:E,node:U(),objectOf:S,oneOf:w,oneOfType:_,shape:q,exact:M};function x(k,le){return k===le?k!==0||1/k===1/le:k!==k&&le!==le}function p(k,le){this.message=k,this.data=le&&typeof le=="object"?le:{},this.stack=""}p.prototype=Error.prototype;function g(k){var le={},j=0;function y(I,G,ie,ae,Q,Z,ve){if(ae=ae||h,Z=Z||ie,ve!==r){if(l){var J=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw J.name="Invariant Violation",J}else if(typeof console!="undefined"){var je=ae+":"+ie;!le[je]&&j<3&&(i("You are manually calling a React.PropTypes validation function for the `"+Z+"` prop on `"+ae+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),le[je]=!0,j++)}}return G[ie]==null?I?G[ie]===null?new p("The "+Q+" `"+Z+"` is marked as required "+("in `"+ae+"`, but its value is `null`.")):new p("The "+Q+" `"+Z+"` is marked as required in "+("`"+ae+"`, but its value is `undefined`.")):null:k(G,ie,ae,Q,Z)}var V=y.bind(null,!1);return V.isRequired=y.bind(null,!0),V}function v(k){function le(j,y,V,I,G,ie){var ae=j[y],Q=de(ae);if(Q!==k){var Z=pe(ae);return new p("Invalid "+I+" `"+G+"` of type "+("`"+Z+"` supplied to `"+V+"`, expected ")+("`"+k+"`."),{expectedType:k})}return null}return g(le)}function C(){return g(s)}function b(k){function le(j,y,V,I,G){if(typeof k!="function")return new p("Property `"+G+"` of component `"+V+"` has invalid PropType notation inside arrayOf.");var ie=j[y];if(!Array.isArray(ie)){var ae=de(ie);return new p("Invalid "+I+" `"+G+"` of type "+("`"+ae+"` supplied to `"+V+"`, expected an array."))}for(var Q=0;Q<ie.length;Q++){var Z=k(ie,Q,V,I,G+"["+Q+"]",r);if(Z instanceof Error)return Z}return null}return g(le)}function N(){function k(le,j,y,V,I){var G=le[j];if(!o(G)){var ie=de(G);return new p("Invalid "+V+" `"+I+"` of type "+("`"+ie+"` supplied to `"+y+"`, expected a single ReactElement."))}return null}return g(k)}function F(){function k(le,j,y,V,I){var G=le[j];if(!e.isValidElementType(G)){var ie=de(G);return new p("Invalid "+V+" `"+I+"` of type "+("`"+ie+"` supplied to `"+y+"`, expected a single ReactElement type."))}return null}return g(k)}function E(k){function le(j,y,V,I,G){if(!(j[y]instanceof k)){var ie=k.name||h,ae=Ne(j[y]);return new p("Invalid "+I+" `"+G+"` of type "+("`"+ae+"` supplied to `"+V+"`, expected ")+("instance of `"+ie+"`."))}return null}return g(le)}function w(k){if(!Array.isArray(k))return arguments.length>1?i("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):i("Invalid argument supplied to oneOf, expected an array."),s;function le(j,y,V,I,G){for(var ie=j[y],ae=0;ae<k.length;ae++)if(x(ie,k[ae]))return null;var Q=JSON.stringify(k,function(ve,J){var je=pe(J);return je==="symbol"?String(J):J});return new p("Invalid "+I+" `"+G+"` of value `"+String(ie)+"` "+("supplied to `"+V+"`, expected one of "+Q+"."))}return g(le)}function S(k){function le(j,y,V,I,G){if(typeof k!="function")return new p("Property `"+G+"` of component `"+V+"` has invalid PropType notation inside objectOf.");var ie=j[y],ae=de(ie);if(ae!=="object")return new p("Invalid "+I+" `"+G+"` of type "+("`"+ae+"` supplied to `"+V+"`, expected an object."));for(var Q in ie)if(n(ie,Q)){var Z=k(ie,Q,V,I,G+"."+Q,r);if(Z instanceof Error)return Z}return null}return g(le)}function _(k){if(!Array.isArray(k))return i("Invalid argument supplied to oneOfType, expected an instance of array."),s;for(var le=0;le<k.length;le++){var j=k[le];if(typeof j!="function")return i("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+Ae(j)+" at index "+le+"."),s}function y(V,I,G,ie,ae){for(var Q=[],Z=0;Z<k.length;Z++){var ve=k[Z],J=ve(V,I,G,ie,ae,r);if(J==null)return null;J.data&&n(J.data,"expectedType")&&Q.push(J.data.expectedType)}var je=Q.length>0?", expected one of type ["+Q.join(", ")+"]":"";return new p("Invalid "+ie+" `"+ae+"` supplied to "+("`"+G+"`"+je+"."))}return g(y)}function U(){function k(le,j,y,V,I){return Y(le[j])?null:new p("Invalid "+V+" `"+I+"` supplied to "+("`"+y+"`, expected a ReactNode."))}return g(k)}function R(k,le,j,y,V){return new p((k||"React class")+": "+le+" type `"+j+"."+y+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+V+"`.")}function q(k){function le(j,y,V,I,G){var ie=j[y],ae=de(ie);if(ae!=="object")return new p("Invalid "+I+" `"+G+"` of type `"+ae+"` "+("supplied to `"+V+"`, expected `object`."));for(var Q in k){var Z=k[Q];if(typeof Z!="function")return R(V,I,G,Q,pe(Z));var ve=Z(ie,Q,V,I,G+"."+Q,r);if(ve)return ve}return null}return g(le)}function M(k){function le(j,y,V,I,G){var ie=j[y],ae=de(ie);if(ae!=="object")return new p("Invalid "+I+" `"+G+"` of type `"+ae+"` "+("supplied to `"+V+"`, expected `object`."));var Q=t({},j[y],k);for(var Z in Q){var ve=k[Z];if(n(k,Z)&&typeof ve!="function")return R(V,I,G,Z,pe(ve));if(!ve)return new p("Invalid "+I+" `"+G+"` key `"+Z+"` supplied to `"+V+"`.\nBad object: "+JSON.stringify(j[y],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(k),null,"  "));var J=ve(ie,Z,V,I,G+"."+Z,r);if(J)return J}return null}return g(le)}function Y(k){switch(typeof k){case"number":case"string":case"undefined":return!0;case"boolean":return!k;case"object":if(Array.isArray(k))return k.every(Y);if(k===null||o(k))return!0;var le=m(k);if(le){var j=le.call(k),y;if(le!==k.entries){for(;!(y=j.next()).done;)if(!Y(y.value))return!1}else for(;!(y=j.next()).done;){var V=y.value;if(V&&!Y(V[1]))return!1}}else return!1;return!0;default:return!1}}function K(k,le){return k==="symbol"?!0:le?le["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&le instanceof Symbol:!1}function de(k){var le=typeof k;return Array.isArray(k)?"array":k instanceof RegExp?"object":K(le,k)?"symbol":le}function pe(k){if(typeof k=="undefined"||k===null)return""+k;var le=de(k);if(le==="object"){if(k instanceof Date)return"date";if(k instanceof RegExp)return"regexp"}return le}function Ae(k){var le=pe(k);switch(le){case"array":case"object":return"an "+le;case"boolean":case"date":case"regexp":return"a "+le;default:return le}}function Ne(k){return!k.constructor||!k.constructor.name?h:k.constructor.name}return f.checkPropTypes=a,f.resetWarningCache=a.resetWarningCache,f.PropTypes=f,f},Gh}var mC;function vM(){if(mC)return qh.exports;mC=1;{var e=s_(),t=!0;qh.exports=gM()(e.isElement,t)}return qh.exports}var bM=vM();const TJ=at(bM);var NM=Object.getOwnPropertyNames,yM=Object.getOwnPropertySymbols,CM=Object.prototype.hasOwnProperty;function dC(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function su(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var i=a.cache,s=i.get(r),o=i.get(n);if(s&&o)return s===n&&o===r;i.set(r,n),i.set(n,r);var l=e(r,n,a);return i.delete(r),i.delete(n),l}}function fC(e){return NM(e).concat(yM(e))}var wM=Object.hasOwn||(function(e,t){return CM.call(e,t)});function Ki(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var EM="__v",_M="__o",SM="_owner",hC=Object.getOwnPropertyDescriptor,pC=Object.keys;function TM(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function DM(e,t){return Ki(e.getTime(),t.getTime())}function AM(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function kM(e,t){return e===t}function xC(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.entries(),s,o,l=0;(s=i.next())&&!s.done;){for(var u=t.entries(),c=!1,m=0;(o=u.next())&&!o.done;){if(a[m]){m++;continue}var h=s.value,f=o.value;if(r.equals(h[0],f[0],l,m,e,t,r)&&r.equals(h[1],f[1],h[0],f[0],e,t,r)){c=a[m]=!0;break}m++}if(!c)return!1;l++}return!0}var FM=Ki;function UM(e,t,r){var n=pC(e),a=n.length;if(pC(t).length!==a)return!1;for(;a-- >0;)if(!QT(e,t,r,n[a]))return!1;return!0}function po(e,t,r){var n=fC(e),a=n.length;if(fC(t).length!==a)return!1;for(var i,s,o;a-- >0;)if(i=n[a],!QT(e,t,r,i)||(s=hC(e,i),o=hC(t,i),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function RM(e,t){return Ki(e.valueOf(),t.valueOf())}function OM(e,t){return e.source===t.source&&e.flags===t.flags}function gC(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.values(),s,o;(s=i.next())&&!s.done;){for(var l=t.values(),u=!1,c=0;(o=l.next())&&!o.done;){if(!a[c]&&r.equals(s.value,o.value,s.value,o.value,e,t,r)){u=a[c]=!0;break}c++}if(!u)return!1}return!0}function VM(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function PM(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function QT(e,t,r,n){return(n===SM||n===_M||n===EM)&&(e.$$typeof||t.$$typeof)?!0:wM(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var IM="[object Arguments]",MM="[object Boolean]",jM="[object Date]",LM="[object Error]",BM="[object Map]",qM="[object Number]",zM="[object Object]",HM="[object RegExp]",$M="[object Set]",WM="[object String]",GM="[object URL]",YM=Array.isArray,vC=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,bC=Object.assign,XM=Object.prototype.toString.call.bind(Object.prototype.toString);function KM(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,s=e.areNumbersEqual,o=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,u=e.areRegExpsEqual,c=e.areSetsEqual,m=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(x,p,g){if(x===p)return!0;if(x==null||p==null)return!1;var v=typeof x;if(v!==typeof p)return!1;if(v!=="object")return v==="number"?s(x,p,g):v==="function"?a(x,p,g):!1;var C=x.constructor;if(C!==p.constructor)return!1;if(C===Object)return o(x,p,g);if(YM(x))return t(x,p,g);if(vC!=null&&vC(x))return m(x,p,g);if(C===Date)return r(x,p,g);if(C===RegExp)return u(x,p,g);if(C===Map)return i(x,p,g);if(C===Set)return c(x,p,g);var b=XM(x);return b===jM?r(x,p,g):b===HM?u(x,p,g):b===BM?i(x,p,g):b===$M?c(x,p,g):b===zM?typeof x.then!="function"&&typeof p.then!="function"&&o(x,p,g):b===GM?h(x,p,g):b===LM?n(x,p,g):b===IM?o(x,p,g):b===MM||b===qM||b===WM?l(x,p,g):!1}}function QM(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?po:TM,areDatesEqual:DM,areErrorsEqual:AM,areFunctionsEqual:kM,areMapsEqual:n?dC(xC,po):xC,areNumbersEqual:FM,areObjectsEqual:n?po:UM,arePrimitiveWrappersEqual:RM,areRegExpsEqual:OM,areSetsEqual:n?dC(gC,po):gC,areTypedArraysEqual:n?po:VM,areUrlsEqual:PM};if(r&&(a=bC({},a,r(a))),t){var i=su(a.areArraysEqual),s=su(a.areMapsEqual),o=su(a.areObjectsEqual),l=su(a.areSetsEqual);a=bC({},a,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:l})}return a}function ZM(e){return function(t,r,n,a,i,s,o){return e(t,r,o)}}function JM(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(l,u){var c=n(),m=c.cache,h=m===void 0?t?new WeakMap:void 0:m,f=c.meta;return r(l,u,{cache:h,equals:a,meta:f,strict:i})};if(t)return function(l,u){return r(l,u,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var s={cache:void 0,equals:a,meta:void 0,strict:i};return function(l,u){return r(l,u,s)}}var DJ=ui();ui({strict:!0});ui({circular:!0});ui({circular:!0,strict:!0});ui({createInternalComparator:function(){return Ki}});ui({strict:!0,createInternalComparator:function(){return Ki}});ui({circular:!0,createInternalComparator:function(){return Ki}});ui({circular:!0,createInternalComparator:function(){return Ki},strict:!0});function ui(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,s=i===void 0?!1:i,o=QM(e),l=KM(o),u=n?n(l):ZM(l);return JM({circular:r,comparator:l,createState:a,equals:u,strict:s})}var Yh,NC;function e8(){if(NC)return Yh;NC=1;var e=Hc(),t=qT(),r=na();function n(a,i){return a&&a.length?e(a,r(i,2),t):void 0}return Yh=n,Yh}var t8=e8();const AJ=at(t8);var Xh,yC;function r8(){if(yC)return Xh;yC=1;var e=Hc(),t=na(),r=zT();function n(a,i){return a&&a.length?e(a,t(i,2),r):void 0}return Xh=n,Xh}var n8=r8();const kJ=at(n8);var Kh,CC;function a8(){if(CC)return Kh;CC=1;var e=GS(),t=e(Object.getPrototypeOf,Object);return Kh=t,Kh}var Qh,wC;function i8(){if(wC)return Qh;wC=1;var e=Ta(),t=a8(),r=Da(),n="[object Object]",a=Function.prototype,i=Object.prototype,s=a.toString,o=i.hasOwnProperty,l=s.call(Object);function u(c){if(!r(c)||e(c)!=n)return!1;var m=t(c);if(m===null)return!0;var h=o.call(m,"constructor")&&m.constructor;return typeof h=="function"&&h instanceof h&&s.call(h)==l}return Qh=u,Qh}var s8=i8();const FJ=at(s8);var Zh,EC;function o8(){if(EC)return Zh;EC=1;var e=Ta(),t=Da(),r="[object Boolean]";function n(a){return a===!0||a===!1||t(a)&&e(a)==r}return Zh=n,Zh}var l8=o8();const UJ=at(l8);var Jh,_C;function u8(){if(_C)return Jh;_C=1;function e(t){return t&&t.length?t[0]:void 0}return Jh=e,Jh}var e0,SC;function c8(){return SC||(SC=1,e0=u8()),e0}var m8=c8();const RJ=at(m8);var t0,TC;function d8(){if(TC)return t0;TC=1;var e=Math.ceil,t=Math.max;function r(n,a,i,s){for(var o=-1,l=t(e((a-n)/(i||1)),0),u=Array(l);l--;)u[s?l:++o]=n,n+=i;return u}return t0=r,t0}var r0,DC;function ZT(){if(DC)return r0;DC=1;var e=rT(),t=1/0,r=17976931348623157e292;function n(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-t){var i=a<0?-1:1;return i*r}return a===a?a:0}return r0=n,r0}var n0,AC;function f8(){if(AC)return n0;AC=1;var e=d8(),t=jc(),r=ZT();function n(a){return function(i,s,o){return o&&typeof o!="number"&&t(i,s,o)&&(s=o=void 0),i=r(i),s===void 0?(s=i,i=0):s=r(s),o=o===void 0?i<s?1:-1:r(o),e(i,s,o,a)}}return n0=n,n0}var a0,kC;function h8(){if(kC)return a0;kC=1;var e=f8(),t=e();return a0=t,a0}var p8=h8();const OJ=at(p8);var i0,FC;function x8(){if(FC)return i0;FC=1;var e=Yx();function t(r,n){var a;return e(r,function(i,s,o){return a=n(i,s,o),!a}),!!a}return i0=t,i0}var s0,UC;function g8(){if(UC)return s0;UC=1;var e=LS(),t=na(),r=x8(),n=Br(),a=jc();function i(s,o,l){var u=n(s)?e:r;return l&&a(s,o,l)&&(o=void 0),u(s,t(o,3))}return s0=i,s0}var v8=g8();const VJ=at(v8);var o0,RC;function b8(){if(RC)return o0;RC=1;var e=tT();function t(r,n,a){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}return o0=t,o0}var l0,OC;function N8(){if(OC)return l0;OC=1;var e=b8(),t=JS(),r=na();function n(a,i){var s={};return i=r(i,3),t(a,function(o,l,u){e(s,l,i(o,l,u))}),s}return l0=n,l0}var y8=N8();const PJ=at(y8);var u0,VC;function C8(){if(VC)return u0;VC=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(!r(t[n],n,t))return!1;return!0}return u0=e,u0}var c0,PC;function w8(){if(PC)return c0;PC=1;var e=Yx();function t(r,n){var a=!0;return e(r,function(i,s,o){return a=!!n(i,s,o),a}),a}return c0=t,c0}var m0,IC;function E8(){if(IC)return m0;IC=1;var e=C8(),t=w8(),r=na(),n=Br(),a=jc();function i(s,o,l){var u=n(s)?e:t;return l&&a(s,o,l)&&(o=void 0),u(s,r(o,3))}return m0=i,m0}var _8=E8();const IJ=at(_8);var d0,MC;function S8(){if(MC)return d0;MC=1;var e=na(),t=Sl(),r=Mc();function n(a){return function(i,s,o){var l=Object(i);if(!t(i)){var u=e(s,3);i=r(i),s=function(m){return u(l[m],m,l)}}var c=a(i,s,o);return c>-1?l[u?i[c]:c]:void 0}}return d0=n,d0}var f0,jC;function T8(){if(jC)return f0;jC=1;var e=ZT();function t(r){var n=e(r),a=n%1;return n===n?a?n-a:n:0}return f0=t,f0}var h0,LC;function D8(){if(LC)return h0;LC=1;var e=QS(),t=na(),r=T8(),n=Math.max;function a(i,s,o){var l=i==null?0:i.length;if(!l)return-1;var u=o==null?0:r(o);return u<0&&(u=n(l+u,0)),e(i,t(s,3),u)}return h0=a,h0}var p0,BC;function A8(){if(BC)return p0;BC=1;var e=S8(),t=D8(),r=e(t);return p0=r,p0}var k8=A8();const MJ=at(k8);var F8=xS();const jJ=at(F8);var x0={exports:{}},qC;function U8(){return qC||(qC=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function i(l,u,c,m,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new a(c,m||l,h),x=r?r+u:u;return l._events[x]?l._events[x].fn?l._events[x]=[l._events[x],f]:l._events[x].push(f):(l._events[x]=f,l._eventsCount++),l}function s(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,m;if(this._eventsCount===0)return u;for(m in c=this._events)t.call(c,m)&&u.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=r?r+u:u,m=this._events[c];if(!m)return[];if(m.fn)return[m.fn];for(var h=0,f=m.length,x=new Array(f);h<f;h++)x[h]=m[h].fn;return x},o.prototype.listenerCount=function(u){var c=r?r+u:u,m=this._events[c];return m?m.fn?1:m.length:0},o.prototype.emit=function(u,c,m,h,f,x){var p=r?r+u:u;if(!this._events[p])return!1;var g=this._events[p],v=arguments.length,C,b;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),v){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,m),!0;case 4:return g.fn.call(g.context,c,m,h),!0;case 5:return g.fn.call(g.context,c,m,h,f),!0;case 6:return g.fn.call(g.context,c,m,h,f,x),!0}for(b=1,C=new Array(v-1);b<v;b++)C[b-1]=arguments[b];g.fn.apply(g.context,C)}else{var N=g.length,F;for(b=0;b<N;b++)switch(g[b].once&&this.removeListener(u,g[b].fn,void 0,!0),v){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,c);break;case 3:g[b].fn.call(g[b].context,c,m);break;case 4:g[b].fn.call(g[b].context,c,m,h);break;default:if(!C)for(F=1,C=new Array(v-1);F<v;F++)C[F-1]=arguments[F];g[b].fn.apply(g[b].context,C)}}return!0},o.prototype.on=function(u,c,m){return i(this,u,c,m,!1)},o.prototype.once=function(u,c,m){return i(this,u,c,m,!0)},o.prototype.removeListener=function(u,c,m,h){var f=r?r+u:u;if(!this._events[f])return this;if(!c)return s(this,f),this;var x=this._events[f];if(x.fn)x.fn===c&&(!h||x.once)&&(!m||x.context===m)&&s(this,f);else{for(var p=0,g=[],v=x.length;p<v;p++)(x[p].fn!==c||h&&!x[p].once||m&&x[p].context!==m)&&g.push(x[p]);g.length?this._events[f]=g.length===1?g[0]:g:s(this,f)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=r?r+u:u,this._events[c]&&s(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(x0)),x0.exports}var R8=U8();const LJ=at(R8),BJ=({data:e,title:t="Performance Trends",description:r="Average ratings over time"})=>{const n=({active:a,payload:i,label:s})=>a&&i&&i.length?d.jsxDEV("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg",children:[d.jsxDEV("p",{className:"font-medium text-foreground mb-2",children:s},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:27,columnNumber:11},void 0),i.map((o,l)=>d.jsxDEV("div",{className:"flex items-center gap-2 text-sm",children:[d.jsxDEV("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:o.color}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:30,columnNumber:15},void 0),d.jsxDEV("span",{className:"text-muted-foreground",children:[o.name,":"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:34,columnNumber:15},void 0),d.jsxDEV("span",{className:"font-medium text-foreground",children:o.value},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:35,columnNumber:15},void 0)]},l,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:29,columnNumber:13},void 0))]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:26,columnNumber:9},void 0):null;return d.jsxDEV(Le,{className:"w-full offscreen-content layout-contained",children:[d.jsxDEV(Ke,{children:[d.jsxDEV(Qe,{className:"flex items-center gap-2 text-foreground",children:[d.jsxDEV(zs,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:48,columnNumber:11},void 0),t]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:47,columnNumber:9},void 0),d.jsxDEV(ft,{className:"text-muted-foreground",children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:51,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:46,columnNumber:7},void 0),d.jsxDEV(He,{children:d.jsxDEV("div",{className:"h-80 w-full",children:d.jsxDEV(Cx,{width:"100%",height:"100%",children:d.jsxDEV(mF,{data:e,margin:{top:5,right:30,left:20,bottom:5},children:[d.jsxDEV(S_,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.3},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:59,columnNumber:15},void 0),d.jsxDEV(T_,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:64,columnNumber:15},void 0),d.jsxDEV(D_,{domain:[1,5],stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:71,columnNumber:15},void 0),d.jsxDEV(A_,{content:d.jsxDEV(n,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:78,columnNumber:33},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:78,columnNumber:15},void 0),d.jsxDEV(k_,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:79,columnNumber:15},void 0),d.jsxDEV(E1,{type:"monotone",dataKey:"averageRating",stroke:"hsl(var(--chart-1))",strokeWidth:3,dot:{fill:"hsl(var(--chart-1))",strokeWidth:2,r:4},activeDot:{r:6,stroke:"hsl(var(--chart-1))",strokeWidth:2}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:80,columnNumber:15},void 0),d.jsxDEV(E1,{type:"monotone",dataKey:"totalInspections",stroke:"hsl(var(--chart-2))",strokeWidth:2,strokeDasharray:"5 5",dot:{fill:"hsl(var(--chart-2))",strokeWidth:2,r:3}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:88,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:58,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:57,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:56,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:55,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/PerformanceTrendChart.tsx",lineNumber:45,columnNumber:5},void 0)},qJ=({data:e,title:t="School Performance Comparison",description:r="Average ratings and inspection counts by school",showThresholds:n=!0})=>{const a=({active:i,payload:s,label:o})=>i&&s&&s.length?d.jsxDEV("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg",children:[d.jsxDEV("p",{className:"font-medium text-foreground mb-2",children:o},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:30,columnNumber:11},void 0),s.map((l,u)=>d.jsxDEV("div",{className:"flex items-center gap-2 text-sm",children:[d.jsxDEV("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:l.color}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:33,columnNumber:15},void 0),d.jsxDEV("span",{className:"text-muted-foreground",children:[l.name,":"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:37,columnNumber:15},void 0),d.jsxDEV("span",{className:"font-medium text-foreground",children:l.value},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:38,columnNumber:15},void 0)]},u,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:32,columnNumber:13},void 0))]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:29,columnNumber:9},void 0):null;return d.jsxDEV(Le,{className:"w-full offscreen-content layout-contained",children:[d.jsxDEV(Ke,{children:[d.jsxDEV(Qe,{className:"flex items-center gap-2 text-foreground",children:[d.jsxDEV(dn,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:51,columnNumber:11},void 0),t]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:50,columnNumber:9},void 0),d.jsxDEV(ft,{className:"text-muted-foreground",children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:54,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:49,columnNumber:7},void 0),d.jsxDEV(He,{children:[d.jsxDEV("div",{className:"h-80 w-full",children:d.jsxDEV(Cx,{width:"100%",height:"100%",children:d.jsxDEV(dF,{data:e,margin:{top:20,right:30,left:20,bottom:5},children:[d.jsxDEV(S_,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.3},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:62,columnNumber:15},void 0),d.jsxDEV(T_,{dataKey:"school",stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1,angle:-45,textAnchor:"end",height:80},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:67,columnNumber:15},void 0),d.jsxDEV(D_,{stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:77,columnNumber:15},void 0),d.jsxDEV(A_,{content:d.jsxDEV(a,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:83,columnNumber:33},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:83,columnNumber:15},void 0),d.jsxDEV(k_,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:84,columnNumber:15},void 0),n&&d.jsxDEV(d.Fragment,{children:[d.jsxDEV(_1,{y:3,stroke:"#10B981",strokeDasharray:"5 5",strokeWidth:2,label:{value:"Acceptable (3.0)",position:"top"}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:87,columnNumber:19},void 0),d.jsxDEV(_1,{y:2,stroke:"#EF4444",strokeDasharray:"5 5",strokeWidth:2,label:{value:"Critical (2.0)",position:"top"}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:94,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:86,columnNumber:17},void 0),d.jsxDEV(S1,{dataKey:"averageRating",fill:"hsl(var(--chart-1))",name:"Average Rating",radius:[2,2,0,0]},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:103,columnNumber:15},void 0),d.jsxDEV(S1,{dataKey:"totalInspections",fill:"hsl(var(--chart-2))",name:"Total Inspections",radius:[2,2,0,0]},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:109,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:61,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:60,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:59,columnNumber:9},void 0),n&&d.jsxDEV("div",{className:"mt-4 flex items-center gap-4 text-sm text-muted-foreground",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV("div",{className:"w-4 h-0.5 bg-green-500 border-dashed border-t-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:121,columnNumber:15},void 0),d.jsxDEV("span",{children:"Acceptable Threshold (3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:122,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:120,columnNumber:13},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV("div",{className:"w-4 h-0.5 bg-red-500 border-dashed border-t-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:125,columnNumber:15},void 0),d.jsxDEV("span",{children:"Critical Threshold (2.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:126,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:124,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:119,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:58,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/SchoolComparisonChart.tsx",lineNumber:48,columnNumber:5},void 0)},zJ=({data:e,title:t="Category Performance Analysis",description:r="Performance ratings across all inspection categories",showProblemHighlighting:n=!0})=>{const a=s=>s<2?{level:"critical",color:"#EF4444",icon:mn}:s<3?{level:"needs-attention",color:"#F59E0B",icon:Fr}:{level:"acceptable",color:"#10B981",icon:Fn},i=s=>{const{payload:o,x:l,y:u,textAnchor:c}=s,m=e.find(f=>f.category===o.value),h=m?a(m.rating):null;return d.jsxDEV("g",{transform:`translate(${l},${u})`,children:[d.jsxDEV("text",{x:0,y:0,dy:16,textAnchor:c,fontSize:12,fill:(h==null?void 0:h.color)||"hsl(var(--muted-foreground))",fontWeight:n&&(h==null?void 0:h.level)!=="acceptable"?"bold":"normal",children:o.value},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:39,columnNumber:9},void 0),n&&(h==null?void 0:h.level)!=="acceptable"&&d.jsxDEV("circle",{cx:-20,cy:0,r:4,fill:(h==null?void 0:h.color)||"#EF4444"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:51,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:38,columnNumber:7},void 0)};return d.jsxDEV(Le,{className:"w-full offscreen-content layout-contained",children:[d.jsxDEV(Ke,{children:[d.jsxDEV(Qe,{className:"flex items-center gap-2 text-foreground",children:[d.jsxDEV(o_,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:65,columnNumber:11},void 0),t]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:64,columnNumber:9},void 0),d.jsxDEV(ft,{className:"text-muted-foreground",children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:68,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:63,columnNumber:7},void 0),d.jsxDEV(He,{children:[d.jsxDEV("div",{className:"h-80 w-full",children:d.jsxDEV(Cx,{width:"100%",height:"100%",children:d.jsxDEV(fF,{data:e,margin:{top:20,right:30,left:20,bottom:5},children:[d.jsxDEV(hF,{stroke:"hsl(var(--border))",opacity:.3},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:76,columnNumber:15},void 0),d.jsxDEV(pF,{dataKey:"category",tick:d.jsxDEV(i,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:82,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:80,columnNumber:15},void 0),d.jsxDEV(xF,{domain:[0,5],tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},axisLine:!1},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:84,columnNumber:15},void 0),d.jsxDEV(gF,{name:"Performance",dataKey:"rating",stroke:"hsl(var(--chart-1))",fill:"hsl(var(--chart-1))",fillOpacity:.2,strokeWidth:2},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:75,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:74,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:73,columnNumber:9},void 0),n&&d.jsxDEV("div",{className:"mt-4 space-y-3",children:[d.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:e.map(s=>{const o=a(s.rating);return o.level==="acceptable"?null:d.jsxDEV("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted/50",children:[d.jsxDEV(o.icon,{className:"w-4 h-4",style:{color:o.color}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:110,columnNumber:21},void 0),d.jsxDEV("span",{className:"font-medium",children:s.category},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:111,columnNumber:21},void 0),d.jsxDEV("span",{className:"text-muted-foreground",children:["(",s.rating.toFixed(1),")"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:112,columnNumber:21},void 0)]},s.category,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:109,columnNumber:19},void 0)})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:103,columnNumber:13},void 0),d.jsxDEV("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(mn,{className:"w-4 h-4 text-red-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:121,columnNumber:17},void 0),d.jsxDEV("span",{children:"Critical (< 2.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:122,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:120,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(Fr,{className:"w-4 h-4 text-orange-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:125,columnNumber:17},void 0),d.jsxDEV("span",{children:"Needs Attention (2.0-3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:126,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:124,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(Fn,{className:"w-4 h-4 text-green-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:129,columnNumber:17},void 0),d.jsxDEV("span",{children:"Acceptable (> 3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:130,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:128,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:119,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:101,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:72,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/CategoryRadarChart.tsx",lineNumber:62,columnNumber:5},void 0)},HJ=({title:e,value:t,description:r,trend:n,icon:a,color:i="primary",className:s=""})=>{const l=(m=>{switch(m){case"primary":return{text:"text-primary",bg:"bg-primary/10",border:"border-primary/20"};case"secondary":return{text:"text-secondary",bg:"bg-secondary/10",border:"border-secondary/20"};case"success":return{text:"text-green-600",bg:"bg-green-50",border:"border-green-200"};case"warning":return{text:"text-yellow-600",bg:"bg-yellow-50",border:"border-yellow-200"};case"destructive":return{text:"text-destructive",bg:"bg-destructive/10",border:"border-destructive/20"};default:return{text:"text-primary",bg:"bg-primary/10",border:"border-primary/20"}}})(i),u=m=>m>0?d.jsxDEV(zs,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:72,columnNumber:32},void 0):m<0?d.jsxDEV(yx,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:73,columnNumber:32},void 0):d.jsxDEV(Dk,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:74,columnNumber:12},void 0),c=m=>m>0?"text-green-600":m<0?"text-red-600":"text-muted-foreground";return d.jsxDEV(Le,{className:s,children:[d.jsxDEV(Ke,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[d.jsxDEV(Qe,{className:"text-sm font-medium text-muted-foreground",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:86,columnNumber:9},void 0),a&&d.jsxDEV("div",{className:`p-2 rounded-lg ${l.bg} ${l.border} border`,children:d.jsxDEV(a,{className:`w-4 h-4 ${l.text}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:91,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:90,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:85,columnNumber:7},void 0),d.jsxDEV(He,{children:d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV("div",{className:"text-2xl font-bold text-foreground",children:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:97,columnNumber:11},void 0),r&&d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:101,columnNumber:13},void 0),n&&d.jsxDEV("div",{className:`flex items-center gap-1 text-sm ${c(n.value)}`,children:[u(n.value),d.jsxDEV("span",{className:"font-medium",children:[n.value>0?"+":"",n.value,"%"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:108,columnNumber:15},void 0),d.jsxDEV("span",{className:"text-muted-foreground",children:n.period},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:111,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:106,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:96,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:95,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/KPICard.tsx",lineNumber:84,columnNumber:5},void 0)},$J=({data:e,title:t="Room Performance Heatmap",description:r="Visual overview of room performance ratings",maxRoomsPerRow:n=8,onRoomClick:a})=>{const[i,s]=W.useState(null),o=h=>h>=4.5?"bg-green-100 text-green-800 border-green-200":h>=3.5?"bg-yellow-100 text-yellow-800 border-yellow-200":h>=2.5?"bg-orange-100 text-orange-800 border-orange-200":"bg-red-100 text-red-800 border-red-200",l=h=>h>=4.5?"Excellent":h>=3.5?"Good":h>=2.5?"Fair":"Needs Attention",u=h=>h<2?{level:"critical",color:"#EF4444",icon:mn}:h<3?{level:"needs-attention",color:"#F59E0B",icon:Fr}:{level:"acceptable",color:"#10B981",icon:Fn},c=h=>{s(h),a==null||a(h)},m=e.reduce((h,f)=>(h[f.school]||(h[f.school]=[]),h[f.school].push(f),h),{});return d.jsxDEV(Le,{className:"w-full offscreen-content layout-contained",children:[d.jsxDEV(Ke,{children:[d.jsxDEV(Qe,{className:"flex items-center gap-2 text-foreground",children:[d.jsxDEV(op,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:76,columnNumber:11},void 0),t]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:75,columnNumber:9},void 0),d.jsxDEV(ft,{className:"text-muted-foreground",children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:79,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:74,columnNumber:7},void 0),d.jsxDEV(He,{children:d.jsxDEV("div",{className:"space-y-6",children:[Object.entries(m).map(([h,f])=>d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(dn,{className:"w-4 h-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:88,columnNumber:17},void 0),d.jsxDEV("h3",{className:"font-medium text-foreground",children:h},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:89,columnNumber:17},void 0),d.jsxDEV("span",{className:"text-sm text-muted-foreground",children:["(",f.length," rooms)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:90,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:87,columnNumber:15},void 0),d.jsxDEV("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${Math.min(n,f.length)}, 1fr)`},children:f.map(x=>d.jsxDEV(kc,{children:[d.jsxDEV(uS,{asChild:!0,children:d.jsxDEV("div",{className:`
                          p-3 text-center text-xs rounded-lg border-2 transition-all duration-200 hover:scale-105 cursor-pointer
                          ${o(x.rating)}
                        `,title:`Room ${x.number}: ${x.rating.toFixed(1)}/5 - ${l(x.rating)}`,onClick:()=>c(x),children:[d.jsxDEV("div",{className:"font-bold text-sm mb-1",children:x.number},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:109,columnNumber:25},void 0),d.jsxDEV("div",{className:"text-xs opacity-75",children:x.rating.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:112,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:101,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:100,columnNumber:21},void 0),d.jsxDEV(yl,{className:"max-w-2xl",children:[d.jsxDEV(Cl,{children:[d.jsxDEV(wl,{className:"flex items-center gap-2",children:[d.jsxDEV(op,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:120,columnNumber:27},void 0),"Room ",x.number," - ",x.school]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:119,columnNumber:25},void 0),d.jsxDEV(El,{children:"Detailed performance analysis and inspection history"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:123,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:118,columnNumber:23},void 0),d.jsxDEV("div",{className:"space-y-6",children:[d.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxDEV(Le,{children:d.jsxDEV(He,{className:"p-4",children:[d.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[d.jsxDEV(Ya,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:134,columnNumber:33},void 0),d.jsxDEV("span",{className:"text-sm font-medium",children:"Current Rating"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:135,columnNumber:33},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:133,columnNumber:31},void 0),d.jsxDEV("div",{className:"text-2xl font-bold",style:{color:u(x.rating).color},children:[x.rating.toFixed(1),"/5"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:137,columnNumber:31},void 0),d.jsxDEV("div",{className:"text-xs text-muted-foreground",children:l(x.rating)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:140,columnNumber:31},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:132,columnNumber:29},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:131,columnNumber:27},void 0),d.jsxDEV(Le,{children:d.jsxDEV(He,{className:"p-4",children:[d.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[d.jsxDEV(yr,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:149,columnNumber:33},void 0),d.jsxDEV("span",{className:"text-sm font-medium",children:"Last Inspection"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:150,columnNumber:33},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:148,columnNumber:31},void 0),d.jsxDEV("div",{className:"text-lg font-semibold",children:new Date(x.lastInspection).toLocaleDateString()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:152,columnNumber:31},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:147,columnNumber:29},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:146,columnNumber:27},void 0),d.jsxDEV(Le,{children:d.jsxDEV(He,{className:"p-4",children:[d.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[vs.createElement(u(x.rating).icon,{className:"w-4 h-4"}),d.jsxDEV("span",{className:"text-sm font-medium",children:"Status"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:162,columnNumber:33},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:160,columnNumber:31},void 0),d.jsxDEV(Ct,{variant:u(x.rating).level==="critical"?"destructive":u(x.rating).level==="needs-attention"?"secondary":"default",className:"text-xs",children:u(x.rating).level.replace("-"," ").toUpperCase()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:164,columnNumber:31},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:159,columnNumber:29},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:158,columnNumber:27},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:130,columnNumber:25},void 0),x.categories&&d.jsxDEV("div",{children:[d.jsxDEV("h4",{className:"text-sm font-medium mb-3",children:"Category Performance"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:178,columnNumber:29},void 0),d.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(x.categories).map(([p,g])=>d.jsxDEV("div",{className:"flex justify-between items-center p-2 bg-muted/50 rounded",children:[d.jsxDEV("span",{className:"text-sm",children:p},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:182,columnNumber:35},void 0),d.jsxDEV("div",{className:"flex items-center gap-1",children:[d.jsxDEV("span",{className:"text-sm font-medium",children:g.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:184,columnNumber:37},void 0),g<3&&d.jsxDEV(mn,{className:"w-3 h-3 text-orange-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:185,columnNumber:54},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:183,columnNumber:35},void 0)]},p,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:181,columnNumber:33},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:179,columnNumber:29},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:177,columnNumber:27},void 0),x.inspectionHistory&&x.inspectionHistory.length>0&&d.jsxDEV("div",{children:[d.jsxDEV("h4",{className:"text-sm font-medium mb-3",children:"Inspection History"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:196,columnNumber:29},void 0),d.jsxDEV("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:x.inspectionHistory.slice(0,5).map((p,g)=>d.jsxDEV("div",{className:"flex justify-between items-center p-2 bg-muted/30 rounded text-sm",children:[d.jsxDEV("div",{children:[d.jsxDEV("span",{className:"font-medium",children:new Date(p.date).toLocaleDateString()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:201,columnNumber:37},void 0),p.inspector&&d.jsxDEV("span",{className:"text-muted-foreground ml-2",children:["by ",p.inspector]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:203,columnNumber:39},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:200,columnNumber:35},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV("span",{className:"font-medium",children:p.rating.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:207,columnNumber:37},void 0),p.rating<3&&d.jsxDEV(mn,{className:"w-3 h-3 text-orange-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:208,columnNumber:65},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:206,columnNumber:35},void 0)]},g,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:199,columnNumber:33},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:197,columnNumber:29},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:195,columnNumber:27},void 0),x.photos&&x.photos.length>0&&d.jsxDEV("div",{children:[d.jsxDEV("h4",{className:"text-sm font-medium mb-3",children:"Inspection Photos"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:219,columnNumber:29},void 0),d.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:x.photos.slice(0,4).map((p,g)=>d.jsxDEV("div",{className:"aspect-square bg-muted rounded overflow-hidden",children:d.jsxDEV("img",{src:p,alt:`Room ${x.number} photo ${g+1}`,className:"w-full h-full object-cover"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:223,columnNumber:35},void 0)},g,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:222,columnNumber:33},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:220,columnNumber:29},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:218,columnNumber:27},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:128,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:117,columnNumber:21},void 0)]},`${h}-${x.number}`,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:99,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:95,columnNumber:15},void 0)]},h,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:86,columnNumber:13},void 0)),d.jsxDEV("div",{className:"border-t border-border pt-4",children:[d.jsxDEV("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Performance Legend"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:243,columnNumber:13},void 0),d.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV("div",{className:"w-3 h-3 rounded bg-green-100 border border-green-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:246,columnNumber:17},void 0),d.jsxDEV("span",{className:"text-muted-foreground",children:"Excellent (4.5+)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:247,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:245,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV("div",{className:"w-3 h-3 rounded bg-yellow-100 border border-yellow-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:250,columnNumber:17},void 0),d.jsxDEV("span",{className:"text-muted-foreground",children:"Good (3.5-4.4)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:251,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:249,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV("div",{className:"w-3 h-3 rounded bg-orange-100 border border-orange-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:254,columnNumber:17},void 0),d.jsxDEV("span",{className:"text-muted-foreground",children:"Fair (2.5-3.4)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:255,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:253,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV("div",{className:"w-3 h-3 rounded bg-red-100 border border-red-200"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:258,columnNumber:17},void 0),d.jsxDEV("span",{className:"text-muted-foreground",children:"Needs Attention (<2.5)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:259,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:257,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:244,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:242,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:84,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:83,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/charts/RoomHeatmap.tsx",lineNumber:73,columnNumber:5},void 0)},gg=({groupName:e,inspections:t,type:r,onInspectionClick:n})=>{const[a,i]=W.useState(!1),s=t.length,o=t.map(x=>{const g=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(v=>x[v]).filter(v=>typeof v=="number");return g.length>0?g.reduce((v,C)=>v+C,0)/g.length:null}).filter(x=>x!==null),l=o.length>0?Math.round(o.reduce((x,p)=>x+p,0)/o.length*10)/10:0,u=t.length>0?{earliest:new Date(Math.min(...t.map(x=>new Date(x.date).getTime()))),latest:new Date(Math.max(...t.map(x=>new Date(x.date).getTime())))}:null,c=()=>{switch(r){case"school":return d.jsxDEV(dn,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:57,columnNumber:16},void 0);case"date":return d.jsxDEV(yr,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:59,columnNumber:16},void 0);case"inspector":return d.jsxDEV(za,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:61,columnNumber:16},void 0);default:return d.jsxDEV(Sa,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:63,columnNumber:16},void 0)}},m=()=>{switch(r){case"school":return"School";case"date":return"Month";case"inspector":return"Inspector";default:return"Group"}},h=x=>d.jsxDEV("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(p=>d.jsxDEV(Ya,{className:`w-3 h-3 ${p<=x?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},p,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:84,columnNumber:11},void 0)),d.jsxDEV("span",{className:"ml-1 text-xs text-muted-foreground",children:x.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:93,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:82,columnNumber:7},void 0),f=()=>{if(!u)return"";const x=p=>p.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${x(u.earliest)} - ${x(u.latest)}`};return d.jsxDEV(Le,{className:"w-full",children:[d.jsxDEV(Ke,{className:"cursor-pointer",onClick:()=>i(!a),children:[d.jsxDEV(Qe,{className:"flex items-center justify-between",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[c(),d.jsxDEV("span",{className:"text-foreground",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:115,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:113,columnNumber:11},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(Ct,{variant:"secondary",className:"text-xs",children:[s," inspections"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:118,columnNumber:13},void 0),d.jsxDEV(Ye,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:a?d.jsxDEV(Fi,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:127,columnNumber:17},void 0):d.jsxDEV(yc,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:129,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:121,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:117,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:112,columnNumber:9},void 0),d.jsxDEV(ft,{className:"flex items-center justify-between",children:[d.jsxDEV("div",{className:"flex items-center gap-4",children:[d.jsxDEV("span",{className:"text-sm text-muted-foreground",children:[m(),": ",e]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:136,columnNumber:13},void 0),u&&d.jsxDEV("span",{className:"text-xs text-muted-foreground",children:f()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:140,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:135,columnNumber:11},void 0),l>0&&d.jsxDEV("div",{className:"flex items-center gap-1",children:h(Math.round(l))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:146,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:134,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:108,columnNumber:7},void 0),a&&d.jsxDEV(He,{className:"pt-0",children:d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-3 bg-muted/30 rounded-lg",children:[d.jsxDEV("div",{className:"text-center",children:[d.jsxDEV("p",{className:"text-lg font-bold text-foreground",children:s},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:159,columnNumber:17},void 0),d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Total"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:160,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:158,columnNumber:15},void 0),d.jsxDEV("div",{className:"text-center",children:[d.jsxDEV("p",{className:"text-lg font-bold text-primary",children:l.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:163,columnNumber:17},void 0),d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Avg Rating"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:164,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:162,columnNumber:15},void 0),d.jsxDEV("div",{className:"text-center",children:[d.jsxDEV("p",{className:"text-lg font-bold text-green-600",children:t.filter(x=>x.inspectionType==="single_room").length},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:167,columnNumber:17},void 0),d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Single Room"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:170,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:166,columnNumber:15},void 0),d.jsxDEV("div",{className:"text-center",children:[d.jsxDEV("p",{className:"text-lg font-bold text-blue-600",children:t.filter(x=>x.inspectionType==="whole_building").length},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:173,columnNumber:17},void 0),d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Building"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:176,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:172,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:157,columnNumber:13},void 0),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Individual Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:182,columnNumber:15},void 0),t.sort((x,p)=>new Date(p.date).getTime()-new Date(x.date).getTime()).map(x=>{var g;const p=(()=>{const C=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(b=>x[b]).filter(b=>typeof b=="number");return C.length>0?Math.round(C.reduce((b,N)=>b+N,0)/C.length*10)/10:0})();return d.jsxDEV("div",{className:"flex items-center justify-between p-3 border border-border rounded-lg hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>n==null?void 0:n(x),children:[d.jsxDEV("div",{className:"flex items-center gap-3",children:[d.jsxDEV("div",{className:"flex items-center gap-1",children:[d.jsxDEV(op,{className:"w-3 h-3 text-muted-foreground"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:210,columnNumber:27},void 0),d.jsxDEV("span",{className:"text-sm font-medium text-foreground",children:x.inspectionType==="single_room"?`Room ${(g=x.roomNumber)!=null?g:"Not specified"}`:`Building: ${x.buildingName||x.locationDescription||"Whole Building"}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:211,columnNumber:27},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:209,columnNumber:25},void 0),d.jsxDEV(Ct,{variant:x.inspectionType==="single_room"?"default":"secondary",className:"text-xs",children:x.inspectionType==="single_room"?"Single Room":"Whole Building"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:218,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:208,columnNumber:23},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[p>0&&d.jsxDEV("div",{className:"flex items-center gap-1",children:h(Math.round(p))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:227,columnNumber:27},void 0),d.jsxDEV("span",{className:"text-xs text-muted-foreground",children:new Date(x.date).toLocaleDateString()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:231,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:225,columnNumber:23},void 0)]},x.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:203,columnNumber:21},void 0)})]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:181,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:155,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:154,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/GroupedInspectionCard.tsx",lineNumber:107,columnNumber:5},void 0)},WJ=({inspections:e,onInspectionClick:t})=>{const r=e.reduce((o,l)=>(o[l.school]||(o[l.school]=[]),o[l.school].push(l),o),{}),n=Object.entries(r).sort(([,o],[,l])=>l.length-o.length),a=n.length,i=e.length,s=a>0?Math.round(i/a*10)/10:0;return d.jsxDEV("div",{className:"space-y-6",children:[d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{children:[d.jsxDEV(Qe,{className:"flex items-center gap-2 text-foreground",children:[d.jsxDEV(dn,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:40,columnNumber:13},void 0),"School Performance Overview"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:39,columnNumber:11},void 0),d.jsxDEV(ft,{className:"text-muted-foreground",children:"Inspections grouped by school with performance metrics"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:43,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:38,columnNumber:9},void 0),d.jsxDEV(He,{children:d.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxDEV("div",{className:"text-center p-4 bg-primary/10 rounded-lg",children:[d.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:d.jsxDEV(dn,{className:"w-6 h-6 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:51,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:50,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:a},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:53,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Total Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:54,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:49,columnNumber:13},void 0),d.jsxDEV("div",{className:"text-center p-4 bg-secondary/10 rounded-lg",children:[d.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:d.jsxDEV(zs,{className:"w-6 h-6 text-secondary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:58,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:57,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:i},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:60,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Total Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:61,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:56,columnNumber:13},void 0),d.jsxDEV("div",{className:"text-center p-4 bg-accent/10 rounded-lg",children:[d.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:d.jsxDEV(Ak,{className:"w-6 h-6 text-accent"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:65,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:64,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:s},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:67,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Avg per School"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:68,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:63,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:48,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:47,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:37,columnNumber:7},void 0),d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[d.jsxDEV(dn,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:77,columnNumber:11},void 0),"Schools (",a,")"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:76,columnNumber:9},void 0),n.length===0?d.jsxDEV(Le,{children:d.jsxDEV(He,{className:"text-center py-8",children:[d.jsxDEV(dn,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:84,columnNumber:15},void 0),d.jsxDEV("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No School Data"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:85,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-muted-foreground",children:"No inspection data available for school grouping."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:86,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:83,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:82,columnNumber:11},void 0):d.jsxDEV("div",{className:"space-y-3",children:n.map(([o,l])=>d.jsxDEV(gg,{groupName:o,inspections:l,type:"school",onInspectionClick:t},o,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:92,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:90,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:75,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/SchoolGroupView.tsx",lineNumber:35,columnNumber:5},void 0)},GJ=({inspections:e,onInspectionClick:t})=>{const r=e.reduce((c,m)=>{const h=new Date(m.date),f=`${h.getFullYear()}-${String(h.getMonth()+1).padStart(2,"0")}`,x=h.toLocaleDateString("en-US",{month:"long",year:"numeric"});return c[f]||(c[f]={monthName:x,inspections:[]}),c[f].inspections.push(m),c},{}),n=Object.entries(r).sort(([c],[m])=>m.localeCompare(c)),a=n.length,i=e.length,s=a>0?Math.round(i/a*10)/10:0,o=new Date().toISOString().slice(0,7),l=r[o],u=(l==null?void 0:l.inspections.length)||0;return d.jsxDEV("div",{className:"space-y-6",children:[d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{children:[d.jsxDEV(Qe,{className:"flex items-center gap-2 text-foreground",children:[d.jsxDEV(yr,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:52,columnNumber:13},void 0),"Monthly Performance Overview"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:51,columnNumber:11},void 0),d.jsxDEV(ft,{className:"text-muted-foreground",children:"Inspections grouped by month with trend analysis"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:55,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:50,columnNumber:9},void 0),d.jsxDEV(He,{children:d.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxDEV("div",{className:"text-center p-4 bg-primary/10 rounded-lg",children:[d.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:d.jsxDEV(yr,{className:"w-6 h-6 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:63,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:62,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:a},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:65,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Active Months"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:66,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:61,columnNumber:13},void 0),d.jsxDEV("div",{className:"text-center p-4 bg-secondary/10 rounded-lg",children:[d.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:d.jsxDEV(zs,{className:"w-6 h-6 text-secondary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:70,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:69,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:i},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:72,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Total Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:73,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:68,columnNumber:13},void 0),d.jsxDEV("div",{className:"text-center p-4 bg-accent/10 rounded-lg",children:[d.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:d.jsxDEV(xx,{className:"w-6 h-6 text-accent"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:77,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:76,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:s},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:79,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Avg per Month"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:80,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:75,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:60,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:59,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:49,columnNumber:7},void 0),l&&d.jsxDEV(Le,{className:"border-primary/20 bg-primary/5",children:d.jsxDEV(Ke,{children:[d.jsxDEV(Qe,{className:"flex items-center gap-2 text-primary",children:[d.jsxDEV(yr,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:91,columnNumber:15},void 0),"Current Month: ",l.monthName]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:90,columnNumber:13},void 0),d.jsxDEV(ft,{children:[u," inspections this month"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:89,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:88,columnNumber:9},void 0),d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[d.jsxDEV(yr,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:104,columnNumber:11},void 0),"Monthly Breakdown (",a," months)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:103,columnNumber:9},void 0),n.length===0?d.jsxDEV(Le,{children:d.jsxDEV(He,{className:"text-center py-8",children:[d.jsxDEV(yr,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:111,columnNumber:15},void 0),d.jsxDEV("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No Monthly Data"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:112,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-muted-foreground",children:"No inspection data available for monthly grouping."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:113,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:110,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:109,columnNumber:11},void 0):d.jsxDEV("div",{className:"space-y-3",children:n.map(([c,m])=>d.jsxDEV(gg,{groupName:m.monthName,inspections:m.inspections,type:"date",onInspectionClick:t},c,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:119,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:117,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:102,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/DateGroupView.tsx",lineNumber:47,columnNumber:5},void 0)},YJ=({inspections:e,onInspectionClick:t})=>{const r=e.reduce((u,c)=>{const m=c.inspectorName||"Unknown Inspector";return u[m]||(u[m]=[]),u[m].push(c),u},{}),n=Object.entries(r).sort(([,u],[,c])=>c.length-u.length),a=n.length,i=e.length,s=a>0?Math.round(i/a*10)/10:0,o=n[0],l=(o==null?void 0:o[1].length)||0;return d.jsxDEV("div",{className:"space-y-6",children:[d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{children:[d.jsxDEV(Qe,{className:"flex items-center gap-2 text-foreground",children:[d.jsxDEV(za,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:45,columnNumber:13},void 0),"Inspector Performance Overview"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:44,columnNumber:11},void 0),d.jsxDEV(ft,{className:"text-muted-foreground",children:"Inspections grouped by inspector with performance metrics"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:48,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:43,columnNumber:9},void 0),d.jsxDEV(He,{children:d.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxDEV("div",{className:"text-center p-4 bg-primary/10 rounded-lg",children:[d.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:d.jsxDEV(za,{className:"w-6 h-6 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:56,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:55,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:a},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:58,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Active Inspectors"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:59,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:54,columnNumber:13},void 0),d.jsxDEV("div",{className:"text-center p-4 bg-secondary/10 rounded-lg",children:[d.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:d.jsxDEV(zs,{className:"w-6 h-6 text-secondary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:63,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:62,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:i},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:65,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Total Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:66,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:61,columnNumber:13},void 0),d.jsxDEV("div",{className:"text-center p-4 bg-accent/10 rounded-lg",children:[d.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:d.jsxDEV(C1,{className:"w-6 h-6 text-accent"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:70,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:69,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-2xl font-bold text-foreground",children:s},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:72,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Avg per Inspector"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:73,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:68,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:53,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:52,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:42,columnNumber:7},void 0),o&&d.jsxDEV(Le,{className:"border-primary/20 bg-primary/5",children:d.jsxDEV(Ke,{children:[d.jsxDEV(Qe,{className:"flex items-center gap-2 text-primary",children:[d.jsxDEV(C1,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:84,columnNumber:15},void 0),"Top Performer: ",o[0]]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:83,columnNumber:13},void 0),d.jsxDEV(ft,{children:[l," inspections completed"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:87,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:82,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:81,columnNumber:9},void 0),d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[d.jsxDEV(za,{className:"w-5 h-5 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:97,columnNumber:11},void 0),"Inspectors (",a,")"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:96,columnNumber:9},void 0),n.length===0?d.jsxDEV(Le,{children:d.jsxDEV(He,{className:"text-center py-8",children:[d.jsxDEV(za,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:104,columnNumber:15},void 0),d.jsxDEV("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No Inspector Data"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:105,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-muted-foreground",children:"No inspection data available for inspector grouping."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:106,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:103,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:102,columnNumber:11},void 0):d.jsxDEV("div",{className:"space-y-3",children:n.map(([u,c])=>d.jsxDEV(gg,{groupName:u,inspections:c,type:"inspector",onInspectionClick:t},u,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:112,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:110,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:95,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/data/InspectorGroupView.tsx",lineNumber:40,columnNumber:5},void 0)},O8=2,V8=3;function Qi(e){const r=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(a=>e[a]).filter(a=>typeof a=="number");if(r.length===0)return null;const n=r.reduce((a,i)=>a+i,0)/r.length;return Math.round(n*10)/10}function vg(e){return e<O8?"critical":e<V8?"needs-attention":"acceptable"}function P8(e){const t=["urgent","emergency","safety","hazard","leak","flood","fire","electrical"],r=["immediate","asap","critical","dangerous","broken","damaged"],n=["needs","require","attention","maintenance","repair"],a=`${e.notes} ${e.location} ${e.locationDescription}`.toLowerCase();let i="low";const s=[];return t.some(o=>a.includes(o))?(i="urgent",s.push(...t.filter(o=>a.includes(o)))):r.some(o=>a.includes(o))?(i="high",s.push(...r.filter(o=>a.includes(o)))):n.some(o=>a.includes(o))&&(i="medium",s.push(...n.filter(o=>a.includes(o)))),{note:e,severity:i,keywords:s}}function bg(e){var s;const t=[],r=[];e.forEach(o=>{const l=Qi(o);if(l===null)return;const u=vg(l);if(u==="acceptable")return;const c={inspection:o,rating:l,severity:u,location:o.inspectionType==="single_room"?`Room ${o.roomNumber}`:o.buildingName||o.locationDescription||"Whole Building",school:o.school,date:o.date};u==="critical"?t.push(c):r.push(c)}),t.sort((o,l)=>o.rating-l.rating),r.sort((o,l)=>o.rating-l.rating);const n=new Set([...t,...r].map(o=>o.school)),a=[...t,...r].reduce((o,l)=>(o[l.school]=(o[l.school]||0)+1,o),{}),i=((s=Object.entries(a).sort(([,o],[,l])=>l-o)[0])==null?void 0:s[0])||null;return{critical:t,needsAttention:r,urgentNotes:[],summary:{totalProblems:t.length+r.length,criticalCount:t.length,needsAttentionCount:r.length,urgentNotesCount:0,affectedSchools:Array.from(n),mostProblematicSchool:i,mostProblematicCategory:null}}}function Ng(e){return e.map(P8).filter(t=>t.severity==="urgent"||t.severity==="high").sort((t,r)=>{const n={urgent:0,high:1,medium:2,low:3};return n[t.severity]-n[r.severity]})}function I8(e){switch(e){case"critical":return{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200",text:"Critical"};case"needs-attention":return{variant:"secondary",className:"bg-orange-100 text-orange-800 border-orange-200",text:"Needs Attention"};case"acceptable":return{variant:"default",className:"bg-green-100 text-green-800 border-green-200",text:"Acceptable"}}}function M8(e){switch(e){case"urgent":return{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200 animate-pulse",text:"URGENT"};case"high":return{variant:"secondary",className:"bg-orange-100 text-orange-800 border-orange-200",text:"High Priority"};case"medium":return{variant:"outline",className:"bg-yellow-100 text-yellow-800 border-yellow-200",text:"Medium Priority"};case"low":return{variant:"outline",className:"bg-gray-100 text-gray-800 border-gray-200",text:"Low Priority"}}}const JT=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(l_,he(H({className:Fe("grid gap-2",e)},t),{ref:r}),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/radio-group.tsx",lineNumber:12,columnNumber:5},void 0)});JT.displayName=l_.displayName;const Au=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(u_,he(H({ref:r,className:Fe("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e)},t),{children:d.jsxDEV(kk,{className:"flex items-center justify-center",children:d.jsxDEV(Fk,{className:"h-2.5 w-2.5 fill-current text-current"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/radio-group.tsx",lineNumber:35,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/radio-group.tsx",lineNumber:34,columnNumber:7},void 0)}),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/radio-group.tsx",lineNumber:26,columnNumber:5},void 0)});Au.displayName=u_.displayName;const tr=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(c_,he(H({ref:r,className:Fe("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e)},t),{children:d.jsxDEV(Uk,{className:Fe("flex items-center justify-center text-current"),children:d.jsxDEV(vx,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/checkbox.tsx",lineNumber:22,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/checkbox.tsx",lineNumber:19,columnNumber:5},void 0)}),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/checkbox.tsx",lineNumber:11,columnNumber:3},void 0)});tr.displayName=c_.displayName;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ec={};ec.version="0.18.5";var eD=1252,j8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],tD=function(e){j8.indexOf(e)!=-1&&(eD=e)};function L8(){tD(1252)}var il=function(e){tD(e)};function B8(){il(1200),L8()}var ou=function(t){return String.fromCharCode(t)},zC=function(t){return String.fromCharCode(t)},HC,Ha="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function sl(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Ha.charAt(i)+Ha.charAt(s)+Ha.charAt(o)+Ha.charAt(l);return t}function Ca(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Ha.indexOf(e.charAt(u++)),s=Ha.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=Ha.indexOf(e.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Ha.indexOf(e.charAt(u++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var ct=(function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node})(),ka=(function(){if(typeof Buffer!="undefined"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Bi(e){return ct?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}function $C(e){return ct?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}var Dn=function(t){return ct?ka(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function $c(e){if(typeof ArrayBuffer=="undefined")return Dn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function kl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function q8(e){if(typeof Uint8Array=="undefined")throw new Error("Unsupported");return new Uint8Array(e)}var fr=ct?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ka(t)}))}:function(e){if(typeof Uint8Array!="undefined"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function z8(e){for(var t=[],r=0,n=e.length+250,a=Bi(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Bi(65535),n=65530)}return t.push(a.slice(0,r)),fr(t)}var Ro=/\u0000/g,lu=/[\u0001-\u0006]/g;function _s(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function kn(e,t){var r=""+e;return r.length>=t?r:Lt("0",t-r.length)+r}function yg(e,t){var r=""+e;return r.length>=t?r:Lt(" ",t-r.length)+r}function tc(e,t){var r=""+e;return r.length>=t?r:r+Lt(" ",t-r.length)}function H8(e,t){var r=""+Math.round(e);return r.length>=t?r:Lt("0",t-r.length)+r}function $8(e,t){var r=""+e;return r.length>=t?r:Lt("0",t-r.length)+r}var WC=Math.pow(2,32);function os(e,t){if(e>WC||e<-WC)return H8(e,t);var r=Math.round(e);return $8(r,t)}function rc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var GC=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],g0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function W8(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var qt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},YC={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},G8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function nc(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,u=0,c=0,m=Math.floor(a);u<t&&(m=Math.floor(a),o=m*s+i,c=m*u+l,!(a-m<5e-8));)a=1/(a-m),i=s,s=o,l=u,u=c;if(c>t&&(u>t?(c=l,o=i):(c=u,o=s)),!r)return[0,n*o,c];var h=Math.floor(n*o/c);return[h,n*o-h*c,c]}function uu(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=e6(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var rD=new Date(1899,11,31,0,0,0),Y8=rD.getTime(),X8=new Date(1900,2,1,0,0,0);function nD(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=X8&&(r+=1440*60*1e3),(r-(Y8+(e.getTimezoneOffset()-rD.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Cg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function K8(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Q8(e){var t=e<0?12:11,r=Cg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Z8(e){var t=Cg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function J8(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Q8(e):t===10?r=e.toFixed(10).substr(0,12):r=Z8(e),Cg(K8(r.toUpperCase()))}function Up(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):J8(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ja(14,nD(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function e6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function t6(e,t,r,n){var a="",i=0,s=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return g0[r.m-1][1];case 5:return g0[r.m-1][0];default:return g0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return GC[r.q][0];default:return GC[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?kn(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=kn(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var c=u>0?kn(l,u):"";return c}function $a(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var aD=/%/g;function r6(e,t,r){var n=t.replace(aD,""),a=t.length-n.length;return pa(e,n,r*Math.pow(10,2*a))+Lt("%",a)}function n6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return pa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function iD(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+iD(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(a+i)%a)+"."+c.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var sD=/# (\?+)( ?)\/( ?)(\d+)/;function a6(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?Lt(" ",e[1].length+1+e[4].length):yg(s,e[1].length)+e[2]+"/"+e[3]+kn(o,e[4].length))}function i6(e,t,r){return r+(t===0?"":""+t)+Lt(" ",e[1].length+2+e[4].length)}var oD=/^#*0*\.([0#]+)/,lD=/\).*[0#]/,uD=/\(###\) ###\\?-####/;function Tr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function XC(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function KC(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function s6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function o6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function on(e,t,r){if(e.charCodeAt(0)===40&&!t.match(lD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?on("n",n,r):"("+on("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return n6(e,t,r);if(t.indexOf("%")!==-1)return r6(e,t,r);if(t.indexOf("E")!==-1)return iD(t,r);if(t.charCodeAt(0)===36)return"$"+on(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+os(l,t.length);if(t.match(/^[#?]+$/))return a=os(r,0),a==="0"&&(a=""),a.length>t.length?a:Tr(t.substr(0,t.length-a.length))+a;if(i=t.match(sD))return a6(i,l,u);if(t.match(/^#+0+$/))return u+os(l,t.length-t.indexOf("0"));if(i=t.match(oD))return a=XC(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Tr(i[1])).replace(/\.$/,"."+Tr(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Lt("0",Tr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+XC(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+$a(os(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+on(e,t,-r):$a(""+(Math.floor(r)+s6(r,i[1].length)))+"."+kn(KC(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return on(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_s(on(e,t.replace(/[\\-]/g,""),r)),s=0,_s(_s(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(uD))return a=on(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var c="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=nc(l,Math.pow(10,s)-1,!1),a=""+u,c=pa("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),a+=c+i[2]+"/"+i[3],c=tc(o[2],s),c.length<i[4].length&&(c=Tr(i[4].substr(i[4].length-c.length))+c),a+=c,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=nc(l,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?yg(o[1],s)+i[2]+"/"+i[3]+tc(o[2],s):Lt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=os(r,0),t.length<=a.length?a:Tr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var m=t.indexOf(".")-s,h=t.length-a.length-m;return Tr(t.substr(0,m)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=KC(r,i[1].length),r<0?"-"+on(e,t,-r):$a(o6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?kn(0,3-x.length):"")+x})+"."+kn(s,i[1].length);switch(t){case"###,##0.00":return on(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=$a(os(l,0));return f!=="0"?u+f:"";case"###,###.00":return on(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return on(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function l6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return pa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function u6(e,t,r){var n=t.replace(aD,""),a=t.length-n.length;return pa(e,n,r*Math.pow(10,2*a))+Lt("%",a)}function cD(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+cD(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(a+i)%a)+"."+c.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Mn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(lD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Mn("n",n,r):"("+Mn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return l6(e,t,r);if(t.indexOf("%")!==-1)return u6(e,t,r);if(t.indexOf("E")!==-1)return cD(t,r);if(t.charCodeAt(0)===36)return"$"+Mn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+kn(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Tr(t.substr(0,t.length-a.length))+a;if(i=t.match(sD))return i6(i,l,u);if(t.match(/^#+0+$/))return u+kn(l,t.length-t.indexOf("0"));if(i=t.match(oD))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Tr(i[1])).replace(/\.$/,"."+Tr(i[1])),a=a.replace(/\.(\d*)$/,function(x,p){return"."+p+Lt("0",Tr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+$a(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Mn(e,t,-r):$a(""+r)+"."+Lt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Mn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_s(Mn(e,t.replace(/[\\-]/g,""),r)),s=0,_s(_s(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(uD))return a=Mn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var c="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=nc(l,Math.pow(10,s)-1,!1),a=""+u,c=pa("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),a+=c+i[2]+"/"+i[3],c=tc(o[2],s),c.length<i[4].length&&(c=Tr(i[4].substr(i[4].length-c.length))+c),a+=c,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=nc(l,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?yg(o[1],s)+i[2]+"/"+i[3]+tc(o[2],s):Lt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Tr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var m=t.indexOf(".")-s,h=t.length-a.length-m;return Tr(t.substr(0,m)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Mn(e,t,-r):$a(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?kn(0,3-x.length):"")+x})+"."+kn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=$a(""+l);return f!=="0"?u+f:"";default:if(t.match(/\.[0#?]*$/))return Mn(e,t.slice(0,t.lastIndexOf(".")),r)+Tr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function pa(e,t,r){return(r|0)===r?Mn(e,t,r):on(e,t,r)}function c6(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var mD=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function dD(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":rc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(mD))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function m6(e,t,r,n){for(var a=[],i="",s=0,o="",l="t",u,c,m,h="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!rc(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(m=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(m);a[a.length]={t:"t",v:i},++s;break;case"\\":var f=e.charAt(++s),x=f==="("||f===")"?f:"t";a[a.length]={t:x,v:f},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=uu(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=uu(t,r),u==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:i},l=o;break;case"A":case"a":case"ä¸Š":var p={t:o,v:o};if(u==null&&(u=uu(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(u!=null&&(p.v=u.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),p.t="T",s+=5,h="h"):(p.t="t",++s),u==null&&p.t==="T")return"";a[a.length]=p,l=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(mD)){if(u==null&&(u=uu(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",dD(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var g=0,v=0,C;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=h,l="h",g<1&&(g=1);break;case"s":(C=a[s].v.match(/\.0+$/))&&(v=Math.max(v,C[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[s].v.match(/[Hh]/)&&(g=1),g<2&&a[s].v.match(/[Mm]/)&&(g=2),g<3&&a[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",N;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=t6(a[s].t.charCodeAt(0),a[s].v,u,v),a[s].t="t";break;case"n":case"?":for(N=s+1;a[N]!=null&&((o=a[N].t)==="?"||o==="D"||(o===" "||o==="t")&&a[N+1]!=null&&(a[N+1].t==="?"||a[N+1].t==="t"&&a[N+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[N].v==="/"||a[N].v===" "&&a[N+1]!=null&&a[N+1].t=="?"));)a[s].v+=a[N].v,a[N]={v:"",t:";"},++N;b+=a[s].v,s=N-1;break;case"G":a[s].t="t",a[s].v=Up(t,r);break}var F="",E,w;if(b.length>0){b.charCodeAt(0)==40?(E=t<0&&b.charCodeAt(0)===45?-t:t,w=pa("n",b,E)):(E=t<0&&n>1?-t:t,w=pa("n",b,E),E<0&&a[0]&&a[0].t=="t"&&(w=w.substr(1),a[0].v="-"+a[0].v)),N=w.length-1;var S=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){S=s;break}var _=a.length;if(S===a.length&&w.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(N>=a[s].v.length-1?(N-=a[s].v.length,a[s].v=w.substr(N+1,a[s].v.length)):N<0?a[s].v="":(a[s].v=w.substr(0,N+1),N=-1),a[s].t="t",_=s);N>=0&&_<a.length&&(a[_].v=w.substr(0,N+1)+a[_].v)}else if(S!==a.length&&w.indexOf("E")===-1){for(N=w.indexOf(".")-1,s=S;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(c=a[s].v.indexOf(".")>-1&&s===S?a[s].v.indexOf(".")-1:a[s].v.length-1,F=a[s].v.substr(c+1);c>=0;--c)N>=0&&(a[s].v.charAt(c)==="0"||a[s].v.charAt(c)==="#")&&(F=w.charAt(N--)+F);a[s].v=F,a[s].t="t",_=s}for(N>=0&&_<a.length&&(a[_].v=w.substr(0,N+1)+a[_].v),N=w.indexOf(".")+1,s=S;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==S)){for(c=a[s].v.indexOf(".")>-1&&s===S?a[s].v.indexOf(".")+1:0,F=a[s].v.substr(0,c);c<a[s].v.length;++c)N<w.length&&(F+=w.charAt(N++));a[s].v=F,a[s].t="t",_=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(E=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=pa(a[s].t,a[s].v,E),a[s].t="t");var U="";for(s=0;s!==a.length;++s)a[s]!=null&&(U+=a[s].v);return U}var QC=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ZC(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function d6(e,t){var r=c6(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(QC),o=r[1].match(QC);return ZC(t,s)?[n,r[0]]:ZC(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function Ja(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:qt)[e],n==null&&(n=r.table&&r.table[YC[e]]||qt[YC[e]]),n==null&&(n=G8[e]||"General");break}if(rc(n,0))return Up(t,r);t instanceof Date&&(t=nD(t,r.date1904));var a=d6(n,t);if(rc(a[1]))return Up(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return m6(a[1],t,r,a[0])}function fD(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(qt[r]==null){t<0&&(t=r);continue}if(qt[r]==e){t=r;break}}t<0&&(t=391)}return qt[t]=e,t}function Wc(e){for(var t=0;t!=392;++t)e[t]!==void 0&&fD(e[t],t)}function Gc(){qt=W8()}var hD=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function f6(e){var t=typeof e=="number"?qt[e]:e;return t=t.replace(hD,"(\\d+)"),new RegExp("^"+t+"$")}function h6(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(hD)||[]).forEach(function(m,h){var f=parseInt(r[h+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=f;break;case"d":i=f;break;case"h":s=f;break;case"s":l=f;break;case"m":s>=0?o=f:a=f;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var c=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?u:n==-1&&a==-1&&i==-1?c:u+"T"+c}var p6=(function(){var e={};e.version="1.2.0";function t(){for(var w=0,S=new Array(256),_=0;_!=256;++_)w=_,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,S[_]=w;return typeof Int32Array!="undefined"?new Int32Array(S):S}var r=t();function n(w){var S=0,_=0,U=0,R=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)R[U]=w[U];for(U=0;U!=256;++U)for(_=w[U],S=256+U;S<4096;S+=256)_=R[S]=_>>>8^w[_&255];var q=[];for(U=1;U!=16;++U)q[U-1]=typeof Int32Array!="undefined"?R.subarray(U*256,U*256+256):R.slice(U*256,U*256+256);return q}var a=n(r),i=a[0],s=a[1],o=a[2],l=a[3],u=a[4],c=a[5],m=a[6],h=a[7],f=a[8],x=a[9],p=a[10],g=a[11],v=a[12],C=a[13],b=a[14];function N(w,S){for(var _=S^-1,U=0,R=w.length;U<R;)_=_>>>8^r[(_^w.charCodeAt(U++))&255];return~_}function F(w,S){for(var _=S^-1,U=w.length-15,R=0;R<U;)_=b[w[R++]^_&255]^C[w[R++]^_>>8&255]^v[w[R++]^_>>16&255]^g[w[R++]^_>>>24]^p[w[R++]]^x[w[R++]]^f[w[R++]]^h[w[R++]]^m[w[R++]]^c[w[R++]]^u[w[R++]]^l[w[R++]]^o[w[R++]]^s[w[R++]]^i[w[R++]]^r[w[R++]];for(U+=15;R<U;)_=_>>>8^r[(_^w[R++])&255];return~_}function E(w,S){for(var _=S^-1,U=0,R=w.length,q=0,M=0;U<R;)q=w.charCodeAt(U++),q<128?_=_>>>8^r[(_^q)&255]:q<2048?(_=_>>>8^r[(_^(192|q>>6&31))&255],_=_>>>8^r[(_^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,M=w.charCodeAt(U++)&1023,_=_>>>8^r[(_^(240|q>>8&7))&255],_=_>>>8^r[(_^(128|q>>2&63))&255],_=_>>>8^r[(_^(128|M>>6&15|(q&3)<<4))&255],_=_>>>8^r[(_^(128|M&63))&255]):(_=_>>>8^r[(_^(224|q>>12&15))&255],_=_>>>8^r[(_^(128|q>>6&63))&255],_=_>>>8^r[(_^(128|q&63))&255]);return~_}return e.table=r,e.bstr=N,e.buf=F,e.str=E,e})(),Nt=(function(){var t={};t.version="1.2.1";function r(D,L){for(var O=D.split("/"),P=L.split("/"),B=0,z=0,te=Math.min(O.length,P.length);B<te;++B){if(z=O[B].length-P[B].length)return z;if(O[B]!=P[B])return O[B]<P[B]?-1:1}return O.length-P.length}function n(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:n(D.slice(0,-1));var L=D.lastIndexOf("/");return L===-1?D:D.slice(0,L+1)}function a(D){if(D.charAt(D.length-1)=="/")return a(D.slice(0,-1));var L=D.lastIndexOf("/");return L===-1?D:D.slice(L+1)}function i(D,L){typeof L=="string"&&(L=new Date(L));var O=L.getHours();O=O<<6|L.getMinutes(),O=O<<5|L.getSeconds()>>>1,D.write_shift(2,O);var P=L.getFullYear()-1980;P=P<<4|L.getMonth()+1,P=P<<5|L.getDate(),D.write_shift(2,P)}function s(D){var L=D.read_shift(2)&65535,O=D.read_shift(2)&65535,P=new Date,B=O&31;O>>>=5;var z=O&15;O>>>=4,P.setMilliseconds(0),P.setFullYear(O+1980),P.setMonth(z-1),P.setDate(B);var te=L&31;L>>>=5;var ce=L&63;return L>>>=6,P.setHours(L),P.setMinutes(ce),P.setSeconds(te<<1),P}function o(D){Yr(D,0);for(var L={},O=0;D.l<=D.length-4;){var P=D.read_shift(2),B=D.read_shift(2),z=D.l+B,te={};switch(P){case 21589:O=D.read_shift(1),O&1&&(te.mtime=D.read_shift(4)),B>5&&(O&2&&(te.atime=D.read_shift(4)),O&4&&(te.ctime=D.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break}D.l=z,L[P]=te}return L}var l;function u(){return l||(l={})}function c(D,L){if(D[0]==80&&D[1]==75)return fi(D,L);if((D[0]|32)==109&&(D[1]|32)==105)return nk(D,L);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var O=3,P=512,B=0,z=0,te=0,ce=0,ee=0,re=[],ne=D.slice(0,512);Yr(ne,0);var be=m(ne);switch(O=be[0],O){case 3:P=512;break;case 4:P=4096;break;case 0:if(be[1]==0)return fi(D,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}P!==512&&(ne=D.slice(0,P),Yr(ne,28));var De=D.slice(0,P);h(ne,O);var Ve=ne.read_shift(4,"i");if(O===3&&Ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ve);ne.l+=4,te=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),ce=ne.read_shift(4,"i"),B=ne.read_shift(4,"i"),ee=ne.read_shift(4,"i"),z=ne.read_shift(4,"i");for(var Ce=-1,Ue=0;Ue<109&&(Ce=ne.read_shift(4,"i"),!(Ce<0));++Ue)re[Ue]=Ce;var $e=f(D,P);g(ee,z,$e,P,re);var Vt=C($e,te,re,P);Vt[te].name="!Directory",B>0&&ce!==M&&(Vt[ce].name="!MiniFAT"),Vt[re[0]].name="!FAT",Vt.fat_addrs=re,Vt.ssz=P;var Pt={},br=[],oo=[],lo=[];b(te,Vt,$e,br,B,Pt,oo,ce),x(oo,lo,br),br.shift();var uo={FileIndex:oo,FullPaths:lo};return L&&L.raw&&(uo.raw={header:De,sectors:$e}),uo}function m(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(Y,"Header Signature: "),D.l+=16;var L=D.read_shift(2,"u");return[D.read_shift(2,"u"),L]}function h(D,L){var O=9;switch(D.l+=2,O=D.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function f(D,L){for(var O=Math.ceil(D.length/L)-1,P=[],B=1;B<O;++B)P[B-1]=D.slice(B*L,(B+1)*L);return P[O-1]=D.slice(O*L),P}function x(D,L,O){for(var P=0,B=0,z=0,te=0,ce=0,ee=O.length,re=[],ne=[];P<ee;++P)re[P]=ne[P]=P,L[P]=O[P];for(;ce<ne.length;++ce)P=ne[ce],B=D[P].L,z=D[P].R,te=D[P].C,re[P]===P&&(B!==-1&&re[B]!==B&&(re[P]=re[B]),z!==-1&&re[z]!==z&&(re[P]=re[z])),te!==-1&&(re[te]=P),B!==-1&&P!=re[P]&&(re[B]=re[P],ne.lastIndexOf(B)<ce&&ne.push(B)),z!==-1&&P!=re[P]&&(re[z]=re[P],ne.lastIndexOf(z)<ce&&ne.push(z));for(P=1;P<ee;++P)re[P]===P&&(z!==-1&&re[z]!==z?re[P]=re[z]:B!==-1&&re[B]!==B&&(re[P]=re[B]));for(P=1;P<ee;++P)if(D[P].type!==0){if(ce=P,ce!=re[ce])do ce=re[ce],L[P]=L[ce]+"/"+L[P];while(ce!==0&&re[ce]!==-1&&ce!=re[ce]);re[P]=-1}for(L[0]+="/",P=1;P<ee;++P)D[P].type!==2&&(L[P]+="/")}function p(D,L,O){for(var P=D.start,B=D.size,z=[],te=P;O&&B>0&&te>=0;)z.push(L.slice(te*q,te*q+q)),B-=q,te=Ci(O,te*4);return z.length===0?ue(0):fr(z).slice(0,D.size)}function g(D,L,O,P,B){var z=M;if(D===M){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var te=O[D],ce=(P>>>2)-1;if(!te)return;for(var ee=0;ee<ce&&(z=Ci(te,ee*4))!==M;++ee)B.push(z);g(Ci(te,P-4),L-1,O,P,B)}}function v(D,L,O,P,B){var z=[],te=[];B||(B=[]);var ce=P-1,ee=0,re=0;for(ee=L;ee>=0;){B[ee]=!0,z[z.length]=ee,te.push(D[ee]);var ne=O[Math.floor(ee*4/P)];if(re=ee*4&ce,P<4+re)throw new Error("FAT boundary crossed: "+ee+" 4 "+P);if(!D[ne])break;ee=Ci(D[ne],re)}return{nodes:z,data:s2([te])}}function C(D,L,O,P){var B=D.length,z=[],te=[],ce=[],ee=[],re=P-1,ne=0,be=0,De=0,Ve=0;for(ne=0;ne<B;++ne)if(ce=[],De=ne+L,De>=B&&(De-=B),!te[De]){ee=[];var Ce=[];for(be=De;be>=0;){Ce[be]=!0,te[be]=!0,ce[ce.length]=be,ee.push(D[be]);var Ue=O[Math.floor(be*4/P)];if(Ve=be*4&re,P<4+Ve)throw new Error("FAT boundary crossed: "+be+" 4 "+P);if(!D[Ue]||(be=Ci(D[Ue],Ve),Ce[be]))break}z[De]={nodes:ce,data:s2([ee])}}return z}function b(D,L,O,P,B,z,te,ce){for(var ee=0,re=P.length?2:0,ne=L[D].data,be=0,De=0,Ve;be<ne.length;be+=128){var Ce=ne.slice(be,be+128);Yr(Ce,64),De=Ce.read_shift(2),Ve=Tg(Ce,0,De-re),P.push(Ve);var Ue={name:Ve,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},$e=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);$e!==0&&(Ue.ct=N(Ce,Ce.l-8));var Vt=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Vt!==0&&(Ue.mt=N(Ce,Ce.l-8)),Ue.start=Ce.read_shift(4,"i"),Ue.size=Ce.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=M,Ue.name=""),Ue.type===5?(ee=Ue.start,B>0&&ee!==M&&(L[ee].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",L[Ue.start]===void 0&&(L[Ue.start]=v(O,Ue.start,L.fat_addrs,L.ssz)),L[Ue.start].name=Ue.name,Ue.content=L[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:ee!==M&&Ue.start!==M&&L[ee]&&(Ue.content=p(Ue,L[ee].data,(L[ce]||{}).data))),Ue.content&&Yr(Ue.content,0),z[Ve]=Ue,te.push(Ue)}}function N(D,L){return new Date((Qr(D,L+4)/1e7*Math.pow(2,32)+Qr(D,L)/1e7-11644473600)*1e3)}function F(D,L){return u(),c(l.readFileSync(D),L)}function E(D,L){var O=L&&L.type;switch(O||ct&&Buffer.isBuffer(D)&&(O="buffer"),O||"base64"){case"file":return F(D,L);case"base64":return c(Dn(Ca(D)),L);case"binary":return c(Dn(D),L)}return c(D,L)}function w(D,L){var O=L||{},P=O.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=P+"/",D.FileIndex[0]={name:P,type:5}),O.CLSID&&(D.FileIndex[0].clsid=O.CLSID),S(D)}function S(D){var L="Sh33tJ5";if(!Nt.find(D,"/"+L)){var O=ue(4);O[0]=55,O[1]=O[3]=50,O[2]=54,D.FileIndex.push({name:L,type:2,content:O,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+L),_(D)}}function _(D,L){w(D);for(var O=!1,P=!1,B=D.FullPaths.length-1;B>=0;--B){var z=D.FileIndex[B];switch(z.type){case 0:P?O=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(z.R*z.L*z.C)&&(O=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!L)){var te=new Date(1987,1,19),ce=0,ee=Object.create?Object.create(null):{},re=[];for(B=0;B<D.FullPaths.length;++B)ee[D.FullPaths[B]]=!0,D.FileIndex[B].type!==0&&re.push([D.FullPaths[B],D.FileIndex[B]]);for(B=0;B<re.length;++B){var ne=n(re[B][0]);P=ee[ne],P||(re.push([ne,{name:a(ne).replace("/",""),type:1,clsid:de,ct:te,mt:te,content:null}]),ee[ne]=!0)}for(re.sort(function(Ve,Ce){return r(Ve[0],Ce[0])}),D.FullPaths=[],D.FileIndex=[],B=0;B<re.length;++B)D.FullPaths[B]=re[B][0],D.FileIndex[B]=re[B][1];for(B=0;B<re.length;++B){var be=D.FileIndex[B],De=D.FullPaths[B];if(be.name=a(De).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||de,B===0)be.C=re.length>1?1:-1,be.size=0,be.type=5;else if(De.slice(-1)=="/"){for(ce=B+1;ce<re.length&&n(D.FullPaths[ce])!=De;++ce);for(be.C=ce>=re.length?-1:ce,ce=B+1;ce<re.length&&n(D.FullPaths[ce])!=n(De);++ce);be.R=ce>=re.length?-1:ce,be.type=1}else n(D.FullPaths[B+1]||"")==n(De)&&(be.R=B+1),be.type=2}}}function U(D,L){var O=L||{};if(O.fileType=="mad")return ak(D,O);switch(_(D),O.fileType){case"zip":return vr(D,O)}var P=(function(Ve){for(var Ce=0,Ue=0,$e=0;$e<Ve.FileIndex.length;++$e){var Vt=Ve.FileIndex[$e];if(Vt.content){var Pt=Vt.content.length;Pt>0&&(Pt<4096?Ce+=Pt+63>>6:Ue+=Pt+511>>9)}}for(var br=Ve.FullPaths.length+3>>2,oo=Ce+7>>3,lo=Ce+127>>7,uo=oo+Ue+br+lo,hi=uo+127>>7,om=hi<=109?0:Math.ceil((hi-109)/127);uo+hi+om+127>>7>hi;)om=++hi<=109?0:Math.ceil((hi-109)/127);var aa=[1,om,hi,lo,br,Ue,Ce,0];return Ve.FileIndex[0].size=Ce<<6,aa[7]=(Ve.FileIndex[0].start=aa[0]+aa[1]+aa[2]+aa[3]+aa[4]+aa[5])+(aa[6]+7>>3),aa})(D),B=ue(P[7]<<9),z=0,te=0;{for(z=0;z<8;++z)B.write_shift(1,K[z]);for(z=0;z<8;++z)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),z=0;z<3;++z)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,P[2]),B.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:M),B.write_shift(4,P[3]),B.write_shift(-4,P[1]?P[0]-1:M),B.write_shift(4,P[1]),z=0;z<109;++z)B.write_shift(-4,z<P[2]?P[1]+z:-1)}if(P[1])for(te=0;te<P[1];++te){for(;z<236+te*127;++z)B.write_shift(-4,z<P[2]?P[1]+z:-1);B.write_shift(-4,te===P[1]-1?M:te+1)}var ce=function(Ve){for(te+=Ve;z<te-1;++z)B.write_shift(-4,z+1);Ve&&(++z,B.write_shift(-4,M))};for(te=z=0,te+=P[1];z<te;++z)B.write_shift(-4,pe.DIFSECT);for(te+=P[2];z<te;++z)B.write_shift(-4,pe.FATSECT);ce(P[3]),ce(P[4]);for(var ee=0,re=0,ne=D.FileIndex[0];ee<D.FileIndex.length;++ee)ne=D.FileIndex[ee],ne.content&&(re=ne.content.length,!(re<4096)&&(ne.start=te,ce(re+511>>9)));for(ce(P[6]+7>>3);B.l&511;)B.write_shift(-4,pe.ENDOFCHAIN);for(te=z=0,ee=0;ee<D.FileIndex.length;++ee)ne=D.FileIndex[ee],ne.content&&(re=ne.content.length,!(!re||re>=4096)&&(ne.start=te,ce(re+63>>6)));for(;B.l&511;)B.write_shift(-4,pe.ENDOFCHAIN);for(z=0;z<P[4]<<2;++z){var be=D.FullPaths[z];if(!be||be.length===0){for(ee=0;ee<17;++ee)B.write_shift(4,0);for(ee=0;ee<3;++ee)B.write_shift(4,-1);for(ee=0;ee<12;++ee)B.write_shift(4,0);continue}ne=D.FileIndex[z],z===0&&(ne.start=ne.size?ne.start-1:M);var De=z===0&&O.root||ne.name;if(re=2*(De.length+1),B.write_shift(64,De,"utf16le"),B.write_shift(2,re),B.write_shift(1,ne.type),B.write_shift(1,ne.color),B.write_shift(-4,ne.L),B.write_shift(-4,ne.R),B.write_shift(-4,ne.C),ne.clsid)B.write_shift(16,ne.clsid,"hex");else for(ee=0;ee<4;++ee)B.write_shift(4,0);B.write_shift(4,ne.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,ne.start),B.write_shift(4,ne.size),B.write_shift(4,0)}for(z=1;z<D.FileIndex.length;++z)if(ne=D.FileIndex[z],ne.size>=4096)if(B.l=ne.start+1<<9,ct&&Buffer.isBuffer(ne.content))ne.content.copy(B,B.l,0,ne.size),B.l+=ne.size+511&-512;else{for(ee=0;ee<ne.size;++ee)B.write_shift(1,ne.content[ee]);for(;ee&511;++ee)B.write_shift(1,0)}for(z=1;z<D.FileIndex.length;++z)if(ne=D.FileIndex[z],ne.size>0&&ne.size<4096)if(ct&&Buffer.isBuffer(ne.content))ne.content.copy(B,B.l,0,ne.size),B.l+=ne.size+63&-64;else{for(ee=0;ee<ne.size;++ee)B.write_shift(1,ne.content[ee]);for(;ee&63;++ee)B.write_shift(1,0)}if(ct)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function R(D,L){var O=D.FullPaths.map(function(ee){return ee.toUpperCase()}),P=O.map(function(ee){var re=ee.split("/");return re[re.length-(ee.slice(-1)=="/"?2:1)]}),B=!1;L.charCodeAt(0)===47?(B=!0,L=O[0].slice(0,-1)+L):B=L.indexOf("/")!==-1;var z=L.toUpperCase(),te=B===!0?O.indexOf(z):P.indexOf(z);if(te!==-1)return D.FileIndex[te];var ce=!z.match(lu);for(z=z.replace(Ro,""),ce&&(z=z.replace(lu,"!")),te=0;te<O.length;++te)if((ce?O[te].replace(lu,"!"):O[te]).replace(Ro,"")==z||(ce?P[te].replace(lu,"!"):P[te]).replace(Ro,"")==z)return D.FileIndex[te];return null}var q=64,M=-2,Y="d0cf11e0a1b11ae1",K=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",pe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:Y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ae(D,L,O){u();var P=U(D,O);l.writeFileSync(L,P)}function Ne(D){for(var L=new Array(D.length),O=0;O<D.length;++O)L[O]=String.fromCharCode(D[O]);return L.join("")}function k(D,L){var O=U(D,L);switch(L&&L.type||"buffer"){case"file":return u(),l.writeFileSync(L.filename,O),O;case"binary":return typeof O=="string"?O:Ne(O);case"base64":return sl(typeof O=="string"?O:Ne(O));case"buffer":if(ct)return Buffer.isBuffer(O)?O:ka(O);case"array":return typeof O=="string"?Dn(O):O}return O}var le;function j(D){try{var L=D.InflateRaw,O=new L;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)le=D;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function y(D,L){if(!le)return ut(D,L);var O=le.InflateRaw,P=new O,B=P._processChunk(D.slice(D.l),P._finishFlushFlag);return D.l+=P.bytesRead,B}function V(D){return le?le.deflateRawSync(D):xe(D)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(D){var L=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(L>>16|L>>8|L)&255}for(var Q=typeof Uint8Array!="undefined",Z=Q?new Uint8Array(256):[],ve=0;ve<256;++ve)Z[ve]=ae(ve);function J(D,L){var O=Z[D&255];return L<=8?O>>>8-L:(O=O<<8|Z[D>>8&255],L<=16?O>>>16-L:(O=O<<8|Z[D>>16&255],O>>>24-L))}function je(D,L){var O=L&7,P=L>>>3;return(D[P]|(O<=6?0:D[P+1]<<8))>>>O&3}function ke(D,L){var O=L&7,P=L>>>3;return(D[P]|(O<=5?0:D[P+1]<<8))>>>O&7}function tt(D,L){var O=L&7,P=L>>>3;return(D[P]|(O<=4?0:D[P+1]<<8))>>>O&15}function ze(D,L){var O=L&7,P=L>>>3;return(D[P]|(O<=3?0:D[P+1]<<8))>>>O&31}function Se(D,L){var O=L&7,P=L>>>3;return(D[P]|(O<=1?0:D[P+1]<<8))>>>O&127}function Ot(D,L,O){var P=L&7,B=L>>>3,z=(1<<O)-1,te=D[B]>>>P;return O<8-P||(te|=D[B+1]<<8-P,O<16-P)||(te|=D[B+2]<<16-P,O<24-P)||(te|=D[B+3]<<24-P),te&z}function cr(D,L,O){var P=L&7,B=L>>>3;return P<=5?D[B]|=(O&7)<<P:(D[B]|=O<<P&255,D[B+1]=(O&7)>>8-P),L+3}function Zt(D,L,O){var P=L&7,B=L>>>3;return O=(O&1)<<P,D[B]|=O,L+1}function zt(D,L,O){var P=L&7,B=L>>>3;return O<<=P,D[B]|=O&255,O>>>=8,D[B+1]=O,L+8}function nr(D,L,O){var P=L&7,B=L>>>3;return O<<=P,D[B]|=O&255,O>>>=8,D[B+1]=O&255,D[B+2]=O>>>8,L+16}function gr(D,L){var O=D.length,P=2*O>L?2*O:L+5,B=0;if(O>=L)return D;if(ct){var z=$C(P);if(D.copy)D.copy(z);else for(;B<D.length;++B)z[B]=D[B];return z}else if(Q){var te=new Uint8Array(P);if(te.set)te.set(D);else for(;B<O;++B)te[B]=D[B];return te}return D.length=P,D}function ht(D){for(var L=new Array(D),O=0;O<D;++O)L[O]=0;return L}function Rr(D,L,O){var P=1,B=0,z=0,te=0,ce=0,ee=D.length,re=Q?new Uint16Array(32):ht(32);for(z=0;z<32;++z)re[z]=0;for(z=ee;z<O;++z)D[z]=0;ee=D.length;var ne=Q?new Uint16Array(ee):ht(ee);for(z=0;z<ee;++z)re[B=D[z]]++,P<B&&(P=B),ne[z]=0;for(re[0]=0,z=1;z<=P;++z)re[z+16]=ce=ce+re[z-1]<<1;for(z=0;z<ee;++z)ce=D[z],ce!=0&&(ne[z]=re[ce+16]++);var be=0;for(z=0;z<ee;++z)if(be=D[z],be!=0)for(ce=J(ne[z],P)>>P-be,te=(1<<P+4-be)-1;te>=0;--te)L[ce|te<<be]=be&15|z<<4;return P}var se=Q?new Uint16Array(512):ht(512),oe=Q?new Uint16Array(32):ht(32);if(!Q){for(var Te=0;Te<512;++Te)se[Te]=0;for(Te=0;Te<32;++Te)oe[Te]=0}(function(){for(var D=[],L=0;L<32;L++)D.push(5);Rr(D,oe,32);var O=[];for(L=0;L<=143;L++)O.push(8);for(;L<=255;L++)O.push(9);for(;L<=279;L++)O.push(7);for(;L<=287;L++)O.push(8);Rr(O,se,288)})();var qe=(function(){for(var L=Q?new Uint8Array(32768):[],O=0,P=0;O<ie.length-1;++O)for(;P<ie[O+1];++P)L[P]=O;for(;P<32768;++P)L[P]=29;var B=Q?new Uint8Array(259):[];for(O=0,P=0;O<G.length-1;++O)for(;P<G[O+1];++P)B[P]=O;function z(ce,ee){for(var re=0;re<ce.length;){var ne=Math.min(65535,ce.length-re),be=re+ne==ce.length;for(ee.write_shift(1,+be),ee.write_shift(2,ne),ee.write_shift(2,~ne&65535);ne-- >0;)ee[ee.l++]=ce[re++]}return ee.l}function te(ce,ee){for(var re=0,ne=0,be=Q?new Uint16Array(32768):[];ne<ce.length;){var De=Math.min(65535,ce.length-ne);if(De<10){for(re=cr(ee,re,+(ne+De==ce.length)),re&7&&(re+=8-(re&7)),ee.l=re/8|0,ee.write_shift(2,De),ee.write_shift(2,~De&65535);De-- >0;)ee[ee.l++]=ce[ne++];re=ee.l*8;continue}re=cr(ee,re,+(ne+De==ce.length)+2);for(var Ve=0;De-- >0;){var Ce=ce[ne];Ve=(Ve<<5^Ce)&32767;var Ue=-1,$e=0;if((Ue=be[Ve])&&(Ue|=ne&-32768,Ue>ne&&(Ue-=32768),Ue<ne))for(;ce[Ue+$e]==ce[ne+$e]&&$e<250;)++$e;if($e>2){Ce=B[$e],Ce<=22?re=zt(ee,re,Z[Ce+1]>>1)-1:(zt(ee,re,3),re+=5,zt(ee,re,Z[Ce-23]>>5),re+=3);var Vt=Ce<8?0:Ce-4>>2;Vt>0&&(nr(ee,re,$e-G[Ce]),re+=Vt),Ce=L[ne-Ue],re=zt(ee,re,Z[Ce]>>3),re-=3;var Pt=Ce<4?0:Ce-2>>1;Pt>0&&(nr(ee,re,ne-Ue-ie[Ce]),re+=Pt);for(var br=0;br<$e;++br)be[Ve]=ne&32767,Ve=(Ve<<5^ce[ne])&32767,++ne;De-=$e-1}else Ce<=143?Ce=Ce+48:re=Zt(ee,re,1),re=zt(ee,re,Z[Ce]),be[Ve]=ne&32767,++ne}re=zt(ee,re,0)-1}return ee.l=(re+7)/8|0,ee.l}return function(ee,re){return ee.length<8?z(ee,re):te(ee,re)}})();function xe(D){var L=ue(50+Math.floor(D.length*1.1)),O=qe(D,L);return L.slice(0,O)}var Oe=Q?new Uint16Array(32768):ht(32768),Be=Q?new Uint16Array(32768):ht(32768),Je=Q?new Uint16Array(128):ht(128),mt=1,kt=1;function rt(D,L){var O=ze(D,L)+257;L+=5;var P=ze(D,L)+1;L+=5;var B=tt(D,L)+4;L+=4;for(var z=0,te=Q?new Uint8Array(19):ht(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,re=Q?new Uint8Array(8):ht(8),ne=Q?new Uint8Array(8):ht(8),be=te.length,De=0;De<B;++De)te[I[De]]=z=ke(D,L),ee<z&&(ee=z),re[z]++,L+=3;var Ve=0;for(re[0]=0,De=1;De<=ee;++De)ne[De]=Ve=Ve+re[De-1]<<1;for(De=0;De<be;++De)(Ve=te[De])!=0&&(ce[De]=ne[Ve]++);var Ce=0;for(De=0;De<be;++De)if(Ce=te[De],Ce!=0){Ve=Z[ce[De]]>>8-Ce;for(var Ue=(1<<7-Ce)-1;Ue>=0;--Ue)Je[Ve|Ue<<Ce]=Ce&7|De<<3}var $e=[];for(ee=1;$e.length<O+P;)switch(Ve=Je[Se(D,L)],L+=Ve&7,Ve>>>=3){case 16:for(z=3+je(D,L),L+=2,Ve=$e[$e.length-1];z-- >0;)$e.push(Ve);break;case 17:for(z=3+ke(D,L),L+=3;z-- >0;)$e.push(0);break;case 18:for(z=11+Se(D,L),L+=7;z-- >0;)$e.push(0);break;default:$e.push(Ve),ee<Ve&&(ee=Ve);break}var Vt=$e.slice(0,O),Pt=$e.slice(O);for(De=O;De<286;++De)Vt[De]=0;for(De=P;De<30;++De)Pt[De]=0;return mt=Rr(Vt,Oe,286),kt=Rr(Pt,Be,30),L}function Jt(D,L){if(D[0]==3&&!(D[1]&3))return[Bi(L),2];for(var O=0,P=0,B=$C(L||1<<18),z=0,te=B.length>>>0,ce=0,ee=0;(P&1)==0;){if(P=ke(D,O),O+=3,P>>>1)P>>1==1?(ce=9,ee=5):(O=rt(D,O),ce=mt,ee=kt);else{O&7&&(O+=8-(O&7));var re=D[O>>>3]|D[(O>>>3)+1]<<8;if(O+=32,re>0)for(!L&&te<z+re&&(B=gr(B,z+re),te=B.length);re-- >0;)B[z++]=D[O>>>3],O+=8;continue}for(;;){!L&&te<z+32767&&(B=gr(B,z+32767),te=B.length);var ne=Ot(D,O,ce),be=P>>>1==1?se[ne]:Oe[ne];if(O+=be&15,be>>>=4,(be>>>8&255)===0)B[z++]=be;else{if(be==256)break;be-=257;var De=be<8?0:be-4>>2;De>5&&(De=0);var Ve=z+G[be];De>0&&(Ve+=Ot(D,O,De),O+=De),ne=Ot(D,O,ee),be=P>>>1==1?oe[ne]:Be[ne],O+=be&15,be>>>=4;var Ce=be<4?0:be-2>>1,Ue=ie[be];for(Ce>0&&(Ue+=Ot(D,O,Ce),O+=Ce),!L&&te<Ve&&(B=gr(B,Ve+100),te=B.length);z<Ve;)B[z]=B[z-Ue],++z}}}return L?[B,O+7>>>3]:[B.slice(0,z),O+7>>>3]}function ut(D,L){var O=D.slice(D.l||0),P=Jt(O,L);return D.l+=P[1],P[0]}function nn(D,L){if(D)typeof console!="undefined"&&console.error(L);else throw new Error(L)}function fi(D,L){var O=D;Yr(O,0);var P=[],B=[],z={FileIndex:P,FullPaths:B};w(z,{root:L.root});for(var te=O.length-4;(O[te]!=80||O[te+1]!=75||O[te+2]!=5||O[te+3]!=6)&&te>=0;)--te;O.l=te+4,O.l+=4;var ce=O.read_shift(2);O.l+=6;var ee=O.read_shift(4);for(O.l=ee,te=0;te<ce;++te){O.l+=20;var re=O.read_shift(4),ne=O.read_shift(4),be=O.read_shift(2),De=O.read_shift(2),Ve=O.read_shift(2);O.l+=8;var Ce=O.read_shift(4),Ue=o(O.slice(O.l+be,O.l+be+De));O.l+=be+De+Ve;var $e=O.l;O.l=Ce+4,so(O,re,ne,z,Ue),O.l=$e}return z}function so(D,L,O,P,B){D.l+=2;var z=D.read_shift(2),te=D.read_shift(2),ce=s(D);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var ee=D.read_shift(4),re=D.read_shift(4),ne=D.read_shift(4),be=D.read_shift(2),De=D.read_shift(2),Ve="",Ce=0;Ce<be;++Ce)Ve+=String.fromCharCode(D[D.l++]);if(De){var Ue=o(D.slice(D.l,D.l+De));(Ue[21589]||{}).mt&&(ce=Ue[21589].mt),((B||{})[21589]||{}).mt&&(ce=B[21589].mt)}D.l+=De;var $e=D.slice(D.l,D.l+re);switch(te){case 8:$e=y(D,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+te)}var Vt=!1;z&8&&(ee=D.read_shift(4),ee==134695760&&(ee=D.read_shift(4),Vt=!0),re=D.read_shift(4),ne=D.read_shift(4)),re!=L&&nn(Vt,"Bad compressed size: "+L+" != "+re),ne!=O&&nn(Vt,"Bad uncompressed size: "+O+" != "+ne),sm(P,Ve,$e,{unsafe:!0,mt:ce})}function vr(D,L){var O=L||{},P=[],B=[],z=ue(1),te=O.compression?8:0,ce=0,ee=0,re=0,ne=0,be=0,De=D.FullPaths[0],Ve=De,Ce=D.FileIndex[0],Ue=[],$e=0;for(ee=1;ee<D.FullPaths.length;++ee)if(Ve=D.FullPaths[ee].slice(De.length),Ce=D.FileIndex[ee],!(!Ce.size||!Ce.content||Ve=="Sh33tJ5")){var Vt=ne,Pt=ue(Ve.length);for(re=0;re<Ve.length;++re)Pt.write_shift(1,Ve.charCodeAt(re)&127);Pt=Pt.slice(0,Pt.l),Ue[be]=p6.buf(Ce.content,0);var br=Ce.content;te==8&&(br=V(br)),z=ue(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,ce),z.write_shift(2,te),Ce.mt?i(z,Ce.mt):z.write_shift(4,0),z.write_shift(-4,Ue[be]),z.write_shift(4,br.length),z.write_shift(4,Ce.content.length),z.write_shift(2,Pt.length),z.write_shift(2,0),ne+=z.length,P.push(z),ne+=Pt.length,P.push(Pt),ne+=br.length,P.push(br),z=ue(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,ce),z.write_shift(2,te),z.write_shift(4,0),z.write_shift(-4,Ue[be]),z.write_shift(4,br.length),z.write_shift(4,Ce.content.length),z.write_shift(2,Pt.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Vt),$e+=z.l,B.push(z),$e+=Pt.length,B.push(Pt),++be}return z=ue(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,be),z.write_shift(2,be),z.write_shift(4,$e),z.write_shift(4,ne),z.write_shift(2,0),fr([fr(P),fr(B),z])}var Hl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Z4(D,L){if(D.ctype)return D.ctype;var O=D.name||"",P=O.match(/\.([^\.]+)$/);return P&&Hl[P[1]]||L&&(P=(O=L).match(/[\.\\]([^\.\\])+$/),P&&Hl[P[1]])?Hl[P[1]]:"application/octet-stream"}function J4(D){for(var L=sl(D),O=[],P=0;P<L.length;P+=76)O.push(L.slice(P,P+76));return O.join(`\r
`)+`\r
`}function ek(D){var L=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ne=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],P=L.split(`\r
`),B=0;B<P.length;++B){var z=P[B];if(z.length==0){O.push("");continue}for(var te=0;te<z.length;){var ce=76,ee=z.slice(te,te+ce);ee.charAt(ce-1)=="="?ce--:ee.charAt(ce-2)=="="?ce-=2:ee.charAt(ce-3)=="="&&(ce-=3),ee=z.slice(te,te+ce),te+=ce,te<z.length&&(ee+="="),O.push(ee)}}return O.join(`\r
`)}function tk(D){for(var L=[],O=0;O<D.length;++O){for(var P=D[O];O<=D.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+D[++O];L.push(P)}for(var B=0;B<L.length;++B)L[B]=L[B].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return Dn(L.join(`\r
`))}function rk(D,L,O){for(var P="",B="",z="",te,ce=0;ce<10;++ce){var ee=L[ce];if(!ee||ee.match(/^\s*$/))break;var re=ee.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":P=re[2].trim();break;case"content-type":z=re[2].trim();break;case"content-transfer-encoding":B=re[2].trim();break}}switch(++ce,B.toLowerCase()){case"base64":te=Dn(Ca(L.slice(ce).join("")));break;case"quoted-printable":te=tk(L.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var ne=sm(D,P.slice(O.length),te,{unsafe:!0});z&&(ne.ctype=z)}function nk(D,L){if(Ne(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=L&&L.root||"",P=(ct&&Buffer.isBuffer(D)?D.toString("binary"):Ne(D)).split(`\r
`),B=0,z="";for(B=0;B<P.length;++B)if(z=P[B],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),O||(O=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),z.slice(0,O.length)!=O););var te=(P[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var ce="--"+(te[1]||""),ee=[],re=[],ne={FileIndex:ee,FullPaths:re};w(ne);var be,De=0;for(B=0;B<P.length;++B){var Ve=P[B];Ve!==ce&&Ve!==ce+"--"||(De++&&rk(ne,P.slice(be,B),O),be=B)}return ne}function ak(D,L){var O=L||{},P=O.boundary||"SheetJS";P="------="+P;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],z=D.FullPaths[0],te=z,ce=D.FileIndex[0],ee=1;ee<D.FullPaths.length;++ee)if(te=D.FullPaths[ee].slice(z.length),ce=D.FileIndex[ee],!(!ce.size||!ce.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function($e){return"_x"+$e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function($e){return"_u"+$e.charCodeAt(0).toString(16)+"_"});for(var re=ce.content,ne=ct&&Buffer.isBuffer(re)?re.toString("binary"):Ne(re),be=0,De=Math.min(1024,ne.length),Ve=0,Ce=0;Ce<=De;++Ce)(Ve=ne.charCodeAt(Ce))>=32&&Ve<128&&++be;var Ue=be>=De*4/5;B.push(P),B.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+te),B.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),B.push("Content-Type: "+Z4(ce,te)),B.push(""),B.push(Ue?ek(ne):J4(ne))}return B.push(P+`--\r
`),B.join(`\r
`)}function ik(D){var L={};return w(L,D),L}function sm(D,L,O,P){var B=P&&P.unsafe;B||w(D);var z=!B&&Nt.find(D,L);if(!z){var te=D.FullPaths[0];L.slice(0,te.length)==te?te=L:(te.slice(-1)!="/"&&(te+="/"),te=(te+L).replace("//","/")),z={name:a(L),type:2},D.FileIndex.push(z),D.FullPaths.push(te),B||Nt.utils.cfb_gc(D)}return z.content=O,z.size=O?O.length:0,P&&(P.CLSID&&(z.clsid=P.CLSID),P.mt&&(z.mt=P.mt),P.ct&&(z.ct=P.ct)),z}function sk(D,L){w(D);var O=Nt.find(D,L);if(O){for(var P=0;P<D.FileIndex.length;++P)if(D.FileIndex[P]==O)return D.FileIndex.splice(P,1),D.FullPaths.splice(P,1),!0}return!1}function ok(D,L,O){w(D);var P=Nt.find(D,L);if(P){for(var B=0;B<D.FileIndex.length;++B)if(D.FileIndex[B]==P)return D.FileIndex[B].name=a(O),D.FullPaths[B]=O,!0}return!1}function lk(D){_(D,!0)}return t.find=R,t.read=E,t.parse=c,t.write=k,t.writeFile=Ae,t.utils={cfb_new:ik,cfb_add:sm,cfb_del:sk,cfb_mov:ok,cfb_gc:lk,ReadShift:Vo,CheckField:UD,prep_blob:Yr,bconcat:fr,use_zlib:j,_deflateRaw:xe,_inflateRaw:ut,consts:pe},t})();function x6(e){return typeof e=="string"?$c(e):Array.isArray(e)?q8(e):e}function Fl(e,t,r){if(typeof Deno!="undefined"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=$c(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?ll(t):t;if(typeof IE_SaveFile!="undefined")return IE_SaveFile(n,e);if(typeof Blob!="undefined"){var a=new Blob([x6(n)],{type:"application/octet-stream"});if(typeof navigator!="undefined"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs!="undefined")return saveAs(a,e);if(typeof URL!="undefined"&&typeof document!="undefined"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=kl(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function xr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function JC(e,t){for(var r=[],n=xr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function wg(e){for(var t=[],r=xr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Yc(e){for(var t=[],r=xr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function g6(e){for(var t=[],r=xr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var ac=new Date(1899,11,30,0,0,0);function jr(e,t){var r=e.getTime(),n=ac.getTime()+(e.getTimezoneOffset()-ac.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var pD=new Date,v6=ac.getTime()+(pD.getTimezoneOffset()-ac.getTimezoneOffset())*6e4,e2=pD.getTimezoneOffset();function xD(e){var t=new Date;return t.setTime(e*24*60*60*1e3+v6),t.getTimezoneOffset()!==e2&&t.setTime(t.getTime()+(t.getTimezoneOffset()-e2)*6e4),t}var t2=new Date("2017-02-19T19:06:09.000Z"),gD=isNaN(t2.getFullYear())?new Date("2/19/17"):t2,b6=gD.getFullYear()==2017;function Ur(e,t){var r=new Date(e);if(b6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(gD.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Xc(e,t){if(ct&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder!="undefined")try{var r={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(i){return r[i]||i})}catch(i){}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Lr(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Lr(e[r]));return t}function Lt(e,t){for(var r="";r.length<t;)r+=e;return r}function xa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var N6=["january","february","march","april","may","june","july","august","september","october","november","december"];function ol(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&N6.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Ze(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ct?n=ka(r):n=z8(r),Nt.utils.cfb_add(e,t,n)}Nt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Eg(){return Nt.utils.cfb_new()}var Qt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,y6={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},_g=wg(y6),Sg=/[&<>'"]/g,C6=/[\u0000-\u0008\u000b-\u001f]/g;function gt(e){var t=e+"";return t.replace(Sg,function(r){return _g[r]}).replace(C6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function r2(e){return gt(e).replace(/ /g,"_x0020_")}var vD=/[\u0000-\u001f]/g;function w6(e){var t=e+"";return t.replace(Sg,function(r){return _g[r]}).replace(/\n/g,"<br/>").replace(vD,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function E6(e){var t=e+"";return t.replace(Sg,function(r){return _g[r]}).replace(vD,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function _6(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function S6(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function v0(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function n2(e){var t=Bi(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function a2(e){return ka(e,"binary").toString("utf8")}var cu="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",Oo=ct&&(a2(cu)==v0(cu)&&a2||n2(cu)==v0(cu)&&n2)||v0,ll=ct?function(e){return ka(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},T6=(function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),bD=/(^\s|\s$|\n)/;function hr(e,t){return"<"+e+(t.match(bD)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ul(e){return xr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function we(e,t,r){return"<"+e+(r!=null?ul(r):"")+(t!=null?(t.match(bD)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Rp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function D6(e,t){switch(typeof e){case"string":var r=we("vt:lpwstr",gt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return we((e|0)==e?"vt:i4":"vt:r8",gt(String(e)));case"boolean":return we("vt:bool",e?"true":"false")}if(e instanceof Date)return we("vt:filetime",Rp(e));throw new Error("Unable to serialize "+e)}var sr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Qs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Kr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function A6(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function k6(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var i2=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},s2=ct?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ka(t)})):i2(e)}:i2,o2=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ao(e,a)));return n.join("").replace(Ro,"")},Tg=ct?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ro,""):o2(e,t,r)}:o2,l2=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},ND=ct?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):l2(e,t,r)}:l2,u2=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(fs(e,a)));return n.join("")},Ul=ct?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):u2(t,r,n)}:u2,yD=function(e,t){var r=Qr(e,t);return r>0?Ul(e,t+4,t+4+r-1):""},CD=yD,wD=function(e,t){var r=Qr(e,t);return r>0?Ul(e,t+4,t+4+r-1):""},ED=wD,_D=function(e,t){var r=2*Qr(e,t);return r>0?Ul(e,t+4,t+4+r-1):""},SD=_D,TD=function(t,r){var n=Qr(t,r);return n>0?Tg(t,r+4,r+4+n):""},DD=TD,AD=function(e,t){var r=Qr(e,t);return r>0?Ul(e,t+4,t+4+r):""},kD=AD,FD=function(e,t){return A6(e,t)},ic=FD,Dg=function(t){return Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array};ct&&(CD=function(t,r){if(!Buffer.isBuffer(t))return yD(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},ED=function(t,r){if(!Buffer.isBuffer(t))return wD(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},SD=function(t,r){if(!Buffer.isBuffer(t))return _D(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},DD=function(t,r){if(!Buffer.isBuffer(t))return TD(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},kD=function(t,r){if(!Buffer.isBuffer(t))return AD(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ic=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):FD(t,r)},Dg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array});var fs=function(e,t){return e[t]},Ao=function(e,t){return e[t+1]*256+e[t]},F6=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Qr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ci=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},U6=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Vo(e,t){var r="",n,a,i=[],s,o,l,u;switch(t){case"dbcs":if(u=this.l,ct&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Ao(this,u)),u+=2;e*=2;break;case"utf8":r=Ul(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Tg(this,this.l,this.l+e);break;case"wstr":return Vo.call(this,e,"dbcs");case"lpstr-ansi":r=CD(this,this.l),e=4+Qr(this,this.l);break;case"lpstr-cp":r=ED(this,this.l),e=4+Qr(this,this.l);break;case"lpwstr":r=SD(this,this.l),e=4+2*Qr(this,this.l);break;case"lpp4":e=4+Qr(this,this.l),r=DD(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Qr(this,this.l),r=kD(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=fs(this,this.l+e++))!==0;)i.push(ou(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Ao(this,this.l+e))!==0;)i.push(ou(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return s=fs(this,u),this.l=u+1,o=Vo.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ou(Ao(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return s=fs(this,u),this.l=u+1,o=Vo.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ou(fs(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=fs(this,this.l),this.l++,n;case 2:return n=(t==="i"?F6:Ao)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Ci:U6)(this,this.l),this.l+=4,n):(a=Qr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=ic(this,this.l):a=ic([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=ND(this,this.l,e);break}}return this.l+=e,r}var R6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},O6=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},V6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function P6(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)V6(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,R6(this,t,this.l);break;case 8:if(n=8,r==="f"){k6(this,t,this.l);break}case 16:break;case-4:n=4,O6(this,t,this.l);break}return this.l+=n,this}function UD(e,t){var r=ND(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Yr(e,t){e.l=t,e.read_shift=Vo,e.chk=UD,e.write_shift=P6}function Jn(e,t){e.l+=t}function ue(e){var t=Bi(e);return Yr(t,0),t}function Pr(){var e=[],t=ct?256:2048,r=function(u){var c=ue(u);return Yr(c,0),c},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),fr(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function fe(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=Aq[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Dg(r)&&e.push(r)}}function Po(e,t,r){var n=Lr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function c2(e,t,r){var n=Lr(e);return n.s=Po(n.s,t.s,r),n.e=Po(n.e,t.s,r),n}function Io(e,t){if(e.cRel&&e.c<0)for(e=Lr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Lr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=vt(e);return!e.cRel&&e.cRel!=null&&(r=j6(r)),!e.rRel&&e.rRel!=null&&(r=I6(r)),r}function b0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+wr(e.s.c)+":"+(e.e.cRel?"":"$")+wr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+pr(e.s.r)+":"+(e.e.rRel?"":"$")+pr(e.e.r):Io(e.s,t.biff)+":"+Io(e.e,t.biff)}function Ag(e){return parseInt(M6(e),10)-1}function pr(e){return""+(e+1)}function I6(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function M6(e){return e.replace(/\$(\d+)$/,"$1")}function kg(e){for(var t=L6(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function wr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function j6(e){return e.replace(/^([A-Z])/,"$$$1")}function L6(e){return e.replace(/^\$([A-Z])/,"$1")}function B6(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function or(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function vt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function rn(e){var t=e.indexOf(":");return t==-1?{s:or(e),e:or(e)}:{s:or(e.slice(0,t)),e:or(e.slice(t+1))}}function Kt(e,t){return typeof t=="undefined"||typeof t=="number"?Kt(e.s,e.e):(typeof e!="string"&&(e=vt(e)),typeof t!="string"&&(t=vt(t)),e==t?e:e+":"+t)}function At(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function m2(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ja(e.z,r?jr(t):t)}catch(n){}try{return e.w=Ja((e.XF||{}).numFmtId||(r?14:0),r?jr(t):t)}catch(n){return""+t}}function wa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Rl[e.v]||e.v:t==null?m2(e,e.v):m2(e,t))}function Zi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function RD(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?or(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var c=At(i["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),s==-1&&(u.e.r=s=c.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[m].length;++h)if(typeof t[m][h]!="undefined"){var f={v:t[m][h]},x=s+m,p=o+h;if(u.s.r>x&&(u.s.r=x),u.s.c>p&&(u.s.c=p),u.e.r<x&&(u.e.r=x),u.e.c<p&&(u.e.c=p),t[m][h]&&typeof t[m][h]=="object"&&!Array.isArray(t[m][h])&&!(t[m][h]instanceof Date))f=t[m][h];else if(Array.isArray(f.v)&&(f.f=t[m][h][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else if(n.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=n.dateNF||qt[14],n.cellDates?(f.t="d",f.w=Ja(f.z,jr(f.v))):(f.t="n",f.v=jr(f.v),f.w=Ja(f.z,f.v))):f.t="s";if(a)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(f.z=i[x][p].z),i[x][p]=f;else{var g=vt({c:p,r:x});i[g]&&i[g].z&&(f.z=i[g].z),i[g]=f}}}return u.s.c<1e7&&(i["!ref"]=Kt(u)),i}function Zs(e,t){return RD(null,e,t)}function q6(e){return e.read_shift(4,"i")}function Un(e,t){return t||(t=ue(4)),t.write_shift(4,e),t}function Er(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function lr(e,t){var r=!1;return t==null&&(r=!0,t=ue(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function z6(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function H6(e,t){return t||(t=ue(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Fg(e,t){var r=e.l,n=e.read_shift(1),a=Er(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(z6(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function $6(e,t){var r=!1;return t==null&&(r=!0,t=ue(15+4*e.t.length)),t.write_shift(1,0),lr(e.t,t),r?t.slice(0,t.l):t}var W6=Fg;function G6(e,t){var r=!1;return t==null&&(r=!0,t=ue(23+4*e.t.length)),t.write_shift(1,1),lr(e.t,t),t.write_shift(4,1),H6({},t),r?t.slice(0,t.l):t}function gn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ji(e,t){return t==null&&(t=ue(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function es(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ts(e,t){return t==null&&(t=ue(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Y6=Er,OD=lr;function Ug(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function sc(e,t){var r=!1;return t==null&&(r=!0,t=ue(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var X6=Er,Op=Ug,Rg=sc;function VD(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?ic([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ci(t,0)>>2;return r?a/100:a}function PD(e,t){t==null&&(t=ue(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function ID(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function K6(e,t){return t||(t=ue(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var rs=ID,Js=K6;function eo(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function qi(e,t){return(t||ue(8)).write_shift(8,e,"f")}function Q6(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=sj[a];u&&(t.rgb=C2(u));break;case 2:t.rgb=C2([s,o,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function oc(e,t){if(t||(t=ue(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Z6(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function J6(e,t){t||(t=ue(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var MD=2,Wr=3,mu=11,lc=19,du=64,ej=65,tj=71,rj=4108,nj=4126,dr=80,d2={1:{n:"CodePage",t:MD},2:{n:"Category",t:dr},3:{n:"PresentationFormat",t:dr},4:{n:"ByteCount",t:Wr},5:{n:"LineCount",t:Wr},6:{n:"ParagraphCount",t:Wr},7:{n:"SlideCount",t:Wr},8:{n:"NoteCount",t:Wr},9:{n:"HiddenCount",t:Wr},10:{n:"MultimediaClipCount",t:Wr},11:{n:"ScaleCrop",t:mu},12:{n:"HeadingPairs",t:rj},13:{n:"TitlesOfParts",t:nj},14:{n:"Manager",t:dr},15:{n:"Company",t:dr},16:{n:"LinksUpToDate",t:mu},17:{n:"CharacterCount",t:Wr},19:{n:"SharedDoc",t:mu},22:{n:"HyperlinksChanged",t:mu},23:{n:"AppVersion",t:Wr,p:"version"},24:{n:"DigSig",t:ej},26:{n:"ContentType",t:dr},27:{n:"ContentStatus",t:dr},28:{n:"Language",t:dr},29:{n:"Version",t:dr},255:{},2147483648:{n:"Locale",t:lc},2147483651:{n:"Behavior",t:lc},1919054434:{}},f2={1:{n:"CodePage",t:MD},2:{n:"Title",t:dr},3:{n:"Subject",t:dr},4:{n:"Author",t:dr},5:{n:"Keywords",t:dr},6:{n:"Comments",t:dr},7:{n:"Template",t:dr},8:{n:"LastAuthor",t:dr},9:{n:"RevNumber",t:dr},10:{n:"EditTime",t:du},11:{n:"LastPrinted",t:du},12:{n:"CreatedDate",t:du},13:{n:"ModifiedDate",t:du},14:{n:"PageCount",t:Wr},15:{n:"WordCount",t:Wr},16:{n:"CharCount",t:Wr},17:{n:"Thumbnail",t:tj},18:{n:"Application",t:dr},19:{n:"DocSecurity",t:Wr},255:{},2147483648:{n:"Locale",t:lc},2147483651:{n:"Behavior",t:lc},1919054434:{}};function aj(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var ij=aj([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),sj=Lr(ij),Rl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},oj={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},fu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function jD(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function LD(e,t){var r=g6(oj),n=[],a;n[n.length]=Qt,n[n.length]=we("Types",null,{xmlns:sr.CT,"xmlns:xsd":sr.xsd,"xmlns:xsi":sr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return we("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=we("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:fu[l][t.bookType]||fu[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(u){n[n.length]=we("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:fu[l][t.bookType]||fu[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=we("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var st={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function BD(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ss(e){var t=[Qt,we("Relationships",null,{xmlns:sr.RELS})];return xr(e["!id"]).forEach(function(r){t[t.length]=we("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function xt(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[st.HLINK,st.XPATH,st.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function lj(e){var t=[Qt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function h2(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function uj(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function cj(e){var t=[Qt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(h2(e[r][0],e[r][1])),t.push(uj("",e[r][0]));return t.push(h2("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function qD(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ec.version+"</meta:generator></office:meta></office:document-meta>"}var Vi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function N0(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=gt(t),n[n.length]=r?we(e,t,r):hr(e,t))}function zD(e,t){var r=t||{},n=[Qt,we("cp:coreProperties",null,{"xmlns:cp":sr.CORE_PROPS,"xmlns:dc":sr.dc,"xmlns:dcterms":sr.dcterms,"xmlns:dcmitype":sr.dcmitype,"xmlns:xsi":sr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&N0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Rp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&N0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Rp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Vi.length;++i){var s=Vi[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&N0(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ts=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],HD=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function $D(e){var t=[],r=we;return e||(e={}),e.Application="SheetJS",t[t.length]=Qt,t[t.length]=we("Properties",null,{xmlns:sr.EXT_PROPS,"xmlns:vt":sr.vt}),Ts.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=gt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+gt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function WD(e){var t=[Qt,we("Properties",null,{xmlns:sr.CUST_PROPS,"xmlns:vt":sr.vt})];if(!e)return t.join("");var r=1;return xr(e).forEach(function(a){++r,t[t.length]=we("property",D6(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:gt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var p2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function mj(e,t){var r=[];return xr(p2).map(function(n){for(var a=0;a<Vi.length;++a)if(Vi[a][1]==n)return Vi[a];for(a=0;a<Ts.length;++a)if(Ts[a][1]==n)return Ts[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(hr(p2[n[1]]||n[1],a))}}),we("DocumentProperties",r.join(""),{xmlns:Kr.o})}function dj(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&xr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Vi.length;++s)if(i==Vi[s][1])return;for(s=0;s<Ts.length;++s)if(i==Ts[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(we(r2(i),o,{"dt:dt":l}))}}),t&&xr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(we(r2(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Kr.o+'">'+a.join("")+"</"+n+">"}function fj(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=ue(8);return s.write_shift(4,n),s.write_shift(4,a),s}function x2(e,t){var r=ue(4),n=ue(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ue(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=fj(t);break;case 31:case 80:for(n=ue(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return fr([r,n])}var GD=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function hj(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function g2(e,t,r){var n=ue(8),a=[],i=[],s=8,o=0,l=ue(8),u=ue(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),i.push(l),a.push(u),s+=8+l.length,!t){u=ue(8),u.write_shift(4,0),a.unshift(u);var c=[ue(4)];for(c[0].write_shift(4,e.length),o=0;o<e.length;++o){var m=e[o][0];for(l=ue(8+2*(m.length+1)+(m.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,m.length+1),l.write_shift(0,m,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=fr(c),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(GD.indexOf(e[o][0])>-1||HD.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],f=0;if(t){f=+t[e[o][0]];var x=r[f];if(x.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=x2(x.t,h)}else{var g=hj(h);g==-1&&(g=31,h=String(h)),l=x2(g,h)}i.push(l),u=ue(8),u.write_shift(4,t?f:2+o),a.push(u),s+=8+l.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,v),v+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),fr([n].concat(a).concat(i))}function v2(e,t,r,n,a,i){var s=ue(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Nt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=g2(e,r,n);if(o.push(l),a){var u=g2(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(u)}return fr(o)}function pj(e,t){t||(t=ue(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function xj(e,t){return e.read_shift(t)===1}function Dr(e,t){return t||(t=ue(2)),t.write_shift(2,+!!e),t}function YD(e){return e.read_shift(2,"u")}function un(e,t){return t||(t=ue(2)),t.write_shift(2,e),t}function XD(e,t,r){return r||(r=ue(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function KD(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function gj(e){var t=e.t||"",r=ue(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ue(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return fr(a)}function vj(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function bj(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):vj(e,n,r)}function Nj(e,t,r){if(r.biff>5)return bj(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function QD(e,t,r){return r||(r=ue(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function b2(e,t){t||(t=ue(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function yj(e){var t=ue(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),b2(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&b2(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function zi(e,t,r,n){return n||(n=ue(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Cj(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function wj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function ZD(e,t){return t||(t=ue(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Og(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ue(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Ej(e,t){var r=!t||t.biff==8,n=ue(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function _j(e,t){var r=!t||t.biff>=8?2:1,n=ue(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Sj(e,t){var r=ue(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=gj(e[a]);var i=fr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function Tj(){var e=ue(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Dj(e){var t=ue(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Aj(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=ue(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function kj(e,t,r,n){var a=ue(10);return zi(e,t,n,a),a.write_shift(4,r),a}function Fj(e,t,r,n,a){var i=!a||a.biff==8,s=ue(8+ +i+(1+i)*r.length);return zi(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function Uj(e,t,r,n){var a=r&&r.biff==5;n||(n=ue(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function Rj(e,t){var r=t.biff==8||!t.biff?4:2,n=ue(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function N2(e,t,r,n){var a=r&&r.biff==5;n||(n=ue(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Oj(e){var t=ue(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Vj(e,t,r,n,a,i){var s=ue(8);return zi(e,t,n,s),XD(r,i,s),s}function Pj(e,t,r,n){var a=ue(14);return zi(e,t,n,a),qi(r,a),a}function Ij(e,t,r){if(r.biff<8)return Mj(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(Cj(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Mj(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=KD(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function jj(e){var t=ue(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)ZD(e[r],t);return t}function Lj(e){var t=ue(24),r=or(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return fr([t,yj(e[1])])}function Bj(e){var t=e[1].Tooltip,r=ue(10+2*(t.length+1));r.write_shift(2,2048);var n=or(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function qj(e){return e||(e=ue(4)),e.write_shift(2,1),e.write_shift(2,1),e}function zj(e,t,r){if(!r.cellStyles)return Jn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function Hj(e,t){var r=ue(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function $j(e){for(var t=ue(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function Wj(e,t,r){var n=ue(15);return Vl(n,e,t),n.write_shift(8,r,"f"),n}function Gj(e,t,r){var n=ue(9);return Vl(n,e,t),n.write_shift(2,r),n}var Yj=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=wg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],c=Bi(1);switch(l.type){case"base64":c=Dn(Ca(o));break;case"binary":c=Dn(o);break;case"buffer":case"array":c=o;break}Yr(c,0);var m=c.read_shift(1),h=!!(m&136),f=!1,x=!1;switch(m){case 2:break;case 3:break;case 48:f=!0,h=!0;break;case 49:f=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var p=0,g=521;m==2&&(p=c.read_shift(2)),c.l+=3,m!=2&&(p=c.read_shift(4)),p>1048576&&(p=1e6),m!=2&&(g=c.read_shift(2));var v=c.read_shift(2),C=l.codepage||1252;m!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(C=e[c[c.l]]),c.l+=1,c.l+=2),x&&(c.l+=36);for(var b=[],N={},F=Math.min(c.length,m==2?521:g-10-(f?264:0)),E=x?32:11;c.l<F&&c[c.l]!=13;)switch(N={},N.name=HC.utils.decode(C,c.slice(c.l,c.l+E)).replace(/[\u0000\r\n].*$/g,""),c.l+=E,N.type=String.fromCharCode(c.read_shift(1)),m!=2&&!x&&(N.offset=c.read_shift(4)),N.len=c.read_shift(1),m==2&&(N.offset=c.read_shift(2)),N.dec=c.read_shift(1),N.name.length&&b.push(N),m!=2&&(c.l+=x?13:14),N.type){case"B":(!f||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(c[c.l]!==13&&(c.l=g-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=g;var w=0,S=0;for(u[0]=[],S=0;S!=b.length;++S)u[0][S]=b[S].name;for(;p-- >0;){if(c[c.l]===42){c.l+=v;continue}for(++c.l,u[++w]=[],S=0,S=0;S!=b.length;++S){var _=c.slice(c.l,c.l+b[S].len);c.l+=b[S].len,Yr(_,0);var U=HC.utils.decode(C,_);switch(b[S].type){case"C":U.trim().length&&(u[w][S]=U.replace(/\s+$/,""));break;case"D":U.length===8?u[w][S]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):u[w][S]=U;break;case"F":u[w][S]=parseFloat(U.trim());break;case"+":case"I":u[w][S]=x?_.read_shift(-4,"i")^2147483648:_.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":u[w][S]=!0;break;case"N":case"F":u[w][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));u[w][S]="##MEMO##"+(x?parseInt(U.trim(),10):_.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(u[w][S]=+U||0);break;case"@":u[w][S]=new Date(_.read_shift(-8,"f")-621356832e5);break;case"T":u[w][S]=new Date((_.read_shift(4)-2440588)*864e5+_.read_shift(4));break;case"Y":u[w][S]=_.read_shift(4,"i")/1e4+_.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[w][S]=-_.read_shift(-8,"f");break;case"B":if(f&&b[S].len==8){u[w][S]=_.read_shift(8,"f");break}case"G":case"P":_.l+=b[S].len;break;case"0":if(b[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[S].type)}}}if(m!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=b,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var c=Zs(r(o,u),u);return c["!cols"]=u.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete u.DBF,c}function a(o,l){try{return Zi(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var u=l||{};if(+u.codepage>=0&&il(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=Pr(),m=fc(o,{header:1,raw:!0,cellDates:!0}),h=m[0],f=m.slice(1),x=o["!cols"]||[],p=0,g=0,v=0,C=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++v;continue}if(h[p]!=null){if(++v,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var b=At(o["!ref"]),N=[],F=[],E=[];for(p=0;p<=b.e.c-b.s.c;++p){var w="",S="",_=0,U=[];for(g=0;g<f.length;++g)f[g][p]!=null&&U.push(f[g][p]);if(U.length==0||h[p]==null){N[p]="?";continue}for(g=0;g<U.length;++g){switch(typeof U[g]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=U[g]instanceof Date?"D":"C";break;default:S="C"}_=Math.max(_,String(U[g]).length),w=w&&w!=S?"C":S}_>250&&(_=250),S=((x[p]||{}).DBF||{}).type,S=="C"&&x[p].DBF.len>_&&(_=x[p].DBF.len),w=="B"&&S=="N"&&(w="N",E[p]=x[p].DBF.dec,_=x[p].DBF.len),F[p]=w=="C"||S=="N"?_:i[w]||0,C+=F[p],N[p]=w}var R=c.next(32);for(R.write_shift(4,318902576),R.write_shift(4,f.length),R.write_shift(2,296+32*v),R.write_shift(2,C),p=0;p<4;++p)R.write_shift(4,0);for(R.write_shift(4,0|(+t[eD]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var q=c.next(32),M=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,M,"sbcs"),q.write_shift(1,N[p]=="?"?"C":N[p],"sbcs"),q.write_shift(4,g),q.write_shift(1,F[p]||i[N[p]]||0),q.write_shift(1,E[p]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),g+=F[p]||i[N[p]]||0}var Y=c.next(264);for(Y.write_shift(4,13),p=0;p<65;++p)Y.write_shift(4,0);for(p=0;p<f.length;++p){var K=c.next(C);for(K.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(N[g]){case"L":K.write_shift(1,f[p][g]==null?63:f[p][g]?84:70);break;case"B":K.write_shift(8,f[p][g]||0,"f");break;case"N":var de="0";for(typeof f[p][g]=="number"&&(de=f[p][g].toFixed(E[g]||0)),v=0;v<F[g]-de.length;++v)K.write_shift(1,32);K.write_shift(1,de,"sbcs");break;case"D":f[p][g]?(K.write_shift(4,("0000"+f[p][g].getFullYear()).slice(-4),"sbcs"),K.write_shift(2,("00"+(f[p][g].getMonth()+1)).slice(-2),"sbcs"),K.write_shift(2,("00"+f[p][g].getDate()).slice(-2),"sbcs")):K.write_shift(8,"00000000","sbcs");break;case"C":var pe=String(f[p][g]!=null?f[p][g]:"").slice(0,F[g]);for(K.write_shift(1,pe,"sbcs"),v=0;v<F[g]-pe.length;++v)K.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),Xj=(function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+xr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,f){var x=e[f];return typeof x=="number"?zC(x):x},n=function(h,f,x){var p=f.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:zC(p)};e["|"]=254;function a(h,f){switch(f.type){case"base64":return i(Ca(h),f);case"binary":return i(h,f);case"buffer":return i(ct&&Buffer.isBuffer(h)?h.toString("binary"):kl(h),f);case"array":return i(Xc(h),f)}throw new Error("Unrecognized type "+f.type)}function i(h,f){var x=h.split(/[\n\r]+/),p=-1,g=-1,v=0,C=0,b=[],N=[],F=null,E={},w=[],S=[],_=[],U=0,R;for(+f.codepage>=0&&il(+f.codepage);v!==x.length;++v){U=0;var q=x[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),M=q.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),Y=M[0],K;if(q.length>0)switch(Y){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&N.push(q.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,pe=!1,Ae=!1,Ne=!1,k=-1,le=-1;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"A":break;case"X":g=parseInt(M[C].slice(1))-1,pe=!0;break;case"Y":for(p=parseInt(M[C].slice(1))-1,pe||(g=0),R=b.length;R<=p;++R)b[R]=[];break;case"K":K=M[C].slice(1),K.charAt(0)==='"'?K=K.slice(1,K.length-1):K==="TRUE"?K=!0:K==="FALSE"?K=!1:isNaN(xa(K))?isNaN(ol(K).getDate())||(K=Ur(K)):(K=xa(K),F!==null&&dD(F)&&(K=xD(K))),de=!0;break;case"E":Ne=!0;var j=GL(M[C].slice(1),{r:p,c:g});b[p][g]=[b[p][g],j];break;case"S":Ae=!0,b[p][g]=[b[p][g],"S5S"];break;case"G":break;case"R":k=parseInt(M[C].slice(1))-1;break;case"C":le=parseInt(M[C].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+q)}if(de&&(b[p][g]&&b[p][g].length==2?b[p][g][0]=K:b[p][g]=K,F=null),Ae){if(Ne)throw new Error("SYLK shared formula cannot have own formula");var y=k>-1&&b[k][le];if(!y||!y[1])throw new Error("SYLK shared formula cannot find base");b[p][g][1]=YL(y[1],{r:p-k,c:g-le})}break;case"F":var V=0;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"X":g=parseInt(M[C].slice(1))-1,++V;break;case"Y":for(p=parseInt(M[C].slice(1))-1,R=b.length;R<=p;++R)b[R]=[];break;case"M":U=parseInt(M[C].slice(1))/20;break;case"F":break;case"G":break;case"P":F=N[parseInt(M[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(_=M[C].slice(1).split(" "),R=parseInt(_[0],10);R<=parseInt(_[1],10);++R)U=parseInt(_[2],10),S[R-1]=U===0?{hidden:!0}:{wch:U},Vg(S[R-1]);break;case"C":g=parseInt(M[C].slice(1))-1,S[g]||(S[g]={});break;case"R":p=parseInt(M[C].slice(1))-1,w[p]||(w[p]={}),U>0?(w[p].hpt=U,w[p].hpx=nA(U)):U===0&&(w[p].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+q)}V<1&&(F=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+q)}}return w.length>0&&(E["!rows"]=w),S.length>0&&(E["!cols"]=S),f&&f.sheetRows&&(b=b.slice(0,f.sheetRows)),[b,E]}function s(h,f){var x=a(h,f),p=x[0],g=x[1],v=Zs(p,f);return xr(g).forEach(function(C){v[C]=g[C]}),v}function o(h,f){return Zi(s(h,f),f)}function l(h,f,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Ig(h.f,{r:x,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,f){f.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=uc(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=cc(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function c(h,f){f.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*mc(x.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function m(h,f){var x=["ID;PWXL;N;E"],p=[],g=At(h["!ref"]),v,C=Array.isArray(h),b=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&c(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var N=g.s.r;N<=g.e.r;++N)for(var F=g.s.c;F<=g.e.c;++F){var E=vt({r:N,c:F});v=C?(h[N]||[])[F]:h[E],!(!v||v.v==null&&(!v.f||v.F))&&p.push(l(v,h,N,F))}return x.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:s,from_sheet:m}})(),Kj=(function(){function e(i,s){switch(s.type){case"base64":return t(Ca(i),s);case"binary":return t(i,s);case"buffer":return t(ct&&Buffer.isBuffer(i)?i.toString("binary"):kl(i),s);case"array":return t(Xc(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),l=-1,u=-1,c=0,m=[];c!==o.length;++c){if(o[c].trim()==="BOT"){m[++l]=[],u=0;continue}if(!(l<0)){var h=o[c].trim().split(","),f=h[0],x=h[1];++c;for(var p=o[c]||"";(p.match(/["]/g)||[]).length&1&&c<o.length-1;)p+=`
`+o[++c];switch(p=p.trim(),+f){case-1:if(p==="BOT"){m[++l]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?m[l][u]=!0:p==="FALSE"?m[l][u]=!1:isNaN(xa(x))?isNaN(ol(x).getDate())?m[l][u]=x:m[l][u]=Ur(x):m[l][u]=xa(x),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),m[l][u++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(m=m.slice(0,s.sheetRows)),m}function r(i,s){return Zs(e(i,s),s)}function n(i,s){return Zi(r(i,s),s)}var a=(function(){var i=function(l,u,c,m,h){l.push(u),l.push(c+","+m),l.push('"'+h.replace(/"/g,'""')+'"')},s=function(l,u,c,m){l.push(u+","+c),l.push(u==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(l){var u=[],c=At(l["!ref"]),m,h=Array.isArray(l);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,c.e.r-c.s.r+1,""),i(u,"TUPLES",0,c.e.c-c.s.c+1,""),i(u,"DATA",0,0,"");for(var f=c.s.r;f<=c.e.r;++f){s(u,-1,0,"BOT");for(var x=c.s.c;x<=c.e.c;++x){var p=vt({r:f,c:x});if(m=h?(l[f]||[])[x]:l[p],!m){s(u,1,0,"");continue}switch(m.t){case"n":var g=m.w;!g&&m.v!=null&&(g=m.v),g==null?m.f&&!m.F?s(u,1,0,"="+m.f):s(u,1,0,""):s(u,0,g,"V");break;case"b":s(u,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Ja(m.z||qt[14],jr(Ur(m.v)))),s(u,0,m.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var v=`\r
`,C=u.join(v);return C}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),JD=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,h){for(var f=m.split(`
`),x=-1,p=-1,g=0,v=[];g!==f.length;++g){var C=f[g].trim().split(":");if(C[0]==="cell"){var b=or(C[1]);if(v.length<=b.r)for(x=v.length;x<=b.r;++x)v[x]||(v[x]=[]);switch(x=b.r,p=b.c,C[2]){case"t":v[x][p]=e(C[3]);break;case"v":v[x][p]=+C[3];break;case"vtf":var N=C[C.length-1];case"vtc":switch(C[3]){case"nl":v[x][p]=!!+C[4];break;default:v[x][p]=+C[4];break}C[2]=="vtf"&&(v[x][p]=[v[x][p],N])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(m,h){return Zs(r(m,h),h)}function a(m,h){return Zi(n(m,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(m){if(!m||!m["!ref"])return"";for(var h=[],f=[],x,p="",g=rn(m["!ref"]),v=Array.isArray(m),C=g.s.r;C<=g.e.r;++C)for(var b=g.s.c;b<=g.e.c;++b)if(p=vt({r:C,c:b}),x=v?(m[C]||[])[b]:m[p],!(!x||x.v==null||x.t==="z")){switch(f=["cell",p,"t"],x.t){case"s":case"str":f.push(t(x.v));break;case"n":x.f?(f[2]="vtf",f[3]="n",f[4]=x.v,f[5]=t(x.f)):(f[2]="v",f[3]=x.v);break;case"b":f[2]="vt"+(x.f?"f":"c"),f[3]="nl",f[4]=x.v?"1":"0",f[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=jr(Ur(x.v));f[2]="vtc",f[3]="nd",f[4]=""+N,f[5]=x.w||Ja(x.z||qt[14],N);break;case"e":continue}h.push(f.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function c(m){return[i,s,o,s,u(m),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:c}})(),Qj=(function(){function e(c,m,h,f,x){x.raw?m[h][f]=c:c===""||(c==="TRUE"?m[h][f]=!0:c==="FALSE"?m[h][f]=!1:isNaN(xa(c))?isNaN(ol(c).getDate())?m[h][f]=c:m[h][f]=Ur(c):m[h][f]=xa(c))}function t(c,m){var h=m||{},f=[];if(!c||c.length===0)return f;for(var x=c.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,v=0,C=0;C<=p;++C)v=x[C].indexOf(" "),v==-1?v=x[C].length:v++,g=Math.max(g,v);for(C=0;C<=p;++C){f[C]=[];var b=0;for(e(x[C].slice(0,g).trim(),f,C,b,h),b=1;b<=(x[C].length-g)/10+1;++b)e(x[C].slice(g+(b-1)*10,g+b*10).trim(),f,C,b,h)}return h.sheetRows&&(f=f.slice(0,h.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(c){for(var m={},h=!1,f=0,x=0;f<c.length;++f)(x=c.charCodeAt(f))==34?h=!h:!h&&x in r&&(m[x]=(m[x]||0)+1);x=[];for(f in m)Object.prototype.hasOwnProperty.call(m,f)&&x.push([m[f],f]);if(!x.length){m=n;for(f in m)Object.prototype.hasOwnProperty.call(m,f)&&x.push([m[f],f])}return x.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[x.pop()[1]]||44}function i(c,m){var h=m||{},f="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(f=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(f=c.charAt(4),c=c.slice(6)):f=a(c.slice(0,1024)):h&&h.FS?f=h.FS:f=a(c.slice(0,1024));var g=0,v=0,C=0,b=0,N=0,F=f.charCodeAt(0),E=!1,w=0,S=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var _=h.dateNF!=null?f6(h.dateNF):null;function U(){var R=c.slice(b,N),q={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)q.t="z";else if(h.raw)q.t="s",q.v=R;else if(R.trim().length===0)q.t="s",q.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(q.t="s",q.v=R.slice(2,-1).replace(/""/g,'"')):XL(R)?(q.t="n",q.f=R.slice(1)):(q.t="s",q.v=R);else if(R=="TRUE")q.t="b",q.v=!0;else if(R=="FALSE")q.t="b",q.v=!1;else if(!isNaN(C=xa(R)))q.t="n",h.cellText!==!1&&(q.w=R),q.v=C;else if(!isNaN(ol(R).getDate())||_&&R.match(_)){q.z=h.dateNF||qt[14];var M=0;_&&R.match(_)&&(R=h6(R,h.dateNF,R.match(_)||[]),M=1),h.cellDates?(q.t="d",q.v=Ur(R,M)):(q.t="n",q.v=jr(Ur(R,M))),h.cellText!==!1&&(q.w=Ja(q.z,q.v instanceof Date?jr(q.v):q.v)),h.cellNF||delete q.z}else q.t="s",q.v=R;if(q.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][v]=q):x[vt({c:v,r:g})]=q),b=N+1,S=c.charCodeAt(b),p.e.c<v&&(p.e.c=v),p.e.r<g&&(p.e.r=g),w==F)++v;else if(v=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;N<c.length;++N)switch(w=c.charCodeAt(N)){case 34:S===34&&(E=!E);break;case F:case 10:case 13:if(!E&&U())break e;break}return N-b>0&&U(),x["!ref"]=Kt(p),x}function s(c,m){return!(m&&m.PRN)||m.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?i(c,m):Zs(t(c,m),m)}function o(c,m){var h="",f=m.type=="string"?[0,0,0,0]:uz(c,m);switch(m.type){case"base64":h=Ca(c);break;case"binary":h=c;break;case"buffer":m.codepage==65001?h=c.toString("utf8"):h=ct&&Buffer.isBuffer(c)?c.toString("binary"):kl(c);break;case"array":h=Xc(c);break;case"string":h=c;break;default:throw new Error("Unrecognized type "+m.type)}return f[0]==239&&f[1]==187&&f[2]==191?h=Oo(h.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001&&(h=Oo(h)),h.slice(0,19)=="socialcalc:version:"?JD.to_sheet(m.type=="string"?h:Oo(h),m):s(h,m)}function l(c,m){return Zi(o(c,m),m)}function u(c){for(var m=[],h=At(c["!ref"]),f,x=Array.isArray(c),p=h.s.r;p<=h.e.r;++p){for(var g=[],v=h.s.c;v<=h.e.c;++v){var C=vt({r:p,c:v});if(f=x?(c[p]||[])[v]:c[C],!f||f.v==null){g.push("          ");continue}for(var b=(f.w||(wa(f),f.w)||"").slice(0,10);b.length<10;)b+=" ";g.push(b+(v===0?" ":""))}m.push(g.join(""))}return m.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}})(),y2=(function(){function e(j,y,V){if(j){Yr(j,j.l||0);for(var I=V.Enum||k;j.l<j.length;){var G=j.read_shift(2),ie=I[G]||I[65535],ae=j.read_shift(2),Q=j.l+ae,Z=ie.f&&ie.f(j,ae,V);if(j.l=Q,y(Z,ie,G))return}}}function t(j,y){switch(y.type){case"base64":return r(Dn(Ca(j)),y);case"binary":return r(Dn(j),y);case"buffer":case"array":return r(j,y)}throw"Unsupported type "+y.type}function r(j,y){if(!j)return j;var V=y||{},I=V.dense?[]:{},G="Sheet1",ie="",ae=0,Q={},Z=[],ve=[],J={s:{r:0,c:0},e:{r:0,c:0}},je=V.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)V.Enum=k,e(j,function(Se,Ot,cr){switch(cr){case 0:V.vers=Se,Se>=4096&&(V.qpro=!0);break;case 6:J=Se;break;case 204:Se&&(ie=Se);break;case 222:ie=Se;break;case 15:case 51:V.qpro||(Se[1].v=Se[1].v.slice(1));case 13:case 14:case 16:cr==14&&(Se[2]&112)==112&&(Se[2]&15)>1&&(Se[2]&15)<15&&(Se[1].z=V.dateNF||qt[14],V.cellDates&&(Se[1].t="d",Se[1].v=xD(Se[1].v))),V.qpro&&Se[3]>ae&&(I["!ref"]=Kt(J),Q[G]=I,Z.push(G),I=V.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},ae=Se[3],G=ie||"Sheet"+(ae+1),ie="");var Zt=V.dense?(I[Se[0].r]||[])[Se[0].c]:I[vt(Se[0])];if(Zt){Zt.t=Se[1].t,Zt.v=Se[1].v,Se[1].z!=null&&(Zt.z=Se[1].z),Se[1].f!=null&&(Zt.f=Se[1].f);break}V.dense?(I[Se[0].r]||(I[Se[0].r]=[]),I[Se[0].r][Se[0].c]=Se[1]):I[vt(Se[0])]=Se[1];break}},V);else if(j[2]==26||j[2]==14)V.Enum=le,j[2]==14&&(V.qpro=!0,j.l=0),e(j,function(Se,Ot,cr){switch(cr){case 204:G=Se;break;case 22:Se[1].v=Se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Se[3]>ae&&(I["!ref"]=Kt(J),Q[G]=I,Z.push(G),I=V.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},ae=Se[3],G="Sheet"+(ae+1)),je>0&&Se[0].r>=je)break;V.dense?(I[Se[0].r]||(I[Se[0].r]=[]),I[Se[0].r][Se[0].c]=Se[1]):I[vt(Se[0])]=Se[1],J.e.c<Se[0].c&&(J.e.c=Se[0].c),J.e.r<Se[0].r&&(J.e.r=Se[0].r);break;case 27:Se[14e3]&&(ve[Se[14e3][0]]=Se[14e3][1]);break;case 1537:ve[Se[0]]=Se[1],Se[0]==ae&&(G=Se[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(I["!ref"]=Kt(J),Q[ie||G]=I,Z.push(ie||G),!ve.length)return{SheetNames:Z,Sheets:Q};for(var ke={},tt=[],ze=0;ze<ve.length;++ze)Q[Z[ze]]?(tt.push(ve[ze]||Z[ze]),ke[ve[ze]]=Q[ve[ze]]||Q[Z[ze]]):(tt.push(ve[ze]),ke[ve[ze]]={"!ref":"A1"});return{SheetNames:tt,Sheets:ke}}function n(j,y){var V=y||{};if(+V.codepage>=0&&il(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var I=Pr(),G=At(j["!ref"]),ie=Array.isArray(j),ae=[];_e(I,0,i(1030)),_e(I,6,l(G));for(var Q=Math.min(G.e.r,8191),Z=G.s.r;Z<=Q;++Z)for(var ve=pr(Z),J=G.s.c;J<=G.e.c;++J){Z===G.s.r&&(ae[J]=wr(J));var je=ae[J]+ve,ke=ie?(j[Z]||[])[J]:j[je];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?_e(I,13,f(Z,J,ke.v)):_e(I,14,p(Z,J,ke.v));else{var tt=wa(ke);_e(I,15,m(Z,J,tt.slice(0,239)))}}return _e(I,1),I.end()}function a(j,y){var V=y||{};if(+V.codepage>=0&&il(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var I=Pr();_e(I,0,s(j));for(var G=0,ie=0;G<j.SheetNames.length;++G)(j.Sheets[j.SheetNames[G]]||{})["!ref"]&&_e(I,27,Ne(j.SheetNames[G],ie++));var ae=0;for(G=0;G<j.SheetNames.length;++G){var Q=j.Sheets[j.SheetNames[G]];if(!(!Q||!Q["!ref"])){for(var Z=At(Q["!ref"]),ve=Array.isArray(Q),J=[],je=Math.min(Z.e.r,8191),ke=Z.s.r;ke<=je;++ke)for(var tt=pr(ke),ze=Z.s.c;ze<=Z.e.c;++ze){ke===Z.s.r&&(J[ze]=wr(ze));var Se=J[ze]+tt,Ot=ve?(Q[ke]||[])[ze]:Q[Se];if(!(!Ot||Ot.t=="z"))if(Ot.t=="n")_e(I,23,U(ke,ze,ae,Ot.v));else{var cr=wa(Ot);_e(I,22,w(ke,ze,ae,cr.slice(0,239)))}}++ae}}return _e(I,1),I.end()}function i(j){var y=ue(2);return y.write_shift(2,j),y}function s(j){var y=ue(26);y.write_shift(2,4096),y.write_shift(2,4),y.write_shift(4,0);for(var V=0,I=0,G=0,ie=0;ie<j.SheetNames.length;++ie){var ae=j.SheetNames[ie],Q=j.Sheets[ae];if(!(!Q||!Q["!ref"])){++G;var Z=rn(Q["!ref"]);V<Z.e.r&&(V=Z.e.r),I<Z.e.c&&(I=Z.e.c)}}return V>8191&&(V=8191),y.write_shift(2,V),y.write_shift(1,G),y.write_shift(1,I),y.write_shift(2,0),y.write_shift(2,0),y.write_shift(1,1),y.write_shift(1,2),y.write_shift(4,0),y.write_shift(4,0),y}function o(j,y,V){var I={s:{c:0,r:0},e:{c:0,r:0}};return y==8&&V.qpro?(I.s.c=j.read_shift(1),j.l++,I.s.r=j.read_shift(2),I.e.c=j.read_shift(1),j.l++,I.e.r=j.read_shift(2),I):(I.s.c=j.read_shift(2),I.s.r=j.read_shift(2),y==12&&V.qpro&&(j.l+=2),I.e.c=j.read_shift(2),I.e.r=j.read_shift(2),y==12&&V.qpro&&(j.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function l(j){var y=ue(8);return y.write_shift(2,j.s.c),y.write_shift(2,j.s.r),y.write_shift(2,j.e.c),y.write_shift(2,j.e.r),y}function u(j,y,V){var I=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(I[0].c=j.read_shift(1),I[3]=j.read_shift(1),I[0].r=j.read_shift(2),j.l+=2):(I[2]=j.read_shift(1),I[0].c=j.read_shift(2),I[0].r=j.read_shift(2)),I}function c(j,y,V){var I=j.l+y,G=u(j,y,V);if(G[1].t="s",V.vers==20768){j.l++;var ie=j.read_shift(1);return G[1].v=j.read_shift(ie,"utf8"),G}return V.qpro&&j.l++,G[1].v=j.read_shift(I-j.l,"cstr"),G}function m(j,y,V){var I=ue(7+V.length);I.write_shift(1,255),I.write_shift(2,y),I.write_shift(2,j),I.write_shift(1,39);for(var G=0;G<I.length;++G){var ie=V.charCodeAt(G);I.write_shift(1,ie>=128?95:ie)}return I.write_shift(1,0),I}function h(j,y,V){var I=u(j,y,V);return I[1].v=j.read_shift(2,"i"),I}function f(j,y,V){var I=ue(7);return I.write_shift(1,255),I.write_shift(2,y),I.write_shift(2,j),I.write_shift(2,V,"i"),I}function x(j,y,V){var I=u(j,y,V);return I[1].v=j.read_shift(8,"f"),I}function p(j,y,V){var I=ue(13);return I.write_shift(1,255),I.write_shift(2,y),I.write_shift(2,j),I.write_shift(8,V,"f"),I}function g(j,y,V){var I=j.l+y,G=u(j,y,V);if(G[1].v=j.read_shift(8,"f"),V.qpro)j.l=I;else{var ie=j.read_shift(2);N(j.slice(j.l,j.l+ie),G),j.l+=ie}return G}function v(j,y,V){var I=y&32768;return y&=-32769,y=(I?j:0)+(y>=8192?y-16384:y),(I?"":"$")+(V?wr(y):pr(y))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(j,y){Yr(j,0);for(var V=[],I=0,G="",ie="",ae="",Q="";j.l<j.length;){var Z=j[j.l++];switch(Z){case 0:V.push(j.read_shift(8,"f"));break;case 1:ie=v(y[0].c,j.read_shift(2),!0),G=v(y[0].r,j.read_shift(2),!1),V.push(ie+G);break;case 2:{var ve=v(y[0].c,j.read_shift(2),!0),J=v(y[0].r,j.read_shift(2),!1);ie=v(y[0].c,j.read_shift(2),!0),G=v(y[0].r,j.read_shift(2),!1),V.push(ve+J+":"+ie+G)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(j.read_shift(2));break;case 6:{for(var je="";Z=j[j.l++];)je+=String.fromCharCode(Z);V.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:Q=V.pop(),ae=V.pop(),V.push(["AND","OR"][Z-20]+"("+ae+","+Q+")");break;default:if(Z<32&&b[Z])Q=V.pop(),ae=V.pop(),V.push(ae+b[Z]+Q);else if(C[Z]){if(I=C[Z][1],I==69&&(I=j[j.l++]),I>V.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+V.join("|")+"|");return}var ke=V.slice(-I);V.length-=I,V.push(C[Z][0]+"("+ke.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}V.length==1?y[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function F(j){var y=[{c:0,r:0},{t:"n",v:0},0];return y[0].r=j.read_shift(2),y[3]=j[j.l++],y[0].c=j[j.l++],y}function E(j,y){var V=F(j);return V[1].t="s",V[1].v=j.read_shift(y-4,"cstr"),V}function w(j,y,V,I){var G=ue(6+I.length);G.write_shift(2,j),G.write_shift(1,V),G.write_shift(1,y),G.write_shift(1,39);for(var ie=0;ie<I.length;++ie){var ae=I.charCodeAt(ie);G.write_shift(1,ae>=128?95:ae)}return G.write_shift(1,0),G}function S(j,y){var V=F(j);V[1].v=j.read_shift(2);var I=V[1].v>>1;if(V[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return V[1].v=I,V}function _(j,y){var V=F(j),I=j.read_shift(4),G=j.read_shift(4),ie=j.read_shift(2);if(ie==65535)return I===0&&G===3221225472?(V[1].t="e",V[1].v=15):I===0&&G===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var ae=ie&32768;return ie=(ie&32767)-16446,V[1].v=(1-ae*2)*(G*Math.pow(2,ie+32)+I*Math.pow(2,ie)),V}function U(j,y,V,I){var G=ue(14);if(G.write_shift(2,j),G.write_shift(1,V),G.write_shift(1,y),I==0)return G.write_shift(4,0),G.write_shift(4,0),G.write_shift(2,65535),G;var ie=0,ae=0,Q=0,Z=0;return I<0&&(ie=1,I=-I),ae=Math.log2(I)|0,I/=Math.pow(2,ae-31),Z=I>>>0,(Z&2147483648)==0&&(I/=2,++ae,Z=I>>>0),I-=Z,Z|=2147483648,Z>>>=0,I*=Math.pow(2,32),Q=I>>>0,G.write_shift(4,Q),G.write_shift(4,Z),ae+=16383+(ie?32768:0),G.write_shift(2,ae),G}function R(j,y){var V=_(j);return j.l+=y-14,V}function q(j,y){var V=F(j),I=j.read_shift(4);return V[1].v=I>>6,V}function M(j,y){var V=F(j),I=j.read_shift(8,"f");return V[1].v=I,V}function Y(j,y){var V=M(j);return j.l+=y-10,V}function K(j,y){return j[j.l+y-1]==0?j.read_shift(y,"cstr"):""}function de(j,y){var V=j[j.l++];V>y-1&&(V=y-1);for(var I="";I.length<V;)I+=String.fromCharCode(j[j.l++]);return I}function pe(j,y,V){if(!(!V.qpro||y<21)){var I=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var G=j.read_shift(y-21,"cstr");return[I,G]}}function Ae(j,y){for(var V={},I=j.l+y;j.l<I;){var G=j.read_shift(2);if(G==14e3){for(V[G]=[0,""],V[G][0]=j.read_shift(2);j[j.l];)V[G][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return V}function Ne(j,y){var V=ue(5+j.length);V.write_shift(2,14e3),V.write_shift(2,y);for(var I=0;I<j.length;++I){var G=j.charCodeAt(I);V[V.l++]=G>127?95:G}return V[V.l++]=0,V}var k={0:{n:"BOF",f:YD},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:K},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},le={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:_},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:Y},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:K},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:pe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})(),Zj=/^\s|\s$|[\t\n\r]/;function eA(e,t){if(!t.bookSST)return"";var r=[Qt];r[r.length]=we("sst",null,{xmlns:Qs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(Zj)&&(i+=' xml:space="preserve"'),i+=">"+gt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Jj(e){return[e.read_shift(4),e.read_shift(4)]}function eL(e,t){return t||(t=ue(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var tL=$6;function rL(e){var t=Pr();fe(t,159,eL(e));for(var r=0;r<e.length;++r)fe(t,19,tL(e[r]));return fe(t,160),t.end()}function nL(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function tA(e){var t=0,r,n=nL(e),a=n.length+1,i,s,o,l,u;for(r=Bi(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=(t&16384)===0?0:1,l=t<<1&32767,u=o|l,t=u^s;return t^52811}var aL=(function(){function e(a,i){switch(i.type){case"base64":return t(Ca(a),i);case"binary":return t(a,i);case"buffer":return t(ct&&Buffer.isBuffer(a)?a.toString("binary"):kl(a),i);case"array":return t(Xc(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,m){Array.isArray(o)&&(o[m]=[]);for(var h=/\\\w+\b/g,f=0,x,p=-1;x=h.exec(c);){switch(x[0]){case"\\cell":var g=c.slice(f,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var v={v:g,t:"s"};Array.isArray(o)?o[m][p]=v:o[vt({r:m,c:p})]=v}break}f=h.lastIndex}p>u.e.c&&(u.e.c=p)}),o["!ref"]=Kt(u),o}function r(a,i){return Zi(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=At(a["!ref"]),o,l=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var c=s.s.c;c<=s.e.c;++c)i.push("\\cellx"+(c+1));for(i.push("\\pard\\intbl"),c=s.s.c;c<=s.e.c;++c){var m=vt({r:u,c});o=l?(a[u]||[])[c]:a[m],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(wa(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function C2(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var iL=6,ga=iL;function uc(e){return Math.floor((e+Math.round(128/ga)/256)*ga)}function cc(e){return Math.floor((e-5)/ga*100+.5)/100}function Vp(e){return Math.round((e*ga+5)/ga*256)/256}function Vg(e){e.width?(e.wpx=uc(e.width),e.wch=cc(e.wpx),e.MDW=ga):e.wpx?(e.wch=cc(e.wpx),e.width=Vp(e.wch),e.MDW=ga):typeof e.wch=="number"&&(e.width=Vp(e.wch),e.wpx=uc(e.width),e.MDW=ga),e.customWidth&&delete e.customWidth}var sL=96,rA=sL;function mc(e){return e*96/rA}function nA(e){return e*rA/96}function oL(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=we("numFmt",null,{numFmtId:n,formatCode:gt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=we("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function lL(e){var t=[];return t[t.length]=we("cellXfs",null),e.forEach(function(r){t[t.length]=we("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=we("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function aA(e,t){var r=[Qt,we("styleSheet",null,{xmlns:Qs[0],"xmlns:vt":sr.vt})],n;return e.SSF&&(n=oL(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=lL(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function uL(e,t){var r=e.read_shift(2),n=Er(e);return[r,n]}function cL(e,t,r){r||(r=ue(6+4*t.length)),r.write_shift(2,e),lr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function mL(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=Z6(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=Q6(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Er(e),n}function dL(e,t){t||(t=ue(153)),t.write_shift(2,e.sz*20),J6(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),oc(e.color,t);var n=0;return n=2,t.write_shift(1,n),lr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var fL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],y0,hL=Jn;function w2(e,t){t||(t=ue(84)),y0||(y0=wg(fL));var r=y0[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(oc({auto:1},t),oc({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function pL(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function iA(e,t,r){r||(r=ue(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function xo(e,t){return t||(t=ue(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var xL=Jn;function gL(e,t){return t||(t=ue(51)),t.write_shift(1,0),xo(null,t),xo(null,t),xo(null,t),xo(null,t),xo(null,t),t.length>t.l?t.slice(0,t.l):t}function vL(e,t){return t||(t=ue(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),sc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function bL(e,t,r){var n=ue(2052);return n.write_shift(4,e),sc(t,n),sc(r,n),n.length>n.l?n.slice(0,n.l):n}function NL(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(fe(e,615,Un(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&fe(e,44,cL(a,t[a]))}),fe(e,616))}}function yL(e){var t=1;fe(e,611,Un(t)),fe(e,43,dL({sz:12,color:{theme:1},name:"Calibri",family:2})),fe(e,612)}function CL(e){var t=2;fe(e,603,Un(t)),fe(e,45,w2({patternType:"none"})),fe(e,45,w2({patternType:"gray125"})),fe(e,604)}function wL(e){var t=1;fe(e,613,Un(t)),fe(e,46,gL()),fe(e,614)}function EL(e){var t=1;fe(e,626,Un(t)),fe(e,47,iA({numFmtId:0},65535)),fe(e,627)}function _L(e,t){fe(e,617,Un(t.length)),t.forEach(function(r){fe(e,47,iA(r,0))}),fe(e,618)}function SL(e){var t=1;fe(e,619,Un(t)),fe(e,48,vL({xfId:0,name:"Normal"})),fe(e,620)}function TL(e){var t=0;fe(e,505,Un(t)),fe(e,506)}function DL(e){var t=0;fe(e,508,bL(t,"TableStyleMedium9","PivotStyleMedium4")),fe(e,509)}function AL(e,t){var r=Pr();return fe(r,278),NL(r,e.SSF),yL(r),CL(r),wL(r),EL(r),_L(r,t.cellXfs),SL(r),TL(r),DL(r),fe(r,279),r.end()}function sA(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Qt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function kL(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Er(e)}}function FL(e){var t=ue(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),lr(e.name,t),t.slice(0,t.l)}function UL(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function RL(e){var t=ue(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function OL(e,t){var r=ue(8+2*t.length);return r.write_shift(4,e),lr(t,r),r.slice(0,r.l)}function VL(e){return e.l+=4,e.read_shift(4)!=0}function PL(e,t){var r=ue(8);return r.write_shift(4,e),r.write_shift(4,1),r}function IL(){var e=Pr();return fe(e,332),fe(e,334,Un(1)),fe(e,335,FL({name:"XLDAPR",version:12e4,flags:3496657072})),fe(e,336),fe(e,339,OL(1,"XLDAPR")),fe(e,52),fe(e,35,Un(514)),fe(e,4096,Un(0)),fe(e,4097,un(1)),fe(e,36),fe(e,53),fe(e,340),fe(e,337,PL(1)),fe(e,51,RL([[1,0]])),fe(e,338),fe(e,333),e.end()}function oA(){var e=[Qt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function ML(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=vt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var gs=1024;function lA(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[we("xml",null,{"xmlns:v":Kr.v,"xmlns:o":Kr.o,"xmlns:x":Kr.x,"xmlns:mv":Kr.mv}).replace(/\/>/,">"),we("o:shapelayout",we("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),we("v:shapetype",[we("v:stroke",null,{joinstyle:"miter"}),we("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];gs<e*1e3;)gs+=1e3;return t.forEach(function(i){var s=or(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?we("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=we("v:fill",l,o),c={on:"t",obscured:"t"};++gs,a=a.concat(["<v:shape"+ul({id:"_x0000_s"+gs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,we("v:shadow",null,c),we("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",hr("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),hr("x:AutoFill","False"),hr("x:Row",String(s.r)),hr("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function uA(e){var t=[Qt,we("comments",null,{xmlns:Qs[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=gt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(gt(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(hr("t",gt(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(hr("t",gt(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function jL(e,t,r){var n=[Qt,we("ThreadedComments",null,{xmlns:sr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(we("threadedComment",hr("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function LL(e){var t=[Qt,we("personList",null,{xmlns:sr.TCMNT,"xmlns:x":Qs[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(we("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function BL(e){var t={};t.iauthor=e.read_shift(4);var r=rs(e);return t.rfx=r.s,t.ref=vt(r.s),e.l+=16,t}function qL(e,t){return t==null&&(t=ue(36)),t.write_shift(4,e[1].iauthor),Js(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var zL=Er;function HL(e){return lr(e.slice(0,54))}function $L(e){var t=Pr(),r=[];return fe(t,628),fe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),fe(t,632,HL(a.a)))})}),fe(t,631),fe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:or(n[0]),e:or(n[0])};fe(t,635,qL([i,a])),a.t&&a.t.length>0&&fe(t,637,G6(a)),fe(t,636),delete a.iauthor})}),fe(t,634),fe(t,629),t.end()}function WL(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Nt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var cA=["xlsb","xlsm","xlam","biff8","xla"],GL=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,c=s.length>0?parseInt(s,10)|0:0;return o?c+=t.c:--c,l?u+=t.r:--u,a+(o?"":"$")+wr(c)+(l?"":"$")+pr(u)}return function(a,i){return t=i,a.replace(e,r)}})(),Pg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ig=(function(){return function(t,r){return t.replace(Pg,function(n,a,i,s,o,l){var u=kg(s)-(i?0:r.c),c=Ag(l)-(o?0:r.r),m=c==0?"":o?c+1:"["+c+"]",h=u==0?"":i?u+1:"["+u+"]";return a+"R"+m+"C"+h})}})();function YL(e,t){return e.replace(Pg,function(r,n,a,i,s,o){return n+(a=="$"?a+i:wr(kg(i)+t.c))+(s=="$"?s+o:pr(Ag(o)+t.r))})}function XL(e){return e.length!=1}function Ht(e){e.l+=1}function ei(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function mA(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return dA(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=ei(e),o=ei(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function dA(e){var t=ei(e),r=ei(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function KL(e,t,r){if(r.biff<8)return dA(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=ei(e),s=ei(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function fA(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return QL(e);var n=e.read_shift(r&&r.biff==12?4:2),a=ei(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function QL(e){var t=ei(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function ZL(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function JL(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return e7(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function e7(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function t7(e,t,r){var n=(e[e.l++]&96)>>5,a=mA(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function r7(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=mA(e,i,r);return[n,a,s]}function n7(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function a7(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function i7(e,t,r){var n=(e[e.l++]&96)>>5,a=KL(e,t-1,r);return[n,a]}function s7(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function E2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function o7(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function l7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function u7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function c7(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function m7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function hA(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function d7(e){return e.read_shift(2),hA(e)}function f7(e){return e.read_shift(2),hA(e)}function h7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=fA(e,0,r);return[n,a]}function p7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=JL(e,0,r);return[n,a]}function x7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=fA(e,0,r);return[n,a,i]}function g7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[g9[a],gA[a],n]}function v7(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:b7(e);return[a,(i[0]===0?gA:x9)[i[1]]]}function b7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function N7(e,t,r){e.l+=r&&r.biff==2?3:4}function y7(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function C7(e){return e.l++,Rl[e.read_shift(1)]}function w7(e){return e.l++,e.read_shift(2)}function E7(e){return e.l++,e.read_shift(1)!==0}function _7(e){return e.l++,eo(e)}function S7(e,t,r){return e.l++,KD(e,t-1,r)}function T7(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=xj(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Rl[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=eo(e);break;case 2:r[1]=Nj(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function D7(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?rs:wj)(e));return a}function A7(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=T7(e,r.biff);return s}function k7(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function F7(e,t,r){if(r.biff==5)return U7(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function U7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function R7(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function O7(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function V7(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function P7(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var I7=Jn,M7=Jn,j7=Jn;function Ol(e,t,r){return e.l+=2,[ZL(e)]}function Mg(e){return e.l+=6,[]}var L7=Ol,B7=Mg,q7=Mg,z7=Ol;function pA(e){return e.l+=2,[YD(e),e.read_shift(2)&1]}var H7=Ol,$7=pA,W7=Mg,G7=Ol,Y7=Ol,X7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function K7(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=X7[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function Q7(e){return e.l+=2,[e.read_shift(4)]}function Z7(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function J7(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function e9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function t9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function r9(e){return e.l+=4,[0,0]}var _2={1:{n:"PtgExp",f:y7},2:{n:"PtgTbl",f:j7},3:{n:"PtgAdd",f:Ht},4:{n:"PtgSub",f:Ht},5:{n:"PtgMul",f:Ht},6:{n:"PtgDiv",f:Ht},7:{n:"PtgPower",f:Ht},8:{n:"PtgConcat",f:Ht},9:{n:"PtgLt",f:Ht},10:{n:"PtgLe",f:Ht},11:{n:"PtgEq",f:Ht},12:{n:"PtgGe",f:Ht},13:{n:"PtgGt",f:Ht},14:{n:"PtgNe",f:Ht},15:{n:"PtgIsect",f:Ht},16:{n:"PtgUnion",f:Ht},17:{n:"PtgRange",f:Ht},18:{n:"PtgUplus",f:Ht},19:{n:"PtgUminus",f:Ht},20:{n:"PtgPercent",f:Ht},21:{n:"PtgParen",f:Ht},22:{n:"PtgMissArg",f:Ht},23:{n:"PtgStr",f:S7},26:{n:"PtgSheet",f:Z7},27:{n:"PtgEndSheet",f:J7},28:{n:"PtgErr",f:C7},29:{n:"PtgBool",f:E7},30:{n:"PtgInt",f:w7},31:{n:"PtgNum",f:_7},32:{n:"PtgArray",f:s7},33:{n:"PtgFunc",f:g7},34:{n:"PtgFuncVar",f:v7},35:{n:"PtgName",f:k7},36:{n:"PtgRef",f:h7},37:{n:"PtgArea",f:t7},38:{n:"PtgMemArea",f:R7},39:{n:"PtgMemErr",f:I7},40:{n:"PtgMemNoMem",f:M7},41:{n:"PtgMemFunc",f:O7},42:{n:"PtgRefErr",f:V7},43:{n:"PtgAreaErr",f:n7},44:{n:"PtgRefN",f:p7},45:{n:"PtgAreaN",f:i7},46:{n:"PtgMemAreaN",f:e9},47:{n:"PtgMemNoMemN",f:t9},57:{n:"PtgNameX",f:F7},58:{n:"PtgRef3d",f:x7},59:{n:"PtgArea3d",f:r7},60:{n:"PtgRefErr3d",f:P7},61:{n:"PtgAreaErr3d",f:a7},255:{}},n9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},a9={1:{n:"PtgElfLel",f:pA},2:{n:"PtgElfRw",f:G7},3:{n:"PtgElfCol",f:L7},6:{n:"PtgElfRwV",f:Y7},7:{n:"PtgElfColV",f:z7},10:{n:"PtgElfRadical",f:H7},11:{n:"PtgElfRadicalS",f:W7},13:{n:"PtgElfColS",f:B7},15:{n:"PtgElfColSV",f:q7},16:{n:"PtgElfRadicalLel",f:$7},25:{n:"PtgList",f:K7},29:{n:"PtgSxName",f:Q7},255:{}},i9={0:{n:"PtgAttrNoop",f:r9},1:{n:"PtgAttrSemi",f:m7},2:{n:"PtgAttrIf",f:u7},4:{n:"PtgAttrChoose",f:o7},8:{n:"PtgAttrGoto",f:l7},16:{n:"PtgAttrSum",f:N7},32:{n:"PtgAttrBaxcel",f:E2},33:{n:"PtgAttrBaxcel",f:E2},64:{n:"PtgAttrSpace",f:d7},65:{n:"PtgAttrSpaceSemi",f:f7},128:{n:"PtgAttrIfError",f:c7},255:{}};function s9(e,t,r,n){if(n.biff<8)return Jn(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=A7(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=D7(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(Jn(e,t)),i}function o9(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=_2[i]||_2[n9[i]],(i===24||i===25)&&(a=(i===24?a9:i9)[e[e.l+1]]),!a||!a.f?Jn(e,t):s.push([a.n,a.f(e,t,r)]);return s}function l9(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var u9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function c9(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function xA(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function S2(e,t,r){var n=xA(e,t,r);return n=="#REF"?n:c9(n,r)}function qs(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],l,u,c,m=0,h=0,f,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",v=0,C=e[0].length;v<C;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Lt(" ",e[0][p][1][1]);break;case 1:g=Lt("\r",e[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}o.push(u+u9[b[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=Po(b[1][1],s,a),o.push(Io(c,i));break;case"PtgRefN":c=r?Po(b[1][1],r,a):b[1][1],o.push(Io(c,i));break;case"PtgRef3d":m=b[1][1],c=Po(b[1][2],s,a),x=S2(n,m,a),o.push(x+"!"+Io(c,i));break;case"PtgFunc":case"PtgFuncVar":var N=b[1][0],F=b[1][1];N||(N=0),N&=127;var E=N==0?[]:o.slice(-N);o.length-=N,F==="User"&&(F=E.shift()),o.push(F+"("+E.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":f=c2(b[1][1],r?{s:r}:s,a),o.push(b0(f,a));break;case"PtgArea":f=c2(b[1][1],s,a),o.push(b0(f,a));break;case"PtgArea3d":m=b[1][1],f=b[1][2],x=S2(n,m,a),o.push(x+"!"+b0(f,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=b[1][2];var w=(n.names||[])[h-1]||(n[0]||[])[h],S=w?w.Name:"SH33TJSNAME"+String(h);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var _=b[1][1];h=b[1][2];var U;if(a.biff<=5)_<0&&(_=-_),n[_]&&(U=n[_][h]);else{var R="";if(((n[_]||[])[0]||[])[0]==14849||(((n[_]||[])[0]||[])[0]==1025?n[_][h]&&n[_][h].itab>0&&(R=n.SheetNames[n[_][h].itab-1]+"!"):R=n.SheetNames[h-1]+"!"),n[_]&&n[_][h])R+=n[_][h].Name;else if(n[0]&&n[0][h])R+=n[0][h].Name;else{var q=(xA(n,_,a)||"").split(";;");q[h-1]?R=q[h-1]:R+="SH33TJSERRX"}o.push(R);break}U||(U={Name:"SH33TJSERRY"}),o.push(U.Name);break;case"PtgParen":var M="(",Y=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:M=Lt(" ",e[0][p][1][1])+M;break;case 3:M=Lt("\r",e[0][p][1][1])+M;break;case 4:Y=Lt(" ",e[0][p][1][1])+Y;break;case 5:Y=Lt("\r",e[0][p][1][1])+Y;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(M+o.pop()+Y);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:b[1][1],r:b[1][0]};var K={c:r.c,r:r.r};if(n.sharedf[vt(c)]){var de=n.sharedf[vt(c)];o.push(qs(de,s,K,n,a))}else{var pe=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(c.c<u[0].s.c||c.c>u[0].e.c)&&!(c.r<u[0].s.r||c.r>u[0].e.r)){o.push(qs(u[1],s,K,n,a)),pe=!0;break}pe||o.push(b[1])}break;case"PtgArray":o.push("{"+l9(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var Ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&Ae.indexOf(e[0][v][0])==-1){b=e[0][p];var Ne=!0;switch(b[1][0]){case 4:Ne=!1;case 0:g=Lt(" ",b[1][1]);break;case 5:Ne=!1;case 1:g=Lt("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((Ne?g:"")+o.pop()+(Ne?"":g)),p=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function m9(e){if(e==null){var t=ue(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return qi(e);return qi(0)}function d9(e,t,r,n,a){var i=zi(t,r,a),s=m9(e.v),o=ue(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=ue(e.bf.length),c=0;c<e.bf.length;++c)u[c]=e.bf[c];var m=fr([i,s,o,u]);return m}function Kc(e,t,r){var n=e.read_shift(4),a=o9(e,n,r),i=e.read_shift(4),s=i>0?s9(e,i,a,r):null;return[a,s]}var f9=Kc,Qc=Kc,h9=Kc,p9=Kc,x9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},gA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},g9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function v9(e){var t="of:="+e.replace(Pg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function b9(e){return e.replace(/\./,"!")}var Mo=typeof Map!="undefined";function jg(e,t,r){var n=0,a=e.length;if(r){if(Mo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Mo?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Mo?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Zc(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(ga=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=cc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Vp(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function vA(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ci(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){fD(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function N9(e,t,r){if(e&&e["!ref"]){var n=At(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function y9(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Kt(e[r])+'"/>';return t+"</mergeCells>"}function C9(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch(c){}i=!0,s.codeName=ll(gt(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+we("outlinePr",null,u)}!i&&!o||(a[a.length]=we("sheetPr",o,s))}var w9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],E9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _9(e){var t={sheet:1};return w9.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),E9.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=tA(e.password).toString(16).toUpperCase()),we("sheetProtection",null,t)}function S9(e){return vA(e),we("pageMargins",null,e)}function T9(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=we("col",null,Zc(a,n)));return r[r.length]="</cols>",r.join("")}function D9(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Kt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=rn(a);s.s.r==s.e.r&&(s.e.r=rn(t["!ref"]).e.r,a=Kt(s));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),we("autoFilter",null,{ref:a})}function A9(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),we("sheetViews",we("sheetView",null,a),{})}function k9(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Rl[e.v];break;case"d":n&&n.cellDates?a=Ur(e.v,-1).toISOString():(e=Lr(e),e.t="n",a=""+(e.v=jr(Ur(e.v)))),typeof e.z=="undefined"&&(e.z=qt[14]);break;default:a=e.v;break}var o=hr("v",gt(a)),l={r:t},u=ci(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=hr("v",""+jg(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var c=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=we("f",gt(e.f),c)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),we("c",o,l)}function F9(e,t,r,n){var a=[],i=[],s=At(e["!ref"]),o="",l,u="",c=[],m=0,h=0,f=e["!rows"],x=Array.isArray(e),p={r:u},g,v=-1;for(h=s.s.c;h<=s.e.c;++h)c[h]=wr(h);for(m=s.s.r;m<=s.e.r;++m){for(i=[],u=pr(m),h=s.s.c;h<=s.e.c;++h){l=c[h]+u;var C=x?(e[m]||[])[h]:e[l];C!==void 0&&(o=k9(C,l,e,t))!=null&&i.push(o)}(i.length>0||f&&f[m])&&(p={r:u},f&&f[m]&&(g=f[m],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=mc(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),a[a.length]=we("row",i.join(""),p))}if(f)for(;m<f.length;++m)f&&f[m]&&(p={r:m+1},g=f[m],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=mc(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level),a[a.length]=we("row","",p));return a.join("")}function bA(e,t,r,n){var a=[Qt,we("worksheet",null,{xmlns:Qs[0],"xmlns:r":sr.r})],i=r.SheetNames[e],s=0,o="",l=r.Sheets[i];l==null&&(l={});var u=l["!ref"]||"A1",c=At(u);if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),u=Kt(c)}n||(n={}),l["!comments"]=[];var m=[];C9(l,r,e,t,a),a[a.length]=we("dimension",null,{ref:u}),a[a.length]=A9(l,t,e,r),t.sheetFormat&&(a[a.length]=we("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=T9(l,l["!cols"])),a[s=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=F9(l,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),l["!protect"]&&(a[a.length]=_9(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=D9(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=y9(l["!merges"]));var h=-1,f,x=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(f={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=xt(n,-1,gt(p[1].Target).replace(/#.*$/,""),st.HLINK),f["r:id"]="rId"+x),(h=p[1].Target.indexOf("#"))>-1&&(f.location=gt(p[1].Target.slice(h+1))),p[1].Tooltip&&(f.tooltip=gt(p[1].Tooltip)),a[a.length]=we("hyperlink",null,f))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=S9(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=hr("ignoredErrors",we("ignoredError",null,{numberStoredAsText:1,sqref:u}))),m.length>0&&(x=xt(n,-1,"../drawings/drawing"+(e+1)+".xml",st.DRAW),a[a.length]=we("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=m),l["!comments"].length>0&&(x=xt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",st.VML),a[a.length]=we("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function U9(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function R9(e,t,r){var n=ue(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=mc(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:e,c:0},c=0;c<16;++c)if(!(t.s.c>c+1<<10||t.e.c<c<<10)){for(var m=-1,h=-1,f=c<<10;f<c+1<<10;++f){u.c=f;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[vt(u)];x&&(m<0&&(m=f),h=f)}m<0||(++o,n.write_shift(4,m),n.write_shift(4,h))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function O9(e,t,r,n){var a=R9(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&fe(e,0,a)}var V9=rs,P9=Js;function I9(){}function M9(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Y6(e),r}function j9(e,t,r){r==null&&(r=ue(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return oc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),OD(e,r),r.slice(0,r.l)}function L9(e){var t=gn(e);return[t]}function B9(e,t,r){return r==null&&(r=ue(8)),Ji(t,r)}function q9(e){var t=es(e);return[t]}function z9(e,t,r){return r==null&&(r=ue(4)),ts(t,r)}function H9(e){var t=gn(e),r=e.read_shift(1);return[t,r,"b"]}function $9(e,t,r){return r==null&&(r=ue(9)),Ji(t,r),r.write_shift(1,e.v?1:0),r}function W9(e){var t=es(e),r=e.read_shift(1);return[t,r,"b"]}function G9(e,t,r){return r==null&&(r=ue(5)),ts(t,r),r.write_shift(1,e.v?1:0),r}function Y9(e){var t=gn(e),r=e.read_shift(1);return[t,r,"e"]}function X9(e,t,r){return r==null&&(r=ue(9)),Ji(t,r),r.write_shift(1,e.v),r}function K9(e){var t=es(e),r=e.read_shift(1);return[t,r,"e"]}function Q9(e,t,r){return r==null&&(r=ue(8)),ts(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Z9(e){var t=gn(e),r=e.read_shift(4);return[t,r,"s"]}function J9(e,t,r){return r==null&&(r=ue(12)),Ji(t,r),r.write_shift(4,t.v),r}function eB(e){var t=es(e),r=e.read_shift(4);return[t,r,"s"]}function tB(e,t,r){return r==null&&(r=ue(8)),ts(t,r),r.write_shift(4,t.v),r}function rB(e){var t=gn(e),r=eo(e);return[t,r,"n"]}function nB(e,t,r){return r==null&&(r=ue(16)),Ji(t,r),qi(e.v,r),r}function aB(e){var t=es(e),r=eo(e);return[t,r,"n"]}function iB(e,t,r){return r==null&&(r=ue(12)),ts(t,r),qi(e.v,r),r}function sB(e){var t=gn(e),r=VD(e);return[t,r,"n"]}function oB(e,t,r){return r==null&&(r=ue(12)),Ji(t,r),PD(e.v,r),r}function lB(e){var t=es(e),r=VD(e);return[t,r,"n"]}function uB(e,t,r){return r==null&&(r=ue(8)),ts(t,r),PD(e.v,r),r}function cB(e){var t=gn(e),r=Fg(e);return[t,r,"is"]}function mB(e){var t=gn(e),r=Er(e);return[t,r,"str"]}function dB(e,t,r){return r==null&&(r=ue(12+4*e.v.length)),Ji(t,r),lr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function fB(e){var t=es(e),r=Er(e);return[t,r,"str"]}function hB(e,t,r){return r==null&&(r=ue(8+4*e.v.length)),ts(t,r),lr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function pB(e,t,r){var n=e.l+t,a=gn(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Qc(e,n-e.l,r);s[3]=qs(o,null,a,r.supbooks,r)}else e.l=n;return s}function xB(e,t,r){var n=e.l+t,a=gn(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Qc(e,n-e.l,r);s[3]=qs(o,null,a,r.supbooks,r)}else e.l=n;return s}function gB(e,t,r){var n=e.l+t,a=gn(e);a.r=r["!row"];var i=eo(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Qc(e,n-e.l,r);s[3]=qs(o,null,a,r.supbooks,r)}else e.l=n;return s}function vB(e,t,r){var n=e.l+t,a=gn(e);a.r=r["!row"];var i=Er(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Qc(e,n-e.l,r);s[3]=qs(o,null,a,r.supbooks,r)}else e.l=n;return s}var bB=rs,NB=Js;function yB(e,t){return t==null&&(t=ue(4)),t.write_shift(4,e),t}function CB(e,t){var r=e.l+t,n=rs(e),a=Ug(e),i=Er(e),s=Er(e),o=Er(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}function wB(e,t){var r=ue(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Js({s:or(e[0]),e:or(e[0])},r),Rg("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return lr(a||"",r),lr(e[1].Tooltip||"",r),lr("",r),r.slice(0,r.l)}function EB(){}function _B(e,t,r){var n=e.l+t,a=ID(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=f9(e,n-e.l,r);s[1]=o}else e.l=n;return s}function SB(e,t,r){var n=e.l+t,a=rs(e),i=[a];if(r.cellFormula){var s=p9(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function TB(e,t,r){r==null&&(r=ue(18));var n=Zc(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var NA=["left","right","top","bottom","header","footer"];function DB(e){var t={};return NA.forEach(function(r){t[r]=eo(e)}),t}function AB(e,t){return t==null&&(t=ue(48)),vA(e),NA.forEach(function(r){qi(e[r],t)}),t}function kB(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function FB(e,t,r){r==null&&(r=ue(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function UB(e){var t=ue(24);return t.write_shift(4,4),t.write_shift(4,1),Js(e,t),t}function RB(e,t){return t==null&&(t=ue(66)),t.write_shift(2,e.password?tA(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function OB(){}function VB(){}function PB(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Lr(t),t.z=t.z||qt[14],t.v=jr(Ur(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=ci(a.cellXfs,t,a),t.l&&i["!links"].push([vt(l),t.l]),t.c&&i["!comments"].push([vt(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=jg(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?fe(e,18,tB(t,l)):fe(e,7,J9(t,l))):(l.t="str",s?fe(e,17,hB(t,l)):fe(e,6,dB(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?fe(e,13,uB(t,l)):fe(e,2,oB(t,l)):s?fe(e,16,iB(t,l)):fe(e,5,nB(t,l)),!0;case"b":return l.t="b",s?fe(e,15,G9(t,l)):fe(e,4,$9(t,l)),!0;case"e":return l.t="e",s?fe(e,14,Q9(t,l)):fe(e,3,X9(t,l)),!0}return s?fe(e,12,z9(t,l)):fe(e,1,B9(t,l)),!0}function IB(e,t,r,n){var a=At(t["!ref"]||"A1"),i,s="",o=[];fe(e,145);var l=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var c=a.s.r;c<=u;++c){s=pr(c),O9(e,t,a,c);var m=!1;if(c<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){c===a.s.r&&(o[h]=wr(h)),i=o[h]+s;var f=l?(t[c]||[])[h]:t[i];if(!f){m=!1;continue}m=PB(e,f,c,h,n,t,m)}}fe(e,146)}function MB(e,t){!t||!t["!merges"]||(fe(e,177,yB(t["!merges"].length)),t["!merges"].forEach(function(r){fe(e,176,NB(r))}),fe(e,178))}function jB(e,t){!t||!t["!cols"]||(fe(e,390),t["!cols"].forEach(function(r,n){r&&fe(e,60,TB(n,r))}),fe(e,391))}function LB(e,t){!t||!t["!ref"]||(fe(e,648),fe(e,649,UB(At(t["!ref"]))),fe(e,650))}function BB(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=xt(r,-1,n[1].Target.replace(/#.*$/,""),st.HLINK);fe(e,494,wB(n,a))}}),delete t["!links"]}function qB(e,t,r,n){if(t["!comments"].length>0){var a=xt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",st.VML);fe(e,551,Rg("rId"+a)),t["!legacy"]=a}}function zB(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Kt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=rn(i);o.s.r==o.e.r&&(o.e.r=rn(t["!ref"]).e.r,i=Kt(o));for(var l=0;l<s.length;++l){var u=s[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),fe(e,161,Js(At(i))),fe(e,162)}}function HB(e,t,r){fe(e,133),fe(e,137,FB(t,r)),fe(e,138),fe(e,134)}function $B(e,t){t["!protect"]&&fe(e,535,RB(t["!protect"]))}function WB(e,t,r,n){var a=Pr(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch(u){}var l=At(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],fe(a,129),(r.vbaraw||s["!outline"])&&fe(a,147,j9(o,s["!outline"])),fe(a,148,P9(l)),HB(a,s,r.Workbook),jB(a,s),IB(a,s,e,t),$B(a,s),zB(a,s,r,e),MB(a,s),BB(a,s,n),s["!margins"]&&fe(a,476,AB(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&LB(a,s),qB(a,s,e,n),fe(a,130),a.end()}function GB(e,t){e.l+=10;var r=Er(e);return{name:r}}var YB=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function XB(e){return!e.Workbook||!e.Workbook.WBProps?"false":S6(e.Workbook.WBProps.date1904)?"true":"false"}var KB="][*?/\\".split("");function yA(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return KB.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function QB(e,t,r){e.forEach(function(n,a){yA(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function ZB(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];QB(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)N9(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function CA(e){var t=[Qt];t[t.length]=we("workbook",null,{xmlns:Qs[0],"xmlns:r":sr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(YB.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=we("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:gt(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=we("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=we("definedName",gt(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function JB(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Op(e),r.name=Er(e),r}function eq(e,t){return t||(t=ue(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Rg(e.strRelID,t),lr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function tq(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Er(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function rq(e,t){t||(t=ue(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),OD(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function nq(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=X6(e),s=h9(e,0,r),o=Ug(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function aq(e,t){fe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};fe(e,156,eq(a))}fe(e,144)}function iq(e,t){t||(t=ue(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return lr("SheetJS",t),lr(ec.version,t),lr(ec.version,t),lr("7262",t),t.length>t.l?t.slice(0,t.l):t}function sq(e,t){t||(t=ue(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function oq(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(fe(e,135),fe(e,158,sq(a)),fe(e,136))}}function lq(e,t){var r=Pr();return fe(r,131),fe(r,128,iq()),fe(r,153,rq(e.Workbook&&e.Workbook.WBProps||null)),oq(r,e),aq(r,e),fe(r,132),r.end()}function uq(e,t,r){return(t.slice(-4)===".bin"?lq:CA)(e)}function cq(e,t,r,n,a){return(t.slice(-4)===".bin"?WB:bA)(e,r,n,a)}function mq(e,t,r){return(t.slice(-4)===".bin"?AL:aA)(e,r)}function dq(e,t,r){return(t.slice(-4)===".bin"?rL:eA)(e,r)}function fq(e,t,r){return(t.slice(-4)===".bin"?$L:uA)(e)}function hq(e){return(e.slice(-4)===".bin"?IL:oA)()}function pq(e,t){var r=[];return e.Props&&r.push(mj(e.Props,t)),e.Custprops&&r.push(dj(e.Props,e.Custprops)),r.join("")}function xq(){return""}function gq(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(we("NumberFormat",null,{"ss:Format":gt(qt[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(we("Style",i.join(""),s))}),we("Styles",r.join(""))}function wA(e){return we("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Ig(e.Ref,{r:0,c:0})})}function vq(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(wA(a)))}return we("Names",r.join(""))}function bq(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(wA(o)))}return i.join("")}function Nq(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(we("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(we("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(we("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(we("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(hr("ProtectContents","True")),e["!protect"].objects&&a.push(hr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(hr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(hr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(hr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":we("WorksheetOptions",a.join(""),{xmlns:Kr.x})}function yq(e){return e.map(function(t){var r=_6(t.t||""),n=we("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return we("Comment",n,{"ss:Author":t.a})}).join("")}function Cq(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+gt(Ig(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=or(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=gt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=gt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],c=0;c!=u.length;++c)u[c].s.c!=s.c||u[c].s.r!=s.r||(u[c].e.c>u[c].s.c&&(o["ss:MergeAcross"]=u[c].e.c-u[c].s.c),u[c].e.r>u[c].s.r&&(o["ss:MergeDown"]=u[c].e.r-u[c].s.r));var m="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":m="Number",h=String(e.v);break;case"b":m="Boolean",h=e.v?"1":"0";break;case"e":m="Error",h=Rl[e.v];break;case"d":m="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||qt[14]);break;case"s":m="String",h=E6(e.v||"");break}var f=ci(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=s.c+1;var x=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+m+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=yq(e.c)),we("Cell",p,o)}function wq(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=nA(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Eq(e,t,r,n){if(!e["!ref"])return"";var a=At(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,v){Vg(g);var C=!!g.width,b=Zc(v,g),N={"ss:Index":v+1};C&&(N["ss:Width"]=uc(b.width)),g.hidden&&(N["ss:Hidden"]="1"),o.push(we("Column",null,N))});for(var l=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var c=[wq(u,(e["!rows"]||[])[u])],m=a.s.c;m<=a.e.c;++m){var h=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>m)&&!(i[s].s.r>u)&&!(i[s].e.c<m)&&!(i[s].e.r<u)){(i[s].s.c!=m||i[s].s.r!=u)&&(h=!0);break}if(!h){var f={r:u,c:m},x=vt(f),p=l?(e[u]||[])[m]:e[x];c.push(Cq(p,x,e,t,r,n,f))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function _q(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?bq(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?Eq(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Nq(i,t,e,r)),n.join("")}function Sq(e,t){t||(t={}),e.SSF||(e.SSF=Lr(qt)),e.SSF&&(Gc(),Wc(e.SSF),t.revssf=Yc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ci(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(pq(e,t)),r.push(xq()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(we("Worksheet",_q(n,t,e),{"ss:Name":gt(e.SheetNames[n])}));return r[2]=gq(e,t),r[3]=vq(e),Qt+we("Workbook",r.join(""),{xmlns:Kr.ss,"xmlns:o":Kr.o,"xmlns:x":Kr.x,"xmlns:ss":Kr.ss,"xmlns:dt":Kr.dt,"xmlns:html":Kr.html})}var C0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Tq(e,t){var r=[],n=[],a=[],i=0,s,o=JC(d2,"n"),l=JC(f2,"n");if(e.Props)for(s=xr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=xr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)GD.indexOf(a[i][0])>-1||HD.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&Nt.utils.cfb_add(t,"/SummaryInformation",v2(n,C0.SI,l,f2)),(r.length||u.length)&&Nt.utils.cfb_add(t,"/DocumentSummaryInformation",v2(r,C0.DSI,o,d2,u.length?u:null,C0.UDI))}function Dq(e,t){var r=t||{},n=Nt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Nt.utils.cfb_add(n,a,EA(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Tq(e,n),r.biff==8&&e.vbaraw&&WL(n,Nt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Aq={0:{f:U9},1:{f:L9},2:{f:sB},3:{f:Y9},4:{f:H9},5:{f:rB},6:{f:mB},7:{f:Z9},8:{f:vB},9:{f:gB},10:{f:pB},11:{f:xB},12:{f:q9},13:{f:lB},14:{f:K9},15:{f:W9},16:{f:aB},17:{f:fB},18:{f:eB},19:{f:Fg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nq},40:{},42:{},43:{f:mL},44:{f:uL},45:{f:hL},46:{f:xL},47:{f:pL},48:{},49:{f:q6},50:{},51:{f:UL},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zj},62:{f:cB},63:{f:ML},64:{f:OB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Jn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:kB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:M9},148:{f:V9,p:16},151:{f:EB},152:{},153:{f:tq},154:{},155:{},156:{f:JB},157:{},158:{},159:{T:1,f:Jj},160:{T:-1},161:{T:1,f:rs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:bB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:kL},336:{T:-1},337:{f:VL,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Op},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ij},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:_B},427:{f:SB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:DB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:I9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:CB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Op},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zL},633:{T:1},634:{T:-1},635:{T:1,f:BL},636:{T:-1},637:{f:W6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:GB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:VB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function _e(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&Dg(r)&&e.push(r)}}function kq(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return _e(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,l=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var c=e.next(4);for(c.write_shift(2,i),c.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<a;){for(c=e.next(4),c.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;c.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function Vl(e,t,r){return e||(e=ue(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Fq(e,t,r,n){var a=ue(9);return Vl(a,e,t),XD(r,n||"b",a),a}function Uq(e,t,r){var n=ue(8+2*r.length);return Vl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Rq(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?jr(Ur(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?_e(e,2,Gj(r,n,a)):_e(e,3,Wj(r,n,a));return;case"b":case"e":_e(e,5,Fq(r,n,t.v,t.t));return;case"s":case"str":_e(e,4,Uq(r,n,(t.v||"").slice(0,255)));return}_e(e,1,Vl(null,r,n))}function Oq(e,t,r,n){var a=Array.isArray(t),i=At(t["!ref"]||"A1"),s,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Kt(i)}for(var u=i.s.r;u<=i.e.r;++u){o=pr(u);for(var c=i.s.c;c<=i.e.c;++c){u===i.s.r&&(l[c]=wr(c)),s=l[c]+o;var m=a?(t[u]||[])[c]:t[s];m&&Rq(e,m,u,c)}}}function Vq(e,t){for(var r=t||{},n=Pr(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return _e(n,r.biff==4?1033:r.biff==3?521:9,Og(e,16,r)),Oq(n,e.Sheets[e.SheetNames[a]],a,r),_e(n,10),n.end()}function Pq(e,t,r){_e(e,49,Aj({sz:12,name:"Arial"},r))}function Iq(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&_e(e,1054,Uj(a,t[a],r))})}function Mq(e,t){var r=ue(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),_e(e,2151,r),r=ue(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),ZD(At(t["!ref"]||"A1"),r),r.write_shift(4,4),_e(e,2152,r)}function jq(e,t){for(var r=0;r<16;++r)_e(e,224,N2({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){_e(e,224,N2(n,0,t))})}function Lq(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];_e(e,440,Lj(n)),n[1].Tooltip&&_e(e,2048,Bj(n))}delete t["!links"]}function Bq(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&_e(e,125,Hj(Zc(a,n),a))})}}function qq(e,t,r,n,a){var i=16+ci(a.cellXfs,t,a);if(t.v==null&&!t.bf){_e(e,513,zi(r,n,i));return}if(t.bf)_e(e,6,d9(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?jr(Ur(t.v)):t.v;_e(e,515,Pj(r,n,s,i));break;case"b":case"e":_e(e,517,Vj(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=jg(a.Strings,t.v,a.revStrings);_e(e,253,kj(r,n,o,i))}else _e(e,516,Fj(r,n,(t.v||"").slice(0,255),i,a));break;default:_e(e,513,zi(r,n,i))}}function zq(e,t,r){var n=Pr(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(i),u=t.biff==8,c,m="",h=[],f=At(i["!ref"]||"A1"),x=u?65536:16384;if(f.e.c>255||f.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,x-1)}_e(n,2057,Og(r,16,t)),_e(n,13,un(1)),_e(n,12,un(100)),_e(n,15,Dr(!0)),_e(n,17,Dr(!1)),_e(n,16,qi(.001)),_e(n,95,Dr(!0)),_e(n,42,Dr(!1)),_e(n,43,Dr(!1)),_e(n,130,un(1)),_e(n,128,Oj()),_e(n,131,Dr(!1)),_e(n,132,Dr(!1)),u&&Bq(n,i["!cols"]),_e(n,512,Rj(f,t)),u&&(i["!links"]=[]);for(var p=f.s.r;p<=f.e.r;++p){m=pr(p);for(var g=f.s.c;g<=f.e.c;++g){p===f.s.r&&(h[g]=wr(g)),c=h[g]+m;var v=l?(i[p]||[])[g]:i[c];v&&(qq(n,v,p,g,t),u&&v.l&&i["!links"].push([c,v.l]))}}var C=o.CodeName||o.name||a;return u&&_e(n,574,Dj((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&_e(n,229,jj(i["!merges"])),u&&Lq(n,i),_e(n,442,QD(C)),u&&Mq(n,i),_e(n,10),n.end()}function Hq(e,t,r){var n=Pr(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(_e(n,2057,Og(e,5,r)),r.bookType=="xla"&&_e(n,135),_e(n,225,o?un(1200):null),_e(n,193,pj(2)),l&&_e(n,191),l&&_e(n,192),_e(n,226),_e(n,92,Ej("SheetJS",r)),_e(n,66,un(o?1200:1252)),o&&_e(n,353,un(0)),o&&_e(n,448),_e(n,317,$j(e.SheetNames.length)),o&&e.vbaraw&&_e(n,211),o&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";_e(n,442,QD(u))}_e(n,156,un(17)),_e(n,25,Dr(!1)),_e(n,18,Dr(!1)),_e(n,19,un(0)),o&&_e(n,431,Dr(!1)),o&&_e(n,444,un(0)),_e(n,61,Tj()),_e(n,64,Dr(!1)),_e(n,141,un(0)),_e(n,34,Dr(XB(e)=="true")),_e(n,14,Dr(!0)),o&&_e(n,439,Dr(!1)),_e(n,218,un(0)),Pq(n,e,r),Iq(n,e.SSF,r),jq(n,r),o&&_e(n,352,Dr(!1));var c=n.end(),m=Pr();o&&_e(m,140,qj()),o&&r.Strings&&kq(m,252,Sj(r.Strings)),_e(m,10);var h=m.end(),f=Pr(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=c.length+x+h.length;for(p=0;p<e.SheetNames.length;++p){var v=i[p]||{};_e(f,133,_j({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var C=f.end();if(x!=C.length)throw new Error("BS8 "+x+" != "+C.length);var b=[];return c.length&&b.push(c),C.length&&b.push(C),h.length&&b.push(h),fr(b)}function $q(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Lr(qt)),e&&e.SSF&&(Gc(),Wc(e.SSF),r.revssf=Yc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Lg(r),r.cellXfs=[],ci(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=zq(a,r,e);return n.unshift(Hq(e,n,r)),fr(n)}function EA(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=rn(n["!ref"]);a.e.c>255&&typeof console!="undefined"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return $q(e,t);case 4:case 3:case 2:return Vq(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Wq(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){o=-1;break}o=a[u].e.r-a[u].s.r+1,l=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var c=vt({r,c:s}),m=n.dense?(e[r]||[])[s]:e[c],h=m&&m.v!=null&&(m.h||w6(m.w||(wa(m),m.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":m&&(f["data-t"]=m&&m.t||"z",m.v!=null&&(f["data-v"]=m.v),m.z!=null&&(f["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+m.l.Target+'">'+h+"</a>")),f.id=(n.id||"sjs")+"-"+c,i.push(we("td",h,f))}}var x="<tr>";return x+i.join("")+"</tr>"}var Gq='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Yq="</body></html>";function Xq(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function _A(e,t){var r=t||{},n=r.header!=null?r.header:Gq,a=r.footer!=null?r.footer:Yq,i=[n],s=rn(e["!ref"]);r.dense=Array.isArray(e),i.push(Xq(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(Wq(e,s,o,r));return i.push("</table>"+a),i.join("")}function SA(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?or(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var c=rn(e["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),a==-1&&(u.e.r=a=c.e.r+1)}var m=[],h=0,f=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,v=0,C=0,b=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&p<l;++x){var N=o[x];if(T2(N)){if(n.display)continue;f[p]={hidden:!0}}var F=N.children;for(g=v=0;g<F.length;++g){var E=F[g];if(!(n.display&&T2(E))){var w=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):T6(E.innerHTML),S=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<m.length;++h){var _=m[h];_.s.c==v+i&&_.s.r<p+a&&p+a<=_.e.r&&(v=_.e.c+1-i,h=-1)}b=+E.getAttribute("colspan")||1,((C=+E.getAttribute("rowspan")||1)>1||b>1)&&m.push({s:{r:p+a,c:v+i},e:{r:p+a+(C||1)-1,c:v+i+(b||1)-1}});var U={t:"s",v:w},R=E.getAttribute("data-t")||E.getAttribute("t")||"";w!=null&&(w.length==0?U.t=R||"z":n.raw||w.trim().length==0||R=="s"||(w==="TRUE"?U={t:"b",v:!0}:w==="FALSE"?U={t:"b",v:!1}:isNaN(xa(w))?isNaN(ol(w).getDate())||(U={t:"d",v:Ur(w)},n.cellDates||(U={t:"n",v:jr(U.v)}),U.z=n.dateNF||qt[14]):U={t:"n",v:xa(w)})),U.z===void 0&&S!=null&&(U.z=S);var q="",M=E.getElementsByTagName("A");if(M&&M.length)for(var Y=0;Y<M.length&&!(M[Y].hasAttribute("href")&&(q=M[Y].getAttribute("href"),q.charAt(0)!="#"));++Y);q&&q.charAt(0)!="#"&&(U.l={Target:q}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][v+i]=U):e[vt({c:v+i,r:p+a})]=U,u.e.c<v+i&&(u.e.c=v+i),v+=b}}++p}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),u.e.r=Math.max(u.e.r,p-1+a),e["!ref"]=Kt(u),p>=l&&(e["!fullref"]=Kt((u.e.r=o.length-x+p-1+a,u))),e}function TA(e,t){var r=t||{},n=r.dense?[]:{};return SA(n,e,t)}function Kq(e,t){return Zi(TA(e,t),t)}function T2(e){var t="",r=Qq(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Qq(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Zq=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ul({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Qt+t}})(),D2=(function(){var e=function(i){return gt(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var l=[];l.push('      <table:table table:name="'+gt(s.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,c=0,m=rn(i["!ref"]||"A1"),h=i["!merges"]||[],f=0,x=Array.isArray(i);if(i["!cols"])for(c=0;c<=m.e.c;++c)l.push("        <table:table-column"+(i["!cols"][c]?' table:style-name="co'+i["!cols"][c].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(u=0;u<m.s.r;++u)p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=m.e.r;++u){for(p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",l.push("        <table:table-row"+p+`>
`),c=0;c<m.s.c;++c)l.push(t);for(;c<=m.e.c;++c){var v=!1,C={},b="";for(f=0;f!=h.length;++f)if(!(h[f].s.c>c)&&!(h[f].s.r>u)&&!(h[f].e.c<c)&&!(h[f].e.r<u)){(h[f].s.c!=c||h[f].s.r!=u)&&(v=!0),C["table:number-columns-spanned"]=h[f].e.c-h[f].s.c+1,C["table:number-rows-spanned"]=h[f].e.r-h[f].s.r+1;break}if(v){l.push(r);continue}var N=vt({r:u,c}),F=x?(i[u]||[])[c]:i[N];if(F&&F.f&&(C["table:formula"]=gt(v9(F.f)),F.F&&F.F.slice(0,N.length)==N)){var E=rn(F.F);C["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,C["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!F){l.push(t);continue}switch(F.t){case"b":b=F.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=F.v?"true":"false";break;case"n":b=F.w||String(F.v||0),C["office:value-type"]="float",C["office:value"]=F.v||0;break;case"s":case"str":b=F.v==null?"":F.v,C["office:value-type"]="string";break;case"d":b=F.w||Ur(F.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=Ur(F.v).toISOString(),C["table:style-name"]="ce1";break;default:l.push(t);continue}var w=e(b);if(F.l&&F.l.Target){var S=F.l.Target;S=S.charAt(0)=="#"?"#"+b9(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),w=we("text:a",w,{"xlink:href":S.replace(/&/g,"&amp;")})}l.push("          "+we("table:table-cell",we("text:p",w,{}),C)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var c=0;c<u["!cols"].length;++c)if(u["!cols"][c]){var m=u["!cols"][c];if(m.width==null&&m.wpx==null&&m.wch==null)continue;Vg(m),m.ods=o;var h=u["!cols"][c].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var c=0;c<u["!rows"].length;++c)if(u["!rows"][c]){u["!rows"][c].ods=l;var m=u["!rows"][c].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var l=[Qt],u=ul({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=ul({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+c+`>
`),l.push(qD().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),a(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var m=0;m!=s.SheetNames.length;++m)l.push(n(s.Sheets[s.SheetNames[m]],s,m));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function DA(e,t){if(t.bookType=="fods")return D2(e,t);var r=Eg(),n="",a=[],i=[];return n="mimetype",Ze(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ze(r,n,D2(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Ze(r,n,Zq(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Ze(r,n,Qt+qD()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Ze(r,n,cj(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ze(r,n,lj(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function dc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Jq(e){return typeof TextEncoder!="undefined"?new TextEncoder().encode(e):Dn(ll(e))}function ez(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ti(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function tz(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function cl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function pt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ds(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function er(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=cl(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=cl(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function mr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(pt(n*8+a.type)),a.type==2&&t.push(pt(a.data.length)),t.push(a.data))})}),ti(t)}function Nn(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=cl(e,n),i=er(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Ds(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=er(o.data),u=Ds(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=Ds(i[3][0].data)>>>0>0),r.push(s)}return r}function ls(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:pt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:pt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:pt(s.data.length)}],n[2].push({data:mr(s.meta),type:2})});var i=mr(n);t.push(pt(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),ti(t)}function rz(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=cl(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[ti(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(a.push(a[0].slice(-l)),u-=l;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-l,-l+u))}}var c=ti(a);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function yn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(rz(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ti(t)}function us(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=pt(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return ti(t)}function w0(e,t){var r=new Uint8Array(32),n=dc(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,tz(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function E0(e,t){var r=new Uint8Array(32),n=dc(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Ua(e){var t=er(e);return cl(t[1][0].data)}function nz(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Ds(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=dc(e[7][0].data),c=0,m=[],h=dc(e[4][0].data),f=0,x=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}u.setUint16(p*2,c,!0),h.setUint16(p*2,f,!0);var g,v;switch(typeof t[p]){case"string":g=w0({t:"s",v:t[p]},r),v=E0({t:"s",v:t[p]},r);break;case"number":g=w0({t:"n",v:t[p]},r),v=E0({t:"n",v:t[p]},r);break;case"boolean":g=w0({t:"b",v:t[p]},r),v=E0({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}m.push(g),c+=g.length,x.push(v),f+=v.length,++l}for(e[2][0].data=pt(l);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=ti(m),e[3][0].data=ti(x),l}function az(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=rn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Kt(n)));var i=fc(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(y){return y.forEach(function(V){typeof V=="string"&&s.push(V)})});var o={},l=[],u=Nt.read(t.numbers,{type:"base64"});u.FileIndex.map(function(y,V){return[y,u.FullPaths[V]]}).forEach(function(y){var V=y[0],I=y[1];if(V.type==2&&V.name.match(/\.iwa/)){var G=V.content,ie=yn(G),ae=Nn(ie);ae.forEach(function(Q){l.push(Q.id),o[Q.id]={deps:[],location:I,type:Ds(Q.messages[0].meta[1][0].data)}})}}),l.sort(function(y,V){return y-V});var c=l.filter(function(y){return y>1}).map(function(y){return[y,pt(y)]});u.FileIndex.map(function(y,V){return[y,u.FullPaths[V]]}).forEach(function(y){var V=y[0];if(V.name.match(/\.iwa/)){var I=Nn(yn(V.content));I.forEach(function(G){G.messages.forEach(function(ie){c.forEach(function(ae){G.messages.some(function(Q){return Ds(Q.meta[1][0].data)!=11006&&ez(Q.data,ae[1])})&&o[ae[0]].deps.push(G.id)})})})}});for(var m=Nt.find(u,o[1].location),h=Nn(yn(m.content)),f,x=0;x<h.length;++x){var p=h[x];p.id==1&&(f=p)}var g=Ua(er(f.messages[0].data)[1][0].data);for(m=Nt.find(u,o[g].location),h=Nn(yn(m.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(f=p);for(g=Ua(er(f.messages[0].data)[2][0].data),m=Nt.find(u,o[g].location),h=Nn(yn(m.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(f=p);for(g=Ua(er(f.messages[0].data)[2][0].data),m=Nt.find(u,o[g].location),h=Nn(yn(m.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(f=p);var v=er(f.messages[0].data);{v[6][0].data=pt(n.e.r+1),v[7][0].data=pt(n.e.c+1);var C=Ua(v[46][0].data),b=Nt.find(u,o[C].location),N=Nn(yn(b.content));{for(var F=0;F<N.length&&N[F].id!=C;++F);if(N[F].id!=C)throw"Bad ColumnRowUIDMapArchive";var E=er(N[F].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var w=0;w<=n.e.c;++w){var S=[];S[1]=S[2]=[{type:0,data:pt(w+420690)}],E[1].push({type:2,data:mr(S)}),E[2].push({type:0,data:pt(w)}),E[3].push({type:0,data:pt(w)})}E[4]=[],E[5]=[],E[6]=[];for(var _=0;_<=n.e.r;++_)S=[],S[1]=S[2]=[{type:0,data:pt(_+726270)}],E[4].push({type:2,data:mr(S)}),E[5].push({type:0,data:pt(_)}),E[6].push({type:0,data:pt(_)});N[F].messages[0].data=mr(E)}b.content=us(ls(N)),b.size=b.content.length,delete v[46];var U=er(v[4][0].data);{U[7][0].data=pt(n.e.r+1);var R=er(U[1][0].data),q=Ua(R[2][0].data);b=Nt.find(u,o[q].location),N=Nn(yn(b.content));{if(N[0].id!=q)throw"Bad HeaderStorageBucket";var M=er(N[0].messages[0].data);for(_=0;_<i.length;++_){var Y=er(M[2][0].data);Y[1][0].data=pt(_),Y[4][0].data=pt(i[_].length),M[2][_]={type:M[2][0].type,data:mr(Y)}}N[0].messages[0].data=mr(M)}b.content=us(ls(N)),b.size=b.content.length;var K=Ua(U[2][0].data);b=Nt.find(u,o[K].location),N=Nn(yn(b.content));{if(N[0].id!=K)throw"Bad HeaderStorageBucket";for(M=er(N[0].messages[0].data),w=0;w<=n.e.c;++w)Y=er(M[2][0].data),Y[1][0].data=pt(w),Y[4][0].data=pt(n.e.r+1),M[2][w]={type:M[2][0].type,data:mr(Y)};N[0].messages[0].data=mr(M)}b.content=us(ls(N)),b.size=b.content.length;var de=Ua(U[4][0].data);(function(){for(var y=Nt.find(u,o[de].location),V=Nn(yn(y.content)),I,G=0;G<V.length;++G){var ie=V[G];ie.id==de&&(I=ie)}var ae=er(I.messages[0].data);{ae[3]=[];var Q=[];s.forEach(function(J,je){Q[1]=[{type:0,data:pt(je)}],Q[2]=[{type:0,data:pt(1)}],Q[3]=[{type:2,data:Jq(J)}],ae[3].push({type:2,data:mr(Q)})})}I.messages[0].data=mr(ae);var Z=ls(V),ve=us(Z);y.content=ve,y.size=y.content.length})();var pe=er(U[3][0].data);{var Ae=pe[1][0];delete pe[2];var Ne=er(Ae.data);{var k=Ua(Ne[2][0].data);(function(){for(var y=Nt.find(u,o[k].location),V=Nn(yn(y.content)),I,G=0;G<V.length;++G){var ie=V[G];ie.id==k&&(I=ie)}var ae=er(I.messages[0].data);{delete ae[6],delete pe[7];var Q=new Uint8Array(ae[5][0].data);ae[5]=[];for(var Z=0,ve=0;ve<=n.e.r;++ve){var J=er(Q);Z+=nz(J,i[ve],s),J[1][0].data=pt(ve),ae[5].push({data:mr(J),type:2})}ae[1]=[{type:0,data:pt(n.e.c+1)}],ae[2]=[{type:0,data:pt(n.e.r+1)}],ae[3]=[{type:0,data:pt(Z)}],ae[4]=[{type:0,data:pt(n.e.r+1)}]}I.messages[0].data=mr(ae);var je=ls(V),ke=us(je);y.content=ke,y.size=y.content.length})()}Ae.data=mr(Ne)}U[3][0].data=mr(pe)}v[4][0].data=mr(U)}f.messages[0].data=mr(v);var le=ls(h),j=us(le);return m.content=j,m.size=m.content.length,u}function iz(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Lg(e){iz([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function sz(e,t){return t.bookType=="ods"?DA(e,t):t.bookType=="numbers"?az(e,t):t.bookType=="xlsb"?oz(e,t):lz(e,t)}function oz(e,t){gs=1024,e&&!e.SSF&&(e.SSF=Lr(qt)),e&&e.SSF&&(Gc(),Wc(e.SSF),t.revssf=Yc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Mo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=cA.indexOf(t.bookType)>-1,a=jD();Lg(t=t||{});var i=Eg(),s="",o=0;if(t.cellXfs=[],ci(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ze(i,s,zD(e.Props,t)),a.coreprops.push(s),xt(t.rels,2,s,st.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Ze(i,s,$D(e.Props)),a.extprops.push(s),xt(t.rels,3,s,st.EXT_PROPS),e.Custprops!==e.Props&&xr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ze(i,s,WD(e.Custprops)),a.custprops.push(s),xt(t.rels,4,s,st.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var c={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],h=(m||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ze(i,s,cq(o-1,s,t,e,c)),a.sheets.push(s),xt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,st.WS[0])}if(m){var f=m["!comments"],x=!1,p="";f&&f.length>0&&(p="xl/comments"+o+"."+r,Ze(i,p,fq(f,p)),a.comments.push(p),xt(c,-1,"../comments"+o+"."+r,st.CMNT),x=!0),m["!legacy"]&&x&&Ze(i,"xl/drawings/vmlDrawing"+o+".vml",lA(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}c["!id"].rId1&&Ze(i,BD(s),Ss(c))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ze(i,s,dq(t.Strings,s,t)),a.strs.push(s),xt(t.wbrels,-1,"sharedStrings."+r,st.SST)),s="xl/workbook."+r,Ze(i,s,uq(e,s)),a.workbooks.push(s),xt(t.rels,1,s,st.WB),s="xl/theme/theme1.xml",Ze(i,s,sA(e.Themes,t)),a.themes.push(s),xt(t.wbrels,-1,"theme/theme1.xml",st.THEME),s="xl/styles."+r,Ze(i,s,mq(e,s,t)),a.styles.push(s),xt(t.wbrels,-1,"styles."+r,st.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ze(i,s,e.vbaraw),a.vba.push(s),xt(t.wbrels,-1,"vbaProject.bin",st.VBA)),s="xl/metadata."+r,Ze(i,s,hq(s)),a.metadata.push(s),xt(t.wbrels,-1,"metadata."+r,st.XLMETA),Ze(i,"[Content_Types].xml",LD(a,t)),Ze(i,"_rels/.rels",Ss(t.rels)),Ze(i,"xl/_rels/workbook."+r+".rels",Ss(t.wbrels)),delete t.revssf,delete t.ssf,i}function lz(e,t){gs=1024,e&&!e.SSF&&(e.SSF=Lr(qt)),e&&e.SSF&&(Gc(),Wc(e.SSF),t.revssf=Yc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Mo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=cA.indexOf(t.bookType)>-1,a=jD();Lg(t=t||{});var i=Eg(),s="",o=0;if(t.cellXfs=[],ci(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ze(i,s,zD(e.Props,t)),a.coreprops.push(s),xt(t.rels,2,s,st.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Ze(i,s,$D(e.Props)),a.extprops.push(s),xt(t.rels,3,s,st.EXT_PROPS),e.Custprops!==e.Props&&xr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ze(i,s,WD(e.Custprops)),a.custprops.push(s),xt(t.rels,4,s,st.CUST_PROPS));var c=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var m={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ze(i,s,bA(o-1,t,e,m)),a.sheets.push(s),xt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,st.WS[0])}if(h){var x=h["!comments"],p=!1,g="";if(x&&x.length>0){var v=!1;x.forEach(function(C){C[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+o+"."+r,Ze(i,g,jL(x,c,t)),a.threadedcomments.push(g),xt(m,-1,"../threadedComments/threadedComment"+o+"."+r,st.TCMNT)),g="xl/comments"+o+"."+r,Ze(i,g,uA(x)),a.comments.push(g),xt(m,-1,"../comments"+o+"."+r,st.CMNT),p=!0}h["!legacy"]&&p&&Ze(i,"xl/drawings/vmlDrawing"+o+".vml",lA(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}m["!id"].rId1&&Ze(i,BD(s),Ss(m))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ze(i,s,eA(t.Strings,t)),a.strs.push(s),xt(t.wbrels,-1,"sharedStrings."+r,st.SST)),s="xl/workbook."+r,Ze(i,s,CA(e)),a.workbooks.push(s),xt(t.rels,1,s,st.WB),s="xl/theme/theme1.xml",Ze(i,s,sA(e.Themes,t)),a.themes.push(s),xt(t.wbrels,-1,"theme/theme1.xml",st.THEME),s="xl/styles."+r,Ze(i,s,aA(e,t)),a.styles.push(s),xt(t.wbrels,-1,"styles."+r,st.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ze(i,s,e.vbaraw),a.vba.push(s),xt(t.wbrels,-1,"vbaProject.bin",st.VBA)),s="xl/metadata."+r,Ze(i,s,oA()),a.metadata.push(s),xt(t.wbrels,-1,"metadata."+r,st.XLMETA),c.length>1&&(s="xl/persons/person.xml",Ze(i,s,LL(c)),a.people.push(s),xt(t.wbrels,-1,"persons/person.xml",st.PEOPLE)),Ze(i,"[Content_Types].xml",LD(a,t)),Ze(i,"_rels/.rels",Ss(t.rels)),Ze(i,"xl/_rels/workbook."+r+".rels",Ss(t.wbrels)),delete t.revssf,delete t.ssf,i}function uz(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ca(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function AA(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Fl(t.file,Nt.write(e,{type:ct?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Nt.write(e,t)}function cz(e,t){var r=Lr(t||{}),n=sz(e,r);return mz(n,r)}function mz(e,t){var r={},n=ct?"nodebuffer":typeof Uint8Array!="undefined"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Nt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno!="undefined"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array($c(a))}return t.password&&typeof encrypt_agile!="undefined"?AA(encrypt_agile(a,t.password),t):t.type==="file"?Fl(t.file,a):t.type=="string"?Oo(a):a}function dz(e,t){var r=t||{},n=Dq(e,r);return AA(n,r)}function jn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return sl(ll(n));case"binary":return ll(n);case"string":return e;case"file":return Fl(t.file,n,"utf8");case"buffer":return ct?ka(n,"utf8"):typeof TextEncoder!="undefined"?new TextEncoder().encode(n):jn(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function fz(e,t){switch(t.type){case"base64":return sl(e);case"binary":return e;case"string":return e;case"file":return Fl(t.file,e,"binary");case"buffer":return ct?ka(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function hu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?sl(r):t.type=="string"?Oo(r):r;case"file":return Fl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function kA(e,t){B8(),ZB(e);var r=Lr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=kA(e,r);return r.type="array",$c(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return jn(Sq(e,r),r);case"slk":case"sylk":return jn(Xj.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return jn(_A(e.Sheets[e.SheetNames[a]],r),r);case"txt":return fz(FA(e.Sheets[e.SheetNames[a]],r),r);case"csv":return jn(Bg(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return jn(Kj.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return hu(Yj.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return jn(Qj.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return jn(aL.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return jn(JD.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return jn(DA(e,r),r);case"wk1":return hu(y2.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return hu(y2.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),hu(EA(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),dz(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return cz(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function hz(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function pz(e,t,r){var n={};return n.type="file",n.file=t,hz(n),kA(e,n)}function xz(e,t,r,n,a,i,s,o){var l=pr(r),u=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),m=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch(g){h.__rowNum__=r}else h.__rowNum__=r;if(!s||e[r])for(var f=t.s.c;f<=t.e.c;++f){var x=s?e[r][f]:e[n[f]+l];if(x===void 0||x.t===void 0){if(u===void 0)continue;i[f]!=null&&(h[i[f]]=u);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[f]!=null){if(p==null)if(x.t=="e"&&p===null)h[i[f]]=null;else if(u!==void 0)h[i[f]]=u;else if(c&&p===null)h[i[f]]=null;else continue;else h[i[f]]=c&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?p:wa(x,p,o);p!=null&&(m=!1)}}return{row:h,isempty:m}}function fc(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},c=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof c){case"string":l=At(c);break;case"number":l=At(e["!ref"]),l.s.r=c;break;default:l=c}n>0&&(a=0);var m=pr(l.s.r),h=[],f=[],x=0,p=0,g=Array.isArray(e),v=l.s.r,C=0,b={};g&&!e[v]&&(e[v]=[]);var N=u.skipHidden&&e["!cols"]||[],F=u.skipHidden&&e["!rows"]||[];for(C=l.s.c;C<=l.e.c;++C)if(!(N[C]||{}).hidden)switch(h[C]=wr(C),r=g?e[v][C]:e[h[C]+m],n){case 1:i[C]=C-l.s.c;break;case 2:i[C]=h[C];break;case 3:i[C]=u.header[C-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=wa(r,null,u),p=b[s]||0,!p)b[s]=1;else{do o=s+"_"+p++;while(b[o]);b[s]=p,b[o]=1}i[C]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(F[v]||{}).hidden){var E=xz(e,l,v,h,n,i,g,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(f[x++]=E.row)}return f.length=x,f}var A2=/"/g;function gz(e,t,r,n,a,i,s,o){for(var l=!0,u=[],c="",m=pr(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var f=o.dense?(e[r]||[])[h]:e[n[h]+m];if(f==null)c="";else if(f.v!=null){l=!1,c=""+(o.rawNumbers&&f.t=="n"?f.v:wa(f,null,o));for(var x=0,p=0;x!==c.length;++x)if((p=c.charCodeAt(x))===a||p===i||p===34||o.forceQuotes){c='"'+c.replace(A2,'""')+'"';break}c=="ID"&&(c='"ID"')}else f.f!=null&&!f.F?(l=!1,c="="+f.f,c.indexOf(",")>=0&&(c='"'+c.replace(A2,'""')+'"')):c="";u.push(c)}return o.blankrows===!1&&l?null:u.join(s)}function Bg(e,t){var r=[],n=t==null?{}:t;if(e==null||e["!ref"]==null)return"";var a=At(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),c="",m=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(h[x]||{}).hidden||(m[x]=wr(x));for(var p=0,g=a.s.r;g<=a.e.r;++g)(f[g]||{}).hidden||(c=gz(e,a,g,m,s,l,i,n),c!=null&&(n.strip&&(c=c.replace(u,"")),(c||n.blankrows!==!1)&&r.push((p++?o:"")+c)));return delete n.dense,r.join("")}function FA(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Bg(e,t);return r}function vz(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=At(e["!ref"]),i="",s=[],o,l=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=wr(o);for(var c=a.s.r;c<=a.e.r;++c)for(i=pr(c),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=u?(e[c]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function UA(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?or(n.origin):n.origin;s=l.r,o=l.c}var u,c={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var m=At(i["!ref"]);c.e.c=Math.max(c.e.c,m.e.c),c.e.r=Math.max(c.e.r,m.e.r),s==-1&&(s=m.e.r+1,c.e.r=s+t.length-1+a)}else s==-1&&(s=0,c.e.r=t.length-1+a);var h=n.header||[],f=0;t.forEach(function(p,g){xr(p).forEach(function(v){(f=h.indexOf(v))==-1&&(h[f=h.length]=v);var C=p[v],b="z",N="",F=vt({c:o+f,r:s+g+a});u=ml(i,F),C&&typeof C=="object"&&!(C instanceof Date)?i[F]=C:(typeof C=="number"?b="n":typeof C=="boolean"?b="b":typeof C=="string"?b="s":C instanceof Date?(b="d",n.cellDates||(b="n",C=jr(C)),N=n.dateNF||qt[14]):C===null&&n.nullError&&(b="e",C=0),u?(u.t=b,u.v=C,delete u.w,delete u.R,N&&(u.z=N)):i[F]=u={t:b,v:C},N&&(u.z=N))})}),c.e.c=Math.max(c.e.c,o+h.length-1);var x=pr(s);if(a)for(f=0;f<h.length;++f)i[wr(f+o)+x]={t:"s",v:h[f]};return i["!ref"]=Kt(c),i}function bz(e,t){return UA(null,e,t)}function ml(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=or(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ml(e,vt(t)):ml(e,vt({r:t,c:r||0}))}function Nz(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function yz(){return{SheetNames:[],Sheets:{}}}function Cz(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(yA(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function wz(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Nz(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Ez(e,t){return e.z=t,e}function RA(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function _z(e,t,r){return RA(e,"#"+t,r)}function Sz(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Tz(e,t,r,n){for(var a=typeof t!="string"?t:At(t),i=typeof t=="string"?t:Kt(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=ml(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var $n={encode_col:wr,encode_row:pr,encode_cell:vt,encode_range:Kt,decode_col:kg,decode_row:Ag,split_cell:B6,decode_cell:or,decode_range:rn,format_cell:wa,sheet_add_aoa:RD,sheet_add_json:UA,sheet_add_dom:SA,aoa_to_sheet:Zs,json_to_sheet:bz,table_to_sheet:TA,table_to_book:Kq,sheet_to_csv:Bg,sheet_to_txt:FA,sheet_to_json:fc,sheet_to_html:_A,sheet_to_formulae:vz,sheet_to_row_object_array:fc,sheet_get_cell:ml,book_new:yz,book_append_sheet:Cz,book_set_sheet_visibility:wz,cell_set_number_format:Ez,cell_set_hyperlink:RA,cell_set_internal_link:_z,cell_add_comment:Sz,sheet_set_array_formula:Tz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Dz(e){const t=$n.book_new();if(e.options.includeSummary){const a=Az(e);$n.book_append_sheet(t,a,"Summary")}if(e.options.includeAllInspections){const a=Pp(e.inspections);$n.book_append_sheet(t,a,"All Inspections")}if(e.options.includeProblemAreas){const a=OA(e.inspections);$n.book_append_sheet(t,a,"Problem Areas")}if(e.options.includeCustodialNotes){const a=VA(e.custodialNotes);$n.book_append_sheet(t,a,"Custodial Notes")}const n=`Custodial_Command_Report_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;pz(t,n)}function Az(e){const t=bg(e.inspections),r=Ng(e.custodialNotes),n=[["CUSTODIAL COMMAND - EXECUTIVE SUMMARY"],["Generated:",new Date().toLocaleString()],[""],["KEY METRICS"],["Total Inspections:",e.inspections.length],["Critical Issues (Rating < 2.0):",t.critical.length],["Needs Attention (Rating 2.0-3.0):",t.needsAttention.length],["Urgent Custodial Notes:",r.length],["Affected Schools:",t.summary.affectedSchools.length],[""],["SCHOOL PERFORMANCE"],["Most Problematic School:",t.summary.mostProblematicSchool||"N/A"],["Affected Schools:",t.summary.affectedSchools.join(", ")],[""],["SEVERITY BREAKDOWN"],["Critical Issues:",t.critical.length],["Needs Attention:",t.needsAttention.length],["Acceptable Performance:",e.inspections.length-t.summary.totalProblems],[""],["AVERAGE RATINGS BY SCHOOL"]],a=e.inspections.reduce((i,s)=>{const o=Qi(s);return o===null||(i[s.school]||(i[s.school]={total:0,count:0}),i[s.school].total+=o,i[s.school].count+=1),i},{});return Object.entries(a).forEach(([i,s])=>{const o=(s.total/s.count).toFixed(2),l=vg(s.total/s.count);n.push([i,o,l.toUpperCase()])}),$n.aoa_to_sheet(n)}function Pp(e){const t=["ID","Date","School","Type","Room Number","Building Name","Location","Inspector","Average Rating","Severity","Floors","Vertical/Horizontal Surfaces","Ceiling","Restrooms","Customer Satisfaction","Trash","Project Cleaning","Activity Support","Safety & Compliance","Equipment","Monitoring","Notes"],r=e.map(i=>{const s=Qi(i),o=s?vg(s):"N/A";return[i.id,new Date(i.date).toLocaleDateString(),i.school,i.inspectionType==="single_room"?"Single Room":"Whole Building",i.roomNumber||"",i.buildingName||"",i.locationDescription||"",i.inspectorName||"",(s==null?void 0:s.toFixed(2))||"N/A",o.toUpperCase(),i.floors||"",i.verticalHorizontalSurfaces||"",i.ceiling||"",i.restrooms||"",i.customerSatisfaction||"",i.trash||"",i.projectCleaning||"",i.activitySupport||"",i.safetyCompliance||"",i.equipment||"",i.monitoring||"",i.notes||""]}),n=$n.aoa_to_sheet([t,...r]),a=[{wch:8},{wch:12},{wch:20},{wch:15},{wch:12},{wch:20},{wch:25},{wch:15},{wch:12},{wch:12},{wch:8},{wch:25},{wch:10},{wch:12},{wch:20},{wch:8},{wch:15},{wch:15},{wch:18},{wch:12},{wch:12},{wch:30}];return n["!cols"]=a,n}function OA(e){const t=bg(e),r=["Severity","School","Location","Date","Rating","Inspector","Type","Floors","Vertical/Horizontal","Ceiling","Restrooms","Customer Satisfaction","Trash","Project Cleaning","Activity Support","Safety & Compliance","Equipment","Monitoring","Notes"],a=[...t.critical,...t.needsAttention].map(o=>{const l=o.inspection;return[o.severity.toUpperCase(),o.school,o.location,new Date(o.date).toLocaleDateString(),o.rating.toFixed(2),l.inspectorName||"",l.inspectionType==="single_room"?"Single Room":"Whole Building",l.floors||"",l.verticalHorizontalSurfaces||"",l.ceiling||"",l.restrooms||"",l.customerSatisfaction||"",l.trash||"",l.projectCleaning||"",l.activitySupport||"",l.safetyCompliance||"",l.equipment||"",l.monitoring||"",l.notes||""]}),i=$n.aoa_to_sheet([r,...a]),s=[{wch:12},{wch:20},{wch:25},{wch:12},{wch:8},{wch:15},{wch:15},{wch:8},{wch:25},{wch:10},{wch:12},{wch:20},{wch:8},{wch:15},{wch:15},{wch:18},{wch:12},{wch:12},{wch:30}];return i["!cols"]=s,i}function VA(e){const t=Ng(e),r=["Priority","School","Location","Date","Notes","Keywords","Inspector"],n=t.map(s=>{const o=s.note;return[s.severity.toUpperCase(),o.school,o.location,new Date(o.date).toLocaleDateString(),o.notes,s.keywords.join(", "),""]}),a=$n.aoa_to_sheet([r,...n]),i=[{wch:12},{wch:20},{wch:25},{wch:12},{wch:50},{wch:30},{wch:15}];return a["!cols"]=i,a}function kz(e,t="inspections"){let r;switch(t){case"inspections":r=Pp(e.inspections);break;case"problems":r=OA(e.inspections);break;case"notes":r=VA(e.custodialNotes);break;default:r=Pp(e.inspections)}const n=$n.sheet_to_csv(r),a=new Blob([n],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),s=URL.createObjectURL(a);i.setAttribute("href",s),i.setAttribute("download",`Custodial_Command_${t}_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}function dl(e){"@babel/helpers - typeof";return dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dl(e)}var Vn=Uint8Array,Jr=Uint16Array,qg=Int32Array,zg=new Vn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Hg=new Vn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),k2=new Vn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),PA=function(e,t){for(var r=new Jr(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new qg(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},IA=PA(zg,2),Fz=IA.b,Ip=IA.r;Fz[28]=258,Ip[258]=28;var Uz=PA(Hg,0),F2=Uz.r,Mp=new Jr(32768);for(var Dt=0;Dt<32768;++Dt){var Ra=(Dt&43690)>>1|(Dt&21845)<<1;Ra=(Ra&52428)>>2|(Ra&13107)<<2,Ra=(Ra&61680)>>4|(Ra&3855)<<4,Mp[Dt]=((Ra&65280)>>8|(Ra&255)<<8)>>1}var jo=(function(e,t,r){for(var n=e.length,a=0,i=new Jr(t);a<n;++a)e[a]&&++i[e[a]-1];var s=new Jr(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(r){o=new Jr(1<<t);var l=15-t;for(a=0;a<n;++a)if(e[a])for(var u=a<<4|e[a],c=t-e[a],m=s[e[a]-1]++<<c,h=m|(1<<c)-1;m<=h;++m)o[Mp[m]>>l]=u}else for(o=new Jr(n),a=0;a<n;++a)e[a]&&(o[a]=Mp[s[e[a]-1]++]>>15-e[a]);return o}),Hi=new Vn(288);for(var Dt=0;Dt<144;++Dt)Hi[Dt]=8;for(var Dt=144;Dt<256;++Dt)Hi[Dt]=9;for(var Dt=256;Dt<280;++Dt)Hi[Dt]=7;for(var Dt=280;Dt<288;++Dt)Hi[Dt]=8;var hc=new Vn(32);for(var Dt=0;Dt<32;++Dt)hc[Dt]=5;var Rz=jo(Hi,9,0),Oz=jo(hc,5,0),MA=function(e){return(e+7)/8|0},Vz=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Vn(e.subarray(t,r))},ia=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},go=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},_0=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:LA,l:0};if(a==1){var s=new Vn(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(F,E){return F.f-E.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],u=0,c=1,m=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};c!=a-1;)o=r[r[u].f<r[m].f?u++:m++],l=r[u!=c&&r[u].f<r[m].f?u++:m++],r[c++]={s:-1,f:o.f+l.f,l:o,r:l};for(var h=i[0].s,n=1;n<a;++n)i[n].s>h&&(h=i[n].s);var f=new Jr(h+1),x=jp(r[c-1],f,0);if(x>t){var n=0,p=0,g=x-t,v=1<<g;for(i.sort(function(E,w){return f[w.s]-f[E.s]||E.f-w.f});n<a;++n){var C=i[n].s;if(f[C]>t)p+=v-(1<<x-f[C]),f[C]=t;else break}for(p>>=g;p>0;){var b=i[n].s;f[b]<t?p-=1<<t-f[b]++-1:++n}for(;n>=0&&p;--n){var N=i[n].s;f[N]==t&&(--f[N],++p)}x=t}return{t:new Vn(f),l:x}},jp=function(e,t,r){return e.s==-1?Math.max(jp(e.l,t,r+1),jp(e.r,t,r+1)):t[e.s]=r},U2=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Jr(++t),n=0,a=e[0],i=1,s=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==a&&o!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[o]}return{c:r.subarray(0,n),n:t}},vo=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},jA=function(e,t,r){var n=r.length,a=MA(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},R2=function(e,t,r,n,a,i,s,o,l,u,c){ia(t,c++,r),++a[256];for(var m=_0(a,15),h=m.t,f=m.l,x=_0(i,15),p=x.t,g=x.l,v=U2(h),C=v.c,b=v.n,N=U2(p),F=N.c,E=N.n,w=new Jr(19),S=0;S<C.length;++S)++w[C[S]&31];for(var S=0;S<F.length;++S)++w[F[S]&31];for(var _=_0(w,7),U=_.t,R=_.l,q=19;q>4&&!U[k2[q-1]];--q);var M=u+5<<3,Y=vo(a,Hi)+vo(i,hc)+s,K=vo(a,h)+vo(i,p)+s+14+3*q+vo(w,U)+2*w[16]+3*w[17]+7*w[18];if(l>=0&&M<=Y&&M<=K)return jA(t,c,e.subarray(l,l+u));var de,pe,Ae,Ne;if(ia(t,c,1+(K<Y)),c+=2,K<Y){de=jo(h,f,0),pe=h,Ae=jo(p,g,0),Ne=p;var k=jo(U,R,0);ia(t,c,b-257),ia(t,c+5,E-1),ia(t,c+10,q-4),c+=14;for(var S=0;S<q;++S)ia(t,c+3*S,U[k2[S]]);c+=3*q;for(var le=[C,F],j=0;j<2;++j)for(var y=le[j],S=0;S<y.length;++S){var V=y[S]&31;ia(t,c,k[V]),c+=U[V],V>15&&(ia(t,c,y[S]>>5&127),c+=y[S]>>12)}}else de=Rz,pe=Hi,Ae=Oz,Ne=hc;for(var S=0;S<o;++S){var I=n[S];if(I>255){var V=I>>18&31;go(t,c,de[V+257]),c+=pe[V+257],V>7&&(ia(t,c,I>>23&31),c+=zg[V]);var G=I&31;go(t,c,Ae[G]),c+=Ne[G],G>3&&(go(t,c,I>>5&8191),c+=Hg[G])}else go(t,c,de[I]),c+=pe[I]}return go(t,c,de[256]),c+pe[256]},Pz=new qg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),LA=new Vn(0),Iz=function(e,t,r,n,a,i){var s=i.z||e.length,o=new Vn(n+s+5*(1+Math.ceil(s/7e3))+a),l=o.subarray(n,o.length-a),u=i.l,c=(i.r||0)&7;if(t){c&&(l[0]=i.r>>3);for(var m=Pz[t-1],h=m>>13,f=m&8191,x=(1<<r)-1,p=i.p||new Jr(32768),g=i.h||new Jr(x+1),v=Math.ceil(r/3),C=2*v,b=function(ke){return(e[ke]^e[ke+1]<<v^e[ke+2]<<C)&x},N=new qg(25e3),F=new Jr(288),E=new Jr(32),w=0,S=0,_=i.i||0,U=0,R=i.w||0,q=0;_+2<s;++_){var M=b(_),Y=_&32767,K=g[M];if(p[Y]=K,g[M]=Y,R<=_){var de=s-_;if((w>7e3||U>24576)&&(de>423||!u)){c=R2(e,l,0,N,F,E,S,U,q,_-q,c),U=w=S=0,q=_;for(var pe=0;pe<286;++pe)F[pe]=0;for(var pe=0;pe<30;++pe)E[pe]=0}var Ae=2,Ne=0,k=f,le=Y-K&32767;if(de>2&&M==b(_-le))for(var j=Math.min(h,de)-1,y=Math.min(32767,_),V=Math.min(258,de);le<=y&&--k&&Y!=K;){if(e[_+Ae]==e[_+Ae-le]){for(var I=0;I<V&&e[_+I]==e[_+I-le];++I);if(I>Ae){if(Ae=I,Ne=le,I>j)break;for(var G=Math.min(le,I-2),ie=0,pe=0;pe<G;++pe){var ae=_-le+pe&32767,Q=p[ae],Z=ae-Q&32767;Z>ie&&(ie=Z,K=ae)}}}Y=K,K=p[Y],le+=Y-K&32767}if(Ne){N[U++]=268435456|Ip[Ae]<<18|F2[Ne];var ve=Ip[Ae]&31,J=F2[Ne]&31;S+=zg[ve]+Hg[J],++F[257+ve],++E[J],R=_+Ae,++w}else N[U++]=e[_],++F[e[_]]}}for(_=Math.max(_,R);_<s;++_)N[U++]=e[_],++F[e[_]];c=R2(e,l,u,N,F,E,S,U,q,_-q,c),u||(i.r=c&7|l[c/8|0]<<3,c-=7,i.h=g,i.p=p,i.i=_,i.w=R)}else{for(var _=i.w||0;_<s+u;_+=65535){var je=_+65535;je>=s&&(l[c/8|0]=u,je=s),c=jA(l,c+1,e.subarray(_,je))}i.i=s}return Vz(o,0,n+MA(c)+a)},BA=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=r[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},Mz=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new Vn(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return Iz(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},qA=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},jz=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=BA();a.p(t.dictionary),qA(e,2,a.d())}};function XJ(e,t){t||(t={});var r=BA();r.p(e);var n=Mz(e,t,t.dictionary?6:2,4);return jz(n,t),qA(n,n.length-4,r.d()),n}var Lz=typeof TextDecoder!="undefined"&&new TextDecoder,Bz=0;try{Lz.decode(LA,{stream:!0}),Bz=1}catch(e){}function qz(e){if(Array.isArray(e))return e}function zz(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function O2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Hz(e,t){if(e){if(typeof e=="string")return O2(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O2(e,t):void 0}}function $z(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KJ(e,t){return qz(e)||zz(e,t)||Hz(e,t)||$z()}function V2(e,t="utf8"){return new TextDecoder(t).decode(e)}const Wz=new TextEncoder;function Gz(e){return Wz.encode(e)}const Yz=1024*8,Xz=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),S0={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class $g{constructor(t=Yz,r={}){et(this,"buffer");et(this,"byteLength");et(this,"byteOffset");et(this,"length");et(this,"offset");et(this,"lastWrittenByte");et(this,"littleEndian");et(this,"_data");et(this,"_mark");et(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const a=r.offset?r.offset>>>0:0,i=t.byteLength-a;let s=a;(ArrayBuffer.isView(t)||t instanceof $g)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+a),t=t.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=S0[r].BYTES_PER_ELEMENT*t,a=this.byteOffset+this.offset,i=this.buffer.slice(a,a+n);if(this.littleEndian===Xz&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(a,a+n));o.reverse();const l=new S0[r](o.buffer);return this.offset+=n,l.reverse(),l}const s=new S0[r](i);return this.offset+=n,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return V2(this.readBytes(t))}decodeText(t=1,r="utf8"){return V2(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(Gz(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function to(e){let t=e.length;for(;--t>=0;)e[t]=0}const Kz=3,Qz=258,zA=29,Zz=256,Jz=Zz+1+zA,HA=30,eH=512,tH=new Array((Jz+2)*2);to(tH);const rH=new Array(HA*2);to(rH);const nH=new Array(eH);to(nH);const aH=new Array(Qz-Kz+1);to(aH);const iH=new Array(zA);to(iH);const sH=new Array(HA);to(sH);const oH=(e,t,r,n)=>{let a=e&65535|0,i=e>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do a=a+t[n++]|0,i=i+a|0;while(--s);a%=65521,i%=65521}return a|i<<16|0};var Lp=oH;const lH=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},uH=new Uint32Array(lH()),cH=(e,t,r,n)=>{const a=uH,i=n+r;e^=-1;for(let s=n;s<i;s++)e=e>>>8^a[(e^t[s])&255];return e^-1};var In=cH,Bp={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},$A={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const mH=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var dH=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)mH(r,n)&&(e[n]=r[n])}}return e},fH=e=>{let t=0;for(let n=0,a=e.length;n<a;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,a=0,i=e.length;n<i;n++){let s=e[n];r.set(s,a),a+=s.length}return r},WA={assign:dH,flattenChunks:fH};let GA=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){GA=!1}const fl=new Uint8Array(256);for(let e=0;e<256;e++)fl[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;fl[254]=fl[254]=1;var hH=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,a,i,s=e.length,o=0;for(a=0;a<s;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),i=0,a=0;i<o;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const pH=(e,t)=>{if(t<65534&&e.subarray&&GA)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var xH=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,a;const i=new Array(r*2);for(a=0,n=0;n<r;){let s=e[n++];if(s<128){i[a++]=s;continue}let o=fl[s];if(o>4){i[a++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<r;)s=s<<6|e[n++]&63,o--;if(o>1){i[a++]=65533;continue}s<65536?i[a++]=s:(s-=65536,i[a++]=55296|s>>10&1023,i[a++]=56320|s&1023)}return pH(i,a)},gH=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+fl[e[r]]>t?r:t},qp={string2buf:hH,buf2string:xH,utf8border:gH};function vH(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var bH=vH;const pu=16209,NH=16191;var yH=function(t,r){let n,a,i,s,o,l,u,c,m,h,f,x,p,g,v,C,b,N,F,E,w,S,_,U;const R=t.state;n=t.next_in,_=t.input,a=n+(t.avail_in-5),i=t.next_out,U=t.output,s=i-(r-t.avail_out),o=i+(t.avail_out-257),l=R.dmax,u=R.wsize,c=R.whave,m=R.wnext,h=R.window,f=R.hold,x=R.bits,p=R.lencode,g=R.distcode,v=(1<<R.lenbits)-1,C=(1<<R.distbits)-1;e:do{x<15&&(f+=_[n++]<<x,x+=8,f+=_[n++]<<x,x+=8),b=p[f&v];t:for(;;){if(N=b>>>24,f>>>=N,x-=N,N=b>>>16&255,N===0)U[i++]=b&65535;else if(N&16){F=b&65535,N&=15,N&&(x<N&&(f+=_[n++]<<x,x+=8),F+=f&(1<<N)-1,f>>>=N,x-=N),x<15&&(f+=_[n++]<<x,x+=8,f+=_[n++]<<x,x+=8),b=g[f&C];r:for(;;){if(N=b>>>24,f>>>=N,x-=N,N=b>>>16&255,N&16){if(E=b&65535,N&=15,x<N&&(f+=_[n++]<<x,x+=8,x<N&&(f+=_[n++]<<x,x+=8)),E+=f&(1<<N)-1,E>l){t.msg="invalid distance too far back",R.mode=pu;break e}if(f>>>=N,x-=N,N=i-s,E>N){if(N=E-N,N>c&&R.sane){t.msg="invalid distance too far back",R.mode=pu;break e}if(w=0,S=h,m===0){if(w+=u-N,N<F){F-=N;do U[i++]=h[w++];while(--N);w=i-E,S=U}}else if(m<N){if(w+=u+m-N,N-=m,N<F){F-=N;do U[i++]=h[w++];while(--N);if(w=0,m<F){N=m,F-=N;do U[i++]=h[w++];while(--N);w=i-E,S=U}}}else if(w+=m-N,N<F){F-=N;do U[i++]=h[w++];while(--N);w=i-E,S=U}for(;F>2;)U[i++]=S[w++],U[i++]=S[w++],U[i++]=S[w++],F-=3;F&&(U[i++]=S[w++],F>1&&(U[i++]=S[w++]))}else{w=i-E;do U[i++]=U[w++],U[i++]=U[w++],U[i++]=U[w++],F-=3;while(F>2);F&&(U[i++]=U[w++],F>1&&(U[i++]=U[w++]))}}else if((N&64)===0){b=g[(b&65535)+(f&(1<<N)-1)];continue r}else{t.msg="invalid distance code",R.mode=pu;break e}break}}else if((N&64)===0){b=p[(b&65535)+(f&(1<<N)-1)];continue t}else if(N&32){R.mode=NH;break e}else{t.msg="invalid literal/length code",R.mode=pu;break e}break}}while(n<a&&i<o);F=x>>3,n-=F,x-=F<<3,f&=(1<<x)-1,t.next_in=n,t.next_out=i,t.avail_in=n<a?5+(a-n):5-(n-a),t.avail_out=i<o?257+(o-i):257-(i-o),R.hold=f,R.bits=x};const cs=15,P2=852,I2=592,M2=0,T0=1,j2=2,CH=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),wH=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),EH=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),_H=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),SH=(e,t,r,n,a,i,s,o)=>{const l=o.bits;let u=0,c=0,m=0,h=0,f=0,x=0,p=0,g=0,v=0,C=0,b,N,F,E,w,S=null,_;const U=new Uint16Array(cs+1),R=new Uint16Array(cs+1);let q=null,M,Y,K;for(u=0;u<=cs;u++)U[u]=0;for(c=0;c<n;c++)U[t[r+c]]++;for(f=l,h=cs;h>=1&&U[h]===0;h--);if(f>h&&(f=h),h===0)return a[i++]=1<<24|64<<16|0,a[i++]=1<<24|64<<16|0,o.bits=1,0;for(m=1;m<h&&U[m]===0;m++);for(f<m&&(f=m),g=1,u=1;u<=cs;u++)if(g<<=1,g-=U[u],g<0)return-1;if(g>0&&(e===M2||h!==1))return-1;for(R[1]=0,u=1;u<cs;u++)R[u+1]=R[u]+U[u];for(c=0;c<n;c++)t[r+c]!==0&&(s[R[t[r+c]]++]=c);if(e===M2?(S=q=s,_=20):e===T0?(S=CH,q=wH,_=257):(S=EH,q=_H,_=0),C=0,c=0,u=m,w=i,x=f,p=0,F=-1,v=1<<f,E=v-1,e===T0&&v>P2||e===j2&&v>I2)return 1;for(;;){M=u-p,s[c]+1<_?(Y=0,K=s[c]):s[c]>=_?(Y=q[s[c]-_],K=S[s[c]-_]):(Y=96,K=0),b=1<<u-p,N=1<<x,m=N;do N-=b,a[w+(C>>p)+N]=M<<24|Y<<16|K|0;while(N!==0);for(b=1<<u-1;C&b;)b>>=1;if(b!==0?(C&=b-1,C+=b):C=0,c++,--U[u]===0){if(u===h)break;u=t[r+s[c]]}if(u>f&&(C&E)!==F){for(p===0&&(p=f),w+=m,x=u-p,g=1<<x;x+p<h&&(g-=U[x+p],!(g<=0));)x++,g<<=1;if(v+=1<<x,e===T0&&v>P2||e===j2&&v>I2)return 1;F=C&E,a[F]=f<<24|x<<16|w-i|0}}return C!==0&&(a[w+C]=u-p<<24|64<<16|0),o.bits=f,0};var Lo=SH;const TH=0,YA=1,XA=2,{Z_FINISH:L2,Z_BLOCK:DH,Z_TREES:xu,Z_OK:$i,Z_STREAM_END:AH,Z_NEED_DICT:kH,Z_STREAM_ERROR:pn,Z_DATA_ERROR:KA,Z_MEM_ERROR:QA,Z_BUF_ERROR:FH,Z_DEFLATED:B2}=$A,Jc=16180,q2=16181,z2=16182,H2=16183,$2=16184,W2=16185,G2=16186,Y2=16187,X2=16188,K2=16189,pc=16190,sa=16191,D0=16192,Q2=16193,A0=16194,Z2=16195,J2=16196,ew=16197,tw=16198,gu=16199,vu=16200,rw=16201,nw=16202,aw=16203,iw=16204,sw=16205,k0=16206,ow=16207,lw=16208,Ft=16209,ZA=16210,JA=16211,UH=852,RH=592,OH=15,VH=OH,uw=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function PH(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ns=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Jc||t.mode>JA?1:0},e3=e=>{if(ns(e))return pn;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Jc,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(UH),t.distcode=t.distdyn=new Int32Array(RH),t.sane=1,t.back=-1,$i},t3=e=>{if(ns(e))return pn;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,e3(e)},r3=(e,t)=>{let r;if(ns(e))return pn;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?pn:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,t3(e))},n3=(e,t)=>{if(!e)return pn;const r=new PH;e.state=r,r.strm=e,r.window=null,r.mode=Jc;const n=r3(e,t);return n!==$i&&(e.state=null),n},IH=e=>n3(e,VH);let cw=!0,F0,U0;const MH=e=>{if(cw){F0=new Int32Array(512),U0=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Lo(YA,e.lens,0,288,F0,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Lo(XA,e.lens,0,32,U0,0,e.work,{bits:5}),cw=!1}e.lencode=F0,e.lenbits=9,e.distcode=U0,e.distbits=5},a3=(e,t,r,n)=>{let a;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(a=i.wsize-i.wnext,a>n&&(a=n),i.window.set(t.subarray(r-n,r-n+a),i.wnext),n-=a,n?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},jH=(e,t)=>{let r,n,a,i,s,o,l,u,c,m,h,f,x,p,g=0,v,C,b,N,F,E,w,S;const _=new Uint8Array(4);let U,R;const q=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ns(e)||!e.output||!e.input&&e.avail_in!==0)return pn;r=e.state,r.mode===sa&&(r.mode=D0),s=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,o=e.avail_in,u=r.hold,c=r.bits,m=o,h=l,S=$i;e:for(;;)switch(r.mode){case Jc:if(r.wrap===0){r.mode=D0;break}for(;c<16;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,_[0]=u&255,_[1]=u>>>8&255,r.check=In(r.check,_,2,0),u=0,c=0,r.mode=q2;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=Ft;break}if((u&15)!==B2){e.msg="unknown compression method",r.mode=Ft;break}if(u>>>=4,c-=4,w=(u&15)+8,r.wbits===0&&(r.wbits=w),w>15||w>r.wbits){e.msg="invalid window size",r.mode=Ft;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?K2:sa,u=0,c=0;break;case q2:for(;c<16;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}if(r.flags=u,(r.flags&255)!==B2){e.msg="unknown compression method",r.mode=Ft;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Ft;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(_[0]=u&255,_[1]=u>>>8&255,r.check=In(r.check,_,2,0)),u=0,c=0,r.mode=z2;case z2:for(;c<32;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(_[0]=u&255,_[1]=u>>>8&255,_[2]=u>>>16&255,_[3]=u>>>24&255,r.check=In(r.check,_,4,0)),u=0,c=0,r.mode=H2;case H2:for(;c<16;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(_[0]=u&255,_[1]=u>>>8&255,r.check=In(r.check,_,2,0)),u=0,c=0,r.mode=$2;case $2:if(r.flags&1024){for(;c<16;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(_[0]=u&255,_[1]=u>>>8&255,r.check=In(r.check,_,2,0)),u=0,c=0}else r.head&&(r.head.extra=null);r.mode=W2;case W2:if(r.flags&1024&&(f=r.length,f>o&&(f=o),f&&(r.head&&(w=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+f),w)),r.flags&512&&r.wrap&4&&(r.check=In(r.check,n,f,i)),o-=f,i+=f,r.length-=f),r.length))break e;r.length=0,r.mode=G2;case G2:if(r.flags&2048){if(o===0)break e;f=0;do w=n[i+f++],r.head&&w&&r.length<65536&&(r.head.name+=String.fromCharCode(w));while(w&&f<o);if(r.flags&512&&r.wrap&4&&(r.check=In(r.check,n,f,i)),o-=f,i+=f,w)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Y2;case Y2:if(r.flags&4096){if(o===0)break e;f=0;do w=n[i+f++],r.head&&w&&r.length<65536&&(r.head.comment+=String.fromCharCode(w));while(w&&f<o);if(r.flags&512&&r.wrap&4&&(r.check=In(r.check,n,f,i)),o-=f,i+=f,w)break e}else r.head&&(r.head.comment=null);r.mode=X2;case X2:if(r.flags&512){for(;c<16;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Ft;break}u=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=sa;break;case K2:for(;c<32;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}e.adler=r.check=uw(u),u=0,c=0,r.mode=pc;case pc:if(r.havedict===0)return e.next_out=s,e.avail_out=l,e.next_in=i,e.avail_in=o,r.hold=u,r.bits=c,kH;e.adler=r.check=1,r.mode=sa;case sa:if(t===DH||t===xu)break e;case D0:if(r.last){u>>>=c&7,c-=c&7,r.mode=k0;break}for(;c<3;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}switch(r.last=u&1,u>>>=1,c-=1,u&3){case 0:r.mode=Q2;break;case 1:if(MH(r),r.mode=gu,t===xu){u>>>=2,c-=2;break e}break;case 2:r.mode=J2;break;case 3:e.msg="invalid block type",r.mode=Ft}u>>>=2,c-=2;break;case Q2:for(u>>>=c&7,c-=c&7;c<32;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Ft;break}if(r.length=u&65535,u=0,c=0,r.mode=A0,t===xu)break e;case A0:r.mode=Z2;case Z2:if(f=r.length,f){if(f>o&&(f=o),f>l&&(f=l),f===0)break e;a.set(n.subarray(i,i+f),s),o-=f,i+=f,l-=f,s+=f,r.length-=f;break}r.mode=sa;break;case J2:for(;c<14;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}if(r.nlen=(u&31)+257,u>>>=5,c-=5,r.ndist=(u&31)+1,u>>>=5,c-=5,r.ncode=(u&15)+4,u>>>=4,c-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Ft;break}r.have=0,r.mode=ew;case ew:for(;r.have<r.ncode;){for(;c<3;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}r.lens[q[r.have++]]=u&7,u>>>=3,c-=3}for(;r.have<19;)r.lens[q[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,U={bits:r.lenbits},S=Lo(TH,r.lens,0,19,r.lencode,0,r.work,U),r.lenbits=U.bits,S){e.msg="invalid code lengths set",r.mode=Ft;break}r.have=0,r.mode=tw;case tw:for(;r.have<r.nlen+r.ndist;){for(;g=r.lencode[u&(1<<r.lenbits)-1],v=g>>>24,C=g>>>16&255,b=g&65535,!(v<=c);){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}if(b<16)u>>>=v,c-=v,r.lens[r.have++]=b;else{if(b===16){for(R=v+2;c<R;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}if(u>>>=v,c-=v,r.have===0){e.msg="invalid bit length repeat",r.mode=Ft;break}w=r.lens[r.have-1],f=3+(u&3),u>>>=2,c-=2}else if(b===17){for(R=v+3;c<R;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}u>>>=v,c-=v,w=0,f=3+(u&7),u>>>=3,c-=3}else{for(R=v+7;c<R;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}u>>>=v,c-=v,w=0,f=11+(u&127),u>>>=7,c-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Ft;break}for(;f--;)r.lens[r.have++]=w}}if(r.mode===Ft)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Ft;break}if(r.lenbits=9,U={bits:r.lenbits},S=Lo(YA,r.lens,0,r.nlen,r.lencode,0,r.work,U),r.lenbits=U.bits,S){e.msg="invalid literal/lengths set",r.mode=Ft;break}if(r.distbits=6,r.distcode=r.distdyn,U={bits:r.distbits},S=Lo(XA,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,U),r.distbits=U.bits,S){e.msg="invalid distances set",r.mode=Ft;break}if(r.mode=gu,t===xu)break e;case gu:r.mode=vu;case vu:if(o>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=i,e.avail_in=o,r.hold=u,r.bits=c,yH(e,h),s=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,o=e.avail_in,u=r.hold,c=r.bits,r.mode===sa&&(r.back=-1);break}for(r.back=0;g=r.lencode[u&(1<<r.lenbits)-1],v=g>>>24,C=g>>>16&255,b=g&65535,!(v<=c);){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}if(C&&(C&240)===0){for(N=v,F=C,E=b;g=r.lencode[E+((u&(1<<N+F)-1)>>N)],v=g>>>24,C=g>>>16&255,b=g&65535,!(N+v<=c);){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}u>>>=N,c-=N,r.back+=N}if(u>>>=v,c-=v,r.back+=v,r.length=b,C===0){r.mode=sw;break}if(C&32){r.back=-1,r.mode=sa;break}if(C&64){e.msg="invalid literal/length code",r.mode=Ft;break}r.extra=C&15,r.mode=rw;case rw:if(r.extra){for(R=r.extra;c<R;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=nw;case nw:for(;g=r.distcode[u&(1<<r.distbits)-1],v=g>>>24,C=g>>>16&255,b=g&65535,!(v<=c);){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}if((C&240)===0){for(N=v,F=C,E=b;g=r.distcode[E+((u&(1<<N+F)-1)>>N)],v=g>>>24,C=g>>>16&255,b=g&65535,!(N+v<=c);){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}u>>>=N,c-=N,r.back+=N}if(u>>>=v,c-=v,r.back+=v,C&64){e.msg="invalid distance code",r.mode=Ft;break}r.offset=b,r.extra=C&15,r.mode=aw;case aw:if(r.extra){for(R=r.extra;c<R;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Ft;break}r.mode=iw;case iw:if(l===0)break e;if(f=h-l,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Ft;break}f>r.wnext?(f-=r.wnext,x=r.wsize-f):x=r.wnext-f,f>r.length&&(f=r.length),p=r.window}else p=a,x=s-r.offset,f=r.length;f>l&&(f=l),l-=f,r.length-=f;do a[s++]=p[x++];while(--f);r.length===0&&(r.mode=vu);break;case sw:if(l===0)break e;a[s++]=r.length,l--,r.mode=vu;break;case k0:if(r.wrap){for(;c<32;){if(o===0)break e;o--,u|=n[i++]<<c,c+=8}if(h-=l,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?In(r.check,a,h,s-h):Lp(r.check,a,h,s-h)),h=l,r.wrap&4&&(r.flags?u:uw(u))!==r.check){e.msg="incorrect data check",r.mode=Ft;break}u=0,c=0}r.mode=ow;case ow:if(r.wrap&&r.flags){for(;c<32;){if(o===0)break e;o--,u+=n[i++]<<c,c+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Ft;break}u=0,c=0}r.mode=lw;case lw:S=AH;break e;case Ft:S=KA;break e;case ZA:return QA;case JA:default:return pn}return e.next_out=s,e.avail_out=l,e.next_in=i,e.avail_in=o,r.hold=u,r.bits=c,(r.wsize||h!==e.avail_out&&r.mode<Ft&&(r.mode<k0||t!==L2))&&a3(e,e.output,e.next_out,h-e.avail_out),m-=e.avail_in,h-=e.avail_out,e.total_in+=m,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?In(r.check,a,h,e.next_out-h):Lp(r.check,a,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===sa?128:0)+(r.mode===gu||r.mode===A0?256:0),(m===0&&h===0||t===L2)&&S===$i&&(S=FH),S},LH=e=>{if(ns(e))return pn;let t=e.state;return t.window&&(t.window=null),e.state=null,$i},BH=(e,t)=>{if(ns(e))return pn;const r=e.state;return(r.wrap&2)===0?pn:(r.head=t,t.done=!1,$i)},qH=(e,t)=>{const r=t.length;let n,a,i;return ns(e)||(n=e.state,n.wrap!==0&&n.mode!==pc)?pn:n.mode===pc&&(a=1,a=Lp(a,t,r,0),a!==n.check)?KA:(i=a3(e,t,r,r),i?(n.mode=ZA,QA):(n.havedict=1,$i))};var zH=t3,HH=r3,$H=e3,WH=IH,GH=n3,YH=jH,XH=LH,KH=BH,QH=qH,ZH="pako inflate (from Nodeca project)",ca={inflateReset:zH,inflateReset2:HH,inflateResetKeep:$H,inflateInit:WH,inflateInit2:GH,inflate:YH,inflateEnd:XH,inflateGetHeader:KH,inflateSetDictionary:QH,inflateInfo:ZH};function JH(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var e$=JH;const i3=Object.prototype.toString,{Z_NO_FLUSH:t$,Z_FINISH:r$,Z_OK:hl,Z_STREAM_END:R0,Z_NEED_DICT:O0,Z_STREAM_ERROR:n$,Z_DATA_ERROR:mw,Z_MEM_ERROR:a$}=$A;function Pl(e){this.options=WA.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new bH,this.strm.avail_out=0;let r=ca.inflateInit2(this.strm,t.windowBits);if(r!==hl)throw new Error(Bp[r]);if(this.header=new e$,ca.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=qp.string2buf(t.dictionary):i3.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=ca.inflateSetDictionary(this.strm,t.dictionary),r!==hl)))throw new Error(Bp[r])}Pl.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let i,s,o;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?r$:t$,i3.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=ca.inflate(r,s),i===O0&&a&&(i=ca.inflateSetDictionary(r,a),i===hl?i=ca.inflate(r,s):i===mw&&(i=O0));r.avail_in>0&&i===R0&&r.state.wrap>0&&e[r.next_in]!==0;)ca.inflateReset(r),i=ca.inflate(r,s);switch(i){case n$:case mw:case O0:case a$:return this.onEnd(i),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||i===R0))if(this.options.to==="string"){let l=qp.utf8border(r.output,r.next_out),u=r.next_out-l,c=qp.buf2string(r.output,l);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(l,l+u),0),this.onData(c)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===hl&&o===0)){if(i===R0)return i=ca.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Pl.prototype.onData=function(e){this.chunks.push(e)};Pl.prototype.onEnd=function(e){e===hl&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=WA.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function i$(e,t){const r=new Pl(t);if(r.push(e),r.err)throw r.msg||Bp[r.err];return r.result}var s$=Pl,o$=i$,l$={Inflate:s$,inflate:o$};const{Inflate:u$,inflate:c$}=l$;var dw=u$,m$=c$;const s3=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;s3[e]=t}const fw=4294967295;function d$(e,t,r){let n=e;for(let a=0;a<r;a++)n=s3[(n^t[a])&255]^n>>>8;return n}function f$(e,t){return(d$(fw,e,t)^fw)>>>0}function hw(e,t,r){const n=e.readUint32(),a=f$(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function o3(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function l3(e,t,r,n){let a=0;for(;a<n;a++)t[a]=e[a];for(;a<r;a++)t[a]=e[a]+t[a-n]&255}function u3(e,t,r,n){let a=0;if(r.length===0)for(;a<n;a++)t[a]=e[a];else for(;a<n;a++)t[a]=e[a]+r[a]&255}function c3(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+(t[i-a]>>1)&255}else{for(;i<a;i++)t[i]=e[i]+(r[i]>>1)&255;for(;i<n;i++)t[i]=e[i]+(t[i-a]+r[i]>>1)&255}}function m3(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+t[i-a]&255}else{for(;i<a;i++)t[i]=e[i]+r[i]&255;for(;i<n;i++)t[i]=e[i]+h$(t[i-a],r[i],r[i-a])&255}}function h$(e,t,r){const n=e+t-r,a=Math.abs(n-e),i=Math.abs(n-t),s=Math.abs(n-r);return a<=i&&a<=s?e:i<=s?t:r}function p$(e,t,r,n,a,i){switch(e){case 0:o3(t,r,a);break;case 1:l3(t,r,a,i);break;case 2:u3(t,r,n,a);break;case 3:c3(t,r,n,a,i);break;case 4:m3(t,r,n,a,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const x$=new Uint16Array([255]),g$=new Uint8Array(x$.buffer),v$=g$[0]===255;function b$(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(i/8)*a,l=new Uint8Array(n*r*o);let u=0;for(let c=0;c<7;c++){const m=s[c],h=Math.ceil((r-m.x)/m.xStep),f=Math.ceil((n-m.y)/m.yStep);if(h<=0||f<=0)continue;const x=h*o,p=new Uint8Array(x);for(let g=0;g<f;g++){const v=t[u++],C=t.subarray(u,u+x);u+=x;const b=new Uint8Array(x);p$(v,C,b,p,x,o),p.set(b);for(let N=0;N<h;N++){const F=m.x+N*m.xStep,E=m.y+g*m.yStep;if(!(F>=r||E>=n))for(let w=0;w<o;w++)l[(E*r+F)*o+w]=b[N*o+w]}}}if(i===16){const c=new Uint16Array(l.buffer);if(v$)for(let m=0;m<c.length;m++)c[m]=N$(c[m]);return c}else return l}function N$(e){return(e&255)<<8|e>>8&255}const y$=new Uint16Array([255]),C$=new Uint8Array(y$.buffer),w$=C$[0]===255,E$=new Uint8Array(0);function pw(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=Math.ceil(i/8)*a,o=Math.ceil(i/8*a*r),l=new Uint8Array(n*o);let u=E$,c=0,m,h;for(let f=0;f<n;f++){switch(m=t.subarray(c+1,c+1+o),h=l.subarray(f*o,(f+1)*o),t[c]){case 0:o3(m,h,o);break;case 1:l3(m,h,o,s);break;case 2:u3(m,h,u,o);break;case 3:c3(m,h,u,o,s);break;case 4:m3(m,h,u,o,s);break;default:throw new Error(`Unsupported filter: ${t[c]}`)}u=h,c+=o+1}if(i===16){const f=new Uint16Array(l.buffer);if(w$)for(let x=0;x<f.length;x++)f[x]=_$(f[x]);return f}else return l}function _$(e){return(e&255)<<8|e>>8&255}const ku=Uint8Array.of(137,80,78,71,13,10,26,10);function xw(e){if(!S$(e.readBytes(ku.length)))throw new Error("wrong PNG signature")}function S$(e){if(e.length<ku.length)return!1;for(let t=0;t<ku.length;t++)if(e[t]!==ku[t])return!1;return!0}const T$="tEXt",D$=0,d3=new TextDecoder("latin1");function A$(e){if(F$(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const k$=/^[\u0000-\u00FF]*$/;function F$(e){if(!k$.test(e))throw new Error("invalid latin1 text")}function U$(e,t,r){const n=f3(t);e[n]=R$(t,r-n.length-1)}function f3(e){for(e.mark();e.readByte()!==D$;);const t=e.offset;e.reset();const r=d3.decode(e.readBytes(t-e.offset-1));return e.skip(1),A$(r),r}function R$(e,t){return d3.decode(e.readBytes(t))}const Hr={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},V0={UNKNOWN:-1,DEFLATE:0},gw={UNKNOWN:-1,ADAPTIVE:0},P0={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},bu={NONE:0,BACKGROUND:1,PREVIOUS:2},I0={SOURCE:0,OVER:1};class O$ extends $g{constructor(r,n={}){super(r);et(this,"_checkCrc");et(this,"_inflator");et(this,"_png");et(this,"_apng");et(this,"_end");et(this,"_hasPalette");et(this,"_palette");et(this,"_hasTransparency");et(this,"_transparency");et(this,"_compressionMethod");et(this,"_filterMethod");et(this,"_interlaceMethod");et(this,"_colorType");et(this,"_isAnimated");et(this,"_numberOfFrames");et(this,"_numberOfPlays");et(this,"_frames");et(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new dw,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=V0.UNKNOWN,this._filterMethod=gw.UNKNOWN,this._interlaceMethod=P0.UNKNOWN,this._colorType=Hr.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(xw(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(xw(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case T$:U$(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?hw(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?hw(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=V$(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case Hr.GREYSCALE:a=1;break;case Hr.TRUECOLOUR:a=3;break;case Hr.INDEXED_COLOUR:a=1;break;case Hr.GREYSCALE_ALPHA:a=2;break;case Hr.TRUECOLOUR_ALPHA:a=4;break;case Hr.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==V0.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let i=0;i<n;i++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Hr.GREYSCALE:case Hr.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Hr.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Hr.UNKNOWN:case Hr.GREYSCALE_ALPHA:case Hr.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=f3(this),a=this.readUint8();if(a!==V0.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const i=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:m$(i)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=pw({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(a,i,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case bu.NONE:break;case bu.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let s=0;s<this._png.width;s++){const o=(i*r.width+s)*this._png.channels;for(let l=0;l<this._png.channels;l++)a.data[o+l]=0}break;case bu.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,i=(s,o)=>{const l=((s+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,u=(s*n.width+o)*this._png.channels;return{index:l,frameIndex:u}};switch(n.blendOp){case I0.SOURCE:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:u}=i(s,o);for(let c=0;c<this._png.channels;c++)r.data[l+c]=n.data[u+c]}break;case I0.OVER:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:u}=i(s,o);for(let c=0;c<this._png.channels;c++){const m=n.data[u+this._png.channels-1]/a,h=c%(this._png.channels-1)===0?1:n.data[u+c],f=Math.floor(m*h+(1-m)*r.data[l+c]);r.data[l+c]+=f}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==gw.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===P0.NO_INTERLACE)this._png.data=pw({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===P0.ADAM7)this._png.data=b$({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:bu.NONE,blendOp:I0.SOURCE,data:r}),this._inflator=new dw,this._writingDataChunks=!1}}function V$(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}function QJ(e,t){return new O$(e,t).decode()}const Yt={left:20,right:20},yt={primary:"#000000",secondary:"#333333",border:"#CCCCCC",text:"#212121",tableBorder:"#CCCCCC",tableHeader:"#F0F0F0"},It={title:16,heading:12,body:10,small:8};function P$(e,t){let r=0;if(r+=50,e.dataTypes.inspections){const n=t.inspections.length;r+=n*.8}if(e.dataTypes.custodialNotes){const n=t.custodialNotes.length;r+=n*.3}if(e.dataTypes.images){const n=t.inspections.reduce((a,i)=>{var s;return a+(((s=i.images)==null?void 0:s.length)||0)},0);r+=n*200}return e.includeCharts&&(r+=500),e.includeDetails&&(r*=1.5),r<1024?`${Math.round(r)} KB`:`${(r/1024).toFixed(1)} MB`}function I$(e,t){let r=1;if(e.dataTypes.inspections){const n=t.inspections.length,a=e.includeDetails?2:8;r+=Math.ceil(n/a)}if(e.dataTypes.custodialNotes){const n=t.custodialNotes.length;r+=Math.ceil(n/10)}return e.includeCharts&&(r+=2),Math.max(r,1)}function zp(e){const t=[];return!e.dataTypes.inspections&&!e.dataTypes.custodialNotes&&t.push("Please select at least one data type to export"),e.reportType||t.push("Please select a report type"),e.filters.dateRange.from&&e.filters.dateRange.to&&e.filters.dateRange.from>e.filters.dateRange.to&&t.push("Start date must be before end date"),(e.filters.ratingThreshold<1||e.filters.ratingThreshold>5)&&t.push("Rating threshold must be between 1 and 5"),{isValid:t.length===0,errors:t}}function ro(e,t){let r=[...e.inspections],n=[...e.custodialNotes];if(t.filters.dateRange.from){const a=t.filters.dateRange.from.getTime();r=r.filter(i=>new Date(i.date).getTime()>=a),n=n.filter(i=>new Date(i.date).getTime()>=a)}if(t.filters.dateRange.to){const a=t.filters.dateRange.to.getTime();r=r.filter(i=>new Date(i.date).getTime()<=a),n=n.filter(i=>new Date(i.date).getTime()<=a)}return t.filters.schools.length>0&&(r=r.filter(a=>t.filters.schools.includes(a.school)),n=n.filter(a=>t.filters.schools.includes(a.school))),t.filters.categories.length>0&&(r=r.filter(a=>t.filters.categories.some(i=>typeof a[i]=="number"))),t.filters.ratingThreshold>0&&(r=r.filter(a=>{const s=["floors","verticalHorizontalSurfaces","ceiling","restrooms","customerSatisfaction","trash","projectCleaning","activitySupport","safetyCompliance","equipment","monitoring"].map(l=>a[l]).filter(l=>typeof l=="number");return s.length===0?!1:s.reduce((l,u)=>l+u,0)/s.length<=t.filters.ratingThreshold})),t.filters.severityLevels.length>0&&(r=r.filter(a=>{const s=["floors","verticalHorizontalSurfaces","ceiling","restrooms"].map(l=>a[l]).filter(l=>typeof l=="number");if(s.length===0)return!1;const o=s.reduce((l,u)=>l+u,0)/s.length;return!!(t.filters.severityLevels.includes("critical")&&o<=2||t.filters.severityLevels.includes("needs-attention")&&o<=3||t.filters.severityLevels.includes("acceptable")&&o>3)})),{inspections:r,custodialNotes:n,totalRecords:r.length+n.length,dateRange:t.filters.dateRange,schools:t.filters.schools,categories:t.filters.categories}}function M$(e){var r,n;const t=[];if(e.filters.dateRange.from||e.filters.dateRange.to){const a=((r=e.filters.dateRange.from)==null?void 0:r.toLocaleDateString())||"Start",i=((n=e.filters.dateRange.to)==null?void 0:n.toLocaleDateString())||"End";t.push(`Date: ${a} - ${i}`)}return e.filters.schools.length>0&&t.push(`Schools: ${e.filters.schools.length} selected`),e.filters.categories.length>0&&t.push(`Categories: ${e.filters.categories.length} selected`),e.filters.severityLevels.length>0&&t.push(`Severity: ${e.filters.severityLevels.join(", ")}`),e.filters.ratingThreshold>0&&t.push(`Rating â‰¤ ${e.filters.ratingThreshold} stars`),t}function j$(e){const t=e.inspections.reduce((a,i)=>{var s;return a+(((s=i.images)==null?void 0:s.length)||0)},0),r=t*200,n=r<1024?`${r} KB`:`${(r/1024).toFixed(1)} MB`;return{inspections:e.inspections.length,custodialNotes:e.custodialNotes.length,images:t,totalSize:n}}function h3(e){const t=new bl("p","mm","letter");let r=20;const n=L$(e);return r=B$(t,e,r),r=q$(t,n,r),r=z$(t,n,r),H$(t),t.output("blob")}function L$(e){var a,i;const t=[],r=(a=e.startDate)==null?void 0:a.getTime(),n=(i=e.endDate)==null?void 0:i.getTime();return e.inspections.forEach(s=>{const o=new Date(s.date).getTime();if(r&&o<r||n&&o>n||e.schoolFilter&&s.school!==e.schoolFilter)return;const l=Qi(s);if(l===null)return;let u="Info";if(l<2)u="Critical";else if(l<3)u="Needs Attention";else return;t.push({date:new Date(s.date).toLocaleDateString(),school:s.school,location:s.locationDescription||s.roomNumber||"N/A",priority:u,description:`Rating: ${l.toFixed(1)}/5.0${s.notes?` - ${s.notes}`:""}`,reportedBy:s.inspectorName||"N/A",category:"Inspection"})}),e.custodialNotes.forEach(s=>{const o=new Date(s.date).getTime();if(r&&o<r||n&&o>n||e.schoolFilter&&s.school!==e.schoolFilter)return;const u=["urgent","emergency","leak","unsafe","broken","immediate"].some(c=>s.notes.toLowerCase().includes(c));t.push({date:new Date(s.date).toLocaleDateString(),school:s.school,location:s.location,priority:u?"Critical":"Needs Attention",description:s.notes,reportedBy:"N/A",category:"Custodial Note"})}),t.sort((s,o)=>{if(s.priority!==o.priority){const l={Critical:0,"Needs Attention":1,Info:2};return l[s.priority]-l[o.priority]}return new Date(o.date).getTime()-new Date(s.date).getTime()}),t}function B$(e,t,r){e.setFontSize(It.title),e.setTextColor(yt.primary),e.setFont("helvetica","bold"),e.text("Current Custodial Issues Report",Yt.left,r),r+=8,e.setFontSize(It.body),e.setTextColor(yt.secondary),e.setFont("helvetica","normal");const n=t.startDate&&t.endDate?`${t.startDate.toLocaleDateString()} - ${t.endDate.toLocaleDateString()}`:"All Dates";return e.text(`Date Range: ${n}`,Yt.left,r),r+=5,t.schoolFilter&&(e.text(`School: ${t.schoolFilter}`,Yt.left,r),r+=5),t.activeFilters&&t.activeFilters.length>0&&(e.text(`Filters: ${t.activeFilters.join(", ")}`,Yt.left,r),r+=5),e.setFontSize(It.small),e.setTextColor(yt.secondary),e.text(`Generated: ${new Date().toLocaleString()}`,Yt.left,r),r+=5,e.setDrawColor(yt.border),e.setLineWidth(.5),e.line(Yt.left,r,e.internal.pageSize.getWidth()-Yt.right,r),r+8}function q$(e,t,r){const n=t.filter(o=>o.priority==="Critical").length,a=t.filter(o=>o.priority==="Needs Attention").length,i=new Set(t.map(o=>o.school)).size;e.setFontSize(It.heading),e.setTextColor(yt.primary),e.setFont("helvetica","bold"),e.text("Summary Statistics",Yt.left,r),r+=6;const s=[["Total Issues:",t.length.toString()],["Critical:",n.toString()],["Needs Attention:",a.toString()],["Schools Affected:",i.toString()]];return Mi(e,{startY:r,body:s,theme:"plain",styles:{fontSize:It.body,textColor:yt.text,cellPadding:2,lineWidth:.5,lineColor:yt.tableBorder},columnStyles:{0:{fontStyle:"bold",cellWidth:40},1:{cellWidth:20}}}),e.lastAutoTable.finalY+10}function z$(e,t,r){if(t.length===0)return e.setFontSize(It.body),e.setTextColor(yt.secondary),e.text("No issues found for the selected criteria.",Yt.left,r),r+10;e.setFontSize(It.heading),e.setTextColor(yt.primary),e.setFont("helvetica","bold"),e.text("Issues Detail",Yt.left,r),r+=6;const n=t.map(a=>[a.date,a.school,a.location,a.priority,a.description,a.category]);return Mi(e,{startY:r,head:[["Date","School","Location","Priority","Description","Type"]],body:n,theme:"grid",headStyles:{fillColor:yt.tableHeader,textColor:yt.primary,fontStyle:"bold",fontSize:It.small,lineWidth:.5,lineColor:yt.tableBorder},bodyStyles:{fontSize:It.small,textColor:yt.text,lineWidth:.5,lineColor:yt.tableBorder},columnStyles:{0:{cellWidth:20},1:{cellWidth:20},2:{cellWidth:30},3:{cellWidth:25},4:{cellWidth:60},5:{cellWidth:25}},styles:{overflow:"linebreak",cellPadding:3}}),e.lastAutoTable.finalY}function H$(e){const t=e.getNumberOfPages();for(let r=1;r<=t;r++){e.setPage(r);const n=e.internal.pageSize.getHeight();e.setFontSize(It.small),e.setTextColor(yt.secondary),e.text(`Page ${r} of ${t}`,e.internal.pageSize.getWidth()/2,n-10,{align:"center"}),e.text("Custodial Command System",Yt.left,n-10)}}function $$(e,t){var u,c;const r=ro(e,t),n=new bl("p","mm","letter");let a=20;if(n.setFontSize(It.title),n.setTextColor(yt.primary),n.setFont("helvetica","bold"),n.text("EXECUTIVE SUMMARY",Yt.left,a),a+=15,t.filters.dateRange.from||t.filters.dateRange.to){n.setFontSize(It.body),n.setTextColor(yt.secondary);const m=((u=t.filters.dateRange.from)==null?void 0:u.toLocaleDateString())||"Start",h=((c=t.filters.dateRange.to)==null?void 0:c.toLocaleDateString())||"End";n.text(`Report Period: ${m} - ${h}`,Yt.left,a),a+=10}const i=r.inspections.length,s=r.custodialNotes.length,o=i>0?r.inspections.map(Qi).filter(m=>m!==null).reduce((m,h)=>m+h,0)/i:0,l=[["Total Inspections",i.toString()],["Custodial Notes",s.toString()],["Average Rating",o.toFixed(1)+" stars"],["Schools Covered",r.schools.length.toString()]];return Mi(n,{startY:a,head:[["Metric","Value"]],body:l,theme:"grid",headStyles:{fillColor:yt.tableHeader},styles:{fontSize:It.body}}),a=n.lastAutoTable.finalY+10,n.setFontSize(It.body),n.setTextColor(yt.text),n.text("This executive summary provides a high-level overview of custodial performance",Yt.left,a),a+=6,n.text(`across ${r.schools.length} schools with ${i} inspections conducted.`,Yt.left,a),n.output("blob")}function W$(e,t){const r=ro(e,t),n=new bl("p","mm","letter");let a=20;n.setFontSize(It.title),n.setTextColor(yt.primary),n.setFont("helvetica","bold"),n.text("SCHOOL PERFORMANCE REPORT",Yt.left,a),a+=15;const i=r.inspections.reduce((o,l)=>{o[l.school]||(o[l.school]={school:l.school,inspections:0,ratings:[]}),o[l.school].inspections++;const u=Qi(l);return u!==null&&o[l.school].ratings.push(u),o},{}),s=Object.values(i).map(o=>[o.school,o.inspections.toString(),o.ratings.length>0?(o.ratings.reduce((l,u)=>l+u,0)/o.ratings.length).toFixed(1):"N/A"]);return Mi(n,{startY:a,head:[["School","Inspections","Avg Rating"]],body:s,theme:"grid",headStyles:{fillColor:yt.tableHeader},styles:{fontSize:It.body}}),n.output("blob")}function G$(e,t){const r=ro(e,t),n=new bl("p","mm","letter");let a=20;n.setFontSize(It.title),n.setTextColor(yt.primary),n.setFont("helvetica","bold"),n.text("CATEGORY ANALYSIS REPORT",Yt.left,a),a+=15;const s=[{key:"floors",label:"Floors"},{key:"verticalHorizontalSurfaces",label:"Vertical and Horizontal Surfaces"},{key:"ceiling",label:"Ceiling"},{key:"restrooms",label:"Restrooms"},{key:"customerSatisfaction",label:"Customer Satisfaction"}].map(o=>{const l=r.inspections.map(u=>u[o.key]).filter(u=>typeof u=="number");return[o.label,l.length.toString(),l.length>0?(l.reduce((u,c)=>u+c,0)/l.length).toFixed(1):"N/A"]});return Mi(n,{startY:a,head:[["Category","Inspections","Avg Rating"]],body:s,theme:"grid",headStyles:{fillColor:yt.tableHeader},styles:{fontSize:It.body}}),n.output("blob")}function Y$(e,t){const r=ro(e,t),n=new bl("p","mm","letter");let a=20;if(n.setFontSize(It.title),n.setTextColor(yt.primary),n.setFont("helvetica","bold"),n.text("CUSTOM REPORT",Yt.left,a),a+=15,t.dataTypes.inspections){n.setFontSize(It.heading),n.setTextColor(yt.primary),n.text("INSPECTIONS",Yt.left,a),a+=10;const i=r.inspections.slice(0,10).map(s=>{var o;return[s.school,s.date,((o=Qi(s))==null?void 0:o.toFixed(1))||"N/A"]});Mi(n,{startY:a,head:[["School","Date","Rating"]],body:i,theme:"grid",headStyles:{fillColor:yt.tableHeader},styles:{fontSize:It.body}}),a=n.lastAutoTable.finalY+10}if(t.dataTypes.custodialNotes){n.setFontSize(It.heading),n.setTextColor(yt.primary),n.text("CUSTODIAL NOTES",Yt.left,a),a+=10;const i=r.custodialNotes.slice(0,10).map(s=>[s.school,s.date,s.notes.substring(0,50)+(s.notes.length>50?"...":"")]);Mi(n,{startY:a,head:[["School","Date","Note"]],body:i,theme:"grid",headStyles:{fillColor:yt.tableHeader},styles:{fontSize:It.body}})}return n.output("blob")}const X$=({inspections:e,custodialNotes:t,trigger:r,onExport:n})=>{const[a,i]=W.useState(!1),[s,o]=W.useState(!1),[l,u]=W.useState("excel"),[c,m]=W.useState("all"),[h,f]=W.useState({includeSummary:!0,includeAllInspections:!0,includeProblemAreas:!0,includeCustodialNotes:!0}),x=()=>bt(null,null,function*(){o(!0);try{const v={inspections:e,custodialNotes:t,options:h};switch(l){case"excel":Dz(v);break;case"csv":kz(v,c==="problems"?"problems":"inspections");break;case"pdf":const b={inspections:e,custodialNotes:t,activeFilters:Object.entries(h).filter(([w,S])=>S).map(([w])=>w)},N=h3(b),F=URL.createObjectURL(N),E=document.createElement("a");E.href=F,E.download=`custodial-report-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(F);break}n==null||n(),i(!1)}catch(v){console.error("Export failed:",v),alert(`Export failed: ${v instanceof Error?v.message:"Unknown error"}. Please try again.`)}finally{o(!1)}}),p=()=>{const v=e.length*.5,C=l==="excel"?1.5:.3,b=Object.values(h).filter(Boolean).length,N=Math.round(v*C*b);return N<1024?`${N} KB`:`${(N/1024).toFixed(1)} MB`},g=()=>{switch(c){case"all":return e.length;case"filtered":return e.length;case"problems":return e.filter(v=>{const b=["floors","verticalHorizontalSurfaces","ceiling","restrooms"].map(F=>v[F]).filter(F=>F!==null);return(b.length>0?b.reduce((F,E)=>F+E,0)/b.length:5)<3}).length;case"custom":return e.length;default:return e.length}};return d.jsxDEV(kc,{open:a,onOpenChange:i,children:[d.jsxDEV(uS,{asChild:!0,children:r||d.jsxDEV(Ye,{children:[d.jsxDEV(Ii,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:133,columnNumber:13},void 0),"Export Data"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:132,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:130,columnNumber:7},void 0),d.jsxDEV(yl,{className:"w-[95vw] sm:max-w-2xl max-h-[90vh] p-0 overflow-hidden",children:d.jsxDEV("div",{className:"flex flex-col h-full",children:[d.jsxDEV(Cl,{className:"p-6 pb-2",children:[d.jsxDEV(wl,{children:"Export Data"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:141,columnNumber:13},void 0),d.jsxDEV(El,{children:"Choose format and options for exporting inspection data and reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:140,columnNumber:11},void 0),d.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 pt-4 space-y-6 bg-background",children:[d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV(nt,{className:"text-base font-medium",children:"Export Format"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:151,columnNumber:13},void 0),d.jsxDEV(JT,{value:l,onValueChange:v=>u(v),children:[d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(Au,{value:"excel",id:"excel"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:154,columnNumber:17},void 0),d.jsxDEV(nt,{htmlFor:"excel",className:"flex items-center gap-2",children:[d.jsxDEV(Rk,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:156,columnNumber:19},void 0),"Excel (.xlsx) - Multiple sheets with formatting"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:155,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:153,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(Au,{value:"csv",id:"csv"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:161,columnNumber:17},void 0),d.jsxDEV(nt,{htmlFor:"csv",className:"flex items-center gap-2",children:[d.jsxDEV(Sa,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:163,columnNumber:19},void 0),"CSV (.csv) - Single sheet, compatible with all tools"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:162,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:160,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(Au,{value:"pdf",id:"pdf"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:168,columnNumber:17},void 0),d.jsxDEV(nt,{htmlFor:"pdf",className:"flex items-center gap-2",children:[d.jsxDEV(Ok,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:170,columnNumber:19},void 0),"PDF (.pdf) - Formatted issue reports with summaries"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:169,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:167,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:152,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:150,columnNumber:11},void 0),d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV(nt,{className:"text-base font-medium",children:"Export Scope"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:179,columnNumber:13},void 0),d.jsxDEV(Fo,{value:c,onValueChange:v=>m(v),children:[d.jsxDEV(Cs,{children:d.jsxDEV(Uo,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:182,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:181,columnNumber:15},void 0),d.jsxDEV(ws,{children:[d.jsxDEV(An,{value:"all",children:["All Data (",e.length," inspections)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:185,columnNumber:17},void 0),d.jsxDEV(An,{value:"filtered",children:["Filtered Data (",g()," inspections)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:186,columnNumber:17},void 0),d.jsxDEV(An,{value:"problems",children:["Problems Only (",g()," inspections)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:187,columnNumber:17},void 0),d.jsxDEV(An,{value:"custom",children:"Custom Selection"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:188,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:184,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:180,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:178,columnNumber:11},void 0),l==="excel"&&d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV(nt,{className:"text-base font-medium",children:"Include in Export"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:196,columnNumber:15},void 0),d.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:"summary",checked:h.includeSummary,onCheckedChange:v=>f(he(H({},h),{includeSummary:!!v}))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:199,columnNumber:19},void 0),d.jsxDEV(nt,{htmlFor:"summary",children:"Executive Summary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:204,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:198,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:"inspections",checked:h.includeAllInspections,onCheckedChange:v=>f(he(H({},h),{includeAllInspections:!!v}))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:207,columnNumber:19},void 0),d.jsxDEV(nt,{htmlFor:"inspections",children:"All Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:212,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:206,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:"problems",checked:h.includeProblemAreas,onCheckedChange:v=>f(he(H({},h),{includeProblemAreas:!!v}))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:215,columnNumber:19},void 0),d.jsxDEV(nt,{htmlFor:"problems",children:"Problem Areas"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:220,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:214,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:"notes",checked:h.includeCustodialNotes,onCheckedChange:v=>f(he(H({},h),{includeCustodialNotes:!!v}))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:223,columnNumber:19},void 0),d.jsxDEV(nt,{htmlFor:"notes",children:"Custodial Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:228,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:222,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:197,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:195,columnNumber:13},void 0),d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{children:d.jsxDEV(Qe,{className:"text-sm",children:"Export Preview"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:237,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:236,columnNumber:13},void 0),d.jsxDEV(He,{className:"space-y-2",children:[d.jsxDEV("div",{className:"flex justify-between text-sm",children:[d.jsxDEV("span",{children:"Records:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:241,columnNumber:17},void 0),d.jsxDEV("span",{children:[g()," inspections"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:242,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:240,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex justify-between text-sm",children:[d.jsxDEV("span",{children:"Format:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:245,columnNumber:17},void 0),d.jsxDEV("span",{children:l.toUpperCase()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:246,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:244,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex justify-between text-sm",children:[d.jsxDEV("span",{children:"Estimated Size:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:249,columnNumber:17},void 0),d.jsxDEV("span",{children:p()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:250,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:248,columnNumber:15},void 0),l==="excel"&&d.jsxDEV("div",{className:"flex justify-between text-sm",children:[d.jsxDEV("span",{children:"Sheets:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:254,columnNumber:19},void 0),d.jsxDEV("span",{children:[Object.values(h).filter(Boolean).length," sheets"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:255,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:253,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:239,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:235,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:148,columnNumber:11},void 0),d.jsxDEV("div",{className:"flex justify-end gap-3 p-6 border-t bg-background",children:[d.jsxDEV(Ye,{variant:"outline",onClick:()=>i(!1),children:"Cancel"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:264,columnNumber:13},void 0),d.jsxDEV(Ye,{onClick:x,disabled:s,className:"min-w-[120px]",children:s?d.jsxDEV(d.Fragment,{children:[d.jsxDEV(Ou,{className:"w-4 h-4 mr-2 animate-spin"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:274,columnNumber:19},void 0),"Exporting..."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:273,columnNumber:17},void 0):d.jsxDEV(d.Fragment,{children:[d.jsxDEV(Ii,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:279,columnNumber:19},void 0),"Export Data"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:278,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:267,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:263,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:139,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:138,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportDialog.tsx",lineNumber:129,columnNumber:5},void 0)},ZJ=({inspections:e,custodialNotes:t,onInspectionClick:r,onExportReport:n})=>{const a=W.useMemo(()=>{const o=bg(e),l=Ng(t);return he(H({},o),{urgentNotes:l,summary:he(H({},o.summary),{urgentNotesCount:l.length})})},[e,t]),i=(o,l)=>{const u=I8(o.severity);return d.jsxDEV(Le,{className:"hover:shadow-lg transition-shadow",children:[d.jsxDEV(Ke,{className:"pb-3",children:[d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[o.severity==="critical"?d.jsxDEV(mn,{className:"w-5 h-5 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:54,columnNumber:17},void 0):d.jsxDEV(Fr,{className:"w-5 h-5 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:56,columnNumber:17},void 0),d.jsxDEV(Qe,{className:"text-lg",children:o.school},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:58,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:52,columnNumber:13},void 0),d.jsxDEV(Ct,he(H({},u),{children:u.text}),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:60,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:51,columnNumber:11},void 0),d.jsxDEV(ft,{className:"flex items-center gap-4 text-sm",children:[d.jsxDEV("span",{className:"flex items-center gap-1",children:[d.jsxDEV(dn,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:66,columnNumber:15},void 0),o.location]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:65,columnNumber:13},void 0),d.jsxDEV("span",{className:"flex items-center gap-1",children:[d.jsxDEV(yr,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:70,columnNumber:15},void 0),new Date(o.date).toLocaleDateString()]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:69,columnNumber:13},void 0),d.jsxDEV("span",{className:"flex items-center gap-1",children:[d.jsxDEV(Ya,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:74,columnNumber:15},void 0),o.rating,"/5"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:73,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:64,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:50,columnNumber:9},void 0),d.jsxDEV(He,{className:"pt-0",children:d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("div",{className:"text-sm text-muted-foreground",children:o.severity==="critical"?"Immediate attention required":"Needs improvement"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:81,columnNumber:13},void 0),d.jsxDEV("div",{className:"flex gap-2",children:d.jsxDEV(Ye,{variant:"outline",size:"sm",onClick:()=>r==null?void 0:r(o.inspection),children:[d.jsxDEV(m_,{className:"w-4 h-4 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:93,columnNumber:17},void 0),"View Details"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:88,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:87,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:80,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:79,columnNumber:9},void 0)]},`${o.inspection.id}-${l}`,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:49,columnNumber:7},void 0)},s=(o,l)=>{const u=M8(o.severity),c=o.note;return d.jsxDEV(Le,{className:"border-l-4 border-l-red-500 hover:shadow-lg transition-shadow",children:[d.jsxDEV(Ke,{className:"pb-3",children:[d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(mn,{className:"w-5 h-5 text-red-600 animate-pulse"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:112,columnNumber:15},void 0),d.jsxDEV(Qe,{className:"text-lg",children:c.school},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:113,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:111,columnNumber:13},void 0),d.jsxDEV(Ct,he(H({},u),{children:u.text}),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:115,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:110,columnNumber:11},void 0),d.jsxDEV(ft,{className:"flex items-center gap-4 text-sm",children:[d.jsxDEV("span",{className:"flex items-center gap-1",children:[d.jsxDEV(dn,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:121,columnNumber:15},void 0),c.location]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:120,columnNumber:13},void 0),d.jsxDEV("span",{className:"flex items-center gap-1",children:[d.jsxDEV(yr,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:125,columnNumber:15},void 0),new Date(c.date).toLocaleDateString()]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:124,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:119,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:109,columnNumber:9},void 0),d.jsxDEV(He,{className:"pt-0",children:d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV("p",{className:"text-sm text-foreground",children:c.notes},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:132,columnNumber:13},void 0),o.keywords.length>0&&d.jsxDEV("div",{className:"flex flex-wrap gap-1",children:o.keywords.map((m,h)=>d.jsxDEV(Ct,{variant:"outline",className:"text-xs",children:m},h,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:136,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:131,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:130,columnNumber:9},void 0)]},`note-${c.id}-${l}`,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:108,columnNumber:7},void 0)};return d.jsxDEV("div",{className:"space-y-6",children:[d.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[d.jsxDEV(Qe,{className:"text-sm font-medium",children:"Critical Issues"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:154,columnNumber:13},void 0),d.jsxDEV(mn,{className:"h-4 w-4 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:155,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:153,columnNumber:11},void 0),d.jsxDEV(He,{children:[d.jsxDEV("div",{className:"text-2xl font-bold text-red-600",children:a.summary.criticalCount},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:158,columnNumber:13},void 0),d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Rating < 2.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:159,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:157,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:152,columnNumber:9},void 0),d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[d.jsxDEV(Qe,{className:"text-sm font-medium",children:"Needs Attention"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:165,columnNumber:13},void 0),d.jsxDEV(Fr,{className:"h-4 w-4 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:166,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:164,columnNumber:11},void 0),d.jsxDEV(He,{children:[d.jsxDEV("div",{className:"text-2xl font-bold text-orange-600",children:a.summary.needsAttentionCount},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:169,columnNumber:13},void 0),d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Rating 2.0-3.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:170,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:168,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:163,columnNumber:9},void 0),d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[d.jsxDEV(Qe,{className:"text-sm font-medium",children:"Urgent Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:176,columnNumber:13},void 0),d.jsxDEV(Sa,{className:"h-4 w-4 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:177,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:175,columnNumber:11},void 0),d.jsxDEV(He,{children:[d.jsxDEV("div",{className:"text-2xl font-bold text-red-600",children:a.summary.urgentNotesCount},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:180,columnNumber:13},void 0),d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"High priority reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:181,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:179,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:174,columnNumber:9},void 0),d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[d.jsxDEV(Qe,{className:"text-sm font-medium",children:"Affected Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:187,columnNumber:13},void 0),d.jsxDEV(dn,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:188,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:186,columnNumber:11},void 0),d.jsxDEV(He,{children:[d.jsxDEV("div",{className:"text-2xl font-bold",children:a.summary.affectedSchools.length},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:191,columnNumber:13},void 0),d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Schools with issues"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:192,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:190,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:185,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:151,columnNumber:7},void 0),d.jsxDEV("div",{className:"flex justify-end",children:d.jsxDEV(X$,{inspections:e,custodialNotes:t,trigger:d.jsxDEV(Ye,{className:"bg-primary hover:bg-primary/90",children:[d.jsxDEV(Ii,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:204,columnNumber:15},void 0),"Export Problem Areas Report"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:203,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:199,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:198,columnNumber:7},void 0),a.urgentNotes.length>0&&d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(mn,{className:"w-6 h-6 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:215,columnNumber:13},void 0),d.jsxDEV("h3",{className:"text-xl font-bold text-red-600",children:"ðŸš¨ URGENT FACILITY ISSUES"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:216,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:214,columnNumber:11},void 0),d.jsxDEV("div",{className:"grid gap-4",children:a.urgentNotes.map((o,l)=>s(o,l))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:218,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:213,columnNumber:9},void 0),a.critical.length>0&&d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(mn,{className:"w-6 h-6 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:230,columnNumber:13},void 0),d.jsxDEV("h3",{className:"text-xl font-bold text-red-600",children:"ðŸ”´ CRITICAL PERFORMANCE ISSUES"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:231,columnNumber:13},void 0),d.jsxDEV(Ct,{variant:"destructive",className:"ml-2",children:"Rating < 2.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:229,columnNumber:11},void 0),d.jsxDEV("div",{className:"grid gap-4",children:a.critical.map((o,l)=>i(o,l))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:236,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:228,columnNumber:9},void 0),a.needsAttention.length>0&&d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(Fr,{className:"w-6 h-6 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:248,columnNumber:13},void 0),d.jsxDEV("h3",{className:"text-xl font-bold text-orange-600",children:"ðŸŸ  NEEDS ATTENTION"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:249,columnNumber:13},void 0),d.jsxDEV(Ct,{variant:"secondary",className:"ml-2",children:"Rating 2.0-3.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:250,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:247,columnNumber:11},void 0),d.jsxDEV("div",{className:"grid gap-4",children:a.needsAttention.map((o,l)=>i(o,l))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:254,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:246,columnNumber:9},void 0),a.critical.length===0&&a.needsAttention.length===0&&a.urgentNotes.length===0&&d.jsxDEV(Le,{className:"text-center py-8",children:d.jsxDEV(He,{children:d.jsxDEV("div",{className:"flex flex-col items-center gap-4",children:[d.jsxDEV("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:d.jsxDEV(Ya,{className:"w-8 h-8 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:270,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:269,columnNumber:15},void 0),d.jsxDEV("div",{children:[d.jsxDEV("h3",{className:"text-lg font-semibold text-green-600",children:"No Problem Areas Found"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:273,columnNumber:17},void 0),d.jsxDEV("p",{className:"text-muted-foreground",children:"All inspections are performing at acceptable levels. Great job!"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:274,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:272,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:268,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:267,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:266,columnNumber:9},void 0),a.summary.totalProblems>0&&d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{children:d.jsxDEV(Qe,{className:"text-lg",children:"Problem Areas Summary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:287,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:286,columnNumber:11},void 0),d.jsxDEV(He,{children:d.jsxDEV("div",{className:"space-y-2 text-sm",children:[d.jsxDEV("p",{children:[d.jsxDEV("strong",{children:"Most Problematic School:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:291,columnNumber:18},void 0)," ",a.summary.mostProblematicSchool||"N/A"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:291,columnNumber:15},void 0),d.jsxDEV("p",{children:[d.jsxDEV("strong",{children:"Affected Schools:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:292,columnNumber:18},void 0)," ",a.summary.affectedSchools.join(", ")]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:292,columnNumber:15},void 0),d.jsxDEV("p",{children:[d.jsxDEV("strong",{children:"Total Issues:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:293,columnNumber:18},void 0)," ",a.summary.totalProblems," problems across ",a.summary.affectedSchools.length," schools"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:293,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:290,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:289,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:285,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ProblemAreasView.tsx",lineNumber:149,columnNumber:5},void 0)},Wg=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(d_,he(H({ref:r,className:Fe("relative flex w-full touch-none select-none items-center",e)},t),{children:[d.jsxDEV(Vk,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:d.jsxDEV(Pk,{className:"absolute h-full bg-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/slider.tsx",lineNumber:19,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/slider.tsx",lineNumber:18,columnNumber:5},void 0),d.jsxDEV(Ik,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/slider.tsx",lineNumber:21,columnNumber:5},void 0)]}),void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/slider.tsx",lineNumber:10,columnNumber:3},void 0)});Wg.displayName=d_.displayName;const M0=Mk,j0=jk,L0=Lk,bo={last7Days:{from:mm(new Date,7),to:new Date},last30Days:{from:mm(new Date,30),to:new Date},thisMonth:{from:T1(new Date),to:bF(new Date)},thisQuarter:{from:T1(mm(new Date,90)),to:new Date}},K$=[{key:"floors",label:"Floors"},{key:"verticalHorizontalSurfaces",label:"Vertical and Horizontal Surfaces"},{key:"ceiling",label:"Ceiling"},{key:"restrooms",label:"Restrooms"},{key:"customerSatisfaction",label:"Customer Satisfaction and Coordination"},{key:"trash",label:"Trash"},{key:"projectCleaning",label:"Project Cleaning"},{key:"activitySupport",label:"Activity Support"},{key:"safetyCompliance",label:"Safety and Compliance"},{key:"equipment",label:"Equipment"},{key:"monitoring",label:"Monitoring"}],JJ=({inspections:e,custodialNotes:t,filters:r,onFiltersChange:n,onClearFilters:a,isOpen:i,onToggle:s})=>{var N,F,E,w;const o=vs.useRef(null);vs.useEffect(()=>{i&&o.current&&o.current.scrollIntoView({behavior:"smooth",block:"start"})},[i]);const[l,u]=W.useState(r);vs.useEffect(()=>{u(r)},[r,i]);const c=Array.from(new Set(e.map(S=>S.school).filter(Boolean))).sort(),m=Array.from(new Set(e.map(S=>S.inspectorName).filter(Boolean))).sort(),h=(S,_)=>{u(U=>he(H({},U),{[S]:_}))},f=S=>{const _=bo[S];h("dateRange",_)},x=(S,_)=>{const U=l[S]||[],R=U.includes(_)?U.filter(q=>q!==_):[...U,_];h(S,R)},p=()=>{let S=0;return l.search&&S++,(l.dateRange.from||l.dateRange.to)&&S++,l.schools.length>0&&S++,l.severityLevels.length>0&&S++,l.categories.length>0&&S++,l.inspectors.length>0&&S++,l.ratingThreshold>0&&S++,l.inspectionType!=="all"&&S++,l.showProblemsOnly&&S++,l.hasCustodialNotes&&S++,S},g=S=>S,v=p(),C=()=>{n(l),s()},b=()=>{a(),u({search:"",dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],inspectors:[],ratingThreshold:0,inspectionType:"all",showProblemsOnly:!1,hasCustodialNotes:!1})};return d.jsxDEV(Le,{className:"w-full",ref:o,children:d.jsxDEV(M0,{open:i,onOpenChange:s,children:[d.jsxDEV(j0,{asChild:!0,children:d.jsxDEV(Ke,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:[d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(f_,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:154,columnNumber:17},void 0),d.jsxDEV(Qe,{className:"text-lg",children:"Advanced Filters"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:155,columnNumber:17},void 0),v>0&&d.jsxDEV(Ct,{variant:"secondary",className:"ml-2",children:[v," active"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:157,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:153,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[v>0&&d.jsxDEV(Ye,{type:"button",variant:"outline",size:"sm",onClick:S=>{S.stopPropagation(),a()},children:[d.jsxDEV(Ga,{className:"w-4 h-4 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:173,columnNumber:21},void 0),"Clear All"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:164,columnNumber:19},void 0),i?d.jsxDEV(GE,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:177,columnNumber:27},void 0):d.jsxDEV(Fi,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:177,columnNumber:63},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:162,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:152,columnNumber:13},void 0),d.jsxDEV(ft,{children:"Filter inspections by date, school, rating, and more"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:180,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:151,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:150,columnNumber:9},void 0),d.jsxDEV(L0,{children:d.jsxDEV(He,{className:"space-y-6",children:[d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{htmlFor:"search",children:"Search"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:190,columnNumber:15},void 0),d.jsxDEV(Ns,{id:"search",placeholder:"Search by school, room, location, or notes...",value:l.search,onChange:S=>h("search",S.target.value)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:191,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:189,columnNumber:13},void 0),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{children:"Date Range"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:201,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex gap-2 flex-wrap",children:[d.jsxDEV(Ye,{type:"button",variant:((N=l.dateRange.from)==null?void 0:N.getTime())===bo.last7Days.from.getTime()?"default":"outline",size:"sm",onClick:()=>f("last7Days"),children:"Last 7 Days"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:203,columnNumber:17},void 0),d.jsxDEV(Ye,{type:"button",variant:((F=l.dateRange.from)==null?void 0:F.getTime())===bo.last30Days.from.getTime()?"default":"outline",size:"sm",onClick:()=>f("last30Days"),children:"Last 30 Days"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:211,columnNumber:17},void 0),d.jsxDEV(Ye,{type:"button",variant:((E=l.dateRange.from)==null?void 0:E.getTime())===bo.thisMonth.from.getTime()?"default":"outline",size:"sm",onClick:()=>f("thisMonth"),children:"This Month"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:219,columnNumber:17},void 0),d.jsxDEV(Ye,{type:"button",variant:((w=l.dateRange.from)==null?void 0:w.getTime())===bo.thisQuarter.from.getTime()?"default":"outline",size:"sm",onClick:()=>f("thisQuarter"),children:"This Quarter"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:227,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:202,columnNumber:15},void 0),d.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[d.jsxDEV("div",{children:[d.jsxDEV(nt,{htmlFor:"dateFrom",children:"From"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:238,columnNumber:19},void 0),d.jsxDEV(Ns,{id:"dateFrom",type:"date",value:l.dateRange.from?Vu(l.dateRange.from,"yyyy-MM-dd"):"",onChange:S=>h("dateRange",he(H({},l.dateRange),{from:S.target.value?new Date(S.target.value):null}))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:239,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:237,columnNumber:17},void 0),d.jsxDEV("div",{children:[d.jsxDEV(nt,{htmlFor:"dateTo",children:"To"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:250,columnNumber:19},void 0),d.jsxDEV(Ns,{id:"dateTo",type:"date",value:l.dateRange.to?Vu(l.dateRange.to,"yyyy-MM-dd"):"",onChange:S=>h("dateRange",he(H({},l.dateRange),{to:S.target.value?new Date(S.target.value):null}))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:251,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:249,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:236,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:200,columnNumber:13},void 0),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{children:"Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:266,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex flex-wrap gap-2",children:c.map(S=>d.jsxDEV(Ye,{type:"button",variant:l.schools.includes(S)?"default":"outline",size:"sm",onClick:()=>x("schools",S),children:S},S,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:269,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:267,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:265,columnNumber:13},void 0),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{children:"Severity Levels"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:284,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex gap-4",children:[d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:"critical",checked:l.severityLevels.includes("critical"),onCheckedChange:()=>x("severityLevels","critical")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:287,columnNumber:19},void 0),d.jsxDEV(nt,{htmlFor:"critical",className:"text-red-600",children:"Critical (< 2.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:292,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:286,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:"needs-attention",checked:l.severityLevels.includes("needs-attention"),onCheckedChange:()=>x("severityLevels","needs-attention")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:295,columnNumber:19},void 0),d.jsxDEV(nt,{htmlFor:"needs-attention",className:"text-orange-600",children:"Needs Attention (2.0-3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:300,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:294,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:"acceptable",checked:l.severityLevels.includes("acceptable"),onCheckedChange:()=>x("severityLevels","acceptable")},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:303,columnNumber:19},void 0),d.jsxDEV(nt,{htmlFor:"acceptable",className:"text-green-600",children:"Acceptable (> 3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:308,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:302,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:285,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:283,columnNumber:13},void 0),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{children:["Minimum Rating: ",l.ratingThreshold.toFixed(1)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:315,columnNumber:15},void 0),d.jsxDEV(Wg,{value:[l.ratingThreshold],onValueChange:([S])=>h("ratingThreshold",S),max:5,min:0,step:.1,className:"w-full"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:316,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex justify-between text-xs text-muted-foreground",children:[d.jsxDEV("span",{children:"0.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:325,columnNumber:17},void 0),d.jsxDEV("span",{children:"2.5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:326,columnNumber:17},void 0),d.jsxDEV("span",{children:"5.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:327,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:324,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:314,columnNumber:13},void 0),d.jsxDEV(M0,{children:[d.jsxDEV(j0,{asChild:!0,children:d.jsxDEV(Ye,{type:"button",variant:"ghost",className:"w-full justify-between p-0 h-auto",children:[d.jsxDEV(nt,{className:"text-base font-medium",children:"Categories"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:335,columnNumber:19},void 0),d.jsxDEV(Fi,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:336,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:334,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:333,columnNumber:15},void 0),d.jsxDEV(L0,{className:"space-y-2 mt-2",children:d.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:K$.map(S=>d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:S.key,checked:l.categories.includes(S.key),onCheckedChange:()=>x("categories",S.key)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:343,columnNumber:23},void 0),d.jsxDEV(nt,{htmlFor:S.key,className:"text-sm",children:S.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:348,columnNumber:23},void 0)]},S.key,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:342,columnNumber:21},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:340,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:339,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:332,columnNumber:13},void 0),d.jsxDEV(M0,{children:[d.jsxDEV(j0,{asChild:!0,children:d.jsxDEV(Ye,{type:"button",variant:"ghost",className:"w-full justify-between p-0 h-auto",children:[d.jsxDEV(nt,{className:"text-base font-medium",children:"Inspectors"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:359,columnNumber:19},void 0),d.jsxDEV(Fi,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:360,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:358,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:357,columnNumber:15},void 0),d.jsxDEV(L0,{className:"space-y-2 mt-2",children:d.jsxDEV("div",{className:"flex flex-wrap gap-2",children:m.map(S=>d.jsxDEV(Ye,{type:"button",variant:l.inspectors.includes(S)?"default":"outline",size:"sm",onClick:()=>x("inspectors",S),title:g(S),children:S},S,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:366,columnNumber:21},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:364,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:363,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:356,columnNumber:13},void 0),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{children:"Inspection Type"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:383,columnNumber:15},void 0),d.jsxDEV(Fo,{value:l.inspectionType,onValueChange:S=>h("inspectionType",S),children:[d.jsxDEV(Cs,{children:d.jsxDEV(Uo,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:389,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:388,columnNumber:17},void 0),d.jsxDEV(ws,{children:[d.jsxDEV(An,{value:"all",children:"All Types"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:392,columnNumber:19},void 0),d.jsxDEV(An,{value:"single_room",children:"Single Room"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:393,columnNumber:19},void 0),d.jsxDEV(An,{value:"whole_building",children:"Whole Building"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:394,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:391,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:384,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:382,columnNumber:13},void 0),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{children:"Quick Filters"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:401,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex gap-4",children:[d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:"problemsOnly",checked:l.showProblemsOnly,onCheckedChange:S=>h("showProblemsOnly",!!S)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:404,columnNumber:19},void 0),d.jsxDEV(nt,{htmlFor:"problemsOnly",children:"Problems Only"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:409,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:403,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:"hasNotes",checked:l.hasCustodialNotes,onCheckedChange:S=>h("hasCustodialNotes",!!S)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:412,columnNumber:19},void 0),d.jsxDEV(nt,{htmlFor:"hasNotes",children:"Has Custodial Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:417,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:411,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:402,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:400,columnNumber:13},void 0),d.jsxDEV("div",{className:"flex justify-between pt-4 border-t",children:[d.jsxDEV(Ye,{type:"button",variant:"outline",onClick:b,className:"flex items-center gap-2",children:[d.jsxDEV(Ga,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:430,columnNumber:17},void 0),"Reset Filters"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:424,columnNumber:15},void 0),d.jsxDEV(Ye,{type:"button",onClick:C,className:"flex items-center gap-2",children:"Apply Filters"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:433,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:423,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:187,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:186,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:149,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/AdvancedFilters.tsx",lineNumber:148,columnNumber:5},void 0)},pi=e=>e!=null?e:!1,vw=e=>he(H({},e),{showProblemsOnly:!!e.showProblemsOnly,hasCustodialNotes:!!e.hasCustodialNotes}),eee=({filters:e,onApplyPreset:t,schools:r})=>{const n=[{id:"critical-only",label:"Critical Only",description:"Show only critical issues (rating < 2.0)",icon:d.jsxDEV(mn,{className:"w-4 h-4 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:42,columnNumber:13},void 0),applyFilter:s=>he(H({},s),{severityLevels:["critical"],showProblemsOnly:!0,ratingThreshold:0}),isActive:s=>s.severityLevels.length===1&&s.severityLevels.includes("critical")&&pi(s.showProblemsOnly)},{id:"asa-issues",label:"ASA Issues",description:"Focus on ASA school problems",icon:d.jsxDEV(cm,{className:"w-4 h-4 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:58,columnNumber:13},void 0),applyFilter:s=>he(H({},s),{schools:["ASA School"],severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.schools.length===1&&s.schools.includes("ASA School")&&pi(s.showProblemsOnly)},{id:"gwc-issues",label:"GWC Issues",description:"Focus on GWC school problems",icon:d.jsxDEV(cm,{className:"w-4 h-4 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:74,columnNumber:13},void 0),applyFilter:s=>he(H({},s),{schools:["GWC School"],severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.schools.length===1&&s.schools.includes("GWC School")&&pi(s.showProblemsOnly)},{id:"recent-problems",label:"Recent Problems",description:"Problems from last 30 days",icon:d.jsxDEV(yr,{className:"w-4 h-4 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:90,columnNumber:13},void 0),applyFilter:s=>he(H({},s),{dateRange:{from:new Date(Date.now()-2592e6),to:new Date},severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>vw(s).showProblemsOnly===!0&&s.severityLevels.includes("critical")&&s.severityLevels.includes("needs-attention")&&!!s.dateRange.from&&Math.abs(s.dateRange.from.getTime()-(Date.now()-2592e6))<864e5},{id:"urgent-notes",label:"Urgent Notes",description:"Show inspections with urgent custodial notes",icon:d.jsxDEV(Fr,{className:"w-4 h-4 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:113,columnNumber:13},void 0),applyFilter:s=>he(H({},s),{hasCustodialNotes:!0,severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>pi(s.hasCustodialNotes)===!0&&pi(s.showProblemsOnly)===!0&&s.severityLevels.includes("critical")},{id:"low-performance",label:"Low Performance",description:"All ratings below 3.0",icon:d.jsxDEV(yx,{className:"w-4 h-4 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:129,columnNumber:13},void 0),applyFilter:s=>he(H({},s),{ratingThreshold:0,severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.ratingThreshold===0&&pi(s.showProblemsOnly)&&s.severityLevels.includes("critical")&&s.severityLevels.includes("needs-attention")},{id:"this-month",label:"This Month",description:"All inspections from current month",icon:d.jsxDEV(yr,{className:"w-4 h-4 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:146,columnNumber:13},void 0),applyFilter:s=>he(H({},s),{dateRange:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date},schools:[],severityLevels:[],showProblemsOnly:!1}),isActive:s=>{const o=vw(s);return!!s.dateRange.from&&s.dateRange.from.getMonth()===new Date().getMonth()&&s.dateRange.from.getFullYear()===new Date().getFullYear()&&o.showProblemsOnly===!1}},{id:"all-schools",label:"All Schools",description:"Show all schools with problems",icon:d.jsxDEV(cm,{className:"w-4 h-4 text-purple-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:169,columnNumber:13},void 0),applyFilter:s=>he(H({},s),{schools:r,severityLevels:["critical","needs-attention"],showProblemsOnly:!0}),isActive:s=>s.schools.length===r.length&&pi(s.showProblemsOnly)&&s.severityLevels.includes("critical")&&s.severityLevels.includes("needs-attention")}],a=s=>{const o=s.applyFilter(e);t(o)},i=(s,o)=>{o.stopPropagation(),t({search:"",dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],inspectors:[],ratingThreshold:0,inspectionType:"all",showProblemsOnly:!1,hasCustodialNotes:!1})};return d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV("h3",{className:"text-lg font-semibold",children:"Quick Filters"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:209,columnNumber:9},void 0),d.jsxDEV(Ct,{variant:"outline",className:"text-xs",children:[n.filter(s=>s.isActive(e)).length," active"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:210,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:208,columnNumber:7},void 0),d.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:n.map(s=>{const o=s.isActive(e);return d.jsxDEV(Ye,{type:"button",variant:o?"default":"outline",className:`h-auto p-4 flex flex-col items-start gap-2 text-left relative ${o?"bg-primary text-primary-foreground border-2 border-primary shadow-lg":"hover:bg-muted/50"} ${o?"outline outline-2 outline-primary":""}`,onClick:()=>a(s),children:[d.jsxDEV("div",{className:"flex items-center gap-2 w-full",children:[s.icon,d.jsxDEV("span",{className:"font-medium text-sm",children:s.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:233,columnNumber:17},void 0),o&&d.jsxDEV("button",{type:"button",onClick:l=>i(s,l),className:"ml-auto p-1 rounded-full hover:bg-primary-foreground/20 transition-colors","aria-label":`Remove ${s.label} filter`,children:d.jsxDEV(Ga,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:241,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:235,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:231,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-xs text-muted-foreground text-left",children:s.description},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:245,columnNumber:15},void 0)]},s.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:220,columnNumber:13},void 0)})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:215,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/filters/FilterPresets.tsx",lineNumber:207,columnNumber:5},void 0)},bw=[{id:"executive",title:"Executive Summary",description:"High-level overview with KPIs, trends, and critical issues for leadership",icon:gx,badge:"Best for monthly reports",color:"bg-blue-50 border-blue-200 hover:bg-blue-100",selectedColor:"bg-blue-100 border-blue-300",iconColor:"text-blue-600"},{id:"school-performance",title:"School Performance",description:"Compare schools, identify trends, and track performance over time",icon:dn,badge:"Best for comparisons",color:"bg-green-50 border-green-200 hover:bg-green-100",selectedColor:"bg-green-100 border-green-300",iconColor:"text-green-600"},{id:"category-analysis",title:"Category Analysis",description:"Deep dive into specific cleaning categories and problem areas",icon:o_,badge:"Best for detailed analysis",color:"bg-purple-50 border-purple-200 hover:bg-purple-100",selectedColor:"bg-purple-100 border-purple-300",iconColor:"text-purple-600"},{id:"issues",title:"Issues Report",description:"List of problems, critical issues, and items needing attention",icon:mn,badge:"Best for problem tracking",color:"bg-red-50 border-red-200 hover:bg-red-100",selectedColor:"bg-red-100 border-red-300",iconColor:"text-red-600"},{id:"custom",title:"Custom Report",description:"Build your own report with flexible sections and data combinations",icon:Bk,badge:"Best for specific needs",color:"bg-gray-50 border-gray-200 hover:bg-gray-100",selectedColor:"bg-gray-100 border-gray-300",iconColor:"text-gray-600"}],Q$=({selectedType:e,onTypeChange:t})=>{var r;return d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("div",{className:"text-center space-y-2",children:[d.jsxDEV("h3",{className:"text-lg font-semibold",children:"Choose Report Type"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:81,columnNumber:9},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Select the type of report that best fits your needs"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:82,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:80,columnNumber:7},void 0),d.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:bw.map(n=>{const a=n.icon,i=e===n.id;return d.jsxDEV(Le,{className:`cursor-pointer transition-all duration-200 ${i?`${n.selectedColor} ring-2 ring-primary/20`:`${n.color} hover:shadow-md`}`,onClick:()=>t(n.id),children:[d.jsxDEV(Ke,{className:"pb-3",children:d.jsxDEV("div",{className:"flex items-start justify-between",children:[d.jsxDEV("div",{className:"flex items-center gap-3",children:[d.jsxDEV("div",{className:`p-2 rounded-lg ${i?"bg-white":"bg-white/50"}`,children:d.jsxDEV(a,{className:`w-5 h-5 ${n.iconColor}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:106,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:105,columnNumber:21},void 0),d.jsxDEV("div",{children:[d.jsxDEV(Qe,{className:"text-base",children:n.title},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:109,columnNumber:23},void 0),d.jsxDEV(Ct,{variant:"secondary",className:"text-xs mt-1",children:n.badge},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:110,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:108,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:104,columnNumber:19},void 0),i&&d.jsxDEV("div",{className:"w-5 h-5 rounded-full bg-primary flex items-center justify-center",children:d.jsxDEV("div",{className:"w-2 h-2 rounded-full bg-white"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:120,columnNumber:23},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:119,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:103,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:102,columnNumber:15},void 0),d.jsxDEV(He,{className:"pt-0",children:d.jsxDEV(ft,{className:"text-sm leading-relaxed",children:n.description},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:126,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:125,columnNumber:15},void 0)]},n.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:93,columnNumber:13},void 0)})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:87,columnNumber:7},void 0),e&&d.jsxDEV("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:d.jsxDEV("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[d.jsxDEV(Sa,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:138,columnNumber:13},void 0),d.jsxDEV("span",{children:["Selected: ",d.jsxDEV("strong",{children:(r=bw.find(n=>n.id===e))==null?void 0:r.title},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:140,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:139,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:137,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:136,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ReportTypeSelector.tsx",lineNumber:79,columnNumber:5},void 0)},Z$=({config:e,onConfigChange:t,inspections:r,custodialNotes:n})=>{const a=j$({inspections:r,custodialNotes:n}),i=(o,l)=>{t(he(H({},e),{dataTypes:he(H({},e.dataTypes),{[o]:l})}))},s=(o,l)=>{t(he(H({},e),{[o]:l}))};return d.jsxDEV("div",{className:"space-y-6",children:[d.jsxDEV("div",{className:"text-center space-y-2",children:[d.jsxDEV("h3",{className:"text-lg font-semibold",children:"Select Data to Include"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:52,columnNumber:9},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Choose what data and content to include in your PDF report"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:53,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:51,columnNumber:7},void 0),d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("h4",{className:"text-sm font-medium text-foreground",children:"Data Types"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:60,columnNumber:9},void 0),d.jsxDEV(Le,{className:"hover:shadow-sm transition-shadow",children:d.jsxDEV(Ke,{className:"pb-3",children:d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("div",{className:"flex items-center gap-3",children:[d.jsxDEV(tr,{id:"inspections",checked:e.dataTypes.inspections,onCheckedChange:o=>i("inspections",!!o)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:66,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(Sa,{className:"w-4 h-4 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:72,columnNumber:19},void 0),d.jsxDEV("div",{children:[d.jsxDEV(Qe,{className:"text-sm",children:"Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:74,columnNumber:21},void 0),d.jsxDEV(ft,{className:"text-xs",children:"Individual inspection records with ratings and details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:75,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:73,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:71,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:65,columnNumber:15},void 0),d.jsxDEV(Ct,{variant:"secondary",className:"text-xs",children:[a.inspections," records"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:81,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:63,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:62,columnNumber:9},void 0),d.jsxDEV(Le,{className:"hover:shadow-sm transition-shadow",children:d.jsxDEV(Ke,{className:"pb-3",children:d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("div",{className:"flex items-center gap-3",children:[d.jsxDEV(tr,{id:"custodialNotes",checked:e.dataTypes.custodialNotes,onCheckedChange:o=>i("custodialNotes",!!o)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:92,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(qk,{className:"w-4 h-4 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:98,columnNumber:19},void 0),d.jsxDEV("div",{children:[d.jsxDEV(Qe,{className:"text-sm",children:"Custodial Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:100,columnNumber:21},void 0),d.jsxDEV(ft,{className:"text-xs",children:"Notes and comments from custodial staff"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:101,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:99,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:97,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:91,columnNumber:15},void 0),d.jsxDEV(Ct,{variant:"secondary",className:"text-xs",children:[a.custodialNotes," notes"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:89,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:88,columnNumber:9},void 0),d.jsxDEV(Le,{className:"hover:shadow-sm transition-shadow",children:d.jsxDEV(Ke,{className:"pb-3",children:d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("div",{className:"flex items-center gap-3",children:[d.jsxDEV(tr,{id:"images",checked:e.dataTypes.images,onCheckedChange:o=>i("images",!!o)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:118,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(zk,{className:"w-4 h-4 text-purple-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:124,columnNumber:19},void 0),d.jsxDEV("div",{children:[d.jsxDEV(Qe,{className:"text-sm",children:"Images"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:126,columnNumber:21},void 0),d.jsxDEV(ft,{className:"text-xs",children:"Photos and visual documentation from inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:127,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:125,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:117,columnNumber:15},void 0),d.jsxDEV(Ct,{variant:"secondary",className:"text-xs",children:[a.images," images (",a.totalSize,")"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:133,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:116,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:115,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:114,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:59,columnNumber:7},void 0),d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("h4",{className:"text-sm font-medium text-foreground",children:"Content Options"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:143,columnNumber:9},void 0),d.jsxDEV(Le,{className:"hover:shadow-sm transition-shadow",children:d.jsxDEV(Ke,{className:"pb-3",children:d.jsxDEV("div",{className:"flex items-center justify-between",children:d.jsxDEV("div",{className:"flex items-center gap-3",children:[d.jsxDEV(tr,{id:"includeCharts",checked:e.includeCharts,onCheckedChange:o=>s("includeCharts",!!o)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:149,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(gx,{className:"w-4 h-4 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:155,columnNumber:19},void 0),d.jsxDEV("div",{children:[d.jsxDEV(Qe,{className:"text-sm",children:"Charts & Visualizations"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:157,columnNumber:21},void 0),d.jsxDEV(ft,{className:"text-xs",children:"Include performance charts, trends, and data visualizations"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:158,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:156,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:154,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:148,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:147,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:146,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:145,columnNumber:9},void 0),d.jsxDEV(Le,{className:"hover:shadow-sm transition-shadow",children:d.jsxDEV(Ke,{className:"pb-3",children:d.jsxDEV("div",{className:"flex items-center justify-between",children:d.jsxDEV("div",{className:"flex items-center gap-3",children:[d.jsxDEV(tr,{id:"includeDetails",checked:e.includeDetails,onCheckedChange:o=>s("includeDetails",!!o)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:172,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(Hk,{className:"w-4 h-4 text-indigo-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:178,columnNumber:19},void 0),d.jsxDEV("div",{children:[d.jsxDEV(Qe,{className:"text-sm",children:"Individual Details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:180,columnNumber:21},void 0),d.jsxDEV(ft,{className:"text-xs",children:"Include full inspection details instead of summary only"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:181,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:179,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:177,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:171,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:170,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:169,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:168,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:142,columnNumber:7},void 0),d.jsxDEV("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg",children:[d.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[d.jsxDEV(So,{className:"w-4 h-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:195,columnNumber:11},void 0),d.jsxDEV("span",{className:"text-sm font-medium",children:"Selected Data Summary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:196,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:194,columnNumber:9},void 0),d.jsxDEV("div",{className:"grid grid-cols-2 gap-4 text-xs text-muted-foreground",children:[d.jsxDEV("div",{children:[e.dataTypes.inspections&&d.jsxDEV("div",{children:["â€¢ ",a.inspections," inspections"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:201,columnNumber:15},void 0),e.dataTypes.custodialNotes&&d.jsxDEV("div",{children:["â€¢ ",a.custodialNotes," notes"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:204,columnNumber:15},void 0),e.dataTypes.images&&d.jsxDEV("div",{children:["â€¢ ",a.images," images"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:207,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:199,columnNumber:11},void 0),d.jsxDEV("div",{children:[e.includeCharts&&d.jsxDEV("div",{children:"â€¢ Charts included"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:211,columnNumber:38},void 0),e.includeDetails&&d.jsxDEV("div",{children:"â€¢ Full details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:212,columnNumber:39},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:210,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:193,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/DataSelector.tsx",lineNumber:50,columnNumber:5},void 0)};function Hp(a){var i=a,{className:e,classNames:t,showOutsideDays:r=!0}=i,n=Ee(i,["className","classNames","showOutsideDays"]);return d.jsxDEV($k,H({showOutsideDays:r,className:Fe("p-3",e),classNames:H({months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Fe(Wo({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Fe(Wo({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible"},t),components:{IconLeft:l=>{var u=l,{className:s}=u,o=Ee(u,["className"]);return d.jsxDEV(Wk,H({className:Fe("h-4 w-4",s)},o),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/calendar.tsx",lineNumber:56,columnNumber:11},this)},IconRight:l=>{var u=l,{className:s}=u,o=Ee(u,["className"]);return d.jsxDEV(yc,H({className:Fe("h-4 w-4",s)},o),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/calendar.tsx",lineNumber:59,columnNumber:11},this)}}},n),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/calendar.tsx",lineNumber:17,columnNumber:5},this)}Hp.displayName="Calendar";const xc=Gk,gc=Yk,pl=W.forwardRef((i,a)=>{var s=i,{className:e,align:t="center",sideOffset:r=4}=s,n=Ee(s,["className","align","sideOffset"]);return d.jsxDEV(Xk,{children:d.jsxDEV(h_,H({ref:a,align:t,sideOffset:r,className:Fe("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",e)},n),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/popover.tsx",lineNumber:15,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/popover.tsx",lineNumber:14,columnNumber:3},void 0)});pl.displayName=h_.displayName;const J$=[{label:"Last 7 days",days:7},{label:"Last 30 days",days:30},{label:"Last 90 days",days:90},{label:"This year",days:365}],eW=[{id:"critical",label:"Critical",description:"Rating â‰¤ 2 stars"},{id:"needs-attention",label:"Needs Attention",description:"Rating â‰¤ 3 stars"},{id:"acceptable",label:"Acceptable",description:"Rating > 3 stars"}],tW=({config:e,onConfigChange:t,availableSchools:r,availableCategories:n})=>{const a=(c,m)=>{t(he(H({},e),{filters:he(H({},e.filters),{[c]:m})}))},i=c=>{const m=new Date,h=new Date;h.setDate(h.getDate()-c),a("dateRange",{from:h,to:m})},s=(c,m)=>{const h=e.filters[c],f=h.includes(m)?h.filter(x=>x!==m):[...h,m];a(c,f)},o=()=>{t(he(H({},e),{filters:{dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],ratingThreshold:0}}))},u=(()=>{let c=0;return(e.filters.dateRange.from||e.filters.dateRange.to)&&c++,e.filters.schools.length>0&&c++,e.filters.severityLevels.length>0&&c++,e.filters.categories.length>0&&c++,e.filters.ratingThreshold>0&&c++,c})();return d.jsxDEV("div",{className:"space-y-6",children:[d.jsxDEV("div",{className:"text-center space-y-2",children:[d.jsxDEV("h3",{className:"text-lg font-semibold",children:"Apply Filters"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:93,columnNumber:9},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Narrow down the data to include in your report"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:94,columnNumber:9},void 0),u>0&&d.jsxDEV("div",{className:"flex items-center justify-center gap-2",children:[d.jsxDEV(Ct,{variant:"secondary",className:"text-xs",children:[u," filter",u!==1?"s":""," active"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:99,columnNumber:13},void 0),d.jsxDEV(Ye,{variant:"ghost",size:"sm",onClick:o,className:"text-xs h-6 px-2",children:[d.jsxDEV(Ga,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:108,columnNumber:15},void 0),"Clear all"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:102,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:98,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:92,columnNumber:7},void 0),d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"pb-3",children:d.jsxDEV(Qe,{className:"text-sm flex items-center gap-2",children:[d.jsxDEV(yr,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:119,columnNumber:13},void 0),"Date Range"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:118,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:117,columnNumber:9},void 0),d.jsxDEV(He,{className:"space-y-4",children:[d.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:J$.map(c=>d.jsxDEV(Ye,{variant:"outline",size:"sm",onClick:()=>i(c.days),className:"text-xs",children:c.label},c.label,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:127,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:125,columnNumber:11},void 0),d.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"From"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:142,columnNumber:15},void 0),d.jsxDEV(xc,{children:[d.jsxDEV(gc,{asChild:!0,children:d.jsxDEV(Ye,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[d.jsxDEV(yr,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:148,columnNumber:21},void 0),e.filters.dateRange.from?Vu(e.filters.dateRange.from,"MMM dd, yyyy"):d.jsxDEV("span",{children:"Select date"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:152,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:147,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:146,columnNumber:17},void 0),d.jsxDEV(pl,{className:"w-auto p-0",children:d.jsxDEV(Hp,{mode:"single",selected:e.filters.dateRange.from||void 0,onSelect:c=>a("dateRange",he(H({},e.filters.dateRange),{from:c||null})),initialFocus:!0},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:157,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:156,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:145,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:141,columnNumber:13},void 0),d.jsxDEV("div",{children:[d.jsxDEV("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"To"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:171,columnNumber:15},void 0),d.jsxDEV(xc,{children:[d.jsxDEV(gc,{asChild:!0,children:d.jsxDEV(Ye,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[d.jsxDEV(yr,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:177,columnNumber:21},void 0),e.filters.dateRange.to?Vu(e.filters.dateRange.to,"MMM dd, yyyy"):d.jsxDEV("span",{children:"Select date"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:181,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:176,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:175,columnNumber:17},void 0),d.jsxDEV(pl,{className:"w-auto p-0",children:d.jsxDEV(Hp,{mode:"single",selected:e.filters.dateRange.to||void 0,onSelect:c=>a("dateRange",he(H({},e.filters.dateRange),{to:c||null})),initialFocus:!0},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:186,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:185,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:174,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:170,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:140,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:123,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:116,columnNumber:7},void 0),d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"pb-3",children:[d.jsxDEV(Qe,{className:"text-sm",children:"Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:205,columnNumber:11},void 0),d.jsxDEV(ft,{className:"text-xs",children:"Select specific schools to include"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:206,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:204,columnNumber:9},void 0),d.jsxDEV(He,{children:[d.jsxDEV("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:r.map(c=>d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:`school-${c}`,checked:e.filters.schools.includes(c),onCheckedChange:()=>s("schools",c)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:214,columnNumber:17},void 0),d.jsxDEV("label",{htmlFor:`school-${c}`,className:"text-sm",children:c},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:219,columnNumber:17},void 0)]},c,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:213,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:211,columnNumber:11},void 0),e.filters.schools.length>0&&d.jsxDEV("div",{className:"mt-2 flex flex-wrap gap-1",children:e.filters.schools.map(c=>d.jsxDEV(Ct,{variant:"secondary",className:"text-xs",children:c},c,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:228,columnNumber:17},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:226,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:210,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:203,columnNumber:7},void 0),d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"pb-3",children:[d.jsxDEV(Qe,{className:"text-sm",children:"Severity Levels"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:240,columnNumber:11},void 0),d.jsxDEV(ft,{className:"text-xs",children:"Filter by problem severity"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:241,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:239,columnNumber:9},void 0),d.jsxDEV(He,{children:d.jsxDEV("div",{className:"space-y-2",children:eW.map(c=>d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:`severity-${c.id}`,checked:e.filters.severityLevels.includes(c.id),onCheckedChange:()=>s("severityLevels",c.id)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:249,columnNumber:17},void 0),d.jsxDEV("div",{className:"flex-1",children:[d.jsxDEV("label",{htmlFor:`severity-${c.id}`,className:"text-sm font-medium",children:c.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:255,columnNumber:19},void 0),d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:c.description},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:258,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:254,columnNumber:17},void 0)]},c.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:248,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:246,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:245,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:238,columnNumber:7},void 0),d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"pb-3",children:[d.jsxDEV(Qe,{className:"text-sm",children:"Categories"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:269,columnNumber:11},void 0),d.jsxDEV(ft,{className:"text-xs",children:"Select specific cleaning categories"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:270,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:268,columnNumber:9},void 0),d.jsxDEV(He,{children:d.jsxDEV("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:n.map(c=>d.jsxDEV("div",{className:"flex items-center space-x-2",children:[d.jsxDEV(tr,{id:`category-${c.key}`,checked:e.filters.categories.includes(c.key),onCheckedChange:()=>s("categories",c.key)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:278,columnNumber:17},void 0),d.jsxDEV("label",{htmlFor:`category-${c.key}`,className:"text-sm",children:c.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:283,columnNumber:17},void 0)]},c.key,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:277,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:275,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:274,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:267,columnNumber:7},void 0),d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"pb-3",children:[d.jsxDEV(Qe,{className:"text-sm",children:"Rating Threshold"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:295,columnNumber:11},void 0),d.jsxDEV(ft,{className:"text-xs",children:"Only include inspections with average rating at or below this threshold"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:296,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:294,columnNumber:9},void 0),d.jsxDEV(He,{children:d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV(Wg,{value:[e.filters.ratingThreshold],onValueChange:([c])=>a("ratingThreshold",c),max:5,min:0,step:.5,className:"w-full"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:302,columnNumber:13},void 0),d.jsxDEV("div",{className:"flex justify-between text-xs text-muted-foreground",children:[d.jsxDEV("span",{children:"All ratings"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:311,columnNumber:15},void 0),d.jsxDEV("span",{className:"font-medium",children:e.filters.ratingThreshold>0?`â‰¤ ${e.filters.ratingThreshold} stars`:"No filter"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:312,columnNumber:15},void 0),d.jsxDEV("span",{children:"1 star only"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:318,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:310,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:301,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:300,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:293,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportFilters.tsx",lineNumber:91,columnNumber:5},void 0)},Bo=W.forwardRef((a,n)=>{var i=a,{className:e,value:t}=i,r=Ee(i,["className","value"]);return d.jsxDEV(p_,he(H({ref:n,className:Fe("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e)},r),{children:d.jsxDEV(Kk,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/progress.tsx",lineNumber:20,columnNumber:5},void 0)}),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/progress.tsx",lineNumber:12,columnNumber:3},void 0)});Bo.displayName=p_.displayName;const rW=({config:e,inspections:t,custodialNotes:r,onExport:n,isExporting:a=!1,exportProgress:i=0})=>{const s=zp(e),o=ro({inspections:t,custodialNotes:r},e),l=P$(e,{inspections:t,custodialNotes:r}),u=I$(e,{inspections:t,custodialNotes:r}),c=M$(e),h=(()=>{const f={executive:{name:"Executive Summary",icon:"ðŸ“Š",color:"bg-blue-100 text-blue-800"},"school-performance":{name:"School Performance",icon:"ðŸ«",color:"bg-green-100 text-green-800"},"category-analysis":{name:"Category Analysis",icon:"ðŸŽ¯",color:"bg-purple-100 text-purple-800"},issues:{name:"Issues Report",icon:"âš ï¸",color:"bg-red-100 text-red-800"},custom:{name:"Custom Report",icon:"âš™ï¸",color:"bg-gray-100 text-gray-800"}};return f[e.reportType]||f.custom})();return d.jsxDEV("div",{className:"space-y-6",children:[d.jsxDEV("div",{className:"text-center space-y-2",children:[d.jsxDEV("h3",{className:"text-lg font-semibold",children:"Review & Export"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:59,columnNumber:9},void 0),d.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Review your selections and generate the PDF report"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:60,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:58,columnNumber:7},void 0),a&&d.jsxDEV(Le,{className:"border-primary/20 bg-primary/5",children:d.jsxDEV(He,{className:"pt-6",children:d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(Ou,{className:"w-4 h-4 animate-spin text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:71,columnNumber:17},void 0),d.jsxDEV("span",{className:"text-sm font-medium",children:"Generating PDF..."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:72,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:70,columnNumber:15},void 0),d.jsxDEV(Bo,{value:i,className:"w-full"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:74,columnNumber:15},void 0),d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"This may take a moment for large reports with images and charts"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:69,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:68,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:67,columnNumber:9},void 0),d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"pb-3",children:d.jsxDEV(Qe,{className:"text-sm flex items-center gap-2",children:[d.jsxDEV(Sa,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:87,columnNumber:13},void 0),"Report Summary"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:86,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:85,columnNumber:9},void 0),d.jsxDEV(He,{className:"space-y-4",children:[d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("span",{className:"text-sm font-medium",children:"Report Type"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:94,columnNumber:13},void 0),d.jsxDEV(Ct,{className:h.color,children:[d.jsxDEV("span",{className:"mr-1",children:h.icon},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:96,columnNumber:15},void 0),h.name]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:95,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:93,columnNumber:11},void 0),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV("span",{className:"text-sm font-medium",children:"Data Included"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:103,columnNumber:13},void 0),d.jsxDEV("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.dataTypes.inspections&&d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(So,{className:"w-3 h-3 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:107,columnNumber:19},void 0),d.jsxDEV("span",{children:[o.inspections.length," inspections"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:108,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:106,columnNumber:17},void 0),e.dataTypes.custodialNotes&&d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(So,{className:"w-3 h-3 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:113,columnNumber:19},void 0),d.jsxDEV("span",{children:[o.custodialNotes.length," notes"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:114,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:112,columnNumber:17},void 0),e.dataTypes.images&&d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(So,{className:"w-3 h-3 text-purple-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:119,columnNumber:19},void 0),d.jsxDEV("span",{children:"Images included"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:120,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:118,columnNumber:17},void 0),e.includeCharts&&d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(So,{className:"w-3 h-3 text-orange-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:125,columnNumber:19},void 0),d.jsxDEV("span",{children:"Charts included"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:126,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:104,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:102,columnNumber:11},void 0),c.length>0&&d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV("span",{className:"text-sm font-medium flex items-center gap-2",children:[d.jsxDEV(f_,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:136,columnNumber:17},void 0),"Active Filters"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:135,columnNumber:15},void 0),d.jsxDEV("div",{className:"flex flex-wrap gap-1",children:c.map((f,x)=>d.jsxDEV(Ct,{variant:"secondary",className:"text-xs",children:f},x,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:141,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:139,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:134,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:91,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:84,columnNumber:7},void 0),d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"pb-3",children:d.jsxDEV(Qe,{className:"text-sm",children:"Export Details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:154,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:153,columnNumber:9},void 0),d.jsxDEV(He,{className:"space-y-3",children:d.jsxDEV("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("span",{className:"text-muted-foreground",children:"File Size"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:159,columnNumber:15},void 0),d.jsxDEV("span",{className:"font-medium",children:l},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:160,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:158,columnNumber:13},void 0),d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("span",{className:"text-muted-foreground",children:"Pages"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:163,columnNumber:15},void 0),d.jsxDEV("span",{className:"font-medium",children:u},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:164,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:162,columnNumber:13},void 0),d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("span",{className:"text-muted-foreground",children:"Records"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:167,columnNumber:15},void 0),d.jsxDEV("span",{className:"font-medium",children:o.totalRecords},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:168,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:166,columnNumber:13},void 0),d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("span",{className:"text-muted-foreground",children:"Schools"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:171,columnNumber:15},void 0),d.jsxDEV("span",{className:"font-medium",children:o.schools.length>0?o.schools.length:"All"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:172,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:170,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:157,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:156,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:152,columnNumber:7},void 0),!s.isValid&&d.jsxDEV(Le,{className:"border-red-200 bg-red-50",children:d.jsxDEV(He,{className:"pt-6",children:d.jsxDEV("div",{className:"flex items-start gap-2",children:[d.jsxDEV(Fr,{className:"w-4 h-4 text-red-600 mt-0.5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:185,columnNumber:15},void 0),d.jsxDEV("div",{className:"space-y-1",children:[d.jsxDEV("p",{className:"text-sm font-medium text-red-800",children:"Please fix the following issues:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:187,columnNumber:17},void 0),d.jsxDEV("ul",{className:"text-xs text-red-700 space-y-1",children:s.errors.map((f,x)=>d.jsxDEV("li",{children:["â€¢ ",f]},x,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:190,columnNumber:21},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:188,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:186,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:184,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:183,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:182,columnNumber:9},void 0),d.jsxDEV("div",{className:"flex justify-center",children:d.jsxDEV(Ye,{onClick:n,disabled:!s.isValid||a,size:"lg",className:"min-w-[200px]",children:a?d.jsxDEV(d.Fragment,{children:[d.jsxDEV(Ou,{className:"w-4 h-4 mr-2 animate-spin"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:209,columnNumber:15},void 0),"Generating..."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:208,columnNumber:13},void 0):d.jsxDEV(d.Fragment,{children:[d.jsxDEV(Ii,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:214,columnNumber:15},void 0),"Export PDF Report"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:213,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:201,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:200,columnNumber:7},void 0),!a&&s.isValid&&d.jsxDEV("div",{className:"flex items-center justify-center gap-2 text-sm text-green-700 bg-green-50 p-3 rounded-lg",children:[d.jsxDEV(Fn,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:224,columnNumber:11},void 0),d.jsxDEV("span",{children:"Ready to export! Click the button above to generate your PDF."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:225,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:223,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/ExportPreview.tsx",lineNumber:57,columnNumber:5},void 0)},tee=({inspections:e,custodialNotes:t,availableSchools:r,availableCategories:n,trigger:a,onExportComplete:i})=>{var S;const{toast:s}=Cc(),[o,l]=W.useState(!1),[u,c]=W.useState(1),[m,h]=W.useState(!1),[f,x]=W.useState(0),[p,g]=W.useState({reportType:"executive",dataTypes:{inspections:!0,custodialNotes:!1,images:!1},filters:{dateRange:{from:null,to:null},schools:[],severityLevels:[],categories:[],ratingThreshold:0},includeCharts:!0,includeDetails:!1}),v=[{id:1,title:"Report Type",description:"Choose your report type",isComplete:!1},{id:2,title:"Data Selection",description:"Select data to include",isComplete:!1},{id:3,title:"Filters",description:"Apply filters and criteria",isComplete:!1},{id:4,title:"Export",description:"Review and generate PDF",isComplete:!1}],C=W.useCallback((_,U)=>{},[]),b=()=>{u<v.length&&c(u+1)},N=()=>{u>1&&c(u-1)},F=_=>{g(_),zp(_),u===1&&_.reportType?C(1,!0):u===2&&(_.dataTypes.inspections||_.dataTypes.custodialNotes)?C(2,!0):u===3&&C(3,!0)},E=()=>bt(null,null,function*(){try{h(!0),x(0);const _=zp(p);if(!_.isValid){s({title:"Export Error",description:_.errors.join(", "),variant:"destructive"});return}const U=setInterval(()=>{x(K=>K>=90?(clearInterval(U),K):K+Math.random()*20)},200),R=ro({inspections:e,custodialNotes:t},p);let q;switch(p.reportType){case"issues":q=h3({inspections:R.inspections,custodialNotes:R.custodialNotes,startDate:p.filters.dateRange.from||void 0,endDate:p.filters.dateRange.to||void 0,schoolFilter:p.filters.schools.length===1?p.filters.schools[0]:void 0,activeFilters:[]});break;case"executive":q=$$({inspections:e,custodialNotes:t},p);break;case"school-performance":q=W$({inspections:e,custodialNotes:t},p);break;case"category-analysis":q=G$({inspections:e,custodialNotes:t},p);break;case"custom":q=Y$({inspections:e,custodialNotes:t},p);break;default:throw new Error("Invalid report type")}clearInterval(U),x(100);const M=URL.createObjectURL(q),Y=document.createElement("a");Y.href=M,Y.download=`custodial-report-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y),URL.revokeObjectURL(M),s({title:"Export Successful",description:"Your PDF report has been generated and downloaded."}),l(!1),i==null||i()}catch(_){console.error("Export failed:",_),s({title:"Export Failed",description:"There was an error generating your PDF report. Please try again.",variant:"destructive"})}finally{h(!1),x(0)}}),w=()=>{switch(u){case 1:return d.jsxDEV(Q$,{selectedType:p.reportType,onTypeChange:_=>F(he(H({},p),{reportType:_}))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:226,columnNumber:11},void 0);case 2:return d.jsxDEV(Z$,{config:p,onConfigChange:F,inspections:e,custodialNotes:t},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:233,columnNumber:11},void 0);case 3:return d.jsxDEV(tW,{config:p,onConfigChange:F,availableSchools:r,availableCategories:n},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:242,columnNumber:11},void 0);case 4:return d.jsxDEV(rW,{config:p,inspections:e,custodialNotes:t,onExport:E,isExporting:m,exportProgress:f},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:251,columnNumber:11},void 0);default:return null}};return d.jsxDEV(kc,{open:o,onOpenChange:l,children:[a&&d.jsxDEV("div",{onClick:_=>{_.preventDefault(),_.stopPropagation(),l(!0)},children:a},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:268,columnNumber:9},void 0),d.jsxDEV(yl,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[d.jsxDEV(Cl,{children:[d.jsxDEV(wl,{className:"flex items-center gap-2",children:[d.jsxDEV(Sa,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:281,columnNumber:13},void 0),"PDF Export Wizard"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:280,columnNumber:11},void 0),d.jsxDEV(El,{children:["Step ",u," of ",v.length,": ",(S=v[u-1])==null?void 0:S.description]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:284,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:279,columnNumber:9},void 0),d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("div",{className:"flex items-center justify-between",children:v.map((_,U)=>d.jsxDEV("div",{className:"flex items-center",children:[d.jsxDEV("div",{className:`
                  flex items-center justify-center w-8 h-8 rounded-full border-2 transition-colors
                  ${u>_.id?"bg-primary border-primary text-primary-foreground":u===_.id?"border-primary text-primary":"border-muted-foreground text-muted-foreground"}
                `,children:u>_.id?d.jsxDEV(Fn,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:304,columnNumber:21},void 0):d.jsxDEV("span",{className:"text-sm font-medium",children:_.id},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:306,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:294,columnNumber:17},void 0),U<v.length-1&&d.jsxDEV("div",{className:`
                    w-12 h-0.5 mx-2 transition-colors
                    ${u>_.id?"bg-primary":"bg-muted-foreground/30"}
                  `},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:310,columnNumber:19},void 0)]},_.id,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:293,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:291,columnNumber:11},void 0),d.jsxDEV("div",{className:"flex justify-between text-xs text-muted-foreground",children:v.map(_=>d.jsxDEV("div",{className:"text-center max-w-20",children:d.jsxDEV("div",{className:"font-medium",children:_.title},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:322,columnNumber:17},void 0)},_.id,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:321,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:319,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:290,columnNumber:9},void 0),d.jsxDEV("div",{className:"py-6",children:w()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:329,columnNumber:9},void 0),d.jsxDEV("div",{className:"flex items-center justify-between pt-4 border-t",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:d.jsxDEV(Ye,{variant:"outline",onClick:()=>l(!1),disabled:m,children:[d.jsxDEV(Ga,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:341,columnNumber:15},void 0),"Cancel"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:336,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:335,columnNumber:11},void 0),d.jsxDEV("div",{className:"flex items-center gap-2",children:[u>1&&d.jsxDEV(Ye,{variant:"outline",onClick:N,disabled:m,children:[d.jsxDEV(Qk,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:353,columnNumber:17},void 0),"Back"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:348,columnNumber:15},void 0),u<v.length&&d.jsxDEV(Ye,{onClick:b,disabled:m,children:["Next",d.jsxDEV(Zk,{className:"w-4 h-4 ml-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:364,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:359,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:346,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:334,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:278,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/reports/PDFExportWizard.tsx",lineNumber:266,columnNumber:5},void 0)},ree=Jk,nee=eF,nW=tF,p3=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(y_,he(H({className:Fe("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e)},t),{ref:r}),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:17,columnNumber:3},void 0)});p3.displayName=y_.displayName;const aW=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(nW,{children:[d.jsxDEV(p3,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:33,columnNumber:5},void 0),d.jsxDEV(x_,H({ref:r,className:Fe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:34,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:32,columnNumber:3},void 0)});aW.displayName=x_.displayName;const iW=r=>{var n=r,{className:e}=n,t=Ee(n,["className"]);return d.jsxDEV("div",H({className:Fe("flex flex-col space-y-2 text-center sm:text-left",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:50,columnNumber:3},void 0)};iW.displayName="AlertDialogHeader";const sW=r=>{var n=r,{className:e}=n,t=Ee(n,["className"]);return d.jsxDEV("div",H({className:Fe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:64,columnNumber:3},void 0)};sW.displayName="AlertDialogFooter";const oW=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(g_,H({ref:r,className:Fe("text-lg font-semibold",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:78,columnNumber:3},void 0)});oW.displayName=g_.displayName;const lW=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(v_,H({ref:r,className:Fe("text-sm text-muted-foreground",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:90,columnNumber:3},void 0)});lW.displayName=v_.displayName;const uW=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(N_,H({ref:r,className:Fe(Wo(),e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:103,columnNumber:3},void 0)});uW.displayName=N_.displayName;const cW=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(b_,H({ref:r,className:Fe(Wo({variant:"outline"}),"mt-2 sm:mt-0",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/alert-dialog.tsx",lineNumber:115,columnNumber:3},void 0)});cW.displayName=b_.displayName;var Nw=1,mW=.9,dW=.8,fW=.17,B0=.1,q0=.999,hW=.9999,pW=.99,xW=/[\\\/_+.#"@\[\(\{&]/,gW=/[\\\/_+.#"@\[\(\{&]/g,vW=/[\s-]/,x3=/[\s-]/g;function $p(e,t,r,n,a,i,s){if(i===t.length)return a===e.length?Nw:pW;var o=`${a},${i}`;if(s[o]!==void 0)return s[o];for(var l=n.charAt(i),u=r.indexOf(l,a),c=0,m,h,f,x;u>=0;)m=$p(e,t,r,n,u+1,i+1,s),m>c&&(u===a?m*=Nw:xW.test(e.charAt(u-1))?(m*=dW,f=e.slice(a,u-1).match(gW),f&&a>0&&(m*=Math.pow(q0,f.length))):vW.test(e.charAt(u-1))?(m*=mW,x=e.slice(a,u-1).match(x3),x&&a>0&&(m*=Math.pow(q0,x.length))):(m*=fW,a>0&&(m*=Math.pow(q0,u-a))),e.charAt(u)!==t.charAt(i)&&(m*=hW)),(m<B0&&r.charAt(u-1)===n.charAt(i+1)||n.charAt(i+1)===n.charAt(i)&&r.charAt(u-1)!==n.charAt(i))&&(h=$p(e,t,r,n,u+1,i+2,s),h*B0>m&&(m=h*B0)),m>c&&(c=m),u=r.indexOf(l,u+1);return s[o]=c,c}function yw(e){return e.toLowerCase().replace(x3," ")}function bW(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,$p(e,t,yw(e),yw(t),0,0,{})}var No='[cmdk-group=""]',z0='[cmdk-group-items=""]',NW='[cmdk-group-heading=""]',g3='[cmdk-item=""]',Cw=`${g3}:not([aria-disabled="true"])`,Wp="cmdk-item-select",hs="data-value",yW=(e,t,r)=>bW(e,t,r),v3=W.createContext(void 0),Il=()=>W.useContext(v3),b3=W.createContext(void 0),Gg=()=>W.useContext(b3),N3=W.createContext(void 0),y3=W.forwardRef((e,t)=>{let r=ps(()=>{var y,V;return{search:"",value:(V=(y=e.value)!=null?y:e.defaultValue)!=null?V:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=ps(()=>new Set),a=ps(()=>new Map),i=ps(()=>new Map),s=ps(()=>new Set),o=C3(e),j=e,{label:l,children:u,value:c,onValueChange:m,filter:h,shouldFilter:f,loop:x,disablePointerSelection:p=!1,vimBindings:g=!0}=j,v=Ee(j,["label","children","value","onValueChange","filter","shouldFilter","loop","disablePointerSelection","vimBindings"]),C=bs(),b=bs(),N=bs(),F=W.useRef(null),E=UW();Wi(()=>{if(c!==void 0){let y=c.trim();r.current.value=y,w.emit()}},[c]),Wi(()=>{E(6,M)},[]);let w=W.useMemo(()=>({subscribe:y=>(s.current.add(y),()=>s.current.delete(y)),snapshot:()=>r.current,setState:(y,V,I)=>{var G,ie,ae,Q;if(!Object.is(r.current[y],V)){if(r.current[y]=V,y==="search")q(),U(),E(1,R);else if(y==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Z=document.getElementById(N);Z?Z.focus():(G=document.getElementById(C))==null||G.focus()}if(E(7,()=>{var Z;r.current.selectedItemId=(Z=Y())==null?void 0:Z.id,w.emit()}),I||E(5,M),((ie=o.current)==null?void 0:ie.value)!==void 0){let Z=V!=null?V:"";(Q=(ae=o.current).onValueChange)==null||Q.call(ae,Z);return}}w.emit()}},emit:()=>{s.current.forEach(y=>y())}}),[]),S=W.useMemo(()=>({value:(y,V,I)=>{var G;V!==((G=i.current.get(y))==null?void 0:G.value)&&(i.current.set(y,{value:V,keywords:I}),r.current.filtered.items.set(y,_(V,I)),E(2,()=>{U(),w.emit()}))},item:(y,V)=>(n.current.add(y),V&&(a.current.has(V)?a.current.get(V).add(y):a.current.set(V,new Set([y]))),E(3,()=>{q(),U(),r.current.value||R(),w.emit()}),()=>{i.current.delete(y),n.current.delete(y),r.current.filtered.items.delete(y);let I=Y();E(4,()=>{q(),(I==null?void 0:I.getAttribute("id"))===y&&R(),w.emit()})}),group:y=>(a.current.has(y)||a.current.set(y,new Set),()=>{i.current.delete(y),a.current.delete(y)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:C,inputId:N,labelId:b,listInnerRef:F}),[]);function _(y,V){var I,G;let ie=(G=(I=o.current)==null?void 0:I.filter)!=null?G:yW;return y?ie(y,r.current.search,V):0}function U(){if(!r.current.search||o.current.shouldFilter===!1)return;let y=r.current.filtered.items,V=[];r.current.filtered.groups.forEach(G=>{let ie=a.current.get(G),ae=0;ie.forEach(Q=>{let Z=y.get(Q);ae=Math.max(Z,ae)}),V.push([G,ae])});let I=F.current;K().sort((G,ie)=>{var ae,Q;let Z=G.getAttribute("id"),ve=ie.getAttribute("id");return((ae=y.get(ve))!=null?ae:0)-((Q=y.get(Z))!=null?Q:0)}).forEach(G=>{let ie=G.closest(z0);ie?ie.appendChild(G.parentElement===ie?G:G.closest(`${z0} > *`)):I.appendChild(G.parentElement===I?G:G.closest(`${z0} > *`))}),V.sort((G,ie)=>ie[1]-G[1]).forEach(G=>{var ie;let ae=(ie=F.current)==null?void 0:ie.querySelector(`${No}[${hs}="${encodeURIComponent(G[0])}"]`);ae==null||ae.parentElement.appendChild(ae)})}function R(){let y=K().find(I=>I.getAttribute("aria-disabled")!=="true"),V=y==null?void 0:y.getAttribute(hs);w.setState("value",V||void 0)}function q(){var y,V,I,G;if(!r.current.search||o.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let ie=0;for(let ae of n.current){let Q=(V=(y=i.current.get(ae))==null?void 0:y.value)!=null?V:"",Z=(G=(I=i.current.get(ae))==null?void 0:I.keywords)!=null?G:[],ve=_(Q,Z);r.current.filtered.items.set(ae,ve),ve>0&&ie++}for(let[ae,Q]of a.current)for(let Z of Q)if(r.current.filtered.items.get(Z)>0){r.current.filtered.groups.add(ae);break}r.current.filtered.count=ie}function M(){var y,V,I;let G=Y();G&&(((y=G.parentElement)==null?void 0:y.firstChild)===G&&((I=(V=G.closest(No))==null?void 0:V.querySelector(NW))==null||I.scrollIntoView({block:"nearest"})),G.scrollIntoView({block:"nearest"}))}function Y(){var y;return(y=F.current)==null?void 0:y.querySelector(`${g3}[aria-selected="true"]`)}function K(){var y;return Array.from(((y=F.current)==null?void 0:y.querySelectorAll(Cw))||[])}function de(y){let V=K()[y];V&&w.setState("value",V.getAttribute(hs))}function pe(y){var V;let I=Y(),G=K(),ie=G.findIndex(Q=>Q===I),ae=G[ie+y];(V=o.current)!=null&&V.loop&&(ae=ie+y<0?G[G.length-1]:ie+y===G.length?G[0]:G[ie+y]),ae&&w.setState("value",ae.getAttribute(hs))}function Ae(y){let V=Y(),I=V==null?void 0:V.closest(No),G;for(;I&&!G;)I=y>0?kW(I,No):FW(I,No),G=I==null?void 0:I.querySelector(Cw);G?w.setState("value",G.getAttribute(hs)):pe(y)}let Ne=()=>de(K().length-1),k=y=>{y.preventDefault(),y.metaKey?Ne():y.altKey?Ae(1):pe(1)},le=y=>{y.preventDefault(),y.metaKey?de(0):y.altKey?Ae(-1):pe(-1)};return W.createElement(ai.div,he(H({ref:t,tabIndex:-1},v),{"cmdk-root":"",onKeyDown:y=>{var V;(V=v.onKeyDown)==null||V.call(v,y);let I=y.nativeEvent.isComposing||y.keyCode===229;if(!(y.defaultPrevented||I))switch(y.key){case"n":case"j":{g&&y.ctrlKey&&k(y);break}case"ArrowDown":{k(y);break}case"p":case"k":{g&&y.ctrlKey&&le(y);break}case"ArrowUp":{le(y);break}case"Home":{y.preventDefault(),de(0);break}case"End":{y.preventDefault(),Ne();break}case"Enter":{y.preventDefault();let G=Y();if(G){let ie=new Event(Wp);G.dispatchEvent(ie)}}}}}),W.createElement("label",{"cmdk-label":"",htmlFor:S.inputId,id:S.labelId,style:OW},l),em(e,y=>W.createElement(b3.Provider,{value:w},W.createElement(v3.Provider,{value:S},y))))}),CW=W.forwardRef((e,t)=>{var r,n;let a=bs(),i=W.useRef(null),s=W.useContext(N3),o=Il(),l=C3(e),u=(n=(r=l.current)==null?void 0:r.forceMount)!=null?n:s==null?void 0:s.forceMount;Wi(()=>{if(!u)return o.item(a,s==null?void 0:s.id)},[u]);let c=w3(a,i,[e.value,e.children,i],e.keywords),m=Gg(),h=ri(w=>w.value&&w.value===c.current),f=ri(w=>u||o.filter()===!1?!0:w.search?w.filtered.items.get(a)>0:!0);W.useEffect(()=>{let w=i.current;if(!(!w||e.disabled))return w.addEventListener(Wp,x),()=>w.removeEventListener(Wp,x)},[f,e.onSelect,e.disabled]);function x(){var w,S;p(),(S=(w=l.current).onSelect)==null||S.call(w,c.current)}function p(){m.setState("value",c.current,!0)}if(!f)return null;let E=e,{disabled:g,value:v,onSelect:C,forceMount:b,keywords:N}=E,F=Ee(E,["disabled","value","onSelect","forceMount","keywords"]);return W.createElement(ai.div,he(H({ref:$o(i,t)},F),{id:a,"cmdk-item":"",role:"option","aria-disabled":!!g,"aria-selected":!!h,"data-disabled":!!g,"data-selected":!!h,onPointerMove:g||o.getDisablePointerSelection()?void 0:p,onClick:g?void 0:x}),e.children)}),wW=W.forwardRef((e,t)=>{let f=e,{heading:r,children:n,forceMount:a}=f,i=Ee(f,["heading","children","forceMount"]),s=bs(),o=W.useRef(null),l=W.useRef(null),u=bs(),c=Il(),m=ri(x=>a||c.filter()===!1?!0:x.search?x.filtered.groups.has(s):!0);Wi(()=>c.group(s),[]),w3(s,o,[e.value,e.heading,l]);let h=W.useMemo(()=>({id:s,forceMount:a}),[a]);return W.createElement(ai.div,he(H({ref:$o(o,t)},i),{"cmdk-group":"",role:"presentation",hidden:m?void 0:!0}),r&&W.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:u},r),em(e,x=>W.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?u:void 0},W.createElement(N3.Provider,{value:h},x))))}),EW=W.forwardRef((e,t)=>{let s=e,{alwaysRender:r}=s,n=Ee(s,["alwaysRender"]),a=W.useRef(null),i=ri(o=>!o.search);return!r&&!i?null:W.createElement(ai.div,he(H({ref:$o(a,t)},n),{"cmdk-separator":"",role:"separator"}))}),_W=W.forwardRef((e,t)=>{let u=e,{onValueChange:r}=u,n=Ee(u,["onValueChange"]),a=e.value!=null,i=Gg(),s=ri(c=>c.search),o=ri(c=>c.selectedItemId),l=Il();return W.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),W.createElement(ai.input,he(H({ref:t},n),{"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:a?e.value:s,onChange:c=>{a||i.setState("search",c.target.value),r==null||r(c.target.value)}}))}),SW=W.forwardRef((e,t)=>{let u=e,{children:r,label:n="Suggestions"}=u,a=Ee(u,["children","label"]),i=W.useRef(null),s=W.useRef(null),o=ri(c=>c.selectedItemId),l=Il();return W.useEffect(()=>{if(s.current&&i.current){let c=s.current,m=i.current,h,f=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let x=c.offsetHeight;m.style.setProperty("--cmdk-list-height",x.toFixed(1)+"px")})});return f.observe(c),()=>{cancelAnimationFrame(h),f.unobserve(c)}}},[]),W.createElement(ai.div,he(H({ref:$o(i,t)},a),{"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":n,id:l.listId}),em(e,c=>W.createElement("div",{ref:$o(s,l.listInnerRef),"cmdk-list-sizer":""},c)))}),TW=W.forwardRef((e,t)=>{let l=e,{open:r,onOpenChange:n,overlayClassName:a,contentClassName:i,container:s}=l,o=Ee(l,["open","onOpenChange","overlayClassName","contentClassName","container"]);return W.createElement(QE,{open:r,onOpenChange:n},W.createElement(ZE,{container:s},W.createElement(Nx,{"cmdk-overlay":"",className:a}),W.createElement(bx,{"aria-label":e.label,"cmdk-dialog":"",className:i},W.createElement(y3,H({ref:t},o)))))}),DW=W.forwardRef((e,t)=>ri(r=>r.filtered.count===0)?W.createElement(ai.div,he(H({ref:t},e),{"cmdk-empty":"",role:"presentation"})):null),AW=W.forwardRef((e,t)=>{let s=e,{progress:r,children:n,label:a="Loading..."}=s,i=Ee(s,["progress","children","label"]);return W.createElement(ai.div,he(H({ref:t},i),{"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a}),em(e,o=>W.createElement("div",{"aria-hidden":!0},o)))}),qr=Object.assign(y3,{List:SW,Item:CW,Input:_W,Group:wW,Separator:EW,Dialog:TW,Empty:DW,Loading:AW});function kW(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function FW(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function C3(e){let t=W.useRef(e);return Wi(()=>{t.current=e}),t}var Wi=typeof window=="undefined"?W.useEffect:W.useLayoutEffect;function ps(e){let t=W.useRef();return t.current===void 0&&(t.current=e()),t}function ri(e){let t=Gg(),r=()=>e(t.snapshot());return W.useSyncExternalStore(t.subscribe,r,r)}function w3(e,t,r,n=[]){let a=W.useRef(),i=Il();return Wi(()=>{var s;let o=(()=>{var u;for(let c of r){if(typeof c=="string")return c.trim();if(typeof c=="object"&&"current"in c)return c.current?(u=c.current.textContent)==null?void 0:u.trim():a.current}})(),l=n.map(u=>u.trim());i.value(e,o,l),(s=t.current)==null||s.setAttribute(hs,o),a.current=o}),a}var UW=()=>{let[e,t]=W.useState(),r=ps(()=>new Map);return Wi(()=>{r.current.forEach(n=>n()),r.current=new Map},[e]),(n,a)=>{r.current.set(n,a),t({})}};function RW(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function em({asChild:e,children:t},r){return e&&W.isValidElement(t)?W.cloneElement(RW(t),{ref:t.ref},r(t.props.children)):r(t)}var OW={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const VW=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(qr,H({ref:r,className:Fe("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:13,columnNumber:3},void 0)});VW.displayName=qr.displayName;const PW=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[d.jsxDEV(rF,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:41,columnNumber:5},void 0),d.jsxDEV(qr.Input,H({ref:r,className:Fe("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:42,columnNumber:5},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:40,columnNumber:3},void 0)});PW.displayName=qr.Input.displayName;const IW=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(qr.List,H({ref:r,className:Fe("max-h-[300px] overflow-y-auto overflow-x-hidden",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:59,columnNumber:3},void 0)});IW.displayName=qr.List.displayName;const MW=W.forwardRef((e,t)=>d.jsxDEV(qr.Empty,H({ref:t,className:"py-6 text-center text-sm"},e),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:72,columnNumber:3},void 0));MW.displayName=qr.Empty.displayName;const jW=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(qr.Group,H({ref:r,className:Fe("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:85,columnNumber:3},void 0)});jW.displayName=qr.Group.displayName;const LW=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(qr.Separator,H({ref:r,className:Fe("-mx-1 h-px bg-border",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:101,columnNumber:3},void 0)});LW.displayName=qr.Separator.displayName;const BW=W.forwardRef((n,r)=>{var a=n,{className:e}=a,t=Ee(a,["className"]);return d.jsxDEV(qr.Item,H({ref:r,className:Fe("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e)},t),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/command.tsx",lineNumber:113,columnNumber:3},void 0)});BW.displayName=qr.Item.displayName;class aee extends vs.Component{constructor(r){super(r);et(this,"handleRetry",()=>{window.location.reload()});et(this,"handleClearData",()=>{try{localStorage.clear(),console.log("LocalStorage cleared successfully")}catch(r){console.error("Failed to clear localStorage:",r)}window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){console.error("LocalStorage Error Boundary caught an error:",r),console.error("Component Stack:",n.componentStack),this.setState({errorInfo:n})}render(){const{hasError:r,error:n,errorInfo:a}=this.state,{children:i,fallback:s}=this.props;return r?s||d.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:d.jsxDEV("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[d.jsxDEV("div",{className:"flex justify-center mb-4",children:d.jsxDEV("div",{className:"rounded-full bg-red-100 p-3",children:d.jsxDEV("svg",{className:"h-8 w-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:129,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:123,columnNumber:17},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:122,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:121,columnNumber:13},this),d.jsxDEV("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:"Something Went Wrong"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:140,columnNumber:13},this),d.jsxDEV("p",{className:"text-gray-600 text-center mb-6",children:"We encountered an issue saving your preferences. This might happen if your browser's storage is full or if you're using private browsing mode."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:143,columnNumber:13},this),d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV("button",{onClick:this.handleRetry,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors",children:"Retry"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:150,columnNumber:15},this),d.jsxDEV("button",{onClick:this.handleClearData,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-4 rounded-md transition-colors",children:"Clear Saved Data & Retry"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:156,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:149,columnNumber:13},this),n&&d.jsxDEV("details",{className:"mt-6",children:[d.jsxDEV("summary",{className:"cursor-pointer text-sm text-gray-500 hover:text-gray-700",children:"View Technical Details"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:167,columnNumber:17},this),d.jsxDEV("div",{className:"mt-3 p-3 bg-gray-100 rounded text-xs font-mono overflow-auto max-h-48",children:[d.jsxDEV("div",{className:"text-red-600 font-semibold mb-2",children:[n.name,": ",n.message]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:171,columnNumber:19},this),a&&d.jsxDEV("div",{className:"text-gray-600 whitespace-pre-wrap",children:a.componentStack},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:175,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:170,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:166,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:119,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/errors/LocalStorageErrorBoundary.tsx",lineNumber:118,columnNumber:9},this):i}}const ww={WARNING:80,CRITICAL:95};function iee(e={}){const{onWarning:t,checkInterval:r=3e4,checkOnMount:n=!0}=e,a=W.useRef(new Set),i=()=>bt(null,null,function*(){try{const s=yield Ut.getQuotaInfo();if(!s||s.percentage===0)return;const{percentage:o,usage:l,quota:u}=s,c=m=>{const h=m/1048576;return h<1?`${(m/1024).toFixed(1)} KB`:`${h.toFixed(1)} MB`};if(o>=ww.CRITICAL){const m=`critical-${Math.floor(o)}`;a.current.has(m)||(console.warn(`[Storage Quota Monitor] CRITICAL: Storage at ${o.toFixed(1)}% capacity`),t==null||t(`Your browser storage is nearly full (${o.toFixed(1)}% used). Using ${c(l)} of ${c(u)} available. Please clear old data or browser cache to continue using this feature.`,o,"critical"),a.current.add(m))}else if(o>=ww.WARNING){const m=`warning-${Math.floor(o/5)*5}`;a.current.has(m)||(console.warn(`[Storage Quota Monitor] WARNING: Storage at ${o.toFixed(1)}% capacity`),t==null||t(`Your browser storage is ${o.toFixed(1)}% full. Using ${c(l)} of ${c(u)} available. Consider clearing old data to ensure smooth operation.`,o,"warning"),a.current.add(m))}}catch(s){console.error("[Storage Quota Monitor] Failed to check quota:",s)}});return W.useEffect(()=>{n&&i();const s=setInterval(i,r);return()=>{clearInterval(s)}},[r,n,t]),{checkQuota:i}}const see=nF,oee=aF,lee=iF,qW=W.forwardRef((a,n)=>{var i=a,{className:e,sideOffset:t=4}=i,r=Ee(i,["className","sideOffset"]);return d.jsxDEV(C_,H({ref:n,sideOffset:t,className:Fe("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e)},r),void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/tooltip.tsx",lineNumber:18,columnNumber:3},void 0)});qW.displayName=C_.displayName;function uee({children:e,className:t="",title:r}){return d.jsxDEV("div",{className:`w-full max-w-full bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden mx-2 sm:mx-0 ${t}`,children:[r&&d.jsxDEV("div",{className:"px-4 sm:px-6 py-4 bg-gradient-to-r from-amber-100 to-orange-100 border-b border-gray-200",children:d.jsxDEV("h3",{className:"text-lg sm:text-xl font-semibold text-amber-900 leading-tight",children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/mobile-card.tsx",lineNumber:15,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/mobile-card.tsx",lineNumber:14,columnNumber:9},this),d.jsxDEV("div",{className:"p-4 sm:p-6 space-y-4",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/mobile-card.tsx",lineNumber:18,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/mobile-card.tsx",lineNumber:12,columnNumber:5},this)}function cee({categoryLabel:e,criteria:t}){return d.jsxDEV(xc,{children:[d.jsxDEV(gc,{asChild:!0,children:d.jsxDEV(Ye,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 ml-2 hover:bg-blue-100 rounded-full",type:"button",children:[d.jsxDEV(w_,{className:"h-4 w-4 text-blue-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:22,columnNumber:11},this),d.jsxDEV("span",{className:"sr-only",children:["View criteria for ",e]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:23,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:16,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:15,columnNumber:7},this),d.jsxDEV(pl,{className:"w-96 max-h-96 overflow-y-auto",align:"start",children:d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV("div",{className:"font-semibold text-sm border-b pb-2",children:[e," - Rating Criteria"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:28,columnNumber:11},this),d.jsxDEV("div",{className:"space-y-3",children:[5,4,3,2,1].map(r=>d.jsxDEV(Le,{className:"border-l-4",style:{borderLeftColor:r>=4?"#10B981":r>=3?"#F59E0B":"#EF4444"},children:d.jsxDEV(He,{className:"p-3",children:[d.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[d.jsxDEV("div",{className:"flex",children:Array.from({length:5},(n,a)=>d.jsxDEV(Ya,{className:`w-3 h-3 ${a<r?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},a,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:40,columnNumber:25},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:38,columnNumber:21},this),d.jsxDEV(Ct,{variant:"secondary",className:"text-xs",children:["Rating ",r]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:50,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:37,columnNumber:19},this),d.jsxDEV("p",{className:"text-xs text-gray-700 leading-relaxed",children:t[r]},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:54,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:36,columnNumber:17},this)},r,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:33,columnNumber:15},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:31,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:27,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:26,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:14,columnNumber:5},this)}function mee({categoryLabel:e,criteria:t}){return d.jsxDEV(xc,{children:[d.jsxDEV(gc,{asChild:!0,children:d.jsxDEV(Ye,{variant:"outline",size:"sm",className:"w-full mt-2 text-xs",type:"button",children:[d.jsxDEV(w_,{className:"h-3 w-3 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:77,columnNumber:11},this),"View Rating Guide"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:71,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:70,columnNumber:7},this),d.jsxDEV(pl,{className:"w-80 max-h-80 overflow-y-auto",align:"center",children:d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV("div",{className:"font-semibold text-sm border-b pb-2",children:[e," - Rating Criteria"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:83,columnNumber:11},this),d.jsxDEV("div",{className:"space-y-3",children:[5,4,3,2,1].map(r=>d.jsxDEV(Le,{className:"border-l-4",style:{borderLeftColor:r>=4?"#10B981":r>=3?"#F59E0B":"#EF4444"},children:d.jsxDEV(He,{className:"p-3",children:[d.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[d.jsxDEV("div",{className:"flex",children:Array.from({length:5},(n,a)=>d.jsxDEV(Ya,{className:`w-3 h-3 ${a<r?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},a,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:95,columnNumber:25},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:93,columnNumber:21},this),d.jsxDEV(Ct,{variant:"secondary",className:"text-xs",children:["Rating ",r]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:105,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:92,columnNumber:19},this),d.jsxDEV("p",{className:"text-xs text-gray-700 leading-relaxed",children:t[r]},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:109,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:91,columnNumber:17},this)},r,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:88,columnNumber:15},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:86,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:82,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:81,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/category-criteria-helper.tsx",lineNumber:69,columnNumber:5},this)}function zW({onBack:e}){const t=r=>d.jsxDEV("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(n=>d.jsxDEV(Ya,{className:`w-5 h-5 ${n<=r?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},n,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:17,columnNumber:11},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:15,columnNumber:7},this);return d.jsxDEV("div",{className:"container mx-auto p-6 max-w-6xl space-y-6",children:[d.jsxDEV("div",{className:"mb-6",children:[e&&d.jsxDEV("div",{className:"flex justify-start mb-4",children:d.jsxDEV(Ye,{variant:"outline",onClick:e,className:"flex-shrink-0",children:"â† Back"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:36,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:35,columnNumber:11},this),d.jsxDEV("div",{className:"text-center space-y-4",children:[d.jsxDEV("div",{className:"flex items-center justify-center gap-3",children:[d.jsxDEV(w1,{className:"w-8 h-8 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:44,columnNumber:13},this),d.jsxDEV("h1",{className:"text-3xl font-bold text-primary",children:"Rating Criteria Reference"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:45,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:43,columnNumber:11},this),d.jsxDEV("p",{className:"text-lg text-muted-foreground max-w-3xl mx-auto",children:"Complete reference guide for custodial inspection ratings. Use this to understand what each star rating means and the specific criteria for each category."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:47,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:42,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:33,columnNumber:7},this),d.jsxDEV(Le,{className:"border-2 border-primary/20",children:[d.jsxDEV(Ke,{className:"bg-primary/5",children:[d.jsxDEV(Qe,{className:"flex items-center gap-2",children:[d.jsxDEV(Ya,{className:"w-6 h-6 text-primary"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:57,columnNumber:13},this),"General Rating Scale"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:56,columnNumber:11},this),d.jsxDEV(ft,{children:"This 5-star scale applies to all inspection categories"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:60,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:55,columnNumber:9},this),d.jsxDEV(He,{className:"p-6",children:d.jsxDEV("div",{className:"grid gap-4",children:nv.map((r,n)=>d.jsxDEV("div",{className:"flex items-start gap-4 p-4 rounded-lg border border-gray-200 bg-gray-50",children:[d.jsxDEV("div",{className:"flex-shrink-0",children:t(n+1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:68,columnNumber:17},this),d.jsxDEV("div",{className:"flex-1",children:[d.jsxDEV("div",{className:"font-semibold text-lg text-gray-900 mb-1",children:r.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:72,columnNumber:19},this),d.jsxDEV("div",{className:"text-gray-700",children:r.description},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:75,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:71,columnNumber:17},this)]},n,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:67,columnNumber:15},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:65,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:64,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:54,columnNumber:7},this),d.jsxDEV("div",{className:"space-y-6",children:[d.jsxDEV("div",{className:"text-center",children:[d.jsxDEV("h2",{className:"text-2xl font-bold text-primary mb-2",children:"Category-Specific Criteria"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:88,columnNumber:11},this),d.jsxDEV("p",{className:"text-muted-foreground",children:"Detailed criteria for each inspection category showing what qualifies for each star rating"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:89,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:87,columnNumber:9},this),d.jsxDEV("div",{className:"grid gap-6",children:mR.map(r=>d.jsxDEV(Le,{className:"border border-gray-200",children:[d.jsxDEV(Ke,{className:"bg-accent/10",children:[d.jsxDEV(Qe,{className:"text-xl text-primary",children:r.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:98,columnNumber:17},this),d.jsxDEV(ft,{children:["Specific criteria for rating ",r.label.toLowerCase()," cleanliness and maintenance"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:101,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:97,columnNumber:15},this),d.jsxDEV(He,{className:"p-6",children:r.criteria?d.jsxDEV("div",{className:"space-y-4",children:Object.entries(r.criteria).map(([n,a])=>{var i;return d.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4",children:[d.jsxDEV("div",{className:"flex items-center gap-3 mb-3",children:[t(parseInt(n)),d.jsxDEV(Ct,{variant:"outline",className:"text-sm",children:[parseInt(n)," Star",parseInt(n)>1?"s":""]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:112,columnNumber:27},this),d.jsxDEV("span",{className:"font-medium text-primary",children:(i=nv[parseInt(n)-1])==null?void 0:i.label},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:115,columnNumber:27},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:110,columnNumber:25},this),d.jsxDEV("div",{className:"text-gray-700 leading-relaxed",children:a},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:119,columnNumber:25},this)]},n,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:109,columnNumber:23},this)})},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:107,columnNumber:19},this):d.jsxDEV("div",{className:"text-center py-8 text-muted-foreground",children:[d.jsxDEV(w1,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:127,columnNumber:21},this),d.jsxDEV("p",{children:"Detailed criteria for this category will be available soon."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:128,columnNumber:21},this),d.jsxDEV("p",{className:"text-sm mt-1",children:"Use the general rating scale above for guidance."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:129,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:126,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:105,columnNumber:15},this)]},r.key,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:96,columnNumber:13},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:94,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:86,columnNumber:7},this),d.jsxDEV(Le,{className:"border-2 border-blue-200 bg-blue-50",children:[d.jsxDEV(Ke,{children:d.jsxDEV(Qe,{className:"text-blue-900",children:"How to Use This Reference"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:141,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:140,columnNumber:9},this),d.jsxDEV(He,{className:"space-y-3 text-blue-800",children:[d.jsxDEV("div",{children:[d.jsxDEV("strong",{children:"During Inspections:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:145,columnNumber:13},this)," Reference this page to ensure consistent and accurate ratings across all categories."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:144,columnNumber:11},this),d.jsxDEV("div",{children:[d.jsxDEV("strong",{children:"For Training:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:148,columnNumber:13},this)," Use this as a training guide for new inspectors to understand rating standards."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:147,columnNumber:11},this),d.jsxDEV("div",{children:[d.jsxDEV("strong",{children:"For Consistency:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:151,columnNumber:13},this)," When multiple inspectors are involved, this ensures everyone applies the same standards."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:150,columnNumber:11},this),d.jsxDEV("div",{children:[d.jsxDEV("strong",{children:"For Documentation:"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:154,columnNumber:13},this)," Print or bookmark this page for offline reference during field inspections."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:153,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:143,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:139,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/pages/rating-criteria.tsx",lineNumber:31,columnNumber:5},this)}const HW=Object.freeze(Object.defineProperty({__proto__:null,default:zW},Symbol.toStringTag,{value:"Module"})),$W=({size:e="md",className:t,text:r="Loading..."})=>{const n={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};return d.jsxDEV("div",{className:Fe("flex flex-col items-center justify-center p-8",t),children:[d.jsxDEV(Ou,{className:Fe("animate-spin text-primary",n[e])},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/loading-spinner.tsx",lineNumber:24,columnNumber:7},void 0),r&&d.jsxDEV("p",{className:"mt-2 text-sm text-muted-foreground",children:r},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/loading-spinner.tsx",lineNumber:26,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/ui/loading-spinner.tsx",lineNumber:23,columnNumber:5},void 0)},dee=$W,WW=[{value:"ASA",label:"ASA"},{value:"LCA",label:"LCA"},{value:"GWC",label:"GWC"},{value:"OA",label:"OA"},{value:"CBR",label:"CBR"},{value:"WLC",label:"WLC"}],GW=["January","February","March","April","May","June","July","August","September","October","November","December"];function fee({onUploadSuccess:e}){const{toast:t}=Cc(),[r,n]=W.useState({school:"",month:"",year:new Date().getFullYear().toString(),notes:"",uploadedBy:""}),[a,i]=W.useState(null),[s,o]=W.useState(!1),[l,u]=W.useState({}),c=f=>{var p;const x=(p=f.target.files)==null?void 0:p[0];if(x){if(u(g=>he(H({},g),{pdfFile:""})),x.type!=="application/pdf"){const g="Only PDF files are allowed. Please select a valid PDF file.";u(v=>he(H({},v),{pdfFile:g})),t({variant:"destructive",title:"Invalid File Type",description:g}),f.target.value="",i(null);return}if(x.size>10*1024*1024){const g="PDF file must be less than 10MB. Please choose a smaller file.";u(v=>he(H({},v),{pdfFile:g})),t({variant:"destructive",title:"File Too Large",description:g}),f.target.value="",i(null);return}i(x),t({title:"âœ… PDF Selected",description:`${x.name} (${(x.size/1024/1024).toFixed(2)} MB) - Ready to upload`})}},m=()=>{const f={};if(r.school||(f.school="School is required"),r.month||(f.month="Month is required"),!r.year)f.year="Year is required";else{const x=parseInt(r.year);(isNaN(x)||x<2020||x>2100)&&(f.year="Please enter a valid year between 2020 and 2100")}return a||(f.pdfFile="PDF file is required"),u(f),Object.keys(f).length===0},h=f=>bt(null,null,function*(){if(f.preventDefault(),!!m()){o(!0);try{const x=new FormData;x.append("school",r.school),x.append("month",r.month),x.append("year",r.year),a&&x.append("pdf",a),r.notes&&x.append("notes",r.notes),r.uploadedBy&&x.append("uploadedBy",r.uploadedBy);const p=yield fetch("/api/monthly-feedback",{method:"POST",body:x});if(p.ok){const g=yield p.json();t({title:"âœ… Upload Successful!",description:`Monthly feedback for ${r.month} ${r.year} has been uploaded.${g.hasExtractedText?" Text extracted successfully.":" (Text extraction unavailable)"}`,duration:5e3}),n({school:"",month:"",year:new Date().getFullYear().toString(),notes:"",uploadedBy:""}),i(null),u({});const v=document.getElementById("pdfFile");v&&(v.value=""),e()}else{const g=yield p.json().catch(()=>({message:"Unknown error"}));t({variant:"destructive",title:"Upload Failed",description:g.message||"Failed to upload monthly feedback."})}}catch(x){console.error("Error uploading feedback:",x),t({variant:"destructive",title:"Network Error",description:"Unable to connect to the server. Please check your connection."})}finally{o(!1)}}});return d.jsxDEV("form",{onSubmit:h,children:d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{children:[d.jsxDEV(Qe,{children:"Upload Monthly Feedback"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:181,columnNumber:11},this),d.jsxDEV(ft,{children:"Upload a monthly custodial feedback email PDF"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:182,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:180,columnNumber:9},this),d.jsxDEV(He,{className:"space-y-4",children:[d.jsxDEV("div",{"aria-live":"polite",className:"sr-only"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:186,columnNumber:11},this),d.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{htmlFor:"school",children:["School ",d.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:189,columnNumber:46},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:189,columnNumber:15},this),d.jsxDEV(Fo,{value:r.school,onValueChange:f=>n(x=>he(H({},x),{school:f})),children:[d.jsxDEV(Cs,{className:l.school?"border-red-500":"",children:d.jsxDEV(Uo,{placeholder:"Select school"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:192,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:191,columnNumber:17},this),d.jsxDEV(ws,{children:WW.map(f=>d.jsxDEV(An,{value:f.value,children:f.label},f.value,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:196,columnNumber:21},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:194,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:190,columnNumber:15},this),l.school&&d.jsxDEV("p",{className:"text-sm text-red-500",children:l.school},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:202,columnNumber:33},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:188,columnNumber:13},this),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{htmlFor:"month",children:["Month ",d.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:206,columnNumber:44},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:206,columnNumber:15},this),d.jsxDEV(Fo,{value:r.month,onValueChange:f=>n(x=>he(H({},x),{month:f})),children:[d.jsxDEV(Cs,{className:l.month?"border-red-500":"",children:d.jsxDEV(Uo,{placeholder:"Select month"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:209,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:208,columnNumber:17},this),d.jsxDEV(ws,{children:GW.map(f=>d.jsxDEV(An,{value:f,children:f},f,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:213,columnNumber:21},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:211,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:207,columnNumber:15},this),l.month&&d.jsxDEV("p",{className:"text-sm text-red-500",children:l.month},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:219,columnNumber:32},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:205,columnNumber:13},this),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{htmlFor:"year",children:["Year ",d.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:223,columnNumber:42},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:223,columnNumber:15},this),d.jsxDEV(Fo,{value:r.year,onValueChange:f=>n(x=>he(H({},x),{year:f})),children:[d.jsxDEV(Cs,{className:l.year?"border-red-500":"",children:d.jsxDEV(Uo,{placeholder:"Select year"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:226,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:225,columnNumber:17},this),d.jsxDEV(ws,{children:Array.from({length:10},(f,x)=>new Date().getFullYear()-5+x).map(f=>d.jsxDEV(An,{value:f.toString(),children:f},f,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:230,columnNumber:21},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:228,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:224,columnNumber:15},this),l.year&&d.jsxDEV("p",{className:"text-sm text-red-500",children:l.year},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:236,columnNumber:31},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:222,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:187,columnNumber:11},this),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{htmlFor:"pdfFile",children:["PDF File ",d.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:241,columnNumber:47},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:241,columnNumber:13},this),d.jsxDEV(Ns,{id:"pdfFile",type:"file",accept:".pdf,application/pdf",onChange:c,className:l.pdfFile?"border-red-500":"",required:!0},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:242,columnNumber:13},this),l.pdfFile&&d.jsxDEV("p",{className:"text-sm text-red-500",children:l.pdfFile},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:250,columnNumber:32},this),a&&d.jsxDEV("p",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[d.jsxDEV(Fn,{className:"w-4 h-4 text-green-500"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:253,columnNumber:17},this),a.name," (",(a.size/1024/1024).toFixed(2)," MB)"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:252,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:240,columnNumber:11},this),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{htmlFor:"uploadedBy",children:"Uploaded By (Optional)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:260,columnNumber:13},this),d.jsxDEV(Ns,{id:"uploadedBy",value:r.uploadedBy,onChange:f=>n(x=>he(H({},x),{uploadedBy:f.target.value})),placeholder:"Your name",maxLength:255},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:261,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:259,columnNumber:11},this),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV(nt,{htmlFor:"notes",children:"Notes (Optional)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:271,columnNumber:13},this),d.jsxDEV(Tx,{id:"notes",value:r.notes,onChange:f=>n(x=>he(H({},x),{notes:f.target.value})),placeholder:"Additional notes or context about this feedback...",rows:4,maxLength:5e3},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:272,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:270,columnNumber:11},this),d.jsxDEV(Ye,{type:"submit",disabled:s,className:"w-full",children:s?d.jsxDEV(d.Fragment,{children:[d.jsxDEV("span",{className:"animate-spin mr-2",children:"â³"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:285,columnNumber:17},this),"Uploading..."]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:284,columnNumber:15},this):d.jsxDEV(d.Fragment,{children:[d.jsxDEV(LE,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:290,columnNumber:17},this),"Upload Feedback"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:289,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:282,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:184,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:179,columnNumber:7},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackUploadForm.tsx",lineNumber:178,columnNumber:5},this)}function hee({feedback:e,onView:t,onDownload:r}){const n=()=>{if(!e.extractedText)return"No text content available";const i=e.extractedText.trim();return i.length===0?"No text content available":i.length>200?i.substring(0,200)+"...":i},a=i=>i;return d.jsxDEV(Le,{children:[d.jsxDEV(Ke,{className:"pb-3",children:[d.jsxDEV(Qe,{className:"flex items-center justify-between leading-7",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(Sa,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:32,columnNumber:13},this),d.jsxDEV("span",{children:[e.month," ",e.year]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:33,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:31,columnNumber:11},this),d.jsxDEV(Ct,{title:a(e.school),children:e.school},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:35,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:30,columnNumber:9},this),d.jsxDEV(ft,{className:"flex items-center gap-2 mt-2",children:[d.jsxDEV(yr,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:38,columnNumber:11},this),new Date(e.createdAt).toLocaleDateString()]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:37,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:29,columnNumber:7},this),d.jsxDEV(He,{className:"pt-0",children:d.jsxDEV("div",{className:"space-y-4",children:[d.jsxDEV("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.uploadedBy&&d.jsxDEV("div",{className:"flex items-center gap-1",children:[d.jsxDEV(za,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:48,columnNumber:17},this),d.jsxDEV("span",{children:e.uploadedBy},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:49,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:47,columnNumber:15},this),e.fileSize&&d.jsxDEV("div",{className:"flex items-center gap-1",children:[d.jsxDEV(sF,{className:"w-3 h-3"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:54,columnNumber:17},this),d.jsxDEV("span",{children:[(e.fileSize/1024/1024).toFixed(2)," MB"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:55,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:53,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:45,columnNumber:11},this),d.jsxDEV("p",{className:"text-sm text-muted-foreground line-clamp-3",children:n()},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:60,columnNumber:11},this),d.jsxDEV("div",{className:"flex gap-2",children:[d.jsxDEV(Ye,{onClick:()=>t(e),size:"sm",variant:"default",children:[d.jsxDEV(m_,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:65,columnNumber:15},this),"View Details"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:64,columnNumber:13},this),d.jsxDEV(Ye,{onClick:()=>r(e),size:"sm",variant:"outline","aria-label":`Download PDF for ${e.month} ${e.year} ${e.school}`,children:[d.jsxDEV(Ii,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:74,columnNumber:15},this),"Download PDF"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:68,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:63,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:43,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:42,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackCard.tsx",lineNumber:28,columnNumber:5},this)}class YW extends Error{constructor(r,n,a,i,s){super(r);et(this,"name","Assertion");et(this,"code","ERR_ASSERTION");Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.actual=n,this.expected=a,this.generated=s,this.operator=i}}function X(e,t){E3(!!e,!1,!0,"ok","Expected value to be truthy",t)}function pee(e){E3(!1,!1,!0,"ok","Unreachable",e)}function E3(e,t,r,n,a,i){if(!e)throw i instanceof Error?i:new YW(i||a,t,r,n,!i)}function XW(e,t){const r={};return(e[e.length-1]===""?[...e,""]:e).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const KW=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,QW=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,ZW={};function Ew(e,t){return(ZW.jsx?QW:KW).test(e)}const JW=/[ \t\n\f\r]/g;function eG(e){return typeof e=="object"?e.type==="text"?_w(e.value):!1:_w(e)}function _w(e){return e.replace(JW,"")===""}class Ml{constructor(t,r,n){this.normal=r,this.property=t,n&&(this.space=n)}}Ml.prototype.normal={};Ml.prototype.property={};Ml.prototype.space=void 0;function _3(e,t){const r={},n={};for(const a of e)Object.assign(r,a.property),Object.assign(n,a.normal);return new Ml(r,n,t)}function Gp(e){return e.toLowerCase()}class zr{constructor(t,r){this.attribute=r,this.property=t}}zr.prototype.attribute="";zr.prototype.booleanish=!1;zr.prototype.boolean=!1;zr.prototype.commaOrSpaceSeparated=!1;zr.prototype.commaSeparated=!1;zr.prototype.defined=!1;zr.prototype.mustUseProperty=!1;zr.prototype.number=!1;zr.prototype.overloadedBoolean=!1;zr.prototype.property="";zr.prototype.spaceSeparated=!1;zr.prototype.space=void 0;let tG=0;const Xe=as(),Gt=as(),Yp=as(),ye=as(),Et=as(),As=as(),$r=as();function as(){return Wl(2,++tG)}const Xp=Object.freeze(Object.defineProperty({__proto__:null,boolean:Xe,booleanish:Gt,commaOrSpaceSeparated:$r,commaSeparated:As,number:ye,overloadedBoolean:Yp,spaceSeparated:Et},Symbol.toStringTag,{value:"Module"})),H0=Object.keys(Xp);class Yg extends zr{constructor(t,r,n,a){let i=-1;if(super(t,r),Sw(this,"space",a),typeof n=="number")for(;++i<H0.length;){const s=H0[i];Sw(this,H0[i],(n&Xp[s])===Xp[s])}}}Yg.prototype.defined=!0;function Sw(e,t,r){r&&(e[t]=r)}function no(e){const t={},r={};for(const[n,a]of Object.entries(e.properties)){const i=new Yg(n,e.transform(e.attributes||{},n),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(n)&&(i.mustUseProperty=!0),t[n]=i,r[Gp(n)]=n,r[Gp(i.attribute)]=n}return new Ml(t,r,e.space)}const S3=no({properties:{ariaActiveDescendant:null,ariaAtomic:Gt,ariaAutoComplete:null,ariaBusy:Gt,ariaChecked:Gt,ariaColCount:ye,ariaColIndex:ye,ariaColSpan:ye,ariaControls:Et,ariaCurrent:null,ariaDescribedBy:Et,ariaDetails:null,ariaDisabled:Gt,ariaDropEffect:Et,ariaErrorMessage:null,ariaExpanded:Gt,ariaFlowTo:Et,ariaGrabbed:Gt,ariaHasPopup:null,ariaHidden:Gt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Et,ariaLevel:ye,ariaLive:null,ariaModal:Gt,ariaMultiLine:Gt,ariaMultiSelectable:Gt,ariaOrientation:null,ariaOwns:Et,ariaPlaceholder:null,ariaPosInSet:ye,ariaPressed:Gt,ariaReadOnly:Gt,ariaRelevant:null,ariaRequired:Gt,ariaRoleDescription:Et,ariaRowCount:ye,ariaRowIndex:ye,ariaRowSpan:ye,ariaSelected:Gt,ariaSetSize:ye,ariaSort:null,ariaValueMax:ye,ariaValueMin:ye,ariaValueNow:ye,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function T3(e,t){return t in e?e[t]:t}function D3(e,t){return T3(e,t.toLowerCase())}const rG=no({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:As,acceptCharset:Et,accessKey:Et,action:null,allow:null,allowFullScreen:Xe,allowPaymentRequest:Xe,allowUserMedia:Xe,alt:null,as:null,async:Xe,autoCapitalize:null,autoComplete:Et,autoFocus:Xe,autoPlay:Xe,blocking:Et,capture:null,charSet:null,checked:Xe,cite:null,className:Et,cols:ye,colSpan:null,content:null,contentEditable:Gt,controls:Xe,controlsList:Et,coords:ye|As,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Xe,defer:Xe,dir:null,dirName:null,disabled:Xe,download:Yp,draggable:Gt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Xe,formTarget:null,headers:Et,height:ye,hidden:Yp,high:ye,href:null,hrefLang:null,htmlFor:Et,httpEquiv:Et,id:null,imageSizes:null,imageSrcSet:null,inert:Xe,inputMode:null,integrity:null,is:null,isMap:Xe,itemId:null,itemProp:Et,itemRef:Et,itemScope:Xe,itemType:Et,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Xe,low:ye,manifest:null,max:null,maxLength:ye,media:null,method:null,min:null,minLength:ye,multiple:Xe,muted:Xe,name:null,nonce:null,noModule:Xe,noValidate:Xe,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Xe,optimum:ye,pattern:null,ping:Et,placeholder:null,playsInline:Xe,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Xe,referrerPolicy:null,rel:Et,required:Xe,reversed:Xe,rows:ye,rowSpan:ye,sandbox:Et,scope:null,scoped:Xe,seamless:Xe,selected:Xe,shadowRootClonable:Xe,shadowRootDelegatesFocus:Xe,shadowRootMode:null,shape:null,size:ye,sizes:null,slot:null,span:ye,spellCheck:Gt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ye,step:null,style:null,tabIndex:ye,target:null,title:null,translate:null,type:null,typeMustMatch:Xe,useMap:null,value:Gt,width:ye,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Et,axis:null,background:null,bgColor:null,border:ye,borderColor:null,bottomMargin:ye,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Xe,declare:Xe,event:null,face:null,frame:null,frameBorder:null,hSpace:ye,leftMargin:ye,link:null,longDesc:null,lowSrc:null,marginHeight:ye,marginWidth:ye,noResize:Xe,noHref:Xe,noShade:Xe,noWrap:Xe,object:null,profile:null,prompt:null,rev:null,rightMargin:ye,rules:null,scheme:null,scrolling:Gt,standby:null,summary:null,text:null,topMargin:ye,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ye,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Xe,disableRemotePlayback:Xe,prefix:null,property:null,results:ye,security:null,unselectable:null},space:"html",transform:D3}),nG=no({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:$r,accentHeight:ye,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ye,amplitude:ye,arabicForm:null,ascent:ye,attributeName:null,attributeType:null,azimuth:ye,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ye,by:null,calcMode:null,capHeight:ye,className:Et,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ye,diffuseConstant:ye,direction:null,display:null,dur:null,divisor:ye,dominantBaseline:null,download:Xe,dx:null,dy:null,edgeMode:null,editable:null,elevation:ye,enableBackground:null,end:null,event:null,exponent:ye,externalResourcesRequired:null,fill:null,fillOpacity:ye,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:As,g2:As,glyphName:As,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ye,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ye,horizOriginX:ye,horizOriginY:ye,id:null,ideographic:ye,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ye,k:ye,k1:ye,k2:ye,k3:ye,k4:ye,kernelMatrix:$r,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ye,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ye,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ye,overlineThickness:ye,paintOrder:null,panose1:null,path:null,pathLength:ye,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Et,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ye,pointsAtY:ye,pointsAtZ:ye,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:$r,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:$r,rev:$r,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:$r,requiredFeatures:$r,requiredFonts:$r,requiredFormats:$r,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ye,specularExponent:ye,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ye,strikethroughThickness:ye,string:null,stroke:null,strokeDashArray:$r,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ye,strokeOpacity:ye,strokeWidth:null,style:null,surfaceScale:ye,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:$r,tabIndex:ye,tableValues:null,target:null,targetX:ye,targetY:ye,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:$r,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ye,underlineThickness:ye,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ye,values:null,vAlphabetic:ye,vMathematical:ye,vectorEffect:null,vHanging:ye,vIdeographic:ye,version:null,vertAdvY:ye,vertOriginX:ye,vertOriginY:ye,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ye,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:T3}),A3=no({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),k3=no({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:D3}),F3=no({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),aG=/[A-Z]/g,Tw=/-[a-z]/g,iG=/^data[-\w.:]+$/i;function sG(e,t){const r=Gp(t);let n=t,a=zr;if(r in e.normal)return e.property[e.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&iG.test(t)){if(t.charAt(4)==="-"){const i=t.slice(5).replace(Tw,lG);n="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=t.slice(4);if(!Tw.test(i)){let s=i.replace(aG,oG);s.charAt(0)!=="-"&&(s="-"+s),t="data"+s}}a=Yg}return new a(n,t)}function oG(e){return"-"+e.toLowerCase()}function lG(e){return e.charAt(1).toUpperCase()}const uG=_3([S3,rG,A3,k3,F3],"html"),Xg=_3([S3,nG,A3,k3,F3],"svg");function cG(e){return e.join(" ").trim()}var ms={},$0,Dw;function mG(){if(Dw)return $0;Dw=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,t=/\n/g,r=/^\s*/,n=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,i=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,s=/^[;\s]*/,o=/^\s+|\s+$/g,l=`
`,u="/",c="*",m="",h="comment",f="declaration";$0=function(p,g){if(typeof p!="string")throw new TypeError("First argument must be a string");if(!p)return[];g=g||{};var v=1,C=1;function b(M){var Y=M.match(t);Y&&(v+=Y.length);var K=M.lastIndexOf(l);C=~K?M.length-K:C+M.length}function N(){var M={line:v,column:C};return function(Y){return Y.position=new F(M),S(),Y}}function F(M){this.start=M,this.end={line:v,column:C},this.source=g.source}F.prototype.content=p;function E(M){var Y=new Error(g.source+":"+v+":"+C+": "+M);if(Y.reason=M,Y.filename=g.source,Y.line=v,Y.column=C,Y.source=p,!g.silent)throw Y}function w(M){var Y=M.exec(p);if(Y){var K=Y[0];return b(K),p=p.slice(K.length),Y}}function S(){w(r)}function _(M){var Y;for(M=M||[];Y=U();)Y!==!1&&M.push(Y);return M}function U(){var M=N();if(!(u!=p.charAt(0)||c!=p.charAt(1))){for(var Y=2;m!=p.charAt(Y)&&(c!=p.charAt(Y)||u!=p.charAt(Y+1));)++Y;if(Y+=2,m===p.charAt(Y-1))return E("End of comment missing");var K=p.slice(2,Y-2);return C+=2,b(K),p=p.slice(Y),C+=2,M({type:h,comment:K})}}function R(){var M=N(),Y=w(n);if(Y){if(U(),!w(a))return E("property missing ':'");var K=w(i),de=M({type:f,property:x(Y[0].replace(e,m)),value:K?x(K[0].replace(e,m)):m});return w(s),de}}function q(){var M=[];_(M);for(var Y;Y=R();)Y!==!1&&(M.push(Y),_(M));return M}return S(),q()};function x(p){return p?p.replace(o,m):m}return $0}var Aw;function dG(){if(Aw)return ms;Aw=1;var e=ms&&ms.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ms,"__esModule",{value:!0}),ms.default=r;const t=e(mG());function r(n,a){let i=null;if(!n||typeof n!="string")return i;const s=(0,t.default)(n),o=typeof a=="function";return s.forEach(l=>{if(l.type!=="declaration")return;const{property:u,value:c}=l;o?a(u,c,l):c&&(i=i||{},i[u]=c)}),i}return ms}var yo={},kw;function fG(){if(kw)return yo;kw=1,Object.defineProperty(yo,"__esModule",{value:!0}),yo.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,t=/-([a-z])/g,r=/^[^-]+$/,n=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,i=function(u){return!u||r.test(u)||e.test(u)},s=function(u,c){return c.toUpperCase()},o=function(u,c){return"".concat(c,"-")},l=function(u,c){return c===void 0&&(c={}),i(u)?u:(u=u.toLowerCase(),c.reactCompat?u=u.replace(a,o):u=u.replace(n,o),u.replace(t,s))};return yo.camelCase=l,yo}var Co,Fw;function hG(){if(Fw)return Co;Fw=1;var e=Co&&Co.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},t=e(dG()),r=fG();function n(a,i){var s={};return!a||typeof a!="string"||(0,t.default)(a,function(o,l){o&&l&&(s[(0,r.camelCase)(o,i)]=l)}),s}return n.default=n,Co=n,Co}var pG=hG();const xG=at(pG),U3=R3("end"),Kg=R3("start");function R3(e){return t;function t(r){const n=r&&r.position&&r.position[e]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function gG(e){const t=Kg(e),r=U3(e);if(t&&r)return{start:t,end:r}}function qo(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Uw(e.position):"start"in e||"end"in e?Uw(e):"line"in e||"column"in e?Kp(e):""}function Kp(e){return Rw(e&&e.line)+":"+Rw(e&&e.column)}function Uw(e){return Kp(e&&e.start)+"-"+Kp(e&&e.end)}function Rw(e){return e&&typeof e=="number"?e:1}class _r extends Error{constructor(t,r,n){super(),typeof r=="string"&&(n=r,r=void 0);let a="",i={},s=!1;if(r&&("line"in r&&"column"in r?i={place:r}:"start"in r&&"end"in r?i={place:r}:"type"in r?i={ancestors:[r],place:r.position}:i=H({},r)),typeof t=="string"?a=t:!i.cause&&t&&(s=!0,a=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof n=="string"){const l=n.indexOf(":");l===-1?i.ruleId=n:(i.source=n.slice(0,l),i.ruleId=n.slice(l+1))}if(!i.place&&i.ancestors&&i.ancestors){const l=i.ancestors[i.ancestors.length-1];l&&(i.place=l.position)}const o=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=o?o.line:void 0,this.name=qo(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=s&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}_r.prototype.file="";_r.prototype.name="";_r.prototype.reason="";_r.prototype.message="";_r.prototype.stack="";_r.prototype.column=void 0;_r.prototype.line=void 0;_r.prototype.ancestors=void 0;_r.prototype.cause=void 0;_r.prototype.fatal=void 0;_r.prototype.place=void 0;_r.prototype.ruleId=void 0;_r.prototype.source=void 0;const Qg={}.hasOwnProperty,vG=new Map,bG=/[A-Z]/g,NG=new Set(["table","tbody","thead","tfoot","tr"]),yG=new Set(["td","th"]),O3="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function xee(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=t.filePath||void 0;let n;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=AG(r,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=DG(r,t.jsx,t.jsxs)}const a={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:n,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?Xg:uG,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},i=V3(a,e,void 0);return i&&typeof i!="string"?i:a.create(e,a.Fragment,{children:i||void 0},void 0)}function V3(e,t,r){if(t.type==="element")return CG(e,t,r);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return wG(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return _G(e,t,r);if(t.type==="mdxjsEsm")return EG(e,t);if(t.type==="root")return SG(e,t,r);if(t.type==="text")return TG(e,t)}function CG(e,t,r){const n=e.schema;let a=n;t.tagName.toLowerCase()==="svg"&&n.space==="html"&&(a=Xg,e.schema=a),e.ancestors.push(t);const i=I3(e,t.tagName,!1),s=kG(e,t);let o=Jg(e,t);return NG.has(t.tagName)&&(o=o.filter(function(l){return typeof l=="string"?!eG(l):!0})),P3(e,s,i,t),Zg(s,o),e.ancestors.pop(),e.schema=n,e.create(t,i,s,r)}function wG(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return X(n.type==="ExpressionStatement"),e.evaluater.evaluateExpression(n.expression)}xl(e,t.position)}function EG(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);xl(e,t.position)}function _G(e,t,r){const n=e.schema;let a=n;t.name==="svg"&&n.space==="html"&&(a=Xg,e.schema=a),e.ancestors.push(t);const i=t.name===null?e.Fragment:I3(e,t.name,!0),s=FG(e,t),o=Jg(e,t);return P3(e,s,i,t),Zg(s,o),e.ancestors.pop(),e.schema=n,e.create(t,i,s,r)}function SG(e,t,r){const n={};return Zg(n,Jg(e,t)),e.create(t,e.Fragment,n,r)}function TG(e,t){return t.value}function P3(e,t,r,n){typeof r!="string"&&r!==e.Fragment&&e.passNode&&(t.node=n)}function Zg(e,t){if(t.length>0){const r=t.length>1?t:t[0];r&&(e.children=r)}}function DG(e,t,r){return n;function n(a,i,s,o){const u=Array.isArray(s.children)?r:t;return o?u(i,s,o):u(i,s)}}function AG(e,t){return r;function r(n,a,i,s){const o=Array.isArray(i.children),l=Kg(n);return t(a,i,s,o,{columnNumber:l?l.column-1:void 0,fileName:e,lineNumber:l?l.line:void 0},void 0)}}function kG(e,t){const r={};let n,a;for(a in t.properties)if(a!=="children"&&Qg.call(t.properties,a)){const i=UG(e,a,t.properties[a]);if(i){const[s,o]=i;e.tableCellAlignToStyle&&s==="align"&&typeof o=="string"&&yG.has(t.tagName)?n=o:r[s]=o}}if(n){const i=r.style||(r.style={});i[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function FG(e,t){const r={};for(const n of t.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&e.evaluater){const i=n.data.estree.body[0];X(i.type==="ExpressionStatement");const s=i.expression;X(s.type==="ObjectExpression");const o=s.properties[0];X(o.type==="SpreadElement"),Object.assign(r,e.evaluater.evaluateExpression(o.argument))}else xl(e,t.position);else{const a=n.name;let i;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&e.evaluater){const o=n.value.data.estree.body[0];X(o.type==="ExpressionStatement"),i=e.evaluater.evaluateExpression(o.expression)}else xl(e,t.position);else i=n.value===null?!0:n.value;r[a]=i}return r}function Jg(e,t){const r=[];let n=-1;const a=e.passKeys?new Map:vG;for(;++n<t.children.length;){const i=t.children[n];let s;if(e.passKeys){const l=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(l){const u=a.get(l)||0;s=l+"-"+u,a.set(l,u+1)}}const o=V3(e,i,s);o!==void 0&&r.push(o)}return r}function UG(e,t,r){const n=sG(e.schema,t);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?XW(r):cG(r)),n.property==="style"){let a=typeof r=="object"?r:RG(e,String(r));return e.stylePropertyNameCase==="css"&&(a=OG(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&n.space?oF[n.property]||n.property:n.attribute,r]}}function RG(e,t){try{return xG(t,{reactCompat:!0})}catch(r){if(e.ignoreInvalidStyle)return{};const n=r,a=new _r("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:n,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=O3+"#cannot-parse-style-attribute",a}}function I3(e,t,r){let n;if(!r)n={type:"Literal",value:t};else if(t.includes(".")){const a=t.split(".");let i=-1,s;for(;++i<a.length;){const o=Ew(a[i])?{type:"Identifier",name:a[i]}:{type:"Literal",value:a[i]};s=s?{type:"MemberExpression",object:s,property:o,computed:!!(i&&o.type==="Literal"),optional:!1}:o}X(s,"always a result"),n=s}else n=Ew(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(n.type==="Literal"){const a=n.value;return Qg.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(n);xl(e)}function xl(e,t){const r=new _r("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=O3+"#cannot-handle-mdx-estrees-without-createevaluater",r}function OG(e){const t={};let r;for(r in e)Qg.call(e,r)&&(t[VG(r)]=e[r]);return t}function VG(e){let t=e.replace(bG,PG);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function PG(e){return"-"+e.toLowerCase()}const gee={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},IG={};function MG(e,t){const r=IG,n=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,a=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return M3(e,n,a)}function M3(e,t,r){if(jG(e)){if("value"in e)return e.type==="html"&&!r?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Ow(e.children,t,r)}return Array.isArray(e)?Ow(e,t,r):""}function Ow(e,t,r){const n=[];let a=-1;for(;++a<e.length;)n[a]=M3(e[a],t,r);return n.join("")}function jG(e){return!!(e&&typeof e=="object")}const Vw=document.createElement("i");function e1(e){const t="&"+e+";";Vw.innerHTML=t;const r=Vw.textContent;return r.charCodeAt(r.length-1)===59&&e!=="semi"||r===t?!1:r}const A={carriageReturn:-5,lineFeed:-4,carriageReturnLineFeed:-3,horizontalTab:-2,virtualSpace:-1,eof:null,nul:0,ht:9,lf:10,vt:11,cr:13,space:32,exclamationMark:33,quotationMark:34,numberSign:35,percentSign:37,ampersand:38,apostrophe:39,leftParenthesis:40,rightParenthesis:41,asterisk:42,plusSign:43,dash:45,dot:46,slash:47,digit0:48,digit1:49,digit2:50,digit3:51,digit4:52,digit5:53,digit6:54,digit7:55,digit8:56,digit9:57,colon:58,semicolon:59,lessThan:60,equalsTo:61,greaterThan:62,questionMark:63,atSign:64,uppercaseX:88,leftSquareBracket:91,backslash:92,rightSquareBracket:93,caret:94,underscore:95,graveAccent:96,lowercaseX:120,tilde:126,del:127,byteOrderMarker:65279,replacementCharacter:65533},Re={atxHeadingOpeningFenceSizeMax:6,autolinkDomainSizeMax:63,autolinkSchemeSizeMax:32,cdataOpeningString:"CDATA[",characterGroupPunctuation:2,characterGroupWhitespace:1,characterReferenceDecimalSizeMax:7,characterReferenceHexadecimalSizeMax:6,characterReferenceNamedSizeMax:31,codeFencedSequenceSizeMin:3,contentTypeContent:"content",contentTypeFlow:"flow",contentTypeString:"string",contentTypeText:"text",hardBreakPrefixSizeMin:2,htmlBasic:6,htmlCdata:5,htmlComment:2,htmlComplete:7,htmlDeclaration:4,htmlInstruction:3,htmlRawSizeMax:8,htmlRaw:1,linkResourceDestinationBalanceMax:32,linkReferenceSizeMax:999,listItemValueSizeMax:10,numericBaseDecimal:10,numericBaseHexadecimal:16,tabSize:4,thematicBreakMarkerCountMin:3,v8MaxSafeChunkSize:1e4},T={data:"data",whitespace:"whitespace",lineEnding:"lineEnding",lineEndingBlank:"lineEndingBlank",linePrefix:"linePrefix",lineSuffix:"lineSuffix",atxHeading:"atxHeading",atxHeadingSequence:"atxHeadingSequence",atxHeadingText:"atxHeadingText",autolink:"autolink",autolinkEmail:"autolinkEmail",autolinkMarker:"autolinkMarker",autolinkProtocol:"autolinkProtocol",characterEscape:"characterEscape",characterEscapeValue:"characterEscapeValue",characterReference:"characterReference",characterReferenceMarker:"characterReferenceMarker",characterReferenceMarkerNumeric:"characterReferenceMarkerNumeric",characterReferenceMarkerHexadecimal:"characterReferenceMarkerHexadecimal",characterReferenceValue:"characterReferenceValue",codeFenced:"codeFenced",codeFencedFence:"codeFencedFence",codeFencedFenceSequence:"codeFencedFenceSequence",codeFencedFenceInfo:"codeFencedFenceInfo",codeFencedFenceMeta:"codeFencedFenceMeta",codeFlowValue:"codeFlowValue",codeIndented:"codeIndented",codeText:"codeText",codeTextData:"codeTextData",codeTextPadding:"codeTextPadding",codeTextSequence:"codeTextSequence",content:"content",definition:"definition",definitionDestination:"definitionDestination",definitionDestinationLiteral:"definitionDestinationLiteral",definitionDestinationLiteralMarker:"definitionDestinationLiteralMarker",definitionDestinationRaw:"definitionDestinationRaw",definitionDestinationString:"definitionDestinationString",definitionLabel:"definitionLabel",definitionLabelMarker:"definitionLabelMarker",definitionLabelString:"definitionLabelString",definitionMarker:"definitionMarker",definitionTitle:"definitionTitle",definitionTitleMarker:"definitionTitleMarker",definitionTitleString:"definitionTitleString",emphasis:"emphasis",emphasisSequence:"emphasisSequence",emphasisText:"emphasisText",escapeMarker:"escapeMarker",hardBreakEscape:"hardBreakEscape",hardBreakTrailing:"hardBreakTrailing",htmlFlow:"htmlFlow",htmlFlowData:"htmlFlowData",htmlText:"htmlText",htmlTextData:"htmlTextData",image:"image",label:"label",labelText:"labelText",labelLink:"labelLink",labelImage:"labelImage",labelMarker:"labelMarker",labelImageMarker:"labelImageMarker",labelEnd:"labelEnd",link:"link",paragraph:"paragraph",reference:"reference",referenceMarker:"referenceMarker",referenceString:"referenceString",resource:"resource",resourceDestination:"resourceDestination",resourceDestinationLiteral:"resourceDestinationLiteral",resourceDestinationLiteralMarker:"resourceDestinationLiteralMarker",resourceDestinationRaw:"resourceDestinationRaw",resourceDestinationString:"resourceDestinationString",resourceMarker:"resourceMarker",resourceTitle:"resourceTitle",resourceTitleMarker:"resourceTitleMarker",resourceTitleString:"resourceTitleString",setextHeading:"setextHeading",setextHeadingText:"setextHeadingText",setextHeadingLine:"setextHeadingLine",setextHeadingLineSequence:"setextHeadingLineSequence",strong:"strong",strongSequence:"strongSequence",strongText:"strongText",thematicBreak:"thematicBreak",thematicBreakSequence:"thematicBreakSequence",blockQuote:"blockQuote",blockQuotePrefix:"blockQuotePrefix",blockQuoteMarker:"blockQuoteMarker",blockQuotePrefixWhitespace:"blockQuotePrefixWhitespace",listOrdered:"listOrdered",listUnordered:"listUnordered",listItemIndent:"listItemIndent",listItemMarker:"listItemMarker",listItemPrefix:"listItemPrefix",listItemPrefixWhitespace:"listItemPrefixWhitespace",listItemValue:"listItemValue",chunkContent:"chunkContent",chunkFlow:"chunkFlow",chunkText:"chunkText",chunkString:"chunkString"},Bn={ht:"	",lf:`
`,cr:"\r",space:" ",replacementCharacter:"ï¿½"};function ea(e,t,r,n){const a=e.length;let i=0,s;if(t<0?t=-t>a?0:a+t:t=t>a?a:t,r=r>0?r:0,n.length<Re.v8MaxSafeChunkSize)s=Array.from(n),s.unshift(t,r),e.splice(...s);else for(r&&e.splice(t,r);i<n.length;)s=n.slice(i,i+Re.v8MaxSafeChunkSize),s.unshift(t,0),e.splice(...s),i+=Re.v8MaxSafeChunkSize,t+=Re.v8MaxSafeChunkSize}function cn(e,t){return e.length>0?(ea(e,e.length,0,t),e):t}const Pw={}.hasOwnProperty;function LG(e){const t={};let r=-1;for(;++r<e.length;)BG(t,e[r]);return t}function BG(e,t){let r;for(r in t){const a=(Pw.call(e,r)?e[r]:void 0)||(e[r]={}),i=t[r];let s;if(i)for(s in i){Pw.call(a,s)||(a[s]=[]);const o=i[s];qG(a[s],Array.isArray(o)?o:o?[o]:[])}}}function qG(e,t){let r=-1;const n=[];for(;++r<t.length;)(t[r].add==="after"?e:n).push(t[r]);ea(e,0,0,n)}function j3(e,t){const r=Number.parseInt(e,t);return r<A.ht||r===A.vt||r>A.cr&&r<A.space||r>A.tilde&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?Bn.replacementCharacter:String.fromCodePoint(r)}function ks(e){return e.replace(/[\t\n\r ]+/g,Bn.space).replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Wn=mi(/[A-Za-z]/),en=mi(/[\dA-Za-z]/),zG=mi(/[#-'*+\--9=?A-Z^-~]/);function Qp(e){return e!==null&&(e<A.space||e===A.del)}const Zp=mi(/\d/),HG=mi(/[\dA-Fa-f]/),$G=mi(/[!-/:-@[-`{-~]/);function Ie(e){return e!==null&&e<A.horizontalTab}function Ir(e){return e!==null&&(e<A.nul||e===A.space)}function ot(e){return e===A.horizontalTab||e===A.virtualSpace||e===A.space}const WG=mi(new RegExp("\\p{P}|\\p{S}","u")),GG=mi(/\s/);function mi(e){return t;function t(r){return r!==null&&r>-1&&e.test(String.fromCharCode(r))}}function ao(e){const t=[];let r=-1,n=0,a=0;for(;++r<e.length;){const i=e.charCodeAt(r);let s="";if(i===A.percentSign&&en(e.charCodeAt(r+1))&&en(e.charCodeAt(r+2)))a=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(s=String.fromCharCode(i));else if(i>55295&&i<57344){const o=e.charCodeAt(r+1);i<56320&&o>56319&&o<57344?(s=String.fromCharCode(i,o),a=1):s=Bn.replacementCharacter}else s=String.fromCharCode(i);s&&(t.push(e.slice(n,r),encodeURIComponent(s)),n=r+a+1,s=""),a&&(r+=a,a=0)}return t.join("")+e.slice(n)}function St(e,t,r,n){const a=n?n-1:Number.POSITIVE_INFINITY;let i=0;return s;function s(l){return ot(l)?(e.enter(r),o(l)):t(l)}function o(l){return ot(l)&&i++<a?(e.consume(l),o):(e.exit(r),t(l))}}const YG={tokenize:XG};function XG(e){const t=e.attempt(this.parser.constructs.contentInitial,n,a);let r;return t;function n(o){if(X(o===A.eof||Ie(o),"expected eol or eof"),o===A.eof){e.consume(o);return}return e.enter(T.lineEnding),e.consume(o),e.exit(T.lineEnding),St(e,t,T.linePrefix)}function a(o){return X(o!==A.eof&&!Ie(o),"expected anything other than a line ending or EOF"),e.enter(T.paragraph),i(o)}function i(o){const l=e.enter(T.chunkText,{contentType:Re.contentTypeText,previous:r});return r&&(r.next=l),r=l,s(o)}function s(o){if(o===A.eof){e.exit(T.chunkText),e.exit(T.paragraph),e.consume(o);return}return Ie(o)?(e.consume(o),e.exit(T.chunkText),i):(e.consume(o),s)}}const KG={tokenize:QG},Iw={tokenize:ZG};function QG(e){const t=this,r=[];let n=0,a,i,s;return o;function o(b){if(n<r.length){const N=r[n];return t.containerState=N[1],X(N[0].continuation,"expected `continuation` to be defined on container construct"),e.attempt(N[0].continuation,l,u)(b)}return u(b)}function l(b){if(X(t.containerState,"expected `containerState` to be defined after continuation"),n++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,a&&C();const N=t.events.length;let F=N,E;for(;F--;)if(t.events[F][0]==="exit"&&t.events[F][1].type===T.chunkFlow){E=t.events[F][1].end;break}X(E,"could not find previous flow chunk"),v(n);let w=N;for(;w<t.events.length;)t.events[w][1].end=H({},E),w++;return ea(t.events,F+1,0,t.events.slice(N)),t.events.length=w,u(b)}return o(b)}function u(b){if(n===r.length){if(!a)return h(b);if(a.currentConstruct&&a.currentConstruct.concrete)return x(b);t.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Iw,c,m)(b)}function c(b){return a&&C(),v(n),h(b)}function m(b){return t.parser.lazy[t.now().line]=n!==r.length,s=t.now().offset,x(b)}function h(b){return t.containerState={},e.attempt(Iw,f,x)(b)}function f(b){return X(t.currentConstruct,"expected `currentConstruct` to be defined on tokenizer"),X(t.containerState,"expected `containerState` to be defined on tokenizer"),n++,r.push([t.currentConstruct,t.containerState]),h(b)}function x(b){if(b===A.eof){a&&C(),v(0),e.consume(b);return}return a=a||t.parser.flow(t.now()),e.enter(T.chunkFlow,{_tokenizer:a,contentType:Re.contentTypeFlow,previous:i}),p(b)}function p(b){if(b===A.eof){g(e.exit(T.chunkFlow),!0),v(0),e.consume(b);return}return Ie(b)?(e.consume(b),g(e.exit(T.chunkFlow)),n=0,t.interrupt=void 0,o):(e.consume(b),p)}function g(b,N){X(a,"expected `childFlow` to be defined when continuing");const F=t.sliceStream(b);if(N&&F.push(null),b.previous=i,i&&(i.next=b),i=b,a.defineSkip(b.start),a.write(F),t.parser.lazy[b.start.line]){let E=a.events.length;for(;E--;)if(a.events[E][1].start.offset<s&&(!a.events[E][1].end||a.events[E][1].end.offset>s))return;const w=t.events.length;let S=w,_,U;for(;S--;)if(t.events[S][0]==="exit"&&t.events[S][1].type===T.chunkFlow){if(_){U=t.events[S][1].end;break}_=!0}for(X(U,"could not find previous flow chunk"),v(n),E=w;E<t.events.length;)t.events[E][1].end=H({},U),E++;ea(t.events,S+1,0,t.events.slice(w)),t.events.length=E}}function v(b){let N=r.length;for(;N-- >b;){const F=r[N];t.containerState=F[1],X(F[0].exit,"expected `exit` to be defined on container construct"),F[0].exit.call(t,e)}r.length=b}function C(){X(t.containerState,"expected `containerState` to be defined when closing flow"),X(a,"expected `childFlow` to be defined when closing it"),a.write([A.eof]),i=void 0,a=void 0,t.containerState._closeFlow=void 0}}function ZG(e,t,r){return X(this.parser.constructs.disable.null,"expected `disable.null` to be populated"),St(e,e.attempt(this.parser.constructs.document,t,r),T.linePrefix,this.parser.constructs.disable.null.includes("codeIndented")?void 0:Re.tabSize)}function Mw(e){if(e===A.eof||Ir(e)||GG(e))return Re.characterGroupWhitespace;if(WG(e))return Re.characterGroupPunctuation}function t1(e,t,r){const n=[];let a=-1;for(;++a<e.length;){const i=e[a].resolveAll;i&&!n.includes(i)&&(t=i(t,r),n.push(i))}return t}const Jp={name:"attention",resolveAll:JG,tokenize:eY};function JG(e,t){let r=-1,n,a,i,s,o,l,u,c;for(;++r<e.length;)if(e[r][0]==="enter"&&e[r][1].type==="attentionSequence"&&e[r][1]._close){for(n=r;n--;)if(e[n][0]==="exit"&&e[n][1].type==="attentionSequence"&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[r][1]).charCodeAt(0)){if((e[n][1]._close||e[r][1]._open)&&(e[r][1].end.offset-e[r][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[r][1].end.offset-e[r][1].start.offset)%3))continue;l=e[n][1].end.offset-e[n][1].start.offset>1&&e[r][1].end.offset-e[r][1].start.offset>1?2:1;const m=H({},e[n][1].end),h=H({},e[r][1].start);jw(m,-l),jw(h,l),s={type:l>1?T.strongSequence:T.emphasisSequence,start:m,end:H({},e[n][1].end)},o={type:l>1?T.strongSequence:T.emphasisSequence,start:H({},e[r][1].start),end:h},i={type:l>1?T.strongText:T.emphasisText,start:H({},e[n][1].end),end:H({},e[r][1].start)},a={type:l>1?T.strong:T.emphasis,start:H({},s.start),end:H({},o.end)},e[n][1].end=H({},s.start),e[r][1].start=H({},o.end),u=[],e[n][1].end.offset-e[n][1].start.offset&&(u=cn(u,[["enter",e[n][1],t],["exit",e[n][1],t]])),u=cn(u,[["enter",a,t],["enter",s,t],["exit",s,t],["enter",i,t]]),X(t.parser.constructs.insideSpan.null,"expected `insideSpan` to be populated"),u=cn(u,t1(t.parser.constructs.insideSpan.null,e.slice(n+1,r),t)),u=cn(u,[["exit",i,t],["enter",o,t],["exit",o,t],["exit",a,t]]),e[r][1].end.offset-e[r][1].start.offset?(c=2,u=cn(u,[["enter",e[r][1],t],["exit",e[r][1],t]])):c=0,ea(e,n-1,r-n+3,u),r=n+u.length-c-2;break}}for(r=-1;++r<e.length;)e[r][1].type==="attentionSequence"&&(e[r][1].type="data");return e}function eY(e,t){const r=this.parser.constructs.attentionMarkers.null,n=this.previous,a=Mw(n);let i;return s;function s(l){return X(l===A.asterisk||l===A.underscore,"expected asterisk or underscore"),i=l,e.enter("attentionSequence"),o(l)}function o(l){if(l===i)return e.consume(l),o;const u=e.exit("attentionSequence"),c=Mw(l);X(r,"expected `attentionMarkers` to be populated");const m=!c||c===Re.characterGroupPunctuation&&a||r.includes(l),h=!a||a===Re.characterGroupPunctuation&&c||r.includes(n);return u._open=!!(i===A.asterisk?m:m&&(a||!h)),u._close=!!(i===A.asterisk?h:h&&(c||!m)),t(l)}}function jw(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const tY={name:"autolink",tokenize:rY};function rY(e,t,r){let n=0;return a;function a(f){return X(f===A.lessThan,"expected `<`"),e.enter(T.autolink),e.enter(T.autolinkMarker),e.consume(f),e.exit(T.autolinkMarker),e.enter(T.autolinkProtocol),i}function i(f){return Wn(f)?(e.consume(f),s):f===A.atSign?r(f):u(f)}function s(f){return f===A.plusSign||f===A.dash||f===A.dot||en(f)?(n=1,o(f)):u(f)}function o(f){return f===A.colon?(e.consume(f),n=0,l):(f===A.plusSign||f===A.dash||f===A.dot||en(f))&&n++<Re.autolinkSchemeSizeMax?(e.consume(f),o):(n=0,u(f))}function l(f){return f===A.greaterThan?(e.exit(T.autolinkProtocol),e.enter(T.autolinkMarker),e.consume(f),e.exit(T.autolinkMarker),e.exit(T.autolink),t):f===A.eof||f===A.space||f===A.lessThan||Qp(f)?r(f):(e.consume(f),l)}function u(f){return f===A.atSign?(e.consume(f),c):zG(f)?(e.consume(f),u):r(f)}function c(f){return en(f)?m(f):r(f)}function m(f){return f===A.dot?(e.consume(f),n=0,c):f===A.greaterThan?(e.exit(T.autolinkProtocol).type=T.autolinkEmail,e.enter(T.autolinkMarker),e.consume(f),e.exit(T.autolinkMarker),e.exit(T.autolink),t):h(f)}function h(f){if((f===A.dash||en(f))&&n++<Re.autolinkDomainSizeMax){const x=f===A.dash?h:m;return e.consume(f),x}return r(f)}}const tm={partial:!0,tokenize:nY};function nY(e,t,r){return n;function n(i){return ot(i)?St(e,a,T.linePrefix)(i):a(i)}function a(i){return i===A.eof||Ie(i)?t(i):r(i)}}const L3={continuation:{tokenize:iY},exit:sY,name:"blockQuote",tokenize:aY};function aY(e,t,r){const n=this;return a;function a(s){if(s===A.greaterThan){const o=n.containerState;return X(o,"expected `containerState` to be defined in container"),o.open||(e.enter(T.blockQuote,{_container:!0}),o.open=!0),e.enter(T.blockQuotePrefix),e.enter(T.blockQuoteMarker),e.consume(s),e.exit(T.blockQuoteMarker),i}return r(s)}function i(s){return ot(s)?(e.enter(T.blockQuotePrefixWhitespace),e.consume(s),e.exit(T.blockQuotePrefixWhitespace),e.exit(T.blockQuotePrefix),t):(e.exit(T.blockQuotePrefix),t(s))}}function iY(e,t,r){const n=this;return a;function a(s){return ot(s)?(X(n.parser.constructs.disable.null,"expected `disable.null` to be populated"),St(e,i,T.linePrefix,n.parser.constructs.disable.null.includes("codeIndented")?void 0:Re.tabSize)(s)):i(s)}function i(s){return e.attempt(L3,t,r)(s)}}function sY(e){e.exit(T.blockQuote)}const B3={name:"characterEscape",tokenize:oY};function oY(e,t,r){return n;function n(i){return X(i===A.backslash,"expected `\\`"),e.enter(T.characterEscape),e.enter(T.escapeMarker),e.consume(i),e.exit(T.escapeMarker),a}function a(i){return $G(i)?(e.enter(T.characterEscapeValue),e.consume(i),e.exit(T.characterEscapeValue),e.exit(T.characterEscape),t):r(i)}}const q3={name:"characterReference",tokenize:lY};function lY(e,t,r){const n=this;let a=0,i,s;return o;function o(m){return X(m===A.ampersand,"expected `&`"),e.enter(T.characterReference),e.enter(T.characterReferenceMarker),e.consume(m),e.exit(T.characterReferenceMarker),l}function l(m){return m===A.numberSign?(e.enter(T.characterReferenceMarkerNumeric),e.consume(m),e.exit(T.characterReferenceMarkerNumeric),u):(e.enter(T.characterReferenceValue),i=Re.characterReferenceNamedSizeMax,s=en,c(m))}function u(m){return m===A.uppercaseX||m===A.lowercaseX?(e.enter(T.characterReferenceMarkerHexadecimal),e.consume(m),e.exit(T.characterReferenceMarkerHexadecimal),e.enter(T.characterReferenceValue),i=Re.characterReferenceHexadecimalSizeMax,s=HG,c):(e.enter(T.characterReferenceValue),i=Re.characterReferenceDecimalSizeMax,s=Zp,c(m))}function c(m){if(m===A.semicolon&&a){const h=e.exit(T.characterReferenceValue);return s===en&&!e1(n.sliceSerialize(h))?r(m):(e.enter(T.characterReferenceMarker),e.consume(m),e.exit(T.characterReferenceMarker),e.exit(T.characterReference),t)}return s(m)&&a++<i?(e.consume(m),c):r(m)}}const Lw={partial:!0,tokenize:cY},Bw={concrete:!0,name:"codeFenced",tokenize:uY};function uY(e,t,r){const n=this,a={partial:!0,tokenize:F};let i=0,s=0,o;return l;function l(E){return u(E)}function u(E){X(E===A.graveAccent||E===A.tilde,"expected `` ` `` or `~`");const w=n.events[n.events.length-1];return i=w&&w[1].type===T.linePrefix?w[2].sliceSerialize(w[1],!0).length:0,o=E,e.enter(T.codeFenced),e.enter(T.codeFencedFence),e.enter(T.codeFencedFenceSequence),c(E)}function c(E){return E===o?(s++,e.consume(E),c):s<Re.codeFencedSequenceSizeMin?r(E):(e.exit(T.codeFencedFenceSequence),ot(E)?St(e,m,T.whitespace)(E):m(E))}function m(E){return E===A.eof||Ie(E)?(e.exit(T.codeFencedFence),n.interrupt?t(E):e.check(Lw,p,N)(E)):(e.enter(T.codeFencedFenceInfo),e.enter(T.chunkString,{contentType:Re.contentTypeString}),h(E))}function h(E){return E===A.eof||Ie(E)?(e.exit(T.chunkString),e.exit(T.codeFencedFenceInfo),m(E)):ot(E)?(e.exit(T.chunkString),e.exit(T.codeFencedFenceInfo),St(e,f,T.whitespace)(E)):E===A.graveAccent&&E===o?r(E):(e.consume(E),h)}function f(E){return E===A.eof||Ie(E)?m(E):(e.enter(T.codeFencedFenceMeta),e.enter(T.chunkString,{contentType:Re.contentTypeString}),x(E))}function x(E){return E===A.eof||Ie(E)?(e.exit(T.chunkString),e.exit(T.codeFencedFenceMeta),m(E)):E===A.graveAccent&&E===o?r(E):(e.consume(E),x)}function p(E){return X(Ie(E),"expected eol"),e.attempt(a,N,g)(E)}function g(E){return X(Ie(E),"expected eol"),e.enter(T.lineEnding),e.consume(E),e.exit(T.lineEnding),v}function v(E){return i>0&&ot(E)?St(e,C,T.linePrefix,i+1)(E):C(E)}function C(E){return E===A.eof||Ie(E)?e.check(Lw,p,N)(E):(e.enter(T.codeFlowValue),b(E))}function b(E){return E===A.eof||Ie(E)?(e.exit(T.codeFlowValue),C(E)):(e.consume(E),b)}function N(E){return e.exit(T.codeFenced),t(E)}function F(E,w,S){let _=0;return U;function U(K){return X(Ie(K),"expected eol"),E.enter(T.lineEnding),E.consume(K),E.exit(T.lineEnding),R}function R(K){return X(n.parser.constructs.disable.null,"expected `disable.null` to be populated"),E.enter(T.codeFencedFence),ot(K)?St(E,q,T.linePrefix,n.parser.constructs.disable.null.includes("codeIndented")?void 0:Re.tabSize)(K):q(K)}function q(K){return K===o?(E.enter(T.codeFencedFenceSequence),M(K)):S(K)}function M(K){return K===o?(_++,E.consume(K),M):_>=s?(E.exit(T.codeFencedFenceSequence),ot(K)?St(E,Y,T.whitespace)(K):Y(K)):S(K)}function Y(K){return K===A.eof||Ie(K)?(E.exit(T.codeFencedFence),w(K)):S(K)}}}function cY(e,t,r){const n=this;return a;function a(s){return s===A.eof?r(s):(X(Ie(s),"expected eol"),e.enter(T.lineEnding),e.consume(s),e.exit(T.lineEnding),i)}function i(s){return n.parser.lazy[n.now().line]?r(s):t(s)}}const W0={name:"codeIndented",tokenize:dY},mY={partial:!0,tokenize:fY};function dY(e,t,r){const n=this;return a;function a(u){return X(ot(u)),e.enter(T.codeIndented),St(e,i,T.linePrefix,Re.tabSize+1)(u)}function i(u){const c=n.events[n.events.length-1];return c&&c[1].type===T.linePrefix&&c[2].sliceSerialize(c[1],!0).length>=Re.tabSize?s(u):r(u)}function s(u){return u===A.eof?l(u):Ie(u)?e.attempt(mY,s,l)(u):(e.enter(T.codeFlowValue),o(u))}function o(u){return u===A.eof||Ie(u)?(e.exit(T.codeFlowValue),s(u)):(e.consume(u),o)}function l(u){return e.exit(T.codeIndented),t(u)}}function fY(e,t,r){const n=this;return a;function a(s){return n.parser.lazy[n.now().line]?r(s):Ie(s)?(e.enter(T.lineEnding),e.consume(s),e.exit(T.lineEnding),a):St(e,i,T.linePrefix,Re.tabSize+1)(s)}function i(s){const o=n.events[n.events.length-1];return o&&o[1].type===T.linePrefix&&o[2].sliceSerialize(o[1],!0).length>=Re.tabSize?t(s):Ie(s)?a(s):r(s)}}const hY={name:"codeText",previous:z3,resolve:pY,tokenize:xY};function pY(e){let t=e.length-4,r=3,n,a;if((e[r][1].type===T.lineEnding||e[r][1].type==="space")&&(e[t][1].type===T.lineEnding||e[t][1].type==="space")){for(n=r;++n<t;)if(e[n][1].type===T.codeTextData){e[r][1].type=T.codeTextPadding,e[t][1].type=T.codeTextPadding,r+=2,t-=2;break}}for(n=r-1,t++;++n<=t;)a===void 0?n!==t&&e[n][1].type!==T.lineEnding&&(a=n):(n===t||e[n][1].type===T.lineEnding)&&(e[a][1].type=T.codeTextData,n!==a+2&&(e[a][1].end=e[n-1][1].end,e.splice(a+2,n-a-2),t-=n-a-2,n=a+2),a=void 0);return e}function z3(e){return e!==A.graveAccent||this.events[this.events.length-1][1].type===T.characterEscape}function xY(e,t,r){const n=this;let a=0,i,s;return o;function o(h){return X(h===A.graveAccent,"expected `` ` ``"),X(z3.call(n,n.previous),"expected correct previous"),e.enter(T.codeText),e.enter(T.codeTextSequence),l(h)}function l(h){return h===A.graveAccent?(e.consume(h),a++,l):(e.exit(T.codeTextSequence),u(h))}function u(h){return h===A.eof?r(h):h===A.space?(e.enter("space"),e.consume(h),e.exit("space"),u):h===A.graveAccent?(s=e.enter(T.codeTextSequence),i=0,m(h)):Ie(h)?(e.enter(T.lineEnding),e.consume(h),e.exit(T.lineEnding),u):(e.enter(T.codeTextData),c(h))}function c(h){return h===A.eof||h===A.space||h===A.graveAccent||Ie(h)?(e.exit(T.codeTextData),u(h)):(e.consume(h),c)}function m(h){return h===A.graveAccent?(e.consume(h),i++,m):i===a?(e.exit(T.codeTextSequence),e.exit(T.codeText),t(h)):(s.type=T.codeTextData,c(h))}}class gY{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,r){const n=r==null?Number.POSITIVE_INFINITY:r;return n<this.left.length?this.left.slice(t,n):t>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(t,r,n){const a=r||0;this.setCursor(Math.trunc(t));const i=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return n&&wo(this.left,n),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),wo(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),wo(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const r=this.left.splice(t,Number.POSITIVE_INFINITY);wo(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);wo(this.left,r.reverse())}}}function wo(e,t){let r=0;if(t.length<Re.v8MaxSafeChunkSize)e.push(...t);else for(;r<t.length;)e.push(...t.slice(r,r+Re.v8MaxSafeChunkSize)),r+=Re.v8MaxSafeChunkSize}function H3(e){const t={};let r=-1,n,a,i,s,o,l,u;const c=new gY(e);for(;++r<c.length;){for(;r in t;)r=t[r];if(n=c.get(r),r&&n[1].type===T.chunkFlow&&c.get(r-1)[1].type===T.listItemPrefix&&(X(n[1]._tokenizer,"expected `_tokenizer` on subtokens"),l=n[1]._tokenizer.events,i=0,i<l.length&&l[i][1].type===T.lineEndingBlank&&(i+=2),i<l.length&&l[i][1].type===T.content))for(;++i<l.length&&l[i][1].type!==T.content;)l[i][1].type===T.chunkText&&(l[i][1]._isInFirstContentOfListItem=!0,i++);if(n[0]==="enter")n[1].contentType&&(Object.assign(t,vY(c,r)),r=t[r],u=!0);else if(n[1]._container){for(i=r,a=void 0;i--;)if(s=c.get(i),s[1].type===T.lineEnding||s[1].type===T.lineEndingBlank)s[0]==="enter"&&(a&&(c.get(a)[1].type=T.lineEndingBlank),s[1].type=T.lineEnding,a=i);else if(!(s[1].type===T.linePrefix||s[1].type===T.listItemIndent))break;a&&(n[1].end=H({},c.get(a)[1].start),o=c.slice(a,r),o.unshift(n),c.splice(a,r-a+1,o))}}return ea(e,0,Number.POSITIVE_INFINITY,c.slice(0)),!u}function vY(e,t){const r=e.get(t)[1],n=e.get(t)[2];let a=t-1;const i=[];X(r.contentType,"expected `contentType` on subtokens");let s=r._tokenizer;s||(s=n.parser[r.contentType](r.start),r._contentTypeTextTrailing&&(s._contentTypeTextTrailing=!0));const o=s.events,l=[],u={};let c,m,h=-1,f=r,x=0,p=0;const g=[p];for(;f;){for(;e.get(++a)[1]!==f;);X(!m||f.previous===m,"expected previous to match"),X(!m||m.next===f,"expected next to match"),i.push(a),f._tokenizer||(c=n.sliceStream(f),f.next||c.push(A.eof),m&&s.defineSkip(f.start),f._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(c),f._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),m=f,f=f.next}for(f=r;++h<o.length;)o[h][0]==="exit"&&o[h-1][0]==="enter"&&o[h][1].type===o[h-1][1].type&&o[h][1].start.line!==o[h][1].end.line&&(X(f,"expected a current token"),p=h+1,g.push(p),f._tokenizer=void 0,f.previous=void 0,f=f.next);for(s.events=[],f?(f._tokenizer=void 0,f.previous=void 0,X(!f.next,"expected no next token")):g.pop(),h=g.length;h--;){const v=o.slice(g[h],g[h+1]),C=i.pop();X(C!==void 0,"expected a start position when splicing"),l.push([C,C+v.length-1]),e.splice(C,2,v)}for(l.reverse(),h=-1;++h<l.length;)u[x+l[h][0]]=x+l[h][1],x+=l[h][1]-l[h][0]-1;return u}const bY={resolve:yY,tokenize:CY},NY={partial:!0,tokenize:wY};function yY(e){return H3(e),e}function CY(e,t){let r;return n;function n(o){return X(o!==A.eof&&!Ie(o),"expected no eof or eol"),e.enter(T.content),r=e.enter(T.chunkContent,{contentType:Re.contentTypeContent}),a(o)}function a(o){return o===A.eof?i(o):Ie(o)?e.check(NY,s,i)(o):(e.consume(o),a)}function i(o){return e.exit(T.chunkContent),e.exit(T.content),t(o)}function s(o){return X(Ie(o),"expected eol"),e.consume(o),e.exit(T.chunkContent),X(r,"expected previous token"),r.next=e.enter(T.chunkContent,{contentType:Re.contentTypeContent,previous:r}),r=r.next,a}}function wY(e,t,r){const n=this;return a;function a(s){return X(Ie(s),"expected a line ending"),e.exit(T.chunkContent),e.enter(T.lineEnding),e.consume(s),e.exit(T.lineEnding),St(e,i,T.linePrefix)}function i(s){if(s===A.eof||Ie(s))return r(s);X(n.parser.constructs.disable.null,"expected `disable.null` to be populated");const o=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type===T.linePrefix&&o[2].sliceSerialize(o[1],!0).length>=Re.tabSize?t(s):e.interrupt(n.parser.constructs.flow,r,t)(s)}}function $3(e,t,r,n,a,i,s,o,l){const u=l||Number.POSITIVE_INFINITY;let c=0;return m;function m(v){return v===A.lessThan?(e.enter(n),e.enter(a),e.enter(i),e.consume(v),e.exit(i),h):v===A.eof||v===A.space||v===A.rightParenthesis||Qp(v)?r(v):(e.enter(n),e.enter(s),e.enter(o),e.enter(T.chunkString,{contentType:Re.contentTypeString}),p(v))}function h(v){return v===A.greaterThan?(e.enter(i),e.consume(v),e.exit(i),e.exit(a),e.exit(n),t):(e.enter(o),e.enter(T.chunkString,{contentType:Re.contentTypeString}),f(v))}function f(v){return v===A.greaterThan?(e.exit(T.chunkString),e.exit(o),h(v)):v===A.eof||v===A.lessThan||Ie(v)?r(v):(e.consume(v),v===A.backslash?x:f)}function x(v){return v===A.lessThan||v===A.greaterThan||v===A.backslash?(e.consume(v),f):f(v)}function p(v){return!c&&(v===A.eof||v===A.rightParenthesis||Ir(v))?(e.exit(T.chunkString),e.exit(o),e.exit(s),e.exit(n),t(v)):c<u&&v===A.leftParenthesis?(e.consume(v),c++,p):v===A.rightParenthesis?(e.consume(v),c--,p):v===A.eof||v===A.space||v===A.leftParenthesis||Qp(v)?r(v):(e.consume(v),v===A.backslash?g:p)}function g(v){return v===A.leftParenthesis||v===A.rightParenthesis||v===A.backslash?(e.consume(v),p):p(v)}}function W3(e,t,r,n,a,i){const s=this;let o=0,l;return u;function u(f){return X(f===A.leftSquareBracket,"expected `[`"),e.enter(n),e.enter(a),e.consume(f),e.exit(a),e.enter(i),c}function c(f){return o>Re.linkReferenceSizeMax||f===A.eof||f===A.leftSquareBracket||f===A.rightSquareBracket&&!l||f===A.caret&&!o&&"_hiddenFootnoteSupport"in s.parser.constructs?r(f):f===A.rightSquareBracket?(e.exit(i),e.enter(a),e.consume(f),e.exit(a),e.exit(n),t):Ie(f)?(e.enter(T.lineEnding),e.consume(f),e.exit(T.lineEnding),c):(e.enter(T.chunkString,{contentType:Re.contentTypeString}),m(f))}function m(f){return f===A.eof||f===A.leftSquareBracket||f===A.rightSquareBracket||Ie(f)||o++>Re.linkReferenceSizeMax?(e.exit(T.chunkString),c(f)):(e.consume(f),l||(l=!ot(f)),f===A.backslash?h:m)}function h(f){return f===A.leftSquareBracket||f===A.backslash||f===A.rightSquareBracket?(e.consume(f),o++,m):m(f)}}function G3(e,t,r,n,a,i){let s;return o;function o(h){return h===A.quotationMark||h===A.apostrophe||h===A.leftParenthesis?(e.enter(n),e.enter(a),e.consume(h),e.exit(a),s=h===A.leftParenthesis?A.rightParenthesis:h,l):r(h)}function l(h){return h===s?(e.enter(a),e.consume(h),e.exit(a),e.exit(n),t):(e.enter(i),u(h))}function u(h){return h===s?(e.exit(i),l(s)):h===A.eof?r(h):Ie(h)?(e.enter(T.lineEnding),e.consume(h),e.exit(T.lineEnding),St(e,u,T.linePrefix)):(e.enter(T.chunkString,{contentType:Re.contentTypeString}),c(h))}function c(h){return h===s||h===A.eof||Ie(h)?(e.exit(T.chunkString),u(h)):(e.consume(h),h===A.backslash?m:c)}function m(h){return h===s||h===A.backslash?(e.consume(h),c):c(h)}}function zo(e,t){let r;return n;function n(a){return Ie(a)?(e.enter(T.lineEnding),e.consume(a),e.exit(T.lineEnding),r=!0,n):ot(a)?St(e,n,r?T.linePrefix:T.lineSuffix)(a):t(a)}}const EY={name:"definition",tokenize:SY},_Y={partial:!0,tokenize:TY};function SY(e,t,r){const n=this;let a;return i;function i(f){return e.enter(T.definition),s(f)}function s(f){return X(f===A.leftSquareBracket,"expected `[`"),W3.call(n,e,o,r,T.definitionLabel,T.definitionLabelMarker,T.definitionLabelString)(f)}function o(f){return a=ks(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),f===A.colon?(e.enter(T.definitionMarker),e.consume(f),e.exit(T.definitionMarker),l):r(f)}function l(f){return Ir(f)?zo(e,u)(f):u(f)}function u(f){return $3(e,c,r,T.definitionDestination,T.definitionDestinationLiteral,T.definitionDestinationLiteralMarker,T.definitionDestinationRaw,T.definitionDestinationString)(f)}function c(f){return e.attempt(_Y,m,m)(f)}function m(f){return ot(f)?St(e,h,T.whitespace)(f):h(f)}function h(f){return f===A.eof||Ie(f)?(e.exit(T.definition),n.parser.defined.push(a),t(f)):r(f)}}function TY(e,t,r){return n;function n(o){return Ir(o)?zo(e,a)(o):r(o)}function a(o){return G3(e,i,r,T.definitionTitle,T.definitionTitleMarker,T.definitionTitleString)(o)}function i(o){return ot(o)?St(e,s,T.whitespace)(o):s(o)}function s(o){return o===A.eof||Ie(o)?t(o):r(o)}}const DY={name:"hardBreakEscape",tokenize:AY};function AY(e,t,r){return n;function n(i){return X(i===A.backslash,"expected `\\`"),e.enter(T.hardBreakEscape),e.consume(i),a}function a(i){return Ie(i)?(e.exit(T.hardBreakEscape),t(i)):r(i)}}const kY={name:"headingAtx",resolve:FY,tokenize:UY};function FY(e,t){let r=e.length-2,n=3,a,i;return e[n][1].type===T.whitespace&&(n+=2),r-2>n&&e[r][1].type===T.whitespace&&(r-=2),e[r][1].type===T.atxHeadingSequence&&(n===r-1||r-4>n&&e[r-2][1].type===T.whitespace)&&(r-=n+1===r?2:4),r>n&&(a={type:T.atxHeadingText,start:e[n][1].start,end:e[r][1].end},i={type:T.chunkText,start:e[n][1].start,end:e[r][1].end,contentType:Re.contentTypeText},ea(e,n,r-n+1,[["enter",a,t],["enter",i,t],["exit",i,t],["exit",a,t]])),e}function UY(e,t,r){let n=0;return a;function a(c){return e.enter(T.atxHeading),i(c)}function i(c){return X(c===A.numberSign,"expected `#`"),e.enter(T.atxHeadingSequence),s(c)}function s(c){return c===A.numberSign&&n++<Re.atxHeadingOpeningFenceSizeMax?(e.consume(c),s):c===A.eof||Ir(c)?(e.exit(T.atxHeadingSequence),o(c)):r(c)}function o(c){return c===A.numberSign?(e.enter(T.atxHeadingSequence),l(c)):c===A.eof||Ie(c)?(e.exit(T.atxHeading),t(c)):ot(c)?St(e,o,T.whitespace)(c):(e.enter(T.atxHeadingText),u(c))}function l(c){return c===A.numberSign?(e.consume(c),l):(e.exit(T.atxHeadingSequence),o(c))}function u(c){return c===A.eof||c===A.numberSign||Ir(c)?(e.exit(T.atxHeadingText),o(c)):(e.consume(c),u)}}const RY=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],qw=["pre","script","style","textarea"],OY={concrete:!0,name:"htmlFlow",resolveTo:IY,tokenize:MY},VY={partial:!0,tokenize:LY},PY={partial:!0,tokenize:jY};function IY(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type===T.htmlFlow););return t>1&&e[t-2][1].type===T.linePrefix&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function MY(e,t,r){const n=this;let a,i,s,o,l;return u;function u(y){return c(y)}function c(y){return X(y===A.lessThan,"expected `<`"),e.enter(T.htmlFlow),e.enter(T.htmlFlowData),e.consume(y),m}function m(y){return y===A.exclamationMark?(e.consume(y),h):y===A.slash?(e.consume(y),i=!0,p):y===A.questionMark?(e.consume(y),a=Re.htmlInstruction,n.interrupt?t:k):Wn(y)?(X(y!==null),e.consume(y),s=String.fromCharCode(y),g):r(y)}function h(y){return y===A.dash?(e.consume(y),a=Re.htmlComment,f):y===A.leftSquareBracket?(e.consume(y),a=Re.htmlCdata,o=0,x):Wn(y)?(e.consume(y),a=Re.htmlDeclaration,n.interrupt?t:k):r(y)}function f(y){return y===A.dash?(e.consume(y),n.interrupt?t:k):r(y)}function x(y){const V=Re.cdataOpeningString;return y===V.charCodeAt(o++)?(e.consume(y),o===V.length?n.interrupt?t:q:x):r(y)}function p(y){return Wn(y)?(X(y!==null),e.consume(y),s=String.fromCharCode(y),g):r(y)}function g(y){if(y===A.eof||y===A.slash||y===A.greaterThan||Ir(y)){const V=y===A.slash,I=s.toLowerCase();return!V&&!i&&qw.includes(I)?(a=Re.htmlRaw,n.interrupt?t(y):q(y)):RY.includes(s.toLowerCase())?(a=Re.htmlBasic,V?(e.consume(y),v):n.interrupt?t(y):q(y)):(a=Re.htmlComplete,n.interrupt&&!n.parser.lazy[n.now().line]?r(y):i?C(y):b(y))}return y===A.dash||en(y)?(e.consume(y),s+=String.fromCharCode(y),g):r(y)}function v(y){return y===A.greaterThan?(e.consume(y),n.interrupt?t:q):r(y)}function C(y){return ot(y)?(e.consume(y),C):U(y)}function b(y){return y===A.slash?(e.consume(y),U):y===A.colon||y===A.underscore||Wn(y)?(e.consume(y),N):ot(y)?(e.consume(y),b):U(y)}function N(y){return y===A.dash||y===A.dot||y===A.colon||y===A.underscore||en(y)?(e.consume(y),N):F(y)}function F(y){return y===A.equalsTo?(e.consume(y),E):ot(y)?(e.consume(y),F):b(y)}function E(y){return y===A.eof||y===A.lessThan||y===A.equalsTo||y===A.greaterThan||y===A.graveAccent?r(y):y===A.quotationMark||y===A.apostrophe?(e.consume(y),l=y,w):ot(y)?(e.consume(y),E):S(y)}function w(y){return y===l?(e.consume(y),l=null,_):y===A.eof||Ie(y)?r(y):(e.consume(y),w)}function S(y){return y===A.eof||y===A.quotationMark||y===A.apostrophe||y===A.slash||y===A.lessThan||y===A.equalsTo||y===A.greaterThan||y===A.graveAccent||Ir(y)?F(y):(e.consume(y),S)}function _(y){return y===A.slash||y===A.greaterThan||ot(y)?b(y):r(y)}function U(y){return y===A.greaterThan?(e.consume(y),R):r(y)}function R(y){return y===A.eof||Ie(y)?q(y):ot(y)?(e.consume(y),R):r(y)}function q(y){return y===A.dash&&a===Re.htmlComment?(e.consume(y),de):y===A.lessThan&&a===Re.htmlRaw?(e.consume(y),pe):y===A.greaterThan&&a===Re.htmlDeclaration?(e.consume(y),le):y===A.questionMark&&a===Re.htmlInstruction?(e.consume(y),k):y===A.rightSquareBracket&&a===Re.htmlCdata?(e.consume(y),Ne):Ie(y)&&(a===Re.htmlBasic||a===Re.htmlComplete)?(e.exit(T.htmlFlowData),e.check(VY,j,M)(y)):y===A.eof||Ie(y)?(e.exit(T.htmlFlowData),M(y)):(e.consume(y),q)}function M(y){return e.check(PY,Y,j)(y)}function Y(y){return X(Ie(y)),e.enter(T.lineEnding),e.consume(y),e.exit(T.lineEnding),K}function K(y){return y===A.eof||Ie(y)?M(y):(e.enter(T.htmlFlowData),q(y))}function de(y){return y===A.dash?(e.consume(y),k):q(y)}function pe(y){return y===A.slash?(e.consume(y),s="",Ae):q(y)}function Ae(y){if(y===A.greaterThan){const V=s.toLowerCase();return qw.includes(V)?(e.consume(y),le):q(y)}return Wn(y)&&s.length<Re.htmlRawSizeMax?(X(y!==null),e.consume(y),s+=String.fromCharCode(y),Ae):q(y)}function Ne(y){return y===A.rightSquareBracket?(e.consume(y),k):q(y)}function k(y){return y===A.greaterThan?(e.consume(y),le):y===A.dash&&a===Re.htmlComment?(e.consume(y),k):q(y)}function le(y){return y===A.eof||Ie(y)?(e.exit(T.htmlFlowData),j(y)):(e.consume(y),le)}function j(y){return e.exit(T.htmlFlow),t(y)}}function jY(e,t,r){const n=this;return a;function a(s){return Ie(s)?(e.enter(T.lineEnding),e.consume(s),e.exit(T.lineEnding),i):r(s)}function i(s){return n.parser.lazy[n.now().line]?r(s):t(s)}}function LY(e,t,r){return n;function n(a){return X(Ie(a),"expected a line ending"),e.enter(T.lineEnding),e.consume(a),e.exit(T.lineEnding),e.attempt(tm,t,r)}}const BY={name:"htmlText",tokenize:qY};function qY(e,t,r){const n=this;let a,i,s;return o;function o(k){return X(k===A.lessThan,"expected `<`"),e.enter(T.htmlText),e.enter(T.htmlTextData),e.consume(k),l}function l(k){return k===A.exclamationMark?(e.consume(k),u):k===A.slash?(e.consume(k),F):k===A.questionMark?(e.consume(k),b):Wn(k)?(e.consume(k),S):r(k)}function u(k){return k===A.dash?(e.consume(k),c):k===A.leftSquareBracket?(e.consume(k),i=0,x):Wn(k)?(e.consume(k),C):r(k)}function c(k){return k===A.dash?(e.consume(k),f):r(k)}function m(k){return k===A.eof?r(k):k===A.dash?(e.consume(k),h):Ie(k)?(s=m,pe(k)):(e.consume(k),m)}function h(k){return k===A.dash?(e.consume(k),f):m(k)}function f(k){return k===A.greaterThan?de(k):k===A.dash?h(k):m(k)}function x(k){const le=Re.cdataOpeningString;return k===le.charCodeAt(i++)?(e.consume(k),i===le.length?p:x):r(k)}function p(k){return k===A.eof?r(k):k===A.rightSquareBracket?(e.consume(k),g):Ie(k)?(s=p,pe(k)):(e.consume(k),p)}function g(k){return k===A.rightSquareBracket?(e.consume(k),v):p(k)}function v(k){return k===A.greaterThan?de(k):k===A.rightSquareBracket?(e.consume(k),v):p(k)}function C(k){return k===A.eof||k===A.greaterThan?de(k):Ie(k)?(s=C,pe(k)):(e.consume(k),C)}function b(k){return k===A.eof?r(k):k===A.questionMark?(e.consume(k),N):Ie(k)?(s=b,pe(k)):(e.consume(k),b)}function N(k){return k===A.greaterThan?de(k):b(k)}function F(k){return Wn(k)?(e.consume(k),E):r(k)}function E(k){return k===A.dash||en(k)?(e.consume(k),E):w(k)}function w(k){return Ie(k)?(s=w,pe(k)):ot(k)?(e.consume(k),w):de(k)}function S(k){return k===A.dash||en(k)?(e.consume(k),S):k===A.slash||k===A.greaterThan||Ir(k)?_(k):r(k)}function _(k){return k===A.slash?(e.consume(k),de):k===A.colon||k===A.underscore||Wn(k)?(e.consume(k),U):Ie(k)?(s=_,pe(k)):ot(k)?(e.consume(k),_):de(k)}function U(k){return k===A.dash||k===A.dot||k===A.colon||k===A.underscore||en(k)?(e.consume(k),U):R(k)}function R(k){return k===A.equalsTo?(e.consume(k),q):Ie(k)?(s=R,pe(k)):ot(k)?(e.consume(k),R):_(k)}function q(k){return k===A.eof||k===A.lessThan||k===A.equalsTo||k===A.greaterThan||k===A.graveAccent?r(k):k===A.quotationMark||k===A.apostrophe?(e.consume(k),a=k,M):Ie(k)?(s=q,pe(k)):ot(k)?(e.consume(k),q):(e.consume(k),Y)}function M(k){return k===a?(e.consume(k),a=void 0,K):k===A.eof?r(k):Ie(k)?(s=M,pe(k)):(e.consume(k),M)}function Y(k){return k===A.eof||k===A.quotationMark||k===A.apostrophe||k===A.lessThan||k===A.equalsTo||k===A.graveAccent?r(k):k===A.slash||k===A.greaterThan||Ir(k)?_(k):(e.consume(k),Y)}function K(k){return k===A.slash||k===A.greaterThan||Ir(k)?_(k):r(k)}function de(k){return k===A.greaterThan?(e.consume(k),e.exit(T.htmlTextData),e.exit(T.htmlText),t):r(k)}function pe(k){return X(s,"expected return state"),X(Ie(k),"expected eol"),e.exit(T.htmlTextData),e.enter(T.lineEnding),e.consume(k),e.exit(T.lineEnding),Ae}function Ae(k){return X(n.parser.constructs.disable.null,"expected `disable.null` to be populated"),ot(k)?St(e,Ne,T.linePrefix,n.parser.constructs.disable.null.includes("codeIndented")?void 0:Re.tabSize)(k):Ne(k)}function Ne(k){return e.enter(T.htmlTextData),s(k)}}const r1={name:"labelEnd",resolveAll:WY,resolveTo:GY,tokenize:YY},zY={tokenize:XY},HY={tokenize:KY},$Y={tokenize:QY};function WY(e){let t=-1;const r=[];for(;++t<e.length;){const n=e[t][1];if(r.push(e[t]),n.type===T.labelImage||n.type===T.labelLink||n.type===T.labelEnd){const a=n.type===T.labelImage?4:2;n.type=T.data,t+=a}}return e.length!==r.length&&ea(e,0,e.length,r),e}function GY(e,t){let r=e.length,n=0,a,i,s,o;for(;r--;)if(a=e[r][1],i){if(a.type===T.link||a.type===T.labelLink&&a._inactive)break;e[r][0]==="enter"&&a.type===T.labelLink&&(a._inactive=!0)}else if(s){if(e[r][0]==="enter"&&(a.type===T.labelImage||a.type===T.labelLink)&&!a._balanced&&(i=r,a.type!==T.labelLink)){n=2;break}}else a.type===T.labelEnd&&(s=r);X(i!==void 0,"`open` is supposed to be found"),X(s!==void 0,"`close` is supposed to be found");const l={type:e[i][1].type===T.labelLink?T.link:T.image,start:H({},e[i][1].start),end:H({},e[e.length-1][1].end)},u={type:T.label,start:H({},e[i][1].start),end:H({},e[s][1].end)},c={type:T.labelText,start:H({},e[i+n+2][1].end),end:H({},e[s-2][1].start)};return o=[["enter",l,t],["enter",u,t]],o=cn(o,e.slice(i+1,i+n+3)),o=cn(o,[["enter",c,t]]),X(t.parser.constructs.insideSpan.null,"expected `insideSpan.null` to be populated"),o=cn(o,t1(t.parser.constructs.insideSpan.null,e.slice(i+n+4,s-3),t)),o=cn(o,[["exit",c,t],e[s-2],e[s-1],["exit",u,t]]),o=cn(o,e.slice(s+1)),o=cn(o,[["exit",l,t]]),ea(e,i,e.length,o),e}function YY(e,t,r){const n=this;let a=n.events.length,i,s;for(;a--;)if((n.events[a][1].type===T.labelImage||n.events[a][1].type===T.labelLink)&&!n.events[a][1]._balanced){i=n.events[a][1];break}return o;function o(h){return X(h===A.rightSquareBracket,"expected `]`"),i?i._inactive?m(h):(s=n.parser.defined.includes(ks(n.sliceSerialize({start:i.end,end:n.now()}))),e.enter(T.labelEnd),e.enter(T.labelMarker),e.consume(h),e.exit(T.labelMarker),e.exit(T.labelEnd),l):r(h)}function l(h){return h===A.leftParenthesis?e.attempt(zY,c,s?c:m)(h):h===A.leftSquareBracket?e.attempt(HY,c,s?u:m)(h):s?c(h):m(h)}function u(h){return e.attempt($Y,c,m)(h)}function c(h){return t(h)}function m(h){return i._balanced=!0,r(h)}}function XY(e,t,r){return n;function n(m){return X(m===A.leftParenthesis,"expected left paren"),e.enter(T.resource),e.enter(T.resourceMarker),e.consume(m),e.exit(T.resourceMarker),a}function a(m){return Ir(m)?zo(e,i)(m):i(m)}function i(m){return m===A.rightParenthesis?c(m):$3(e,s,o,T.resourceDestination,T.resourceDestinationLiteral,T.resourceDestinationLiteralMarker,T.resourceDestinationRaw,T.resourceDestinationString,Re.linkResourceDestinationBalanceMax)(m)}function s(m){return Ir(m)?zo(e,l)(m):c(m)}function o(m){return r(m)}function l(m){return m===A.quotationMark||m===A.apostrophe||m===A.leftParenthesis?G3(e,u,r,T.resourceTitle,T.resourceTitleMarker,T.resourceTitleString)(m):c(m)}function u(m){return Ir(m)?zo(e,c)(m):c(m)}function c(m){return m===A.rightParenthesis?(e.enter(T.resourceMarker),e.consume(m),e.exit(T.resourceMarker),e.exit(T.resource),t):r(m)}}function KY(e,t,r){const n=this;return a;function a(o){return X(o===A.leftSquareBracket,"expected left bracket"),W3.call(n,e,i,s,T.reference,T.referenceMarker,T.referenceString)(o)}function i(o){return n.parser.defined.includes(ks(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?t(o):r(o)}function s(o){return r(o)}}function QY(e,t,r){return n;function n(i){return X(i===A.leftSquareBracket,"expected left bracket"),e.enter(T.reference),e.enter(T.referenceMarker),e.consume(i),e.exit(T.referenceMarker),a}function a(i){return i===A.rightSquareBracket?(e.enter(T.referenceMarker),e.consume(i),e.exit(T.referenceMarker),e.exit(T.reference),t):r(i)}}const ZY={name:"labelStartImage",resolveAll:r1.resolveAll,tokenize:JY};function JY(e,t,r){const n=this;return a;function a(o){return X(o===A.exclamationMark,"expected `!`"),e.enter(T.labelImage),e.enter(T.labelImageMarker),e.consume(o),e.exit(T.labelImageMarker),i}function i(o){return o===A.leftSquareBracket?(e.enter(T.labelMarker),e.consume(o),e.exit(T.labelMarker),e.exit(T.labelImage),s):r(o)}function s(o){return o===A.caret&&"_hiddenFootnoteSupport"in n.parser.constructs?r(o):t(o)}}const eX={name:"labelStartLink",resolveAll:r1.resolveAll,tokenize:tX};function tX(e,t,r){const n=this;return a;function a(s){return X(s===A.leftSquareBracket,"expected `[`"),e.enter(T.labelLink),e.enter(T.labelMarker),e.consume(s),e.exit(T.labelMarker),e.exit(T.labelLink),i}function i(s){return s===A.caret&&"_hiddenFootnoteSupport"in n.parser.constructs?r(s):t(s)}}const G0={name:"lineEnding",tokenize:rX};function rX(e,t){return r;function r(n){return X(Ie(n),"expected eol"),e.enter(T.lineEnding),e.consume(n),e.exit(T.lineEnding),St(e,t,T.linePrefix)}}const Fu={name:"thematicBreak",tokenize:nX};function nX(e,t,r){let n=0,a;return i;function i(u){return e.enter(T.thematicBreak),s(u)}function s(u){return X(u===A.asterisk||u===A.dash||u===A.underscore,"expected `*`, `-`, or `_`"),a=u,o(u)}function o(u){return u===a?(e.enter(T.thematicBreakSequence),l(u)):n>=Re.thematicBreakMarkerCountMin&&(u===A.eof||Ie(u))?(e.exit(T.thematicBreak),t(u)):r(u)}function l(u){return u===a?(e.consume(u),n++,l):(e.exit(T.thematicBreakSequence),ot(u)?St(e,o,T.whitespace)(u):o(u))}}const Or={continuation:{tokenize:oX},exit:uX,name:"list",tokenize:sX},aX={partial:!0,tokenize:cX},iX={partial:!0,tokenize:lX};function sX(e,t,r){const n=this,a=n.events[n.events.length-1];let i=a&&a[1].type===T.linePrefix?a[2].sliceSerialize(a[1],!0).length:0,s=0;return o;function o(f){X(n.containerState,"expected state");const x=n.containerState.type||(f===A.asterisk||f===A.plusSign||f===A.dash?T.listUnordered:T.listOrdered);if(x===T.listUnordered?!n.containerState.marker||f===n.containerState.marker:Zp(f)){if(n.containerState.type||(n.containerState.type=x,e.enter(x,{_container:!0})),x===T.listUnordered)return e.enter(T.listItemPrefix),f===A.asterisk||f===A.dash?e.check(Fu,r,u)(f):u(f);if(!n.interrupt||f===A.digit1)return e.enter(T.listItemPrefix),e.enter(T.listItemValue),l(f)}return r(f)}function l(f){return X(n.containerState,"expected state"),Zp(f)&&++s<Re.listItemValueSizeMax?(e.consume(f),l):(!n.interrupt||s<2)&&(n.containerState.marker?f===n.containerState.marker:f===A.rightParenthesis||f===A.dot)?(e.exit(T.listItemValue),u(f)):r(f)}function u(f){return X(n.containerState,"expected state"),X(f!==A.eof,"eof (`null`) is not a marker"),e.enter(T.listItemMarker),e.consume(f),e.exit(T.listItemMarker),n.containerState.marker=n.containerState.marker||f,e.check(tm,n.interrupt?r:c,e.attempt(aX,h,m))}function c(f){return X(n.containerState,"expected state"),n.containerState.initialBlankLine=!0,i++,h(f)}function m(f){return ot(f)?(e.enter(T.listItemPrefixWhitespace),e.consume(f),e.exit(T.listItemPrefixWhitespace),h):r(f)}function h(f){return X(n.containerState,"expected state"),n.containerState.size=i+n.sliceSerialize(e.exit(T.listItemPrefix),!0).length,t(f)}}function oX(e,t,r){const n=this;return X(n.containerState,"expected state"),n.containerState._closeFlow=void 0,e.check(tm,a,i);function a(o){return X(n.containerState,"expected state"),X(typeof n.containerState.size=="number","expected size"),n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,St(e,t,T.listItemIndent,n.containerState.size+1)(o)}function i(o){return X(n.containerState,"expected state"),n.containerState.furtherBlankLines||!ot(o)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,s(o)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,e.attempt(iX,t,s)(o))}function s(o){return X(n.containerState,"expected state"),n.containerState._closeFlow=!0,n.interrupt=void 0,X(n.parser.constructs.disable.null,"expected `disable.null` to be populated"),St(e,e.attempt(Or,t,r),T.linePrefix,n.parser.constructs.disable.null.includes("codeIndented")?void 0:Re.tabSize)(o)}}function lX(e,t,r){const n=this;return X(n.containerState,"expected state"),X(typeof n.containerState.size=="number","expected size"),St(e,a,T.listItemIndent,n.containerState.size+1);function a(i){X(n.containerState,"expected state");const s=n.events[n.events.length-1];return s&&s[1].type===T.listItemIndent&&s[2].sliceSerialize(s[1],!0).length===n.containerState.size?t(i):r(i)}}function uX(e){X(this.containerState,"expected state"),X(typeof this.containerState.type=="string","expected type"),e.exit(this.containerState.type)}function cX(e,t,r){const n=this;return X(n.parser.constructs.disable.null,"expected `disable.null` to be populated"),St(e,a,T.listItemPrefixWhitespace,n.parser.constructs.disable.null.includes("codeIndented")?void 0:Re.tabSize+1);function a(i){const s=n.events[n.events.length-1];return!ot(i)&&s&&s[1].type===T.listItemPrefixWhitespace?t(i):r(i)}}const zw={name:"setextUnderline",resolveTo:mX,tokenize:dX};function mX(e,t){let r=e.length,n,a,i;for(;r--;)if(e[r][0]==="enter"){if(e[r][1].type===T.content){n=r;break}e[r][1].type===T.paragraph&&(a=r)}else e[r][1].type===T.content&&e.splice(r,1),!i&&e[r][1].type===T.definition&&(i=r);X(a!==void 0,"expected a `text` index to be found"),X(n!==void 0,"expected a `text` index to be found"),X(e[n][2]===t,"enter context should be same"),X(e[e.length-1][2]===t,"enter context should be same");const s={type:T.setextHeading,start:H({},e[n][1].start),end:H({},e[e.length-1][1].end)};return e[a][1].type=T.setextHeadingText,i?(e.splice(a,0,["enter",s,t]),e.splice(i+1,0,["exit",e[n][1],t]),e[n][1].end=H({},e[i][1].end)):e[n][1]=s,e.push(["exit",s,t]),e}function dX(e,t,r){const n=this;let a;return i;function i(u){let c=n.events.length,m;for(X(u===A.dash||u===A.equalsTo,"expected `=` or `-`");c--;)if(n.events[c][1].type!==T.lineEnding&&n.events[c][1].type!==T.linePrefix&&n.events[c][1].type!==T.content){m=n.events[c][1].type===T.paragraph;break}return!n.parser.lazy[n.now().line]&&(n.interrupt||m)?(e.enter(T.setextHeadingLine),a=u,s(u)):r(u)}function s(u){return e.enter(T.setextHeadingLineSequence),o(u)}function o(u){return u===a?(e.consume(u),o):(e.exit(T.setextHeadingLineSequence),ot(u)?St(e,l,T.lineSuffix)(u):l(u))}function l(u){return u===A.eof||Ie(u)?(e.exit(T.setextHeadingLine),t(u)):r(u)}}const fX={tokenize:hX};function hX(e){const t=this,r=e.attempt(tm,n,e.attempt(this.parser.constructs.flowInitial,a,St(e,e.attempt(this.parser.constructs.flow,a,e.attempt(bY,a)),T.linePrefix)));return r;function n(i){if(X(i===A.eof||Ie(i),"expected eol or eof"),i===A.eof){e.consume(i);return}return e.enter(T.lineEndingBlank),e.consume(i),e.exit(T.lineEndingBlank),t.currentConstruct=void 0,r}function a(i){if(X(i===A.eof||Ie(i),"expected eol or eof"),i===A.eof){e.consume(i);return}return e.enter(T.lineEnding),e.consume(i),e.exit(T.lineEnding),t.currentConstruct=void 0,r}}const pX={resolveAll:X3()},xX=Y3("string"),gX=Y3("text");function Y3(e){return{resolveAll:X3(e==="text"?vX:void 0),tokenize:t};function t(r){const n=this,a=this.parser.constructs[e],i=r.attempt(a,s,o);return s;function s(c){return u(c)?i(c):o(c)}function o(c){if(c===A.eof){r.consume(c);return}return r.enter(T.data),r.consume(c),l}function l(c){return u(c)?(r.exit(T.data),i(c)):(r.consume(c),l)}function u(c){if(c===A.eof)return!0;const m=a[c];let h=-1;if(m)for(X(Array.isArray(m),"expected `disable.null` to be populated");++h<m.length;){const f=m[h];if(!f.previous||f.previous.call(n,n.previous))return!0}return!1}}}function X3(e){return t;function t(r,n){let a=-1,i;for(;++a<=r.length;)i===void 0?r[a]&&r[a][1].type===T.data&&(i=a,a++):(!r[a]||r[a][1].type!==T.data)&&(a!==i+2&&(r[i][1].end=r[a-1][1].end,r.splice(i+2,a-i-2),a=i+2),i=void 0);return e?e(r,n):r}}function vX(e,t){let r=0;for(;++r<=e.length;)if((r===e.length||e[r][1].type===T.lineEnding)&&e[r-1][1].type===T.data){const n=e[r-1][1],a=t.sliceStream(n);let i=a.length,s=-1,o=0,l;for(;i--;){const u=a[i];if(typeof u=="string"){for(s=u.length;u.charCodeAt(s-1)===A.space;)o++,s--;if(s)break;s=-1}else if(u===A.horizontalTab)l=!0,o++;else if(u!==A.virtualSpace){i++;break}}if(t._contentTypeTextTrailing&&r===e.length&&(o=0),o){const u={type:r===e.length||l||o<Re.hardBreakPrefixSizeMin?T.lineSuffix:T.hardBreakTrailing,start:{_bufferIndex:i?s:n.start._bufferIndex+s,_index:n.start._index+i,line:n.end.line,column:n.end.column-o,offset:n.end.offset-o},end:H({},n.end)};n.end=H({},u.start),n.start.offset===n.end.offset?Object.assign(n,u):(e.splice(r,0,["enter",u,t],["exit",u,t]),r+=2)}r++}return e}const bX={[A.asterisk]:Or,[A.plusSign]:Or,[A.dash]:Or,[A.digit0]:Or,[A.digit1]:Or,[A.digit2]:Or,[A.digit3]:Or,[A.digit4]:Or,[A.digit5]:Or,[A.digit6]:Or,[A.digit7]:Or,[A.digit8]:Or,[A.digit9]:Or,[A.greaterThan]:L3},NX={[A.leftSquareBracket]:EY},yX={[A.horizontalTab]:W0,[A.virtualSpace]:W0,[A.space]:W0},CX={[A.numberSign]:kY,[A.asterisk]:Fu,[A.dash]:[zw,Fu],[A.lessThan]:OY,[A.equalsTo]:zw,[A.underscore]:Fu,[A.graveAccent]:Bw,[A.tilde]:Bw},wX={[A.ampersand]:q3,[A.backslash]:B3},EX={[A.carriageReturn]:G0,[A.lineFeed]:G0,[A.carriageReturnLineFeed]:G0,[A.exclamationMark]:ZY,[A.ampersand]:q3,[A.asterisk]:Jp,[A.lessThan]:[tY,BY],[A.leftSquareBracket]:eX,[A.backslash]:[DY,B3],[A.rightSquareBracket]:r1,[A.underscore]:Jp,[A.graveAccent]:hY},_X={null:[Jp,pX]},SX={null:[A.asterisk,A.underscore]},TX={null:[]},DX=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:SX,contentInitial:NX,disable:TX,document:bX,flow:CX,flowInitial:yX,insideSpan:_X,string:wX,text:EX},Symbol.toStringTag,{value:"Module"}));var Nu={exports:{}},Y0,Hw;function AX(){if(Hw)return Y0;Hw=1;var e=1e3,t=e*60,r=t*60,n=r*24,a=n*7,i=n*365.25;Y0=function(c,m){m=m||{};var h=typeof c;if(h==="string"&&c.length>0)return s(c);if(h==="number"&&isFinite(c))return m.long?l(c):o(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))};function s(c){if(c=String(c),!(c.length>100)){var m=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(c);if(m){var h=parseFloat(m[1]),f=(m[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return h*i;case"weeks":case"week":case"w":return h*a;case"days":case"day":case"d":return h*n;case"hours":case"hour":case"hrs":case"hr":case"h":return h*r;case"minutes":case"minute":case"mins":case"min":case"m":return h*t;case"seconds":case"second":case"secs":case"sec":case"s":return h*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}}}function o(c){var m=Math.abs(c);return m>=n?Math.round(c/n)+"d":m>=r?Math.round(c/r)+"h":m>=t?Math.round(c/t)+"m":m>=e?Math.round(c/e)+"s":c+"ms"}function l(c){var m=Math.abs(c);return m>=n?u(c,m,n,"day"):m>=r?u(c,m,r,"hour"):m>=t?u(c,m,t,"minute"):m>=e?u(c,m,e,"second"):c+" ms"}function u(c,m,h,f){var x=m>=h*1.5;return Math.round(c/h)+" "+f+(x?"s":"")}return Y0}var X0,$w;function kX(){if($w)return X0;$w=1;function e(t){n.debug=n,n.default=n,n.coerce=u,n.disable=o,n.enable=i,n.enabled=l,n.humanize=AX(),n.destroy=c,Object.keys(t).forEach(m=>{n[m]=t[m]}),n.names=[],n.skips=[],n.formatters={};function r(m){let h=0;for(let f=0;f<m.length;f++)h=(h<<5)-h+m.charCodeAt(f),h|=0;return n.colors[Math.abs(h)%n.colors.length]}n.selectColor=r;function n(m){let h,f=null,x,p;function g(...v){if(!g.enabled)return;const C=g,b=Number(new Date),N=b-(h||b);C.diff=N,C.prev=h,C.curr=b,h=b,v[0]=n.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let F=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(w,S)=>{if(w==="%%")return"%";F++;const _=n.formatters[S];if(typeof _=="function"){const U=v[F];w=_.call(C,U),v.splice(F,1),F--}return w}),n.formatArgs.call(C,v),(C.log||n.log).apply(C,v)}return g.namespace=m,g.useColors=n.useColors(),g.color=n.selectColor(m),g.extend=a,g.destroy=n.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(x!==n.namespaces&&(x=n.namespaces,p=n.enabled(m)),p),set:v=>{f=v}}),typeof n.init=="function"&&n.init(g),g}function a(m,h){const f=n(this.namespace+(typeof h=="undefined"?":":h)+m);return f.log=this.log,f}function i(m){n.save(m),n.namespaces=m,n.names=[],n.skips=[];const h=(typeof m=="string"?m:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const f of h)f[0]==="-"?n.skips.push(f.slice(1)):n.names.push(f)}function s(m,h){let f=0,x=0,p=-1,g=0;for(;f<m.length;)if(x<h.length&&(h[x]===m[f]||h[x]==="*"))h[x]==="*"?(p=x,g=f,x++):(f++,x++);else if(p!==-1)x=p+1,g++,f=g;else return!1;for(;x<h.length&&h[x]==="*";)x++;return x===h.length}function o(){const m=[...n.names,...n.skips.map(h=>"-"+h)].join(",");return n.enable(""),m}function l(m){for(const h of n.skips)if(s(m,h))return!1;for(const h of n.names)if(s(m,h))return!0;return!1}function u(m){return m instanceof Error?m.stack||m.message:m}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}return X0=e,X0}var Ww;function FX(){return Ww||(Ww=1,(function(e,t){var r={};t.formatArgs=a,t.save=i,t.load=s,t.useColors=n,t.storage=o(),t.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let u;return typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&(u=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(u[1],10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;u.splice(1,0,c,"color: inherit");let m=0,h=0;u[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(m++,f==="%c"&&(h=m))}),u.splice(h,0,c)}t.log=console.debug||console.log||(()=>{});function i(u){try{u?t.storage.setItem("debug",u):t.storage.removeItem("debug")}catch(c){}}function s(){let u;try{u=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(c){}return!u&&typeof process!="undefined"&&"env"in process&&(u=r.DEBUG),u}function o(){try{return localStorage}catch(u){}}e.exports=kX()(t);const{formatters:l}=e.exports;l.j=function(u){try{return JSON.stringify(u)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}})(Nu,Nu.exports)),Nu.exports}var UX=FX();const RX=at(UX),xi=RX("micromark");function OX(e,t,r){let n={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const a={},i=[];let s=[],o=[],l=!0;const u={attempt:_(w),check:_(S),consume:N,enter:F,exit:E,interrupt:_(S,{interrupt:!0})},c={code:A.eof,containerState:{},defineSkip:v,events:[],now:g,parser:e,previous:A.eof,sliceSerialize:x,sliceStream:p,write:f};let m=t.tokenize.call(c,u),h;return t.resolveAll&&i.push(t),c;function f(M){return s=cn(s,M),C(),s[s.length-1]!==A.eof?[]:(U(t,0),c.events=t1(i,c.events,c),c.events)}function x(M,Y){return PX(p(M),Y)}function p(M){return VX(s,M)}function g(){const{_bufferIndex:M,_index:Y,line:K,column:de,offset:pe}=n;return{_bufferIndex:M,_index:Y,line:K,column:de,offset:pe}}function v(M){a[M.line]=M.column,q(),xi("position: define skip: `%j`",n)}function C(){let M;for(;n._index<s.length;){const Y=s[n._index];if(typeof Y=="string")for(M=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===M&&n._bufferIndex<Y.length;)b(Y.charCodeAt(n._bufferIndex));else b(Y)}}function b(M){X(l===!0,"expected character to be consumed"),l=void 0,xi("main: passing `%s` to %s",M,m&&m.name),h=M,X(typeof m=="function","expected state"),m=m(M)}function N(M){X(M===h,"expected given code to equal expected code"),xi("consume: `%s`",M),X(l===void 0,"expected code to not have been consumed: this might be because `return x(code)` instead of `return x` was used"),X(M===null?c.events.length===0||c.events[c.events.length-1][0]==="exit":c.events[c.events.length-1][0]==="enter","expected last token to be open"),Ie(M)?(n.line++,n.column=1,n.offset+=M===A.carriageReturnLineFeed?2:1,q(),xi("position: after eol: `%j`",n)):M!==A.virtualSpace&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===s[n._index].length&&(n._bufferIndex=-1,n._index++)),c.previous=M,l=!0}function F(M,Y){const K=Y||{};return K.type=M,K.start=g(),X(typeof M=="string","expected string type"),X(M.length>0,"expected non-empty string"),xi("enter: `%s`",M),c.events.push(["enter",K,c]),o.push(K),K}function E(M){X(typeof M=="string","expected string type"),X(M.length>0,"expected non-empty string");const Y=o.pop();return X(Y,"cannot close w/o open tokens"),Y.end=g(),X(M===Y.type,"expected exit token to match current token"),X(!(Y.start._index===Y.end._index&&Y.start._bufferIndex===Y.end._bufferIndex),"expected non-empty token (`"+M+"`)"),xi("exit: `%s`",Y.type),c.events.push(["exit",Y,c]),Y}function w(M,Y){U(M,Y.from)}function S(M,Y){Y.restore()}function _(M,Y){return K;function K(de,pe,Ae){let Ne,k,le,j;return Array.isArray(de)?V(de):"tokenize"in de?V([de]):y(de);function y(ae){return Q;function Q(Z){const ve=Z!==null&&ae[Z],J=Z!==null&&ae.null,je=[...Array.isArray(ve)?ve:ve?[ve]:[],...Array.isArray(J)?J:J?[J]:[]];return V(je)(Z)}}function V(ae){return Ne=ae,k=0,ae.length===0?(X(Ae,"expected `bogusState` to be given"),Ae):I(ae[k])}function I(ae){return Q;function Q(Z){return j=R(),le=ae,ae.partial||(c.currentConstruct=ae),X(c.parser.constructs.disable.null,"expected `disable.null` to be populated"),ae.name&&c.parser.constructs.disable.null.includes(ae.name)?ie(Z):ae.tokenize.call(Y?Object.assign(Object.create(c),Y):c,u,G,ie)(Z)}}function G(ae){return X(ae===h,"expected code"),l=!0,M(le,j),pe}function ie(ae){return X(ae===h,"expected code"),l=!0,j.restore(),++k<Ne.length?I(Ne[k]):Ae}}}function U(M,Y){M.resolveAll&&!i.includes(M)&&i.push(M),M.resolve&&ea(c.events,Y,c.events.length-Y,M.resolve(c.events.slice(Y),c)),M.resolveTo&&(c.events=M.resolveTo(c.events,c)),X(M.partial||c.events.length===0||c.events[c.events.length-1][0]==="exit","expected last token to end")}function R(){const M=g(),Y=c.previous,K=c.currentConstruct,de=c.events.length,pe=Array.from(o);return{from:de,restore:Ae};function Ae(){n=M,c.previous=Y,c.currentConstruct=K,c.events.length=de,o=pe,q(),xi("position: restore: `%j`",n)}}function q(){n.line in a&&n.column<2&&(n.column=a[n.line],n.offset+=a[n.line]-1)}}function VX(e,t){const r=t.start._index,n=t.start._bufferIndex,a=t.end._index,i=t.end._bufferIndex;let s;if(r===a)X(i>-1,"expected non-negative end buffer index"),X(n>-1,"expected non-negative start buffer index"),s=[e[r].slice(n,i)];else{if(s=e.slice(r,a),n>-1){const o=s[0];typeof o=="string"?s[0]=o.slice(n):(X(n===0,"expected `startBufferIndex` to be `0`"),s.shift())}i>0&&s.push(e[a].slice(0,i))}return s}function PX(e,t){let r=-1;const n=[];let a;for(;++r<e.length;){const i=e[r];let s;if(typeof i=="string")s=i;else switch(i){case A.carriageReturn:{s=Bn.cr;break}case A.lineFeed:{s=Bn.lf;break}case A.carriageReturnLineFeed:{s=Bn.cr+Bn.lf;break}case A.horizontalTab:{s=t?Bn.space:Bn.ht;break}case A.virtualSpace:{if(!t&&a)continue;s=Bn.space;break}default:X(typeof i=="number","expected number"),s=String.fromCharCode(i)}a=i===A.horizontalTab,n.push(s)}return n.join("")}function IX(e){const n={constructs:LG([DX,...(e||{}).extensions||[]]),content:a(YG),defined:[],document:a(KG),flow:a(fX),lazy:{},string:a(xX),text:a(gX)};return n;function a(i){return s;function s(o){return OX(n,i,o)}}}function MX(e){for(;!H3(e););return e}const Gw=/[\0\t\n\r]/g;function jX(){let e=1,t="",r=!0,n;return a;function a(i,s,o){const l=[];let u,c,m,h,f;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(s||void 0).decode(i)),m=0,t="",r&&(i.charCodeAt(0)===A.byteOrderMarker&&m++,r=void 0);m<i.length;){if(Gw.lastIndex=m,u=Gw.exec(i),h=u&&u.index!==void 0?u.index:i.length,f=i.charCodeAt(h),!u){t=i.slice(m);break}if(f===A.lf&&m===h&&n)l.push(A.carriageReturnLineFeed),n=void 0;else switch(n&&(l.push(A.carriageReturn),n=void 0),m<h&&(l.push(i.slice(m,h)),e+=h-m),f){case A.nul:{l.push(A.replacementCharacter),e++;break}case A.ht:{for(c=Math.ceil(e/Re.tabSize)*Re.tabSize,l.push(A.horizontalTab);e++<c;)l.push(A.virtualSpace);break}case A.lf:{l.push(A.lineFeed),e=1;break}default:n=!0,e=1}m=h+1}return o&&(n&&l.push(A.carriageReturn),t&&l.push(t),l.push(A.eof)),l}}const LX=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function BX(e){return e.replace(LX,qX)}function qX(e,t,r){if(t)return t;if(r.charCodeAt(0)===A.numberSign){const a=r.charCodeAt(1),i=a===A.lowercaseX||a===A.uppercaseX;return j3(r.slice(i?2:1),i?Re.numericBaseHexadecimal:Re.numericBaseDecimal)}return e1(r)||e}const K3={}.hasOwnProperty;function zX(e,t,r){return typeof t!="string"&&(r=t,t=void 0),HX(r)(MX(IX(r).document().write(jX()(e,t,!0))))}function HX(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(cr),autolinkProtocol:_,autolinkEmail:_,atxHeading:i(tt),blockQuote:i(Z),characterEscape:_,characterReference:_,codeFenced:i(ve),codeFencedFenceInfo:s,codeFencedFenceMeta:s,codeIndented:i(ve,s),codeText:i(J,s),codeTextData:_,data:_,codeFlowValue:_,definition:i(je),definitionDestinationString:s,definitionLabelString:s,definitionTitleString:s,emphasis:i(ke),hardBreakEscape:i(ze),hardBreakTrailing:i(ze),htmlFlow:i(Se,s),htmlFlowData:_,htmlText:i(Se,s),htmlTextData:_,image:i(Ot),label:s,link:i(cr),listItem:i(zt),listItemValue:h,listOrdered:i(Zt,m),listUnordered:i(Zt),paragraph:i(nr),reference:y,referenceString:s,resourceDestinationString:s,resourceTitleString:s,setextHeading:i(tt),strong:i(gr),thematicBreak:i(Rr)},exit:{atxHeading:l(),atxHeadingSequence:F,autolink:l(),autolinkEmail:Q,autolinkProtocol:ae,blockQuote:l(),characterEscapeValue:U,characterReferenceMarkerHexadecimal:I,characterReferenceMarkerNumeric:I,characterReferenceValue:G,characterReference:ie,codeFenced:l(g),codeFencedFence:p,codeFencedFenceInfo:f,codeFencedFenceMeta:x,codeFlowValue:U,codeIndented:l(v),codeText:l(K),codeTextData:U,data:U,definition:l(),definitionDestinationString:N,definitionLabelString:C,definitionTitleString:b,emphasis:l(),hardBreakEscape:l(q),hardBreakTrailing:l(q),htmlFlow:l(M),htmlFlowData:U,htmlText:l(Y),htmlTextData:U,image:l(pe),label:Ne,labelText:Ae,lineEnding:R,link:l(de),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:V,resourceDestinationString:k,resourceTitleString:le,resource:j,setextHeading:l(S),setextHeadingLineSequence:w,setextHeadingText:E,strong:l(),thematicBreak:l()}};Q3(t,(e||{}).mdastExtensions||[]);const r={};return n;function n(se){let oe={type:"root",children:[]};const Te={stack:[oe],tokenStack:[],config:t,enter:o,exit:u,buffer:s,resume:c,data:r},qe=[];let xe=-1;for(;++xe<se.length;)if(se[xe][1].type===T.listOrdered||se[xe][1].type===T.listUnordered)if(se[xe][0]==="enter")qe.push(xe);else{const Oe=qe.pop();X(typeof Oe=="number","expected list ot be open"),xe=a(se,Oe,xe)}for(xe=-1;++xe<se.length;){const Oe=t[se[xe][0]];K3.call(Oe,se[xe][1].type)&&Oe[se[xe][1].type].call(Object.assign({sliceSerialize:se[xe][2].sliceSerialize},Te),se[xe][1])}if(Te.tokenStack.length>0){const Oe=Te.tokenStack[Te.tokenStack.length-1];(Oe[1]||Yw).call(Te,void 0,Oe[0])}for(oe.position={start:Oa(se.length>0?se[0][1].start:{line:1,column:1,offset:0}),end:Oa(se.length>0?se[se.length-2][1].end:{line:1,column:1,offset:0})},xe=-1;++xe<t.transforms.length;)oe=t.transforms[xe](oe)||oe;return oe}function a(se,oe,Te){let qe=oe-1,xe=-1,Oe=!1,Be,Je,mt,kt;for(;++qe<=Te;){const rt=se[qe];switch(rt[1].type){case T.listUnordered:case T.listOrdered:case T.blockQuote:{rt[0]==="enter"?xe++:xe--,kt=void 0;break}case T.lineEndingBlank:{rt[0]==="enter"&&(Be&&!kt&&!xe&&!mt&&(mt=qe),kt=void 0);break}case T.linePrefix:case T.listItemValue:case T.listItemMarker:case T.listItemPrefix:case T.listItemPrefixWhitespace:break;default:kt=void 0}if(!xe&&rt[0]==="enter"&&rt[1].type===T.listItemPrefix||xe===-1&&rt[0]==="exit"&&(rt[1].type===T.listUnordered||rt[1].type===T.listOrdered)){if(Be){let Jt=qe;for(Je=void 0;Jt--;){const ut=se[Jt];if(ut[1].type===T.lineEnding||ut[1].type===T.lineEndingBlank){if(ut[0]==="exit")continue;Je&&(se[Je][1].type=T.lineEndingBlank,Oe=!0),ut[1].type=T.lineEnding,Je=Jt}else if(!(ut[1].type===T.linePrefix||ut[1].type===T.blockQuotePrefix||ut[1].type===T.blockQuotePrefixWhitespace||ut[1].type===T.blockQuoteMarker||ut[1].type===T.listItemIndent))break}mt&&(!Je||mt<Je)&&(Be._spread=!0),Be.end=Object.assign({},Je?se[Je][1].start:rt[1].end),se.splice(Je||qe,0,["exit",Be,rt[2]]),qe++,Te++}if(rt[1].type===T.listItemPrefix){const Jt={type:"listItem",_spread:!1,start:Object.assign({},rt[1].start),end:void 0};Be=Jt,se.splice(qe,0,["enter",Jt,rt[2]]),qe++,Te++,mt=void 0,kt=!0}}}return se[oe][1]._spread=Oe,Te}function i(se,oe){return Te;function Te(qe){o.call(this,se(qe),qe),oe&&oe.call(this,qe)}}function s(){this.stack.push({type:"fragment",children:[]})}function o(se,oe,Te){const qe=this.stack[this.stack.length-1];X(qe,"expected `parent`"),X("children"in qe,"expected `parent`"),qe.children.push(se),this.stack.push(se),this.tokenStack.push([oe,Te||void 0]),se.position={start:Oa(oe.start),end:void 0}}function l(se){return oe;function oe(Te){se&&se.call(this,Te),u.call(this,Te)}}function u(se,oe){const Te=this.stack.pop();X(Te,"expected `node`");const qe=this.tokenStack.pop();if(qe)qe[0].type!==se.type&&(oe?oe.call(this,se,qe[0]):(qe[1]||Yw).call(this,se,qe[0]));else throw new Error("Cannot close `"+se.type+"` ("+qo({start:se.start,end:se.end})+"): itâ€™s not open");X(Te.type!=="fragment","unexpected fragment `exit`ed"),X(Te.position,"expected `position` to be defined"),Te.position.end=Oa(se.end)}function c(){return MG(this.stack.pop())}function m(){this.data.expectingFirstListItemValue=!0}function h(se){if(this.data.expectingFirstListItemValue){const oe=this.stack[this.stack.length-2];X(oe,"expected nodes on stack"),X(oe.type==="list","expected list on stack"),oe.start=Number.parseInt(this.sliceSerialize(se),Re.numericBaseDecimal),this.data.expectingFirstListItemValue=void 0}}function f(){const se=this.resume(),oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="code","expected code on stack"),oe.lang=se}function x(){const se=this.resume(),oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="code","expected code on stack"),oe.meta=se}function p(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function g(){const se=this.resume(),oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="code","expected code on stack"),oe.value=se.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function v(){const se=this.resume(),oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="code","expected code on stack"),oe.value=se.replace(/(\r?\n|\r)$/g,"")}function C(se){const oe=this.resume(),Te=this.stack[this.stack.length-1];X(Te,"expected node on stack"),X(Te.type==="definition","expected definition on stack"),Te.label=oe,Te.identifier=ks(this.sliceSerialize(se)).toLowerCase()}function b(){const se=this.resume(),oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="definition","expected definition on stack"),oe.title=se}function N(){const se=this.resume(),oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="definition","expected definition on stack"),oe.url=se}function F(se){const oe=this.stack[this.stack.length-1];if(X(oe,"expected node on stack"),X(oe.type==="heading","expected heading on stack"),!oe.depth){const Te=this.sliceSerialize(se).length;X(Te===1||Te===2||Te===3||Te===4||Te===5||Te===6,"expected `depth` between `1` and `6`"),oe.depth=Te}}function E(){this.data.setextHeadingSlurpLineEnding=!0}function w(se){const oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="heading","expected heading on stack"),oe.depth=this.sliceSerialize(se).codePointAt(0)===A.equalsTo?1:2}function S(){this.data.setextHeadingSlurpLineEnding=void 0}function _(se){const oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X("children"in oe,"expected parent on stack");const Te=oe.children;let qe=Te[Te.length-1];(!qe||qe.type!=="text")&&(qe=ht(),qe.position={start:Oa(se.start),end:void 0},Te.push(qe)),this.stack.push(qe)}function U(se){const oe=this.stack.pop();X(oe,"expected a `node` to be on the stack"),X("value"in oe,"expected a `literal` to be on the stack"),X(oe.position,"expected `node` to have an open position"),oe.value+=this.sliceSerialize(se),oe.position.end=Oa(se.end)}function R(se){const oe=this.stack[this.stack.length-1];if(X(oe,"expected `node`"),this.data.atHardBreak){X("children"in oe,"expected `parent`");const Te=oe.children[oe.children.length-1];X(Te.position,"expected tail to have a starting position"),Te.position.end=Oa(se.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(oe.type)&&(_.call(this,se),U.call(this,se))}function q(){this.data.atHardBreak=!0}function M(){const se=this.resume(),oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="html","expected html on stack"),oe.value=se}function Y(){const se=this.resume(),oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="html","expected html on stack"),oe.value=se}function K(){const se=this.resume(),oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="inlineCode","expected inline code on stack"),oe.value=se}function de(){const se=this.stack[this.stack.length-1];if(X(se,"expected node on stack"),X(se.type==="link","expected link on stack"),this.data.inReference){const oe=this.data.referenceType||"shortcut";se.type+="Reference",se.referenceType=oe,delete se.url,delete se.title}else delete se.identifier,delete se.label;this.data.referenceType=void 0}function pe(){const se=this.stack[this.stack.length-1];if(X(se,"expected node on stack"),X(se.type==="image","expected image on stack"),this.data.inReference){const oe=this.data.referenceType||"shortcut";se.type+="Reference",se.referenceType=oe,delete se.url,delete se.title}else delete se.identifier,delete se.label;this.data.referenceType=void 0}function Ae(se){const oe=this.sliceSerialize(se),Te=this.stack[this.stack.length-2];X(Te,"expected ancestor on stack"),X(Te.type==="image"||Te.type==="link","expected image or link on stack"),Te.label=BX(oe),Te.identifier=ks(oe).toLowerCase()}function Ne(){const se=this.stack[this.stack.length-1];X(se,"expected node on stack"),X(se.type==="fragment","expected fragment on stack");const oe=this.resume(),Te=this.stack[this.stack.length-1];if(X(Te,"expected node on stack"),X(Te.type==="image"||Te.type==="link","expected image or link on stack"),this.data.inReference=!0,Te.type==="link"){const qe=se.children;Te.children=qe}else Te.alt=oe}function k(){const se=this.resume(),oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="image"||oe.type==="link","expected image or link on stack"),oe.url=se}function le(){const se=this.resume(),oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="image"||oe.type==="link","expected image or link on stack"),oe.title=se}function j(){this.data.inReference=void 0}function y(){this.data.referenceType="collapsed"}function V(se){const oe=this.resume(),Te=this.stack[this.stack.length-1];X(Te,"expected node on stack"),X(Te.type==="image"||Te.type==="link","expected image reference or link reference on stack"),Te.label=oe,Te.identifier=ks(this.sliceSerialize(se)).toLowerCase(),this.data.referenceType="full"}function I(se){X(se.type==="characterReferenceMarkerNumeric"||se.type==="characterReferenceMarkerHexadecimal"),this.data.characterReferenceType=se.type}function G(se){const oe=this.sliceSerialize(se),Te=this.data.characterReferenceType;let qe;if(Te)qe=j3(oe,Te===T.characterReferenceMarkerNumeric?Re.numericBaseDecimal:Re.numericBaseHexadecimal),this.data.characterReferenceType=void 0;else{const Oe=e1(oe);X(Oe!==!1,"expected reference to decode"),qe=Oe}const xe=this.stack[this.stack.length-1];X(xe,"expected `node`"),X("value"in xe,"expected `node.value`"),xe.value+=qe}function ie(se){const oe=this.stack.pop();X(oe,"expected `node`"),X(oe.position,"expected `node.position`"),oe.position.end=Oa(se.end)}function ae(se){U.call(this,se);const oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="link","expected link on stack"),oe.url=this.sliceSerialize(se)}function Q(se){U.call(this,se);const oe=this.stack[this.stack.length-1];X(oe,"expected node on stack"),X(oe.type==="link","expected link on stack"),oe.url="mailto:"+this.sliceSerialize(se)}function Z(){return{type:"blockquote",children:[]}}function ve(){return{type:"code",lang:null,meta:null,value:""}}function J(){return{type:"inlineCode",value:""}}function je(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function ke(){return{type:"emphasis",children:[]}}function tt(){return{type:"heading",depth:0,children:[]}}function ze(){return{type:"break"}}function Se(){return{type:"html",value:""}}function Ot(){return{type:"image",title:null,url:"",alt:null}}function cr(){return{type:"link",title:null,url:"",children:[]}}function Zt(se){return{type:"list",ordered:se.type==="listOrdered",start:null,spread:se._spread,children:[]}}function zt(se){return{type:"listItem",spread:se._spread,checked:null,children:[]}}function nr(){return{type:"paragraph",children:[]}}function gr(){return{type:"strong",children:[]}}function ht(){return{type:"text",value:""}}function Rr(){return{type:"thematicBreak"}}}function Oa(e){return{line:e.line,column:e.column,offset:e.offset}}function Q3(e,t){let r=-1;for(;++r<t.length;){const n=t[r];Array.isArray(n)?Q3(e,n):$X(e,n)}}function $X(e,t){let r;for(r in t)if(K3.call(t,r))switch(r){case"canContainEols":{const n=t[r];n&&e[r].push(...n);break}case"transforms":{const n=t[r];n&&e[r].push(...n);break}case"enter":case"exit":{const n=t[r];n&&Object.assign(e[r],n);break}}}function Yw(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+qo({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+qo({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+qo({start:t.start,end:t.end})+") is still open")}function vee(e){const t=this;t.parser=r;function r(n){return zX(n,he(H(H({},t.data("settings")),e),{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}}function WX(e,t){const r={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,r),e.applyData(t,r)}function GX(e,t){const r={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,r),[e.applyData(t,r),{type:"text",value:`
`}]}function YX(e,t){const r=t.value?t.value+`
`:"",n={};t.lang&&(n.className=["language-"+t.lang]);let a={type:"element",tagName:"code",properties:n,children:[{type:"text",value:r}]};return t.meta&&(a.data={meta:t.meta}),e.patch(t,a),a=e.applyData(t,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(t,a),a}function XX(e,t){const r={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function KX(e,t){const r={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function QX(e,t){const r=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=String(t.identifier).toUpperCase(),a=ao(n.toLowerCase()),i=e.footnoteOrder.indexOf(n);let s,o=e.footnoteCounts.get(n);o===void 0?(o=0,e.footnoteOrder.push(n),s=e.footnoteOrder.length):s=i+1,o+=1,e.footnoteCounts.set(n,o);const l={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+a,id:r+"fnref-"+a+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(s)}]};e.patch(t,l);const u={type:"element",tagName:"sup",properties:{},children:[l]};return e.patch(t,u),e.applyData(t,u)}function ZX(e,t){const r={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function JX(e,t){if(e.options.allowDangerousHtml){const r={type:"raw",value:t.value};return e.patch(t,r),e.applyData(t,r)}}function Z3(e,t){const r=t.referenceType;let n="]";if(r==="collapsed"?n+="[]":r==="full"&&(n+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+n}];const a=e.all(t),i=a[0];i&&i.type==="text"?i.value="["+i.value:a.unshift({type:"text",value:"["});const s=a[a.length-1];return s&&s.type==="text"?s.value+=n:a.push({type:"text",value:n}),a}function eK(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return Z3(e,t);const a={src:ao(n.url||""),alt:t.alt};n.title!==null&&n.title!==void 0&&(a.title=n.title);const i={type:"element",tagName:"img",properties:a,children:[]};return e.patch(t,i),e.applyData(t,i)}function tK(e,t){const r={src:ao(t.url)};t.alt!==null&&t.alt!==void 0&&(r.alt=t.alt),t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,n),e.applyData(t,n)}function rK(e,t){const r={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,r);const n={type:"element",tagName:"code",properties:{},children:[r]};return e.patch(t,n),e.applyData(t,n)}function nK(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return Z3(e,t);const a={href:ao(n.url||"")};n.title!==null&&n.title!==void 0&&(a.title=n.title);const i={type:"element",tagName:"a",properties:a,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function aK(e,t){const r={href:ao(t.url)};t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function iK(e,t,r){const n=e.all(t),a=r?sK(r):J3(t),i={},s=[];if(typeof t.checked=="boolean"){const c=n[0];let m;c&&c.type==="element"&&c.tagName==="p"?m=c:(m={type:"element",tagName:"p",properties:{},children:[]},n.unshift(m)),m.children.length>0&&m.children.unshift({type:"text",value:" "}),m.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let o=-1;for(;++o<n.length;){const c=n[o];(a||o!==0||c.type!=="element"||c.tagName!=="p")&&s.push({type:"text",value:`
`}),c.type==="element"&&c.tagName==="p"&&!a?s.push(...c.children):s.push(c)}const l=n[n.length-1];l&&(a||l.type!=="element"||l.tagName!=="p")&&s.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:i,children:s};return e.patch(t,u),e.applyData(t,u)}function sK(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const r=e.children;let n=-1;for(;!t&&++n<r.length;)t=J3(r[n])}return t}function J3(e){const t=e.spread;return t==null?e.children.length>1:t}function oK(e,t){const r={},n=e.all(t);let a=-1;for(typeof t.start=="number"&&t.start!==1&&(r.start=t.start);++a<n.length;){const s=n[a];if(s.type==="element"&&s.tagName==="li"&&s.properties&&Array.isArray(s.properties.className)&&s.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const i={type:"element",tagName:t.ordered?"ol":"ul",properties:r,children:e.wrap(n,!0)};return e.patch(t,i),e.applyData(t,i)}function lK(e,t){const r={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function uK(e,t){const r={type:"root",children:e.wrap(e.all(t))};return e.patch(t,r),e.applyData(t,r)}function cK(e,t){const r={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function mK(e,t){const r=e.all(t),n=r.shift(),a=[];if(n){const s={type:"element",tagName:"thead",properties:{},children:e.wrap([n],!0)};e.patch(t.children[0],s),a.push(s)}if(r.length>0){const s={type:"element",tagName:"tbody",properties:{},children:e.wrap(r,!0)},o=Kg(t.children[1]),l=U3(t.children[t.children.length-1]);o&&l&&(s.position={start:o,end:l}),a.push(s)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(t,i),e.applyData(t,i)}function dK(e,t,r){const n=r?r.children:void 0,i=(n?n.indexOf(t):1)===0?"th":"td",s=r&&r.type==="table"?r.align:void 0,o=s?s.length:t.children.length;let l=-1;const u=[];for(;++l<o;){const m=t.children[l],h={},f=s?s[l]:void 0;f&&(h.align=f);let x={type:"element",tagName:i,properties:h,children:[]};m&&(x.children=e.all(m),e.patch(m,x),x=e.applyData(m,x)),u.push(x)}const c={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,c),e.applyData(t,c)}function fK(e,t){const r={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}const Xw=9,Kw=32;function hK(e){const t=String(e),r=/\r?\n|\r/g;let n=r.exec(t),a=0;const i=[];for(;n;)i.push(Qw(t.slice(a,n.index),a>0,!0),n[0]),a=n.index+n[0].length,n=r.exec(t);return i.push(Qw(t.slice(a),a>0,!1)),i.join("")}function Qw(e,t,r){let n=0,a=e.length;if(t){let i=e.codePointAt(n);for(;i===Xw||i===Kw;)n++,i=e.codePointAt(n)}if(r){let i=e.codePointAt(a-1);for(;i===Xw||i===Kw;)a--,i=e.codePointAt(a-1)}return a>n?e.slice(n,a):""}function pK(e,t){const r={type:"text",value:hK(String(t.value))};return e.patch(t,r),e.applyData(t,r)}function xK(e,t){const r={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,r),e.applyData(t,r)}const gK={blockquote:WX,break:GX,code:YX,delete:XX,emphasis:KX,footnoteReference:QX,heading:ZX,html:JX,imageReference:eK,image:tK,inlineCode:rK,linkReference:nK,link:aK,listItem:iK,list:oK,paragraph:lK,root:uK,strong:cK,table:mK,tableCell:fK,tableRow:dK,text:pK,thematicBreak:xK,toml:yu,yaml:yu,definition:yu,footnoteDefinition:yu};function yu(){}const e4=-1,rm=0,Ho=1,vc=2,n1=3,a1=4,i1=5,s1=6,t4=7,r4=8,Zw=typeof self=="object"?self:globalThis,vK=(e,t)=>{const r=(a,i)=>(e.set(i,a),a),n=a=>{if(e.has(a))return e.get(a);const[i,s]=t[a];switch(i){case rm:case e4:return r(s,a);case Ho:{const o=r([],a);for(const l of s)o.push(n(l));return o}case vc:{const o=r({},a);for(const[l,u]of s)o[n(l)]=n(u);return o}case n1:return r(new Date(s),a);case a1:{const{source:o,flags:l}=s;return r(new RegExp(o,l),a)}case i1:{const o=r(new Map,a);for(const[l,u]of s)o.set(n(l),n(u));return o}case s1:{const o=r(new Set,a);for(const l of s)o.add(n(l));return o}case t4:{const{name:o,message:l}=s;return r(new Zw[o](l),a)}case r4:return r(BigInt(s),a);case"BigInt":return r(Object(BigInt(s)),a);case"ArrayBuffer":return r(new Uint8Array(s).buffer,s);case"DataView":{const{buffer:o}=new Uint8Array(s);return r(new DataView(o),s)}}return r(new Zw[i](s),a)};return n},Jw=e=>vK(new Map,e)(0),ds="",{toString:bK}={},{keys:NK}=Object,Eo=e=>{const t=typeof e;if(t!=="object"||!e)return[rm,t];const r=bK.call(e).slice(8,-1);switch(r){case"Array":return[Ho,ds];case"Object":return[vc,ds];case"Date":return[n1,ds];case"RegExp":return[a1,ds];case"Map":return[i1,ds];case"Set":return[s1,ds];case"DataView":return[Ho,r]}return r.includes("Array")?[Ho,r]:r.includes("Error")?[t4,r]:[vc,r]},Cu=([e,t])=>e===rm&&(t==="function"||t==="symbol"),yK=(e,t,r,n)=>{const a=(s,o)=>{const l=n.push(s)-1;return r.set(o,l),l},i=s=>{if(r.has(s))return r.get(s);let[o,l]=Eo(s);switch(o){case rm:{let c=s;switch(l){case"bigint":o=r4,c=s.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+l);c=null;break;case"undefined":return a([e4],s)}return a([o,c],s)}case Ho:{if(l){let h=s;return l==="DataView"?h=new Uint8Array(s.buffer):l==="ArrayBuffer"&&(h=new Uint8Array(s)),a([l,[...h]],s)}const c=[],m=a([o,c],s);for(const h of s)c.push(i(h));return m}case vc:{if(l)switch(l){case"BigInt":return a([l,s.toString()],s);case"Boolean":case"Number":case"String":return a([l,s.valueOf()],s)}if(t&&"toJSON"in s)return i(s.toJSON());const c=[],m=a([o,c],s);for(const h of NK(s))(e||!Cu(Eo(s[h])))&&c.push([i(h),i(s[h])]);return m}case n1:return a([o,s.toISOString()],s);case a1:{const{source:c,flags:m}=s;return a([o,{source:c,flags:m}],s)}case i1:{const c=[],m=a([o,c],s);for(const[h,f]of s)(e||!(Cu(Eo(h))||Cu(Eo(f))))&&c.push([i(h),i(f)]);return m}case s1:{const c=[],m=a([o,c],s);for(const h of s)(e||!Cu(Eo(h)))&&c.push(i(h));return m}}const{message:u}=s;return a([o,{name:l,message:u}],s)};return i},eE=(e,{json:t,lossy:r}={})=>{const n=[];return yK(!(t||r),!!t,new Map,n)(e),n},bc=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?Jw(eE(e,t)):structuredClone(e):(e,t)=>Jw(eE(e,t));function CK(e,t){const r=[{type:"text",value:"â†©"}];return t>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),r}function wK(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function EK(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=e.options.footnoteBackContent||CK,n=e.options.footnoteBackLabel||wK,a=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",s=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let l=-1;for(;++l<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[l]);if(!u)continue;const c=e.all(u),m=String(u.identifier).toUpperCase(),h=ao(m.toLowerCase());let f=0;const x=[],p=e.footnoteCounts.get(m);for(;p!==void 0&&++f<=p;){x.length>0&&x.push({type:"text",value:" "});let C=typeof r=="string"?r:r(l,f);typeof C=="string"&&(C={type:"text",value:C}),x.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+h+(f>1?"-"+f:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(l,f),className:["data-footnote-backref"]},children:Array.isArray(C)?C:[C]})}const g=c[c.length-1];if(g&&g.type==="element"&&g.tagName==="p"){const C=g.children[g.children.length-1];C&&C.type==="text"?C.value+=" ":g.children.push({type:"text",value:" "}),g.children.push(...x)}else c.push(...x);const v={type:"element",tagName:"li",properties:{id:t+"fn-"+h},children:e.wrap(c,!0)};e.patch(u,v),o.push(v)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:he(H({},bc(s)),{id:"footnote-label"}),children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const n4=(function(e){if(e==null)return DK;if(typeof e=="function")return nm(e);if(typeof e=="object")return Array.isArray(e)?_K(e):SK(e);if(typeof e=="string")return TK(e);throw new Error("Expected function, string, or object as test")});function _K(e){const t=[];let r=-1;for(;++r<e.length;)t[r]=n4(e[r]);return nm(n);function n(...a){let i=-1;for(;++i<t.length;)if(t[i].apply(this,a))return!0;return!1}}function SK(e){const t=e;return nm(r);function r(n){const a=n;let i;for(i in e)if(a[i]!==t[i])return!1;return!0}}function TK(e){return nm(t);function t(r){return r&&r.type===e}}function nm(e){return t;function t(r,n,a){return!!(AK(r)&&e.call(this,r,typeof n=="number"?n:void 0,a||void 0))}}function DK(){return!0}function AK(e){return e!==null&&typeof e=="object"&&"type"in e}const a4=[],kK=!0,tE=!1,FK="skip";function UK(e,t,r,n){let a;typeof t=="function"&&typeof r!="function"?(n=r,r=t):a=t;const i=n4(a),s=n?-1:1;o(e,void 0,[])();function o(l,u,c){const m=l&&typeof l=="object"?l:{};if(typeof m.type=="string"){const f=typeof m.tagName=="string"?m.tagName:typeof m.name=="string"?m.name:void 0;Object.defineProperty(h,"name",{value:"node ("+(l.type+(f?"<"+f+">":""))+")"})}return h;function h(){let f=a4,x,p,g;if((!t||i(l,u,c[c.length-1]||void 0))&&(f=RK(r(l,c)),f[0]===tE))return f;if("children"in l&&l.children){const v=l;if(v.children&&f[0]!==FK)for(p=(n?v.children.length:-1)+s,g=c.concat(v);p>-1&&p<v.children.length;){const C=v.children[p];if(x=o(C,p,g)(),x[0]===tE)return x;p=typeof x[1]=="number"?x[1]:p+s}}return f}}}function RK(e){return Array.isArray(e)?e:typeof e=="number"?[kK,e]:e==null?a4:[e]}function OK(e,t,r,n){let a,i,s;typeof t=="function"&&typeof r!="function"?(i=void 0,s=t,a=r):(i=t,s=r,a=n),UK(e,i,o,a);function o(l,u){const c=u[u.length-1],m=c?c.children.indexOf(l):void 0;return s(l,m,c)}}const ex={}.hasOwnProperty,VK={};function PK(e,t){const r=t||VK,n=new Map,a=new Map,i=new Map,s=H(H({},gK),r.handlers),o={all:u,applyData:MK,definitionById:n,footnoteById:a,footnoteCounts:i,footnoteOrder:[],handlers:s,one:l,options:r,patch:IK,wrap:LK};return OK(e,function(c){if(c.type==="definition"||c.type==="footnoteDefinition"){const m=c.type==="definition"?n:a,h=String(c.identifier).toUpperCase();m.has(h)||m.set(h,c)}}),o;function l(c,m){const h=c.type,f=o.handlers[h];if(ex.call(o.handlers,h)&&f)return f(o,c,m);if(o.options.passThrough&&o.options.passThrough.includes(h)){if("children"in c){const p=c,{children:g}=p,v=Ee(p,["children"]),C=bc(v);return C.children=o.all(c),C}return bc(c)}return(o.options.unknownHandler||jK)(o,c,m)}function u(c){const m=[];if("children"in c){const h=c.children;let f=-1;for(;++f<h.length;){const x=o.one(h[f],c);if(x){if(f&&h[f-1].type==="break"&&(!Array.isArray(x)&&x.type==="text"&&(x.value=rE(x.value)),!Array.isArray(x)&&x.type==="element")){const p=x.children[0];p&&p.type==="text"&&(p.value=rE(p.value))}Array.isArray(x)?m.push(...x):m.push(x)}}}return m}}function IK(e,t){e.position&&(t.position=gG(e))}function MK(e,t){let r=t;if(e&&e.data){const n=e.data.hName,a=e.data.hChildren,i=e.data.hProperties;if(typeof n=="string")if(r.type==="element")r.tagName=n;else{const s="children"in r?r.children:[r];r={type:"element",tagName:n,properties:{},children:s}}r.type==="element"&&i&&Object.assign(r.properties,bc(i)),"children"in r&&r.children&&a!==null&&a!==void 0&&(r.children=a)}return r}function jK(e,t){const r=t.data||{},n="value"in t&&!(ex.call(r,"hProperties")||ex.call(r,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function LK(e,t){const r=[];let n=-1;for(t&&r.push({type:"text",value:`
`});++n<e.length;)n&&r.push({type:"text",value:`
`}),r.push(e[n]);return t&&e.length>0&&r.push({type:"text",value:`
`}),r}function rE(e){let t=0,r=e.charCodeAt(t);for(;r===9||r===32;)t++,r=e.charCodeAt(t);return e.slice(t)}function nE(e,t){const r=PK(e,t),n=r.one(e,void 0),a=EK(r),i=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return a&&(X("children"in i),i.children.push({type:"text",value:`
`},a)),i}function bee(e,t){return e&&"run"in e?function(r,n){return bt(this,null,function*(){const a=nE(r,H({file:n},t));yield e.run(a,n)})}:function(r,n){return nE(r,H({file:n},e||t))}}function aE(e){if(e)throw e}var K0,iE;function BK(){if(iE)return K0;iE=1;var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,r=Object.defineProperty,n=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):t.call(u)==="[object Array]"},i=function(u){if(!u||t.call(u)!=="[object Object]")return!1;var c=e.call(u,"constructor"),m=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!c&&!m)return!1;var h;for(h in u);return typeof h=="undefined"||e.call(u,h)},s=function(u,c){r&&c.name==="__proto__"?r(u,c.name,{enumerable:!0,configurable:!0,value:c.newValue,writable:!0}):u[c.name]=c.newValue},o=function(u,c){if(c==="__proto__")if(e.call(u,c)){if(n)return n(u,c).value}else return;return u[c]};return K0=function l(){var u,c,m,h,f,x,p=arguments[0],g=1,v=arguments.length,C=!1;for(typeof p=="boolean"&&(C=p,p=arguments[1]||{},g=2),(p==null||typeof p!="object"&&typeof p!="function")&&(p={});g<v;++g)if(u=arguments[g],u!=null)for(c in u)m=o(p,c),h=o(u,c),p!==h&&(C&&h&&(i(h)||(f=a(h)))?(f?(f=!1,x=m&&a(m)?m:[]):x=m&&i(m)?m:{},s(p,{name:c,newValue:l(C,x,h)})):typeof h!="undefined"&&s(p,{name:c,newValue:h}));return p},K0}var qK=BK();const Q0=at(qK);function tx(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function zK(){const e=[],t={run:r,use:n};return t;function r(...a){let i=-1;const s=a.pop();if(typeof s!="function")throw new TypeError("Expected function as last argument, not "+s);o(null,...a);function o(l,...u){const c=e[++i];let m=-1;if(l){s(l);return}for(;++m<a.length;)(u[m]===null||u[m]===void 0)&&(u[m]=a[m]);a=u,c?HK(c,o)(...u):s(null,...u)}}function n(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),t}}function HK(e,t){let r;return n;function n(...s){const o=e.length>s.length;let l;o&&s.push(a);try{l=e.apply(this,s)}catch(u){const c=u;if(o&&r)throw c;return a(c)}o||(l&&l.then&&typeof l.then=="function"?l.then(i,a):l instanceof Error?a(l):i(l))}function a(s,...o){r||(r=!0,t(s,...o))}function i(s){a(null,s)}}const Ln={basename:$K,dirname:WK,extname:GK,join:YK,sep:"/"};function $K(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');jl(e);let r=0,n=-1,a=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(i){r=a+1;break}}else n<0&&(i=!0,n=a+1);return n<0?"":e.slice(r,n)}if(t===e)return"";let s=-1,o=t.length-1;for(;a--;)if(e.codePointAt(a)===47){if(i){r=a+1;break}}else s<0&&(i=!0,s=a+1),o>-1&&(e.codePointAt(a)===t.codePointAt(o--)?o<0&&(n=a):(o=-1,n=s));return r===n?n=s:n<0&&(n=e.length),e.slice(r,n)}function WK(e){if(jl(e),e.length===0)return".";let t=-1,r=e.length,n;for(;--r;)if(e.codePointAt(r)===47){if(n){t=r;break}}else n||(n=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function GK(e){jl(e);let t=e.length,r=-1,n=0,a=-1,i=0,s;for(;t--;){const o=e.codePointAt(t);if(o===47){if(s){n=t+1;break}continue}r<0&&(s=!0,r=t+1),o===46?a<0?a=t:i!==1&&(i=1):a>-1&&(i=-1)}return a<0||r<0||i===0||i===1&&a===r-1&&a===n+1?"":e.slice(a,r)}function YK(...e){let t=-1,r;for(;++t<e.length;)jl(e[t]),e[t]&&(r=r===void 0?e[t]:r+"/"+e[t]);return r===void 0?".":XK(r)}function XK(e){jl(e);const t=e.codePointAt(0)===47;let r=KK(e,!t);return r.length===0&&!t&&(r="."),r.length>0&&e.codePointAt(e.length-1)===47&&(r+="/"),t?"/"+r:r}function KK(e,t){let r="",n=0,a=-1,i=0,s=-1,o,l;for(;++s<=e.length;){if(s<e.length)o=e.codePointAt(s);else{if(o===47)break;o=47}if(o===47){if(!(a===s-1||i===1))if(a!==s-1&&i===2){if(r.length<2||n!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(l=r.lastIndexOf("/"),l!==r.length-1){l<0?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),a=s,i=0;continue}}else if(r.length>0){r="",n=0,a=s,i=0;continue}}t&&(r=r.length>0?r+"/..":"..",n=2)}else r.length>0?r+="/"+e.slice(a+1,s):r=e.slice(a+1,s),n=s-a-1;a=s,i=0}else o===46&&i>-1?i++:i=-1}return r}function jl(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const QK={cwd:ZK};function ZK(){return"/"}function rx(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function JK(e){if(typeof e=="string")e=new URL(e);else if(!rx(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return eQ(e)}function eQ(e){if(e.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const t=e.pathname;let r=-1;for(;++r<t.length;)if(t.codePointAt(r)===37&&t.codePointAt(r+1)===50){const n=t.codePointAt(r+2);if(n===70||n===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(t)}const Z0=["history","path","basename","stem","extname","dirname"];class tQ{constructor(t){let r;t?rx(t)?r={path:t}:typeof t=="string"||rQ(t)?r={value:t}:r=t:r={},this.cwd="cwd"in r?"":QK.cwd(),this.data={},this.history=[],this.messages=[];let n=-1;for(;++n<Z0.length;){const i=Z0[n];i in r&&r[i]!==void 0&&r[i]!==null&&(this[i]=i==="history"?[...r[i]]:r[i])}let a;for(a in r)Z0.includes(a)||(this[a]=r[a])}get basename(){return typeof this.path=="string"?Ln.basename(this.path):void 0}set basename(t){ep(t,"basename"),J0(t,"basename"),this.path=Ln.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Ln.dirname(this.path):void 0}set dirname(t){sE(this.basename,"dirname"),this.path=Ln.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Ln.extname(this.path):void 0}set extname(t){if(J0(t,"extname"),sE(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Ln.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){rx(t)&&(t=JK(t)),ep(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Ln.basename(this.path,this.extname):void 0}set stem(t){ep(t,"stem"),J0(t,"stem"),this.path=Ln.join(this.dirname||"",t+(this.extname||""))}fail(t,r,n){const a=this.message(t,r,n);throw a.fatal=!0,a}info(t,r,n){const a=this.message(t,r,n);return a.fatal=void 0,a}message(t,r,n){const a=new _r(t,r,n);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function J0(e,t){if(e&&e.includes(Ln.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Ln.sep+"`")}function ep(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function sE(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function rQ(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const nQ=(function(e){const n=this.constructor.prototype,a=n[e],i=function(){return a.apply(i,arguments)};return Object.setPrototypeOf(i,n),i}),aQ={}.hasOwnProperty;class o1 extends nQ{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=zK()}copy(){const t=new o1;let r=-1;for(;++r<this.attachers.length;){const n=this.attachers[r];t.use(...n)}return t.data(Q0(!0,{},this.namespace)),t}data(t,r){return typeof t=="string"?arguments.length===2?(np("data",this.frozen),this.namespace[t]=r,this):aQ.call(this.namespace,t)&&this.namespace[t]||void 0:t?(np("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const a=r.call(t,...n);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const r=wu(t),n=this.parser||this.Parser;return tp("parse",n),n(String(r),r)}process(t,r){const n=this;return this.freeze(),tp("process",this.parser||this.Parser),rp("process",this.compiler||this.Compiler),r?a(void 0,r):new Promise(a);function a(i,s){const o=wu(t),l=n.parse(o);n.run(l,o,function(c,m,h){if(c||!m||!h)return u(c);const f=m,x=n.stringify(f,h);sQ(x)?h.value=x:h.result=x,u(c,h)});function u(c,m){c||!m?s(c):i?i(m):(X(r,"`done` is defined if `resolve` is not"),r(void 0,m))}}}processSync(t){let r=!1,n;return this.freeze(),tp("processSync",this.parser||this.Parser),rp("processSync",this.compiler||this.Compiler),this.process(t,a),lE("processSync","process",r),X(n,"we either bailed on an error or have a tree"),n;function a(i,s){r=!0,aE(i),n=s}}run(t,r,n){oE(t),this.freeze();const a=this.transformers;return!n&&typeof r=="function"&&(n=r,r=void 0),n?i(void 0,n):new Promise(i);function i(s,o){X(typeof r!="function","`file` canâ€™t be a `done` anymore, we checked");const l=wu(r);a.run(t,l,u);function u(c,m,h){const f=m||t;c?o(c):s?s(f):(X(n,"`done` is defined if `resolve` is not"),n(void 0,f,h))}}}runSync(t,r){let n=!1,a;return this.run(t,r,i),lE("runSync","run",n),X(a,"we either bailed on an error or have a tree"),a;function i(s,o){aE(s),a=o,n=!0}}stringify(t,r){this.freeze();const n=wu(r),a=this.compiler||this.Compiler;return rp("stringify",a),oE(t),a(t,n)}use(t,...r){const n=this.attachers,a=this.namespace;if(np("use",this.frozen),t!=null)if(typeof t=="function")l(t,r);else if(typeof t=="object")Array.isArray(t)?o(t):s(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(u){if(typeof u=="function")l(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[c,...m]=u;l(c,m)}else s(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function s(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(u.plugins),u.settings&&(a.settings=Q0(!0,a.settings,u.settings))}function o(u){let c=-1;if(u!=null)if(Array.isArray(u))for(;++c<u.length;){const m=u[c];i(m)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function l(u,c){let m=-1,h=-1;for(;++m<n.length;)if(n[m][0]===u){h=m;break}if(h===-1)n.push([u,...c]);else if(c.length>0){let[f,...x]=c;const p=n[h][1];tx(p)&&tx(f)&&(f=Q0(!0,p,f)),n[h]=[u,f,...x]}}}}const Nee=new o1().freeze();function tp(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function rp(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function np(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function oE(e){if(!tx(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function lE(e,t,r){if(!r)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function wu(e){return iQ(e)?e:new tQ(e)}function iQ(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function sQ(e){return typeof e=="string"||oQ(e)}function oQ(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}function yee({feedback:e,isOpen:t,onClose:r,onDelete:n,isAdmin:a=!1}){const{toast:i}=Cc(),[s,o]=W.useState(""),[l,u]=W.useState(!1),[c,m]=W.useState(e),[h,f]=W.useState(!1),[x,p]=W.useState(null),[g,v]=W.useState(0),C=W.useRef(null);if(W.useEffect(()=>{if(m(e),p(null),!t||!(e!=null&&e.id))return;let S=!1;return bt(null,null,function*(){try{f(!0);const U=yield fetch(`/api/monthly-feedback/${e.id}`);if(!U.ok)throw U.status===404?new Error("This feedback report was not found. It may have been deleted."):U.status===500?new Error("Server error occurred while loading the report."):new Error(`Unable to load report (Error ${U.status})`);const R=yield U.json();S||m(R)}catch(U){console.error("Failed to load feedback details:",U),S||p(U instanceof Error?U.message:"We could not load this report right now.")}finally{S||f(!1)}}),()=>{S=!0}},[t,e==null?void 0:e.id,g]),!e)return null;const b=c!=null?c:e,N={id:b.id||0,school:b.school||"Unknown School",month:b.month||"Unknown Month",year:b.year||new Date().getFullYear(),pdfUrl:b.pdfUrl||"",pdfFileName:b.pdfFileName||"document.pdf",extractedText:b.extractedText||null,notes:b.notes||null,uploadedBy:b.uploadedBy||null,fileSize:b.fileSize||null,createdAt:b.createdAt||new Date().toISOString()};W.useEffect(()=>{var R;if(!t)return;const S=q=>{q.key==="Escape"&&r()},_=(R=C.current)==null?void 0:R.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),U=_==null?void 0:_[0];return U&&U.focus(),document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[t,r]);const F=()=>{const S=document.createElement("a");S.href=N.pdfUrl,S.download=N.pdfFileName,document.body.appendChild(S),S.click(),document.body.removeChild(S),i({title:"Download Started",description:"PDF download has started."})},E=()=>bt(null,null,function*(){u(!0);try{if((yield fetch(`/api/monthly-feedback/${N.id}/notes`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:s})})).ok)i({title:"Notes Saved",description:"Your notes have been saved successfully."});else throw new Error("Failed to save notes")}catch(S){i({variant:"destructive",title:"Save Failed",description:"Failed to save notes. Please try again."})}finally{u(!1)}}),w=()=>{n&&confirm(`Are you sure you want to delete feedback for ${N.month} ${N.year}?`)&&n(N.id)};return d.jsxDEV(kc,{open:t,onOpenChange:r,children:d.jsxDEV(yl,{ref:C,className:"w-[70vw] h-[70vh] max-w-6xl overflow-hidden flex flex-col",children:[d.jsxDEV(Cl,{className:"flex-shrink-0",children:[d.jsxDEV(wl,{className:"flex items-center justify-between text-xl",children:[d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(Sa,{className:"w-5 h-5"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:178,columnNumber:15},this),N.month," ",N.year," - ",N.school]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:177,columnNumber:13},this),d.jsxDEV(Ct,{children:N.school},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:181,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:176,columnNumber:11},this),d.jsxDEV(El,{children:d.jsxDEV("div",{className:"flex items-center gap-4 text-sm",children:[d.jsxDEV("span",{className:"flex items-center gap-1",children:[d.jsxDEV(yr,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:186,columnNumber:17},this),new Date(N.createdAt).toLocaleDateString()]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:185,columnNumber:15},this),N.uploadedBy&&d.jsxDEV("span",{className:"flex items-center gap-1",children:[d.jsxDEV(za,{className:"w-4 h-4"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:191,columnNumber:19},this),N.uploadedBy]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:190,columnNumber:17},this),N.fileSize&&d.jsxDEV("span",{children:["Size: ",(N.fileSize/1024/1024).toFixed(2)," MB"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:196,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:184,columnNumber:13},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:183,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:175,columnNumber:9},this),d.jsxDEV(dS,{},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:202,columnNumber:9},this),d.jsxDEV("div",{className:"flex-1 overflow-hidden",children:[h&&d.jsxDEV("div",{className:"p-6 text-sm text-muted-foreground",children:"Loading detailsâ€¦"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:206,columnNumber:13},this),!h&&x&&d.jsxDEV("div",{className:"p-6",children:d.jsxDEV("div",{className:"border rounded-md p-4 bg-muted/50",children:[d.jsxDEV("p",{className:"text-sm text-destructive",children:x},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:211,columnNumber:17},this),d.jsxDEV("p",{className:"text-sm text-muted-foreground mt-2",children:"You can try again or download the original PDF if available."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:212,columnNumber:17},this),d.jsxDEV("div",{className:"mt-4 flex gap-2",children:[d.jsxDEV(Ye,{onClick:()=>{p(null),v(S=>S+1)},variant:"outline",children:"Retry"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:216,columnNumber:19},this),d.jsxDEV(Ye,{onClick:r,variant:"outline",children:"Back to Feedback Reports"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:225,columnNumber:19},this),N.pdfUrl&&d.jsxDEV(Ye,{onClick:F,children:[d.jsxDEV(Ii,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:230,columnNumber:23},this),"Download PDF"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:229,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:215,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:210,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:209,columnNumber:13},this),!h&&!x&&d.jsxDEV(dR,{defaultValue:"content",className:"w-full h-full flex flex-col",children:[d.jsxDEV(fS,{className:"grid w-full grid-cols-2 flex-shrink-0",children:[d.jsxDEV(gp,{value:"content",children:"Extracted Content"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:241,columnNumber:15},this),d.jsxDEV(gp,{value:"notes",children:"Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:242,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:240,columnNumber:13},this),d.jsxDEV(vp,{value:"content",className:"flex-1 overflow-y-auto space-y-4",children:d.jsxDEV("div",{className:"border rounded-lg p-4 bg-muted/50",children:N.extractedText?d.jsxDEV("div",{className:"prose prose-sm max-w-none",children:d.jsxDEV(lF,{children:N.extractedText},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:249,columnNumber:21},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:248,columnNumber:19},this):d.jsxDEV("p",{className:"text-muted-foreground text-center py-8",children:"Text could not be extracted â€“ download the PDF to view."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:252,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:246,columnNumber:15},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:245,columnNumber:13},this),d.jsxDEV(vp,{value:"notes",className:"flex-1 overflow-y-auto space-y-4",children:[d.jsxDEV(Tx,{value:s||N.notes||"",onChange:S=>o(S.target.value),placeholder:"Add notes about this feedback...",rows:10,maxLength:5e3},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:260,columnNumber:15},this),d.jsxDEV(Ye,{onClick:E,disabled:l,children:l?d.jsxDEV(d.Fragment,{children:"Saving..."},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:269,columnNumber:19},this):d.jsxDEV(d.Fragment,{children:[d.jsxDEV(t_,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:272,columnNumber:21},this),"Save Notes"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:271,columnNumber:19},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:267,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:259,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:239,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:204,columnNumber:9},this),d.jsxDEV(mS,{className:"flex justify-between",children:[d.jsxDEV("div",{className:"flex flex-col gap-2",children:[d.jsxDEV(Ye,{onClick:F,variant:"outline",children:[d.jsxDEV(Ii,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:285,columnNumber:15},this),"Download PDF"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:284,columnNumber:13},this),N.fileSize&&d.jsxDEV("p",{className:"text-xs text-muted-foreground",children:["Download original PDF â€“ ",(N.fileSize/1024/1024).toFixed(2)," MB"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:289,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:283,columnNumber:11},this),d.jsxDEV("div",{className:"flex items-center gap-2",children:[a&&n&&d.jsxDEV(Ye,{onClick:w,variant:"destructive",children:[d.jsxDEV(uF,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:297,columnNumber:17},this),"Delete"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:296,columnNumber:15},this),d.jsxDEV(Ye,{onClick:r,children:"Close"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:301,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:294,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:282,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:174,columnNumber:7},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/MonthlyFeedbackViewer.tsx",lineNumber:173,columnNumber:5},this)}function Cee({school:e,score:t,complianceStatus:r,dateRange:n,compact:a=!1}){const i=t.overallScore/5*100,s=u=>u>=4?"text-green-700":u>=3?"text-green-600":u>=2?"text-yellow-600":"text-red-600",o=u=>u>=4?"bg-green-600":u>=3?"bg-green-500":u>=2?"bg-yellow-500":"bg-red-500",l=u=>{switch(u){case"green":return"default";case"yellow":return"secondary";case"red":return"destructive";default:return"outline"}};return a?d.jsxDEV(Le,{className:"hover:shadow-md transition-shadow",children:[d.jsxDEV(Ke,{className:"pb-3",children:[d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV(Qe,{className:"text-lg",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:79,columnNumber:13},this),d.jsxDEV(Ct,{variant:l(r.color),children:[t.level2Compliant?d.jsxDEV(Fn,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:82,columnNumber:17},this):d.jsxDEV(Fr,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:84,columnNumber:17},this),r.text]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:80,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:78,columnNumber:11},this),n&&d.jsxDEV(ft,{className:"text-xs",children:[n.start," to ",n.end]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:90,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:77,columnNumber:9},this),d.jsxDEV(He,{children:d.jsxDEV("div",{className:"space-y-3",children:[d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("span",{className:"text-2xl font-bold",style:{color:s(t.overallScore)},children:t.overallScore.toFixed(2)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:98,columnNumber:15},this),d.jsxDEV("span",{className:"text-sm text-muted-foreground",children:"/ 5.0"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:101,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:97,columnNumber:13},this),d.jsxDEV(Bo,{value:i,className:o(t.overallScore)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:103,columnNumber:13},this),d.jsxDEV("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[d.jsxDEV("div",{children:[d.jsxDEV("div",{className:"text-muted-foreground",children:"Inspections"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:106,columnNumber:17},this),d.jsxDEV("div",{className:"font-semibold",children:t.inspectionCount},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:107,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:105,columnNumber:15},this),d.jsxDEV("div",{children:[d.jsxDEV("div",{className:"text-muted-foreground",children:"Notes"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:110,columnNumber:17},this),d.jsxDEV("div",{className:"font-semibold",children:t.notesCount},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:111,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:109,columnNumber:15},this),d.jsxDEV("div",{children:[d.jsxDEV("div",{className:"text-muted-foreground",children:"Avg Rating"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:114,columnNumber:17},this),d.jsxDEV("div",{className:"font-semibold",children:t.inspectionScore.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:115,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:113,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:104,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:96,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:95,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:76,columnNumber:7},this):d.jsxDEV(Le,{className:"hover:shadow-lg transition-shadow",children:[d.jsxDEV(Ke,{children:d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("div",{children:[d.jsxDEV(Qe,{className:"text-2xl",children:e},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:129,columnNumber:13},this),n&&d.jsxDEV(ft,{children:["Period: ",n.start," to ",n.end]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:131,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:128,columnNumber:11},this),d.jsxDEV(Ct,{variant:l(r.color),className:"text-sm px-3 py-1",children:[t.level2Compliant?d.jsxDEV(Fn,{className:"w-4 h-4 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:138,columnNumber:15},this):d.jsxDEV(Fr,{className:"w-4 h-4 mr-1"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:140,columnNumber:15},this),r.text]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:136,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:127,columnNumber:9},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:126,columnNumber:7},this),d.jsxDEV(He,{className:"space-y-6",children:[d.jsxDEV("div",{className:"text-center space-y-2",children:[d.jsxDEV("div",{className:"text-6xl font-bold",style:{color:s(t.overallScore)},children:t.overallScore.toFixed(2)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:149,columnNumber:11},this),d.jsxDEV("div",{className:"text-sm text-muted-foreground",children:"Overall Building Score (out of 5.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:152,columnNumber:11},this),d.jsxDEV(Bo,{value:i,className:`h-3 ${o(t.overallScore)}`},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:153,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:148,columnNumber:9},this),d.jsxDEV("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t",children:[d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV("div",{className:"text-sm font-medium text-muted-foreground",children:"Inspection Average"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:159,columnNumber:13},this),d.jsxDEV("div",{className:"text-2xl font-bold",children:t.inspectionScore.toFixed(2)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:160,columnNumber:13},this),d.jsxDEV("div",{className:"text-xs text-muted-foreground",children:["75% weight â€¢ ",t.inspectionCount," inspections"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:161,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:158,columnNumber:11},this),d.jsxDEV("div",{className:"space-y-2",children:[d.jsxDEV("div",{className:"text-sm font-medium text-muted-foreground",children:"Notes Impact"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:164,columnNumber:13},this),d.jsxDEV("div",{className:"text-2xl font-bold flex items-center gap-1",children:[t.notesModifier>0?d.jsxDEV(zs,{className:"w-5 h-5 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:167,columnNumber:17},this):t.notesModifier<0?d.jsxDEV(yx,{className:"w-5 h-5 text-red-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:169,columnNumber:17},this):null,t.notesModifier>0?"+":"",t.notesModifier.toFixed(2)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:165,columnNumber:13},this),d.jsxDEV("div",{className:"text-xs text-muted-foreground",children:["25% weight â€¢ ",t.notesCount," notes"]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:173,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:163,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:157,columnNumber:9},this),t.categoryBreakdown&&t.categoryBreakdown.length>0&&d.jsxDEV("div",{className:"space-y-3 pt-4 border-t",children:[d.jsxDEV("div",{className:"text-sm font-medium",children:"Category Breakdown"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:180,columnNumber:13},this),d.jsxDEV("div",{className:"space-y-2",children:t.categoryBreakdown.filter(u=>u.count>0).sort((u,c)=>c.averageRating-u.averageRating).slice(0,5).map(u=>d.jsxDEV("div",{className:"flex items-center justify-between",children:[d.jsxDEV("span",{className:"text-sm",children:u.category},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:188,columnNumber:21},this),d.jsxDEV("div",{className:"flex items-center gap-2",children:[d.jsxDEV(Bo,{value:u.averageRating/5*100,className:"w-24 h-2"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:190,columnNumber:23},this),d.jsxDEV("span",{className:"text-sm font-semibold w-12 text-right",children:u.averageRating.toFixed(1)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:194,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:189,columnNumber:21},this)]},u.category,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:187,columnNumber:19},this))},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:181,columnNumber:13},this),t.categoryBreakdown.filter(u=>u.count>0).length>5&&d.jsxDEV("div",{className:"text-xs text-muted-foreground text-center",children:"Showing top 5 categories"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:202,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:179,columnNumber:11},this),d.jsxDEV("div",{className:`p-3 rounded-lg border ${t.level2Compliant?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"}`,children:d.jsxDEV("div",{className:"flex items-center gap-2",children:[t.level2Compliant?d.jsxDEV(Fn,{className:"w-5 h-5 text-green-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:217,columnNumber:15},this):d.jsxDEV(Fr,{className:"w-5 h-5 text-yellow-600"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:219,columnNumber:15},this),d.jsxDEV("div",{className:"text-sm",children:t.level2Compliant?d.jsxDEV("span",{className:"font-semibold text-green-800",children:"Meets Level 2 Standards (â‰¥3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:223,columnNumber:17},this):d.jsxDEV("span",{className:"font-semibold text-yellow-800",children:"Below Level 2 Standards (target: â‰¥3.0)"},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:227,columnNumber:17},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:221,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:215,columnNumber:11},this)},void 0,!1,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:210,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:146,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/rharman/CustodialCommand/src/components/building-score-card.tsx",lineNumber:125,columnNumber:5},this)}function uE(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(u){return void r(u)}o.done?t(l):Promise.resolve(l).then(n,a)}function Ea(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function s(l){uE(i,n,a,s,o,"next",l)}function o(l){uE(i,n,a,s,o,"throw",l)}s(void 0)})}}function lQ(e,t){if(dl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(dl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uQ(e){var t=lQ(e,"string");return dl(t)=="symbol"?t:t+""}function l1(e,t,r){return(t=uQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _o={exports:{}},yi={exports:{}},cQ=yi.exports,cE;function mQ(){return cE||(cE=1,(function(){var e,t,r,n,a,i;typeof performance!="undefined"&&performance!==null&&performance.now?yi.exports=function(){return performance.now()}:typeof process!="undefined"&&process!==null&&process.hrtime?(yi.exports=function(){return(e()-a)/1e6},t=process.hrtime,e=function(){var s;return s=t(),s[0]*1e9+s[1]},n=e(),i=process.uptime()*1e9,a=n-i):Date.now?(yi.exports=function(){return Date.now()-r},r=Date.now()):(yi.exports=function(){return new Date().getTime()-r},r=new Date().getTime())}).call(cQ)),yi.exports}var mE;function dQ(){if(mE)return _o.exports;mE=1;for(var e=mQ(),t=typeof window=="undefined"?Do:window,r=["moz","webkit"],n="AnimationFrame",a=t["request"+n],i=t["cancel"+n]||t["cancelRequest"+n],s=0;!a&&s<r.length;s++)a=t[r[s]+"Request"+n],i=t[r[s]+"Cancel"+n]||t[r[s]+"CancelRequest"+n];if(!a||!i){var o=0,l=0,u=[],c=1e3/60;a=function(m){if(u.length===0){var h=e(),f=Math.max(0,c-(h-o));o=f+h,setTimeout(function(){var x=u.slice(0);u.length=0;for(var p=0;p<x.length;p++)if(!x[p].cancelled)try{x[p].callback(o)}catch(g){setTimeout(function(){throw g},0)}},Math.round(f))}return u.push({handle:++l,callback:m,cancelled:!1}),l},i=function(m){for(var h=0;h<u.length;h++)u[h].handle===m&&(u[h].cancelled=!0)}}return _o.exports=function(m){return a.call(t,m)},_o.exports.cancel=function(){i.apply(t,arguments)},_o.exports.polyfill=function(m){m||(m=t),m.requestAnimationFrame=a,m.cancelAnimationFrame=i},_o.exports}var fQ=dQ();const ap=at(fQ);var ip,dE;function hQ(){return dE||(dE=1,ip=function(e){this.ok=!1,this.alpha=1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};e=t[e]||e;for(var r=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3]),parseFloat(l[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,s=a.exec(e);if(s){var o=i(s);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var l=this.r.toString(16),u=this.g.toString(16),c=this.b.toString(16);return l.length==1&&(l="0"+l),u.length==1&&(u="0"+u),c.length==1&&(c="0"+c),"#"+l+u+c},this.getHelpXML=function(){for(var l=new Array,u=0;u<r.length;u++)for(var c=r[u].example,m=0;m<c.length;m++)l[l.length]=c[m];for(var h in t)l[l.length]=h;var f=document.createElement("ul");f.setAttribute("id","rgbcolor-examples");for(var u=0;u<l.length;u++)try{var x=document.createElement("li"),p=new RGBColor(l[u]),g=document.createElement("div");g.style.cssText="margin: 3px; border: 1px solid black; background:"+p.toHex()+"; color:"+p.toHex(),g.appendChild(document.createTextNode("test"));var v=document.createTextNode(" "+l[u]+" -> "+p.toRGB()+" -> "+p.toHex());x.appendChild(g),x.appendChild(v),f.appendChild(x)}catch(b){}return f}}),ip}var pQ=hQ();const nx=at(pQ);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var i4=function(e,t){return(i4=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])})(e,t)};function s4(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i4(e,t),e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function xQ(e){var t="";Array.isArray(e)||(e=[e]);for(var r=0;r<e.length;r++){var n=e[r];if(n.type===ge.CLOSE_PATH)t+="z";else if(n.type===ge.HORIZ_LINE_TO)t+=(n.relative?"h":"H")+n.x;else if(n.type===ge.VERT_LINE_TO)t+=(n.relative?"v":"V")+n.y;else if(n.type===ge.MOVE_TO)t+=(n.relative?"m":"M")+n.x+" "+n.y;else if(n.type===ge.LINE_TO)t+=(n.relative?"l":"L")+n.x+" "+n.y;else if(n.type===ge.CURVE_TO)t+=(n.relative?"c":"C")+n.x1+" "+n.y1+" "+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===ge.SMOOTH_CURVE_TO)t+=(n.relative?"s":"S")+n.x2+" "+n.y2+" "+n.x+" "+n.y;else if(n.type===ge.QUAD_TO)t+=(n.relative?"q":"Q")+n.x1+" "+n.y1+" "+n.x+" "+n.y;else if(n.type===ge.SMOOTH_QUAD_TO)t+=(n.relative?"t":"T")+n.x+" "+n.y;else{if(n.type!==ge.ARC)throw new Error('Unexpected command type "'+n.type+'" at index '+r+".");t+=(n.relative?"a":"A")+n.rX+" "+n.rY+" "+n.xRot+" "+ +n.lArcFlag+" "+ +n.sweepFlag+" "+n.x+" "+n.y}}return t}function ax(e,t){var r=e[0],n=e[1];return[r*Math.cos(t)-n*Math.sin(t),r*Math.sin(t)+n*Math.cos(t)]}function wn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0;r<e.length;r++)if(typeof e[r]!="number")throw new Error("assertNumbers arguments["+r+"] is not a number. "+typeof e[r]+" == typeof "+e[r]);return!0}var Ia=Math.PI;function sp(e,t,r){e.lArcFlag=e.lArcFlag===0?0:1,e.sweepFlag=e.sweepFlag===0?0:1;var n=e.rX,a=e.rY,i=e.x,s=e.y;n=Math.abs(e.rX),a=Math.abs(e.rY);var o=ax([(t-i)/2,(r-s)/2],-e.xRot/180*Ia),l=o[0],u=o[1],c=Math.pow(l,2)/Math.pow(n,2)+Math.pow(u,2)/Math.pow(a,2);1<c&&(n*=Math.sqrt(c),a*=Math.sqrt(c)),e.rX=n,e.rY=a;var m=Math.pow(n,2)*Math.pow(u,2)+Math.pow(a,2)*Math.pow(l,2),h=(e.lArcFlag!==e.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(n,2)*Math.pow(a,2)-m)/m)),f=n*u/a*h,x=-a*l/n*h,p=ax([f,x],e.xRot/180*Ia);e.cX=p[0]+(t+i)/2,e.cY=p[1]+(r+s)/2,e.phi1=Math.atan2((u-x)/a,(l-f)/n),e.phi2=Math.atan2((-u-x)/a,(-l-f)/n),e.sweepFlag===0&&e.phi2>e.phi1&&(e.phi2-=2*Ia),e.sweepFlag===1&&e.phi2<e.phi1&&(e.phi2+=2*Ia),e.phi1*=180/Ia,e.phi2*=180/Ia}function fE(e,t,r){wn(e,t,r);var n=e*e+t*t-r*r;if(0>n)return[];if(n===0)return[[e*r/(e*e+t*t),t*r/(e*e+t*t)]];var a=Math.sqrt(n);return[[(e*r+t*a)/(e*e+t*t),(t*r-e*a)/(e*e+t*t)],[(e*r-t*a)/(e*e+t*t),(t*r+e*a)/(e*e+t*t)]]}var Wt,oa=Math.PI/180;function hE(e,t,r){return(1-r)*e+r*t}function pE(e,t,r,n){return e+Math.cos(n/180*Ia)*t+Math.sin(n/180*Ia)*r}function xE(e,t,r,n){var a=1e-6,i=t-e,s=r-t,o=3*i+3*(n-r)-6*s,l=6*(s-i),u=3*i;return Math.abs(o)<a?[-u/l]:(function(c,m,h){var f=c*c/4-m;if(f<-h)return[];if(f<=h)return[-c/2];var x=Math.sqrt(f);return[-c/2-x,-c/2+x]})(l/o,u/o,a)}function gE(e,t,r,n,a){var i=1-a;return e*(i*i*i)+t*(3*i*i*a)+r*(3*i*a*a)+n*(a*a*a)}(function(e){function t(){return a((function(o,l,u){return o.relative&&(o.x1!==void 0&&(o.x1+=l),o.y1!==void 0&&(o.y1+=u),o.x2!==void 0&&(o.x2+=l),o.y2!==void 0&&(o.y2+=u),o.x!==void 0&&(o.x+=l),o.y!==void 0&&(o.y+=u),o.relative=!1),o}))}function r(){var o=NaN,l=NaN,u=NaN,c=NaN;return a((function(m,h,f){return m.type&ge.SMOOTH_CURVE_TO&&(m.type=ge.CURVE_TO,o=isNaN(o)?h:o,l=isNaN(l)?f:l,m.x1=m.relative?h-o:2*h-o,m.y1=m.relative?f-l:2*f-l),m.type&ge.CURVE_TO?(o=m.relative?h+m.x2:m.x2,l=m.relative?f+m.y2:m.y2):(o=NaN,l=NaN),m.type&ge.SMOOTH_QUAD_TO&&(m.type=ge.QUAD_TO,u=isNaN(u)?h:u,c=isNaN(c)?f:c,m.x1=m.relative?h-u:2*h-u,m.y1=m.relative?f-c:2*f-c),m.type&ge.QUAD_TO?(u=m.relative?h+m.x1:m.x1,c=m.relative?f+m.y1:m.y1):(u=NaN,c=NaN),m}))}function n(){var o=NaN,l=NaN;return a((function(u,c,m){if(u.type&ge.SMOOTH_QUAD_TO&&(u.type=ge.QUAD_TO,o=isNaN(o)?c:o,l=isNaN(l)?m:l,u.x1=u.relative?c-o:2*c-o,u.y1=u.relative?m-l:2*m-l),u.type&ge.QUAD_TO){o=u.relative?c+u.x1:u.x1,l=u.relative?m+u.y1:u.y1;var h=u.x1,f=u.y1;u.type=ge.CURVE_TO,u.x1=((u.relative?0:c)+2*h)/3,u.y1=((u.relative?0:m)+2*f)/3,u.x2=(u.x+2*h)/3,u.y2=(u.y+2*f)/3}else o=NaN,l=NaN;return u}))}function a(o){var l=0,u=0,c=NaN,m=NaN;return function(h){if(isNaN(c)&&!(h.type&ge.MOVE_TO))throw new Error("path must start with moveto");var f=o(h,l,u,c,m);return h.type&ge.CLOSE_PATH&&(l=c,u=m),h.x!==void 0&&(l=h.relative?l+h.x:h.x),h.y!==void 0&&(u=h.relative?u+h.y:h.y),h.type&ge.MOVE_TO&&(c=l,m=u),f}}function i(o,l,u,c,m,h){return wn(o,l,u,c,m,h),a((function(f,x,p,g){var v=f.x1,C=f.x2,b=f.relative&&!isNaN(g),N=f.x!==void 0?f.x:b?0:x,F=f.y!==void 0?f.y:b?0:p;function E(j){return j*j}f.type&ge.HORIZ_LINE_TO&&l!==0&&(f.type=ge.LINE_TO,f.y=f.relative?0:p),f.type&ge.VERT_LINE_TO&&u!==0&&(f.type=ge.LINE_TO,f.x=f.relative?0:x),f.x!==void 0&&(f.x=f.x*o+F*u+(b?0:m)),f.y!==void 0&&(f.y=N*l+f.y*c+(b?0:h)),f.x1!==void 0&&(f.x1=f.x1*o+f.y1*u+(b?0:m)),f.y1!==void 0&&(f.y1=v*l+f.y1*c+(b?0:h)),f.x2!==void 0&&(f.x2=f.x2*o+f.y2*u+(b?0:m)),f.y2!==void 0&&(f.y2=C*l+f.y2*c+(b?0:h));var w=o*c-l*u;if(f.xRot!==void 0&&(o!==1||l!==0||u!==0||c!==1))if(w===0)delete f.rX,delete f.rY,delete f.xRot,delete f.lArcFlag,delete f.sweepFlag,f.type=ge.LINE_TO;else{var S=f.xRot*Math.PI/180,_=Math.sin(S),U=Math.cos(S),R=1/E(f.rX),q=1/E(f.rY),M=E(U)*R+E(_)*q,Y=2*_*U*(R-q),K=E(_)*R+E(U)*q,de=M*c*c-Y*l*c+K*l*l,pe=Y*(o*c+l*u)-2*(M*u*c+K*o*l),Ae=M*u*u-Y*o*u+K*o*o,Ne=(Math.atan2(pe,de-Ae)+Math.PI)%Math.PI/2,k=Math.sin(Ne),le=Math.cos(Ne);f.rX=Math.abs(w)/Math.sqrt(de*E(le)+pe*k*le+Ae*E(k)),f.rY=Math.abs(w)/Math.sqrt(de*E(k)-pe*k*le+Ae*E(le)),f.xRot=180*Ne/Math.PI}return f.sweepFlag!==void 0&&0>w&&(f.sweepFlag=+!f.sweepFlag),f}))}function s(){return function(o){var l={};for(var u in o)l[u]=o[u];return l}}e.ROUND=function(o){function l(u){return Math.round(u*o)/o}return o===void 0&&(o=1e13),wn(o),function(u){return u.x1!==void 0&&(u.x1=l(u.x1)),u.y1!==void 0&&(u.y1=l(u.y1)),u.x2!==void 0&&(u.x2=l(u.x2)),u.y2!==void 0&&(u.y2=l(u.y2)),u.x!==void 0&&(u.x=l(u.x)),u.y!==void 0&&(u.y=l(u.y)),u.rX!==void 0&&(u.rX=l(u.rX)),u.rY!==void 0&&(u.rY=l(u.rY)),u}},e.TO_ABS=t,e.TO_REL=function(){return a((function(o,l,u){return o.relative||(o.x1!==void 0&&(o.x1-=l),o.y1!==void 0&&(o.y1-=u),o.x2!==void 0&&(o.x2-=l),o.y2!==void 0&&(o.y2-=u),o.x!==void 0&&(o.x-=l),o.y!==void 0&&(o.y-=u),o.relative=!0),o}))},e.NORMALIZE_HVZ=function(o,l,u){return o===void 0&&(o=!0),l===void 0&&(l=!0),u===void 0&&(u=!0),a((function(c,m,h,f,x){if(isNaN(f)&&!(c.type&ge.MOVE_TO))throw new Error("path must start with moveto");return l&&c.type&ge.HORIZ_LINE_TO&&(c.type=ge.LINE_TO,c.y=c.relative?0:h),u&&c.type&ge.VERT_LINE_TO&&(c.type=ge.LINE_TO,c.x=c.relative?0:m),o&&c.type&ge.CLOSE_PATH&&(c.type=ge.LINE_TO,c.x=c.relative?f-m:f,c.y=c.relative?x-h:x),c.type&ge.ARC&&(c.rX===0||c.rY===0)&&(c.type=ge.LINE_TO,delete c.rX,delete c.rY,delete c.xRot,delete c.lArcFlag,delete c.sweepFlag),c}))},e.NORMALIZE_ST=r,e.QT_TO_C=n,e.INFO=a,e.SANITIZE=function(o){o===void 0&&(o=0),wn(o);var l=NaN,u=NaN,c=NaN,m=NaN;return a((function(h,f,x,p,g){var v=Math.abs,C=!1,b=0,N=0;if(h.type&ge.SMOOTH_CURVE_TO&&(b=isNaN(l)?0:f-l,N=isNaN(u)?0:x-u),h.type&(ge.CURVE_TO|ge.SMOOTH_CURVE_TO)?(l=h.relative?f+h.x2:h.x2,u=h.relative?x+h.y2:h.y2):(l=NaN,u=NaN),h.type&ge.SMOOTH_QUAD_TO?(c=isNaN(c)?f:2*f-c,m=isNaN(m)?x:2*x-m):h.type&ge.QUAD_TO?(c=h.relative?f+h.x1:h.x1,m=h.relative?x+h.y1:h.y2):(c=NaN,m=NaN),h.type&ge.LINE_COMMANDS||h.type&ge.ARC&&(h.rX===0||h.rY===0||!h.lArcFlag)||h.type&ge.CURVE_TO||h.type&ge.SMOOTH_CURVE_TO||h.type&ge.QUAD_TO||h.type&ge.SMOOTH_QUAD_TO){var F=h.x===void 0?0:h.relative?h.x:h.x-f,E=h.y===void 0?0:h.relative?h.y:h.y-x;b=isNaN(c)?h.x1===void 0?b:h.relative?h.x:h.x1-f:c-f,N=isNaN(m)?h.y1===void 0?N:h.relative?h.y:h.y1-x:m-x;var w=h.x2===void 0?0:h.relative?h.x:h.x2-f,S=h.y2===void 0?0:h.relative?h.y:h.y2-x;v(F)<=o&&v(E)<=o&&v(b)<=o&&v(N)<=o&&v(w)<=o&&v(S)<=o&&(C=!0)}return h.type&ge.CLOSE_PATH&&v(f-p)<=o&&v(x-g)<=o&&(C=!0),C?[]:h}))},e.MATRIX=i,e.ROTATE=function(o,l,u){l===void 0&&(l=0),u===void 0&&(u=0),wn(o,l,u);var c=Math.sin(o),m=Math.cos(o);return i(m,c,-c,m,l-l*m+u*c,u-l*c-u*m)},e.TRANSLATE=function(o,l){return l===void 0&&(l=0),wn(o,l),i(1,0,0,1,o,l)},e.SCALE=function(o,l){return l===void 0&&(l=o),wn(o,l),i(o,0,0,l,0,0)},e.SKEW_X=function(o){return wn(o),i(1,0,Math.atan(o),1,0,0)},e.SKEW_Y=function(o){return wn(o),i(1,Math.atan(o),0,1,0,0)},e.X_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),wn(o),i(-1,0,0,1,o,0)},e.Y_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),wn(o),i(1,0,0,-1,0,o)},e.A_TO_C=function(){return a((function(o,l,u){return ge.ARC===o.type?(function(c,m,h){var f,x,p,g;c.cX||sp(c,m,h);for(var v=Math.min(c.phi1,c.phi2),C=Math.max(c.phi1,c.phi2)-v,b=Math.ceil(C/90),N=new Array(b),F=m,E=h,w=0;w<b;w++){var S=hE(c.phi1,c.phi2,w/b),_=hE(c.phi1,c.phi2,(w+1)/b),U=_-S,R=4/3*Math.tan(U*oa/4),q=[Math.cos(S*oa)-R*Math.sin(S*oa),Math.sin(S*oa)+R*Math.cos(S*oa)],M=q[0],Y=q[1],K=[Math.cos(_*oa),Math.sin(_*oa)],de=K[0],pe=K[1],Ae=[de+R*Math.sin(_*oa),pe-R*Math.cos(_*oa)],Ne=Ae[0],k=Ae[1];N[w]={relative:c.relative,type:ge.CURVE_TO};var le=function(j,y){var V=ax([j*c.rX,y*c.rY],c.xRot),I=V[0],G=V[1];return[c.cX+I,c.cY+G]};f=le(M,Y),N[w].x1=f[0],N[w].y1=f[1],x=le(Ne,k),N[w].x2=x[0],N[w].y2=x[1],p=le(de,pe),N[w].x=p[0],N[w].y=p[1],c.relative&&(N[w].x1-=F,N[w].y1-=E,N[w].x2-=F,N[w].y2-=E,N[w].x-=F,N[w].y-=E),F=(g=[N[w].x,N[w].y])[0],E=g[1]}return N})(o,o.relative?0:l,o.relative?0:u):o}))},e.ANNOTATE_ARCS=function(){return a((function(o,l,u){return o.relative&&(l=0,u=0),ge.ARC===o.type&&sp(o,l,u),o}))},e.CLONE=s,e.CALCULATE_BOUNDS=function(){var o=function(h){var f={};for(var x in h)f[x]=h[x];return f},l=t(),u=n(),c=r(),m=a((function(h,f,x){var p=c(u(l(o(h))));function g(k){k>m.maxX&&(m.maxX=k),k<m.minX&&(m.minX=k)}function v(k){k>m.maxY&&(m.maxY=k),k<m.minY&&(m.minY=k)}if(p.type&ge.DRAWING_COMMANDS&&(g(f),v(x)),p.type&ge.HORIZ_LINE_TO&&g(p.x),p.type&ge.VERT_LINE_TO&&v(p.y),p.type&ge.LINE_TO&&(g(p.x),v(p.y)),p.type&ge.CURVE_TO){g(p.x),v(p.y);for(var C=0,b=xE(f,p.x1,p.x2,p.x);C<b.length;C++)0<(Ne=b[C])&&1>Ne&&g(gE(f,p.x1,p.x2,p.x,Ne));for(var N=0,F=xE(x,p.y1,p.y2,p.y);N<F.length;N++)0<(Ne=F[N])&&1>Ne&&v(gE(x,p.y1,p.y2,p.y,Ne))}if(p.type&ge.ARC){g(p.x),v(p.y),sp(p,f,x);for(var E=p.xRot/180*Math.PI,w=Math.cos(E)*p.rX,S=Math.sin(E)*p.rX,_=-Math.sin(E)*p.rY,U=Math.cos(E)*p.rY,R=p.phi1<p.phi2?[p.phi1,p.phi2]:-180>p.phi2?[p.phi2+360,p.phi1+360]:[p.phi2,p.phi1],q=R[0],M=R[1],Y=function(k){var le=k[0],j=k[1],y=180*Math.atan2(j,le)/Math.PI;return y<q?y+360:y},K=0,de=fE(_,-w,0).map(Y);K<de.length;K++)(Ne=de[K])>q&&Ne<M&&g(pE(p.cX,w,_,Ne));for(var pe=0,Ae=fE(U,-S,0).map(Y);pe<Ae.length;pe++){var Ne;(Ne=Ae[pe])>q&&Ne<M&&v(pE(p.cY,S,U,Ne))}}return h}));return m.minX=1/0,m.maxX=-1/0,m.minY=1/0,m.maxY=-1/0,m}})(Wt||(Wt={}));var Cn,o4=(function(){function e(){}return e.prototype.round=function(t){return this.transform(Wt.ROUND(t))},e.prototype.toAbs=function(){return this.transform(Wt.TO_ABS())},e.prototype.toRel=function(){return this.transform(Wt.TO_REL())},e.prototype.normalizeHVZ=function(t,r,n){return this.transform(Wt.NORMALIZE_HVZ(t,r,n))},e.prototype.normalizeST=function(){return this.transform(Wt.NORMALIZE_ST())},e.prototype.qtToC=function(){return this.transform(Wt.QT_TO_C())},e.prototype.aToC=function(){return this.transform(Wt.A_TO_C())},e.prototype.sanitize=function(t){return this.transform(Wt.SANITIZE(t))},e.prototype.translate=function(t,r){return this.transform(Wt.TRANSLATE(t,r))},e.prototype.scale=function(t,r){return this.transform(Wt.SCALE(t,r))},e.prototype.rotate=function(t,r,n){return this.transform(Wt.ROTATE(t,r,n))},e.prototype.matrix=function(t,r,n,a,i,s){return this.transform(Wt.MATRIX(t,r,n,a,i,s))},e.prototype.skewX=function(t){return this.transform(Wt.SKEW_X(t))},e.prototype.skewY=function(t){return this.transform(Wt.SKEW_Y(t))},e.prototype.xSymmetry=function(t){return this.transform(Wt.X_AXIS_SYMMETRY(t))},e.prototype.ySymmetry=function(t){return this.transform(Wt.Y_AXIS_SYMMETRY(t))},e.prototype.annotateArcs=function(){return this.transform(Wt.ANNOTATE_ARCS())},e})(),gQ=function(e){return e===" "||e==="	"||e==="\r"||e===`
`},vE=function(e){return 48<=e.charCodeAt(0)&&e.charCodeAt(0)<=57},vQ=(function(e){function t(){var r=e.call(this)||this;return r.curNumber="",r.curCommandType=-1,r.curCommandRelative=!1,r.canParseCommandOrComma=!0,r.curNumberHasExp=!1,r.curNumberHasExpDigits=!1,r.curNumberHasDecimal=!1,r.curArgs=[],r}return s4(t,e),t.prototype.finish=function(r){if(r===void 0&&(r=[]),this.parse(" ",r),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return r},t.prototype.parse=function(r,n){var a=this;n===void 0&&(n=[]);for(var i=function(m){n.push(m),a.curArgs.length=0,a.canParseCommandOrComma=!0},s=0;s<r.length;s++){var o=r[s],l=!(this.curCommandType!==ge.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),u=vE(o)&&(this.curNumber==="0"&&o==="0"||l);if(!vE(o)||u)if(o!=="e"&&o!=="E")if(o!=="-"&&o!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(o!=="."||this.curNumberHasExp||this.curNumberHasDecimal||l){if(this.curNumber&&this.curCommandType!==-1){var c=Number(this.curNumber);if(isNaN(c))throw new SyntaxError("Invalid number ending at "+s);if(this.curCommandType===ge.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>c)throw new SyntaxError('Expected positive number, got "'+c+'" at index "'+s+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+s+'"')}this.curArgs.push(c),this.curArgs.length===bQ[this.curCommandType]&&(ge.HORIZ_LINE_TO===this.curCommandType?i({type:ge.HORIZ_LINE_TO,relative:this.curCommandRelative,x:c}):ge.VERT_LINE_TO===this.curCommandType?i({type:ge.VERT_LINE_TO,relative:this.curCommandRelative,y:c}):this.curCommandType===ge.MOVE_TO||this.curCommandType===ge.LINE_TO||this.curCommandType===ge.SMOOTH_QUAD_TO?(i({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),ge.MOVE_TO===this.curCommandType&&(this.curCommandType=ge.LINE_TO)):this.curCommandType===ge.CURVE_TO?i({type:ge.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===ge.SMOOTH_CURVE_TO?i({type:ge.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===ge.QUAD_TO?i({type:ge.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===ge.ARC&&i({type:ge.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!gQ(o))if(o===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(o!=="+"&&o!=="-"&&o!==".")if(u)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+s+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+s+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,o!=="z"&&o!=="Z")if(o==="h"||o==="H")this.curCommandType=ge.HORIZ_LINE_TO,this.curCommandRelative=o==="h";else if(o==="v"||o==="V")this.curCommandType=ge.VERT_LINE_TO,this.curCommandRelative=o==="v";else if(o==="m"||o==="M")this.curCommandType=ge.MOVE_TO,this.curCommandRelative=o==="m";else if(o==="l"||o==="L")this.curCommandType=ge.LINE_TO,this.curCommandRelative=o==="l";else if(o==="c"||o==="C")this.curCommandType=ge.CURVE_TO,this.curCommandRelative=o==="c";else if(o==="s"||o==="S")this.curCommandType=ge.SMOOTH_CURVE_TO,this.curCommandRelative=o==="s";else if(o==="q"||o==="Q")this.curCommandType=ge.QUAD_TO,this.curCommandRelative=o==="q";else if(o==="t"||o==="T")this.curCommandType=ge.SMOOTH_QUAD_TO,this.curCommandRelative=o==="t";else{if(o!=="a"&&o!=="A")throw new SyntaxError('Unexpected character "'+o+'" at index '+s+".");this.curCommandType=ge.ARC,this.curCommandRelative=o==="a"}else n.push({type:ge.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal=o==="."}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return n},t.prototype.transform=function(r){return Object.create(this,{parse:{value:function(n,a){a===void 0&&(a=[]);for(var i=0,s=Object.getPrototypeOf(this).parse.call(this,n);i<s.length;i++){var o=s[i],l=r(o);Array.isArray(l)?a.push.apply(a,l):a.push(l)}return a}}})},t})(o4),ge=(function(e){function t(r){var n=e.call(this)||this;return n.commands=typeof r=="string"?t.parse(r):r,n}return s4(t,e),t.prototype.encode=function(){return t.encode(this.commands)},t.prototype.getBounds=function(){var r=Wt.CALCULATE_BOUNDS();return this.transform(r),r},t.prototype.transform=function(r){for(var n=[],a=0,i=this.commands;a<i.length;a++){var s=r(i[a]);Array.isArray(s)?n.push.apply(n,s):n.push(s)}return this.commands=n,this},t.encode=function(r){return xQ(r)},t.parse=function(r){var n=new vQ,a=[];return n.parse(r,a),n.finish(a),a},t.CLOSE_PATH=1,t.MOVE_TO=2,t.HORIZ_LINE_TO=4,t.VERT_LINE_TO=8,t.LINE_TO=16,t.CURVE_TO=32,t.SMOOTH_CURVE_TO=64,t.QUAD_TO=128,t.SMOOTH_QUAD_TO=256,t.ARC=512,t.LINE_COMMANDS=t.LINE_TO|t.HORIZ_LINE_TO|t.VERT_LINE_TO,t.DRAWING_COMMANDS=t.HORIZ_LINE_TO|t.VERT_LINE_TO|t.LINE_TO|t.CURVE_TO|t.SMOOTH_CURVE_TO|t.QUAD_TO|t.SMOOTH_QUAD_TO|t.ARC,t})(o4),bQ=((Cn={})[ge.MOVE_TO]=2,Cn[ge.LINE_TO]=2,Cn[ge.HORIZ_LINE_TO]=1,Cn[ge.VERT_LINE_TO]=1,Cn[ge.CLOSE_PATH]=0,Cn[ge.QUAD_TO]=4,Cn[ge.SMOOTH_QUAD_TO]=2,Cn[ge.CURVE_TO]=6,Cn[ge.SMOOTH_CURVE_TO]=4,Cn[ge.ARC]=7,Cn);function Uu(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Uu=function(t){return typeof t}:Uu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function NQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var yQ=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],CQ=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function wQ(e,t,r,n,a){if(typeof e=="string"&&(e=document.getElementById(e)),!e||Uu(e)!=="object"||!("getContext"in e))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var i=e.getContext("2d");try{return i.getImageData(t,r,n,a)}catch(s){throw new Error("unable to access image data: "+s)}}function EQ(e,t,r,n,a,i){if(!(isNaN(i)||i<1)){i|=0;var s=wQ(e,t,r,n,a);s=_Q(s,t,r,n,a,i),e.getContext("2d").putImageData(s,t,r)}}function _Q(e,t,r,n,a,i){for(var s=e.data,o=2*i+1,l=n-1,u=a-1,c=i+1,m=c*(c+1)/2,h=new bE,f=h,x,p=1;p<o;p++)f=f.next=new bE,p===c&&(x=f);f.next=h;for(var g=null,v=null,C=0,b=0,N=yQ[i],F=CQ[i],E=0;E<a;E++){f=h;for(var w=s[b],S=s[b+1],_=s[b+2],U=s[b+3],R=0;R<c;R++)f.r=w,f.g=S,f.b=_,f.a=U,f=f.next;for(var q=0,M=0,Y=0,K=0,de=c*w,pe=c*S,Ae=c*_,Ne=c*U,k=m*w,le=m*S,j=m*_,y=m*U,V=1;V<c;V++){var I=b+((l<V?l:V)<<2),G=s[I],ie=s[I+1],ae=s[I+2],Q=s[I+3],Z=c-V;k+=(f.r=G)*Z,le+=(f.g=ie)*Z,j+=(f.b=ae)*Z,y+=(f.a=Q)*Z,q+=G,M+=ie,Y+=ae,K+=Q,f=f.next}g=h,v=x;for(var ve=0;ve<n;ve++){var J=y*N>>>F;if(s[b+3]=J,J!==0){var je=255/J;s[b]=(k*N>>>F)*je,s[b+1]=(le*N>>>F)*je,s[b+2]=(j*N>>>F)*je}else s[b]=s[b+1]=s[b+2]=0;k-=de,le-=pe,j-=Ae,y-=Ne,de-=g.r,pe-=g.g,Ae-=g.b,Ne-=g.a;var ke=ve+i+1;ke=C+(ke<l?ke:l)<<2,q+=g.r=s[ke],M+=g.g=s[ke+1],Y+=g.b=s[ke+2],K+=g.a=s[ke+3],k+=q,le+=M,j+=Y,y+=K,g=g.next;var tt=v,ze=tt.r,Se=tt.g,Ot=tt.b,cr=tt.a;de+=ze,pe+=Se,Ae+=Ot,Ne+=cr,q-=ze,M-=Se,Y-=Ot,K-=cr,v=v.next,b+=4}C+=n}for(var Zt=0;Zt<n;Zt++){b=Zt<<2;var zt=s[b],nr=s[b+1],gr=s[b+2],ht=s[b+3],Rr=c*zt,se=c*nr,oe=c*gr,Te=c*ht,qe=m*zt,xe=m*nr,Oe=m*gr,Be=m*ht;f=h;for(var Je=0;Je<c;Je++)f.r=zt,f.g=nr,f.b=gr,f.a=ht,f=f.next;for(var mt=n,kt=0,rt=0,Jt=0,ut=0,nn=1;nn<=i;nn++){b=mt+Zt<<2;var fi=c-nn;qe+=(f.r=zt=s[b])*fi,xe+=(f.g=nr=s[b+1])*fi,Oe+=(f.b=gr=s[b+2])*fi,Be+=(f.a=ht=s[b+3])*fi,ut+=zt,kt+=nr,rt+=gr,Jt+=ht,f=f.next,nn<u&&(mt+=n)}b=Zt,g=h,v=x;for(var so=0;so<a;so++){var vr=b<<2;s[vr+3]=ht=Be*N>>>F,ht>0?(ht=255/ht,s[vr]=(qe*N>>>F)*ht,s[vr+1]=(xe*N>>>F)*ht,s[vr+2]=(Oe*N>>>F)*ht):s[vr]=s[vr+1]=s[vr+2]=0,qe-=Rr,xe-=se,Oe-=oe,Be-=Te,Rr-=g.r,se-=g.g,oe-=g.b,Te-=g.a,vr=Zt+((vr=so+c)<u?vr:u)*n<<2,qe+=ut+=g.r=s[vr],xe+=kt+=g.g=s[vr+1],Oe+=rt+=g.b=s[vr+2],Be+=Jt+=g.a=s[vr+3],g=g.next,Rr+=zt=v.r,se+=nr=v.g,oe+=gr=v.b,Te+=ht=v.a,ut-=zt,kt-=nr,rt-=gr,Jt-=ht,v=v.next,b+=n}}return e}var bE=function e(){NQ(this,e),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function SQ(){var{DOMParser:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:e,createCanvas(r,n){return new OffscreenCanvas(r,n)},createImage(r){return Ea(function*(){var n=yield fetch(r),a=yield n.blob(),i=yield createImageBitmap(a);return i})()}};return(typeof DOMParser!="undefined"||typeof e=="undefined")&&Reflect.deleteProperty(t,"DOMParser"),t}function TQ(e){var{DOMParser:t,canvas:r,fetch:n}=e;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:t,fetch:n,createCanvas:r.createCanvas,createImage:r.loadImage}}var DQ=Object.freeze({__proto__:null,offscreen:SQ,node:TQ});function is(e){return e.replace(/(?!\u3000)\s+/gm," ")}function l4(e){return e.replace(/^[\n \t]+/,"")}function u4(e){return e.replace(/[\n \t]+$/,"")}function Mr(e){var t=(e||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return t.map(parseFloat)}var AQ=/^[A-Z-]+$/;function c4(e){return AQ.test(e)?e.toLowerCase():e}function u1(e){var t=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(e)||[];return t[2]||t[3]||t[4]}function m4(e){if(!e.startsWith("rgb"))return e;var t=3,r=e.replace(/\d+(\.\d+)?/g,(n,a)=>t--&&a?String(Math.round(parseFloat(n))):n);return r}var kQ=/(\[[^\]]+\])/g,FQ=/(#[^\s+>~.[:]+)/g,UQ=/(\.[^\s+>~.[:]+)/g,RQ=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,OQ=/(:[\w-]+\([^)]*\))/gi,VQ=/(:[^\s+>~.[:]+)/g,PQ=/([^\s+>~.[:]+)/g;function gi(e,t){var r=t.exec(e);return r?[e.replace(t," "),r.length]:[e,0]}function d4(e){var t=[0,0,0],r=e.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),n=0;return[r,n]=gi(r,kQ),t[1]+=n,[r,n]=gi(r,FQ),t[0]+=n,[r,n]=gi(r,UQ),t[1]+=n,[r,n]=gi(r,RQ),t[2]+=n,[r,n]=gi(r,OQ),t[1]+=n,[r,n]=gi(r,VQ),t[1]+=n,r=r.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[r,n]=gi(r,PQ),t[2]+=n,t.join("")}var Pi=1e-8;function ix(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))}function Nc(e,t){return(e[0]*t[0]+e[1]*t[1])/(ix(e)*ix(t))}function sx(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(Nc(e,t))}function ox(e){return e*e*e}function lx(e){return 3*e*e*(1-e)}function ux(e){return 3*e*(1-e)*(1-e)}function cx(e){return(1-e)*(1-e)*(1-e)}function mx(e){return e*e}function dx(e){return 2*e*(1-e)}function fx(e){return(1-e)*(1-e)}class Me{constructor(t,r,n){this.document=t,this.name=r,this.value=n,this.isNormalizedColor=!1}static empty(t){return new Me(t,"EMPTY","")}split(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ",{document:r,name:n}=this;return is(this.getString()).trim().split(t).map(a=>new Me(r,n,a))}hasValue(t){var{value:r}=this;return r!==null&&r!==""&&(t||r!==0)&&typeof r!="undefined"}isString(t){var{value:r}=this,n=typeof r=="string";return!n||!t?n:t.test(r)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return typeof t=="undefined"||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return typeof t=="undefined"?0:parseFloat(t);var{value:r}=this,n=parseFloat(r);return this.isString(/%$/)&&(n/=100),n}getString(t){return typeof t=="undefined"||this.hasValue()?typeof this.value=="undefined"?"":String(this.value):String(t)}getColor(t){var r=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,r=m4(r),this.value=r),r}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;var[n,a]=typeof t=="boolean"?[void 0,t]:[t],{viewPort:i}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(i.computeSize("x"),i.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(i.computeSize("x"),i.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*i.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*i.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&a):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*i.computeSize(n);default:{var s=this.getNumber();return r&&s<1?s*i.computeSize(n):s}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var t=this.getString(),r=/#([^)'"]+)/.exec(t);return r&&(r=r[1]),r||(r=t),this.document.definitions[r]}getFillStyleDefinition(t,r){var n=this.getDefinition();if(!n)return null;if(typeof n.createGradient=="function")return n.createGradient(this.document.ctx,t,r);if(typeof n.createPattern=="function"){if(n.getHrefAttribute().hasValue()){var a=n.getAttribute("patternTransform");n=n.getHrefAttribute().getDefinition(),a.hasValue()&&n.getAttribute("patternTransform",!0).setValue(a.value)}return n.createPattern(this.document.ctx,t,r)}return null}getTextBaseline(){return this.hasValue()?Me.textBaselineMapping[this.getString()]:null}addOpacity(t){for(var r=this.getColor(),n=r.length,a=0,i=0;i<n&&(r[i]===","&&a++,a!==3);i++);if(t.hasValue()&&this.isString()&&a!==3){var s=new nx(r);s.ok&&(s.alpha=t.getNumber(),r=s.toRGBA())}return new Me(this.document,this.name,r)}}Me.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class f4{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(t,r){this.viewPorts.push({width:t,height:r})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:t}=this;return t[t.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return typeof t=="number"?t:t==="x"?this.width:t==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}}class Bt{constructor(t,r){this.x=t,this.y=r}static parse(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,[n=r,a=r]=Mr(t);return new Bt(n,a)}static parseScale(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,[n=r,a=n]=Mr(t);return new Bt(n,a)}static parsePath(t){for(var r=Mr(t),n=r.length,a=[],i=0;i<n;i+=2)a.push(new Bt(r[i],r[i+1]));return a}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){var{x:r,y:n}=this,a=r*t[0]+n*t[2]+t[4],i=r*t[1]+n*t[3]+t[5];this.x=a,this.y=i}}class h4{constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:t,onClick:r,onMouseMove:n}=this,a=t.ctx.canvas;a.onclick=r,a.onmousemove=n,this.working=!0}}stop(){if(this.working){var t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:t,events:r,eventElements:n}=this,{style:a}=t.ctx.canvas;a&&(a.cursor=""),r.forEach((i,s)=>{for(var{run:o}=i,l=n[s];l;)o(l),l=l.parent}),this.events=[],this.eventElements=[]}}checkPath(t,r){if(!(!this.working||!r)){var{events:n,eventElements:a}=this;n.forEach((i,s)=>{var{x:o,y:l}=i;!a[s]&&r.isPointInPath&&r.isPointInPath(o,l)&&(a[s]=t)})}}checkBoundingBox(t,r){if(!(!this.working||!r)){var{events:n,eventElements:a}=this;n.forEach((i,s)=>{var{x:o,y:l}=i;!a[s]&&r.isPointInBox(o,l)&&(a[s]=t)})}}mapXY(t,r){for(var{window:n,ctx:a}=this.screen,i=new Bt(t,r),s=a.canvas;s;)i.x-=s.offsetLeft,i.y-=s.offsetTop,s=s.offsetParent;return n.scrollX&&(i.x+=n.scrollX),n.scrollY&&(i.y+=n.scrollY),i}onClick(t){var{x:r,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:r,y:n,run(a){a.onClick&&a.onClick()}})}onMouseMove(t){var{x:r,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:r,y:n,run(a){a.onMouseMove&&a.onMouseMove()}})}}var p4=typeof window!="undefined"?window:null,x4=typeof fetch!="undefined"?fetch.bind(void 0):null;class Ll{constructor(t){var{fetch:r=x4,window:n=p4}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.ctx=t,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new f4,this.mouse=new h4(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=n,this.fetch=r}wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var t=this.waits.every(r=>r());return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){var{document:r,ctx:n,aspectRatio:a,width:i,desiredWidth:s,height:o,desiredHeight:l,minX:u=0,minY:c=0,refX:m,refY:h,clip:f=!1,clipX:x=0,clipY:p=0}=t,g=is(a).replace(/^defer\s/,""),[v,C]=g.split(" "),b=v||"xMidYMid",N=C||"meet",F=i/s,E=o/l,w=Math.min(F,E),S=Math.max(F,E),_=s,U=l;N==="meet"&&(_*=w,U*=w),N==="slice"&&(_*=S,U*=S);var R=new Me(r,"refX",m),q=new Me(r,"refY",h),M=R.hasValue()&&q.hasValue();if(M&&n.translate(-w*R.getPixels("x"),-w*q.getPixels("y")),f){var Y=w*x,K=w*p;n.beginPath(),n.moveTo(Y,K),n.lineTo(i,K),n.lineTo(i,o),n.lineTo(Y,o),n.closePath(),n.clip()}if(!M){var de=N==="meet"&&w===E,pe=N==="slice"&&S===E,Ae=N==="meet"&&w===F,Ne=N==="slice"&&S===F;b.startsWith("xMid")&&(de||pe)&&n.translate(i/2-_/2,0),b.endsWith("YMid")&&(Ae||Ne)&&n.translate(0,o/2-U/2),b.startsWith("xMax")&&(de||pe)&&n.translate(i-_,0),b.endsWith("YMax")&&(Ae||Ne)&&n.translate(0,o-U)}switch(!0){case b==="none":n.scale(F,E);break;case N==="meet":n.scale(w,w);break;case N==="slice":n.scale(S,S);break}n.translate(-u,-c)}start(t){var{enableRedraw:r=!1,ignoreMouse:n=!1,ignoreAnimation:a=!1,ignoreDimensions:i=!1,ignoreClear:s=!1,forceRedraw:o,scaleWidth:l,scaleHeight:u,offsetX:c,offsetY:m}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{FRAMERATE:h,mouse:f}=this,x=1e3/h;if(this.frameDuration=x,this.readyPromise=new Promise(b=>{this.resolveReady=b}),this.isReady()&&this.render(t,i,s,l,u,c,m),!!r){var p=Date.now(),g=p,v=0,C=()=>{p=Date.now(),v=p-g,v>=x&&(g=p-v%x,this.shouldUpdate(a,o)&&(this.render(t,i,s,l,u,c,m),f.runEvents())),this.intervalId=ap(C)};n||f.start(),this.intervalId=ap(C)}}stop(){this.intervalId&&(ap.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,r){if(!t){var{frameDuration:n}=this,a=this.animations.reduce((i,s)=>s.update(n)||i,!1);if(a)return!0}return!!(typeof r=="function"&&r()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(t,r,n,a,i,s,o){var{CLIENT_WIDTH:l,CLIENT_HEIGHT:u,viewPort:c,ctx:m,isFirstRender:h}=this,f=m.canvas;c.clear(),f.width&&f.height?c.setCurrent(f.width,f.height):c.setCurrent(l,u);var x=t.getStyle("width"),p=t.getStyle("height");!r&&(h||typeof a!="number"&&typeof i!="number")&&(x.hasValue()&&(f.width=x.getPixels("x"),f.style&&(f.style.width="".concat(f.width,"px"))),p.hasValue()&&(f.height=p.getPixels("y"),f.style&&(f.style.height="".concat(f.height,"px"))));var g=f.clientWidth||f.width,v=f.clientHeight||f.height;if(r&&x.hasValue()&&p.hasValue()&&(g=x.getPixels("x"),v=p.getPixels("y")),c.setCurrent(g,v),typeof s=="number"&&t.getAttribute("x",!0).setValue(s),typeof o=="number"&&t.getAttribute("y",!0).setValue(o),typeof a=="number"||typeof i=="number"){var C=Mr(t.getAttribute("viewBox").getString()),b=0,N=0;if(typeof a=="number"){var F=t.getStyle("width");F.hasValue()?b=F.getPixels("x")/a:isNaN(C[2])||(b=C[2]/a)}if(typeof i=="number"){var E=t.getStyle("height");E.hasValue()?N=E.getPixels("y")/i:isNaN(C[3])||(N=C[3]/i)}b||(b=N),N||(N=b),t.getAttribute("width",!0).setValue(a),t.getAttribute("height",!0).setValue(i);var w=t.getStyle("transform",!0,!0);w.setValue("".concat(w.getString()," scale(").concat(1/b,", ").concat(1/N,")"))}n||m.clearRect(0,0,g,v),t.render(m),h&&(this.isFirstRender=!1)}}Ll.defaultWindow=p4;Ll.defaultFetch=x4;var{defaultFetch:IQ}=Ll,MQ=typeof DOMParser!="undefined"?DOMParser:null;class Ru{constructor(){var{fetch:t=IQ,DOMParser:r=MQ}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fetch=t,this.DOMParser=r}parse(t){var r=this;return Ea(function*(){return t.startsWith("<")?r.parseFromString(t):r.load(t)})()}parseFromString(t){var r=new this.DOMParser;try{return this.checkDocument(r.parseFromString(t,"image/svg+xml"))}catch(n){return this.checkDocument(r.parseFromString(t,"text/xml"))}}checkDocument(t){var r=t.getElementsByTagName("parsererror")[0];if(r)throw new Error(r.textContent);return t}load(t){var r=this;return Ea(function*(){var n=yield r.fetch(t),a=yield n.text();return r.parseFromString(a)})()}}class g4{constructor(t,r){this.type="translate",this.point=null,this.point=Bt.parse(r)}apply(t){var{x:r,y:n}=this.point;t.translate(r||0,n||0)}unapply(t){var{x:r,y:n}=this.point;t.translate(-1*r||0,-1*n||0)}applyToPoint(t){var{x:r,y:n}=this.point;t.applyTransform([1,0,0,1,r||0,n||0])}}class v4{constructor(t,r,n){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var a=Mr(r);this.angle=new Me(t,"angle",a[0]),this.originX=n[0],this.originY=n[1],this.cx=a[1]||0,this.cy=a[2]||0}apply(t){var{cx:r,cy:n,originX:a,originY:i,angle:s}=this,o=r+a.getPixels("x"),l=n+i.getPixels("y");t.translate(o,l),t.rotate(s.getRadians()),t.translate(-o,-l)}unapply(t){var{cx:r,cy:n,originX:a,originY:i,angle:s}=this,o=r+a.getPixels("x"),l=n+i.getPixels("y");t.translate(o,l),t.rotate(-1*s.getRadians()),t.translate(-o,-l)}applyToPoint(t){var{cx:r,cy:n,angle:a}=this,i=a.getRadians();t.applyTransform([1,0,0,1,r||0,n||0]),t.applyTransform([Math.cos(i),Math.sin(i),-Math.sin(i),Math.cos(i),0,0]),t.applyTransform([1,0,0,1,-r||0,-n||0])}}class b4{constructor(t,r,n){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var a=Bt.parseScale(r);(a.x===0||a.y===0)&&(a.x=Pi,a.y=Pi),this.scale=a,this.originX=n[0],this.originY=n[1]}apply(t){var{scale:{x:r,y:n},originX:a,originY:i}=this,s=a.getPixels("x"),o=i.getPixels("y");t.translate(s,o),t.scale(r,n||r),t.translate(-s,-o)}unapply(t){var{scale:{x:r,y:n},originX:a,originY:i}=this,s=a.getPixels("x"),o=i.getPixels("y");t.translate(s,o),t.scale(1/r,1/n||r),t.translate(-s,-o)}applyToPoint(t){var{x:r,y:n}=this.scale;t.applyTransform([r||0,0,0,n||0,0,0])}}class c1{constructor(t,r,n){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=Mr(r),this.originX=n[0],this.originY=n[1]}apply(t){var{originX:r,originY:n,matrix:a}=this,i=r.getPixels("x"),s=n.getPixels("y");t.translate(i,s),t.transform(a[0],a[1],a[2],a[3],a[4],a[5]),t.translate(-i,-s)}unapply(t){var{originX:r,originY:n,matrix:a}=this,i=a[0],s=a[2],o=a[4],l=a[1],u=a[3],c=a[5],m=0,h=0,f=1,x=1/(i*(u*f-c*h)-s*(l*f-c*m)+o*(l*h-u*m)),p=r.getPixels("x"),g=n.getPixels("y");t.translate(p,g),t.transform(x*(u*f-c*h),x*(c*m-l*f),x*(o*h-s*f),x*(i*f-o*m),x*(s*c-o*u),x*(o*l-i*c)),t.translate(-p,-g)}applyToPoint(t){t.applyTransform(this.matrix)}}class m1 extends c1{constructor(t,r,n){super(t,r,n),this.type="skew",this.angle=null,this.angle=new Me(t,"angle",r)}}class N4 extends m1{constructor(t,r,n){super(t,r,n),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}}class y4 extends m1{constructor(t,r,n){super(t,r,n),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}function jQ(e){return is(e).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function LQ(e){var[t,r]=e.split("(");return[t.trim(),r.trim().replace(")","")]}class ni{constructor(t,r,n){this.document=t,this.transforms=[];var a=jQ(r);a.forEach(i=>{if(i!=="none"){var[s,o]=LQ(i),l=ni.transformTypes[s];typeof l!="undefined"&&this.transforms.push(new l(this.document,o,n))}})}static fromElement(t,r){var n=r.getStyle("transform",!1,!0),[a,i=a]=r.getStyle("transform-origin",!1,!0).split(),s=[a,i];return n.hasValue()?new ni(t,n.getString(),s):null}apply(t){for(var{transforms:r}=this,n=r.length,a=0;a<n;a++)r[a].apply(t)}unapply(t){for(var{transforms:r}=this,n=r.length,a=n-1;a>=0;a--)r[a].unapply(t)}applyToPoint(t){for(var{transforms:r}=this,n=r.length,a=0;a<n;a++)r[a].applyToPoint(t)}}ni.transformTypes={translate:g4,rotate:v4,scale:b4,matrix:c1,skewX:N4,skewY:y4};let Mt=class hx{constructor(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.document=t,this.node=r,this.captureTextNodes=n,this.attributes=Object.create(null),this.styles=Object.create(null),this.stylesSpecificity=Object.create(null),this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!(!r||r.nodeType!==1)){if(Array.from(r.attributes).forEach(o=>{var l=c4(o.nodeName);this.attributes[l]=new Me(t,l,o.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var a=this.getAttribute("style").getString().split(";").map(o=>o.trim());a.forEach(o=>{if(o){var[l,u]=o.split(":").map(c=>c.trim());this.styles[l]=new Me(t,l,u)}})}var{definitions:i}=t,s=this.getAttribute("id");s.hasValue()&&(i[s.getString()]||(i[s.getString()]=this)),Array.from(r.childNodes).forEach(o=>{if(o.nodeType===1)this.addChild(o);else if(n&&(o.nodeType===3||o.nodeType===4)){var l=t.createTextNode(o);l.getText().length>0&&this.addChild(l)}})}}getAttribute(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.attributes[t];if(!n&&r){var a=new Me(this.document,t,"");return this.attributes[t]=a,a}return n||Me.empty(this.document)}getHrefAttribute(){for(var t in this.attributes)if(t==="href"||t.endsWith(":href"))return this.attributes[t];return Me.empty(this.document)}getStyle(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.styles[t];if(a)return a;var i=this.getAttribute(t);if(i!=null&&i.hasValue())return this.styles[t]=i,i;if(!n){var{parent:s}=this;if(s){var o=s.getStyle(t);if(o!=null&&o.hasValue())return o}}if(r){var l=new Me(this.document,t,"");return this.styles[t]=l,l}return a||Me.empty(this.document)}render(t){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(t.save(),this.getStyle("mask").hasValue()){var r=this.getStyle("mask").getDefinition();r&&(this.applyEffects(t),r.apply(t,this))}else if(this.getStyle("filter").getValue("none")!=="none"){var n=this.getStyle("filter").getDefinition();n&&(this.applyEffects(t),n.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){var r=ni.fromElement(this.document,this);r&&r.apply(t);var n=this.getStyle("clip-path",!1,!0);if(n.hasValue()){var a=n.getDefinition();a&&a.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach(r=>{r.render(t)})}addChild(t){var r=t instanceof hx?t:this.document.createElement(t);r.parent=this,hx.ignoreChildTypes.includes(r.type)||this.children.push(r)}matchesSelector(t){var r,{node:n}=this;if(typeof n.matches=="function")return n.matches(t);var a=(r=n.getAttribute)===null||r===void 0?void 0:r.call(n,"class");return!a||a===""?!1:a.split(" ").some(i=>".".concat(i)===t)}addStylesFromStyleDefinition(){var{styles:t,stylesSpecificity:r}=this.document;for(var n in t)if(!n.startsWith("@")&&this.matchesSelector(n)){var a=t[n],i=r[n];if(a)for(var s in a){var o=this.stylesSpecificity[s];typeof o=="undefined"&&(o="000"),i>=o&&(this.styles[s]=a[s],this.stylesSpecificity[s]=i)}}}removeStyles(t,r){var n=r.reduce((a,i)=>{var s=t.getStyle(i);if(!s.hasValue())return a;var o=s.getString();return s.setValue(""),[...a,[i,o]]},[]);return n}restoreStyles(t,r){r.forEach(n=>{var[a,i]=n;t.getStyle(a,!0).setValue(i)})}isFirstChild(){var t;return((t=this.parent)===null||t===void 0?void 0:t.children.indexOf(this))===0}};Mt.ignoreChildTypes=["title"];class C4 extends Mt{constructor(t,r,n){super(t,r,n)}}function BQ(e){var t=e.trim();return/^('|")/.test(t)?t:'"'.concat(t,'"')}function qQ(e){return typeof process=="undefined"?e:e.trim().split(",").map(BQ).join(",")}function zQ(e){if(!e)return"";var t=e.trim().toLowerCase();switch(t){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return t;default:return/^oblique\s+(-|)\d+deg$/.test(t)?t:""}}function HQ(e){if(!e)return"";var t=e.trim().toLowerCase();switch(t){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return t;default:return/^[\d.]+$/.test(t)?t:""}}class Cr{constructor(t,r,n,a,i,s){var o=s?typeof s=="string"?Cr.parse(s):s:{};this.fontFamily=i||o.fontFamily,this.fontSize=a||o.fontSize,this.fontStyle=t||o.fontStyle,this.fontWeight=n||o.fontWeight,this.fontVariant=r||o.fontVariant}static parse(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0,n="",a="",i="",s="",o="",l=is(t).trim().split(" "),u={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return l.forEach(c=>{switch(!0){case(!u.fontStyle&&Cr.styles.includes(c)):c!=="inherit"&&(n=c),u.fontStyle=!0;break;case(!u.fontVariant&&Cr.variants.includes(c)):c!=="inherit"&&(a=c),u.fontStyle=!0,u.fontVariant=!0;break;case(!u.fontWeight&&Cr.weights.includes(c)):c!=="inherit"&&(i=c),u.fontStyle=!0,u.fontVariant=!0,u.fontWeight=!0;break;case!u.fontSize:c!=="inherit"&&([s]=c.split("/")),u.fontStyle=!0,u.fontVariant=!0,u.fontWeight=!0,u.fontSize=!0;break;default:c!=="inherit"&&(o+=c)}}),new Cr(n,a,i,s,o,r)}toString(){return[zQ(this.fontStyle),this.fontVariant,HQ(this.fontWeight),this.fontSize,qQ(this.fontFamily)].join(" ").trim()}}Cr.styles="normal|italic|oblique|inherit";Cr.variants="normal|small-caps|inherit";Cr.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class vn{constructor(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.NaN,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.NaN,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Number.NaN,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Number.NaN;this.x1=t,this.y1=r,this.x2=n,this.y2=a,this.addPoint(t,r),this.addPoint(n,a)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,r){typeof t!="undefined"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),typeof r!="undefined"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=r,this.y2=r),r<this.y1&&(this.y1=r),r>this.y2&&(this.y2=r))}addX(t){this.addPoint(t,null)}addY(t){this.addPoint(null,t)}addBoundingBox(t){if(t){var{x1:r,y1:n,x2:a,y2:i}=t;this.addPoint(r,n),this.addPoint(a,i)}}sumCubic(t,r,n,a,i){return Math.pow(1-t,3)*r+3*Math.pow(1-t,2)*t*n+3*(1-t)*Math.pow(t,2)*a+Math.pow(t,3)*i}bezierCurveAdd(t,r,n,a,i){var s=6*r-12*n+6*a,o=-3*r+9*n-9*a+3*i,l=3*n-3*r;if(o===0){if(s===0)return;var u=-l/s;0<u&&u<1&&(t?this.addX(this.sumCubic(u,r,n,a,i)):this.addY(this.sumCubic(u,r,n,a,i)));return}var c=Math.pow(s,2)-4*l*o;if(!(c<0)){var m=(-s+Math.sqrt(c))/(2*o);0<m&&m<1&&(t?this.addX(this.sumCubic(m,r,n,a,i)):this.addY(this.sumCubic(m,r,n,a,i)));var h=(-s-Math.sqrt(c))/(2*o);0<h&&h<1&&(t?this.addX(this.sumCubic(h,r,n,a,i)):this.addY(this.sumCubic(h,r,n,a,i)))}}addBezierCurve(t,r,n,a,i,s,o,l){this.addPoint(t,r),this.addPoint(o,l),this.bezierCurveAdd(!0,t,n,i,o),this.bezierCurveAdd(!1,r,a,s,l)}addQuadraticCurve(t,r,n,a,i,s){var o=t+.6666666666666666*(n-t),l=r+2/3*(a-r),u=o+1/3*(i-t),c=l+1/3*(s-r);this.addBezierCurve(t,r,o,u,l,c,i,s)}isPointInBox(t,r){var{x1:n,y1:a,x2:i,y2:s}=this;return n<=t&&t<=i&&a<=r&&r<=s}}class Ge extends ge{constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new Bt(0,0),this.control=new Bt(0,0),this.current=new Bt(0,0),this.points=[],this.angles=[]}isEnd(){var{i:t,commands:r}=this;return t>=r.length-1}next(){var t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y",n=new Bt(this.command[t],this.command[r]);return this.makeAbsolute(n)}getAsControlPoint(t,r){var n=this.getPoint(t,r);return this.control=n,n}getAsCurrentPoint(t,r){var n=this.getPoint(t,r);return this.current=n,n}getReflectedControlPoint(){var t=this.previousCommand.type;if(t!==ge.CURVE_TO&&t!==ge.SMOOTH_CURVE_TO&&t!==ge.QUAD_TO&&t!==ge.SMOOTH_QUAD_TO)return this.current;var{current:{x:r,y:n},control:{x:a,y:i}}=this,s=new Bt(2*r-a,2*n-i);return s}makeAbsolute(t){if(this.command.relative){var{x:r,y:n}=this.current;t.x+=r,t.y+=n}return t}addMarker(t,r,n){var{points:a,angles:i}=this;n&&i.length>0&&!i[i.length-1]&&(i[i.length-1]=a[a.length-1].angleTo(n)),this.addMarkerAngle(t,r?r.angleTo(t):null)}addMarkerAngle(t,r){this.points.push(t),this.angles.push(r)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:t}=this,r=t.length,n=0;n<r;n++)if(!t[n]){for(var a=n+1;a<r;a++)if(t[a]){t[n]=t[a];break}}return t}}class di extends Mt{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var t=1,r=this;r;){var n=r.getStyle("opacity",!1,!0);n.hasValue(!0)&&(t*=n.getNumber()),r=r.parent}return t}setContext(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r){var n=this.getStyle("fill"),a=this.getStyle("fill-opacity"),i=this.getStyle("stroke"),s=this.getStyle("stroke-opacity");if(n.isUrlDefinition()){var o=n.getFillStyleDefinition(this,a);o&&(t.fillStyle=o)}else if(n.hasValue()){n.getString()==="currentColor"&&n.setValue(this.getStyle("color").getColor());var l=n.getColor();l!=="inherit"&&(t.fillStyle=l==="none"?"rgba(0,0,0,0)":l)}if(a.hasValue()){var u=new Me(this.document,"fill",t.fillStyle).addOpacity(a).getColor();t.fillStyle=u}if(i.isUrlDefinition()){var c=i.getFillStyleDefinition(this,s);c&&(t.strokeStyle=c)}else if(i.hasValue()){i.getString()==="currentColor"&&i.setValue(this.getStyle("color").getColor());var m=i.getString();m!=="inherit"&&(t.strokeStyle=m==="none"?"rgba(0,0,0,0)":m)}if(s.hasValue()){var h=new Me(this.document,"stroke",t.strokeStyle).addOpacity(s).getString();t.strokeStyle=h}var f=this.getStyle("stroke-width");if(f.hasValue()){var x=f.getPixels();t.lineWidth=x||Pi}var p=this.getStyle("stroke-linecap"),g=this.getStyle("stroke-linejoin"),v=this.getStyle("stroke-miterlimit"),C=this.getStyle("stroke-dasharray"),b=this.getStyle("stroke-dashoffset");if(p.hasValue()&&(t.lineCap=p.getString()),g.hasValue()&&(t.lineJoin=g.getString()),v.hasValue()&&(t.miterLimit=v.getNumber()),C.hasValue()&&C.getString()!=="none"){var N=Mr(C.getString());typeof t.setLineDash!="undefined"?t.setLineDash(N):typeof t.webkitLineDash!="undefined"?t.webkitLineDash=N:typeof t.mozDash!="undefined"&&!(N.length===1&&N[0]===0)&&(t.mozDash=N);var F=b.getPixels();typeof t.lineDashOffset!="undefined"?t.lineDashOffset=F:typeof t.webkitLineDashOffset!="undefined"?t.webkitLineDashOffset=F:typeof t.mozDashOffset!="undefined"&&(t.mozDashOffset=F)}}if(this.modifiedEmSizeStack=!1,typeof t.font!="undefined"){var E=this.getStyle("font"),w=this.getStyle("font-style"),S=this.getStyle("font-variant"),_=this.getStyle("font-weight"),U=this.getStyle("font-size"),R=this.getStyle("font-family"),q=new Cr(w.getString(),S.getString(),_.getString(),U.hasValue()?"".concat(U.getPixels(!0),"px"):"",R.getString(),Cr.parse(E.getString(),t.font));w.setValue(q.fontStyle),S.setValue(q.fontVariant),_.setValue(q.fontWeight),U.setValue(q.fontSize),R.setValue(q.fontFamily),t.font=q.toString(),U.isPixels()&&(this.document.emSize=U.getPixels(),this.modifiedEmSizeStack=!0)}r||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}}class dt extends di{constructor(t,r,n){super(t,r,n),this.type="path",this.pathParser=null,this.pathParser=new Ge(this.getAttribute("d").getString())}path(t){var{pathParser:r}=this,n=new vn;for(r.reset(),t&&t.beginPath();!r.isEnd();)switch(r.next().type){case Ge.MOVE_TO:this.pathM(t,n);break;case Ge.LINE_TO:this.pathL(t,n);break;case Ge.HORIZ_LINE_TO:this.pathH(t,n);break;case Ge.VERT_LINE_TO:this.pathV(t,n);break;case Ge.CURVE_TO:this.pathC(t,n);break;case Ge.SMOOTH_CURVE_TO:this.pathS(t,n);break;case Ge.QUAD_TO:this.pathQ(t,n);break;case Ge.SMOOTH_QUAD_TO:this.pathT(t,n);break;case Ge.ARC:this.pathA(t,n);break;case Ge.CLOSE_PATH:this.pathZ(t,n);break}return n}getBoundingBox(t){return this.path()}getMarkers(){var{pathParser:t}=this,r=t.getMarkerPoints(),n=t.getMarkerAngles(),a=r.map((i,s)=>[i,n[s]]);return a}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);var r=this.getStyle("fill-rule");t.fillStyle!==""&&(r.getString("inherit")!=="inherit"?t.fill(r.getString()):t.fill()),t.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());var n=this.getMarkers();if(n){var a=n.length-1,i=this.getStyle("marker-start"),s=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(i.isUrlDefinition()){var l=i.getDefinition(),[u,c]=n[0];l.render(t,u,c)}if(s.isUrlDefinition())for(var m=s.getDefinition(),h=1;h<a;h++){var[f,x]=n[h];m.render(t,f,x)}if(o.isUrlDefinition()){var p=o.getDefinition(),[g,v]=n[a];p.render(t,g,v)}}}static pathM(t){var r=t.getAsCurrentPoint();return t.start=t.current,{point:r}}pathM(t,r){var{pathParser:n}=this,{point:a}=dt.pathM(n),{x:i,y:s}=a;n.addMarker(a),r.addPoint(i,s),t&&t.moveTo(i,s)}static pathL(t){var{current:r}=t,n=t.getAsCurrentPoint();return{current:r,point:n}}pathL(t,r){var{pathParser:n}=this,{current:a,point:i}=dt.pathL(n),{x:s,y:o}=i;n.addMarker(i,a),r.addPoint(s,o),t&&t.lineTo(s,o)}static pathH(t){var{current:r,command:n}=t,a=new Bt((n.relative?r.x:0)+n.x,r.y);return t.current=a,{current:r,point:a}}pathH(t,r){var{pathParser:n}=this,{current:a,point:i}=dt.pathH(n),{x:s,y:o}=i;n.addMarker(i,a),r.addPoint(s,o),t&&t.lineTo(s,o)}static pathV(t){var{current:r,command:n}=t,a=new Bt(r.x,(n.relative?r.y:0)+n.y);return t.current=a,{current:r,point:a}}pathV(t,r){var{pathParser:n}=this,{current:a,point:i}=dt.pathV(n),{x:s,y:o}=i;n.addMarker(i,a),r.addPoint(s,o),t&&t.lineTo(s,o)}static pathC(t){var{current:r}=t,n=t.getPoint("x1","y1"),a=t.getAsControlPoint("x2","y2"),i=t.getAsCurrentPoint();return{current:r,point:n,controlPoint:a,currentPoint:i}}pathC(t,r){var{pathParser:n}=this,{current:a,point:i,controlPoint:s,currentPoint:o}=dt.pathC(n);n.addMarker(o,s,i),r.addBezierCurve(a.x,a.y,i.x,i.y,s.x,s.y,o.x,o.y),t&&t.bezierCurveTo(i.x,i.y,s.x,s.y,o.x,o.y)}static pathS(t){var{current:r}=t,n=t.getReflectedControlPoint(),a=t.getAsControlPoint("x2","y2"),i=t.getAsCurrentPoint();return{current:r,point:n,controlPoint:a,currentPoint:i}}pathS(t,r){var{pathParser:n}=this,{current:a,point:i,controlPoint:s,currentPoint:o}=dt.pathS(n);n.addMarker(o,s,i),r.addBezierCurve(a.x,a.y,i.x,i.y,s.x,s.y,o.x,o.y),t&&t.bezierCurveTo(i.x,i.y,s.x,s.y,o.x,o.y)}static pathQ(t){var{current:r}=t,n=t.getAsControlPoint("x1","y1"),a=t.getAsCurrentPoint();return{current:r,controlPoint:n,currentPoint:a}}pathQ(t,r){var{pathParser:n}=this,{current:a,controlPoint:i,currentPoint:s}=dt.pathQ(n);n.addMarker(s,i,i),r.addQuadraticCurve(a.x,a.y,i.x,i.y,s.x,s.y),t&&t.quadraticCurveTo(i.x,i.y,s.x,s.y)}static pathT(t){var{current:r}=t,n=t.getReflectedControlPoint();t.control=n;var a=t.getAsCurrentPoint();return{current:r,controlPoint:n,currentPoint:a}}pathT(t,r){var{pathParser:n}=this,{current:a,controlPoint:i,currentPoint:s}=dt.pathT(n);n.addMarker(s,i,i),r.addQuadraticCurve(a.x,a.y,i.x,i.y,s.x,s.y),t&&t.quadraticCurveTo(i.x,i.y,s.x,s.y)}static pathA(t){var{current:r,command:n}=t,{rX:a,rY:i,xRot:s,lArcFlag:o,sweepFlag:l}=n,u=s*(Math.PI/180),c=t.getAsCurrentPoint(),m=new Bt(Math.cos(u)*(r.x-c.x)/2+Math.sin(u)*(r.y-c.y)/2,-Math.sin(u)*(r.x-c.x)/2+Math.cos(u)*(r.y-c.y)/2),h=Math.pow(m.x,2)/Math.pow(a,2)+Math.pow(m.y,2)/Math.pow(i,2);h>1&&(a*=Math.sqrt(h),i*=Math.sqrt(h));var f=(o===l?-1:1)*Math.sqrt((Math.pow(a,2)*Math.pow(i,2)-Math.pow(a,2)*Math.pow(m.y,2)-Math.pow(i,2)*Math.pow(m.x,2))/(Math.pow(a,2)*Math.pow(m.y,2)+Math.pow(i,2)*Math.pow(m.x,2)));isNaN(f)&&(f=0);var x=new Bt(f*a*m.y/i,f*-i*m.x/a),p=new Bt((r.x+c.x)/2+Math.cos(u)*x.x-Math.sin(u)*x.y,(r.y+c.y)/2+Math.sin(u)*x.x+Math.cos(u)*x.y),g=sx([1,0],[(m.x-x.x)/a,(m.y-x.y)/i]),v=[(m.x-x.x)/a,(m.y-x.y)/i],C=[(-m.x-x.x)/a,(-m.y-x.y)/i],b=sx(v,C);return Nc(v,C)<=-1&&(b=Math.PI),Nc(v,C)>=1&&(b=0),{currentPoint:c,rX:a,rY:i,sweepFlag:l,xAxisRotation:u,centp:p,a1:g,ad:b}}pathA(t,r){var{pathParser:n}=this,{currentPoint:a,rX:i,rY:s,sweepFlag:o,xAxisRotation:l,centp:u,a1:c,ad:m}=dt.pathA(n),h=1-o?1:-1,f=c+h*(m/2),x=new Bt(u.x+i*Math.cos(f),u.y+s*Math.sin(f));if(n.addMarkerAngle(x,f-h*Math.PI/2),n.addMarkerAngle(a,f-h*Math.PI),r.addPoint(a.x,a.y),t&&!isNaN(c)&&!isNaN(m)){var p=i>s?i:s,g=i>s?1:i/s,v=i>s?s/i:1;t.translate(u.x,u.y),t.rotate(l),t.scale(g,v),t.arc(0,0,p,c,c+m,!!(1-o)),t.scale(1/g,1/v),t.rotate(-l),t.translate(-u.x,-u.y)}}static pathZ(t){t.current=t.start}pathZ(t,r){dt.pathZ(this.pathParser),t&&r.x1!==r.x2&&r.y1!==r.y2&&t.closePath()}}class d1 extends dt{constructor(t,r,n){super(t,r,n),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class _a extends di{constructor(t,r,n){super(t,r,new.target===_a?!0:n),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(t,r);var n=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();n&&(t.textBaseline=n)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(t){if(this.type!=="text")return this.getTElementBoundingBox(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t);var r=null;return this.children.forEach((n,a)=>{var i=this.getChildBoundingBox(t,this,this,a);r?r.addBoundingBox(i):r=i}),r}getFontSize(){var{document:t,parent:r}=this,n=Cr.parse(t.ctx.font).fontSize,a=r.getStyle("font-size").getNumber(n);return a}getTElementBoundingBox(t){var r=this.getFontSize();return new vn(this.x,this.y-r,this.x+this.measureText(t),this.y)}getGlyph(t,r,n){var a=r[n],i=null;if(t.isArabic){var s=r.length,o=r[n-1],l=r[n+1],u="isolated";if((n===0||o===" ")&&n<s-1&&l!==" "&&(u="terminal"),n>0&&o!==" "&&n<s-1&&l!==" "&&(u="medial"),n>0&&o!==" "&&(n===s-1||l===" ")&&(u="initial"),typeof t.glyphs[a]!="undefined"){var c=t.glyphs[a];i=c instanceof d1?c:c[u]}}else i=t.glyphs[a];return i||(i=t.missingGlyph),i}getText(){return""}getTextFromNode(t){var r=t||this.node,n=Array.from(r.parentNode.childNodes),a=n.indexOf(r),i=n.length-1,s=is(r.textContent||"");return a===0&&(s=l4(s)),a===i&&(s=u4(s)),s}renderChildren(t){if(this.type!=="text"){this.renderTElementChildren(t);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t),this.children.forEach((n,a)=>{this.renderChild(t,this,this,a)});var{mouse:r}=this.document.screen;r.isWorking()&&r.checkBoundingBox(this,this.getBoundingBox(t))}renderTElementChildren(t){var{document:r,parent:n}=this,a=this.getText(),i=n.getStyle("font-family").getDefinition();if(i){for(var{unitsPerEm:s}=i.fontFace,o=Cr.parse(r.ctx.font),l=n.getStyle("font-size").getNumber(o.fontSize),u=n.getStyle("font-style").getString(o.fontStyle),c=l/s,m=i.isRTL?a.split("").reverse().join(""):a,h=Mr(n.getAttribute("dx").getString()),f=m.length,x=0;x<f;x++){var p=this.getGlyph(i,m,x);t.translate(this.x,this.y),t.scale(c,-c);var g=t.lineWidth;t.lineWidth=t.lineWidth*s/l,u==="italic"&&t.transform(1,0,.4,1,0,0),p.render(t),u==="italic"&&t.transform(1,0,-.4,1,0,0),t.lineWidth=g,t.scale(1/c,-1/c),t.translate(-this.x,-this.y),this.x+=l*(p.horizAdvX||i.horizAdvX)/s,typeof h[x]!="undefined"&&!isNaN(h[x])&&(this.x+=h[x])}return}var{x:v,y:C}=this;t.fillStyle&&t.fillText(a,v,C),t.strokeStyle&&t.strokeText(a,v,C)}applyAnchoring(){if(!(this.textChunkStart>=this.leafTexts.length)){var t=this.leafTexts[this.textChunkStart],r=t.getStyle("text-anchor").getString("start"),n=!1,a=0;r==="start"&&!n||r==="end"&&n?a=t.x-this.minX:r==="end"&&!n||r==="start"&&n?a=t.x-this.maxX:a=t.x-(this.minX+this.maxX)/2;for(var i=this.textChunkStart;i<this.leafTexts.length;i++)this.leafTexts[i].x+=a;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}}adjustChildCoordinatesRecursive(t){this.children.forEach((r,n)=>{this.adjustChildCoordinatesRecursiveCore(t,this,this,n)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(t,r,n,a){var i=n.children[a];i.children.length>0?i.children.forEach((s,o)=>{r.adjustChildCoordinatesRecursiveCore(t,r,i,o)}):this.adjustChildCoordinates(t,r,n,a)}adjustChildCoordinates(t,r,n,a){var i=n.children[a];if(typeof i.measureText!="function")return i;t.save(),i.setContext(t,!0);var s=i.getAttribute("x"),o=i.getAttribute("y"),l=i.getAttribute("dx"),u=i.getAttribute("dy"),c=i.getStyle("font-family").getDefinition(),m=!!c&&c.isRTL;a===0&&(s.hasValue()||s.setValue(i.getInheritedAttribute("x")),o.hasValue()||o.setValue(i.getInheritedAttribute("y")),l.hasValue()||l.setValue(i.getInheritedAttribute("dx")),u.hasValue()||u.setValue(i.getInheritedAttribute("dy")));var h=i.measureText(t);return m&&(r.x-=h),s.hasValue()?(r.applyAnchoring(),i.x=s.getPixels("x"),l.hasValue()&&(i.x+=l.getPixels("x"))):(l.hasValue()&&(r.x+=l.getPixels("x")),i.x=r.x),r.x=i.x,m||(r.x+=h),o.hasValue()?(i.y=o.getPixels("y"),u.hasValue()&&(i.y+=u.getPixels("y"))):(u.hasValue()&&(r.y+=u.getPixels("y")),i.y=r.y),r.y=i.y,r.leafTexts.push(i),r.minX=Math.min(r.minX,i.x,i.x+h),r.maxX=Math.max(r.maxX,i.x,i.x+h),i.clearContext(t),t.restore(),i}getChildBoundingBox(t,r,n,a){var i=n.children[a];if(typeof i.getBoundingBox!="function")return null;var s=i.getBoundingBox(t);return s?(i.children.forEach((o,l)=>{var u=r.getChildBoundingBox(t,r,i,l);s.addBoundingBox(u)}),s):null}renderChild(t,r,n,a){var i=n.children[a];i.render(t),i.children.forEach((s,o)=>{r.renderChild(t,r,i,o)})}measureText(t){var{measureCache:r}=this;if(~r)return r;var n=this.getText(),a=this.measureTargetText(t,n);return this.measureCache=a,a}measureTargetText(t,r){if(!r.length)return 0;var{parent:n}=this,a=n.getStyle("font-family").getDefinition();if(a){for(var i=this.getFontSize(),s=a.isRTL?r.split("").reverse().join(""):r,o=Mr(n.getAttribute("dx").getString()),l=s.length,u=0,c=0;c<l;c++){var m=this.getGlyph(a,s,c);u+=(m.horizAdvX||a.horizAdvX)*i/a.fontFace.unitsPerEm,typeof o[c]!="undefined"&&!isNaN(o[c])&&(u+=o[c])}return u}if(!t.measureText)return r.length*10;t.save(),this.setContext(t,!0);var{width:h}=t.measureText(r);return this.clearContext(t),t.restore(),h}getInheritedAttribute(t){for(var r=this;r instanceof _a&&r.isFirstChild();){var n=r.parent.getAttribute(t);if(n.hasValue(!0))return n.getValue("0");r=r.parent}return null}}class Bl extends _a{constructor(t,r,n){super(t,r,new.target===Bl?!0:n),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}}class $Q extends Bl{constructor(){super(...arguments),this.type="textNode"}}class io extends di{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(t){var r,{document:n}=this,{screen:a,window:i}=n,s=t.canvas;if(a.setDefaults(t),s.style&&typeof t.font!="undefined"&&i&&typeof i.getComputedStyle!="undefined"){t.font=i.getComputedStyle(s).getPropertyValue("font");var o=new Me(n,"fontSize",Cr.parse(t.font).fontSize);o.hasValue()&&(n.rootEmSize=o.getPixels("y"),n.emSize=n.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:l,height:u}=a.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var c=this.getAttribute("refX"),m=this.getAttribute("refY"),h=this.getAttribute("viewBox"),f=h.hasValue()?Mr(h.getString()):null,x=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible",p=0,g=0,v=0,C=0;f&&(p=f[0],g=f[1]),this.root||(l=this.getStyle("width").getPixels("x"),u=this.getStyle("height").getPixels("y"),this.type==="marker"&&(v=p,C=g,p=0,g=0)),a.viewPort.setCurrent(l,u),this.node&&(!this.parent||((r=this.node.parentNode)===null||r===void 0?void 0:r.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),f&&(l=f[2],u=f[3]),n.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:a.viewPort.width,desiredWidth:l,height:a.viewPort.height,desiredHeight:u,minX:p,minY:g,refX:c.getValue(),refY:m.getValue(),clip:x,clipX:v,clipY:C}),f&&(a.viewPort.removeCurrent(),a.viewPort.setCurrent(l,u))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.getAttribute("width",!0),i=this.getAttribute("height",!0),s=this.getAttribute("viewBox"),o=this.getAttribute("style"),l=a.getNumber(0),u=i.getNumber(0);if(n)if(typeof n=="string")this.getAttribute("preserveAspectRatio",!0).setValue(n);else{var c=this.getAttribute("preserveAspectRatio");c.hasValue()&&c.setValue(c.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(a.setValue(t),i.setValue(r),s.hasValue()||s.setValue("0 0 ".concat(l||t," ").concat(u||r)),o.hasValue()){var m=this.getStyle("width"),h=this.getStyle("height");m.hasValue()&&m.setValue("".concat(t,"px")),h.hasValue()&&h.setValue("".concat(r,"px"))}}}class f1 extends dt{constructor(){super(...arguments),this.type="rect"}path(t){var r=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),a=this.getStyle("width",!1,!0).getPixels("x"),i=this.getStyle("height",!1,!0).getPixels("y"),s=this.getAttribute("rx"),o=this.getAttribute("ry"),l=s.getPixels("x"),u=o.getPixels("y");if(s.hasValue()&&!o.hasValue()&&(u=l),o.hasValue()&&!s.hasValue()&&(l=u),l=Math.min(l,a/2),u=Math.min(u,i/2),t){var c=4*((Math.sqrt(2)-1)/3);t.beginPath(),i>0&&a>0&&(t.moveTo(r+l,n),t.lineTo(r+a-l,n),t.bezierCurveTo(r+a-l+c*l,n,r+a,n+u-c*u,r+a,n+u),t.lineTo(r+a,n+i-u),t.bezierCurveTo(r+a,n+i-u+c*u,r+a-l+c*l,n+i,r+a-l,n+i),t.lineTo(r+l,n+i),t.bezierCurveTo(r+l-c*l,n+i,r,n+i-u+c*u,r,n+i-u),t.lineTo(r,n+u),t.bezierCurveTo(r,n+u-c*u,r+l-c*l,n,r+l,n),t.closePath())}return new vn(r,n,r+a,n+i)}getMarkers(){return null}}class w4 extends dt{constructor(){super(...arguments),this.type="circle"}path(t){var r=this.getAttribute("cx").getPixels("x"),n=this.getAttribute("cy").getPixels("y"),a=this.getAttribute("r").getPixels();return t&&a>0&&(t.beginPath(),t.arc(r,n,a,0,Math.PI*2,!1),t.closePath()),new vn(r-a,n-a,r+a,n+a)}getMarkers(){return null}}class E4 extends dt{constructor(){super(...arguments),this.type="ellipse"}path(t){var r=4*((Math.sqrt(2)-1)/3),n=this.getAttribute("rx").getPixels("x"),a=this.getAttribute("ry").getPixels("y"),i=this.getAttribute("cx").getPixels("x"),s=this.getAttribute("cy").getPixels("y");return t&&n>0&&a>0&&(t.beginPath(),t.moveTo(i+n,s),t.bezierCurveTo(i+n,s+r*a,i+r*n,s+a,i,s+a),t.bezierCurveTo(i-r*n,s+a,i-n,s+r*a,i-n,s),t.bezierCurveTo(i-n,s-r*a,i-r*n,s-a,i,s-a),t.bezierCurveTo(i+r*n,s-a,i+n,s-r*a,i+n,s),t.closePath()),new vn(i-n,s-a,i+n,s+a)}getMarkers(){return null}}class _4 extends dt{constructor(){super(...arguments),this.type="line"}getPoints(){return[new Bt(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new Bt(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){var[{x:r,y:n},{x:a,y:i}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(r,n),t.lineTo(a,i)),new vn(r,n,a,i)}getMarkers(){var[t,r]=this.getPoints(),n=t.angleTo(r);return[[t,n],[r,n]]}}class h1 extends dt{constructor(t,r,n){super(t,r,n),this.type="polyline",this.points=[],this.points=Bt.parsePath(this.getAttribute("points").getString())}path(t){var{points:r}=this,[{x:n,y:a}]=r,i=new vn(n,a);return t&&(t.beginPath(),t.moveTo(n,a)),r.forEach(s=>{var{x:o,y:l}=s;i.addPoint(o,l),t&&t.lineTo(o,l)}),i}getMarkers(){var{points:t}=this,r=t.length-1,n=[];return t.forEach((a,i)=>{i!==r&&n.push([a,a.angleTo(t[i+1])])}),n.length>0&&n.push([t[t.length-1],n[n.length-1][1]]),n}}class S4 extends h1{constructor(){super(...arguments),this.type="polygon"}path(t){var r=super.path(t),[{x:n,y:a}]=this.points;return t&&(t.lineTo(n,a),t.closePath()),r}}class T4 extends Mt{constructor(){super(...arguments),this.type="pattern"}createPattern(t,r,n){var a=this.getStyle("width").getPixels("x",!0),i=this.getStyle("height").getPixels("y",!0),s=new io(this.document,null);s.attributes.viewBox=new Me(this.document,"viewBox",this.getAttribute("viewBox").getValue()),s.attributes.width=new Me(this.document,"width","".concat(a,"px")),s.attributes.height=new Me(this.document,"height","".concat(i,"px")),s.attributes.transform=new Me(this.document,"transform",this.getAttribute("patternTransform").getValue()),s.children=this.children;var o=this.document.createCanvas(a,i),l=o.getContext("2d"),u=this.getAttribute("x"),c=this.getAttribute("y");u.hasValue()&&c.hasValue()&&l.translate(u.getPixels("x",!0),c.getPixels("y",!0)),n.hasValue()?this.styles["fill-opacity"]=n:Reflect.deleteProperty(this.styles,"fill-opacity");for(var m=-1;m<=1;m++)for(var h=-1;h<=1;h++)l.save(),s.attributes.x=new Me(this.document,"x",m*o.width),s.attributes.y=new Me(this.document,"y",h*o.height),s.render(l),l.restore();var f=t.createPattern(o,"repeat");return f}}class D4 extends Mt{constructor(){super(...arguments),this.type="marker"}render(t,r,n){if(r){var{x:a,y:i}=r,s=this.getAttribute("orient").getString("auto"),o=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(a,i),s==="auto"&&t.rotate(n),o==="strokeWidth"&&t.scale(t.lineWidth,t.lineWidth),t.save();var l=new io(this.document,null);l.type=this.type,l.attributes.viewBox=new Me(this.document,"viewBox",this.getAttribute("viewBox").getValue()),l.attributes.refX=new Me(this.document,"refX",this.getAttribute("refX").getValue()),l.attributes.refY=new Me(this.document,"refY",this.getAttribute("refY").getValue()),l.attributes.width=new Me(this.document,"width",this.getAttribute("markerWidth").getValue()),l.attributes.height=new Me(this.document,"height",this.getAttribute("markerHeight").getValue()),l.attributes.overflow=new Me(this.document,"overflow",this.getAttribute("overflow").getValue()),l.attributes.fill=new Me(this.document,"fill",this.getAttribute("fill").getColor("black")),l.attributes.stroke=new Me(this.document,"stroke",this.getAttribute("stroke").getValue("none")),l.children=this.children,l.render(t),t.restore(),o==="strokeWidth"&&t.scale(1/t.lineWidth,1/t.lineWidth),s==="auto"&&t.rotate(-n),t.translate(-a,-i)}}}class A4 extends Mt{constructor(){super(...arguments),this.type="defs"}render(){}}class am extends di{constructor(){super(...arguments),this.type="g"}getBoundingBox(t){var r=new vn;return this.children.forEach(n=>{r.addBoundingBox(n.getBoundingBox(t))}),r}}class p1 extends Mt{constructor(t,r,n){super(t,r,n),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:a,children:i}=this;i.forEach(s=>{s.type==="stop"&&a.push(s)})}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,r,n){var a=this;this.getHrefAttribute().hasValue()&&(a=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(a));var{stops:i}=a,s=this.getGradient(t,r);if(!s)return this.addParentOpacity(n,i[i.length-1].color);if(i.forEach(g=>{s.addColorStop(g.offset,this.addParentOpacity(n,g.color))}),this.getAttribute("gradientTransform").hasValue()){var{document:o}=this,{MAX_VIRTUAL_PIXELS:l,viewPort:u}=o.screen,[c]=u.viewPorts,m=new f1(o,null);m.attributes.x=new Me(o,"x",-l/3),m.attributes.y=new Me(o,"y",-l/3),m.attributes.width=new Me(o,"width",l),m.attributes.height=new Me(o,"height",l);var h=new am(o,null);h.attributes.transform=new Me(o,"transform",this.getAttribute("gradientTransform").getValue()),h.children=[m];var f=new io(o,null);f.attributes.x=new Me(o,"x",0),f.attributes.y=new Me(o,"y",0),f.attributes.width=new Me(o,"width",c.width),f.attributes.height=new Me(o,"height",c.height),f.children=[h];var x=o.createCanvas(c.width,c.height),p=x.getContext("2d");return p.fillStyle=s,f.render(p),p.createPattern(x,"no-repeat")}return s}inheritStopContainer(t){this.attributesToInherit.forEach(r=>{!this.getAttribute(r).hasValue()&&t.getAttribute(r).hasValue()&&this.getAttribute(r,!0).setValue(t.getAttribute(r).getValue())})}addParentOpacity(t,r){if(t.hasValue()){var n=new Me(this.document,"color",r);return n.addOpacity(t).getColor()}return r}}class k4 extends p1{constructor(t,r,n){super(t,r,n),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(t,r){var n=this.getGradientUnits()==="objectBoundingBox",a=n?r.getBoundingBox(t):null;if(n&&!a)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var i=n?a.x+a.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),s=n?a.y+a.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),o=n?a.x+a.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),l=n?a.y+a.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return i===o&&s===l?null:t.createLinearGradient(i,s,o,l)}}class F4 extends p1{constructor(t,r,n){super(t,r,n),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(t,r){var n=this.getGradientUnits()==="objectBoundingBox",a=r.getBoundingBox(t);if(n&&!a)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var i=n?a.x+a.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),s=n?a.y+a.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),o=i,l=s;this.getAttribute("fx").hasValue()&&(o=n?a.x+a.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(l=n?a.y+a.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var u=n?(a.width+a.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),c=this.getAttribute("fr").getPixels();return t.createRadialGradient(o,l,c,i,s,u)}}class U4 extends Mt{constructor(t,r,n){super(t,r,n),this.type="stop";var a=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),i=this.getStyle("stop-opacity"),s=this.getStyle("stop-color",!0);s.getString()===""&&s.setValue("#000"),i.hasValue()&&(s=s.addOpacity(i)),this.offset=a,this.color=s.getColor()}}class im extends Mt{constructor(t,r,n){super(t,r,n),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new Me(t,"values",null);var a=this.getAttribute("values");a.hasValue()&&this.values.setValue(a.getString().split(";"))}getProperty(){var t=this.getAttribute("attributeType").getString(),r=this.getAttribute("attributeName").getString();return t==="CSS"?this.parent.getStyle(r,!0):this.parent.getAttribute(r,!0)}calcValue(){var{initialUnits:t}=this,{progress:r,from:n,to:a}=this.getProgress(),i=n.getNumber()+(a.getNumber()-n.getNumber())*r;return t==="%"&&(i*=100),"".concat(i).concat(t)}update(t){var{parent:r}=this,n=this.getProperty();if(this.initialValue||(this.initialValue=n.getString(),this.initialUnits=n.getUnits()),this.duration>this.maxDuration){var a=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(a==="freeze"&&!this.frozen)this.frozen=!0,r.animationFrozen=!0,r.animationFrozenValue=n.getString();else if(a==="remove"&&!this.removed)return this.removed=!0,n.setValue(r.animationFrozen?r.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=t;var i=!1;if(this.begin<this.duration){var s=this.calcValue(),o=this.getAttribute("type");if(o.hasValue()){var l=o.getString();s="".concat(l,"(").concat(s,")")}n.setValue(s),i=!0}return i}getProgress(){var{document:t,values:r}=this,n={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(r.hasValue()){var a=n.progress*(r.getValue().length-1),i=Math.floor(a),s=Math.ceil(a);n.from=new Me(t,"from",parseFloat(r.getValue()[i])),n.to=new Me(t,"to",parseFloat(r.getValue()[s])),n.progress=(a-i)/(s-i)}else n.from=this.from,n.to=this.to;return n}}class R4 extends im{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:t,from:r,to:n}=this.getProgress(),a=new nx(r.getColor()),i=new nx(n.getColor());if(a.ok&&i.ok){var s=a.r+(i.r-a.r)*t,o=a.g+(i.g-a.g)*t,l=a.b+(i.b-a.b)*t;return"rgb(".concat(Math.floor(s),", ").concat(Math.floor(o),", ").concat(Math.floor(l),")")}return this.getAttribute("from").getColor()}}class O4 extends im{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:t,from:r,to:n}=this.getProgress(),a=Mr(r.getString()),i=Mr(n.getString()),s=a.map((o,l)=>{var u=i[l];return o+(u-o)*t}).join(" ");return s}}class V4 extends Mt{constructor(t,r,n){super(t,r,n),this.type="font",this.glyphs=Object.create(null),this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:a}=t,{children:i}=this;for(var s of i)switch(s.type){case"font-face":{this.fontFace=s;var o=s.getStyle("font-family");o.hasValue()&&(a[o.getString()]=this);break}case"missing-glyph":this.missingGlyph=s;break;case"glyph":{var l=s;l.arabicForm?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[l.unicode]=="undefined"&&(this.glyphs[l.unicode]=Object.create(null)),this.glyphs[l.unicode][l.arabicForm]=l):this.glyphs[l.unicode]=l;break}}}render(){}}class P4 extends Mt{constructor(t,r,n){super(t,r,n),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}}class I4 extends dt{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}}class M4 extends _a{constructor(){super(...arguments),this.type="tref"}getText(){var t=this.getHrefAttribute().getDefinition();if(t){var r=t.children[0];if(r)return r.getText()}return""}}class j4 extends _a{constructor(t,r,n){super(t,r,n),this.type="a";var{childNodes:a}=r,i=a[0],s=a.length>0&&Array.from(a).every(o=>o.nodeType===3);this.hasText=s,this.text=s?this.getTextFromNode(i):""}getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);var{document:r,x:n,y:a}=this,{mouse:i}=r.screen,s=new Me(r,"fontSize",Cr.parse(r.ctx.font).fontSize);i.isWorking()&&i.checkBoundingBox(this,new vn(n,a-s.getPixels("y"),n+this.measureText(t),a))}else if(this.children.length>0){var o=new am(this.document,null);o.children=this.children,o.parent=this,o.render(t)}}onClick(){var{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){var t=this.document.ctx;t.canvas.style.cursor="pointer"}}function NE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Eu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NE(Object(r),!0).forEach(function(n){l1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}class L4 extends _a{constructor(t,r,n){super(t,r,n),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var a=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(a)}getText(){return this.text}path(t){var{dataArray:r}=this;t&&t.beginPath(),r.forEach(n=>{var{type:a,points:i}=n;switch(a){case Ge.LINE_TO:t&&t.lineTo(i[0],i[1]);break;case Ge.MOVE_TO:t&&t.moveTo(i[0],i[1]);break;case Ge.CURVE_TO:t&&t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case Ge.QUAD_TO:t&&t.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case Ge.ARC:{var[s,o,l,u,c,m,h,f]=i,x=l>u?l:u,p=l>u?1:l/u,g=l>u?u/l:1;t&&(t.translate(s,o),t.rotate(h),t.scale(p,g),t.arc(0,0,x,c,c+m,!!(1-f)),t.scale(1/p,1/g),t.rotate(-h),t.translate(-s,-o));break}case Ge.CLOSE_PATH:t&&t.closePath();break}})}renderChildren(t){this.setTextData(t),t.save();var r=this.parent.getStyle("text-decoration").getString(),n=this.getFontSize(),{glyphInfo:a}=this,i=t.fillStyle;r==="underline"&&t.beginPath(),a.forEach((s,o)=>{var{p0:l,p1:u,rotation:c,text:m}=s;t.save(),t.translate(l.x,l.y),t.rotate(c),t.fillStyle&&t.fillText(m,0,0),t.strokeStyle&&t.strokeText(m,0,0),t.restore(),r==="underline"&&(o===0&&t.moveTo(l.x,l.y+n/8),t.lineTo(u.x,u.y+n/5))}),r==="underline"&&(t.lineWidth=n/20,t.strokeStyle=i,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,r,n,a,i,s,o,l,u){var c=s,m=this.measureText(t,l);l===" "&&r==="justify"&&n<a&&(m+=(a-n)/i),u>-1&&(c+=this.getLetterSpacingAt(u));var h=this.textHeight/20,f=this.getEquidistantPointOnPath(c,h,0),x=this.getEquidistantPointOnPath(c+m,h,0),p={p0:f,p1:x},g=f&&x?Math.atan2(x.y-f.y,x.x-f.x):0;if(o){var v=Math.cos(Math.PI/2+g)*o,C=Math.cos(-g)*o;p.p0=Eu(Eu({},f),{},{x:f.x+v,y:f.y+C}),p.p1=Eu(Eu({},x),{},{x:x.x+v,y:x.y+C})}return c+=m,{offset:c,segment:p,rotation:g}}measureText(t,r){var{measuresCache:n}=this,a=r||this.getText();if(n.has(a))return n.get(a);var i=this.measureTargetText(t,a);return n.set(a,i),i}setTextData(t){if(!this.glyphInfo){var r=this.getText(),n=r.split(""),a=r.split(" ").length-1,i=this.parent.getAttribute("dx").split().map(N=>N.getPixels("x")),s=this.parent.getAttribute("dy").getPixels("y"),o=this.parent.getStyle("text-anchor").getString("start"),l=this.getStyle("letter-spacing"),u=this.parent.getStyle("letter-spacing"),c=0;!l.hasValue()||l.getValue()==="inherit"?c=u.getPixels():l.hasValue()&&l.getValue()!=="initial"&&l.getValue()!=="unset"&&(c=l.getPixels());var m=[],h=r.length;this.letterSpacingCache=m;for(var f=0;f<h;f++)m.push(typeof i[f]!="undefined"?i[f]:c);var x=m.reduce((N,F,E)=>E===0?0:N+F||0,0),p=this.measureText(t),g=Math.max(p+x,0);this.textWidth=p,this.textHeight=this.getFontSize(),this.glyphInfo=[];var v=this.getPathLength(),C=this.getStyle("startOffset").getNumber(0)*v,b=0;(o==="middle"||o==="center")&&(b=-g/2),(o==="end"||o==="right")&&(b=-g),b+=C,n.forEach((N,F)=>{var{offset:E,segment:w,rotation:S}=this.findSegmentToFitChar(t,o,g,v,a,b,s,N,F);b=E,!(!w.p0||!w.p1)&&this.glyphInfo.push({text:n[F],p0:w.p0,p1:w.p1,rotation:S})})}}parsePathData(t){if(this.pathLength=-1,!t)return[];var r=[],{pathParser:n}=t;for(n.reset();!n.isEnd();){var{current:a}=n,i=a?a.x:0,s=a?a.y:0,o=n.next(),l=o.type,u=[];switch(o.type){case Ge.MOVE_TO:this.pathM(n,u);break;case Ge.LINE_TO:l=this.pathL(n,u);break;case Ge.HORIZ_LINE_TO:l=this.pathH(n,u);break;case Ge.VERT_LINE_TO:l=this.pathV(n,u);break;case Ge.CURVE_TO:this.pathC(n,u);break;case Ge.SMOOTH_CURVE_TO:l=this.pathS(n,u);break;case Ge.QUAD_TO:this.pathQ(n,u);break;case Ge.SMOOTH_QUAD_TO:l=this.pathT(n,u);break;case Ge.ARC:u=this.pathA(n);break;case Ge.CLOSE_PATH:dt.pathZ(n);break}o.type!==Ge.CLOSE_PATH?r.push({type:l,points:u,start:{x:i,y:s},pathLength:this.calcLength(i,s,l,u)}):r.push({type:Ge.CLOSE_PATH,points:[],pathLength:0})}return r}pathM(t,r){var{x:n,y:a}=dt.pathM(t).point;r.push(n,a)}pathL(t,r){var{x:n,y:a}=dt.pathL(t).point;return r.push(n,a),Ge.LINE_TO}pathH(t,r){var{x:n,y:a}=dt.pathH(t).point;return r.push(n,a),Ge.LINE_TO}pathV(t,r){var{x:n,y:a}=dt.pathV(t).point;return r.push(n,a),Ge.LINE_TO}pathC(t,r){var{point:n,controlPoint:a,currentPoint:i}=dt.pathC(t);r.push(n.x,n.y,a.x,a.y,i.x,i.y)}pathS(t,r){var{point:n,controlPoint:a,currentPoint:i}=dt.pathS(t);return r.push(n.x,n.y,a.x,a.y,i.x,i.y),Ge.CURVE_TO}pathQ(t,r){var{controlPoint:n,currentPoint:a}=dt.pathQ(t);r.push(n.x,n.y,a.x,a.y)}pathT(t,r){var{controlPoint:n,currentPoint:a}=dt.pathT(t);return r.push(n.x,n.y,a.x,a.y),Ge.QUAD_TO}pathA(t){var{rX:r,rY:n,sweepFlag:a,xAxisRotation:i,centp:s,a1:o,ad:l}=dt.pathA(t);return a===0&&l>0&&(l-=2*Math.PI),a===1&&l<0&&(l+=2*Math.PI),[s.x,s.y,r,n,o,l,i,a]}calcLength(t,r,n,a){var i=0,s=null,o=null,l=0;switch(n){case Ge.LINE_TO:return this.getLineLength(t,r,a[0],a[1]);case Ge.CURVE_TO:for(i=0,s=this.getPointOnCubicBezier(0,t,r,a[0],a[1],a[2],a[3],a[4],a[5]),l=.01;l<=1;l+=.01)o=this.getPointOnCubicBezier(l,t,r,a[0],a[1],a[2],a[3],a[4],a[5]),i+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;return i;case Ge.QUAD_TO:for(i=0,s=this.getPointOnQuadraticBezier(0,t,r,a[0],a[1],a[2],a[3]),l=.01;l<=1;l+=.01)o=this.getPointOnQuadraticBezier(l,t,r,a[0],a[1],a[2],a[3]),i+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;return i;case Ge.ARC:{i=0;var u=a[4],c=a[5],m=a[4]+c,h=Math.PI/180;if(Math.abs(u-m)<h&&(h=Math.abs(u-m)),s=this.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],u,0),c<0)for(l=u-h;l>m;l-=h)o=this.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],l,0),i+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;else for(l=u+h;l<m;l+=h)o=this.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],l,0),i+=this.getLineLength(s.x,s.y,o.x,o.y),s=o;return o=this.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],m,0),i+=this.getLineLength(s.x,s.y,o.x,o.y),i}}return 0}getPointOnLine(t,r,n,a,i){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:r,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:n,l=(i-n)/(a-r+Pi),u=Math.sqrt(t*t/(1+l*l));a<r&&(u*=-1);var c=l*u,m=null;if(a===r)m={x:s,y:o+c};else if((o-n)/(s-r+Pi)===l)m={x:s+u,y:o+c};else{var h=0,f=0,x=this.getLineLength(r,n,a,i);if(x<Pi)return null;var p=(s-r)*(a-r)+(o-n)*(i-n);p/=x*x,h=r+p*(a-r),f=n+p*(i-n);var g=this.getLineLength(s,o,h,f),v=Math.sqrt(t*t-g*g);u=Math.sqrt(v*v/(1+l*l)),a<r&&(u*=-1),c=l*u,m={x:h+u,y:f+c}}return m}getPointOnPath(t){var r=this.getPathLength(),n=0,a=null;if(t<-5e-5||t-5e-5>r)return null;var{dataArray:i}=this;for(var s of i){if(s&&(s.pathLength<5e-5||n+s.pathLength+5e-5<t)){n+=s.pathLength;continue}var o=t-n,l=0;switch(s.type){case Ge.LINE_TO:a=this.getPointOnLine(o,s.start.x,s.start.y,s.points[0],s.points[1],s.start.x,s.start.y);break;case Ge.ARC:{var u=s.points[4],c=s.points[5],m=s.points[4]+c;if(l=u+o/s.pathLength*c,c<0&&l<m||c>=0&&l>m)break;a=this.getPointOnEllipticalArc(s.points[0],s.points[1],s.points[2],s.points[3],l,s.points[6]);break}case Ge.CURVE_TO:l=o/s.pathLength,l>1&&(l=1),a=this.getPointOnCubicBezier(l,s.start.x,s.start.y,s.points[0],s.points[1],s.points[2],s.points[3],s.points[4],s.points[5]);break;case Ge.QUAD_TO:l=o/s.pathLength,l>1&&(l=1),a=this.getPointOnQuadraticBezier(l,s.start.x,s.start.y,s.points[0],s.points[1],s.points[2],s.points[3]);break}if(a)return a;break}return null}getLineLength(t,r,n,a){return Math.sqrt((n-t)*(n-t)+(a-r)*(a-r))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((t,r)=>r.pathLength>0?t+r.pathLength:t,0)),this.pathLength}getPointOnCubicBezier(t,r,n,a,i,s,o,l,u){var c=l*ox(t)+s*lx(t)+a*ux(t)+r*cx(t),m=u*ox(t)+o*lx(t)+i*ux(t)+n*cx(t);return{x:c,y:m}}getPointOnQuadraticBezier(t,r,n,a,i,s,o){var l=s*mx(t)+a*dx(t)+r*fx(t),u=o*mx(t)+i*dx(t)+n*fx(t);return{x:l,y:u}}getPointOnEllipticalArc(t,r,n,a,i,s){var o=Math.cos(s),l=Math.sin(s),u={x:n*Math.cos(i),y:a*Math.sin(i)};return{x:t+(u.x*o-u.y*l),y:r+(u.x*l+u.y*o)}}buildEquidistantCache(t,r){var n=this.getPathLength(),a=r||.25,i=t||n/100;if(!this.equidistantCache||this.equidistantCache.step!==i||this.equidistantCache.precision!==a){this.equidistantCache={step:i,precision:a,points:[]};for(var s=0,o=0;o<=n;o+=a){var l=this.getPointOnPath(o),u=this.getPointOnPath(o+a);!l||!u||(s+=this.getLineLength(l.x,l.y,u.x,u.y),s>=i&&(this.equidistantCache.points.push({x:l.x,y:l.y,distance:o}),s-=i))}}}getEquidistantPointOnPath(t,r,n){if(this.buildEquidistantCache(r,n),t<0||t-this.getPathLength()>5e-5)return null;var a=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[a]||null}}var WQ=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class B4 extends di{constructor(t,r,n){super(t,r,n),this.type="image",this.loaded=!1;var a=this.getHrefAttribute().getString();if(a){var i=a.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(a);t.images.push(this),i?this.loadSvg(a):this.loadImage(a),this.isSvg=i}}loadImage(t){var r=this;return Ea(function*(){try{var n=yield r.document.createImage(t);r.image=n}catch(a){console.error('Error while loading image "'.concat(t,'":'),a)}r.loaded=!0})()}loadSvg(t){var r=this;return Ea(function*(){var n=WQ.exec(t);if(n){var a=n[5];n[4]==="base64"?r.image=atob(a):r.image=decodeURIComponent(a)}else try{var i=yield r.document.fetch(t),s=yield i.text();r.image=s}catch(o){console.error('Error while loading image "'.concat(t,'":'),o)}r.loaded=!0})()}renderChildren(t){var{document:r,image:n,loaded:a}=this,i=this.getAttribute("x").getPixels("x"),s=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),l=this.getStyle("height").getPixels("y");if(!(!a||!n||!o||!l)){if(t.save(),t.translate(i,s),this.isSvg){var u=r.canvg.forkString(t,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:o,scaleHeight:l});u.document.documentElement.parent=this,u.render()}else{var c=this.image;r.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:o,desiredWidth:c.width,height:l,desiredHeight:c.height}),this.loaded&&(typeof c.complete=="undefined"||c.complete)&&t.drawImage(c,0,0)}t.restore()}}getBoundingBox(){var t=this.getAttribute("x").getPixels("x"),r=this.getAttribute("y").getPixels("y"),n=this.getStyle("width").getPixels("x"),a=this.getStyle("height").getPixels("y");return new vn(t,r,t+n,r+a)}}class q4 extends di{constructor(){super(...arguments),this.type="symbol"}render(t){}}class z4{constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}load(t,r){var n=this;return Ea(function*(){try{var{document:a}=n,i=yield a.canvg.parser.load(r),s=i.getElementsByTagName("font");Array.from(s).forEach(o=>{var l=a.createElement(o);a.definitions[t]=l})}catch(o){console.error('Error while loading font "'.concat(r,'":'),o)}n.loaded=!0})()}}class x1 extends Mt{constructor(t,r,n){super(t,r,n),this.type="style";var a=is(Array.from(r.childNodes).map(s=>s.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")),i=a.split("}");i.forEach(s=>{var o=s.trim();if(o){var l=o.split("{"),u=l[0].split(","),c=l[1].split(";");u.forEach(m=>{var h=m.trim();if(h){var f=t.styles[h]||{};if(c.forEach(g=>{var v=g.indexOf(":"),C=g.substr(0,v).trim(),b=g.substr(v+1,g.length-v).trim();C&&b&&(f[C]=new Me(t,C,b))}),t.styles[h]=f,t.stylesSpecificity[h]=d4(h),h==="@font-face"){var x=f["font-family"].getString().replace(/"|'/g,""),p=f.src.getString().split(",");p.forEach(g=>{if(g.indexOf('format("svg")')>0){var v=u1(g);v&&new z4(t).load(x,v)}})}}})}})}}x1.parseExternalUrl=u1;class H4 extends di{constructor(){super(...arguments),this.type="use"}setContext(t){super.setContext(t);var r=this.getAttribute("x"),n=this.getAttribute("y");r.hasValue()&&t.translate(r.getPixels("x"),0),n.hasValue()&&t.translate(0,n.getPixels("y"))}path(t){var{element:r}=this;r&&r.path(t)}renderChildren(t){var{document:r,element:n}=this;if(n){var a=n;if(n.type==="symbol"&&(a=new io(r,null),a.attributes.viewBox=new Me(r,"viewBox",n.getAttribute("viewBox").getString()),a.attributes.preserveAspectRatio=new Me(r,"preserveAspectRatio",n.getAttribute("preserveAspectRatio").getString()),a.attributes.overflow=new Me(r,"overflow",n.getAttribute("overflow").getString()),a.children=n.children,n.styles.opacity=new Me(r,"opacity",this.calculateOpacity())),a.type==="svg"){var i=this.getStyle("width",!1,!0),s=this.getStyle("height",!1,!0);i.hasValue()&&(a.attributes.width=new Me(r,"width",i.getString())),s.hasValue()&&(a.attributes.height=new Me(r,"height",s.getString()))}var o=a.parent;a.parent=this,a.render(t),a.parent=o}}getBoundingBox(t){var{element:r}=this;return r?r.getBoundingBox(t):null}elementTransform(){var{document:t,element:r}=this;return ni.fromElement(t,r)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}}function _u(e,t,r,n,a,i){return e[r*n*4+t*4+i]}function Su(e,t,r,n,a,i,s){e[r*n*4+t*4+i]=s}function $t(e,t,r){var n=e[t];return n*r}function la(e,t,r,n){return t+Math.cos(e)*r+Math.sin(e)*n}class g1 extends Mt{constructor(t,r,n){super(t,r,n),this.type="feColorMatrix";var a=Mr(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{var i=a[0];a=[.213+.787*i,.715-.715*i,.072-.072*i,0,0,.213-.213*i,.715+.285*i,.072-.072*i,0,0,.213-.213*i,.715-.715*i,.072+.928*i,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{var s=a[0]*Math.PI/180;a=[la(s,.213,.787,-.213),la(s,.715,-.715,-.715),la(s,.072,-.072,.928),0,0,la(s,.213,-.213,.143),la(s,.715,.285,.14),la(s,.072,-.072,-.283),0,0,la(s,.213,-.213,-.787),la(s,.715,-.715,.715),la(s,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=a,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(t,r,n,a,i){for(var{includeOpacity:s,matrix:o}=this,l=t.getImageData(0,0,a,i),u=0;u<i;u++)for(var c=0;c<a;c++){var m=_u(l.data,c,u,a,i,0),h=_u(l.data,c,u,a,i,1),f=_u(l.data,c,u,a,i,2),x=_u(l.data,c,u,a,i,3),p=$t(o,0,m)+$t(o,1,h)+$t(o,2,f)+$t(o,3,x)+$t(o,4,1),g=$t(o,5,m)+$t(o,6,h)+$t(o,7,f)+$t(o,8,x)+$t(o,9,1),v=$t(o,10,m)+$t(o,11,h)+$t(o,12,f)+$t(o,13,x)+$t(o,14,1),C=$t(o,15,m)+$t(o,16,h)+$t(o,17,f)+$t(o,18,x)+$t(o,19,1);s&&(p=0,g=0,v=0,C*=x/255),Su(l.data,c,u,a,i,0,p),Su(l.data,c,u,a,i,1,g),Su(l.data,c,u,a,i,2,v),Su(l.data,c,u,a,i,3,C)}t.clearRect(0,0,a,i),t.putImageData(l,0,0)}}class ql extends Mt{constructor(){super(...arguments),this.type="mask"}apply(t,r){var{document:n}=this,a=this.getAttribute("x").getPixels("x"),i=this.getAttribute("y").getPixels("y"),s=this.getStyle("width").getPixels("x"),o=this.getStyle("height").getPixels("y");if(!s&&!o){var l=new vn;this.children.forEach(x=>{l.addBoundingBox(x.getBoundingBox(t))}),a=Math.floor(l.x1),i=Math.floor(l.y1),s=Math.floor(l.width),o=Math.floor(l.height)}var u=this.removeStyles(r,ql.ignoreStyles),c=n.createCanvas(a+s,i+o),m=c.getContext("2d");n.screen.setDefaults(m),this.renderChildren(m),new g1(n,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(m,0,0,a+s,i+o);var h=n.createCanvas(a+s,i+o),f=h.getContext("2d");n.screen.setDefaults(f),r.render(f),f.globalCompositeOperation="destination-in",f.fillStyle=m.createPattern(c,"no-repeat"),f.fillRect(0,0,a+s,i+o),t.fillStyle=f.createPattern(h,"no-repeat"),t.fillRect(0,0,a+s,i+o),this.restoreStyles(r,u)}render(t){}}ql.ignoreStyles=["mask","transform","clip-path"];var yE=()=>{};class $4 extends Mt{constructor(){super(...arguments),this.type="clipPath"}apply(t){var{document:r}=this,n=Reflect.getPrototypeOf(t),{beginPath:a,closePath:i}=t;n&&(n.beginPath=yE,n.closePath=yE),Reflect.apply(a,t,[]),this.children.forEach(s=>{if(typeof s.path!="undefined"){var o=typeof s.elementTransform!="undefined"?s.elementTransform():null;o||(o=ni.fromElement(r,s)),o&&o.apply(t),s.path(t),n&&(n.closePath=i),o&&o.unapply(t)}}),Reflect.apply(i,t,[]),t.clip(),n&&(n.beginPath=a,n.closePath=i)}render(t){}}class zl extends Mt{constructor(){super(...arguments),this.type="filter"}apply(t,r){var{document:n,children:a}=this,i=r.getBoundingBox(t);if(i){var s=0,o=0;a.forEach(v=>{var C=v.extraFilterDistance||0;s=Math.max(s,C),o=Math.max(o,C)});var l=Math.floor(i.width),u=Math.floor(i.height),c=l+2*s,m=u+2*o;if(!(c<1||m<1)){var h=Math.floor(i.x),f=Math.floor(i.y),x=this.removeStyles(r,zl.ignoreStyles),p=n.createCanvas(c,m),g=p.getContext("2d");n.screen.setDefaults(g),g.translate(-h+s,-f+o),r.render(g),a.forEach(v=>{typeof v.apply=="function"&&v.apply(g,0,0,c,m)}),t.drawImage(p,0,0,c,m,h-s,f-o,c,m),this.restoreStyles(r,x)}}}render(t){}}zl.ignoreStyles=["filter","transform","clip-path"];class W4 extends Mt{constructor(t,r,n){super(t,r,n),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(t,r,n,a,i){}}class G4 extends Mt{constructor(){super(...arguments),this.type="feMorphology"}apply(t,r,n,a,i){}}class Y4 extends Mt{constructor(){super(...arguments),this.type="feComposite"}apply(t,r,n,a,i){}}class X4 extends Mt{constructor(t,r,n){super(t,r,n),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(t,r,n,a,i){var{document:s,blurRadius:o}=this,l=s.window?s.window.document.body:null,u=t.canvas;u.id=s.getUniqueId(),l&&(u.style.display="none",l.appendChild(u)),EQ(u,r,n,a,i,o),l&&l.removeChild(u)}}class K4 extends Mt{constructor(){super(...arguments),this.type="title"}}class Q4 extends Mt{constructor(){super(...arguments),this.type="desc"}}var GQ={svg:io,rect:f1,circle:w4,ellipse:E4,line:_4,polyline:h1,polygon:S4,path:dt,pattern:T4,marker:D4,defs:A4,linearGradient:k4,radialGradient:F4,stop:U4,animate:im,animateColor:R4,animateTransform:O4,font:V4,"font-face":P4,"missing-glyph":I4,glyph:d1,text:_a,tspan:Bl,tref:M4,a:j4,textPath:L4,image:B4,g:am,symbol:q4,style:x1,use:H4,mask:ql,clipPath:$4,filter:zl,feDropShadow:W4,feMorphology:G4,feComposite:Y4,feColorMatrix:g1,feGaussianBlur:X4,title:K4,desc:Q4};function CE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CE(Object(r),!0).forEach(function(n){l1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XQ(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r}function KQ(e){return px.apply(this,arguments)}function px(){return px=Ea(function*(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=document.createElement("img");return t&&(r.crossOrigin="Anonymous"),new Promise((n,a)=>{r.onload=()=>{n(r)},r.onerror=(i,s,o,l,u)=>{a(u)},r.src=e})}),px.apply(this,arguments)}class va{constructor(t){var{rootEmSize:r=12,emSize:n=12,createCanvas:a=va.createCanvas,createImage:i=va.createImage,anonymousCrossOrigin:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.canvg=t,this.definitions=Object.create(null),this.styles=Object.create(null),this.stylesSpecificity=Object.create(null),this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=r,this.emSize=n,this.createCanvas=a,this.createImage=this.bindCreateImage(i,s),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(t,r){return typeof r=="boolean"?(n,a)=>t(n,typeof a=="boolean"?a:r):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:t}=this;return t[t.length-1]}set emSize(t){var{emSizeStack:r}=this;r.push(t)}popEmSize(){var{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(t=>t.loaded)}isFontsLoaded(){return this.fonts.every(t=>t.loaded)}createDocumentElement(t){var r=this.createElement(t.documentElement);return r.root=!0,r.addStylesFromStyleDefinition(),this.documentElement=r,r}createElement(t){var r=t.nodeName.replace(/^[^:]+:/,""),n=va.elementTypes[r];return typeof n!="undefined"?new n(this,t):new C4(this,t)}createTextNode(t){return new $Q(this,t)}setViewBox(t){this.screen.setViewBox(YQ({document:this},t))}}va.createCanvas=XQ;va.createImage=KQ;va.elementTypes=GQ;function wE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wE(Object(r),!0).forEach(function(n){l1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}class _i{constructor(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.parser=new Ru(n),this.screen=new Ll(t,n),this.options=n;var a=new va(this,n),i=a.createDocumentElement(r);this.document=a,this.documentElement=i}static from(t,r){var n=arguments;return Ea(function*(){var a=n.length>2&&n[2]!==void 0?n[2]:{},i=new Ru(a),s=yield i.parse(r);return new _i(t,s,a)})()}static fromString(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=new Ru(n),i=a.parseFromString(r);return new _i(t,i,n)}fork(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return _i.from(t,r,vi(vi({},this.options),n))}forkString(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return _i.fromString(t,r,vi(vi({},this.options),n))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var t=arguments,r=this;return Ea(function*(){var n=t.length>0&&t[0]!==void 0?t[0]:{};r.start(vi({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},n)),yield r.ready(),r.stop()})()}start(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{documentElement:r,screen:n,options:a}=this;n.start(r,vi(vi({enableRedraw:!0},a),t))}stop(){this.screen.stop()}resize(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(t,r,n)}}const wee=Object.freeze(Object.defineProperty({__proto__:null,AElement:j4,AnimateColorElement:R4,AnimateElement:im,AnimateTransformElement:O4,BoundingBox:vn,CB1:ox,CB2:lx,CB3:ux,CB4:cx,Canvg:_i,CircleElement:w4,ClipPathElement:$4,DefsElement:A4,DescElement:Q4,Document:va,Element:Mt,EllipseElement:E4,FeColorMatrixElement:g1,FeCompositeElement:Y4,FeDropShadowElement:W4,FeGaussianBlurElement:X4,FeMorphologyElement:G4,FilterElement:zl,Font:Cr,FontElement:V4,FontFaceElement:P4,GElement:am,GlyphElement:d1,GradientElement:p1,ImageElement:B4,LineElement:_4,LinearGradientElement:k4,MarkerElement:D4,MaskElement:ql,Matrix:c1,MissingGlyphElement:I4,Mouse:h4,PSEUDO_ZERO:Pi,Parser:Ru,PathElement:dt,PathParser:Ge,PatternElement:T4,Point:Bt,PolygonElement:S4,PolylineElement:h1,Property:Me,QB1:mx,QB2:dx,QB3:fx,RadialGradientElement:F4,RectElement:f1,RenderedElement:di,Rotate:v4,SVGElement:io,SVGFontLoader:z4,Scale:b4,Screen:Ll,Skew:m1,SkewX:N4,SkewY:y4,StopElement:U4,StyleElement:x1,SymbolElement:q4,TRefElement:M4,TSpanElement:Bl,TextElement:_a,TextPathElement:L4,TitleElement:K4,Transform:ni,Translate:g4,UnknownElement:C4,UseElement:H4,ViewPort:f4,compressSpaces:is,default:_i,getSelectorSpecificity:d4,normalizeAttributeName:c4,normalizeColor:m4,parseExternalUrl:u1,presets:DQ,toNumbers:Mr,trimLeft:l4,trimRight:u4,vectorMagnitude:ix,vectorsAngle:sx,vectorsRatio:Nc},Symbol.toStringTag,{value:"Module"}));export{mee as $,ree as A,Ye as B,Le as C,kc as D,sW as E,cW as F,uW as G,mR as H,Ns as I,uZ as J,mZ as K,nt as L,sZ as M,Xl as N,see as O,M0 as P,j0 as Q,L0 as R,Fo as S,dR as T,dS as U,oee as V,lee as W,qW as X,Bo as Y,uee as Z,kZ as _,Cc as a,MJ as a$,nv as a0,cee as a1,lZ as a2,LZ as a3,HZ as a4,zZ as a5,MZ as a6,jZ as a7,qZ as a8,BZ as a9,YV as aA,bJ as aB,SJ as aC,WZ as aD,sO as aE,cJ as aF,mJ as aG,uJ as aH,lJ as aI,oJ as aJ,sJ as aK,_S as aL,iJ as aM,YZ as aN,GZ as aO,rJ as aP,aJ as aQ,nJ as aR,AJ as aS,kJ as aT,FJ as aU,UJ as aV,RJ as aW,OJ as aX,IJ as aY,PJ as aZ,jJ as a_,tJ as aa,$Z as ab,eJ as ac,JZ as ad,ZZ as ae,QZ as af,KZ as ag,XZ as ah,oO as ai,xJ as aj,gJ as ak,vJ as al,EJ as am,_J as an,dJ as ao,vb as ap,pJ as aq,hJ as ar,Qo as as,fJ as at,CJ as au,yJ as av,NJ as aw,wJ as ax,Qx as ay,fT as az,Ke as b,pZ as b$,VJ as b0,LJ as b1,FZ as b2,Cee as b3,IZ as b4,eee as b5,JJ as b6,X$ as b7,tee as b8,HJ as b9,Ut as bA,aee as bB,xc as bC,gc as bD,pl as bE,VW as bF,PW as bG,MW as bH,jW as bI,BW as bJ,VZ as bK,OZ as bL,dl as bM,QJ as bN,KJ as bO,XJ as bP,ii as bQ,iZ as bR,at as bS,wZ as bT,xZ as bU,gZ as bV,vZ as bW,bZ as bX,NZ as bY,CZ as bZ,yZ as b_,ZJ as ba,BJ as bb,qJ as bc,zJ as bd,$J as be,WJ as bf,GJ as bg,YJ as bh,hee as bi,fee as bj,yee as bk,oZ as bl,cZ as bm,iR as bn,sR as bo,oR as bp,lR as bq,cR as br,uR as bs,PZ as bt,fZ as bu,dZ as bv,hZ as bw,RZ as bx,UZ as by,iee as bz,Qe as c,TZ as c0,QU as c1,SZ as c2,Bu as c3,AZ as c4,_Z as c5,DZ as c6,EZ as c7,DJ as c8,TJ as c9,Nee as ca,vee as cb,bee as cc,tQ as cd,pee as ce,OK as cf,xee as cg,gee as ch,wee as ci,ft as d,He as e,dee as f,fS as g,gp as h,vp as i,Ct as j,uS as k,yl as l,Cl as m,wl as n,El as o,Cs as p,Uo as q,ws as r,An as s,Tx as t,wF as u,nee as v,aW as w,iW as x,oW as y,lW as z};
