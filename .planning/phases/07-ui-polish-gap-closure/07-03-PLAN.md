---
phase: 07-ui-polish-gap-closure
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/quick-capture.tsx
  - src/components/capture/QuickNoteInput.tsx
autonomous: true
must_haves:
  truths:
    - Camera appears first in Quick Capture visual hierarchy
    - Notes section defaults to collapsed state
    - Notes can be expanded/collapsed with toggle control
    - Metadata fields (school, location) remain accessible but secondary
  artifacts:
    - path: src/pages/quick-capture.tsx
      provides: Camera-first layout with collapsed notes
    - path: src/components/capture/QuickNoteInput.tsx
      provides: Collapsible notes component with toggle API
  key_links:
    - from: QuickNoteInput component
      to: Quick Capture page
      via: Collapsed prop and toggle callback
---

<objective>
Reorder Quick Capture to camera-first layout and add default-collapsed notes section.
</objective>

<context>
**Gap from Phase 04 Verification:**
- File: `src/pages/quick-capture.tsx:391`
- Current: Camera appears after metadata fields (school, location, name)
- Issue: `QuickNoteInput` always visible, no collapse toggle
- Requirement: CAP-02 (Location selection), camera-first UX improvement

**Current Layout:**
1. School selector
2. Location selector
3. Name input
4. Camera
5. Photos preview
6. Notes (always visible)
7. Save button

**Target Layout:**
1. Camera (primary focus)
2. Photos preview
3. School/Location (collapsed or secondary)
4. Notes (default collapsed)
5. Save button
</context>

<implementation>
**Two-Phase Approach:**

**Phase A - QuickNoteInput Enhancement:**
- Add `collapsed` prop to QuickNoteInput
- Add toggle button (chevron or text "Add note")
- When collapsed: show toggle button only
- When expanded: show textarea + collapse button

**Phase B - Layout Reordering:**
- Move Camera and PhotoPreviewStrip to top
- Collapse or de-emphasize metadata section
- Add toggle to show/hide metadata if needed
- Place Notes section below, default collapsed
</implementation>

<tasks>

<task name="Add collapsible API to QuickNoteInput" type="auto">
<description>Add collapsed prop and toggle to QuickNoteInput component</description>
<files>
- src/components/capture/QuickNoteInput.tsx
</files>
<action>
1. Read QuickNoteInput.tsx
2. Add props: `collapsed?: boolean`, `onToggle?: () => void`
3. When collapsed: render toggle button (e.g., "Add note ▼")
4. When expanded: render textarea with collapse button ("Hide note ▲")
5. Save file
</action>
<verify>
- Component accepts collapsed prop
- Toggle works to show/hide textarea
- Styling matches project theme
- No breaking changes to existing usage
</verify>
<done>QuickNoteInput now supports collapsed state</done>
</task>

<task name="Reorder Quick Capture to camera-first" type="auto">
<description>Move camera section before metadata in quick-capture.tsx</description>
<files>
- src/pages/quick-capture.tsx
</files>
<action>
1. Read quick-capture.tsx to understand current layout
2. Identify camera section (CameraCapture component)
3. Identify PhotoPreviewStrip
4. Move camera and preview above metadata section
5. Add optional: Collapse metadata section with toggle
6. Update QuickNoteInput usage to pass collapsed={true}
7. Save file
</action>
<verify>
- Camera appears first in page flow
- Metadata still accessible (either visible or collapsible)
- Notes section defaults collapsed
- All functionality preserved
- No console errors
</verify>
<done>Quick Capture now camera-first layout</done>
</task>

<task name="Update styles for camera-first layout" type="auto">
<description>Adjust Tailwind classes for new layout priority</description>
<action>
1. Review camera section styling
2. Ensure camera is prominent (full width on mobile)
3. Style metadata section as secondary (muted appearance)
4. Style notes toggle to be discoverable
5. Verify safe-area and mobile ergonomics
</action>
<verify>
- Camera is visually dominant
- Metadata doesn't compete for attention
- Notes toggle is clear but not intrusive
- Mobile layout works well
- Touch targets adequate
</verify>
<done>Camera-first layout styled appropriately</done>
</task>

</tasks>

<verification>
- Camera appears first in Quick Capture
- Notes section defaults collapsed
- Notes can be expanded/collapsed
- Metadata accessible but secondary
- All existing functionality preserved
- Mobile UX improved
</verification>

<success_criteria>
- [ ] QuickNoteInput supports collapsed prop
- [ ] Camera moved to top of Quick Capture
- [ ] Notes default to collapsed
- [ ] Metadata section de-emphasized or collapsible
- [ ] Mobile layout tested and functional
- [ ] TypeScript compilation passes
</success_criteria>
