---
phase: 12-home-page-layout-reorganization
plan: 03
type: execute
wave: 2
depends_on:
  - 12-01
  - 12-02
files_modified:
  - src/pages/Dashboard.tsx
  - src/components/dashboard/SafeAreaWrapper.tsx
  - src/components/dashboard/MobileNav.tsx
  - src/App.tsx
autonomous: true
must_haves:
  truths:
    - All primary touch targets are minimum 44px (48px+ recommended for gloved hands)
    - Bottom elements respect safe area insets (iPhone home indicator)
    - Layout adapts between mobile portrait and desktop views
    - FAB positioning accounts for bottom section on mobile
    - No content is obscured by device notches or home indicators
  artifacts:
    - path: src/components/dashboard/SafeAreaWrapper.tsx
      provides: Wrapper component for safe area insets
      exports: [SafeAreaWrapper]
    - path: src/components/dashboard/MobileNav.tsx
      provides: Optional bottom navigation for mobile (Claude's discretion)
      exports: [MobileNav]
    - path: src/pages/Dashboard.tsx
      provides: Responsive styles and mobile optimizations
      contains: [Responsive grid, safe area classes, touch target sizes]
  key_links:
    - from: src/pages/Dashboard.tsx
      to: src/components/dashboard/SafeAreaWrapper.tsx
      via: import and wrap
      pattern: import.*SafeAreaWrapper
    - from: src/pages/Dashboard.tsx
      to: src/components/dashboard/MobileNav.tsx
      via: conditional render
      pattern: MobileNav.*render
---

<objective>
Optimize Dashboard for mobile portrait use with safe area handling, responsive breakpoints, and touch target sizing to satisfy LAYOUT-03.

Purpose: Ensure one-handed thumb reachability and proper display on mobile devices.
Output: Mobile-optimized Dashboard with safe area support and responsive layout.
</objective>

<execution_context>
@C:/Users/veloc/.config/opencode/get-shit-done/workflows/execute-plan.md
@C:/Users/veloc/.config/opencode/get-shit-down/templates/summary.md
</execution_context>

<context>
@.planning/phases/12-home-page-layout-reorganization/12-CONTEXT.md
@.planning/phases/12-home-page-layout-reorganization/12-RESEARCH.md

# Existing FAB to coordinate with
@src/components/dashboard/DashboardFAB.tsx

# Existing viewport meta tag location
@index.html
</context>

<tasks>

<task type="auto">
  <name>Create SafeAreaWrapper component</name>
  <files>src/components/dashboard/SafeAreaWrapper.tsx</files>
  <action>
Create SafeAreaWrapper component for handling iOS safe area insets.

Purpose: Ensure bottom content isn't obscured by iPhone home indicator.

Implementation:
1. Wrapper div that adds padding-bottom using CSS env() function
2. Support for `env(safe-area-inset-bottom)`, `env(safe-area-inset-top)`, etc.
3. Fallback values for browsers that don't support env()
4. Optional: support for all edges (top, right, bottom, left)

Component signature:
```typescript
interface SafeAreaWrapperProps {
  children: React.ReactNode;
  edges?: ('top' | 'right' | 'bottom' | 'left')[];
  className?: string;
}
```

Default: add bottom safe area padding.

CSS approach:
```css
.safe-area-bottom {
  padding-bottom: max(1rem, env(safe-area-inset-bottom));
}
```

Use Tailwind arbitrary values: `pb-[max(1rem,env(safe-area-inset-bottom))]`

Or create inline styles for full env() support:
```typescript
style={{
  paddingBottom: `max(1rem, env(safe-area-inset-bottom))`
}}
```

Also check and update index.html to ensure viewport meta tag includes `viewport-fit=cover`:
```html
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
```

If not present, add it via this task.
  </action>
  <verify>cat src/components/dashboard/SafeAreaWrapper.tsx</verify>
  <done>SafeAreaWrapper exists with env(safe-area-inset-bottom) support, fallback values, and proper TypeScript types. index.html has viewport-fit=cover if needed.</done>
</task>

<task type="auto">
  <name>Implement responsive breakpoints in Dashboard</name>
  <files>src/pages/Dashboard.tsx</files>
  <action>
Update Dashboard layout with responsive breakpoints:

**Mobile (< 640px / default):**
- Single column layout
- Sections stacked vertically
- Full-width cards
- QuickCaptureCard takes full width with generous padding
- Touch targets: minimum 48px height for all interactive elements
- Padding: px-4 (16px horizontal)

**Tablet/Desktop (>= 640px / sm:):**
- Two-column grid for Capture + Review sections
- Analyze section spans both columns below
- Gap between columns: gap-6 (24px)
- Max width container: max-w-7xl mx-auto

**Large Desktop (>= 1024px / lg:):**
- Three-column potential (future expansion)
- Larger padding and spacing

Implementation:
```tsx
<div className="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
  {/* Capture section */}
  <section className="col-span-1">...</section>
  
  {/* Review section */}
  <section className="col-span-1">...</section>
  
  {/* Analyze section */}
  <section className="col-span-1 sm:col-span-2">...</section>
</div>
```

Ensure each section has appropriate background colors:
- Capture: bg-amber-50/50 (warm)
- Review: bg-teal-50/50 (cool)
- Analyze: bg-slate-50 (neutral)

Add section borders: border border-amber-100 (Capture), border-teal-100 (Review), border-slate-200 (Analyze)

Apply rounded corners: rounded-xl or rounded-2xl
  </action>
  <verify>grep -n "grid-cols\|sm:grid\|col-span\|bg-amber\|bg-teal\|bg-slate" src/pages/Dashboard.tsx | head -20</verify>
  <done>Dashboard uses responsive grid (1 col mobile, 2 col desktop), section backgrounds, and rounded corners. All TypeScript checks pass.</done>
</task>

<task type="auto">
  <name>Ensure 44px+ touch targets</name>
  <files>src/pages/Dashboard.tsx
src/components/dashboard/QuickCaptureCard.tsx
src/components/dashboard/ReviewSection.tsx</files>
  <action>
Verify and update all touch targets to meet minimum 44px (prefer 48px+ for gloved hands):

**QuickCaptureCard:**
- Height: min-h-[120px] (already should be large)
- Internal buttons: h-12 (48px) or larger

**ReviewSection:**
- "Review All Pending" button: h-12 (48px)
- Preview items: min-h-[48px]

**Any inline links or small buttons:**
- Convert to proper Button components or add padding
- Ensure hit area is at least 44x44px

**Dashboard FAB coordination:**
- FAB should not overlap QuickCaptureCard on mobile
- Add margin-bottom to main content to clear FAB
- FAB size is already 56px (Phase 04), which is good

Add to Dashboard:
```tsx
{/* Bottom spacer to clear FAB */}
<div className="h-20 sm:hidden" />
```

This ensures scrollable content clears the FAB on mobile.
  </action>
  <verify>grep -n "h-12\|min-h-\[48px\]\|h-20" src/pages/Dashboard.tsx src/components/dashboard/QuickCaptureCard.tsx src/components/dashboard/ReviewSection.tsx</verify>
  <done>All interactive elements have minimum 44px touch targets (48px+ for primary actions). FAB clearance spacer added.</done>
</task>

<task type="auto">
  <name>Create optional MobileNav component</name>
  <files>src/components/dashboard/MobileNav.tsx</files>
  <action>
Create MobileNav component for bottom navigation on mobile (Claude's discretion - make it optional/enhancement).

Since user delegated bottom navigation to Claude's discretion, implement a minimal, unobtrusive version:

Features:
1. Fixed position at bottom (above safe area)
2. Shows only on mobile (< sm breakpoint)
3. Three items: Dashboard (home icon), Capture (camera icon), Review (list icon)
4. Active state highlighting
5. Simple pill/tab style, not full-width bar
6. Collapsible/hidable if user scrolls (optional enhancement)

Style:
- Background: white with subtle shadow
- Active item: amber for Capture, teal for Review, slate for Dashboard
- Height: 64px total (including safe area padding)
- Touch targets: 48px minimum

Component signature:
```typescript
interface MobileNavProps {
  currentPath: string;
  className?: string;
}
```

If this feels like too much, make it a simple component that can be conditionally rendered and easily disabled.

Alternative: Skip this and rely on existing FAB + in-page navigation if it feels cleaner.

Decision: Create the component but make it optional - Dashboard can choose to render it or not based on UX testing.
  </action>
  <verify>cat src/components/dashboard/MobileNav.tsx | head -30</verify>
  <done>MobileNav exists with three navigation items, active states, and mobile-only display. Optional integration in Dashboard.</done>
</task>

<task type="auto">
  <name>Apply safe area to Dashboard</name>
  <files>src/pages/Dashboard.tsx</files>
  <action>
Integrate SafeAreaWrapper into Dashboard:

1. Wrap the main content area with SafeAreaWrapper
2. Apply safe area padding to bottom of page
3. Ensure FAB is positioned above the safe area (it should already have pb-safe from Phase 04)

Update Dashboard structure:
```tsx
<SafeAreaWrapper edges={['bottom']}>
  <div className="min-h-screen bg-background">
    {/* Header */}
    {/* Workflow sections */}
    {/* Optional MobileNav */}
    {/* FAB */}
  </div>
</SafeAreaWrapper>
```

Verify the page content is not obscured on iPhone simulators or real devices.

Test with Chrome DevTools device emulation (iPhone 12/13/14).
  </action>
  <verify>grep -n "SafeAreaWrapper\|edges.*bottom" src/pages/Dashboard.tsx</verify>
  <done>SafeAreaWrapper wraps Dashboard content with bottom safe area padding. No visual overlap issues.</done>
</task>

</tasks>

<verification>
- [ ] SafeAreaWrapper component exists with env(safe-area-inset-bottom) support
- [ ] Dashboard has responsive grid (1 col mobile, 2 col desktop)
- [ ] Section backgrounds use correct colors (amber-50, teal-50, slate-50)
- [ ] All interactive elements have minimum 44px touch targets (48px+ primary)
- [ ] FAB has clearance spacer on mobile
- [ ] index.html has viewport-fit=cover meta tag
- [ ] MobileNav component exists (optional)
- [ ] Dashboard passes iPhone safe area test (DevTools emulation)
- [ ] npm run check passes (TypeScript)
- [ ] npm run build succeeds
</verification>

<success_criteria>
1. Dashboard layout adapts between mobile (stacked) and desktop (side-by-side)
2. All interactive elements meet 44px minimum touch target (48px+ for primary actions)
3. Bottom content respects iPhone safe area insets (no content under home indicator)
4. QuickCaptureCard in bottom 1/3 is reachable with thumb in portrait mode
5. FAB positioned appropriately and doesn't overlap content
6. Background color blocks visually separate workflow sections on all screen sizes
7. Layout tested and functional on iPhone 12/13/14 size devices
8. No horizontal scroll on mobile
9. TypeScript checks pass, build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/12-home-page-layout-reorganization/12-03-SUMMARY.md`
</output>
