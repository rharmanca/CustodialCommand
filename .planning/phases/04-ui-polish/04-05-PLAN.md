---
phase: 04-ui-polish
plan: 05
type: execute
wave: 2
depends_on: [04-01, 04-02, 04-03]
files_modified:
  - src/App.tsx
  - src/components/ui/FloatingActionButton.tsx
autonomous: true
must_haves:
  truths:
    - FAB visible on dashboard bottom-right
    - FAB uses amber color matching Quick Capture
    - FAB size 56px diameter
    - FAB hides on scroll down, shows on scroll up
    - FAB navigates to Quick Capture
  artifacts:
    - path: src/App.tsx
      provides: Dashboard view with FAB wiring and scroll behavior
    - path: src/components/ui/FloatingActionButton.tsx
      provides: Reusable FAB component
  key_links:
    - from: FAB click
      to: /quick-capture route
      via: React Router navigate
---

<objective>
Add Floating Action Button (FAB) to dashboard for instant Quick Capture access.

Purpose: Field users need immediate access without navigating menus.
Output: Dashboard with Material Design FAB in bottom-right corner.
</objective>

<execution_context>
@C:/Users/veloc/.config/opencode/get-shit-done/workflows/execute-plan.md
</execution_context>

<context>
@.planning/phases/04-ui-polish/04-CONTEXT.md
@src/App.tsx
@src/components/ui/FloatingActionButton.tsx
</context>

<tasks>

<task type="auto">
  <name>Refine existing FAB component</name>
  <files>src/components/ui/FloatingActionButton.tsx</files>
  <action>
    Refine the existing reusable Floating Action Button component:
    1. Circular button, 56px diameter
    2. Amber/orange background matching Quick Capture theme
    3. White camera icon (from lucide-react)
    4. Fixed positioning: bottom-6 right-6
    5. Shadow for elevation (shadow-lg or xl)
    6. Hover state with scale transform
    7. Active/pressed state
    8. Accessible: aria-label="Quick Capture"
    
    Keep using the existing component patterns in `FloatingActionButton.tsx`.
    Ensure it works on mobile touch devices.
  </action>
  <verify>
    Run `npm run check` and confirm exit code 0.
    Run `npm run build` and confirm build succeeds.
    Run `node tests/visual-analysis.cjs` and confirm `tests/screenshots/visual-analysis/01-dashboard-desktop.png` exists.
  </verify>
  <done>
    FAB component supports required props and behavior: onClick, ariaLabel, icon, variant, badge
    Matches design system
  </done>
</task>

<task type="auto">
  <name>Add FAB to dashboard with scroll behavior</name>
  <files>src/App.tsx</files>
  <action>
    Add FAB to dashboard with scroll-aware visibility:
    1. Import FAB component
    2. Position fixed bottom-right
    3. Add scroll listener to detect scroll direction
    4. Hide FAB when scrolling down (translate-y-full or opacity-0)
    5. Show FAB when scrolling up
    6. On click, navigate to /quick-capture
    7. Ensure FAB doesn't overlap footer or other fixed elements
    8. Consider threshold (only hide after scrolling 100px+)
    
    Use React useState and useEffect for scroll handling.
    Debounce scroll handler for performance.
  </action>
  <verify>
    Run `npx cross-env TARGET_URL=https://custodialcommand-dev.up.railway.app node tests/dev-browser-flow-check.cjs` and confirm `quickCaptureTransition: true`.
    Run `node tests/visual-analysis.cjs` and confirm dashboard screenshot includes the FAB.
    Confirm FAB scroll hide/show behavior works without flicker.
  </verify>
  <done>
    FAB appears on dashboard
    Scroll behavior working smoothly
    Navigation functional
  </done>
</task>

<task type="auto">
  <name>Ensure mobile compatibility</name>
  <files>src/App.tsx
src/components/ui/FloatingActionButton.tsx</files>
  <action>
    Test and adjust FAB for mobile:
    1. FAB should not overlap bottom navigation (if exists)
    2. Size remains 56px on mobile (touch target)
    3. Position above any mobile nav bar
    4. Safe area padding for notched devices (safe-area-inset-bottom)
    5. No horizontal scroll triggered by FAB
    6. Test on 375px and 320px viewports
    
    Consider using CSS env(safe-area-inset-bottom) for iOS.
  </action>
  <verify>
    Run `node tests/visual-analysis.cjs` and confirm `tests/screenshots/visual-analysis/02-dashboard-mobile.png` is generated.
    Confirm FAB remains tappable on mobile viewport and does not overlap navigation.
    Confirm no horizontal scroll is introduced.
  </verify>
  <done>
    FAB works on mobile devices
    Proper spacing from screen edges
  </done>
</task>

</tasks>

<verification>
- Run `npm run check` and `npm run build` successfully.
- Run `node tests/visual-analysis.cjs` and verify desktop/mobile dashboard screenshots include FAB.
- Run `npx cross-env TARGET_URL=https://custodialcommand-dev.up.railway.app node tests/dev-browser-flow-check.cjs` and confirm navigation still passes.
</verification>

<success_criteria>
- FAB visible bottom-right on dashboard
- Hides on scroll down, shows on scroll up
- Navigates to Quick Capture on click
- Amber color consistent with theme
- Works on mobile and desktop
</success_criteria>

<output>
After completion, create `.planning/phases/04-ui-polish/04-05-SUMMARY.md`
</output>
